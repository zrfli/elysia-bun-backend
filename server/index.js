// @bun
var fG=Object.create;var{getPrototypeOf:yG,defineProperty:MY,getOwnPropertyNames:vG}=Object;var dG=Object.prototype.hasOwnProperty;var GY=(Z,$,Y)=>{Y=Z!=null?fG(yG(Z)):{};let Q=$||!Z||!Z.__esModule?MY(Y,"default",{value:Z,enumerable:!0}):Y;for(let X of vG(Z))if(!dG.call(Q,X))MY(Q,X,{get:()=>Z[X],enumerable:!0});return Q};var j=(Z,$)=>()=>($||Z(($={exports:{}}).exports,$),$.exports);var e8=(Z,$)=>{for(var Y in $)MY(Z,Y,{get:$[Y],enumerable:!0,configurable:!0,set:(Q)=>$[Y]=()=>Q})};var z1=import.meta.require;var lW=j((iW)=>{Object.defineProperty(iW,"__esModule",{value:!0});iW.parse=C3;iW.serialize=V3;var F3=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,K3=/^[\u0021-\u003A\u003C-\u007E]*$/,P3=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,j3=/^[\u0020-\u003A\u003D-\u007E]*$/,R3=Object.prototype.toString,_3=(()=>{let Z=function(){};return Z.prototype=Object.create(null),Z})();function C3(Z,$){let Y=new _3,Q=Z.length;if(Q<2)return Y;let X=$?.decode||E3,W=0;do{let J=Z.indexOf("=",W);if(J===-1)break;let z=Z.indexOf(";",W),q=z===-1?Q:z;if(J>q){W=Z.lastIndexOf(";",J-1)+1;continue}let U=pW(Z,W,J),w=cW(Z,J,U),M=Z.slice(U,w);if(Y[M]===void 0){let S=pW(Z,J+1,q),G=cW(Z,q,S),L=X(Z.slice(S,G));Y[M]=L}W=q+1}while(W<Q);return Y}function pW(Z,$,Y){do{let Q=Z.charCodeAt($);if(Q!==32&&Q!==9)return $}while(++$<Y);return Y}function cW(Z,$,Y){while($>Y){let Q=Z.charCodeAt(--$);if(Q!==32&&Q!==9)return $+1}return Y}function V3(Z,$,Y){let Q=Y?.encode||encodeURIComponent;if(!F3.test(Z))throw new TypeError(`argument name is invalid: ${Z}`);let X=Q($);if(!K3.test(X))throw new TypeError(`argument val is invalid: ${$}`);let W=Z+"="+X;if(!Y)return W;if(Y.maxAge!==void 0){if(!Number.isInteger(Y.maxAge))throw new TypeError(`option maxAge is invalid: ${Y.maxAge}`);W+="; Max-Age="+Y.maxAge}if(Y.domain){if(!P3.test(Y.domain))throw new TypeError(`option domain is invalid: ${Y.domain}`);W+="; Domain="+Y.domain}if(Y.path){if(!j3.test(Y.path))throw new TypeError(`option path is invalid: ${Y.path}`);W+="; Path="+Y.path}if(Y.expires){if(!I3(Y.expires)||!Number.isFinite(Y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${Y.expires}`);W+="; Expires="+Y.expires.toUTCString()}if(Y.httpOnly)W+="; HttpOnly";if(Y.secure)W+="; Secure";if(Y.partitioned)W+="; Partitioned";if(Y.priority)switch(typeof Y.priority==="string"?Y.priority.toLowerCase():void 0){case"low":W+="; Priority=Low";break;case"medium":W+="; Priority=Medium";break;case"high":W+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${Y.priority}`)}if(Y.sameSite)switch(typeof Y.sameSite==="string"?Y.sameSite.toLowerCase():Y.sameSite){case!0:case"strict":W+="; SameSite=Strict";break;case"lax":W+="; SameSite=Lax";break;case"none":W+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${Y.sameSite}`)}return W}function E3(Z){if(Z.indexOf("%")===-1)return Z;try{return decodeURIComponent(Z)}catch($){return Z}}function I3(Z){return R3.call(Z)==="[object Date]"}});var YZ=j((A5,mJ)=>{/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var B9=z1("buffer"),s6=B9.Buffer;function hJ(Z,$){for(var Y in Z)$[Y]=Z[Y]}if(s6.from&&s6.alloc&&s6.allocUnsafe&&s6.allocUnsafeSlow)mJ.exports=B9;else hJ(B9,A5),A5.Buffer=N4;function N4(Z,$,Y){return s6(Z,$,Y)}N4.prototype=Object.create(s6.prototype);hJ(s6,N4);N4.from=function(Z,$,Y){if(typeof Z==="number")throw new TypeError("Argument must not be a number");return s6(Z,$,Y)};N4.alloc=function(Z,$,Y){if(typeof Z!=="number")throw new TypeError("Argument must be a number");var Q=s6(Z);if($!==void 0)if(typeof Y==="string")Q.fill($,Y);else Q.fill($);else Q.fill(0);return Q};N4.allocUnsafe=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return s6(Z)};N4.allocUnsafeSlow=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return B9.SlowBuffer(Z)}});var N5=j((_o,uJ)=>{var S9=YZ().Buffer,gK=z1("stream"),fK=z1("util");function H9(Z){if(this.buffer=null,this.writable=!0,this.readable=!0,!Z)return this.buffer=S9.alloc(0),this;if(typeof Z.pipe==="function")return this.buffer=S9.alloc(0),Z.pipe(this),this;if(Z.length||typeof Z==="object")return this.buffer=Z,this.writable=!1,process.nextTick(function(){this.emit("end",Z),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof Z+")")}fK.inherits(H9,gK);H9.prototype.write=function Z($){this.buffer=S9.concat([this.buffer,S9.from($)]),this.emit("data",$)};H9.prototype.end=function Z($){if($)this.write($);this.emit("end",$),this.emit("close"),this.writable=!1,this.readable=!1};uJ.exports=H9});var cJ=j((Co,pJ)=>{var cZ=z1("buffer").Buffer,L5=z1("buffer").SlowBuffer;pJ.exports=D9;function D9(Z,$){if(!cZ.isBuffer(Z)||!cZ.isBuffer($))return!1;if(Z.length!==$.length)return!1;var Y=0;for(var Q=0;Q<Z.length;Q++)Y|=Z[Q]^$[Q];return Y===0}D9.install=function(){cZ.prototype.equal=L5.prototype.equal=function Z($){return D9(this,$)}};var yK=cZ.prototype.equal,vK=L5.prototype.equal;D9.restore=function(){cZ.prototype.equal=yK,L5.prototype.equal=vK}});var lJ=j((Vo,iJ)=>{function O5(Z){var $=(Z/8|0)+(Z%8===0?0:1);return $}var dK={ES256:O5(256),ES384:O5(384),ES512:O5(521)};function hK(Z){var $=dK[Z];if($)return $;throw new Error('Unknown algorithm "'+Z+'"')}iJ.exports=hK});var eJ=j((Eo,aJ)=>{var A9=YZ().Buffer,oJ=lJ(),N9=128,tJ=0,mK=32,uK=16,pK=2,sJ=uK|mK|tJ<<6,L9=pK|tJ<<6;function cK(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rJ(Z){if(A9.isBuffer(Z))return Z;else if(typeof Z==="string")return A9.from(Z,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function iK(Z,$){Z=rJ(Z);var Y=oJ($),Q=Y+1,X=Z.length,W=0;if(Z[W++]!==sJ)throw new Error('Could not find expected "seq"');var J=Z[W++];if(J===(N9|1))J=Z[W++];if(X-W<J)throw new Error('"seq" specified length of "'+J+'", only "'+(X-W)+'" remaining');if(Z[W++]!==L9)throw new Error('Could not find expected "int" for "r"');var z=Z[W++];if(X-W-2<z)throw new Error('"r" specified length of "'+z+'", only "'+(X-W-2)+'" available');if(Q<z)throw new Error('"r" specified length of "'+z+'", max of "'+Q+'" is acceptable');var q=W;if(W+=z,Z[W++]!==L9)throw new Error('Could not find expected "int" for "s"');var U=Z[W++];if(X-W!==U)throw new Error('"s" specified length of "'+U+'", expected "'+(X-W)+'"');if(Q<U)throw new Error('"s" specified length of "'+U+'", max of "'+Q+'" is acceptable');var w=W;if(W+=U,W!==X)throw new Error('Expected to consume entire buffer, but "'+(X-W)+'" bytes remain');var M=Y-z,S=Y-U,G=A9.allocUnsafe(M+z+S+U);for(W=0;W<M;++W)G[W]=0;Z.copy(G,W,q+Math.max(-M,0),q+z),W=Y;for(var L=W;W<L+S;++W)G[W]=0;return Z.copy(G,W,w+Math.max(-S,0),w+U),G=G.toString("base64"),G=cK(G),G}function nJ(Z,$,Y){var Q=0;while($+Q<Y&&Z[$+Q]===0)++Q;var X=Z[$+Q]>=N9;if(X)--Q;return Q}function lK(Z,$){Z=rJ(Z);var Y=oJ($),Q=Z.length;if(Q!==Y*2)throw new TypeError('"'+$+'" signatures must be "'+Y*2+'" bytes, saw "'+Q+'"');var X=nJ(Z,0,Y),W=nJ(Z,Y,Z.length),J=Y-X,z=Y-W,q=2+J+1+1+z,U=q<N9,w=A9.allocUnsafe((U?2:3)+q),M=0;if(w[M++]=sJ,U)w[M++]=q;else w[M++]=N9|1,w[M++]=q&255;if(w[M++]=L9,w[M++]=J,X<0)w[M++]=0,M+=Z.copy(w,M,0,Y);else M+=Z.copy(w,M,X,Y);if(w[M++]=L9,w[M++]=z,W<0)w[M++]=0,Z.copy(w,M,Y);else Z.copy(w,M,Y+W);return w}aJ.exports={derToJose:iK,joseToDer:lK}});var P5=j((Io,qz)=>{var nK=cJ(),XZ=YZ().Buffer,r6=z1("crypto"),$z=eJ(),Zz=z1("util"),oK=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,iZ="secret must be a string or buffer",QZ="key must be a string or a buffer",tK="key must be a string, a buffer or an object",F5=typeof r6.createPublicKey==="function";if(F5)QZ+=" or a KeyObject",iZ+="or a KeyObject";function Yz(Z){if(XZ.isBuffer(Z))return;if(typeof Z==="string")return;if(!F5)throw h6(QZ);if(typeof Z!=="object")throw h6(QZ);if(typeof Z.type!=="string")throw h6(QZ);if(typeof Z.asymmetricKeyType!=="string")throw h6(QZ);if(typeof Z.export!=="function")throw h6(QZ)}function Qz(Z){if(XZ.isBuffer(Z))return;if(typeof Z==="string")return;if(typeof Z==="object")return;throw h6(tK)}function sK(Z){if(XZ.isBuffer(Z))return;if(typeof Z==="string")return Z;if(!F5)throw h6(iZ);if(typeof Z!=="object")throw h6(iZ);if(Z.type!=="secret")throw h6(iZ);if(typeof Z.export!=="function")throw h6(iZ)}function K5(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Xz(Z){Z=Z.toString();var $=4-Z.length%4;if($!==4)for(var Y=0;Y<$;++Y)Z+="=";return Z.replace(/\-/g,"+").replace(/_/g,"/")}function h6(Z){var $=[].slice.call(arguments,1),Y=Zz.format.bind(Zz,Z).apply(null,$);return new TypeError(Y)}function rK(Z){return XZ.isBuffer(Z)||typeof Z==="string"}function lZ(Z){if(!rK(Z))Z=JSON.stringify(Z);return Z}function Wz(Z){return function $(Y,Q){sK(Q),Y=lZ(Y);var X=r6.createHmac("sha"+Z,Q),W=(X.update(Y),X.digest("base64"));return K5(W)}}function aK(Z){return function $(Y,Q,X){var W=Wz(Z)(Y,X);return nK(XZ.from(Q),XZ.from(W))}}function Jz(Z){return function $(Y,Q){Qz(Q),Y=lZ(Y);var X=r6.createSign("RSA-SHA"+Z),W=(X.update(Y),X.sign(Q,"base64"));return K5(W)}}function zz(Z){return function $(Y,Q,X){Yz(X),Y=lZ(Y),Q=Xz(Q);var W=r6.createVerify("RSA-SHA"+Z);return W.update(Y),W.verify(X,Q,"base64")}}function eK(Z){return function $(Y,Q){Qz(Q),Y=lZ(Y);var X=r6.createSign("RSA-SHA"+Z),W=(X.update(Y),X.sign({key:Q,padding:r6.constants.RSA_PKCS1_PSS_PADDING,saltLength:r6.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return K5(W)}}function ZP(Z){return function $(Y,Q,X){Yz(X),Y=lZ(Y),Q=Xz(Q);var W=r6.createVerify("RSA-SHA"+Z);return W.update(Y),W.verify({key:X,padding:r6.constants.RSA_PKCS1_PSS_PADDING,saltLength:r6.constants.RSA_PSS_SALTLEN_DIGEST},Q,"base64")}}function $P(Z){var $=Jz(Z);return function Y(){var Q=$.apply(null,arguments);return Q=$z.derToJose(Q,"ES"+Z),Q}}function YP(Z){var $=zz(Z);return function Y(Q,X,W){X=$z.joseToDer(X,"ES"+Z).toString("base64");var J=$(Q,X,W);return J}}function QP(){return function Z(){return""}}function XP(){return function Z($,Y){return Y===""}}qz.exports=function Z($){var Y={hs:Wz,rs:Jz,ps:eK,es:$P,none:QP},Q={hs:aK,rs:zz,ps:ZP,es:YP,none:XP},X=$.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!X)throw h6(oK,$);var W=(X[1]||X[3]).toLowerCase(),J=X[2];return{sign:Y[W](J),verify:Q[W](J)}}});var j5=j((xo,Uz)=>{var WP=z1("buffer").Buffer;Uz.exports=function Z($){if(typeof $==="string")return $;if(typeof $==="number"||WP.isBuffer($))return $.toString();return JSON.stringify($)}});var Hz=j((To,Sz)=>{var JP=YZ().Buffer,wz=N5(),zP=P5(),qP=z1("stream"),Mz=j5(),R5=z1("util");function Gz(Z,$){return JP.from(Z,$).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function UP(Z,$,Y){Y=Y||"utf8";var Q=Gz(Mz(Z),"binary"),X=Gz(Mz($),Y);return R5.format("%s.%s",Q,X)}function Bz(Z){var{header:$,payload:Y}=Z,Q=Z.secret||Z.privateKey,X=Z.encoding,W=zP($.alg),J=UP($,Y,X),z=W.sign(J,Q);return R5.format("%s.%s",J,z)}function O9(Z){var $=Z.secret||Z.privateKey||Z.key,Y=new wz($);this.readable=!0,this.header=Z.header,this.encoding=Z.encoding,this.secret=this.privateKey=this.key=Y,this.payload=new wz(Z.payload),this.secret.once("close",function(){if(!this.payload.writable&&this.readable)this.sign()}.bind(this)),this.payload.once("close",function(){if(!this.secret.writable&&this.readable)this.sign()}.bind(this))}R5.inherits(O9,qP);O9.prototype.sign=function Z(){try{var $=Bz({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",$),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Y){this.readable=!1,this.emit("error",Y),this.emit("close")}};O9.sign=Bz;Sz.exports=O9});var Rz=j((bo,jz)=>{var Az=YZ().Buffer,Dz=N5(),wP=P5(),MP=z1("stream"),Nz=j5(),GP=z1("util"),BP=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function SP(Z){return Object.prototype.toString.call(Z)==="[object Object]"}function HP(Z){if(SP(Z))return Z;try{return JSON.parse(Z)}catch($){return}}function Lz(Z){var $=Z.split(".",1)[0];return HP(Az.from($,"base64").toString("binary"))}function DP(Z){return Z.split(".",2).join(".")}function Oz(Z){return Z.split(".")[2]}function AP(Z,$){$=$||"utf8";var Y=Z.split(".")[1];return Az.from(Y,"base64").toString($)}function Fz(Z){return BP.test(Z)&&!!Lz(Z)}function Kz(Z,$,Y){if(!$){var Q=new Error("Missing algorithm parameter for jws.verify");throw Q.code="MISSING_ALGORITHM",Q}Z=Nz(Z);var X=Oz(Z),W=DP(Z),J=wP($);return J.verify(W,X,Y)}function Pz(Z,$){if($=$||{},Z=Nz(Z),!Fz(Z))return null;var Y=Lz(Z);if(!Y)return null;var Q=AP(Z);if(Y.typ==="JWT"||$.json)Q=JSON.parse(Q,$.encoding);return{header:Y,payload:Q,signature:Oz(Z)}}function WZ(Z){Z=Z||{};var $=Z.secret||Z.publicKey||Z.key,Y=new Dz($);this.readable=!0,this.algorithm=Z.algorithm,this.encoding=Z.encoding,this.secret=this.publicKey=this.key=Y,this.signature=new Dz(Z.signature),this.secret.once("close",function(){if(!this.signature.writable&&this.readable)this.verify()}.bind(this)),this.signature.once("close",function(){if(!this.secret.writable&&this.readable)this.verify()}.bind(this))}GP.inherits(WZ,MP);WZ.prototype.verify=function Z(){try{var $=Kz(this.signature.buffer,this.algorithm,this.key.buffer),Y=Pz(this.signature.buffer,this.encoding);return this.emit("done",$,Y),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Q){this.readable=!1,this.emit("error",Q),this.emit("close")}};WZ.decode=Pz;WZ.isValid=Fz;WZ.verify=Kz;jz.exports=WZ});var K9=j((LP)=>{var _z=Hz(),F9=Rz(),NP=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];LP.ALGORITHMS=NP;LP.sign=_z.sign;LP.verify=F9.verify;LP.decode=F9.decode;LP.isValid=F9.isValid;LP.createSign=function Z($){return new _z($)};LP.createVerify=function Z($){return new F9($)}});var _5=j((go,Cz)=>{var CP=K9();Cz.exports=function(Z,$){$=$||{};var Y=CP.decode(Z,$);if(!Y)return null;var Q=Y.payload;if(typeof Q==="string")try{var X=JSON.parse(Q);if(X!==null&&typeof X==="object")Q=X}catch(W){}if($.complete===!0)return{header:Y.header,payload:Q,signature:Y.signature};return Q}});var nZ=j((fo,Vz)=>{var P9=function(Z,$){if(Error.call(this,Z),Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);if(this.name="JsonWebTokenError",this.message=Z,$)this.inner=$};P9.prototype=Object.create(Error.prototype);P9.prototype.constructor=P9;Vz.exports=P9});var C5=j((yo,Iz)=>{var Ez=nZ(),j9=function(Z,$){Ez.call(this,Z),this.name="NotBeforeError",this.date=$};j9.prototype=Object.create(Ez.prototype);j9.prototype.constructor=j9;Iz.exports=j9});var V5=j((vo,Tz)=>{var xz=nZ(),R9=function(Z,$){xz.call(this,Z),this.name="TokenExpiredError",this.expiredAt=$};R9.prototype=Object.create(xz.prototype);R9.prototype.constructor=R9;Tz.exports=R9});var E5=j((ho,bz)=>{var JZ=1000,zZ=JZ*60,qZ=zZ*60,L4=qZ*24,VP=L4*7,EP=L4*365.25;bz.exports=function(Z,$){$=$||{};var Y=typeof Z;if(Y==="string"&&Z.length>0)return IP(Z);else if(Y==="number"&&isFinite(Z))return $.long?TP(Z):xP(Z);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Z))};function IP(Z){if(Z=String(Z),Z.length>100)return;var $=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Z);if(!$)return;var Y=parseFloat($[1]),Q=($[2]||"ms").toLowerCase();switch(Q){case"years":case"year":case"yrs":case"yr":case"y":return Y*EP;case"weeks":case"week":case"w":return Y*VP;case"days":case"day":case"d":return Y*L4;case"hours":case"hour":case"hrs":case"hr":case"h":return Y*qZ;case"minutes":case"minute":case"mins":case"min":case"m":return Y*zZ;case"seconds":case"second":case"secs":case"sec":case"s":return Y*JZ;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Y;default:return}}function xP(Z){var $=Math.abs(Z);if($>=L4)return Math.round(Z/L4)+"d";if($>=qZ)return Math.round(Z/qZ)+"h";if($>=zZ)return Math.round(Z/zZ)+"m";if($>=JZ)return Math.round(Z/JZ)+"s";return Z+"ms"}function TP(Z){var $=Math.abs(Z);if($>=L4)return _9(Z,$,L4,"day");if($>=qZ)return _9(Z,$,qZ,"hour");if($>=zZ)return _9(Z,$,zZ,"minute");if($>=JZ)return _9(Z,$,JZ,"second");return Z+" ms"}function _9(Z,$,Y,Q){var X=$>=Y*1.5;return Math.round(Z/Y)+" "+Q+(X?"s":"")}});var I5=j((mo,kz)=>{var bP=E5();kz.exports=function(Z,$){var Y=$||Math.floor(Date.now()/1000);if(typeof Z==="string"){var Q=bP(Z);if(typeof Q==="undefined")return;return Math.floor(Y+Q/1000)}else if(typeof Z==="number")return Y+Z;else return}});var oZ=j((uo,gz)=>{var kP=Number.MAX_SAFE_INTEGER||9007199254740991,gP=["major","premajor","minor","preminor","patch","prepatch","prerelease"];gz.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:kP,RELEASE_TYPES:gP,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var tZ=j((po,fz)=>{var fP=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...Z)=>console.error("SEMVER",...Z):()=>{};fz.exports=fP});var UZ=j((a6,yz)=>{var{MAX_SAFE_COMPONENT_LENGTH:x5,MAX_SAFE_BUILD_LENGTH:yP,MAX_LENGTH:vP}=oZ(),dP=tZ();a6=yz.exports={};var hP=a6.re=[],mP=a6.safeRe=[],f=a6.src=[],uP=a6.safeSrc=[],y=a6.t={},pP=0,T5="[a-zA-Z0-9-]",cP=[["\\s",1],["\\d",vP],[T5,yP]],iP=(Z)=>{for(let[$,Y]of cP)Z=Z.split(`${$}*`).join(`${$}{0,${Y}}`).split(`${$}+`).join(`${$}{1,${Y}}`);return Z},t=(Z,$,Y)=>{let Q=iP($),X=pP++;dP(Z,X,$),y[Z]=X,f[X]=$,uP[X]=Q,hP[X]=new RegExp($,Y?"g":void 0),mP[X]=new RegExp(Q,Y?"g":void 0)};t("NUMERICIDENTIFIER","0|[1-9]\\d*");t("NUMERICIDENTIFIERLOOSE","\\d+");t("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${T5}*`);t("MAINVERSION",`(${f[y.NUMERICIDENTIFIER]})\\.(${f[y.NUMERICIDENTIFIER]})\\.(${f[y.NUMERICIDENTIFIER]})`);t("MAINVERSIONLOOSE",`(${f[y.NUMERICIDENTIFIERLOOSE]})\\.(${f[y.NUMERICIDENTIFIERLOOSE]})\\.(${f[y.NUMERICIDENTIFIERLOOSE]})`);t("PRERELEASEIDENTIFIER",`(?:${f[y.NUMERICIDENTIFIER]}|${f[y.NONNUMERICIDENTIFIER]})`);t("PRERELEASEIDENTIFIERLOOSE",`(?:${f[y.NUMERICIDENTIFIERLOOSE]}|${f[y.NONNUMERICIDENTIFIER]})`);t("PRERELEASE",`(?:-(${f[y.PRERELEASEIDENTIFIER]}(?:\\.${f[y.PRERELEASEIDENTIFIER]})*))`);t("PRERELEASELOOSE",`(?:-?(${f[y.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${f[y.PRERELEASEIDENTIFIERLOOSE]})*))`);t("BUILDIDENTIFIER",`${T5}+`);t("BUILD",`(?:\\+(${f[y.BUILDIDENTIFIER]}(?:\\.${f[y.BUILDIDENTIFIER]})*))`);t("FULLPLAIN",`v?${f[y.MAINVERSION]}${f[y.PRERELEASE]}?${f[y.BUILD]}?`);t("FULL",`^${f[y.FULLPLAIN]}$`);t("LOOSEPLAIN",`[v=\\s]*${f[y.MAINVERSIONLOOSE]}${f[y.PRERELEASELOOSE]}?${f[y.BUILD]}?`);t("LOOSE",`^${f[y.LOOSEPLAIN]}$`);t("GTLT","((?:<|>)?=?)");t("XRANGEIDENTIFIERLOOSE",`${f[y.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);t("XRANGEIDENTIFIER",`${f[y.NUMERICIDENTIFIER]}|x|X|\\*`);t("XRANGEPLAIN",`[v=\\s]*(${f[y.XRANGEIDENTIFIER]})(?:\\.(${f[y.XRANGEIDENTIFIER]})(?:\\.(${f[y.XRANGEIDENTIFIER]})(?:${f[y.PRERELEASE]})?${f[y.BUILD]}?)?)?`);t("XRANGEPLAINLOOSE",`[v=\\s]*(${f[y.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f[y.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f[y.XRANGEIDENTIFIERLOOSE]})(?:${f[y.PRERELEASELOOSE]})?${f[y.BUILD]}?)?)?`);t("XRANGE",`^${f[y.GTLT]}\\s*${f[y.XRANGEPLAIN]}$`);t("XRANGELOOSE",`^${f[y.GTLT]}\\s*${f[y.XRANGEPLAINLOOSE]}$`);t("COERCEPLAIN",`(^|[^\\d])(\\d{1,${x5}})(?:\\.(\\d{1,${x5}}))?(?:\\.(\\d{1,${x5}}))?`);t("COERCE",`${f[y.COERCEPLAIN]}(?:$|[^\\d])`);t("COERCEFULL",f[y.COERCEPLAIN]+`(?:${f[y.PRERELEASE]})?(?:${f[y.BUILD]})?(?:$|[^\\d])`);t("COERCERTL",f[y.COERCE],!0);t("COERCERTLFULL",f[y.COERCEFULL],!0);t("LONETILDE","(?:~>?)");t("TILDETRIM",`(\\s*)${f[y.LONETILDE]}\\s+`,!0);a6.tildeTrimReplace="$1~";t("TILDE",`^${f[y.LONETILDE]}${f[y.XRANGEPLAIN]}$`);t("TILDELOOSE",`^${f[y.LONETILDE]}${f[y.XRANGEPLAINLOOSE]}$`);t("LONECARET","(?:\\^)");t("CARETTRIM",`(\\s*)${f[y.LONECARET]}\\s+`,!0);a6.caretTrimReplace="$1^";t("CARET",`^${f[y.LONECARET]}${f[y.XRANGEPLAIN]}$`);t("CARETLOOSE",`^${f[y.LONECARET]}${f[y.XRANGEPLAINLOOSE]}$`);t("COMPARATORLOOSE",`^${f[y.GTLT]}\\s*(${f[y.LOOSEPLAIN]})$|^$`);t("COMPARATOR",`^${f[y.GTLT]}\\s*(${f[y.FULLPLAIN]})$|^$`);t("COMPARATORTRIM",`(\\s*)${f[y.GTLT]}\\s*(${f[y.LOOSEPLAIN]}|${f[y.XRANGEPLAIN]})`,!0);a6.comparatorTrimReplace="$1$2$3";t("HYPHENRANGE",`^\\s*(${f[y.XRANGEPLAIN]})\\s+-\\s+(${f[y.XRANGEPLAIN]})\\s*$`);t("HYPHENRANGELOOSE",`^\\s*(${f[y.XRANGEPLAINLOOSE]})\\s+-\\s+(${f[y.XRANGEPLAINLOOSE]})\\s*$`);t("STAR","(<|>)?=?\\s*\\*");t("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");t("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var C9=j((co,vz)=>{var lP=Object.freeze({loose:!0}),nP=Object.freeze({}),oP=(Z)=>{if(!Z)return nP;if(typeof Z!=="object")return lP;return Z};vz.exports=oP});var b5=j((io,mz)=>{var dz=/^[0-9]+$/,hz=(Z,$)=>{let Y=dz.test(Z),Q=dz.test($);if(Y&&Q)Z=+Z,$=+$;return Z===$?0:Y&&!Q?-1:Q&&!Y?1:Z<$?-1:1},tP=(Z,$)=>hz($,Z);mz.exports={compareIdentifiers:hz,rcompareIdentifiers:tP}});var N0=j((lo,iz)=>{var V9=tZ(),{MAX_LENGTH:uz,MAX_SAFE_INTEGER:E9}=oZ(),{safeRe:pz,safeSrc:cz,t:I9}=UZ(),sP=C9(),{compareIdentifiers:wZ}=b5();class m6{constructor(Z,$){if($=sP($),Z instanceof m6)if(Z.loose===!!$.loose&&Z.includePrerelease===!!$.includePrerelease)return Z;else Z=Z.version;else if(typeof Z!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof Z}".`);if(Z.length>uz)throw new TypeError(`version is longer than ${uz} characters`);V9("SemVer",Z,$),this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease;let Y=Z.trim().match($.loose?pz[I9.LOOSE]:pz[I9.FULL]);if(!Y)throw new TypeError(`Invalid Version: ${Z}`);if(this.raw=Z,this.major=+Y[1],this.minor=+Y[2],this.patch=+Y[3],this.major>E9||this.major<0)throw new TypeError("Invalid major version");if(this.minor>E9||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>E9||this.patch<0)throw new TypeError("Invalid patch version");if(!Y[4])this.prerelease=[];else this.prerelease=Y[4].split(".").map((Q)=>{if(/^[0-9]+$/.test(Q)){let X=+Q;if(X>=0&&X<E9)return X}return Q});this.build=Y[5]?Y[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare(Z){if(V9("SemVer.compare",this.version,this.options,Z),!(Z instanceof m6)){if(typeof Z==="string"&&Z===this.version)return 0;Z=new m6(Z,this.options)}if(Z.version===this.version)return 0;return this.compareMain(Z)||this.comparePre(Z)}compareMain(Z){if(!(Z instanceof m6))Z=new m6(Z,this.options);return wZ(this.major,Z.major)||wZ(this.minor,Z.minor)||wZ(this.patch,Z.patch)}comparePre(Z){if(!(Z instanceof m6))Z=new m6(Z,this.options);if(this.prerelease.length&&!Z.prerelease.length)return-1;else if(!this.prerelease.length&&Z.prerelease.length)return 1;else if(!this.prerelease.length&&!Z.prerelease.length)return 0;let $=0;do{let Y=this.prerelease[$],Q=Z.prerelease[$];if(V9("prerelease compare",$,Y,Q),Y===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(Y===void 0)return-1;else if(Y===Q)continue;else return wZ(Y,Q)}while(++$)}compareBuild(Z){if(!(Z instanceof m6))Z=new m6(Z,this.options);let $=0;do{let Y=this.build[$],Q=Z.build[$];if(V9("build compare",$,Y,Q),Y===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(Y===void 0)return-1;else if(Y===Q)continue;else return wZ(Y,Q)}while(++$)}inc(Z,$,Y){if(Z.startsWith("pre")){if(!$&&Y===!1)throw new Error("invalid increment argument: identifier is empty");if($){let Q=new RegExp(`^${this.options.loose?cz[I9.PRERELEASELOOSE]:cz[I9.PRERELEASE]}$`),X=`-${$}`.match(Q);if(!X||X[1]!==$)throw new Error(`invalid identifier: ${$}`)}}switch(Z){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",$,Y);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",$,Y);break;case"prepatch":this.prerelease.length=0,this.inc("patch",$,Y),this.inc("pre",$,Y);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",$,Y);this.inc("pre",$,Y);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let Q=Number(Y)?1:0;if(this.prerelease.length===0)this.prerelease=[Q];else{let X=this.prerelease.length;while(--X>=0)if(typeof this.prerelease[X]==="number")this.prerelease[X]++,X=-2;if(X===-1){if($===this.prerelease.join(".")&&Y===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Q)}}if($){let X=[$,Q];if(Y===!1)X=[$];if(wZ(this.prerelease[0],$)===0){if(isNaN(this.prerelease[1]))this.prerelease=X}else this.prerelease=X}break}default:throw new Error(`invalid increment argument: ${Z}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}iz.exports=m6});var O4=j((no,nz)=>{var lz=N0(),rP=(Z,$,Y=!1)=>{if(Z instanceof lz)return Z;try{return new lz(Z,$)}catch(Q){if(!Y)return null;throw Q}};nz.exports=rP});var tz=j((oo,oz)=>{var aP=O4(),eP=(Z,$)=>{let Y=aP(Z,$);return Y?Y.version:null};oz.exports=eP});var rz=j((to,sz)=>{var Zj=O4(),$j=(Z,$)=>{let Y=Zj(Z.trim().replace(/^[=v]+/,""),$);return Y?Y.version:null};sz.exports=$j});var Z2=j((so,ez)=>{var az=N0(),Yj=(Z,$,Y,Q,X)=>{if(typeof Y==="string")X=Q,Q=Y,Y=void 0;try{return new az(Z instanceof az?Z.version:Z,Y).inc($,Q,X).version}catch(W){return null}};ez.exports=Yj});var Q2=j((ro,Y2)=>{var $2=O4(),Qj=(Z,$)=>{let Y=$2(Z,null,!0),Q=$2($,null,!0),X=Y.compare(Q);if(X===0)return null;let W=X>0,J=W?Y:Q,z=W?Q:Y,q=!!J.prerelease.length;if(!!z.prerelease.length&&!q){if(!z.patch&&!z.minor)return"major";if(z.compareMain(J)===0){if(z.minor&&!z.patch)return"minor";return"patch"}}let w=q?"pre":"";if(Y.major!==Q.major)return w+"major";if(Y.minor!==Q.minor)return w+"minor";if(Y.patch!==Q.patch)return w+"patch";return"prerelease"};Y2.exports=Qj});var W2=j((ao,X2)=>{var Xj=N0(),Wj=(Z,$)=>new Xj(Z,$).major;X2.exports=Wj});var z2=j((eo,J2)=>{var Jj=N0(),zj=(Z,$)=>new Jj(Z,$).minor;J2.exports=zj});var U2=j((Zt,q2)=>{var qj=N0(),Uj=(Z,$)=>new qj(Z,$).patch;q2.exports=Uj});var M2=j(($t,w2)=>{var wj=O4(),Mj=(Z,$)=>{let Y=wj(Z,$);return Y&&Y.prerelease.length?Y.prerelease:null};w2.exports=Mj});var H6=j((Yt,B2)=>{var G2=N0(),Gj=(Z,$,Y)=>new G2(Z,Y).compare(new G2($,Y));B2.exports=Gj});var H2=j((Qt,S2)=>{var Bj=H6(),Sj=(Z,$,Y)=>Bj($,Z,Y);S2.exports=Sj});var A2=j((Xt,D2)=>{var Hj=H6(),Dj=(Z,$)=>Hj(Z,$,!0);D2.exports=Dj});var x9=j((Wt,L2)=>{var N2=N0(),Aj=(Z,$,Y)=>{let Q=new N2(Z,Y),X=new N2($,Y);return Q.compare(X)||Q.compareBuild(X)};L2.exports=Aj});var F2=j((Jt,O2)=>{var Nj=x9(),Lj=(Z,$)=>Z.sort((Y,Q)=>Nj(Y,Q,$));O2.exports=Lj});var P2=j((zt,K2)=>{var Oj=x9(),Fj=(Z,$)=>Z.sort((Y,Q)=>Oj(Q,Y,$));K2.exports=Fj});var sZ=j((qt,j2)=>{var Kj=H6(),Pj=(Z,$,Y)=>Kj(Z,$,Y)>0;j2.exports=Pj});var T9=j((Ut,R2)=>{var jj=H6(),Rj=(Z,$,Y)=>jj(Z,$,Y)<0;R2.exports=Rj});var k5=j((wt,_2)=>{var _j=H6(),Cj=(Z,$,Y)=>_j(Z,$,Y)===0;_2.exports=Cj});var g5=j((Mt,C2)=>{var Vj=H6(),Ej=(Z,$,Y)=>Vj(Z,$,Y)!==0;C2.exports=Ej});var b9=j((Gt,V2)=>{var Ij=H6(),xj=(Z,$,Y)=>Ij(Z,$,Y)>=0;V2.exports=xj});var k9=j((Bt,E2)=>{var Tj=H6(),bj=(Z,$,Y)=>Tj(Z,$,Y)<=0;E2.exports=bj});var f5=j((St,I2)=>{var kj=k5(),gj=g5(),fj=sZ(),yj=b9(),vj=T9(),dj=k9(),hj=(Z,$,Y,Q)=>{switch($){case"===":if(typeof Z==="object")Z=Z.version;if(typeof Y==="object")Y=Y.version;return Z===Y;case"!==":if(typeof Z==="object")Z=Z.version;if(typeof Y==="object")Y=Y.version;return Z!==Y;case"":case"=":case"==":return kj(Z,Y,Q);case"!=":return gj(Z,Y,Q);case">":return fj(Z,Y,Q);case">=":return yj(Z,Y,Q);case"<":return vj(Z,Y,Q);case"<=":return dj(Z,Y,Q);default:throw new TypeError(`Invalid operator: ${$}`)}};I2.exports=hj});var T2=j((Ht,x2)=>{var mj=N0(),uj=O4(),{safeRe:g9,t:f9}=UZ(),pj=(Z,$)=>{if(Z instanceof mj)return Z;if(typeof Z==="number")Z=String(Z);if(typeof Z!=="string")return null;$=$||{};let Y=null;if(!$.rtl)Y=Z.match($.includePrerelease?g9[f9.COERCEFULL]:g9[f9.COERCE]);else{let q=$.includePrerelease?g9[f9.COERCERTLFULL]:g9[f9.COERCERTL],U;while((U=q.exec(Z))&&(!Y||Y.index+Y[0].length!==Z.length)){if(!Y||U.index+U[0].length!==Y.index+Y[0].length)Y=U;q.lastIndex=U.index+U[1].length+U[2].length}q.lastIndex=-1}if(Y===null)return null;let Q=Y[2],X=Y[3]||"0",W=Y[4]||"0",J=$.includePrerelease&&Y[5]?`-${Y[5]}`:"",z=$.includePrerelease&&Y[6]?`+${Y[6]}`:"";return uj(`${Q}.${X}.${W}${J}${z}`,$)};x2.exports=pj});var g2=j((Dt,k2)=>{class b2{constructor(){this.max=1000,this.map=new Map}get(Z){let $=this.map.get(Z);if($===void 0)return;else return this.map.delete(Z),this.map.set(Z,$),$}delete(Z){return this.map.delete(Z)}set(Z,$){if(!this.delete(Z)&&$!==void 0){if(this.map.size>=this.max){let Q=this.map.keys().next().value;this.delete(Q)}this.map.set(Z,$)}return this}}k2.exports=b2});var D6=j((At,d2)=>{var cj=/\s+/g;class rZ{constructor(Z,$){if($=lj($),Z instanceof rZ)if(Z.loose===!!$.loose&&Z.includePrerelease===!!$.includePrerelease)return Z;else return new rZ(Z.raw,$);if(Z instanceof y5)return this.raw=Z.value,this.set=[[Z]],this.formatted=void 0,this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=Z.trim().replace(cj," "),this.set=this.raw.split("||").map((Y)=>this.parseRange(Y.trim())).filter((Y)=>Y.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let Y=this.set[0];if(this.set=this.set.filter((Q)=>!y2(Q[0])),this.set.length===0)this.set=[Y];else if(this.set.length>1){for(let Q of this.set)if(Q.length===1&&ej(Q[0])){this.set=[Q];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let Z=0;Z<this.set.length;Z++){if(Z>0)this.formatted+="||";let $=this.set[Z];for(let Y=0;Y<$.length;Y++){if(Y>0)this.formatted+=" ";this.formatted+=$[Y].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(Z){let Y=((this.options.includePrerelease&&rj)|(this.options.loose&&aj))+":"+Z,Q=f2.get(Y);if(Q)return Q;let X=this.options.loose,W=X?h0[P0.HYPHENRANGELOOSE]:h0[P0.HYPHENRANGE];Z=Z.replace(W,UR(this.options.includePrerelease)),y1("hyphen replace",Z),Z=Z.replace(h0[P0.COMPARATORTRIM],oj),y1("comparator trim",Z),Z=Z.replace(h0[P0.TILDETRIM],tj),y1("tilde trim",Z),Z=Z.replace(h0[P0.CARETTRIM],sj),y1("caret trim",Z);let J=Z.split(" ").map((w)=>ZR(w,this.options)).join(" ").split(/\s+/).map((w)=>qR(w,this.options));if(X)J=J.filter((w)=>{return y1("loose invalid filter",w,this.options),!!w.match(h0[P0.COMPARATORLOOSE])});y1("range list",J);let z=new Map,q=J.map((w)=>new y5(w,this.options));for(let w of q){if(y2(w))return[w];z.set(w.value,w)}if(z.size>1&&z.has(""))z.delete("");let U=[...z.values()];return f2.set(Y,U),U}intersects(Z,$){if(!(Z instanceof rZ))throw new TypeError("a Range is required");return this.set.some((Y)=>{return v2(Y,$)&&Z.set.some((Q)=>{return v2(Q,$)&&Y.every((X)=>{return Q.every((W)=>{return X.intersects(W,$)})})})})}test(Z){if(!Z)return!1;if(typeof Z==="string")try{Z=new nj(Z,this.options)}catch($){return!1}for(let $=0;$<this.set.length;$++)if(wR(this.set[$],Z,this.options))return!0;return!1}}d2.exports=rZ;var ij=g2(),f2=new ij,lj=C9(),y5=aZ(),y1=tZ(),nj=N0(),{safeRe:h0,t:P0,comparatorTrimReplace:oj,tildeTrimReplace:tj,caretTrimReplace:sj}=UZ(),{FLAG_INCLUDE_PRERELEASE:rj,FLAG_LOOSE:aj}=oZ(),y2=(Z)=>Z.value==="<0.0.0-0",ej=(Z)=>Z.value==="",v2=(Z,$)=>{let Y=!0,Q=Z.slice(),X=Q.pop();while(Y&&Q.length)Y=Q.every((W)=>{return X.intersects(W,$)}),X=Q.pop();return Y},ZR=(Z,$)=>{return y1("comp",Z,$),Z=QR(Z,$),y1("caret",Z),Z=$R(Z,$),y1("tildes",Z),Z=WR(Z,$),y1("xrange",Z),Z=zR(Z,$),y1("stars",Z),Z},j0=(Z)=>!Z||Z.toLowerCase()==="x"||Z==="*",$R=(Z,$)=>{return Z.trim().split(/\s+/).map((Y)=>YR(Y,$)).join(" ")},YR=(Z,$)=>{let Y=$.loose?h0[P0.TILDELOOSE]:h0[P0.TILDE];return Z.replace(Y,(Q,X,W,J,z)=>{y1("tilde",Z,Q,X,W,J,z);let q;if(j0(X))q="";else if(j0(W))q=`>=${X}.0.0 <${+X+1}.0.0-0`;else if(j0(J))q=`>=${X}.${W}.0 <${X}.${+W+1}.0-0`;else if(z)y1("replaceTilde pr",z),q=`>=${X}.${W}.${J}-${z} <${X}.${+W+1}.0-0`;else q=`>=${X}.${W}.${J} <${X}.${+W+1}.0-0`;return y1("tilde return",q),q})},QR=(Z,$)=>{return Z.trim().split(/\s+/).map((Y)=>XR(Y,$)).join(" ")},XR=(Z,$)=>{y1("caret",Z,$);let Y=$.loose?h0[P0.CARETLOOSE]:h0[P0.CARET],Q=$.includePrerelease?"-0":"";return Z.replace(Y,(X,W,J,z,q)=>{y1("caret",Z,X,W,J,z,q);let U;if(j0(W))U="";else if(j0(J))U=`>=${W}.0.0${Q} <${+W+1}.0.0-0`;else if(j0(z))if(W==="0")U=`>=${W}.${J}.0${Q} <${W}.${+J+1}.0-0`;else U=`>=${W}.${J}.0${Q} <${+W+1}.0.0-0`;else if(q)if(y1("replaceCaret pr",q),W==="0")if(J==="0")U=`>=${W}.${J}.${z}-${q} <${W}.${J}.${+z+1}-0`;else U=`>=${W}.${J}.${z}-${q} <${W}.${+J+1}.0-0`;else U=`>=${W}.${J}.${z}-${q} <${+W+1}.0.0-0`;else if(y1("no pr"),W==="0")if(J==="0")U=`>=${W}.${J}.${z}${Q} <${W}.${J}.${+z+1}-0`;else U=`>=${W}.${J}.${z}${Q} <${W}.${+J+1}.0-0`;else U=`>=${W}.${J}.${z} <${+W+1}.0.0-0`;return y1("caret return",U),U})},WR=(Z,$)=>{return y1("replaceXRanges",Z,$),Z.split(/\s+/).map((Y)=>JR(Y,$)).join(" ")},JR=(Z,$)=>{Z=Z.trim();let Y=$.loose?h0[P0.XRANGELOOSE]:h0[P0.XRANGE];return Z.replace(Y,(Q,X,W,J,z,q)=>{y1("xRange",Z,Q,X,W,J,z,q);let U=j0(W),w=U||j0(J),M=w||j0(z),S=M;if(X==="="&&S)X="";if(q=$.includePrerelease?"-0":"",U)if(X===">"||X==="<")Q="<0.0.0-0";else Q="*";else if(X&&S){if(w)J=0;if(z=0,X===">")if(X=">=",w)W=+W+1,J=0,z=0;else J=+J+1,z=0;else if(X==="<=")if(X="<",w)W=+W+1;else J=+J+1;if(X==="<")q="-0";Q=`${X+W}.${J}.${z}${q}`}else if(w)Q=`>=${W}.0.0${q} <${+W+1}.0.0-0`;else if(M)Q=`>=${W}.${J}.0${q} <${W}.${+J+1}.0-0`;return y1("xRange return",Q),Q})},zR=(Z,$)=>{return y1("replaceStars",Z,$),Z.trim().replace(h0[P0.STAR],"")},qR=(Z,$)=>{return y1("replaceGTE0",Z,$),Z.trim().replace(h0[$.includePrerelease?P0.GTE0PRE:P0.GTE0],"")},UR=(Z)=>($,Y,Q,X,W,J,z,q,U,w,M,S)=>{if(j0(Q))Y="";else if(j0(X))Y=`>=${Q}.0.0${Z?"-0":""}`;else if(j0(W))Y=`>=${Q}.${X}.0${Z?"-0":""}`;else if(J)Y=`>=${Y}`;else Y=`>=${Y}${Z?"-0":""}`;if(j0(U))q="";else if(j0(w))q=`<${+U+1}.0.0-0`;else if(j0(M))q=`<${U}.${+w+1}.0-0`;else if(S)q=`<=${U}.${w}.${M}-${S}`;else if(Z)q=`<${U}.${w}.${+M+1}-0`;else q=`<=${q}`;return`${Y} ${q}`.trim()},wR=(Z,$,Y)=>{for(let Q=0;Q<Z.length;Q++)if(!Z[Q].test($))return!1;if($.prerelease.length&&!Y.includePrerelease){for(let Q=0;Q<Z.length;Q++){if(y1(Z[Q].semver),Z[Q].semver===y5.ANY)continue;if(Z[Q].semver.prerelease.length>0){let X=Z[Q].semver;if(X.major===$.major&&X.minor===$.minor&&X.patch===$.patch)return!0}}return!1}return!0}});var aZ=j((Nt,i2)=>{var eZ=Symbol("SemVer ANY");class y9{static get ANY(){return eZ}constructor(Z,$){if($=h2($),Z instanceof y9)if(Z.loose===!!$.loose)return Z;else Z=Z.value;if(Z=Z.trim().split(/\s+/).join(" "),d5("comparator",Z,$),this.options=$,this.loose=!!$.loose,this.parse(Z),this.semver===eZ)this.value="";else this.value=this.operator+this.semver.version;d5("comp",this)}parse(Z){let $=this.options.loose?m2[u2.COMPARATORLOOSE]:m2[u2.COMPARATOR],Y=Z.match($);if(!Y)throw new TypeError(`Invalid comparator: ${Z}`);if(this.operator=Y[1]!==void 0?Y[1]:"",this.operator==="=")this.operator="";if(!Y[2])this.semver=eZ;else this.semver=new p2(Y[2],this.options.loose)}toString(){return this.value}test(Z){if(d5("Comparator.test",Z,this.options.loose),this.semver===eZ||Z===eZ)return!0;if(typeof Z==="string")try{Z=new p2(Z,this.options)}catch($){return!1}return v5(Z,this.operator,this.semver,this.options)}intersects(Z,$){if(!(Z instanceof y9))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new c2(Z.value,$).test(this.value)}else if(Z.operator===""){if(Z.value==="")return!0;return new c2(this.value,$).test(Z.semver)}if($=h2($),$.includePrerelease&&(this.value==="<0.0.0-0"||Z.value==="<0.0.0-0"))return!1;if(!$.includePrerelease&&(this.value.startsWith("<0.0.0")||Z.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&Z.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&Z.operator.startsWith("<"))return!0;if(this.semver.version===Z.semver.version&&this.operator.includes("=")&&Z.operator.includes("="))return!0;if(v5(this.semver,"<",Z.semver,$)&&this.operator.startsWith(">")&&Z.operator.startsWith("<"))return!0;if(v5(this.semver,">",Z.semver,$)&&this.operator.startsWith("<")&&Z.operator.startsWith(">"))return!0;return!1}}i2.exports=y9;var h2=C9(),{safeRe:m2,t:u2}=UZ(),v5=f5(),d5=tZ(),p2=N0(),c2=D6()});var Z$=j((Lt,l2)=>{var MR=D6(),GR=(Z,$,Y)=>{try{$=new MR($,Y)}catch(Q){return!1}return $.test(Z)};l2.exports=GR});var o2=j((Ot,n2)=>{var BR=D6(),SR=(Z,$)=>new BR(Z,$).set.map((Y)=>Y.map((Q)=>Q.value).join(" ").trim().split(" "));n2.exports=SR});var s2=j((Ft,t2)=>{var HR=N0(),DR=D6(),AR=(Z,$,Y)=>{let Q=null,X=null,W=null;try{W=new DR($,Y)}catch(J){return null}return Z.forEach((J)=>{if(W.test(J)){if(!Q||X.compare(J)===-1)Q=J,X=new HR(Q,Y)}}),Q};t2.exports=AR});var a2=j((Kt,r2)=>{var NR=N0(),LR=D6(),OR=(Z,$,Y)=>{let Q=null,X=null,W=null;try{W=new LR($,Y)}catch(J){return null}return Z.forEach((J)=>{if(W.test(J)){if(!Q||X.compare(J)===1)Q=J,X=new NR(Q,Y)}}),Q};r2.exports=OR});var $q=j((Pt,Zq)=>{var h5=N0(),FR=D6(),e2=sZ(),KR=(Z,$)=>{Z=new FR(Z,$);let Y=new h5("0.0.0");if(Z.test(Y))return Y;if(Y=new h5("0.0.0-0"),Z.test(Y))return Y;Y=null;for(let Q=0;Q<Z.set.length;++Q){let X=Z.set[Q],W=null;if(X.forEach((J)=>{let z=new h5(J.semver.version);switch(J.operator){case">":if(z.prerelease.length===0)z.patch++;else z.prerelease.push(0);z.raw=z.format();case"":case">=":if(!W||e2(z,W))W=z;break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${J.operator}`)}}),W&&(!Y||e2(Y,W)))Y=W}if(Y&&Z.test(Y))return Y;return null};Zq.exports=KR});var Qq=j((jt,Yq)=>{var PR=D6(),jR=(Z,$)=>{try{return new PR(Z,$).range||"*"}catch(Y){return null}};Yq.exports=jR});var v9=j((Rt,zq)=>{var RR=N0(),Jq=aZ(),{ANY:_R}=Jq,CR=D6(),VR=Z$(),Xq=sZ(),Wq=T9(),ER=k9(),IR=b9(),xR=(Z,$,Y,Q)=>{Z=new RR(Z,Q),$=new CR($,Q);let X,W,J,z,q;switch(Y){case">":X=Xq,W=ER,J=Wq,z=">",q=">=";break;case"<":X=Wq,W=IR,J=Xq,z="<",q="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(VR(Z,$,Q))return!1;for(let U=0;U<$.set.length;++U){let w=$.set[U],M=null,S=null;if(w.forEach((G)=>{if(G.semver===_R)G=new Jq(">=0.0.0");if(M=M||G,S=S||G,X(G.semver,M.semver,Q))M=G;else if(J(G.semver,S.semver,Q))S=G}),M.operator===z||M.operator===q)return!1;if((!S.operator||S.operator===z)&&W(Z,S.semver))return!1;else if(S.operator===q&&J(Z,S.semver))return!1}return!0};zq.exports=xR});var Uq=j((_t,qq)=>{var TR=v9(),bR=(Z,$,Y)=>TR(Z,$,">",Y);qq.exports=bR});var Mq=j((Ct,wq)=>{var kR=v9(),gR=(Z,$,Y)=>kR(Z,$,"<",Y);wq.exports=gR});var Sq=j((Vt,Bq)=>{var Gq=D6(),fR=(Z,$,Y)=>{return Z=new Gq(Z,Y),$=new Gq($,Y),Z.intersects($,Y)};Bq.exports=fR});var Dq=j((Et,Hq)=>{var yR=Z$(),vR=H6();Hq.exports=(Z,$,Y)=>{let Q=[],X=null,W=null,J=Z.sort((w,M)=>vR(w,M,Y));for(let w of J)if(yR(w,$,Y)){if(W=w,!X)X=w}else{if(W)Q.push([X,W]);W=null,X=null}if(X)Q.push([X,null]);let z=[];for(let[w,M]of Q)if(w===M)z.push(w);else if(!M&&w===J[0])z.push("*");else if(!M)z.push(`>=${w}`);else if(w===J[0])z.push(`<=${M}`);else z.push(`${w} - ${M}`);let q=z.join(" || "),U=typeof $.raw==="string"?$.raw:String($);return q.length<U.length?q:$}});var Kq=j((It,Fq)=>{var Aq=D6(),u5=aZ(),{ANY:m5}=u5,$$=Z$(),p5=H6(),dR=(Z,$,Y={})=>{if(Z===$)return!0;Z=new Aq(Z,Y),$=new Aq($,Y);let Q=!1;Z:for(let X of Z.set){for(let W of $.set){let J=mR(X,W,Y);if(Q=Q||J!==null,J)continue Z}if(Q)return!1}return!0},hR=[new u5(">=0.0.0-0")],Nq=[new u5(">=0.0.0")],mR=(Z,$,Y)=>{if(Z===$)return!0;if(Z.length===1&&Z[0].semver===m5)if($.length===1&&$[0].semver===m5)return!0;else if(Y.includePrerelease)Z=hR;else Z=Nq;if($.length===1&&$[0].semver===m5)if(Y.includePrerelease)return!0;else $=Nq;let Q=new Set,X,W;for(let G of Z)if(G.operator===">"||G.operator===">=")X=Lq(X,G,Y);else if(G.operator==="<"||G.operator==="<=")W=Oq(W,G,Y);else Q.add(G.semver);if(Q.size>1)return null;let J;if(X&&W){if(J=p5(X.semver,W.semver,Y),J>0)return null;else if(J===0&&(X.operator!==">="||W.operator!=="<="))return null}for(let G of Q){if(X&&!$$(G,String(X),Y))return null;if(W&&!$$(G,String(W),Y))return null;for(let L of $)if(!$$(G,String(L),Y))return!1;return!0}let z,q,U,w,M=W&&!Y.includePrerelease&&W.semver.prerelease.length?W.semver:!1,S=X&&!Y.includePrerelease&&X.semver.prerelease.length?X.semver:!1;if(M&&M.prerelease.length===1&&W.operator==="<"&&M.prerelease[0]===0)M=!1;for(let G of $){if(w=w||G.operator===">"||G.operator===">=",U=U||G.operator==="<"||G.operator==="<=",X){if(S){if(G.semver.prerelease&&G.semver.prerelease.length&&G.semver.major===S.major&&G.semver.minor===S.minor&&G.semver.patch===S.patch)S=!1}if(G.operator===">"||G.operator===">="){if(z=Lq(X,G,Y),z===G&&z!==X)return!1}else if(X.operator===">="&&!$$(X.semver,String(G),Y))return!1}if(W){if(M){if(G.semver.prerelease&&G.semver.prerelease.length&&G.semver.major===M.major&&G.semver.minor===M.minor&&G.semver.patch===M.patch)M=!1}if(G.operator==="<"||G.operator==="<="){if(q=Oq(W,G,Y),q===G&&q!==W)return!1}else if(W.operator==="<="&&!$$(W.semver,String(G),Y))return!1}if(!G.operator&&(W||X)&&J!==0)return!1}if(X&&U&&!W&&J!==0)return!1;if(W&&w&&!X&&J!==0)return!1;if(S||M)return!1;return!0},Lq=(Z,$,Y)=>{if(!Z)return $;let Q=p5(Z.semver,$.semver,Y);return Q>0?Z:Q<0?$:$.operator===">"&&Z.operator===">="?$:Z},Oq=(Z,$,Y)=>{if(!Z)return $;let Q=p5(Z.semver,$.semver,Y);return Q<0?Z:Q>0?$:$.operator==="<"&&Z.operator==="<="?$:Z};Fq.exports=dR});var d9=j((xt,Rq)=>{var c5=UZ(),Pq=oZ(),uR=N0(),jq=b5(),pR=O4(),cR=tz(),iR=rz(),lR=Z2(),nR=Q2(),oR=W2(),tR=z2(),sR=U2(),rR=M2(),aR=H6(),eR=H2(),Z_=A2(),$_=x9(),Y_=F2(),Q_=P2(),X_=sZ(),W_=T9(),J_=k5(),z_=g5(),q_=b9(),U_=k9(),w_=f5(),M_=T2(),G_=aZ(),B_=D6(),S_=Z$(),H_=o2(),D_=s2(),A_=a2(),N_=$q(),L_=Qq(),O_=v9(),F_=Uq(),K_=Mq(),P_=Sq(),j_=Dq(),R_=Kq();Rq.exports={parse:pR,valid:cR,clean:iR,inc:lR,diff:nR,major:oR,minor:tR,patch:sR,prerelease:rR,compare:aR,rcompare:eR,compareLoose:Z_,compareBuild:$_,sort:Y_,rsort:Q_,gt:X_,lt:W_,eq:J_,neq:z_,gte:q_,lte:U_,cmp:w_,coerce:M_,Comparator:G_,Range:B_,satisfies:S_,toComparators:H_,maxSatisfying:D_,minSatisfying:A_,minVersion:N_,validRange:L_,outside:O_,gtr:F_,ltr:K_,intersects:P_,simplifyRange:j_,subset:R_,SemVer:uR,re:c5.re,src:c5.src,tokens:c5.t,SEMVER_SPEC_VERSION:Pq.SEMVER_SPEC_VERSION,RELEASE_TYPES:Pq.RELEASE_TYPES,compareIdentifiers:jq.compareIdentifiers,rcompareIdentifiers:jq.rcompareIdentifiers}});var Cq=j((Tt,_q)=>{var __=d9();_q.exports=__.satisfies(process.version,">=15.7.0")});var Eq=j((bt,Vq)=>{var C_=d9();Vq.exports=C_.satisfies(process.version,">=16.9.0")});var i5=j((kt,Iq)=>{var V_=Cq(),E_=Eq(),I_={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},x_={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Iq.exports=function(Z,$){if(!Z||!$)return;let Y=$.asymmetricKeyType;if(!Y)return;let Q=I_[Y];if(!Q)throw new Error(`Unknown key type "${Y}".`);if(!Q.includes(Z))throw new Error(`"alg" parameter for "${Y}" key type must be one of: ${Q.join(", ")}.`);if(V_)switch(Y){case"ec":let X=$.asymmetricKeyDetails.namedCurve,W=x_[Z];if(X!==W)throw new Error(`"alg" parameter "${Z}" requires curve "${W}".`);break;case"rsa-pss":if(E_){let J=parseInt(Z.slice(-3),10),{hashAlgorithm:z,mgf1HashAlgorithm:q,saltLength:U}=$.asymmetricKeyDetails;if(z!==`sha${J}`||q!==z)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${Z}.`);if(U!==void 0&&U>J>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${Z}.`)}break}}});var l5=j((gt,xq)=>{var T_=d9();xq.exports=T_.satisfies(process.version,"^6.12.0 || >=8.0.0")});var kq=j((ft,bq)=>{var T1=nZ(),b_=C5(),Tq=V5(),k_=_5(),g_=I5(),f_=i5(),y_=l5(),v_=K9(),{KeyObject:d_,createSecretKey:h_,createPublicKey:m_}=z1("crypto"),n5=["RS256","RS384","RS512"],u_=["ES256","ES384","ES512"],o5=["RS256","RS384","RS512"],p_=["HS256","HS384","HS512"];if(y_)n5.splice(n5.length,0,"PS256","PS384","PS512"),o5.splice(o5.length,0,"PS256","PS384","PS512");bq.exports=function(Z,$,Y,Q){if(typeof Y==="function"&&!Q)Q=Y,Y={};if(!Y)Y={};Y=Object.assign({},Y);let X;if(Q)X=Q;else X=function(w,M){if(w)throw w;return M};if(Y.clockTimestamp&&typeof Y.clockTimestamp!=="number")return X(new T1("clockTimestamp must be a number"));if(Y.nonce!==void 0&&(typeof Y.nonce!=="string"||Y.nonce.trim()===""))return X(new T1("nonce must be a non-empty string"));if(Y.allowInvalidAsymmetricKeyTypes!==void 0&&typeof Y.allowInvalidAsymmetricKeyTypes!=="boolean")return X(new T1("allowInvalidAsymmetricKeyTypes must be a boolean"));let W=Y.clockTimestamp||Math.floor(Date.now()/1000);if(!Z)return X(new T1("jwt must be provided"));if(typeof Z!=="string")return X(new T1("jwt must be a string"));let J=Z.split(".");if(J.length!==3)return X(new T1("jwt malformed"));let z;try{z=k_(Z,{complete:!0})}catch(w){return X(w)}if(!z)return X(new T1("invalid token"));let q=z.header,U;if(typeof $==="function"){if(!Q)return X(new T1("verify must be called asynchronous if secret or public key is provided as a callback"));U=$}else U=function(w,M){return M(null,$)};return U(q,function(w,M){if(w)return X(new T1("error in secret or public key callback: "+w.message));let S=J[2].trim()!=="";if(!S&&M)return X(new T1("jwt signature is required"));if(S&&!M)return X(new T1("secret or public key must be provided"));if(!S&&!Y.algorithms)return X(new T1('please specify "none" in "algorithms" to verify unsigned tokens'));if(M!=null&&!(M instanceof d_))try{M=m_(M)}catch(B){try{M=h_(typeof M==="string"?Buffer.from(M):M)}catch(P){return X(new T1("secretOrPublicKey is not valid key material"))}}if(!Y.algorithms)if(M.type==="secret")Y.algorithms=p_;else if(["rsa","rsa-pss"].includes(M.asymmetricKeyType))Y.algorithms=o5;else if(M.asymmetricKeyType==="ec")Y.algorithms=u_;else Y.algorithms=n5;if(Y.algorithms.indexOf(z.header.alg)===-1)return X(new T1("invalid algorithm"));if(q.alg.startsWith("HS")&&M.type!=="secret")return X(new T1(`secretOrPublicKey must be a symmetric key when using ${q.alg}`));else if(/^(?:RS|PS|ES)/.test(q.alg)&&M.type!=="public")return X(new T1(`secretOrPublicKey must be an asymmetric key when using ${q.alg}`));if(!Y.allowInvalidAsymmetricKeyTypes)try{f_(q.alg,M)}catch(B){return X(B)}let G;try{G=v_.verify(Z,z.header.alg,M)}catch(B){return X(B)}if(!G)return X(new T1("invalid signature"));let L=z.payload;if(typeof L.nbf!=="undefined"&&!Y.ignoreNotBefore){if(typeof L.nbf!=="number")return X(new T1("invalid nbf value"));if(L.nbf>W+(Y.clockTolerance||0))return X(new b_("jwt not active",new Date(L.nbf*1000)))}if(typeof L.exp!=="undefined"&&!Y.ignoreExpiration){if(typeof L.exp!=="number")return X(new T1("invalid exp value"));if(W>=L.exp+(Y.clockTolerance||0))return X(new Tq("jwt expired",new Date(L.exp*1000)))}if(Y.audience){let B=Array.isArray(Y.audience)?Y.audience:[Y.audience];if(!(Array.isArray(L.aud)?L.aud:[L.aud]).some(function(n){return B.some(function(s){return s instanceof RegExp?s.test(n):s===n})}))return X(new T1("jwt audience invalid. expected: "+B.join(" or ")))}if(Y.issuer){if(typeof Y.issuer==="string"&&L.iss!==Y.issuer||Array.isArray(Y.issuer)&&Y.issuer.indexOf(L.iss)===-1)return X(new T1("jwt issuer invalid. expected: "+Y.issuer))}if(Y.subject){if(L.sub!==Y.subject)return X(new T1("jwt subject invalid. expected: "+Y.subject))}if(Y.jwtid){if(L.jti!==Y.jwtid)return X(new T1("jwt jwtid invalid. expected: "+Y.jwtid))}if(Y.nonce){if(L.nonce!==Y.nonce)return X(new T1("jwt nonce invalid. expected: "+Y.nonce))}if(Y.maxAge){if(typeof L.iat!=="number")return X(new T1("iat required when maxAge is specified"));let B=g_(Y.maxAge,L.iat);if(typeof B==="undefined")return X(new T1('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(W>=B+(Y.clockTolerance||0))return X(new Tq("maxAge exceeded",new Date(B*1000)))}if(Y.complete===!0){let B=z.signature;return X(null,{header:q,payload:L,signature:B})}return X(null,L)})}});var hq=j((yt,dq)=>{var gq=1/0,yq=9007199254740991,c_=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,fq=NaN,i_="[object Arguments]",l_="[object Function]",n_="[object GeneratorFunction]",o_="[object String]",t_="[object Symbol]",s_=/^\s+|\s+$/g,r_=/^[-+]0x[0-9a-f]+$/i,a_=/^0b[01]+$/i,e_=/^0o[0-7]+$/i,ZC=/^(?:0|[1-9]\d*)$/,$C=parseInt;function YC(Z,$){var Y=-1,Q=Z?Z.length:0,X=Array(Q);while(++Y<Q)X[Y]=$(Z[Y],Y,Z);return X}function QC(Z,$,Y,Q){var X=Z.length,W=Y+(Q?1:-1);while(Q?W--:++W<X)if($(Z[W],W,Z))return W;return-1}function XC(Z,$,Y){if($!==$)return QC(Z,WC,Y);var Q=Y-1,X=Z.length;while(++Q<X)if(Z[Q]===$)return Q;return-1}function WC(Z){return Z!==Z}function JC(Z,$){var Y=-1,Q=Array(Z);while(++Y<Z)Q[Y]=$(Y);return Q}function zC(Z,$){return YC($,function(Y){return Z[Y]})}function qC(Z,$){return function(Y){return Z($(Y))}}var h9=Object.prototype,s5=h9.hasOwnProperty,m9=h9.toString,UC=h9.propertyIsEnumerable,wC=qC(Object.keys,Object),MC=Math.max;function GC(Z,$){var Y=vq(Z)||AC(Z)?JC(Z.length,String):[],Q=Y.length,X=!!Q;for(var W in Z)if(($||s5.call(Z,W))&&!(X&&(W=="length"||SC(W,Q))))Y.push(W);return Y}function BC(Z){if(!HC(Z))return wC(Z);var $=[];for(var Y in Object(Z))if(s5.call(Z,Y)&&Y!="constructor")$.push(Y);return $}function SC(Z,$){return $=$==null?yq:$,!!$&&(typeof Z=="number"||ZC.test(Z))&&(Z>-1&&Z%1==0&&Z<$)}function HC(Z){var $=Z&&Z.constructor,Y=typeof $=="function"&&$.prototype||h9;return Z===Y}function DC(Z,$,Y,Q){Z=r5(Z)?Z:CC(Z),Y=Y&&!Q?jC(Y):0;var X=Z.length;if(Y<0)Y=MC(X+Y,0);return FC(Z)?Y<=X&&Z.indexOf($,Y)>-1:!!X&&XC(Z,$,Y)>-1}function AC(Z){return NC(Z)&&s5.call(Z,"callee")&&(!UC.call(Z,"callee")||m9.call(Z)==i_)}var vq=Array.isArray;function r5(Z){return Z!=null&&OC(Z.length)&&!LC(Z)}function NC(Z){return a5(Z)&&r5(Z)}function LC(Z){var $=t5(Z)?m9.call(Z):"";return $==l_||$==n_}function OC(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=yq}function t5(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function a5(Z){return!!Z&&typeof Z=="object"}function FC(Z){return typeof Z=="string"||!vq(Z)&&a5(Z)&&m9.call(Z)==o_}function KC(Z){return typeof Z=="symbol"||a5(Z)&&m9.call(Z)==t_}function PC(Z){if(!Z)return Z===0?Z:0;if(Z=RC(Z),Z===gq||Z===-gq){var $=Z<0?-1:1;return $*c_}return Z===Z?Z:0}function jC(Z){var $=PC(Z),Y=$%1;return $===$?Y?$-Y:$:0}function RC(Z){if(typeof Z=="number")return Z;if(KC(Z))return fq;if(t5(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=t5($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(s_,"");var Y=a_.test(Z);return Y||e_.test(Z)?$C(Z.slice(2),Y?2:8):r_.test(Z)?fq:+Z}function _C(Z){return r5(Z)?GC(Z):BC(Z)}function CC(Z){return Z?zC(Z,_C(Z)):[]}dq.exports=DC});var uq=j((vt,mq)=>{var VC="[object Boolean]",EC=Object.prototype,IC=EC.toString;function xC(Z){return Z===!0||Z===!1||TC(Z)&&IC.call(Z)==VC}function TC(Z){return!!Z&&typeof Z=="object"}mq.exports=xC});var nq=j((dt,lq)=>{var pq=1/0,bC=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,cq=NaN,kC="[object Symbol]",gC=/^\s+|\s+$/g,fC=/^[-+]0x[0-9a-f]+$/i,yC=/^0b[01]+$/i,vC=/^0o[0-7]+$/i,dC=parseInt,hC=Object.prototype,mC=hC.toString;function uC(Z){return typeof Z=="number"&&Z==lC(Z)}function iq(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function pC(Z){return!!Z&&typeof Z=="object"}function cC(Z){return typeof Z=="symbol"||pC(Z)&&mC.call(Z)==kC}function iC(Z){if(!Z)return Z===0?Z:0;if(Z=nC(Z),Z===pq||Z===-pq){var $=Z<0?-1:1;return $*bC}return Z===Z?Z:0}function lC(Z){var $=iC(Z),Y=$%1;return $===$?Y?$-Y:$:0}function nC(Z){if(typeof Z=="number")return Z;if(cC(Z))return cq;if(iq(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=iq($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(gC,"");var Y=yC.test(Z);return Y||vC.test(Z)?dC(Z.slice(2),Y?2:8):fC.test(Z)?cq:+Z}lq.exports=uC});var tq=j((ht,oq)=>{var oC="[object Number]",tC=Object.prototype,sC=tC.toString;function rC(Z){return!!Z&&typeof Z=="object"}function aC(Z){return typeof Z=="number"||rC(Z)&&sC.call(Z)==oC}oq.exports=aC});var eq=j((mt,aq)=>{var eC="[object Object]";function ZV(Z){var $=!1;if(Z!=null&&typeof Z.toString!="function")try{$=!!(Z+"")}catch(Y){}return $}function $V(Z,$){return function(Y){return Z($(Y))}}var YV=Function.prototype,sq=Object.prototype,rq=YV.toString,QV=sq.hasOwnProperty,XV=rq.call(Object),WV=sq.toString,JV=$V(Object.getPrototypeOf,Object);function zV(Z){return!!Z&&typeof Z=="object"}function qV(Z){if(!zV(Z)||WV.call(Z)!=eC||ZV(Z))return!1;var $=JV(Z);if($===null)return!0;var Y=QV.call($,"constructor")&&$.constructor;return typeof Y=="function"&&Y instanceof Y&&rq.call(Y)==XV}aq.exports=qV});var $U=j((ut,ZU)=>{var UV="[object String]",wV=Object.prototype,MV=wV.toString,GV=Array.isArray;function BV(Z){return!!Z&&typeof Z=="object"}function SV(Z){return typeof Z=="string"||!GV(Z)&&BV(Z)&&MV.call(Z)==UV}ZU.exports=SV});var JU=j((pt,WU)=>{var HV="Expected a function",YU=1/0,DV=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,QU=NaN,AV="[object Symbol]",NV=/^\s+|\s+$/g,LV=/^[-+]0x[0-9a-f]+$/i,OV=/^0b[01]+$/i,FV=/^0o[0-7]+$/i,KV=parseInt,PV=Object.prototype,jV=PV.toString;function RV(Z,$){var Y;if(typeof $!="function")throw new TypeError(HV);return Z=IV(Z),function(){if(--Z>0)Y=$.apply(this,arguments);if(Z<=1)$=void 0;return Y}}function _V(Z){return RV(2,Z)}function XU(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function CV(Z){return!!Z&&typeof Z=="object"}function VV(Z){return typeof Z=="symbol"||CV(Z)&&jV.call(Z)==AV}function EV(Z){if(!Z)return Z===0?Z:0;if(Z=xV(Z),Z===YU||Z===-YU){var $=Z<0?-1:1;return $*DV}return Z===Z?Z:0}function IV(Z){var $=EV(Z),Y=$%1;return $===$?Y?$-Y:$:0}function xV(Z){if(typeof Z=="number")return Z;if(VV(Z))return QU;if(XU(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=XU($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(NV,"");var Y=OV.test(Z);return Y||FV.test(Z)?KV(Z.slice(2),Y?2:8):LV.test(Z)?QU:+Z}WU.exports=_V});var HU=j((ct,SU)=>{var zU=I5(),TV=l5(),bV=i5(),qU=K9(),kV=hq(),u9=uq(),UU=nq(),e5=tq(),MU=eq(),m8=$U(),gV=JU(),{KeyObject:fV,createSecretKey:yV,createPrivateKey:vV}=z1("crypto"),GU=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];if(TV)GU.splice(3,0,"PS256","PS384","PS512");var dV={expiresIn:{isValid:function(Z){return UU(Z)||m8(Z)&&Z},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(Z){return UU(Z)||m8(Z)&&Z},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(Z){return m8(Z)||Array.isArray(Z)},message:'"audience" must be a string or array'},algorithm:{isValid:kV.bind(null,GU),message:'"algorithm" must be a valid string enum value'},header:{isValid:MU,message:'"header" must be an object'},encoding:{isValid:m8,message:'"encoding" must be a string'},issuer:{isValid:m8,message:'"issuer" must be a string'},subject:{isValid:m8,message:'"subject" must be a string'},jwtid:{isValid:m8,message:'"jwtid" must be a string'},noTimestamp:{isValid:u9,message:'"noTimestamp" must be a boolean'},keyid:{isValid:m8,message:'"keyid" must be a string'},mutatePayload:{isValid:u9,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:u9,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:u9,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},hV={iat:{isValid:e5,message:'"iat" should be a number of seconds'},exp:{isValid:e5,message:'"exp" should be a number of seconds'},nbf:{isValid:e5,message:'"nbf" should be a number of seconds'}};function BU(Z,$,Y,Q){if(!MU(Y))throw new Error('Expected "'+Q+'" to be a plain object.');Object.keys(Y).forEach(function(X){let W=Z[X];if(!W){if(!$)throw new Error('"'+X+'" is not allowed in "'+Q+'"');return}if(!W.isValid(Y[X]))throw new Error(W.message)})}function mV(Z){return BU(dV,!1,Z,"options")}function uV(Z){return BU(hV,!0,Z,"payload")}var wU={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},pV=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];SU.exports=function(Z,$,Y,Q){if(typeof Y==="function")Q=Y,Y={};else Y=Y||{};let X=typeof Z==="object"&&!Buffer.isBuffer(Z),W=Object.assign({alg:Y.algorithm||"HS256",typ:X?"JWT":void 0,kid:Y.keyid},Y.header);function J(U){if(Q)return Q(U);throw U}if(!$&&Y.algorithm!=="none")return J(new Error("secretOrPrivateKey must have a value"));if($!=null&&!($ instanceof fV))try{$=vV($)}catch(U){try{$=yV(typeof $==="string"?Buffer.from($):$)}catch(w){return J(new Error("secretOrPrivateKey is not valid key material"))}}if(W.alg.startsWith("HS")&&$.type!=="secret")return J(new Error(`secretOrPrivateKey must be a symmetric key when using ${W.alg}`));else if(/^(?:RS|PS|ES)/.test(W.alg)){if($.type!=="private")return J(new Error(`secretOrPrivateKey must be an asymmetric key when using ${W.alg}`));if(!Y.allowInsecureKeySizes&&!W.alg.startsWith("ES")&&$.asymmetricKeyDetails!==void 0&&$.asymmetricKeyDetails.modulusLength<2048)return J(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${W.alg}`))}if(typeof Z==="undefined")return J(new Error("payload is required"));else if(X){try{uV(Z)}catch(U){return J(U)}if(!Y.mutatePayload)Z=Object.assign({},Z)}else{let U=pV.filter(function(w){return typeof Y[w]!=="undefined"});if(U.length>0)return J(new Error("invalid "+U.join(",")+" option for "+typeof Z+" payload"))}if(typeof Z.exp!=="undefined"&&typeof Y.expiresIn!=="undefined")return J(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof Z.nbf!=="undefined"&&typeof Y.notBefore!=="undefined")return J(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{mV(Y)}catch(U){return J(U)}if(!Y.allowInvalidAsymmetricKeyTypes)try{bV(W.alg,$)}catch(U){return J(U)}let z=Z.iat||Math.floor(Date.now()/1000);if(Y.noTimestamp)delete Z.iat;else if(X)Z.iat=z;if(typeof Y.notBefore!=="undefined"){try{Z.nbf=zU(Y.notBefore,z)}catch(U){return J(U)}if(typeof Z.nbf==="undefined")return J(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof Y.expiresIn!=="undefined"&&typeof Z==="object"){try{Z.exp=zU(Y.expiresIn,z)}catch(U){return J(U)}if(typeof Z.exp==="undefined")return J(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(wU).forEach(function(U){let w=wU[U];if(typeof Y[U]!=="undefined"){if(typeof Z[w]!=="undefined")return J(new Error('Bad "options.'+U+'" option. The payload already has an "'+w+'" property.'));Z[w]=Y[U]}});let q=Y.encoding||"utf8";if(typeof Q==="function")Q=Q&&gV(Q),qU.createSign({header:W,privateKey:$,payload:Z,encoding:q}).once("error",Q).once("done",function(U){if(!Y.allowInsecureKeySizes&&/^(?:RS|PS)/.test(W.alg)&&U.length<256)return Q(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${W.alg}`));Q(null,U)});else{let U=qU.sign({header:W,payload:Z,secret:$,encoding:q});if(!Y.allowInsecureKeySizes&&/^(?:RS|PS)/.test(W.alg)&&U.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${W.alg}`);return U}}});var AU=j((it,DU)=>{DU.exports={decode:_5(),verify:kq(),sign:HU(),JsonWebTokenError:nZ(),NotBeforeError:C5(),TokenExpiredError:V5()}});var NU=j((nt,cV)=>{cV.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var MZ=j((a0)=>{var iV=a0&&a0.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(a0,"__esModule",{value:!0});a0.getKeyIndexes=a0.hasFlag=a0.exists=a0.list=void 0;var p9=iV(NU());a0.list=Object.keys(p9.default);var ZQ={};a0.list.forEach((Z)=>{ZQ[Z]=p9.default[Z].flags.reduce(function($,Y){return $[Y]=!0,$},{})});function lV(Z){return Boolean(p9.default[Z])}a0.exists=lV;function nV(Z,$){if(!ZQ[Z])throw new Error("Unknown command "+Z);return Boolean(ZQ[Z][$])}a0.hasFlag=nV;function oV(Z,$,Y){let Q=p9.default[Z];if(!Q)throw new Error("Unknown command "+Z);if(!Array.isArray($))throw new Error("Expect args to be an array");let X=[],W=Boolean(Y&&Y.parseExternalKey),J=(q,U)=>{let w=[],M=Number(q[U]);for(let S=0;S<M;S++)w.push(S+U+1);return w},z=(q,U,w)=>{for(let M=U;M<q.length-1;M+=1)if(String(q[M]).toLowerCase()===w.toLowerCase())return M+1;return null};switch(Z){case"zunionstore":case"zinterstore":case"zdiffstore":X.push(0,...J($,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":X.push(...J($,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{X.push(...J($,0));break}case"georadius":{X.push(0);let q=z($,5,"STORE");if(q)X.push(q);let U=z($,5,"STOREDIST");if(U)X.push(U);break}case"georadiusbymember":{X.push(0);let q=z($,4,"STORE");if(q)X.push(q);let U=z($,4,"STOREDIST");if(U)X.push(U);break}case"sort":case"sort_ro":X.push(0);for(let q=1;q<$.length-1;q++){let U=$[q];if(typeof U!=="string")continue;let w=U.toUpperCase();if(w==="GET"){if(q+=1,U=$[q],U!=="#")if(W)X.push([q,LU(U)]);else X.push(q)}else if(w==="BY")if(q+=1,W)X.push([q,LU($[q])]);else X.push(q);else if(w==="STORE")q+=1,X.push(q)}break;case"migrate":if($[2]==="")for(let q=5;q<$.length-1;q++){let U=$[q];if(typeof U==="string"&&U.toUpperCase()==="KEYS"){for(let w=q+1;w<$.length;w++)X.push(w);break}}else X.push(2);break;case"xreadgroup":case"xread":for(let q=Z==="xread"?0:3;q<$.length-1;q++)if(String($[q]).toUpperCase()==="STREAMS"){for(let U=q+1;U<=q+($.length-1-q)/2;U++)X.push(U);break}break;default:if(Q.step>0){let q=Q.keyStart-1,U=Q.keyStop>0?Q.keyStop:$.length+Q.keyStop+1;for(let w=q;w<U;w+=Q.step)X.push(w)}break}return X}a0.getKeyIndexes=oV;function LU(Z){if(typeof Z!=="string")Z=String(Z);let $=Z.indexOf("->");return $===-1?Z.length:$}});var KU=j((OU)=>{Object.defineProperty(OU,"__esModule",{value:!0});OU.tryCatch=OU.errorObj=void 0;OU.errorObj={e:{}};var $Q;function tV(Z,$){try{let Y=$Q;return $Q=null,Y.apply(this,arguments)}catch(Y){return OU.errorObj.e=Y,OU.errorObj}}function sV(Z){return $Q=Z,tV}OU.tryCatch=sV});var p8=j((jU)=>{Object.defineProperty(jU,"__esModule",{value:!0});var GZ=KU();function PU(Z){setTimeout(function(){throw Z},0)}function rV(Z,$,Y){if(typeof $==="function")Z.then((Q)=>{let X;if(Y!==void 0&&Object(Y).spread&&Array.isArray(Q))X=GZ.tryCatch($).apply(void 0,[null].concat(Q));else X=Q===void 0?GZ.tryCatch($)(null):GZ.tryCatch($)(null,Q);if(X===GZ.errorObj)PU(X.e)},(Q)=>{if(!Q){let W=new Error(Q+"");Object.assign(W,{cause:Q}),Q=W}let X=GZ.tryCatch($)(Q);if(X===GZ.errorObj)PU(X.e)});return Z}jU.default=rV});var CU=j((rt,_U)=>{var RU=z1("assert"),Y$=z1("util");function BZ(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}Y$.inherits(BZ,Error);Object.defineProperty(BZ.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function QQ(Z,$,Y){RU($),RU.strictEqual(typeof Y,"number"),Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0});let Q=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=Q,this.offset=Y,this.buffer=$}Y$.inherits(QQ,BZ);Object.defineProperty(QQ.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function XQ(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0});let $=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=$}Y$.inherits(XQ,BZ);Object.defineProperty(XQ.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function c9(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}Y$.inherits(c9,BZ);Object.defineProperty(c9.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function WQ(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}Y$.inherits(WQ,c9);Object.defineProperty(WQ.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});_U.exports={RedisError:BZ,ParserError:QQ,ReplyError:XQ,AbortError:c9,InterruptError:WQ}});var bU=j((at,TU)=>{var VU=z1("assert");class Q$ extends Error{get name(){return this.constructor.name}}class EU extends Q${constructor(Z,$,Y){VU($),VU.strictEqual(typeof Y,"number");let Q=Error.stackTraceLimit;Error.stackTraceLimit=2;super(Z);Error.stackTraceLimit=Q,this.offset=Y,this.buffer=$}get name(){return this.constructor.name}}class IU extends Q${constructor(Z){let $=Error.stackTraceLimit;Error.stackTraceLimit=2;super(Z);Error.stackTraceLimit=$}get name(){return this.constructor.name}}class JQ extends Q${get name(){return this.constructor.name}}class xU extends JQ{get name(){return this.constructor.name}}TU.exports={RedisError:Q$,ParserError:EU,ReplyError:IU,AbortError:JQ,InterruptError:xU}});var F4=j((et,kU)=>{var eV=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?CU():bU();kU.exports=eV});var X$=j((Zs,zQ)=>{var gU=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],ZE=function Z($){var Y,Q=0,X=0,W=[],J=$.length;for(;Q<J;Q++)if(Y=$.charCodeAt(Q),Y<128)W[X++]=Y;else if(Y<2048)W[X++]=Y>>6|192,W[X++]=Y&63|128;else if((Y&64512)===55296&&Q+1<$.length&&($.charCodeAt(Q+1)&64512)===56320)Y=65536+((Y&1023)<<10)+($.charCodeAt(++Q)&1023),W[X++]=Y>>18|240,W[X++]=Y>>12&63|128,W[X++]=Y>>6&63|128,W[X++]=Y&63|128;else W[X++]=Y>>12|224,W[X++]=Y>>6&63|128,W[X++]=Y&63|128;return W},fU=zQ.exports=function Z($){var Y,Q=0,X=-1,W=0,J=0,z=typeof $==="string"?ZE($):$,q=z.length;while(Q<q){if(Y=z[Q++],X===-1){if(Y===123)X=Q}else if(Y!==125)J=gU[(Y^J>>8)&255]^J<<8;else if(Q-1!==X)return J&16383;W=gU[(Y^W>>8)&255]^W<<8}return W&16383};zQ.exports.generateMulti=function Z($){var Y=1,Q=$.length,X=fU($[0]);while(Y<Q)if(fU($[Y++])!==X)return-1;return X}});var cU=j(($s,pU)=>{var vU=9007199254740991,$E="[object Arguments]",YE="[object Function]",QE="[object GeneratorFunction]",XE=/^(?:0|[1-9]\d*)$/;function dU(Z,$,Y){switch(Y.length){case 0:return Z.call($);case 1:return Z.call($,Y[0]);case 2:return Z.call($,Y[0],Y[1]);case 3:return Z.call($,Y[0],Y[1],Y[2])}return Z.apply($,Y)}function WE(Z,$){var Y=-1,Q=Array(Z);while(++Y<Z)Q[Y]=$(Y);return Q}var W$=Object.prototype,J$=W$.hasOwnProperty,hU=W$.toString,JE=W$.propertyIsEnumerable,yU=Math.max;function zE(Z,$){var Y=AE(Z)||DE(Z)?WE(Z.length,String):[],Q=Y.length,X=!!Q;for(var W in Z)if(($||J$.call(Z,W))&&!(X&&(W=="length"||uU(W,Q))))Y.push(W);return Y}function qE(Z,$,Y,Q){if(Z===void 0||qQ(Z,W$[Y])&&!J$.call(Q,Y))return $;return Z}function UE(Z,$,Y){var Q=Z[$];if(!(J$.call(Z,$)&&qQ(Q,Y))||Y===void 0&&!($ in Z))Z[$]=Y}function wE(Z){if(!wQ(Z))return HE(Z);var $=SE(Z),Y=[];for(var Q in Z)if(!(Q=="constructor"&&($||!J$.call(Z,Q))))Y.push(Q);return Y}function mU(Z,$){return $=yU($===void 0?Z.length-1:$,0),function(){var Y=arguments,Q=-1,X=yU(Y.length-$,0),W=Array(X);while(++Q<X)W[Q]=Y[$+Q];Q=-1;var J=Array($+1);while(++Q<$)J[Q]=Y[Q];return J[$]=W,dU(Z,this,J)}}function ME(Z,$,Y,Q){Y||(Y={});var X=-1,W=$.length;while(++X<W){var J=$[X],z=Q?Q(Y[J],Z[J],J,Y,Z):void 0;UE(Y,J,z===void 0?Z[J]:z)}return Y}function GE(Z){return mU(function($,Y){var Q=-1,X=Y.length,W=X>1?Y[X-1]:void 0,J=X>2?Y[2]:void 0;if(W=Z.length>3&&typeof W=="function"?(X--,W):void 0,J&&BE(Y[0],Y[1],J))W=X<3?void 0:W,X=1;$=Object($);while(++Q<X){var z=Y[Q];if(z)Z($,z,Q,W)}return $})}function uU(Z,$){return $=$==null?vU:$,!!$&&(typeof Z=="number"||XE.test(Z))&&(Z>-1&&Z%1==0&&Z<$)}function BE(Z,$,Y){if(!wQ(Y))return!1;var Q=typeof $;if(Q=="number"?UQ(Y)&&uU($,Y.length):Q=="string"&&($ in Y))return qQ(Y[$],Z);return!1}function SE(Z){var $=Z&&Z.constructor,Y=typeof $=="function"&&$.prototype||W$;return Z===Y}function HE(Z){var $=[];if(Z!=null)for(var Y in Object(Z))$.push(Y);return $}function qQ(Z,$){return Z===$||Z!==Z&&$!==$}function DE(Z){return NE(Z)&&J$.call(Z,"callee")&&(!JE.call(Z,"callee")||hU.call(Z)==$E)}var AE=Array.isArray;function UQ(Z){return Z!=null&&OE(Z.length)&&!LE(Z)}function NE(Z){return FE(Z)&&UQ(Z)}function LE(Z){var $=wQ(Z)?hU.call(Z):"";return $==YE||$==QE}function OE(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=vU}function wQ(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function FE(Z){return!!Z&&typeof Z=="object"}var KE=GE(function(Z,$,Y,Q){ME($,jE($),Z,Q)}),PE=mU(function(Z){return Z.push(void 0,qE),dU(KE,void 0,Z)});function jE(Z){return UQ(Z)?zE(Z,!0):wE(Z)}pU.exports=PE});var nU=j((Ys,lU)=>{var RE=9007199254740991,_E="[object Arguments]",CE="[object Function]",VE="[object GeneratorFunction]",MQ=Object.prototype,EE=MQ.hasOwnProperty,iU=MQ.toString,IE=MQ.propertyIsEnumerable;function xE(Z){return bE(Z)&&EE.call(Z,"callee")&&(!IE.call(Z,"callee")||iU.call(Z)==_E)}function TE(Z){return Z!=null&&gE(Z.length)&&!kE(Z)}function bE(Z){return yE(Z)&&TE(Z)}function kE(Z){var $=fE(Z)?iU.call(Z):"";return $==CE||$==VE}function gE(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=RE}function fE(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function yE(Z){return!!Z&&typeof Z=="object"}lU.exports=xE});var i9=j((oU)=>{Object.defineProperty(oU,"__esModule",{value:!0});oU.isArguments=oU.defaults=oU.noop=void 0;var vE=cU();oU.defaults=vE;var dE=nU();oU.isArguments=dE;function hE(){}oU.noop=hE});var GQ=j((Xs,sU)=>{function pE(Z){Y.debug=Y,Y.default=Y,Y.coerce=q,Y.disable=J,Y.enable=X,Y.enabled=z,Y.humanize=E5(),Y.destroy=U,Object.keys(Z).forEach((w)=>{Y[w]=Z[w]}),Y.names=[],Y.skips=[],Y.formatters={};function $(w){let M=0;for(let S=0;S<w.length;S++)M=(M<<5)-M+w.charCodeAt(S),M|=0;return Y.colors[Math.abs(M)%Y.colors.length]}Y.selectColor=$;function Y(w){let M,S=null,G,L;function B(...P){if(!B.enabled)return;let I=B,n=Number(new Date),s=n-(M||n);if(I.diff=s,I.prev=M,I.curr=n,M=n,P[0]=Y.coerce(P[0]),typeof P[0]!=="string")P.unshift("%O");let A1=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(v,k)=>{if(v==="%%")return"%";A1++;let g=Y.formatters[k];if(typeof g==="function"){let V=P[A1];v=g.call(I,V),P.splice(A1,1),A1--}return v}),Y.formatArgs.call(I,P),(I.log||Y.log).apply(I,P)}if(B.namespace=w,B.useColors=Y.useColors(),B.color=Y.selectColor(w),B.extend=Q,B.destroy=Y.destroy,Object.defineProperty(B,"enabled",{enumerable:!0,configurable:!1,get:()=>{if(S!==null)return S;if(G!==Y.namespaces)G=Y.namespaces,L=Y.enabled(w);return L},set:(P)=>{S=P}}),typeof Y.init==="function")Y.init(B);return B}function Q(w,M){let S=Y(this.namespace+(typeof M==="undefined"?":":M)+w);return S.log=this.log,S}function X(w){Y.save(w),Y.namespaces=w,Y.names=[],Y.skips=[];let M=(typeof w==="string"?w:"").trim().replace(" ",",").split(",").filter(Boolean);for(let S of M)if(S[0]==="-")Y.skips.push(S.slice(1));else Y.names.push(S)}function W(w,M){let S=0,G=0,L=-1,B=0;while(S<w.length)if(G<M.length&&(M[G]===w[S]||M[G]==="*"))if(M[G]==="*")L=G,B=S,G++;else S++,G++;else if(L!==-1)G=L+1,B++,S=B;else return!1;while(G<M.length&&M[G]==="*")G++;return G===M.length}function J(){let w=[...Y.names,...Y.skips.map((M)=>"-"+M)].join(",");return Y.enable(""),w}function z(w){for(let M of Y.skips)if(W(w,M))return!1;for(let M of Y.names)if(W(w,M))return!0;return!1}function q(w){if(w instanceof Error)return w.stack||w.message;return w}function U(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return Y.enable(Y.load()),Y}sU.exports=pE});var aU=j((rU,n9)=>{rU.formatArgs=iE;rU.save=lE;rU.load=nE;rU.useColors=cE;rU.storage=oE();rU.destroy=(()=>{let Z=!1;return()=>{if(!Z)Z=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}})();rU.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function cE(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let Z;return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&(Z=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(Z[1],10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function iE(Z){if(Z[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Z[0]+(this.useColors?"%c ":" ")+"+"+n9.exports.humanize(this.diff),!this.useColors)return;let $="color: "+this.color;Z.splice(1,0,$,"color: inherit");let Y=0,Q=0;Z[0].replace(/%[a-zA-Z%]/g,(X)=>{if(X==="%%")return;if(Y++,X==="%c")Q=Y}),Z.splice(Q,0,$)}rU.log=console.debug||console.log||(()=>{});function lE(Z){try{if(Z)rU.storage.setItem("debug",Z);else rU.storage.removeItem("debug")}catch($){}}function nE(){let Z;try{Z=rU.storage.getItem("debug")}catch($){}if(!Z&&typeof process!=="undefined"&&"env"in process)Z=process.env.DEBUG;return Z}function oE(){try{return localStorage}catch(Z){}}n9.exports=GQ()(rU);var{formatters:tE}=n9.exports;tE.j=function(Z){try{return JSON.stringify(Z)}catch($){return"[UnexpectedJSONParseError]: "+$.message}}});var Yw=j((Zw,t9)=>{var QI=z1("tty"),o9=z1("util");Zw.init=wI;Zw.log=zI;Zw.formatArgs=WI;Zw.save=qI;Zw.load=UI;Zw.useColors=XI;Zw.destroy=o9.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Zw.colors=[6,2,3,4,5,1];try{let Z=(()=>{throw new Error("Cannot require module "+"supports-color");})();if(Z&&(Z.stderr||Z).level>=2)Zw.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}catch(Z){}Zw.inspectOpts=Object.keys(process.env).filter((Z)=>{return/^debug_/i.test(Z)}).reduce((Z,$)=>{let Y=$.substring(6).toLowerCase().replace(/_([a-z])/g,(X,W)=>{return W.toUpperCase()}),Q=process.env[$];if(/^(yes|on|true|enabled)$/i.test(Q))Q=!0;else if(/^(no|off|false|disabled)$/i.test(Q))Q=!1;else if(Q==="null")Q=null;else Q=Number(Q);return Z[Y]=Q,Z},{});function XI(){return"colors"in Zw.inspectOpts?Boolean(Zw.inspectOpts.colors):QI.isatty(process.stderr.fd)}function WI(Z){let{namespace:$,useColors:Y}=this;if(Y){let Q=this.color,X="\x1B[3"+(Q<8?Q:"8;5;"+Q),W=`  ${X};1m${$} \x1B[0m`;Z[0]=W+Z[0].split(`
`).join(`
`+W),Z.push(X+"m+"+t9.exports.humanize(this.diff)+"\x1B[0m")}else Z[0]=JI()+$+" "+Z[0]}function JI(){if(Zw.inspectOpts.hideDate)return"";return new Date().toISOString()+" "}function zI(...Z){return process.stderr.write(o9.formatWithOptions(Zw.inspectOpts,...Z)+`
`)}function qI(Z){if(Z)process.env.DEBUG=Z;else delete process.env.DEBUG}function UI(){return process.env.DEBUG}function wI(Z){Z.inspectOpts={};let $=Object.keys(Zw.inspectOpts);for(let Y=0;Y<$.length;Y++)Z.inspectOpts[$[Y]]=Zw.inspectOpts[$[Y]]}t9.exports=GQ()(Zw);var{formatters:eU}=t9.exports;eU.o=function(Z){return this.inspectOpts.colors=this.useColors,o9.inspect(Z,this.inspectOpts).split(`
`).map(($)=>$.trim()).join(" ")};eU.O=function(Z){return this.inspectOpts.colors=this.useColors,o9.inspect(Z,this.inspectOpts)}});var Qw=j((zs,BQ)=>{if(typeof process==="undefined"||process.type==="renderer"||!1||process.__nwjs)BQ.exports=aU();else BQ.exports=Yw()});var qw=j((Jw)=>{Object.defineProperty(Jw,"__esModule",{value:!0});Jw.genRedactedString=Jw.getStringValue=Jw.MAX_ARGUMENT_LENGTH=void 0;var NI=Qw(),SQ=200;Jw.MAX_ARGUMENT_LENGTH=SQ;var LI="ioredis";function Xw(Z){if(Z===null)return;switch(typeof Z){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(Z))return Z.toString("hex");if(Array.isArray(Z))return Z.join(",");try{return JSON.stringify(Z)}catch($){return}case"string":return Z}}Jw.getStringValue=Xw;function Ww(Z,$){let{length:Y}=Z;return Y<=$?Z:Z.slice(0,$)+' ... <REDACTED full-length="'+Y+'">'}Jw.genRedactedString=Ww;function OI(Z){let $=NI.default(`${LI}:${Z}`);function Y(...Q){if(!$.enabled)return;for(let X=1;X<Q.length;X++){let W=Xw(Q[X]);if(typeof W==="string"&&W.length>SQ)Q[X]=Ww(W,SQ)}return $.apply(null,Q)}return Object.defineProperties(Y,{namespace:{get(){return $.namespace}},enabled:{get(){return $.enabled}},destroy:{get(){return $.destroy}},log:{get(){return $.log},set(Q){$.log=Q}}}),Y}Jw.default=OI});var Mw=j((ww)=>{Object.defineProperty(ww,"__esModule",{value:!0});var Uw=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,jI={RedisCloudFixed:{ca:Uw},RedisCloudFlexible:{ca:Uw}};ww.default=jI});var M0=j((s9)=>{Object.defineProperty(s9,"__esModule",{value:!0});s9.noop=s9.defaults=s9.Debug=s9.zipMap=s9.CONNECTION_CLOSED_ERROR_MSG=s9.shuffle=s9.sample=s9.resolveTLSProfile=s9.parseURL=s9.optimizeErrorStack=s9.toArg=s9.convertMapToArray=s9.convertObjectToArray=s9.timeout=s9.packObject=s9.isInt=s9.wrapMultiResult=s9.convertBufferToString=void 0;var Gw=z1("url"),HQ=i9();Object.defineProperty(s9,"defaults",{enumerable:!0,get:function(){return HQ.defaults}});Object.defineProperty(s9,"noop",{enumerable:!0,get:function(){return HQ.noop}});var _I=qw();s9.Debug=_I.default;var CI=Mw();function Bw(Z,$){if(Z instanceof Buffer)return Z.toString($);if(Array.isArray(Z)){let Y=Z.length,Q=Array(Y);for(let X=0;X<Y;++X)Q[X]=Z[X]instanceof Buffer&&$==="utf8"?Z[X].toString():Bw(Z[X],$);return Q}return Z}s9.convertBufferToString=Bw;function VI(Z){if(!Z)return null;let $=[],Y=Z.length;for(let Q=0;Q<Y;++Q){let X=Z[Q];if(X instanceof Error)$.push([X]);else $.push([null,X])}return $}s9.wrapMultiResult=VI;function Sw(Z){let $=parseFloat(Z);return!isNaN(Z)&&($|0)===$}s9.isInt=Sw;function EI(Z){let $={},Y=Z.length;for(let Q=1;Q<Y;Q+=2)$[Z[Q-1]]=Z[Q];return $}s9.packObject=EI;function II(Z,$){let Y=null,Q=function(){if(Y)clearTimeout(Y),Y=null,Z.apply(this,arguments)};return Y=setTimeout(Q,$,new Error("timeout")),Q}s9.timeout=II;function xI(Z){let $=[],Y=Object.keys(Z);for(let Q=0,X=Y.length;Q<X;Q++)$.push(Y[Q],Z[Y[Q]]);return $}s9.convertObjectToArray=xI;function TI(Z){let $=[],Y=0;return Z.forEach(function(Q,X){$[Y]=X,$[Y+1]=Q,Y+=2}),$}s9.convertMapToArray=TI;function bI(Z){if(Z===null||typeof Z==="undefined")return"";return String(Z)}s9.toArg=bI;function kI(Z,$,Y){let Q=$.split(`
`),X="",W;for(W=1;W<Q.length;++W)if(Q[W].indexOf(Y)===-1)break;for(let J=W;J<Q.length;++J)X+=`
`+Q[J];if(Z.stack){let J=Z.stack.indexOf(`
`);Z.stack=Z.stack.slice(0,J)+X}return Z}s9.optimizeErrorStack=kI;function gI(Z){if(Sw(Z))return{port:Z};let $=Gw.parse(Z,!0,!0);if(!$.slashes&&Z[0]!=="/")Z="//"+Z,$=Gw.parse(Z,!0,!0);let Y=$.query||{},Q={};if($.auth){let X=$.auth.indexOf(":");Q.username=X===-1?$.auth:$.auth.slice(0,X),Q.password=X===-1?"":$.auth.slice(X+1)}if($.pathname)if($.protocol==="redis:"||$.protocol==="rediss:"){if($.pathname.length>1)Q.db=$.pathname.slice(1)}else Q.path=$.pathname;if($.host)Q.host=$.hostname;if($.port)Q.port=$.port;if(typeof Y.family==="string"){let X=Number.parseInt(Y.family,10);if(!Number.isNaN(X))Q.family=X}return HQ.defaults(Q,Y),Q}s9.parseURL=gI;function fI(Z){let $=Z===null||Z===void 0?void 0:Z.tls;if(typeof $==="string")$={profile:$};let Y=CI.default[$===null||$===void 0?void 0:$.profile];if(Y)$=Object.assign({},Y,$),delete $.profile,Z=Object.assign({},Z,{tls:$});return Z}s9.resolveTLSProfile=fI;function yI(Z,$=0){let Y=Z.length;if($>=Y)return null;return Z[$+Math.floor(Math.random()*(Y-$))]}s9.sample=yI;function vI(Z){let $=Z.length;while($>0){let Y=Math.floor(Math.random()*$);$--,[Z[$],Z[Y]]=[Z[Y],Z[$]]}return Z}s9.shuffle=vI;s9.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function dI(Z,$){let Y=new Map;return Z.forEach((Q,X)=>{Y.set(Q,$[X])}),Y}s9.zipMap=dI});var N8=j((Lw)=>{var __dirname="C:\\Users\\Eray\\Desktop\\elysia-backend\\node_modules\\ioredis\\built";Object.defineProperty(Lw,"__esModule",{value:!0});var Hw=MZ(),Qx=X$(),Xx=p8(),P4=M0();class e0{constructor(Z,$=[],Y={},Q){if(this.name=Z,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=Y.replyEncoding,this.errorStack=Y.errorStack,this.args=$.flat(),this.callback=Q,this.initPromise(),Y.keyPrefix){let X=Y.keyPrefix instanceof Buffer,W=X?Y.keyPrefix:null;this._iterateKeys((J)=>{if(J instanceof Buffer){if(W===null)W=Buffer.from(Y.keyPrefix);return Buffer.concat([W,J])}else if(X)return Buffer.concat([Y.keyPrefix,Buffer.from(String(J))]);return Y.keyPrefix+J})}if(Y.readOnly)this.isReadOnly=!0}static checkFlag(Z,$){return!!this.getFlagMap()[Z][$]}static setArgumentTransformer(Z,$){this._transformer.argument[Z]=$}static setReplyTransformer(Z,$){this._transformer.reply[Z]=$}static getFlagMap(){if(!this.flagMap)this.flagMap=Object.keys(e0.FLAGS).reduce((Z,$)=>{return Z[$]={},e0.FLAGS[$].forEach((Y)=>{Z[$][Y]=!0}),Z},{});return this.flagMap}getSlot(){if(typeof this.slot==="undefined"){let Z=this.getKeys()[0];this.slot=Z==null?null:Qx(Z)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(Z){let $,Y="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let Q=new Nw;Q.push(Y);for(let X=0;X<this.args.length;++X){let W=this.args[X];if(W instanceof Buffer)if(W.length===0)Q.push(`$0\r
\r
`);else Q.push("$"+W.length+`\r
`),Q.push(W),Q.push(`\r
`);else Q.push("$"+Buffer.byteLength(W)+`\r
`+W+`\r
`)}$=Q.toBuffer()}else{$=Y;for(let Q=0;Q<this.args.length;++Q){let X=this.args[Q];$+="$"+Buffer.byteLength(X)+`\r
`+X+`\r
`}}return $}stringifyArguments(){for(let Z=0;Z<this.args.length;++Z){let $=this.args[Z];if(typeof $==="string");else if($ instanceof Buffer)this.bufferMode=!0;else this.args[Z]=P4.toArg($)}}transformReply(Z){if(this.replyEncoding)Z=P4.convertBufferToString(Z,this.replyEncoding);let $=e0._transformer.reply[this.name];if($)Z=$(Z);return Z}setTimeout(Z){if(!this._commandTimeoutTimer)this._commandTimeoutTimer=setTimeout(()=>{if(!this.isResolved)this.reject(new Error("Command timed out"))},Z)}initPromise(){let Z=new Promise(($,Y)=>{if(!this.transformed){this.transformed=!0;let Q=e0._transformer.argument[this.name];if(Q)this.args=Q(this.args);this.stringifyArguments()}if(this.resolve=this._convertValue($),this.errorStack)this.reject=(Q)=>{Y(P4.optimizeErrorStack(Q,this.errorStack.stack,__dirname))};else this.reject=Y});this.promise=Xx.default(Z,this.callback)}_iterateKeys(Z=($)=>$){if(typeof this.keys==="undefined"){if(this.keys=[],Hw.exists(this.name)){let $=Hw.getKeyIndexes(this.name,this.args);for(let Y of $)this.args[Y]=Z(this.args[Y]),this.keys.push(this.args[Y])}}return this.keys}_convertValue(Z){return($)=>{try{let Y=this._commandTimeoutTimer;if(Y)clearTimeout(Y),delete this._commandTimeoutTimer;Z(this.transformReply($)),this.isResolved=!0}catch(Y){this.reject(Y)}return this.promise}}}Lw.default=e0;e0.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]};e0._transformer={argument:{},reply:{}};var Dw=function(Z){if(Z.length===1){if(Z[0]instanceof Map)return P4.convertMapToArray(Z[0]);if(typeof Z[0]==="object"&&Z[0]!==null)return P4.convertObjectToArray(Z[0])}return Z},Aw=function(Z){if(Z.length===2){if(Z[1]instanceof Map)return[Z[0]].concat(P4.convertMapToArray(Z[1]));if(typeof Z[1]==="object"&&Z[1]!==null)return[Z[0]].concat(P4.convertObjectToArray(Z[1]))}return Z};e0.setArgumentTransformer("mset",Dw);e0.setArgumentTransformer("msetnx",Dw);e0.setArgumentTransformer("hset",Aw);e0.setArgumentTransformer("hmset",Aw);e0.setReplyTransformer("hgetall",function(Z){if(Array.isArray(Z)){let $={};for(let Y=0;Y<Z.length;Y+=2){let Q=Z[Y],X=Z[Y+1];if(Q in $)Object.defineProperty($,Q,{value:X,configurable:!0,enumerable:!0,writable:!0});else $[Q]=X}return $}return Z});class Nw{constructor(){this.length=0,this.items=[]}push(Z){this.length+=Buffer.byteLength(Z),this.items.push(Z)}toBuffer(){let Z=Buffer.allocUnsafe(this.length),$=0;for(let Y of this.items){let Q=Buffer.byteLength(Y);Buffer.isBuffer(Y)?Y.copy(Z,$):Z.write(Y,$,Q),$+=Q}return Z}}});var Fw=j((Ow)=>{Object.defineProperty(Ow,"__esModule",{value:!0});var Jx=F4();class DQ extends Jx.RedisError{constructor(Z,$){super(Z);this.lastNodeError=$,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}Ow.default=DQ;DQ.defaultMessage="Failed to refresh slots cache."});var r9=j((Pw)=>{Object.defineProperty(Pw,"__esModule",{value:!0});var qx=z1("stream");class Kw extends qx.Readable{constructor(Z){super(Z);this.opt=Z,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let Z=[this._redisCursor];if(this.opt.key)Z.unshift(this.opt.key);if(this.opt.match)Z.push("MATCH",this.opt.match);if(this.opt.type)Z.push("TYPE",this.opt.type);if(this.opt.count)Z.push("COUNT",String(this.opt.count));if(this.opt.noValues)Z.push("NOVALUES");this.opt.redis[this.opt.command](Z,($,Y)=>{if($){this.emit("error",$);return}if(this._redisCursor=Y[0]instanceof Buffer?Y[0].toString():Y[0],this._redisCursor==="0")this._redisDrained=!0;this.push(Y[1])})}close(){this._redisDrained=!0}}Pw.default=Kw});var Tw=j((Ew)=>{Object.defineProperty(Ew,"__esModule",{value:!0});Ew.executeWithAutoPipelining=Ew.getFirstValueInFlattenedArray=Ew.shouldUseAutoPipelining=Ew.notAllowedAutoPipelineCommands=Ew.kCallbacks=Ew.kExec=void 0;var Rw=i9(),wx=X$(),jw=p8();Ew.kExec=Symbol("exec");Ew.kCallbacks=Symbol("callbacks");Ew.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"];function _w(Z,$){if(Z._runningAutoPipelines.has($))return;if(!Z._autoPipelines.has($))return;Z._runningAutoPipelines.add($);let Y=Z._autoPipelines.get($);Z._autoPipelines.delete($);let Q=Y[Ew.kCallbacks];Y[Ew.kCallbacks]=null,Y.exec(function(X,W){if(Z._runningAutoPipelines.delete($),X)for(let J=0;J<Q.length;J++)process.nextTick(Q[J],X);else for(let J=0;J<Q.length;J++)process.nextTick(Q[J],...W[J]);if(Z._autoPipelines.has($))_w(Z,$)})}function Mx(Z,$,Y){return $&&Z.options.enableAutoPipelining&&!Z.isPipeline&&!Ew.notAllowedAutoPipelineCommands.includes(Y)&&!Z.options.autoPipeliningIgnoredCommands.includes(Y)}Ew.shouldUseAutoPipelining=Mx;function Cw(Z){for(let $=0;$<Z.length;$++){let Y=Z[$];if(typeof Y==="string")return Y;else if(Array.isArray(Y)||Rw.isArguments(Y)){if(Y.length===0)continue;return Y[0]}let Q=[Y].flat();if(Q.length>0)return Q[0]}return}Ew.getFirstValueInFlattenedArray=Cw;function Vw(Z,$,Y,Q,X){if(Z.isCluster&&!Z.slots.length){if(Z.status==="wait")Z.connect().catch(Rw.noop);return jw.default(new Promise(function(U,w){Z.delayUntilReady((M)=>{if(M){w(M);return}Vw(Z,$,Y,Q,null).then(U,w)})}),X)}let W=Z.options.keyPrefix||"",J=Z.isCluster?Z.slots[wx(`${W}${Cw(Q)}`)].join(","):"main";if(!Z._autoPipelines.has(J)){let U=Z.pipeline();U[Ew.kExec]=!1,U[Ew.kCallbacks]=[],Z._autoPipelines.set(J,U)}let z=Z._autoPipelines.get(J);if(!z[Ew.kExec])z[Ew.kExec]=!0,setImmediate(_w,Z,J);let q=new Promise(function(U,w){if(z[Ew.kCallbacks].push(function(M,S){if(M){w(M);return}U(S)}),$==="call")Q.unshift(Y);z[$](...Q)});return jw.default(q,X)}Ew.executeWithAutoPipelining=Vw});var gw=j((kw)=>{Object.defineProperty(kw,"__esModule",{value:!0});var Sx=z1("crypto"),Hx=N8(),Dx=p8();class bw{constructor(Z,$=null,Y="",Q=!1){this.lua=Z,this.numberOfKeys=$,this.keyPrefix=Y,this.readOnly=Q,this.sha=Sx.createHash("sha1").update(Z).digest("hex");let X=this.sha,W=new WeakSet;this.Command=class J extends Hx.default{toWritable(z){let q=this.reject;if(this.reject=(U)=>{if(U.message.indexOf("NOSCRIPT")!==-1)W.delete(z);q.call(this,U)},!W.has(z))W.add(z),this.name="eval",this.args[0]=Z;else if(this.name==="eval")this.name="evalsha",this.args[0]=X;return super.toWritable(z)}}}execute(Z,$,Y,Q){if(typeof this.numberOfKeys==="number")$.unshift(this.numberOfKeys);if(this.keyPrefix)Y.keyPrefix=this.keyPrefix;if(this.readOnly)Y.readOnly=!0;let X=new this.Command("evalsha",[this.sha,...$],Y);return X.promise=X.promise.catch((W)=>{if(W.message.indexOf("NOSCRIPT")===-1)throw W;let J=new this.Command("evalsha",[this.sha,...$],Y);return(Z.isPipeline?Z.redis:Z).sendCommand(J)}),Dx.default(X.promise,Q),Z.sendCommand(X)}}kw.default=bw});var ZY=j((yw)=>{Object.defineProperty(yw,"__esModule",{value:!0});var Nx=MZ(),e9=Tw(),Lx=N8(),Ox=gw();class i8{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return AQ.slice(0)}createBuiltinCommand(Z){return{string:c8(null,Z,"utf8"),buffer:c8(null,Z,null)}}addBuiltinCommand(Z){this.addedBuiltinSet.add(Z),this[Z]=c8(Z,Z,"utf8"),this[Z+"Buffer"]=c8(Z+"Buffer",Z,null)}defineCommand(Z,$){let Y=new Ox.default($.lua,$.numberOfKeys,this.options.keyPrefix,$.readOnly);this.scriptsSet[Z]=Y,this[Z]=fw(Z,Z,Y,"utf8"),this[Z+"Buffer"]=fw(Z+"Buffer",Z,Y,null)}sendCommand(Z,$,Y){throw new Error('"sendCommand" is not implemented')}}var AQ=Nx.list.filter((Z)=>Z!=="monitor");AQ.push("sentinel");AQ.forEach(function(Z){i8.prototype[Z]=c8(Z,Z,"utf8"),i8.prototype[Z+"Buffer"]=c8(Z+"Buffer",Z,null)});i8.prototype.call=c8("call","utf8");i8.prototype.callBuffer=c8("callBuffer",null);i8.prototype.send_command=i8.prototype.call;function c8(Z,$,Y){if(typeof Y==="undefined")Y=$,$=null;return function(...Q){let X=$||Q.shift(),W=Q[Q.length-1];if(typeof W==="function")Q.pop();else W=void 0;let J={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:Y};if(!e9.shouldUseAutoPipelining(this,Z,X))return this.sendCommand(new Lx.default(X,Q,J,W));return e9.executeWithAutoPipelining(this,Z,X,Q,W)}}function fw(Z,$,Y,Q){return function(...X){let W=typeof X[X.length-1]==="function"?X.pop():void 0,J={replyEncoding:Q};if(this.options.showFriendlyErrorStack)J.errorStack=new Error;if(!e9.shouldUseAutoPipelining(this,Z,$))return Y.execute(this,X,J,W);return e9.executeWithAutoPipelining(this,Z,$,X,W)}}yw.default=i8});var LQ=j((mw)=>{Object.defineProperty(mw,"__esModule",{value:!0});var NQ=X$(),vw=MZ(),dw=p8(),Kx=z1("util"),Px=N8(),jx=M0(),Rx=ZY();function _x(Z,$){let Y=NQ($[0]),Q=Z._groupsBySlot[Y];for(let X=1;X<$.length;X++)if(Z._groupsBySlot[NQ($[X])]!==Q)return-1;return Y}class j4 extends Rx.default{constructor(Z){super();this.redis=Z,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=Z.options,Object.keys(Z.scriptsSet).forEach((Y)=>{let Q=Z.scriptsSet[Y];this._shaToScript[Q.sha]=Q,this[Y]=Z[Y],this[Y+"Buffer"]=Z[Y+"Buffer"]}),Z.addedBuiltinSet.forEach((Y)=>{this[Y]=Z[Y],this[Y+"Buffer"]=Z[Y+"Buffer"]}),this.promise=new Promise((Y,Q)=>{this.resolve=Y,this.reject=Q});let $=this;Object.defineProperty(this,"length",{get:function(){return $._queue.length}})}fillResult(Z,$){if(this._queue[$].name==="exec"&&Array.isArray(Z[1])){let Q=Z[1].length;for(let X=0;X<Q;X++){if(Z[1][X]instanceof Error)continue;let W=this._queue[$-(Q-X)];try{Z[1][X]=W.transformReply(Z[1][X])}catch(J){Z[1][X]=J}}}if(this._result[$]=Z,--this.replyPending)return;if(this.isCluster){let Q=!0,X;for(let W=0;W<this._result.length;++W){let J=this._result[W][0],z=this._queue[W];if(J){if(z.name==="exec"&&J.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!X)X={name:J.name,message:J.message};else if(X.name!==J.name||X.message!==J.message){Q=!1;break}}else if(!z.inTransaction){if(!(vw.exists(z.name)&&vw.hasFlag(z.name,"readonly"))){Q=!1;break}}}if(X&&Q){let W=this,J=X.message.split(" "),z=this._queue,q=!1;this._queue=[];for(let S=0;S<z.length;++S){if(J[0]==="ASK"&&!q&&z[S].name!=="asking"&&(!z[S-1]||z[S-1].name!=="asking")){let G=new Px.default("asking");G.ignore=!0,this.sendCommand(G)}z[S].initPromise(),this.sendCommand(z[S]),q=z[S].inTransaction}let U=!0;if(typeof this.leftRedirections==="undefined")this.leftRedirections={};let w=function(){W.exec()},M=this.redis;if(M.handleError(X,this.leftRedirections,{moved:function(S,G){W.preferKey=G,M.slots[J[1]]=[G],M._groupsBySlot[J[1]]=M._groupsIds[M.slots[J[1]].join(";")],M.refreshSlotsCache(),W.exec()},ask:function(S,G){W.preferKey=G,W.exec()},tryagain:w,clusterDown:w,connectionClosed:w,maxRedirections:()=>{U=!1},defaults:()=>{U=!1}}),U)return}}let Y=0;for(let Q=0;Q<this._queue.length-Y;++Q){if(this._queue[Q+Y].ignore)Y+=1;this._result[Q]=this._result[Q+Y]}this.resolve(this._result.slice(0,this._result.length-Y))}sendCommand(Z){if(this._transactions>0)Z.inTransaction=!0;let $=this._queue.length;return Z.pipelineIndex=$,Z.promise.then((Y)=>{this.fillResult([null,Y],$)}).catch((Y)=>{this.fillResult([Y],$)}),this._queue.push(Z),this}addBatch(Z){let $,Y,Q;for(let X=0;X<Z.length;++X)$=Z[X],Y=$[0],Q=$.slice(1),this[Y].apply(this,Q);return this}}mw.default=j4;var Cx=j4.prototype.multi;j4.prototype.multi=function(){return this._transactions+=1,Cx.apply(this,arguments)};var hw=j4.prototype.execBuffer;j4.prototype.execBuffer=Kx.deprecate(function(){if(this._transactions>0)this._transactions-=1;return hw.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");j4.prototype.exec=function(Z){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(jx.noop);if(Z&&!this.nodeifiedPromise)this.nodeifiedPromise=!0,dw.default(this.promise,Z);return this.redis.delayUntilReady((X)=>{if(X){this.reject(X);return}this.exec(Z)}),this.promise}if(this._transactions>0)return this._transactions-=1,hw.apply(this,arguments);if(!this.nodeifiedPromise)this.nodeifiedPromise=!0,dw.default(this.promise,Z);if(!this._queue.length)this.resolve([]);let $;if(this.isCluster){let X=[];for(let W=0;W<this._queue.length;W++){let J=this._queue[W].getKeys();if(J.length)X.push(J[0]);if(J.length&&NQ.generateMulti(J)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(X.length){if($=_x(this.redis,X),$<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else $=Math.random()*16384|0}let Y=this;return Q(),this.promise;function Q(){let X=Y.replyPending=Y._queue.length,W;if(Y.isCluster)W={slot:$,redis:Y.redis.connectionPool.nodes.all[Y.preferKey]};let J="",z,q={isPipeline:!0,destination:Y.isCluster?W:{redis:Y.redis},write(U){if(typeof U!=="string"){if(!z)z=[];if(J)z.push(Buffer.from(J,"utf8")),J="";z.push(U)}else J+=U;if(!--X){if(z){if(J)z.push(Buffer.from(J,"utf8"));q.destination.redis.stream.write(Buffer.concat(z))}else q.destination.redis.stream.write(J);X=Y._queue.length,J="",z=void 0}}};for(let U=0;U<Y._queue.length;++U)Y.redis.sendCommand(Y._queue[U],q,W);return Y.promise}}});var KQ=j((pw)=>{Object.defineProperty(pw,"__esModule",{value:!0});pw.addTransactionSupport=void 0;var OQ=M0(),FQ=p8(),uw=LQ();function Ex(Z){Z.pipeline=function(Q){let X=new uw.default(this);if(Array.isArray(Q))X.addBatch(Q);return X};let{multi:$}=Z;Z.multi=function(Q,X){if(typeof X==="undefined"&&!Array.isArray(Q))X=Q,Q=null;if(X&&X.pipeline===!1)return $.call(this);let W=new uw.default(this);if(W.multi(),Array.isArray(Q))W.addBatch(Q);let J=W.exec;W.exec=function(q){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(OQ.noop);return FQ.default(new Promise((w,M)=>{this.redis.delayUntilReady((S)=>{if(S){M(S);return}this.exec(W).then(w,M)})}),q)}if(this._transactions>0)J.call(W);if(this.nodeifiedPromise)return J.call(W);let U=J.call(W);return FQ.default(U.then(function(w){let M=w[w.length-1];if(typeof M==="undefined")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(M[0]){M[0].previousErrors=[];for(let S=0;S<w.length-1;++S)if(w[S][0])M[0].previousErrors.push(w[S][0]);throw M[0]}return OQ.wrapMultiResult(M[1])}),q)};let{execBuffer:z}=W;return W.execBuffer=function(q){if(this._transactions>0)z.call(W);return W.exec(q)},W};let{exec:Y}=Z;Z.exec=function(Q){return FQ.default(Y.call(this).then(function(X){if(Array.isArray(X))X=OQ.wrapMultiResult(X);return X}),Q)}}pw.addTransactionSupport=Ex});var PQ=j((iw)=>{Object.defineProperty(iw,"__esModule",{value:!0});function Ix(Z,$){Object.getOwnPropertyNames($.prototype).forEach((Y)=>{Object.defineProperty(Z.prototype,Y,Object.getOwnPropertyDescriptor($.prototype,Y))})}iw.default=Ix});var tw=j((nw)=>{Object.defineProperty(nw,"__esModule",{value:!0});nw.DEFAULT_CLUSTER_OPTIONS=void 0;var lw=z1("dns");nw.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:(Z)=>Math.min(100+Z*2,2000),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1000,useSRVRecords:!1,resolveSrv:lw.resolveSrv,dnsLookup:lw.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}});var q$=j((rw)=>{Object.defineProperty(rw,"__esModule",{value:!0});rw.getConnectionName=rw.weightSrvRecords=rw.groupSrvRecords=rw.getUniqueHostnamesFromOptions=rw.normalizeNodeOptions=rw.nodeKeyToRedisOptions=rw.getNodeKey=void 0;var sw=M0(),Tx=z1("net");function bx(Z){return Z.port=Z.port||6379,Z.host=Z.host||"127.0.0.1",Z.host+":"+Z.port}rw.getNodeKey=bx;function kx(Z){let $=Z.lastIndexOf(":");if($===-1)throw new Error(`Invalid node key ${Z}`);return{host:Z.slice(0,$),port:Number(Z.slice($+1))}}rw.nodeKeyToRedisOptions=kx;function gx(Z){return Z.map(($)=>{let Y={};if(typeof $==="object")Object.assign(Y,$);else if(typeof $==="string")Object.assign(Y,sw.parseURL($));else if(typeof $==="number")Y.port=$;else throw new Error("Invalid argument "+$);if(typeof Y.port==="string")Y.port=parseInt(Y.port,10);if(delete Y.db,!Y.port)Y.port=6379;if(!Y.host)Y.host="127.0.0.1";return sw.resolveTLSProfile(Y)})}rw.normalizeNodeOptions=gx;function fx(Z){let $={};return Z.forEach((Y)=>{$[Y.host]=!0}),Object.keys($).filter((Y)=>!Tx.isIP(Y))}rw.getUniqueHostnamesFromOptions=fx;function yx(Z){let $={};for(let Y of Z)if(!$.hasOwnProperty(Y.priority))$[Y.priority]={totalWeight:Y.weight,records:[Y]};else $[Y.priority].totalWeight+=Y.weight,$[Y.priority].records.push(Y);return $}rw.groupSrvRecords=yx;function vx(Z){if(Z.records.length===1)return Z.totalWeight=0,Z.records.shift();let $=Math.floor(Math.random()*(Z.totalWeight+Z.records.length)),Y=0;for(let[Q,X]of Z.records.entries())if(Y+=1+X.weight,Y>$)return Z.totalWeight-=X.weight,Z.records.splice(Q,1),X}rw.weightSrvRecords=vx;function dx(Z,$){let Y=`ioredis-cluster(${Z})`;return $?`${Y}:${$}`:Y}rw.getConnectionName=dx});var RQ=j(($M)=>{Object.defineProperty($M,"__esModule",{value:!0});var ew=q$(),jQ=M0(),lx=l8(),L8=jQ.Debug("cluster:subscriber");class ZM{constructor(Z,$,Y=!1){this.connectionPool=Z,this.emitter=$,this.isSharded=Y,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){L8("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}L8("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(Q,X)=>{if(!this.started||!this.subscriber)return;if(ew.getNodeKey(this.subscriber.options)===X)L8("subscriber has left, selecting a new one..."),this.selectSubscriber()}),this.connectionPool.on("+node",()=>{if(!this.started||this.subscriber)return;L8("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber()})}getInstance(){return this.subscriber}associateSlotRange(Z){if(this.isSharded)this.slotRange=Z;return this.slotRange}start(){this.started=!0,this.selectSubscriber(),L8("started")}stop(){if(this.started=!1,this.subscriber)this.subscriber.disconnect(),this.subscriber=null}isStarted(){return this.started}selectSubscriber(){let Z=this.lastActiveSubscriber;if(Z)Z.off("end",this.onSubscriberEnd),Z.disconnect();if(this.subscriber)this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect();let $=jQ.sample(this.connectionPool.getNodes());if(!$){L8("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:Y}=$;L8("selected a subscriber %s:%s",Y.host,Y.port);let Q="subscriber";if(this.isSharded)Q="ssubscriber";this.subscriber=new lx.default({port:Y.port,host:Y.host,username:Y.username,password:Y.password,enableReadyCheck:!0,connectionName:ew.getConnectionName(Q,Y.connectionName),lazyConnect:!0,tls:Y.tls,retryStrategy:null}),this.subscriber.on("error",jQ.noop),this.subscriber.once("end",this.onSubscriberEnd);let X={subscribe:[],psubscribe:[],ssubscribe:[]};if(Z){let W=Z.condition||Z.prevCondition;if(W&&W.subscriber)X.subscribe=W.subscriber.channels("subscribe"),X.psubscribe=W.subscriber.channels("psubscribe"),X.ssubscribe=W.subscriber.channels("ssubscribe")}if(X.subscribe.length||X.psubscribe.length||X.ssubscribe.length){let W=0;for(let J of["subscribe","psubscribe","ssubscribe"]){let z=X[J];if(z.length)W+=1,L8("%s %d channels",J,z.length),this.subscriber[J](z).then(()=>{if(!--W)this.lastActiveSubscriber=this.subscriber}).catch(()=>{L8("failed to %s %d channels",J,z.length)})}}else this.lastActiveSubscriber=this.subscriber;for(let W of["message","messageBuffer"])this.subscriber.on(W,(J,z)=>{this.emitter.emit(W,J,z)});for(let W of["pmessage","pmessageBuffer"])this.subscriber.on(W,(J,z,q)=>{this.emitter.emit(W,J,z,q)});if(this.isSharded==!0)for(let W of["smessage","smessageBuffer"])this.subscriber.on(W,(J,z)=>{this.emitter.emit(W,J,z)})}}$M.default=ZM});var CQ=j((QM)=>{Object.defineProperty(QM,"__esModule",{value:!0});var ox=z1("events"),$Y=M0(),_Q=q$(),tx=l8(),U$=$Y.Debug("cluster:connectionPool");class YM extends ox.EventEmitter{constructor(Z){super();this.redisOptions=Z,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(Z="all"){let $=this.nodes[Z];return Object.keys($).map((Y)=>$[Y])}getInstanceByKey(Z){return this.nodes.all[Z]}getSampleInstance(Z){let $=Object.keys(this.nodes[Z]),Y=$Y.sample($);return this.nodes[Z][Y]}addMasterNode(Z){let $=_Q.getNodeKey(Z.options),Y=this.createRedisFromOptions(Z,Z.options.readOnly);if(!Z.options.readOnly)return this.nodes.all[$]=Y,this.nodes.master[$]=Y,!0;return!1}createRedisFromOptions(Z,$){return new tx.default($Y.defaults({retryStrategy:null,enableOfflineQueue:!0,readOnly:$},Z,this.redisOptions,{lazyConnect:!0}))}findOrCreate(Z,$=!1){let Y=_Q.getNodeKey(Z);if($=Boolean($),this.specifiedOptions[Y])Object.assign(Z,this.specifiedOptions[Y]);else this.specifiedOptions[Y]=Z;let Q;if(this.nodes.all[Y]){if(Q=this.nodes.all[Y],Q.options.readOnly!==$)if(Q.options.readOnly=$,U$("Change role of %s to %s",Y,$?"slave":"master"),Q[$?"readonly":"readwrite"]().catch($Y.noop),$)delete this.nodes.master[Y],this.nodes.slave[Y]=Q;else delete this.nodes.slave[Y],this.nodes.master[Y]=Q}else U$("Connecting to %s as %s",Y,$?"slave":"master"),Q=this.createRedisFromOptions(Z,$),this.nodes.all[Y]=Q,this.nodes[$?"slave":"master"][Y]=Q,Q.once("end",()=>{if(this.removeNode(Y),this.emit("-node",Q,Y),!Object.keys(this.nodes.all).length)this.emit("drain")}),this.emit("+node",Q,Y),Q.on("error",function(X){this.emit("nodeError",X,Y)});return Q}reset(Z){U$("Reset with %O",Z);let $={};Z.forEach((Y)=>{let Q=_Q.getNodeKey(Y);if(!(Y.readOnly&&$[Q]))$[Q]=Y}),Object.keys(this.nodes.all).forEach((Y)=>{if(!$[Y])U$("Disconnect %s because the node does not hold any slot",Y),this.nodes.all[Y].disconnect(),this.removeNode(Y)}),Object.keys($).forEach((Y)=>{let Q=$[Y];this.findOrCreate(Q,Q.readOnly)})}removeNode(Z){let{nodes:$}=this;if($.all[Z])U$("Remove %s from the pool",Z),delete $.all[Z];delete $.master[Z],delete $.slave[Z]}}QM.default=YM});var YY=j((Rs,XM)=>{function c1(Z,Y){var Y=Y||{};if(this._capacity=Y.capacity,this._head=0,this._tail=0,Array.isArray(Z))this._fromArray(Z);else this._capacityMask=3,this._list=new Array(4)}c1.prototype.peekAt=function Z($){var Y=$;if(Y!==(Y|0))return;var Q=this.size();if(Y>=Q||Y<-Q)return;if(Y<0)Y+=Q;return Y=this._head+Y&this._capacityMask,this._list[Y]};c1.prototype.get=function Z($){return this.peekAt($)};c1.prototype.peek=function Z(){if(this._head===this._tail)return;return this._list[this._head]};c1.prototype.peekFront=function Z(){return this.peek()};c1.prototype.peekBack=function Z(){return this.peekAt(-1)};Object.defineProperty(c1.prototype,"length",{get:function Z(){return this.size()}});c1.prototype.size=function Z(){if(this._head===this._tail)return 0;if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};c1.prototype.unshift=function Z($){if(arguments.length===0)return this.size();var Y=this._list.length;if(this._head=this._head-1+Y&this._capacityMask,this._list[this._head]=$,this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.pop();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};c1.prototype.shift=function Z(){var $=this._head;if($===this._tail)return;var Y=this._list[$];if(this._list[$]=void 0,this._head=$+1&this._capacityMask,$<2&&this._tail>1e4&&this._tail<=this._list.length>>>2)this._shrinkArray();return Y};c1.prototype.push=function Z($){if(arguments.length===0)return this.size();var Y=this._tail;if(this._list[Y]=$,this._tail=Y+1&this._capacityMask,this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.shift();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};c1.prototype.pop=function Z(){var $=this._tail;if($===this._head)return;var Y=this._list.length;this._tail=$-1+Y&this._capacityMask;var Q=this._list[this._tail];if(this._list[this._tail]=void 0,this._head<2&&$>1e4&&$<=Y>>>2)this._shrinkArray();return Q};c1.prototype.removeOne=function Z($){var Y=$;if(Y!==(Y|0))return;if(this._head===this._tail)return;var Q=this.size(),X=this._list.length;if(Y>=Q||Y<-Q)return;if(Y<0)Y+=Q;Y=this._head+Y&this._capacityMask;var W=this._list[Y],J;if($<Q/2){for(J=$;J>0;J--)this._list[Y]=this._list[Y=Y-1+X&this._capacityMask];this._list[Y]=void 0,this._head=this._head+1+X&this._capacityMask}else{for(J=Q-1-$;J>0;J--)this._list[Y]=this._list[Y=Y+1+X&this._capacityMask];this._list[Y]=void 0,this._tail=this._tail-1+X&this._capacityMask}return W};c1.prototype.remove=function Z($,Y){var Q=$,X,W=Y;if(Q!==(Q|0))return;if(this._head===this._tail)return;var J=this.size(),z=this._list.length;if(Q>=J||Q<-J||Y<1)return;if(Q<0)Q+=J;if(Y===1||!Y)return X=new Array(1),X[0]=this.removeOne(Q),X;if(Q===0&&Q+Y>=J)return X=this.toArray(),this.clear(),X;if(Q+Y>J)Y=J-Q;var q;X=new Array(Y);for(q=0;q<Y;q++)X[q]=this._list[this._head+Q+q&this._capacityMask];if(Q=this._head+Q&this._capacityMask,$+Y===J){this._tail=this._tail-Y+z&this._capacityMask;for(q=Y;q>0;q--)this._list[Q=Q+1+z&this._capacityMask]=void 0;return X}if($===0){this._head=this._head+Y+z&this._capacityMask;for(q=Y-1;q>0;q--)this._list[Q=Q+1+z&this._capacityMask]=void 0;return X}if(Q<J/2){this._head=this._head+$+Y+z&this._capacityMask;for(q=$;q>0;q--)this.unshift(this._list[Q=Q-1+z&this._capacityMask]);Q=this._head-1+z&this._capacityMask;while(W>0)this._list[Q=Q-1+z&this._capacityMask]=void 0,W--;if($<0)this._tail=Q}else{this._tail=Q,Q=Q+Y+z&this._capacityMask;for(q=J-(Y+$);q>0;q--)this.push(this._list[Q++]);Q=this._tail;while(W>0)this._list[Q=Q+1+z&this._capacityMask]=void 0,W--}if(this._head<2&&this._tail>1e4&&this._tail<=z>>>2)this._shrinkArray();return X};c1.prototype.splice=function Z($,Y){var Q=$;if(Q!==(Q|0))return;var X=this.size();if(Q<0)Q+=X;if(Q>X)return;if(arguments.length>2){var W,J,z,q=arguments.length,U=this._list.length,w=2;if(!X||Q<X/2){J=new Array(Q);for(W=0;W<Q;W++)J[W]=this._list[this._head+W&this._capacityMask];if(Y===0){if(z=[],Q>0)this._head=this._head+Q+U&this._capacityMask}else z=this.remove(Q,Y),this._head=this._head+Q+U&this._capacityMask;while(q>w)this.unshift(arguments[--q]);for(W=Q;W>0;W--)this.unshift(J[W-1])}else{J=new Array(X-(Q+Y));var M=J.length;for(W=0;W<M;W++)J[W]=this._list[this._head+Q+Y+W&this._capacityMask];if(Y===0){if(z=[],Q!=X)this._tail=this._head+Q+U&this._capacityMask}else z=this.remove(Q,Y),this._tail=this._tail-M+U&this._capacityMask;while(w<q)this.push(arguments[w++]);for(W=0;W<M;W++)this.push(J[W])}return z}else return this.remove(Q,Y)};c1.prototype.clear=function Z(){this._list=new Array(this._list.length),this._head=0,this._tail=0};c1.prototype.isEmpty=function Z(){return this._head===this._tail};c1.prototype.toArray=function Z(){return this._copyArray(!1)};c1.prototype._fromArray=function Z($){var Y=$.length,Q=this._nextPowerOf2(Y);this._list=new Array(Q),this._capacityMask=Q-1,this._tail=Y;for(var X=0;X<Y;X++)this._list[X]=$[X]};c1.prototype._copyArray=function Z($,Y){var Q=this._list,X=Q.length,W=this.length;if(Y=Y|W,Y==W&&this._head<this._tail)return this._list.slice(this._head,this._tail);var J=new Array(Y),z=0,q;if($||this._head>this._tail){for(q=this._head;q<X;q++)J[z++]=Q[q];for(q=0;q<this._tail;q++)J[z++]=Q[q]}else for(q=this._head;q<this._tail;q++)J[z++]=Q[q];return J};c1.prototype._growArray=function Z(){if(this._head!=0){var $=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=$}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};c1.prototype._shrinkArray=function Z(){this._list.length>>>=1,this._capacityMask>>>=1};c1.prototype._nextPowerOf2=function Z($){var Y=Math.log($)/Math.log(2),Q=1<<Y+1;return Math.max(Q,4)};XM.exports=c1});var zM=j((JM)=>{Object.defineProperty(JM,"__esModule",{value:!0});var rx=M0(),ax=YY(),ex=rx.Debug("delayqueue");class WM{constructor(){this.queues={},this.timeouts={}}push(Z,$,Y){let Q=Y.callback||process.nextTick;if(!this.queues[Z])this.queues[Z]=new ax;if(this.queues[Z].push($),!this.timeouts[Z])this.timeouts[Z]=setTimeout(()=>{Q(()=>{this.timeouts[Z]=null,this.execute(Z)})},Y.timeout)}execute(Z){let $=this.queues[Z];if(!$)return;let{length:Y}=$;if(!Y)return;ex("send %d commands in %s queue",Y,Z),this.queues[Z]=null;while($.length>0)$.shift()()}}JM.default=WM});var GM=j((MM)=>{Object.defineProperty(MM,"__esModule",{value:!0});var $T=M0(),YT=RQ(),QT=CQ(),qM=q$(),QY=X$(),UM=$T.Debug("cluster:subscriberGroup");class wM{constructor(Z){this.cluster=Z,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,Z.on("+node",($)=>{this._addSubscriber($)}),Z.on("-node",($)=>{this._removeSubscriber($)}),Z.on("refresh",()=>{this._refreshSlots(Z)})}getResponsibleSubscriber(Z){let $=this.clusterSlots[Z][0];return this.shardedSubscribers.get($)}addChannels(Z){let $=QY(Z[0]);Z.forEach((Q)=>{if(QY(Q)!=$)return-1});let Y=this.channels.get($);if(!Y)this.channels.set($,Z);else this.channels.set($,Y.concat(Z));return[...this.channels.values()].flatMap((Q)=>Q).length}removeChannels(Z){let $=QY(Z[0]);Z.forEach((Q)=>{if(QY(Q)!=$)return-1});let Y=this.channels.get($);if(Y){let Q=Y.filter((X)=>!Z.includes(X));this.channels.set($,Q)}return[...this.channels.values()].flatMap((Q)=>Q).length}stop(){for(let Z of this.shardedSubscribers.values())Z.stop()}start(){for(let Z of this.shardedSubscribers.values())if(!Z.isStarted())Z.start()}_addSubscriber(Z){let $=new QT.default(Z.options);if($.addMasterNode(Z)){let Y=new YT.default($,this.cluster,!0),Q=qM.getNodeKey(Z.options);return this.shardedSubscribers.set(Q,Y),Y.start(),this._resubscribe(),this.cluster.emit("+subscriber"),Y}return null}_removeSubscriber(Z){let $=qM.getNodeKey(Z.options),Y=this.shardedSubscribers.get($);if(Y)Y.stop(),this.shardedSubscribers.delete($),this._resubscribe(),this.cluster.emit("-subscriber");return this.shardedSubscribers}_refreshSlots(Z){if(this._slotsAreEqual(Z.slots))UM("Nothing to refresh because the new cluster map is equal to the previous one.");else{UM("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let $=0;$<Z.slots.length;$++){let Y=Z.slots[$][0];if(!this.subscriberToSlotsIndex.has(Y))this.subscriberToSlotsIndex.set(Y,[]);this.subscriberToSlotsIndex.get(Y).push(Number($))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify(Z.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){if(this.shardedSubscribers)this.shardedSubscribers.forEach((Z,$)=>{let Y=this.subscriberToSlotsIndex.get($);if(Y)Z.associateSlotRange(Y),Y.forEach((Q)=>{let X=Z.getInstance(),W=this.channels.get(Q);if(W&&W.length>0){if(X)X.ssubscribe(W),X.on("ready",()=>{X.ssubscribe(W)})}})})}_slotsAreEqual(Z){if(this.clusterSlots===void 0)return!1;else return JSON.stringify(this.clusterSlots)===JSON.stringify(Z)}}MM.default=wM});var EQ=j((LM)=>{Object.defineProperty(LM,"__esModule",{value:!0});var BM=MZ(),NM=z1("events"),w$=F4(),SM=p8(),HM=N8(),VQ=Fw(),WT=l8(),JT=r9(),zT=KQ(),Z6=M0(),qT=PQ(),UT=ZY(),wT=tw(),MT=RQ(),GT=CQ(),BT=zM(),SZ=q$(),DM=YY(),ST=GM(),i1=Z6.Debug("cluster"),AM=new WeakSet;class M$ extends UT.default{constructor(Z,$={}){super();if(this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new BT.default,this.offlineQueue=new DM,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,NM.EventEmitter.call(this),this.startupNodes=Z,this.options=Z6.defaults({},$,wT.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers==!0)this.shardedSubscribers=new ST.default(this);if(this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix)this.options.keyPrefix=this.options.redisOptions.keyPrefix;if(typeof this.options.scaleReads!=="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');if(this.connectionPool=new GT.default(this.options.redisOptions),this.connectionPool.on("-node",(Y,Q)=>{this.emit("-node",Y)}),this.connectionPool.on("+node",(Y)=>{this.emit("+node",Y)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(Y,Q)=>{this.emit("node error",Y,Q)}),this.subscriber=new MT.default(this.connectionPool,this),this.options.scripts)Object.entries(this.options.scripts).forEach(([Y,Q])=>{this.defineCommand(Y,Q)});if(this.options.lazyConnect)this.setStatus("wait");else this.connect().catch((Y)=>{i1("connecting failed: %s",Y)})}connect(){return new Promise((Z,$)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){$(new Error("Redis is already connecting/connected"));return}let Y=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then((Q)=>{if(this.connectionEpoch!==Y){i1("discard connecting after resolving startup nodes because epoch not match: %d != %d",Y,this.connectionEpoch),$(new w$.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){i1("discard connecting after resolving startup nodes because the status changed to %s",this.status),$(new w$.RedisError("Connection is aborted"));return}this.connectionPool.reset(Q);let X=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),Z()},W=void 0,J=()=>{if(this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",W),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck)this.readyCheck((z,q)=>{if(z||q){if(i1("Ready check failed (%s). Reconnecting...",z||q),this.status==="connect")this.disconnect(!0)}else X()});else X()};if(W=()=>{let z=new Error("None of startup nodes is available");this.removeListener("refresh",J),this.invokeReadyDelayedCallbacks(z),$(z)},this.once("refresh",J),this.once("close",W),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache((z)=>{if(z&&z.message===VQ.default.defaultMessage)WT.default.prototype.silentEmit.call(this,"error",z),this.connectionPool.reset([])}),this.subscriber.start(),this.options.shardedSubscribers)this.shardedSubscribers.start()}).catch((Q)=>{this.setStatus("close"),this.handleCloseEvent(Q),this.invokeReadyDelayedCallbacks(Q),$(Q)})})}disconnect(Z=!1){let $=this.status;if(this.setStatus("disconnecting"),!Z)this.manuallyClosing=!0;if(this.reconnectTimeout&&!Z)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,i1("Canceled reconnecting attempts");if(this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers)this.shardedSubscribers.stop();if($==="wait")this.setStatus("close"),this.handleCloseEvent();else this.connectionPool.reset([])}quit(Z){let $=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null;if(this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers)this.shardedSubscribers.stop();if($==="wait"){let Y=SM.default(Promise.resolve("OK"),Z);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),Y}return SM.default(Promise.all(this.nodes().map((Y)=>Y.quit().catch((Q)=>{if(Q.message===Z6.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw Q}))).then(()=>"OK"),Z)}duplicate(Z=[],$={}){let Y=Z.length>0?Z:this.startupNodes.slice(0),Q=Object.assign({},this.options,$);return new M$(Y,Q)}nodes(Z="all"){if(Z!=="all"&&Z!=="master"&&Z!=="slave")throw new Error('Invalid role "'+Z+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(Z)}delayUntilReady(Z){this._readyDelayedCallbacks.push(Z)}get autoPipelineQueueSize(){let Z=0;for(let $ of this._autoPipelines.values())Z+=$.length;return Z}refreshSlotsCache(Z){if(Z)this._refreshSlotsCacheCallbacks.push(Z);if(this.isRefreshing)return;this.isRefreshing=!0;let $=this,Y=(J)=>{this.isRefreshing=!1;for(let z of this._refreshSlotsCacheCallbacks)z(J);this._refreshSlotsCacheCallbacks=[]},Q=Z6.shuffle(this.connectionPool.getNodes()),X=null;function W(J){if(J===Q.length){let U=new VQ.default(VQ.default.defaultMessage,X);return Y(U)}let z=Q[J],q=`${z.options.host}:${z.options.port}`;i1("getting slot cache from %s",q),$.getInfoFromNode(z,function(U){switch($.status){case"close":case"end":return Y(new Error("Cluster is disconnected."));case"disconnecting":return Y(new Error("Cluster is disconnecting."))}if(U)$.emit("node error",U,q),X=U,W(J+1);else $.emit("refresh"),Y()})}W(0)}sendCommand(Z,$,Y){if(this.status==="wait")this.connect().catch(Z6.noop);if(this.status==="end")return Z.reject(new Error(Z6.CONNECTION_CLOSED_ERROR_MSG)),Z.promise;let Q=this.options.scaleReads;if(Q!=="master"){if(!(Z.isReadOnly||BM.exists(Z.name)&&BM.hasFlag(Z.name,"readonly")))Q="master"}let X=Y?Y.slot:Z.getSlot(),W={},J=this;if(!Y&&!AM.has(Z)){AM.add(Z);let q=Z.reject;Z.reject=function(U){let w=z.bind(null,!0);J.handleError(U,W,{moved:function(M,S){if(i1("command %s is moved to %s",Z.name,S),X=Number(M),J.slots[M])J.slots[M][0]=S;else J.slots[M]=[S];J._groupsBySlot[M]=J._groupsIds[J.slots[M].join(";")],J.connectionPool.findOrCreate(J.natMapper(S)),z(),i1("refreshing slot caches... (triggered by MOVED error)"),J.refreshSlotsCache()},ask:function(M,S){i1("command %s is required to ask %s:%s",Z.name,S);let G=J.natMapper(S);J.connectionPool.findOrCreate(G),z(!1,`${G.host}:${G.port}`)},tryagain:w,clusterDown:w,connectionClosed:w,maxRedirections:function(M){q.call(Z,M)},defaults:function(){q.call(Z,U)}})}}z();function z(q,U){if(J.status==="end"){Z.reject(new w$.AbortError("Cluster is ended."));return}let w;if(J.status==="ready"||Z.name==="cluster"){if(Y&&Y.redis)w=Y.redis;else if(HM.default.checkFlag("ENTER_SUBSCRIBER_MODE",Z.name)||HM.default.checkFlag("EXIT_SUBSCRIBER_MODE",Z.name)){if(J.options.shardedSubscribers==!0&&(Z.name=="ssubscribe"||Z.name=="sunsubscribe")){let M=J.shardedSubscribers.getResponsibleSubscriber(X),S=-1;if(Z.name=="ssubscribe")S=J.shardedSubscribers.addChannels(Z.getKeys());if(Z.name=="sunsubscribe")S=J.shardedSubscribers.removeChannels(Z.getKeys());if(S!==-1)w=M.getInstance();else Z.reject(new w$.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else w=J.subscriber.getInstance();if(!w){Z.reject(new w$.AbortError("No subscriber for the cluster"));return}}else{if(!q){if(typeof X==="number"&&J.slots[X]){let M=J.slots[X];if(typeof Q==="function"){let S=M.map(function(G){return J.connectionPool.getInstanceByKey(G)});if(w=Q(S,Z),Array.isArray(w))w=Z6.sample(w);if(!w)w=S[0]}else{let S;if(Q==="all")S=Z6.sample(M);else if(Q==="slave"&&M.length>1)S=Z6.sample(M,1);else S=M[0];w=J.connectionPool.getInstanceByKey(S)}}if(U)w=J.connectionPool.getInstanceByKey(U),w.asking()}if(!w)w=(typeof Q==="function"?null:J.connectionPool.getSampleInstance(Q))||J.connectionPool.getSampleInstance("all")}if(Y&&!Y.redis)Y.redis=w}if(w)w.sendCommand(Z,$);else if(J.options.enableOfflineQueue)J.offlineQueue.push({command:Z,stream:$,node:Y});else Z.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return Z.promise}sscanStream(Z,$){return this.createScanStream("sscan",{key:Z,options:$})}sscanBufferStream(Z,$){return this.createScanStream("sscanBuffer",{key:Z,options:$})}hscanStream(Z,$){return this.createScanStream("hscan",{key:Z,options:$})}hscanBufferStream(Z,$){return this.createScanStream("hscanBuffer",{key:Z,options:$})}zscanStream(Z,$){return this.createScanStream("zscan",{key:Z,options:$})}zscanBufferStream(Z,$){return this.createScanStream("zscanBuffer",{key:Z,options:$})}handleError(Z,$,Y){if(typeof $.value==="undefined")$.value=this.options.maxRedirections;else $.value-=1;if($.value<=0){Y.maxRedirections(new Error("Too many Cluster redirections. Last error: "+Z));return}let Q=Z.message.split(" ");if(Q[0]==="MOVED"){let X=this.options.retryDelayOnMoved;if(X&&typeof X==="number")this.delayQueue.push("moved",Y.moved.bind(null,Q[1],Q[2]),{timeout:X});else Y.moved(Q[1],Q[2])}else if(Q[0]==="ASK")Y.ask(Q[1],Q[2]);else if(Q[0]==="TRYAGAIN")this.delayQueue.push("tryagain",Y.tryagain,{timeout:this.options.retryDelayOnTryAgain});else if(Q[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0)this.delayQueue.push("clusterdown",Y.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)});else if(Z.message===Z6.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready")this.delayQueue.push("failover",Y.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)});else Y.defaults()}resetOfflineQueue(){this.offlineQueue=new DM}clearNodesRefreshInterval(){if(this.slotsTimer)clearTimeout(this.slotsTimer),this.slotsTimer=null}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let Z=()=>{this.slotsTimer=setTimeout(()=>{i1('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{Z()})},this.options.slotsRefreshInterval)};Z()}setStatus(Z){i1("status: %s -> %s",this.status||"[empty]",Z),this.status=Z,process.nextTick(()=>{this.emit(Z)})}handleCloseEvent(Z){if(Z)i1("closed because %s",Z);let $;if(!this.manuallyClosing&&typeof this.options.clusterRetryStrategy==="function")$=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,Z);if(typeof $==="number")this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,i1("Cluster is disconnected. Retrying after %dms",$),this.connect().catch(function(Y){i1("Got error %s when reconnecting. Ignoring...",Y)})},$);else this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available"))}flushQueue(Z){let $;while($=this.offlineQueue.shift())$.command.reject(Z)}executeOfflineCommands(){if(this.offlineQueue.length){i1("send %d commands in offline queue",this.offlineQueue.length);let Z=this.offlineQueue;this.resetOfflineQueue();let $;while($=Z.shift())this.sendCommand($.command,$.stream,$.node)}}natMapper(Z){let $=typeof Z==="string"?Z:`${Z.host}:${Z.port}`,Y=null;if(this.options.natMap&&typeof this.options.natMap==="function")Y=this.options.natMap($);else if(this.options.natMap&&typeof this.options.natMap==="object")Y=this.options.natMap[$];if(Y)return i1("NAT mapping %s -> %O",$,Y),Object.assign({},Y);return typeof Z==="string"?SZ.nodeKeyToRedisOptions(Z):Z}getInfoFromNode(Z,$){if(!Z)return $(new Error("Node is disconnected"));let Y=Z.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:SZ.getConnectionName("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});Y.on("error",Z6.noop),Y.cluster("SLOTS",Z6.timeout((Q,X)=>{if(Y.disconnect(),Q)return i1("error encountered running CLUSTER.SLOTS: %s",Q),$(Q);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){i1("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",X.length,this.status),$();return}let W=[];i1("cluster slots result count: %d",X.length);for(let z=0;z<X.length;++z){let q=X[z],U=q[0],w=q[1],M=[];for(let S=2;S<q.length;S++){if(!q[S][0])continue;let G=this.natMapper({host:q[S][0],port:q[S][1]});G.readOnly=S!==2,W.push(G),M.push(G.host+":"+G.port)}i1("cluster slots result [%d]: slots %d~%d served by %s",z,U,w,M);for(let S=U;S<=w;S++)this.slots[S]=M}this._groupsIds=Object.create(null);let J=0;for(let z=0;z<16384;z++){let q=(this.slots[z]||[]).join(";");if(!q.length){this._groupsBySlot[z]=void 0;continue}if(!this._groupsIds[q])this._groupsIds[q]=++J;this._groupsBySlot[z]=this._groupsIds[q]}this.connectionPool.reset(W),$()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(Z){for(let $ of this._readyDelayedCallbacks)process.nextTick($,Z);this._readyDelayedCallbacks=[]}readyCheck(Z){this.cluster("INFO",($,Y)=>{if($)return Z($);if(typeof Y!=="string")return Z();let Q,X=Y.split(`\r
`);for(let W=0;W<X.length;++W){let J=X[W].split(":");if(J[0]==="cluster_state"){Q=J[1];break}}if(Q==="fail")i1("cluster state not ok (%s)",Q),Z(null,Q);else Z()})}resolveSrv(Z){return new Promise(($,Y)=>{this.options.resolveSrv(Z,(Q,X)=>{if(Q)return Y(Q);let W=this,J=SZ.groupSrvRecords(X),z=Object.keys(J).sort((U,w)=>parseInt(U)-parseInt(w));function q(U){if(!z.length)return Y(U);let w=z[0],M=J[w],S=SZ.weightSrvRecords(M);if(!M.records.length)z.shift();W.dnsLookup(S.name).then((G)=>$({host:G,port:S.port}),q)}q()})})}dnsLookup(Z){return new Promise(($,Y)=>{this.options.dnsLookup(Z,(Q,X)=>{if(Q)i1("failed to resolve hostname %s to IP: %s",Z,Q.message),Y(Q);else i1("resolved hostname %s to IP %s",Z,X),$(X)})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let Z=SZ.normalizeNodeOptions(this.startupNodes),$=SZ.getUniqueHostnamesFromOptions(Z);if($.length===0)return Z;let Y=await Promise.all($.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),Q=Z6.zipMap($,Y);return Z.map((X)=>{let W=Q.get(X.host);if(!W)return X;if(this.options.useSRVRecords)return Object.assign({},X,W);return Object.assign({},X,{host:W})})}createScanStream(Z,{key:$,options:Y={}}){return new JT.default({objectMode:!0,key:$,redis:this,command:Z,...Y})}}qT.default(M$,NM.EventEmitter);zT.addTransactionSupport(M$.prototype);LM.default=M$});var XY=j((FM)=>{Object.defineProperty(FM,"__esModule",{value:!0});var DT=M0(),AT=DT.Debug("AbstractConnector");class OM{constructor(Z){this.connecting=!1,this.disconnectTimeout=Z}check(Z){return!0}disconnect(){if(this.connecting=!1,this.stream){let Z=this.stream,$=setTimeout(()=>{AT("stream %s:%s still open, destroying it",Z.remoteAddress,Z.remotePort),Z.destroy()},this.disconnectTimeout);Z.on("close",()=>clearTimeout($)),Z.end()}}}FM.default=OM});var jM=j((PM)=>{Object.defineProperty(PM,"__esModule",{value:!0});var LT=z1("net"),OT=z1("tls"),FT=M0(),KT=XY();class KM extends KT.default{constructor(Z){super(Z.disconnectTimeout);this.options=Z}connect(Z){let{options:$}=this;this.connecting=!0;let Y;if("path"in $&&$.path)Y={path:$.path};else{if(Y={},"port"in $&&$.port!=null)Y.port=$.port;if("host"in $&&$.host!=null)Y.host=$.host;if("family"in $&&$.family!=null)Y.family=$.family}if($.tls)Object.assign(Y,$.tls);return new Promise((Q,X)=>{process.nextTick(()=>{if(!this.connecting){X(new Error(FT.CONNECTION_CLOSED_ERROR_MSG));return}try{if($.tls)this.stream=OT.connect(Y);else this.stream=LT.createConnection(Y)}catch(W){X(W);return}this.stream.once("error",(W)=>{this.firstError=W}),Q(this.stream)})})}}PM.default=KM});var CM=j((_M)=>{Object.defineProperty(_M,"__esModule",{value:!0});function jT(Z,$){return(Z.host||"127.0.0.1")===($.host||"127.0.0.1")&&(Z.port||26379)===($.port||26379)}class RM{constructor(Z){this.cursor=0,this.sentinels=Z.slice(0)}next(){let Z=this.cursor>=this.sentinels.length;return{done:Z,value:Z?void 0:this.sentinels[this.cursor++]}}reset(Z){if(Z&&this.sentinels.length>1&&this.cursor!==1)this.sentinels.unshift(...this.sentinels.splice(this.cursor-1));this.cursor=0}add(Z){for(let $=0;$<this.sentinels.length;$++)if(jT(Z,this.sentinels[$]))return!1;return this.sentinels.push(Z),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}_M.default=RM});var TM=j((IM)=>{Object.defineProperty(IM,"__esModule",{value:!0});IM.FailoverDetector=void 0;var _T=M0(),IQ=_T.Debug("FailoverDetector"),VM="+switch-master";class EM{constructor(Z,$){this.isDisconnected=!1,this.connector=Z,this.sentinels=$}cleanup(){this.isDisconnected=!0;for(let Z of this.sentinels)Z.client.disconnect()}async subscribe(){IQ("Starting FailoverDetector");let Z=[];for(let $ of this.sentinels){let Y=$.client.subscribe(VM).catch((Q)=>{IQ("Failed to subscribe to failover messages on sentinel %s:%s (%s)",$.address.host||"127.0.0.1",$.address.port||26739,Q.message)});Z.push(Y),$.client.on("message",(Q)=>{if(!this.isDisconnected&&Q===VM)this.disconnect()})}await Promise.all(Z)}disconnect(){this.isDisconnected=!0,IQ("Failover detected, disconnecting"),this.connector.disconnect()}}IM.FailoverDetector=EM});var WY=j((fM)=>{Object.defineProperty(fM,"__esModule",{value:!0});fM.SentinelIterator=void 0;var CT=z1("net"),G$=M0(),VT=z1("tls"),bM=CM();fM.SentinelIterator=bM.default;var ET=XY(),IT=l8(),xT=TM(),HZ=G$.Debug("SentinelConnector");class kM extends ET.default{constructor(Z){super(Z.disconnectTimeout);if(this.options=Z,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new bM.default(this.options.sentinels)}check(Z){let $=!Z.role||this.options.role===Z.role;if(!$)HZ("role invalid, expected %s, but got %s",this.options.role,Z.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0);return $}disconnect(){if(super.disconnect(),this.failoverDetector)this.failoverDetector.cleanup()}connect(Z){this.connecting=!0,this.retryAttempts=0;let $,Y=async()=>{let Q=this.sentinelIterator.next();if(Q.done){this.sentinelIterator.reset(!1);let z=typeof this.options.sentinelRetryStrategy==="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,q=typeof z!=="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${z}ms.`;if($)q+=` Last error: ${$.message}`;HZ(q);let U=new Error(q);if(typeof z==="number")return Z("error",U),await new Promise((w)=>setTimeout(w,z)),Y();else throw U}let X=null,W=null;try{X=await this.resolve(Q.value)}catch(z){W=z}if(!this.connecting)throw new Error(G$.CONNECTION_CLOSED_ERROR_MSG);let J=Q.value.host+":"+Q.value.port;if(X){if(HZ("resolved: %s:%s from sentinel %s",X.host,X.port,J),this.options.enableTLSForSentinelMode&&this.options.tls)Object.assign(X,this.options.tls),this.stream=VT.connect(X),this.stream.once("secureConnect",this.initFailoverDetector.bind(this));else this.stream=CT.createConnection(X),this.stream.once("connect",this.initFailoverDetector.bind(this));return this.stream.once("error",(z)=>{this.firstError=z}),this.stream}else{let z=W?"failed to connect to sentinel "+J+" because "+W.message:"connected to sentinel "+J+" successfully, but got an invalid reply: "+X;if(HZ(z),Z("sentinelError",new Error(z)),W)$=W;return Y()}};return Y()}async updateSentinels(Z){if(!this.options.updateSentinels)return;let $=await Z.sentinel("sentinels",this.options.name);if(!Array.isArray($))return;$.map(G$.packObject).forEach((Y)=>{if((Y.flags?Y.flags.split(","):[]).indexOf("disconnected")===-1&&Y.ip&&Y.port){let X=this.sentinelNatResolve(gM(Y));if(this.sentinelIterator.add(X))HZ("adding sentinel %s:%s",X.host,X.port)}}),HZ("Updated internal sentinels: %s",this.sentinelIterator)}async resolveMaster(Z){let $=await Z.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(Z),this.sentinelNatResolve(Array.isArray($)?{host:$[0],port:Number($[1])}:null)}async resolveSlave(Z){let $=await Z.sentinel("slaves",this.options.name);if(!Array.isArray($))return null;let Y=$.map(G$.packObject).filter((Q)=>Q.flags&&!Q.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(TT(Y,this.options.preferredSlaves))}sentinelNatResolve(Z){if(!Z||!this.options.natMap)return Z;let $=`${Z.host}:${Z.port}`,Y=Z;if(typeof this.options.natMap==="function")Y=this.options.natMap($)||Z;else if(typeof this.options.natMap==="object")Y=this.options.natMap[$]||Z;return Y}connectToSentinel(Z,$){return new IT.default({port:Z.port||26379,host:Z.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:Z.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...$})}async resolve(Z){let $=this.connectToSentinel(Z);$.on("error",bT);try{if(this.options.role==="slave")return await this.resolveSlave($);else return await this.resolveMaster($)}finally{$.disconnect()}}async initFailoverDetector(){var Z;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let $=[];while($.length<this.options.sentinelMaxConnections){let{done:Y,value:Q}=this.sentinelIterator.next();if(Y)break;let X=this.connectToSentinel(Q,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});X.on("reconnecting",()=>{var W;(W=this.emitter)===null||W===void 0||W.emit("sentinelReconnecting")}),$.push({address:Q,client:X})}if(this.sentinelIterator.reset(!1),this.failoverDetector)this.failoverDetector.cleanup();this.failoverDetector=new xT.FailoverDetector(this,$),await this.failoverDetector.subscribe(),(Z=this.emitter)===null||Z===void 0||Z.emit("failoverSubscribed")}}fM.default=kM;function TT(Z,$){if(Z.length===0)return null;let Y;if(typeof $==="function")Y=$(Z);else if($!==null&&typeof $==="object"){let Q=Array.isArray($)?$:[$];Q.sort((X,W)=>{if(!X.prio)X.prio=1;if(!W.prio)W.prio=1;if(X.prio<W.prio)return-1;if(X.prio>W.prio)return 1;return 0});for(let X=0;X<Q.length;X++){for(let W=0;W<Z.length;W++){let J=Z[W];if(J.ip===Q[X].ip){if(J.port===Q[X].port){Y=J;break}}}if(Y)break}}if(!Y)Y=G$.sample(Z);return gM(Y)}function gM(Z){return{host:Z.ip,port:Number(Z.port)}}function bT(){}});var hM=j((vM)=>{Object.defineProperty(vM,"__esModule",{value:!0});vM.SentinelConnector=vM.StandaloneConnector=void 0;var gT=jM();vM.StandaloneConnector=gT.default;var fT=WY();vM.SentinelConnector=fT.default});var pM=j((uM)=>{Object.defineProperty(uM,"__esModule",{value:!0});var vT=F4();class mM extends vT.AbortError{constructor(Z){let $=`Reached the max retries per request limit (which is ${Z}). Refer to "maxRetriesPerRequest" option for details.`;super($);Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}uM.default=mM});var lM=j((cM)=>{Object.defineProperty(cM,"__esModule",{value:!0});cM.MaxRetriesPerRequestError=void 0;var hT=pM();cM.MaxRetriesPerRequestError=hT.default});var ZG=j((ys,eM)=>{var gQ=z1("buffer").Buffer,mT=z1("string_decoder").StringDecoder,xQ=new mT,nM=F4(),uT=nM.ReplyError,pT=nM.ParserError,u6=gQ.allocUnsafe(32768),R0=0,JY=null,B$=0,TQ=0;function cT(Z){let $=Z.buffer.length-1;var Y=Z.offset,Q=0,X=1;if(Z.buffer[Y]===45)X=-1,Y++;while(Y<$){let W=Z.buffer[Y++];if(W===13)return Z.offset=Y+1,X*Q;Q=Q*10+(W-48)}}function iT(Z){let $=Z.buffer.length-1;var Y=Z.offset,Q=0,X="";if(Z.buffer[Y]===45)X+="-",Y++;while(Y<$){var W=Z.buffer[Y++];if(W===13){if(Z.offset=Y+1,Q!==0)X+=Q;return X}else if(Q>429496728)X+=Q*10+(W-48),Q=0;else if(W===48&&Q===0)X+=0;else Q=Q*10+(W-48)}}function oM(Z){let{offset:$,buffer:Y}=Z,Q=Y.length-1;var X=$;while(X<Q)if(Y[X++]===13){if(Z.offset=X+1,Z.optionReturnBuffers===!0)return Z.buffer.slice($,X-1);return Z.buffer.toString("utf8",$,X-1)}}function tM(Z){let $=Z.buffer.length-1;var Y=Z.offset,Q=0;while(Y<$){let X=Z.buffer[Y++];if(X===13)return Z.offset=Y+1,Q;Q=Q*10+(X-48)}}function lT(Z){if(Z.optionStringNumbers===!0)return iT(Z);return cT(Z)}function nT(Z){let $=tM(Z);if($===void 0)return;if($<0)return null;let Y=Z.offset+$;if(Y+2>Z.buffer.length){Z.bigStrSize=Y+2,Z.totalChunkSize=Z.buffer.length,Z.bufferCache.push(Z.buffer);return}let Q=Z.offset;if(Z.offset=Y+2,Z.optionReturnBuffers===!0)return Z.buffer.slice(Q,Y);return Z.buffer.toString("utf8",Q,Y)}function oT(Z){var $=oM(Z);if($!==void 0){if(Z.optionReturnBuffers===!0)$=$.toString();return new uT($)}}function tT(Z,$){let Y=new pT("Protocol error, got "+JSON.stringify(String.fromCharCode($))+" as reply type byte",JSON.stringify(Z.buffer),Z.offset);Z.buffer=null,Z.returnFatalError(Y)}function sT(Z){let $=tM(Z);if($===void 0)return;if($<0)return null;let Y=new Array($);return sM(Z,Y,0)}function bQ(Z,$,Y){Z.arrayCache.push($),Z.arrayPos.push(Y)}function kQ(Z){let $=Z.arrayCache.pop();var Y=Z.arrayPos.pop();if(Z.arrayCache.length){let Q=kQ(Z);if(Q===void 0){bQ(Z,$,Y);return}$[Y++]=Q}return sM(Z,$,Y)}function sM(Z,$,Y){let Q=Z.buffer.length;while(Y<$.length){let X=Z.offset;if(Z.offset>=Q){bQ(Z,$,Y);return}let W=rM(Z,Z.buffer[Z.offset++]);if(W===void 0){if(!(Z.arrayCache.length||Z.bufferCache.length))Z.offset=X;bQ(Z,$,Y);return}$[Y]=W,Y++}return $}function rM(Z,$){switch($){case 36:return nT(Z);case 43:return oM(Z);case 42:return sT(Z);case 58:return lT(Z);case 45:return oT(Z);default:return tT(Z,$)}}function rT(){if(u6.length>51200)if(B$===1||TQ>B$*2){let Z=Math.floor(u6.length/10),$=Z<R0?R0:Z;R0=0,u6=u6.slice($,u6.length)}else TQ++,B$--;else clearInterval(JY),B$=0,TQ=0,JY=null}function aT(Z){if(u6.length<Z+R0){let $=Z>78643200?2:3;if(R0>116391936)R0=52428800;if(u6=gQ.allocUnsafe(Z*$+R0),R0=0,B$++,JY===null)JY=setInterval(rT,50)}}function eT(Z){let{bufferCache:$,offset:Y}=Z;var Q=$.length,X=Z.bigStrSize-Z.totalChunkSize;if(Z.offset=X,X<=2){if(Q===2)return $[0].toString("utf8",Y,$[0].length+X-2);Q--,X=$[$.length-2].length+X}var W=xQ.write($[0].slice(Y));for(var J=1;J<Q-1;J++)W+=xQ.write($[J]);return W+=xQ.end($[J].slice(0,X-2)),W}function Zb(Z){let{bufferCache:$,offset:Y}=Z,Q=Z.bigStrSize-Y-2;var X=$.length,W=Z.bigStrSize-Z.totalChunkSize;if(Z.offset=W,W<=2){if(X===2)return $[0].slice(Y,$[0].length+W-2);X--,W=$[$.length-2].length+W}aT(Q);let J=R0;$[0].copy(u6,J,Y,$[0].length),R0+=$[0].length-Y;for(var z=1;z<X-1;z++)$[z].copy(u6,R0),R0+=$[z].length;return $[z].copy(u6,R0,0,W-2),R0+=W-2,u6.slice(J,R0)}class aM{constructor(Z){if(!Z)throw new TypeError("Options are mandatory.");if(typeof Z.returnError!=="function"||typeof Z.returnReply!=="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!Z.returnBuffers),this.setStringNumbers(!!Z.stringNumbers),this.returnError=Z.returnError,this.returnFatalError=Z.returnFatalError||Z.returnError,this.returnReply=Z.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(Z){if(typeof Z!=="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=Z}setStringNumbers(Z){if(typeof Z!=="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=Z}execute(Z){if(this.buffer===null)this.buffer=Z,this.offset=0;else if(this.bigStrSize===0){let Y=this.buffer.length,Q=Y-this.offset,X=gQ.allocUnsafe(Q+Z.length);if(this.buffer.copy(X,0,this.offset,Y),Z.copy(X,Q,0,Z.length),this.buffer=X,this.offset=0,this.arrayCache.length){let W=kQ(this);if(W===void 0)return;this.returnReply(W)}}else if(this.totalChunkSize+Z.length>=this.bigStrSize){this.bufferCache.push(Z);var $=this.optionReturnBuffers?Zb(this):eT(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=Z,this.arrayCache.length){if(this.arrayCache[0][this.arrayPos[0]++]=$,$=kQ(this),$===void 0)return}this.returnReply($)}else{this.bufferCache.push(Z),this.totalChunkSize+=Z.length;return}while(this.offset<this.buffer.length){let Y=this.offset,Q=this.buffer[this.offset++],X=rM(this,Q);if(X===void 0){if(!(this.arrayCache.length||this.bufferCache.length))this.offset=Y;return}if(Q===45)this.returnError(X);else this.returnReply(X)}this.buffer=null}}eM.exports=aM});var QG=j((YG)=>{Object.defineProperty(YG,"__esModule",{value:!0});class $G{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(Z,$){this.set[fQ(Z)][$]=!0}del(Z,$){delete this.set[fQ(Z)][$]}channels(Z){return Object.keys(this.set[fQ(Z)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}}YG.default=$G;function fQ(Z){if(Z==="unsubscribe")return"subscribe";if(Z==="punsubscribe")return"psubscribe";if(Z==="sunsubscribe")return"ssubscribe";return Z}});var UG=j((qG)=>{Object.defineProperty(qG,"__esModule",{value:!0});var XG=N8(),Yb=M0(),Qb=ZG(),Xb=QG(),Wb=Yb.Debug("dataHandler");class zG{constructor(Z,$){this.redis=Z;let Y=new Qb({stringNumbers:$.stringNumbers,returnBuffers:!0,returnError:(Q)=>{this.returnError(Q)},returnFatalError:(Q)=>{this.returnFatalError(Q)},returnReply:(Q)=>{this.returnReply(Q)}});Z.stream.prependListener("data",(Q)=>{Y.execute(Q)}),Z.stream.resume()}returnFatalError(Z){Z.message+=". Please report this.",this.redis.recoverFromFatalError(Z,Z,{offlineQueue:!1})}returnError(Z){let $=this.shiftCommand(Z);if(!$)return;Z.command={name:$.command.name,args:$.command.args},this.redis.handleReconnection(Z,$)}returnReply(Z){if(this.handleMonitorReply(Z))return;if(this.handleSubscriberReply(Z))return;let $=this.shiftCommand(Z);if(!$)return;if(XG.default.checkFlag("ENTER_SUBSCRIBER_MODE",$.command.name)){if(this.redis.condition.subscriber=new Xb.default,this.redis.condition.subscriber.add($.command.name,Z[1].toString()),!WG($.command,Z[2]))this.redis.commandQueue.unshift($)}else if(XG.default.checkFlag("EXIT_SUBSCRIBER_MODE",$.command.name)){if(!JG($.command,Z[2]))this.redis.commandQueue.unshift($)}else $.command.resolve(Z)}handleSubscriberReply(Z){if(!this.redis.condition.subscriber)return!1;let $=Array.isArray(Z)?Z[0].toString():null;switch(Wb('receive reply "%s" in subscriber mode',$),$){case"message":if(this.redis.listeners("message").length>0)this.redis.emit("message",Z[1].toString(),Z[2]?Z[2].toString():"");this.redis.emit("messageBuffer",Z[1],Z[2]);break;case"pmessage":{let Y=Z[1].toString();if(this.redis.listeners("pmessage").length>0)this.redis.emit("pmessage",Y,Z[2].toString(),Z[3].toString());this.redis.emit("pmessageBuffer",Y,Z[2],Z[3]);break}case"smessage":{if(this.redis.listeners("smessage").length>0)this.redis.emit("smessage",Z[1].toString(),Z[2]?Z[2].toString():"");this.redis.emit("smessageBuffer",Z[1],Z[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let Y=Z[1].toString();this.redis.condition.subscriber.add($,Y);let Q=this.shiftCommand(Z);if(!Q)return;if(!WG(Q.command,Z[2]))this.redis.commandQueue.unshift(Q);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let Y=Z[1]?Z[1].toString():null;if(Y)this.redis.condition.subscriber.del($,Y);let Q=Z[2];if(Number(Q)===0)this.redis.condition.subscriber=!1;let X=this.shiftCommand(Z);if(!X)return;if(!JG(X.command,Q))this.redis.commandQueue.unshift(X);break}default:{let Y=this.shiftCommand(Z);if(!Y)return;Y.command.resolve(Z)}}return!0}handleMonitorReply(Z){if(this.redis.status!=="monitoring")return!1;let $=Z.toString();if($==="OK")return!1;let Y=$.indexOf(" "),Q=$.slice(0,Y),X=$.indexOf('"'),W=$.slice(X+1,-1).split('" "').map((z)=>z.replace(/\\"/g,'"')),J=$.slice(Y+2,X-2).split(" ");return this.redis.emit("monitor",Q,W,J[1],J[0]),!0}shiftCommand(Z){let $=this.redis.commandQueue.shift();if(!$){let Q=new Error("Command queue state error. If you can reproduce this, please report it."+(Z instanceof Error?` Last error: ${Z.message}`:` Last reply: ${Z.toString()}`));return this.redis.emit("error",Q),null}return $}}qG.default=zG;var n8=new WeakMap;function WG(Z,$){let Y=n8.has(Z)?n8.get(Z):Z.args.length;if(Y-=1,Y<=0)return Z.resolve($),n8.delete(Z),!0;return n8.set(Z,Y),!1}function JG(Z,$){let Y=n8.has(Z)?n8.get(Z):Z.args.length;if(Y===0){if(Number($)===0)return n8.delete(Z),Z.resolve($),!0;return!1}if(Y-=1,Y<=0)return Z.resolve($),!0;return n8.set(Z,Y),!1}});var MG=j((wG)=>{Object.defineProperty(wG,"__esModule",{value:!0});wG.readyHandler=wG.errorHandler=wG.closeHandler=wG.connectHandler=void 0;var zb=F4(),qb=N8(),Ub=lM(),S$=M0(),wb=UG(),L0=S$.Debug("connection");function Mb(Z){return function(){Z.setStatus("connect"),Z.resetCommandQueue();let $=!1,{connectionEpoch:Y}=Z;if(Z.condition.auth)Z.auth(Z.condition.auth,function(Q){if(Y!==Z.connectionEpoch)return;if(Q)if(Q.message.indexOf("no password is set")!==-1)console.warn("[WARN] Redis server does not require a password, but a password was supplied.");else if(Q.message.indexOf("without any password configured for the default user")!==-1)console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied");else if(Q.message.indexOf("wrong number of arguments for 'auth' command")!==-1)console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`);else $=!0,Z.recoverFromFatalError(Q,Q)});if(Z.condition.select)Z.select(Z.condition.select).catch((Q)=>{Z.silentEmit("error",Q)});if(!Z.options.enableReadyCheck)wG.readyHandler(Z)();if(new wb.default(Z,{stringNumbers:Z.options.stringNumbers}),Z.options.enableReadyCheck)Z._readyCheck(function(Q,X){if(Y!==Z.connectionEpoch)return;if(Q){if(!$)Z.recoverFromFatalError(new Error("Ready check failed: "+Q.message),Q)}else if(Z.connector.check(X))wG.readyHandler(Z)();else Z.disconnect(!0)})}}wG.connectHandler=Mb;function yQ(Z){let $=new zb.AbortError("Command aborted due to connection close");return $.command={name:Z.name,args:Z.args},$}function Gb(Z){var $;let Y=0;for(let Q=0;Q<Z.length;){let X=($=Z.peekAt(Q))===null||$===void 0?void 0:$.command,W=X.pipelineIndex;if(W===void 0||W===0)Y=0;if(W!==void 0&&W!==Y++){Z.remove(Q,1),X.reject(yQ(X));continue}Q++}}function Bb(Z){var $;for(let Y=0;Y<Z.length;){let Q=($=Z.peekAt(Y))===null||$===void 0?void 0:$.command;if(Q.name==="multi")break;if(Q.name==="exec"){Z.remove(Y,1),Q.reject(yQ(Q));break}if(Q.inTransaction)Z.remove(Y,1),Q.reject(yQ(Q));else Y++}}function Sb(Z){return function(){let Y=Z.status;if(Z.setStatus("close"),Z.commandQueue.length)Gb(Z.commandQueue);if(Z.offlineQueue.length)Bb(Z.offlineQueue);if(Y==="ready"){if(!Z.prevCondition)Z.prevCondition=Z.condition;if(Z.commandQueue.length)Z.prevCommandQueue=Z.commandQueue}if(Z.manuallyClosing)return Z.manuallyClosing=!1,L0("skip reconnecting since the connection is manually closed."),$();if(typeof Z.options.retryStrategy!=="function")return L0("skip reconnecting because `retryStrategy` is not a function"),$();let Q=Z.options.retryStrategy(++Z.retryAttempts);if(typeof Q!=="number")return L0("skip reconnecting because `retryStrategy` doesn't return a number"),$();L0("reconnect in %sms",Q),Z.setStatus("reconnecting",Q),Z.reconnectTimeout=setTimeout(function(){Z.reconnectTimeout=null,Z.connect().catch(S$.noop)},Q);let{maxRetriesPerRequest:X}=Z.options;if(typeof X==="number"){if(X<0)L0("maxRetriesPerRequest is negative, ignoring...");else if(Z.retryAttempts%(X+1)===0)L0("reach maxRetriesPerRequest limitation, flushing command queue..."),Z.flushQueue(new Ub.MaxRetriesPerRequestError(X))}};function $(){Z.setStatus("end"),Z.flushQueue(new Error(S$.CONNECTION_CLOSED_ERROR_MSG))}}wG.closeHandler=Sb;function Hb(Z){return function($){L0("error: %s",$),Z.silentEmit("error",$)}}wG.errorHandler=Hb;function Db(Z){return function(){if(Z.setStatus("ready"),Z.retryAttempts=0,Z.options.monitor){Z.call("monitor").then(()=>Z.setStatus("monitoring"),(Q)=>Z.emit("error",Q));let{sendCommand:Y}=Z;Z.sendCommand=function(Q){if(qb.default.checkFlag("VALID_IN_MONITOR_MODE",Q.name))return Y.call(Z,Q);return Q.reject(new Error("Connection is in monitoring mode, can't process commands.")),Q.promise},Z.once("close",function(){delete Z.sendCommand});return}let $=Z.prevCondition?Z.prevCondition.select:Z.condition.select;if(Z.options.connectionName)L0("set the connection name [%s]",Z.options.connectionName),Z.client("setname",Z.options.connectionName).catch(S$.noop);if(Z.options.readOnly)L0("set the connection to readonly mode"),Z.readonly().catch(S$.noop);if(Z.prevCondition){let Y=Z.prevCondition;if(Z.prevCondition=null,Y.subscriber&&Z.options.autoResubscribe){if(Z.condition.select!==$)L0("connect to db [%d]",$),Z.select($);let Q=Y.subscriber.channels("subscribe");if(Q.length)L0("subscribe %d channels",Q.length),Z.subscribe(Q);let X=Y.subscriber.channels("psubscribe");if(X.length)L0("psubscribe %d channels",X.length),Z.psubscribe(X);let W=Y.subscriber.channels("ssubscribe");if(W.length)L0("ssubscribe %d channels",W.length),Z.ssubscribe(W)}}if(Z.prevCommandQueue)if(Z.options.autoResendUnfulfilledCommands){L0("resend %d unfulfilled commands",Z.prevCommandQueue.length);while(Z.prevCommandQueue.length>0){let Y=Z.prevCommandQueue.shift();if(Y.select!==Z.condition.select&&Y.command.name!=="select")Z.select(Y.select);Z.sendCommand(Y.command,Y.stream)}}else Z.prevCommandQueue=null;if(Z.offlineQueue.length){L0("send %d commands in offline queue",Z.offlineQueue.length);let Y=Z.offlineQueue;Z.resetOfflineQueue();while(Y.length>0){let Q=Y.shift();if(Q.select!==Z.condition.select&&Q.command.name!=="select")Z.select(Q.select);Z.sendCommand(Q.command,Q.stream)}}if(Z.condition.select!==$)L0("connect to db [%d]",$),Z.select($)}}wG.readyHandler=Db});var SG=j((GG)=>{Object.defineProperty(GG,"__esModule",{value:!0});GG.DEFAULT_REDIS_OPTIONS=void 0;GG.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2000,retryStrategy:function(Z){return Math.min(Z*50,2000)},keepAlive:0,noDelay:!0,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(Z){return Math.min(Z*10,1000)},sentinelReconnectStrategy:function(){return 60000},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var l8=j((NG)=>{Object.defineProperty(NG,"__esModule",{value:!0});var HG=MZ(),AG=z1("events"),vQ=p8(),Ob=EQ(),dQ=N8(),Fb=hM(),Kb=WY(),o8=MG(),Pb=SG(),jb=r9(),Rb=KQ(),R4=M0(),_b=PQ(),Cb=ZY(),t8=i9(),DG=YY(),s8=R4.Debug("redis");class e6 extends Cb.default{constructor(Z,$,Y){super();if(this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(Z,$,Y),AG.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let Q=new Kb.default(this.options);Q.emitter=this,this.connector=Q}else this.connector=new Fb.StandaloneConnector(this.options);if(this.options.scripts)Object.entries(this.options.scripts).forEach(([Q,X])=>{this.defineCommand(Q,X)});if(this.options.lazyConnect)this.setStatus("wait");else this.connect().catch(t8.noop)}static createClient(...Z){return new e6(...Z)}get autoPipelineQueueSize(){let Z=0;for(let $ of this._autoPipelines.values())Z+=$.length;return Z}connect(Z){let $=new Promise((Y,Q)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){Q(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:X}=this;this.condition={select:X.db,auth:X.username?[X.username,X.password]:X.password,subscriber:!1};let W=this;vQ.default(this.connector.connect(function(J,z){W.silentEmit(J,z)}),function(J,z){if(J){W.flushQueue(J),W.silentEmit("error",J),Q(J),W.setStatus("end");return}let q=X.tls?"secureConnect":"connect";if("sentinels"in X&&X.sentinels&&!X.enableTLSForSentinelMode)q="connect";if(W.stream=z,X.noDelay)z.setNoDelay(!0);if(typeof X.keepAlive==="number")if(z.connecting)z.once(q,()=>{z.setKeepAlive(!0,X.keepAlive)});else z.setKeepAlive(!0,X.keepAlive);if(z.connecting){if(z.once(q,o8.connectHandler(W)),X.connectTimeout){let M=!1;z.setTimeout(X.connectTimeout,function(){if(M)return;z.setTimeout(0),z.destroy();let S=new Error("connect ETIMEDOUT");S.errorno="ETIMEDOUT",S.code="ETIMEDOUT",S.syscall="connect",o8.errorHandler(W)(S)}),z.once(q,function(){M=!0,z.setTimeout(0)})}}else if(z.destroyed){let M=W.connector.firstError;if(M)process.nextTick(()=>{o8.errorHandler(W)(M)});process.nextTick(o8.closeHandler(W))}else process.nextTick(o8.connectHandler(W));if(!z.destroyed)z.once("error",o8.errorHandler(W)),z.once("close",o8.closeHandler(W));let U=function(){W.removeListener("close",w),Y()};var w=function(){W.removeListener("ready",U),Q(new Error(R4.CONNECTION_CLOSED_ERROR_MSG))};W.once("ready",U),W.once("close",w)})});return vQ.default($,Z)}disconnect(Z=!1){if(!Z)this.manuallyClosing=!0;if(this.reconnectTimeout&&!Z)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null;if(this.status==="wait")o8.closeHandler(this)();else this.connector.disconnect()}end(){this.disconnect()}duplicate(Z){return new e6({...this.options,...Z})}get mode(){var Z;return this.options.monitor?"monitor":((Z=this.condition)===null||Z===void 0?void 0:Z.subscriber)?"subscriber":"normal"}monitor(Z){let $=this.duplicate({monitor:!0,lazyConnect:!1});return vQ.default(new Promise(function(Y,Q){$.once("error",Q),$.once("monitoring",function(){Y($)})}),Z)}sendCommand(Z,$){var Y,Q;if(this.status==="wait")this.connect().catch(t8.noop);if(this.status==="end")return Z.reject(new Error(R4.CONNECTION_CLOSED_ERROR_MSG)),Z.promise;if(((Y=this.condition)===null||Y===void 0?void 0:Y.subscriber)&&!dQ.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",Z.name))return Z.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),Z.promise;if(typeof this.options.commandTimeout==="number")Z.setTimeout(this.options.commandTimeout);let X=this.status==="ready"||!$&&this.status==="connect"&&HG.exists(Z.name)&&HG.hasFlag(Z.name,"loading");if(!this.stream)X=!1;else if(!this.stream.writable)X=!1;else if(this.stream._writableState&&this.stream._writableState.ended)X=!1;if(!X){if(!this.options.enableOfflineQueue)return Z.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),Z.promise;if(Z.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),Z.resolve(Buffer.from("OK")),Z.promise;if(s8.enabled)s8("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,Z.name,Z.args);this.offlineQueue.push({command:Z,stream:$,select:this.condition.select})}else{if(s8.enabled)s8("write command[%s]: %d -> %s(%o)",this._getDescription(),(Q=this.condition)===null||Q===void 0?void 0:Q.select,Z.name,Z.args);if($)if("isPipeline"in $&&$.isPipeline)$.write(Z.toWritable($.destination.redis.stream));else $.write(Z.toWritable($));else this.stream.write(Z.toWritable(this.stream));if(this.commandQueue.push({command:Z,stream:$,select:this.condition.select}),dQ.default.checkFlag("WILL_DISCONNECT",Z.name))this.manuallyClosing=!0;if(this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0)this.setSocketTimeout()}if(Z.name==="select"&&R4.isInt(Z.args[0])){let W=parseInt(Z.args[0],10);if(this.condition.select!==W)this.condition.select=W,this.emit("select",W),s8("switch to db [%d]",this.condition.select)}return Z.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{if(clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length===0)return;this.setSocketTimeout()})}scanStream(Z){return this.createScanStream("scan",{options:Z})}scanBufferStream(Z){return this.createScanStream("scanBuffer",{options:Z})}sscanStream(Z,$){return this.createScanStream("sscan",{key:Z,options:$})}sscanBufferStream(Z,$){return this.createScanStream("sscanBuffer",{key:Z,options:$})}hscanStream(Z,$){return this.createScanStream("hscan",{key:Z,options:$})}hscanBufferStream(Z,$){return this.createScanStream("hscanBuffer",{key:Z,options:$})}zscanStream(Z,$){return this.createScanStream("zscan",{key:Z,options:$})}zscanBufferStream(Z,$){return this.createScanStream("zscanBuffer",{key:Z,options:$})}silentEmit(Z,$){let Y;if(Z==="error"){if(Y=$,this.status==="end")return;if(this.manuallyClosing){if(Y instanceof Error&&(Y.message===R4.CONNECTION_CLOSED_ERROR_MSG||Y.syscall==="connect"||Y.syscall==="read"))return}}if(this.listeners(Z).length>0)return this.emit.apply(this,arguments);if(Y&&Y instanceof Error)console.error("[ioredis] Unhandled error event:",Y.stack);return!1}recoverFromFatalError(Z,$,Y){this.flushQueue($,Y),this.silentEmit("error",$),this.disconnect(!0)}handleReconnection(Z,$){var Y;let Q=!1;if(this.options.reconnectOnError)Q=this.options.reconnectOnError(Z);switch(Q){case 1:case!0:if(this.status!=="reconnecting")this.disconnect(!0);$.command.reject(Z);break;case 2:if(this.status!=="reconnecting")this.disconnect(!0);if(((Y=this.condition)===null||Y===void 0?void 0:Y.select)!==$.select&&$.command.name!=="select")this.select($.select);this.sendCommand($.command);break;default:$.command.reject(Z)}}_getDescription(){let Z;if("path"in this.options&&this.options.path)Z=this.options.path;else if(this.stream&&this.stream.remoteAddress&&this.stream.remotePort)Z=this.stream.remoteAddress+":"+this.stream.remotePort;else if("host"in this.options&&this.options.host)Z=this.options.host+":"+this.options.port;else Z="";if(this.options.connectionName)Z+=` (${this.options.connectionName})`;return Z}resetCommandQueue(){this.commandQueue=new DG}resetOfflineQueue(){this.offlineQueue=new DG}parseOptions(...Z){let $={},Y=!1;for(let Q=0;Q<Z.length;++Q){let X=Z[Q];if(X===null||typeof X==="undefined")continue;if(typeof X==="object")t8.defaults($,X);else if(typeof X==="string"){if(t8.defaults($,R4.parseURL(X)),X.startsWith("rediss://"))Y=!0}else if(typeof X==="number")$.port=X;else throw new Error("Invalid argument "+X)}if(Y)t8.defaults($,{tls:!0});if(t8.defaults($,e6.defaultOptions),typeof $.port==="string")$.port=parseInt($.port,10);if(typeof $.db==="string")$.db=parseInt($.db,10);this.options=R4.resolveTLSProfile($)}setStatus(Z,$){if(s8.enabled)s8("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",Z);this.status=Z,process.nextTick(this.emit.bind(this,Z,$))}createScanStream(Z,{key:$,options:Y={}}){return new jb.default({objectMode:!0,key:$,redis:this,command:Z,...Y})}flushQueue(Z,$){$=t8.defaults({},$,{offlineQueue:!0,commandQueue:!0});let Y;if($.offlineQueue)while(Y=this.offlineQueue.shift())Y.command.reject(Z);if($.commandQueue){if(this.commandQueue.length>0){if(this.stream)this.stream.removeAllListeners("data");while(Y=this.commandQueue.shift())Y.command.reject(Z)}}}_readyCheck(Z){let $=this;this.info(function(Y,Q){if(Y){if(Y.message&&Y.message.includes("NOPERM"))return console.warn(`Skipping the ready check because INFO command fails: "${Y.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),Z(null,{});return Z(Y)}if(typeof Q!=="string")return Z(null,Q);let X={},W=Q.split(`\r
`);for(let J=0;J<W.length;++J){let[z,...q]=W[J].split(":"),U=q.join(":");if(U)X[z]=U}if(!X.loading||X.loading==="0")Z(null,X);else{let J=(X.loading_eta_seconds||1)*1000,z=$.options.maxLoadingRetryTime&&$.options.maxLoadingRetryTime<J?$.options.maxLoadingRetryTime:J;s8("Redis server still loading, trying again in "+z+"ms"),setTimeout(function(){$._readyCheck(Z)},z)}}).catch(t8.noop)}}e6.Cluster=Ob.default;e6.Command=dQ.default;e6.defaultOptions=Pb.DEFAULT_REDIS_OPTIONS;_b.default(e6,AG.EventEmitter);Rb.addTransactionSupport(e6.prototype);NG.default=e6});var FG=j((_0,OG)=>{Object.defineProperty(_0,"__esModule",{value:!0});_0.print=_0.ReplyError=_0.SentinelIterator=_0.SentinelConnector=_0.AbstractConnector=_0.Pipeline=_0.ScanStream=_0.Command=_0.Cluster=_0.Redis=_0.default=void 0;_0=OG.exports=l8().default;var Eb=l8();Object.defineProperty(_0,"default",{enumerable:!0,get:function(){return Eb.default}});var Ib=l8();Object.defineProperty(_0,"Redis",{enumerable:!0,get:function(){return Ib.default}});var xb=EQ();Object.defineProperty(_0,"Cluster",{enumerable:!0,get:function(){return xb.default}});var Tb=N8();Object.defineProperty(_0,"Command",{enumerable:!0,get:function(){return Tb.default}});var bb=r9();Object.defineProperty(_0,"ScanStream",{enumerable:!0,get:function(){return bb.default}});var kb=LQ();Object.defineProperty(_0,"Pipeline",{enumerable:!0,get:function(){return kb.default}});var gb=XY();Object.defineProperty(_0,"AbstractConnector",{enumerable:!0,get:function(){return gb.default}});var LG=WY();Object.defineProperty(_0,"SentinelConnector",{enumerable:!0,get:function(){return LG.default}});Object.defineProperty(_0,"SentinelIterator",{enumerable:!0,get:function(){return LG.SentinelIterator}});_0.ReplyError=F4().ReplyError;Object.defineProperty(_0,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(Z){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function fb(Z,$){if(Z)console.log("Error: "+Z);else console.log("Reply: "+$)}_0.print=fb});var _4=(Z,$)=>{let Y=$?.length?{}:null;if(Y)for(let Q of $)Y[Q.part.charCodeAt(0)]=Q;return{part:Z,store:null,inert:Y,params:null,wildcardStore:null}},mQ=(Z,$)=>({...Z,part:$}),uQ=(Z)=>({name:Z,store:null,inert:null});class Z4{config;root={};history=[];deferred=[];constructor(Z={}){if(this.config=Z,Z.lazy)this.find=this.lazyFind}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/:.+?\?(?=\/|$)/g};lazyFind=(Z,$)=>{if(!this.config.lazy)return this.find;return this.build(),this.find(Z,$)};build(){if(!this.config.lazy)return;for(let[Z,$,Y]of this.deferred)this.add(Z,$,Y,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=(Z,$)=>{let Y=this.root[Z];if(!Y)return null;return D$($,$.length,Y,0)}}add(Z,$,Y,{ignoreError:Q=!1,ignoreHistory:X=!1,lazy:W=this.config.lazy}={}){if(W)return this.find=this.lazyFind,this.deferred.push([Z,$,Y]),Y;if(typeof $!=="string")throw new TypeError("Route path must be a string");if($==="")$="/";else if($[0]!=="/")$=`/${$}`;let J=$[$.length-1]==="*",z=$.match(Z4.regex.optionalParams);if(z){let S=$.replaceAll("?","");this.add(Z,S,Y,{ignoreError:Q,ignoreHistory:X,lazy:W});for(let G=0;G<z.length;G++){let L=$.replace("/"+z[G],"");this.add(Z,L,Y,{ignoreError:!0,ignoreHistory:X,lazy:W})}return Y}if(z)$=$.replaceAll("?","");if(this.history.find(([S,G,L])=>S===Z&&G===$))return Y;if(J||z&&$.charCodeAt($.length-1)===63)$=$.slice(0,-1);if(!X)this.history.push([Z,$,Y]);let q=$.split(Z4.regex.static),U=$.match(Z4.regex.params)||[];if(q[q.length-1]==="")q.pop();let w;if(!this.root[Z])w=this.root[Z]=_4("/");else w=this.root[Z];let M=0;for(let S=0;S<q.length;++S){let G=q[S];if(S>0){let L=U[M++].slice(1);if(w.params===null)w.params=uQ(L);else if(w.params.name!==L)if(Q)return Y;else throw new Error(`Cannot create route "${$}" with parameter "${L}" because a route already exists with a different parameter name ("${w.params.name}") in the same location`);let B=w.params;if(B.inert===null){w=B.inert=_4(G);continue}w=B.inert}for(let L=0;;){if(L===G.length){if(L<w.part.length){let B=mQ(w,w.part.slice(L));Object.assign(w,_4(G,[B]))}break}if(L===w.part.length){if(w.inert===null)w.inert={};let B=w.inert[G.charCodeAt(L)];if(B){w=B,G=G.slice(L),L=0;continue}let P=_4(G.slice(L));w.inert[G.charCodeAt(L)]=P,w=P;break}if(G[L]!==w.part[L]){let B=mQ(w,w.part.slice(L)),P=_4(G.slice(L));Object.assign(w,_4(w.part.slice(0,L),[B,P])),w=P;break}++L}}if(M<U.length){let S=U[M].slice(1);if(w.params===null)w.params=uQ(S);else if(w.params.name!==S)if(Q)return Y;else throw new Error(`Cannot create route "${$}" with parameter "${S}" because a route already exists with a different parameter name ("${w.params.name}") in the same location`);if(w.params.store===null)w.params.store=Y;return w.params.store}if(J){if(w.wildcardStore===null)w.wildcardStore=Y;return w.wildcardStore}if(w.store===null)w.store=Y;return w.store}find(Z,$){let Y=this.root[Z];if(!Y)return null;return D$($,$.length,Y,0)}}var D$=(Z,$,Y,Q)=>{let X=Y.part,W=X.length,J=Q+W;if(W>1){if(J>$)return null;if(W<15){for(let z=1,q=Q+1;z<W;++z,++q)if(X.charCodeAt(z)!==Z.charCodeAt(q))return null}else if(Z.slice(Q,J)!==X)return null}if(J===$){if(Y.store!==null)return{store:Y.store,params:{}};if(Y.wildcardStore!==null)return{store:Y.wildcardStore,params:{"*":""}};return null}if(Y.inert!==null){let z=Y.inert[Z.charCodeAt(J)];if(z!==void 0){let q=D$(Z,$,z,J);if(q!==null)return q}}if(Y.params!==null){let{store:z,name:q,inert:U}=Y.params,w=Z.indexOf("/",J);if(w!==J){if(w===-1||w>=$){if(z!==null){let M={};return M[q]=Z.substring(J,$),{store:z,params:M}}}else if(U!==null){let M=D$(Z,$,U,w);if(M!==null)return M.params[q]=Z.substring(J,w),M}}}if(Y.wildcardStore!==null)return{store:Y.wildcardStore,params:{"*":Z.substring(J,$)}};return null};var G0={};e8(G0,{IsUndefined:()=>t1,IsUint8Array:()=>Y8,IsSymbol:()=>AY,IsString:()=>_1,IsRegExp:()=>NZ,IsObject:()=>K1,IsNumber:()=>p0,IsNull:()=>DY,IsIterator:()=>HY,IsFunction:()=>SY,IsDate:()=>$4,IsBoolean:()=>$8,IsBigInt:()=>AZ,IsAsyncIterator:()=>BY,IsArray:()=>o1,HasPropertyKey:()=>A$});function A$(Z,$){return $ in Z}function BY(Z){return K1(Z)&&!o1(Z)&&!Y8(Z)&&Symbol.asyncIterator in Z}function o1(Z){return Array.isArray(Z)}function AZ(Z){return typeof Z==="bigint"}function $8(Z){return typeof Z==="boolean"}function $4(Z){return Z instanceof globalThis.Date}function SY(Z){return typeof Z==="function"}function HY(Z){return K1(Z)&&!o1(Z)&&!Y8(Z)&&Symbol.iterator in Z}function DY(Z){return Z===null}function p0(Z){return typeof Z==="number"}function K1(Z){return typeof Z==="object"&&Z!==null}function NZ(Z){return Z instanceof globalThis.RegExp}function _1(Z){return typeof Z==="string"}function AY(Z){return typeof Z==="symbol"}function Y8(Z){return Z instanceof globalThis.Uint8Array}function t1(Z){return Z===void 0}function hG(Z){return Z.map(($)=>N$($))}function mG(Z){return new Date(Z.getTime())}function uG(Z){return new Uint8Array(Z)}function pG(Z){return new RegExp(Z.source,Z.flags)}function cG(Z){let $={};for(let Y of Object.getOwnPropertyNames(Z))$[Y]=N$(Z[Y]);for(let Y of Object.getOwnPropertySymbols(Z))$[Y]=N$(Z[Y]);return $}function N$(Z){return o1(Z)?hG(Z):$4(Z)?mG(Z):Y8(Z)?uG(Z):NZ(Z)?pG(Z):K1(Z)?cG(Z):Z}function b1(Z){return N$(Z)}function C4(Z,$){return $===void 0?b1(Z):b1({...$,...Z})}function L$(Z){return a(Z)&&globalThis.Symbol.asyncIterator in Z}function O$(Z){return a(Z)&&globalThis.Symbol.iterator in Z}function NY(Z){return a(Z)&&(globalThis.Object.getPrototypeOf(Z)===Object.prototype||globalThis.Object.getPrototypeOf(Z)===null)}function F$(Z){return Z instanceof globalThis.Promise}function O0(Z){return Z instanceof Date&&globalThis.Number.isFinite(Z.getTime())}function pQ(Z){return Z instanceof globalThis.Map}function cQ(Z){return Z instanceof globalThis.Set}function $6(Z){return globalThis.ArrayBuffer.isView(Z)}function V4(Z){return Z instanceof globalThis.Uint8Array}function c(Z,$){return $ in Z}function a(Z){return Z!==null&&typeof Z==="object"}function i(Z){return globalThis.Array.isArray(Z)&&!globalThis.ArrayBuffer.isView(Z)}function k1(Z){return Z===void 0}function Q8(Z){return Z===null}function c6(Z){return typeof Z==="boolean"}function u(Z){return typeof Z==="number"}function K$(Z){return globalThis.Number.isInteger(Z)}function J0(Z){return typeof Z==="bigint"}function q1(Z){return typeof Z==="string"}function j8(Z){return typeof Z==="function"}function X8(Z){return typeof Z==="symbol"}function c0(Z){return J0(Z)||c6(Z)||Q8(Z)||u(Z)||q1(Z)||X8(Z)||k1(Z)}var I1;(function(Z){Z.InstanceMode="default",Z.ExactOptionalPropertyTypes=!1,Z.AllowArrayObject=!1,Z.AllowNaN=!1,Z.AllowNullVoid=!1;function $(J,z){return Z.ExactOptionalPropertyTypes?z in J:J[z]!==void 0}Z.IsExactOptionalProperty=$;function Y(J){let z=a(J);return Z.AllowArrayObject?z:z&&!i(J)}Z.IsObjectLike=Y;function Q(J){return Y(J)&&!(J instanceof Date)&&!(J instanceof Uint8Array)}Z.IsRecordLike=Q;function X(J){return Z.AllowNaN?u(J):Number.isFinite(J)}Z.IsNumberLike=X;function W(J){let z=k1(J);return Z.AllowNullVoid?z||J===null:z}Z.IsVoidLike=W})(I1||(I1={}));function iG(Z){return globalThis.Object.freeze(Z).map(($)=>LZ($))}function lG(Z){return Z}function nG(Z){return Z}function oG(Z){return Z}function tG(Z){let $={};for(let Y of Object.getOwnPropertyNames(Z))$[Y]=LZ(Z[Y]);for(let Y of Object.getOwnPropertySymbols(Z))$[Y]=LZ(Z[Y]);return globalThis.Object.freeze($)}function LZ(Z){return o1(Z)?iG(Z):$4(Z)?lG(Z):Y8(Z)?nG(Z):NZ(Z)?oG(Z):K1(Z)?tG(Z):Z}function F(Z,$){let Y=$!==void 0?{...$,...Z}:Z;switch(I1.InstanceMode){case"freeze":return LZ(Y);case"clone":return b1(Y);default:return Y}}class p extends Error{constructor(Z){super(Z)}}var C1=Symbol.for("TypeBox.Transform"),O6=Symbol.for("TypeBox.Readonly"),z0=Symbol.for("TypeBox.Optional"),Y6=Symbol.for("TypeBox.Hint"),N=Symbol.for("TypeBox.Kind");function E4(Z){return K1(Z)&&Z[O6]==="Readonly"}function V0(Z){return K1(Z)&&Z[z0]==="Optional"}function LY(Z){return W1(Z,"Any")}function OY(Z){return W1(Z,"Argument")}function F6(Z){return W1(Z,"Array")}function Y4(Z){return W1(Z,"AsyncIterator")}function Q4(Z){return W1(Z,"BigInt")}function W8(Z){return W1(Z,"Boolean")}function K6(Z){return W1(Z,"Computed")}function P6(Z){return W1(Z,"Constructor")}function sG(Z){return W1(Z,"Date")}function j6(Z){return W1(Z,"Function")}function R6(Z){return W1(Z,"Integer")}function m1(Z){return W1(Z,"Intersect")}function X4(Z){return W1(Z,"Iterator")}function W1(Z,$){return K1(Z)&&N in Z&&Z[N]===$}function P$(Z){return $8(Z)||p0(Z)||_1(Z)}function i0(Z){return W1(Z,"Literal")}function l0(Z){return W1(Z,"MappedKey")}function g1(Z){return W1(Z,"MappedResult")}function R8(Z){return W1(Z,"Never")}function rG(Z){return W1(Z,"Not")}function OZ(Z){return W1(Z,"Null")}function _6(Z){return W1(Z,"Number")}function s1(Z){return W1(Z,"Object")}function W4(Z){return W1(Z,"Promise")}function J4(Z){return W1(Z,"Record")}function n1(Z){return W1(Z,"Ref")}function FY(Z){return W1(Z,"RegExp")}function J8(Z){return W1(Z,"String")}function FZ(Z){return W1(Z,"Symbol")}function n0(Z){return W1(Z,"TemplateLiteral")}function aG(Z){return W1(Z,"This")}function S1(Z){return K1(Z)&&C1 in Z}function o0(Z){return W1(Z,"Tuple")}function z8(Z){return W1(Z,"Undefined")}function U1(Z){return W1(Z,"Union")}function eG(Z){return W1(Z,"Uint8Array")}function ZB(Z){return W1(Z,"Unknown")}function $B(Z){return W1(Z,"Unsafe")}function YB(Z){return W1(Z,"Void")}function _8(Z){return K1(Z)&&N in Z&&_1(Z[N])}function v1(Z){return LY(Z)||OY(Z)||F6(Z)||W8(Z)||Q4(Z)||Y4(Z)||K6(Z)||P6(Z)||sG(Z)||j6(Z)||R6(Z)||m1(Z)||X4(Z)||i0(Z)||l0(Z)||g1(Z)||R8(Z)||rG(Z)||OZ(Z)||_6(Z)||s1(Z)||W4(Z)||J4(Z)||n1(Z)||FY(Z)||J8(Z)||FZ(Z)||n0(Z)||aG(Z)||o0(Z)||z8(Z)||U1(Z)||eG(Z)||ZB(Z)||$B(Z)||YB(Z)||_8(Z)}var D={};e8(D,{TypeGuardUnknownTypeError:()=>iQ,IsVoid:()=>TX,IsUnsafe:()=>xX,IsUnknown:()=>IX,IsUnionLiteral:()=>MB,IsUnion:()=>jY,IsUndefined:()=>VX,IsUint8Array:()=>EX,IsTuple:()=>CX,IsTransform:()=>_X,IsThis:()=>RX,IsTemplateLiteral:()=>jX,IsSymbol:()=>PX,IsString:()=>KX,IsSchema:()=>f1,IsRegExp:()=>FX,IsRef:()=>OX,IsRecursive:()=>wB,IsRecord:()=>LX,IsReadonly:()=>JB,IsProperties:()=>j$,IsPromise:()=>NX,IsOptional:()=>zB,IsObject:()=>AX,IsNumber:()=>DX,IsNull:()=>HX,IsNot:()=>SX,IsNever:()=>BX,IsMappedResult:()=>GX,IsMappedKey:()=>MX,IsLiteralValue:()=>wX,IsLiteralString:()=>qX,IsLiteralNumber:()=>UX,IsLiteralBoolean:()=>UB,IsLiteral:()=>PZ,IsKindOf:()=>$1,IsKind:()=>bX,IsIterator:()=>zX,IsIntersect:()=>JX,IsInteger:()=>WX,IsImport:()=>qB,IsFunction:()=>XX,IsDate:()=>QX,IsConstructor:()=>YX,IsComputed:()=>$X,IsBoolean:()=>ZX,IsBigInt:()=>eQ,IsAsyncIterator:()=>aQ,IsArray:()=>rQ,IsArgument:()=>sQ,IsAny:()=>tQ});class iQ extends p{}var QB=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function lQ(Z){try{return new RegExp(Z),!0}catch{return!1}}function KY(Z){if(!_1(Z))return!1;for(let $=0;$<Z.length;$++){let Y=Z.charCodeAt($);if(Y>=7&&Y<=13||Y===27||Y===127)return!1}return!0}function nQ(Z){return PY(Z)||f1(Z)}function KZ(Z){return t1(Z)||AZ(Z)}function V1(Z){return t1(Z)||p0(Z)}function PY(Z){return t1(Z)||$8(Z)}function P1(Z){return t1(Z)||_1(Z)}function XB(Z){return t1(Z)||_1(Z)&&KY(Z)&&lQ(Z)}function WB(Z){return t1(Z)||_1(Z)&&KY(Z)}function oQ(Z){return t1(Z)||f1(Z)}function JB(Z){return K1(Z)&&Z[O6]==="Readonly"}function zB(Z){return K1(Z)&&Z[z0]==="Optional"}function tQ(Z){return $1(Z,"Any")&&P1(Z.$id)}function sQ(Z){return $1(Z,"Argument")&&p0(Z.index)}function rQ(Z){return $1(Z,"Array")&&Z.type==="array"&&P1(Z.$id)&&f1(Z.items)&&V1(Z.minItems)&&V1(Z.maxItems)&&PY(Z.uniqueItems)&&oQ(Z.contains)&&V1(Z.minContains)&&V1(Z.maxContains)}function aQ(Z){return $1(Z,"AsyncIterator")&&Z.type==="AsyncIterator"&&P1(Z.$id)&&f1(Z.items)}function eQ(Z){return $1(Z,"BigInt")&&Z.type==="bigint"&&P1(Z.$id)&&KZ(Z.exclusiveMaximum)&&KZ(Z.exclusiveMinimum)&&KZ(Z.maximum)&&KZ(Z.minimum)&&KZ(Z.multipleOf)}function ZX(Z){return $1(Z,"Boolean")&&Z.type==="boolean"&&P1(Z.$id)}function $X(Z){return $1(Z,"Computed")&&_1(Z.target)&&o1(Z.parameters)&&Z.parameters.every(($)=>f1($))}function YX(Z){return $1(Z,"Constructor")&&Z.type==="Constructor"&&P1(Z.$id)&&o1(Z.parameters)&&Z.parameters.every(($)=>f1($))&&f1(Z.returns)}function QX(Z){return $1(Z,"Date")&&Z.type==="Date"&&P1(Z.$id)&&V1(Z.exclusiveMaximumTimestamp)&&V1(Z.exclusiveMinimumTimestamp)&&V1(Z.maximumTimestamp)&&V1(Z.minimumTimestamp)&&V1(Z.multipleOfTimestamp)}function XX(Z){return $1(Z,"Function")&&Z.type==="Function"&&P1(Z.$id)&&o1(Z.parameters)&&Z.parameters.every(($)=>f1($))&&f1(Z.returns)}function qB(Z){return $1(Z,"Import")&&A$(Z,"$defs")&&K1(Z.$defs)&&j$(Z.$defs)&&A$(Z,"$ref")&&_1(Z.$ref)&&Z.$ref in Z.$defs}function WX(Z){return $1(Z,"Integer")&&Z.type==="integer"&&P1(Z.$id)&&V1(Z.exclusiveMaximum)&&V1(Z.exclusiveMinimum)&&V1(Z.maximum)&&V1(Z.minimum)&&V1(Z.multipleOf)}function j$(Z){return K1(Z)&&Object.entries(Z).every(([$,Y])=>KY($)&&f1(Y))}function JX(Z){return $1(Z,"Intersect")&&(_1(Z.type)&&Z.type!=="object"?!1:!0)&&o1(Z.allOf)&&Z.allOf.every(($)=>f1($)&&!_X($))&&P1(Z.type)&&(PY(Z.unevaluatedProperties)||oQ(Z.unevaluatedProperties))&&P1(Z.$id)}function zX(Z){return $1(Z,"Iterator")&&Z.type==="Iterator"&&P1(Z.$id)&&f1(Z.items)}function $1(Z,$){return K1(Z)&&N in Z&&Z[N]===$}function qX(Z){return PZ(Z)&&_1(Z.const)}function UX(Z){return PZ(Z)&&p0(Z.const)}function UB(Z){return PZ(Z)&&$8(Z.const)}function PZ(Z){return $1(Z,"Literal")&&P1(Z.$id)&&wX(Z.const)}function wX(Z){return $8(Z)||p0(Z)||_1(Z)}function MX(Z){return $1(Z,"MappedKey")&&o1(Z.keys)&&Z.keys.every(($)=>p0($)||_1($))}function GX(Z){return $1(Z,"MappedResult")&&j$(Z.properties)}function BX(Z){return $1(Z,"Never")&&K1(Z.not)&&Object.getOwnPropertyNames(Z.not).length===0}function SX(Z){return $1(Z,"Not")&&f1(Z.not)}function HX(Z){return $1(Z,"Null")&&Z.type==="null"&&P1(Z.$id)}function DX(Z){return $1(Z,"Number")&&Z.type==="number"&&P1(Z.$id)&&V1(Z.exclusiveMaximum)&&V1(Z.exclusiveMinimum)&&V1(Z.maximum)&&V1(Z.minimum)&&V1(Z.multipleOf)}function AX(Z){return $1(Z,"Object")&&Z.type==="object"&&P1(Z.$id)&&j$(Z.properties)&&nQ(Z.additionalProperties)&&V1(Z.minProperties)&&V1(Z.maxProperties)}function NX(Z){return $1(Z,"Promise")&&Z.type==="Promise"&&P1(Z.$id)&&f1(Z.item)}function LX(Z){return $1(Z,"Record")&&Z.type==="object"&&P1(Z.$id)&&nQ(Z.additionalProperties)&&K1(Z.patternProperties)&&(($)=>{let Y=Object.getOwnPropertyNames($.patternProperties);return Y.length===1&&lQ(Y[0])&&K1($.patternProperties)&&f1($.patternProperties[Y[0]])})(Z)}function wB(Z){return K1(Z)&&Y6 in Z&&Z[Y6]==="Recursive"}function OX(Z){return $1(Z,"Ref")&&P1(Z.$id)&&_1(Z.$ref)}function FX(Z){return $1(Z,"RegExp")&&P1(Z.$id)&&_1(Z.source)&&_1(Z.flags)&&V1(Z.maxLength)&&V1(Z.minLength)}function KX(Z){return $1(Z,"String")&&Z.type==="string"&&P1(Z.$id)&&V1(Z.minLength)&&V1(Z.maxLength)&&XB(Z.pattern)&&WB(Z.format)}function PX(Z){return $1(Z,"Symbol")&&Z.type==="symbol"&&P1(Z.$id)}function jX(Z){return $1(Z,"TemplateLiteral")&&Z.type==="string"&&_1(Z.pattern)&&Z.pattern[0]==="^"&&Z.pattern[Z.pattern.length-1]==="$"}function RX(Z){return $1(Z,"This")&&P1(Z.$id)&&_1(Z.$ref)}function _X(Z){return K1(Z)&&C1 in Z}function CX(Z){return $1(Z,"Tuple")&&Z.type==="array"&&P1(Z.$id)&&p0(Z.minItems)&&p0(Z.maxItems)&&Z.minItems===Z.maxItems&&(t1(Z.items)&&t1(Z.additionalItems)&&Z.minItems===0||o1(Z.items)&&Z.items.every(($)=>f1($)))}function VX(Z){return $1(Z,"Undefined")&&Z.type==="undefined"&&P1(Z.$id)}function MB(Z){return jY(Z)&&Z.anyOf.every(($)=>qX($)||UX($))}function jY(Z){return $1(Z,"Union")&&P1(Z.$id)&&K1(Z)&&o1(Z.anyOf)&&Z.anyOf.every(($)=>f1($))}function EX(Z){return $1(Z,"Uint8Array")&&Z.type==="Uint8Array"&&P1(Z.$id)&&V1(Z.minByteLength)&&V1(Z.maxByteLength)}function IX(Z){return $1(Z,"Unknown")&&P1(Z.$id)}function xX(Z){return $1(Z,"Unsafe")}function TX(Z){return $1(Z,"Void")&&Z.type==="void"&&P1(Z.$id)}function bX(Z){return K1(Z)&&N in Z&&_1(Z[N])&&!QB.includes(Z[N])}function f1(Z){return K1(Z)&&(tQ(Z)||sQ(Z)||rQ(Z)||ZX(Z)||eQ(Z)||aQ(Z)||$X(Z)||YX(Z)||QX(Z)||XX(Z)||WX(Z)||JX(Z)||zX(Z)||PZ(Z)||MX(Z)||GX(Z)||BX(Z)||SX(Z)||HX(Z)||DX(Z)||AX(Z)||NX(Z)||LX(Z)||OX(Z)||FX(Z)||KX(Z)||PX(Z)||jX(Z)||RX(Z)||CX(Z)||VX(Z)||jY(Z)||EX(Z)||IX(Z)||xX(Z)||TX(Z)||bX(Z))}var kX="(true|false)",R$="(0|[1-9][0-9]*)",gX="(.*)";var i6="^(0|[1-9][0-9]*)$",l6="^(.*)$",fX="^(?!.*)$";var F1={};e8(F1,{Set:()=>DB,Has:()=>HB,Get:()=>AB,Entries:()=>GB,Delete:()=>SB,Clear:()=>BB});var I4=new Map;function GB(){return new Map(I4)}function BB(){return I4.clear()}function SB(Z){return I4.delete(Z)}function HB(Z){return I4.has(Z)}function DB(Z,$){I4.set(Z,$)}function AB(Z){return I4.get(Z)}var r1={};e8(r1,{Set:()=>KB,Has:()=>FB,Get:()=>PB,Entries:()=>NB,Delete:()=>OB,Clear:()=>LB});var x4=new Map;function NB(){return new Map(x4)}function LB(){return x4.clear()}function OB(Z){return x4.delete(Z)}function FB(Z){return x4.has(Z)}function KB(Z,$){x4.set(Z,$)}function PB(Z){return x4.get(Z)}function yX(Z,$){return Z.includes($)}function vX(Z){return[...new Set(Z)]}function jB(Z,$){return Z.filter((Y)=>$.includes(Y))}function RB(Z,$){return Z.reduce((Y,Q)=>{return jB(Y,Q)},$)}function dX(Z){return Z.length===1?Z[0]:Z.length>1?RB(Z.slice(1),Z[0]):[]}function hX(Z){let $=[];for(let Y of Z)$.push(...Y);return $}function C8(Z){return F({[N]:"Any"},Z)}function T4(Z,$){return F({[N]:"Array",type:"array",items:Z},$)}function mX(Z){return F({[N]:"Argument",index:Z})}function b4(Z,$){return F({[N]:"AsyncIterator",type:"AsyncIterator",items:Z},$)}function x1(Z,$,Y){return F({[N]:"Computed",target:Z,parameters:$},Y)}function _B(Z,$){let{[$]:Y,...Q}=Z;return Q}function u1(Z,$){return $.reduce((Y,Q)=>_B(Y,Q),Z)}function r(Z){return F({[N]:"Never",not:{}},Z)}function w1(Z){return F({[N]:"MappedResult",properties:Z})}function k4(Z,$,Y){return F({[N]:"Constructor",type:"Constructor",parameters:Z,returns:$},Y)}function n6(Z,$,Y){return F({[N]:"Function",type:"Function",parameters:Z,returns:$},Y)}function jZ(Z,$){return F({[N]:"Union",anyOf:Z},$)}function CB(Z){return Z.some(($)=>V0($))}function uX(Z){return Z.map(($)=>V0($)?VB($):$)}function VB(Z){return u1(Z,[z0])}function EB(Z,$){return CB(Z)?B0(jZ(uX(Z),$)):jZ(uX(Z),$)}function o6(Z,$){return Z.length===1?F(Z[0],$):Z.length===0?r($):EB(Z,$)}function H1(Z,$){return Z.length===0?r($):Z.length===1?F(Z[0],$):jZ(Z,$)}class RY extends p{}function IB(Z){return Z.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function _Y(Z,$,Y){return Z[$]===Y&&Z.charCodeAt($-1)!==92}function U8(Z,$){return _Y(Z,$,"(")}function RZ(Z,$){return _Y(Z,$,")")}function pX(Z,$){return _Y(Z,$,"|")}function xB(Z){if(!(U8(Z,0)&&RZ(Z,Z.length-1)))return!1;let $=0;for(let Y=0;Y<Z.length;Y++){if(U8(Z,Y))$+=1;if(RZ(Z,Y))$-=1;if($===0&&Y!==Z.length-1)return!1}return!0}function TB(Z){return Z.slice(1,Z.length-1)}function bB(Z){let $=0;for(let Y=0;Y<Z.length;Y++){if(U8(Z,Y))$+=1;if(RZ(Z,Y))$-=1;if(pX(Z,Y)&&$===0)return!0}return!1}function kB(Z){for(let $=0;$<Z.length;$++)if(U8(Z,$))return!0;return!1}function gB(Z){let[$,Y]=[0,0],Q=[];for(let W=0;W<Z.length;W++){if(U8(Z,W))$+=1;if(RZ(Z,W))$-=1;if(pX(Z,W)&&$===0){let J=Z.slice(Y,W);if(J.length>0)Q.push(g4(J));Y=W+1}}let X=Z.slice(Y);if(X.length>0)Q.push(g4(X));if(Q.length===0)return{type:"const",const:""};if(Q.length===1)return Q[0];return{type:"or",expr:Q}}function fB(Z){function $(X,W){if(!U8(X,W))throw new RY("TemplateLiteralParser: Index must point to open parens");let J=0;for(let z=W;z<X.length;z++){if(U8(X,z))J+=1;if(RZ(X,z))J-=1;if(J===0)return[W,z]}throw new RY("TemplateLiteralParser: Unclosed group parens in expression")}function Y(X,W){for(let J=W;J<X.length;J++)if(U8(X,J))return[W,J];return[W,X.length]}let Q=[];for(let X=0;X<Z.length;X++)if(U8(Z,X)){let[W,J]=$(Z,X),z=Z.slice(W,J+1);Q.push(g4(z)),X=J}else{let[W,J]=Y(Z,X),z=Z.slice(W,J);if(z.length>0)Q.push(g4(z));X=J-1}return Q.length===0?{type:"const",const:""}:Q.length===1?Q[0]:{type:"and",expr:Q}}function g4(Z){return xB(Z)?g4(TB(Z)):bB(Z)?gB(Z):kB(Z)?fB(Z):{type:"const",const:IB(Z)}}function f4(Z){return g4(Z.slice(1,Z.length-1))}class cX extends p{}function yB(Z){return Z.type==="or"&&Z.expr.length===2&&Z.expr[0].type==="const"&&Z.expr[0].const==="0"&&Z.expr[1].type==="const"&&Z.expr[1].const==="[1-9][0-9]*"}function vB(Z){return Z.type==="or"&&Z.expr.length===2&&Z.expr[0].type==="const"&&Z.expr[0].const==="true"&&Z.expr[1].type==="const"&&Z.expr[1].const==="false"}function dB(Z){return Z.type==="const"&&Z.const===".*"}function z4(Z){return yB(Z)||dB(Z)?!1:vB(Z)?!0:Z.type==="and"?Z.expr.every(($)=>z4($)):Z.type==="or"?Z.expr.every(($)=>z4($)):Z.type==="const"?!0:(()=>{throw new cX("Unknown expression type")})()}function _$(Z){let $=f4(Z.pattern);return z4($)}class iX extends p{}function*lX(Z){if(Z.length===1)return yield*Z[0];for(let $ of Z[0])for(let Y of lX(Z.slice(1)))yield`${$}${Y}`}function*hB(Z){return yield*lX(Z.expr.map(($)=>[..._Z($)]))}function*mB(Z){for(let $ of Z.expr)yield*_Z($)}function*uB(Z){return yield Z.const}function*_Z(Z){return Z.type==="and"?yield*hB(Z):Z.type==="or"?yield*mB(Z):Z.type==="const"?yield*uB(Z):(()=>{throw new iX("Unknown expression")})()}function y4(Z){let $=f4(Z.pattern);return z4($)?[..._Z($)]:[]}function J1(Z,$){return F({[N]:"Literal",const:Z,type:typeof Z},$)}function C$(Z){return F({[N]:"Boolean",type:"boolean"},Z)}function v4(Z){return F({[N]:"BigInt",type:"bigint"},Z)}function Q6(Z){return F({[N]:"Number",type:"number"},Z)}function F0(Z){return F({[N]:"String",type:"string"},Z)}function*pB(Z){let $=Z.trim().replace(/"|'/g,"");return $==="boolean"?yield C$():$==="number"?yield Q6():$==="bigint"?yield v4():$==="string"?yield F0():yield(()=>{let Y=$.split("|").map((Q)=>J1(Q.trim()));return Y.length===0?r():Y.length===1?Y[0]:o6(Y)})()}function*cB(Z){if(Z[1]!=="{"){let $=J1("$"),Y=CY(Z.slice(1));return yield*[$,...Y]}for(let $=2;$<Z.length;$++)if(Z[$]==="}"){let Y=pB(Z.slice(2,$)),Q=CY(Z.slice($+1));return yield*[...Y,...Q]}yield J1(Z)}function*CY(Z){for(let $=0;$<Z.length;$++)if(Z[$]==="$"){let Y=J1(Z.slice(0,$)),Q=cB(Z.slice($));return yield*[Y,...Q]}yield J1(Z)}function nX(Z){return[...CY(Z)]}class oX extends p{}function iB(Z){return Z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function tX(Z,$){return n0(Z)?Z.pattern.slice(1,Z.pattern.length-1):U1(Z)?`(${Z.anyOf.map((Y)=>tX(Y,$)).join("|")})`:_6(Z)?`${$}${R$}`:R6(Z)?`${$}${R$}`:Q4(Z)?`${$}${R$}`:J8(Z)?`${$}${gX}`:i0(Z)?`${$}${iB(Z.const.toString())}`:W8(Z)?`${$}${kX}`:(()=>{throw new oX(`Unexpected Kind '${Z[N]}'`)})()}function VY(Z){return`^${Z.map(($)=>tX($,"")).join("")}$`}function q4(Z){let Y=y4(Z).map((Q)=>J1(Q));return o6(Y)}function V$(Z,$){let Y=_1(Z)?VY(nX(Z)):VY(Z);return F({[N]:"TemplateLiteral",type:"string",pattern:Y},$)}function lB(Z){return y4(Z).map((Y)=>Y.toString())}function nB(Z){let $=[];for(let Y of Z)$.push(...E0(Y));return $}function oB(Z){return[Z.toString()]}function E0(Z){return[...new Set(n0(Z)?lB(Z):U1(Z)?nB(Z.anyOf):i0(Z)?oB(Z.const):_6(Z)?["[number]"]:R6(Z)?["[number]"]:[])]}function tB(Z,$,Y){let Q={};for(let X of Object.getOwnPropertyNames($))Q[X]=V8(Z,E0($[X]),Y);return Q}function sB(Z,$,Y){return tB(Z,$.properties,Y)}function sX(Z,$,Y){let Q=sB(Z,$,Y);return w1(Q)}function aX(Z,$){return Z.map((Y)=>eX(Y,$))}function rB(Z){return Z.filter(($)=>!R8($))}function aB(Z,$){return E$(rB(aX(Z,$)))}function eB(Z){return Z.some(($)=>R8($))?[]:Z}function ZS(Z,$){return o6(eB(aX(Z,$)))}function $S(Z,$){return $ in Z?Z[$]:$==="[number]"?o6(Z):r()}function YS(Z,$){return $==="[number]"?Z:r()}function QS(Z,$){return $ in Z?Z[$]:r()}function eX(Z,$){return m1(Z)?aB(Z.allOf,$):U1(Z)?ZS(Z.anyOf,$):o0(Z)?$S(Z.items??[],$):F6(Z)?YS(Z.items,$):s1(Z)?QS(Z.properties,$):r()}function CZ(Z,$){return $.map((Y)=>eX(Z,Y))}function rX(Z,$){return o6(CZ(Z,$))}function V8(Z,$,Y){if(n1(Z)||n1($)){if(!v1(Z)||!v1($))throw new p("Index types using Ref parameters require both Type and Key to be of TSchema");return x1("Index",[Z,$])}if(g1($))return sX(Z,$,Y);if(l0($))return Z7(Z,$,Y);return F(v1($)?rX(Z,E0($)):rX(Z,$),Y)}function XS(Z,$,Y){return{[$]:V8(Z,[$],b1(Y))}}function WS(Z,$,Y){return $.reduce((Q,X)=>{return{...Q,...XS(Z,X,Y)}},{})}function JS(Z,$,Y){return WS(Z,$.keys,Y)}function Z7(Z,$,Y){let Q=JS(Z,$,Y);return w1(Q)}function d4(Z,$){return F({[N]:"Iterator",type:"Iterator",items:Z},$)}function zS(Z){let $=[];for(let Y in Z)if(!V0(Z[Y]))$.push(Y);return $}function qS(Z,$){let Y=zS(Z),Q=Y.length>0?{[N]:"Object",type:"object",properties:Z,required:Y}:{[N]:"Object",type:"object",properties:Z};return F(Q,$)}var D1=qS;function I$(Z,$){return F({[N]:"Promise",type:"Promise",item:Z},$)}function US(Z){return F(u1(Z,[O6]))}function wS(Z){return F({...Z,[O6]:"Readonly"})}function MS(Z,$){return $===!1?US(Z):wS(Z)}function I0(Z,$){let Y=$??!0;return g1(Z)?$7(Z,Y):MS(Z,Y)}function GS(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=I0(Z[Q],$);return Y}function BS(Z,$){return GS(Z.properties,$)}function $7(Z,$){let Y=BS(Z,$);return w1(Y)}function X6(Z,$){return F(Z.length>0?{[N]:"Tuple",type:"array",items:Z,additionalItems:!1,minItems:Z.length,maxItems:Z.length}:{[N]:"Tuple",type:"array",minItems:Z.length,maxItems:Z.length},$)}function Y7(Z,$){return Z in $?W6(Z,$[Z]):w1($)}function SS(Z){return{[Z]:J1(Z)}}function HS(Z){let $={};for(let Y of Z)$[Y]=J1(Y);return $}function DS(Z,$){return yX($,Z)?SS(Z):HS($)}function AS(Z,$){let Y=DS(Z,$);return Y7(Z,Y)}function VZ(Z,$){return $.map((Y)=>W6(Z,Y))}function NS(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=W6(Z,$[Q]);return Y}function W6(Z,$){let Y={...$};return V0($)?B0(W6(Z,u1($,[z0]))):E4($)?I0(W6(Z,u1($,[O6]))):g1($)?Y7(Z,$.properties):l0($)?AS(Z,$.keys):P6($)?k4(VZ(Z,$.parameters),W6(Z,$.returns),Y):j6($)?n6(VZ(Z,$.parameters),W6(Z,$.returns),Y):Y4($)?b4(W6(Z,$.items),Y):X4($)?d4(W6(Z,$.items),Y):m1($)?S0(VZ(Z,$.allOf),Y):U1($)?H1(VZ(Z,$.anyOf),Y):o0($)?X6(VZ(Z,$.items??[]),Y):s1($)?D1(NS(Z,$.properties),Y):F6($)?T4(W6(Z,$.items),Y):W4($)?I$(W6(Z,$.item),Y):$}function LS(Z,$){let Y={};for(let Q of Z)Y[Q]=W6(Q,$);return Y}function Q7(Z,$,Y){let Q=v1(Z)?E0(Z):Z,X=$({[N]:"MappedKey",keys:Q}),W=LS(Q,X);return D1(W,Y)}function OS(Z){return F(u1(Z,[z0]))}function FS(Z){return F({...Z,[z0]:"Optional"})}function KS(Z,$){return $===!1?OS(Z):FS(Z)}function B0(Z,$){let Y=$??!0;return g1(Z)?X7(Z,Y):KS(Z,Y)}function PS(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=B0(Z[Q],$);return Y}function jS(Z,$){return PS(Z.properties,$)}function X7(Z,$){let Y=jS(Z,$);return w1(Y)}function EZ(Z,$={}){let Y=Z.every((X)=>s1(X)),Q=v1($.unevaluatedProperties)?{unevaluatedProperties:$.unevaluatedProperties}:{};return F($.unevaluatedProperties===!1||v1($.unevaluatedProperties)||Y?{...Q,[N]:"Intersect",type:"object",allOf:Z}:{...Q,[N]:"Intersect",allOf:Z},$)}function RS(Z){return Z.every(($)=>V0($))}function _S(Z){return u1(Z,[z0])}function W7(Z){return Z.map(($)=>V0($)?_S($):$)}function CS(Z,$){return RS(Z)?B0(EZ(W7(Z),$)):EZ(W7(Z),$)}function E$(Z,$={}){if(Z.length===1)return F(Z[0],$);if(Z.length===0)return r($);if(Z.some((Y)=>S1(Y)))throw new Error("Cannot intersect transform types");return CS(Z,$)}function S0(Z,$){if(Z.length===1)return F(Z[0],$);if(Z.length===0)return r($);if(Z.some((Y)=>S1(Y)))throw new Error("Cannot intersect transform types");return EZ(Z,$)}function J6(...Z){let[$,Y]=typeof Z[0]==="string"?[Z[0],Z[1]]:[Z[0].$id,Z[1]];if(typeof $!=="string")throw new p("Ref: $ref must be a string");return F({[N]:"Ref",$ref:$},Y)}function VS(Z,$){return x1("Awaited",[x1(Z,$)])}function ES(Z){return x1("Awaited",[J6(Z)])}function IS(Z){return S0(J7(Z))}function xS(Z){return H1(J7(Z))}function TS(Z){return h4(Z)}function J7(Z){return Z.map(($)=>h4($))}function h4(Z,$){return F(K6(Z)?VS(Z.target,Z.parameters):m1(Z)?IS(Z.allOf):U1(Z)?xS(Z.anyOf):W4(Z)?TS(Z.item):n1(Z)?ES(Z.$ref):Z,$)}function z7(Z){let $=[];for(let Y of Z)$.push(x0(Y));return $}function bS(Z){let $=z7(Z);return hX($)}function kS(Z){let $=z7(Z);return dX($)}function gS(Z){return Z.map(($,Y)=>Y.toString())}function fS(Z){return["[number]"]}function yS(Z){return globalThis.Object.getOwnPropertyNames(Z)}function vS(Z){if(!EY)return[];return globalThis.Object.getOwnPropertyNames(Z).map((Y)=>{return Y[0]==="^"&&Y[Y.length-1]==="$"?Y.slice(1,Y.length-1):Y})}function x0(Z){return m1(Z)?bS(Z.allOf):U1(Z)?kS(Z.anyOf):o0(Z)?gS(Z.items??[]):F6(Z)?fS(Z.items):s1(Z)?yS(Z.properties):J4(Z)?vS(Z.patternProperties):[]}var EY=!1;function w8(Z){EY=!0;let $=x0(Z);return EY=!1,`^(${$.map((Q)=>`(${Q})`).join("|")})$`}function dS(Z,$){return x1("KeyOf",[x1(Z,$)])}function hS(Z){return x1("KeyOf",[J6(Z)])}function mS(Z,$){let Y=x0(Z),Q=uS(Y),X=o6(Q);return F(X,$)}function uS(Z){return Z.map(($)=>$==="[number]"?Q6():J1($))}function m4(Z,$){return K6(Z)?dS(Z.target,Z.parameters):n1(Z)?hS(Z.$ref):g1(Z)?q7(Z,$):mS(Z,$)}function pS(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=m4(Z[Q],b1($));return Y}function cS(Z,$){return pS(Z.properties,$)}function q7(Z,$){let Y=cS(Z,$);return w1(Y)}function x$(Z){let $=x0(Z),Y=CZ(Z,$);return $.map((Q,X)=>[$[X],Y[X]])}function iS(Z){let $=[];for(let Y of Z)$.push(...x0(Y));return vX($)}function lS(Z){return Z.filter(($)=>!R8($))}function nS(Z,$){let Y=[];for(let Q of Z)Y.push(...CZ(Q,[$]));return lS(Y)}function oS(Z,$){let Y={};for(let Q of $)Y[Q]=E$(nS(Z,Q));return Y}function U7(Z,$){let Y=iS(Z),Q=oS(Z,Y);return D1(Q,$)}function T$(Z){return F({[N]:"Date",type:"Date"},Z)}function b$(Z){return F({[N]:"Null",type:"null"},Z)}function k$(Z){return F({[N]:"Symbol",type:"symbol"},Z)}function g$(Z){return F({[N]:"Undefined",type:"undefined"},Z)}function f$(Z){return F({[N]:"Uint8Array",type:"Uint8Array"},Z)}function C6(Z){return F({[N]:"Unknown"},Z)}function tS(Z){return Z.map(($)=>IY($,!1))}function sS(Z){let $={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))$[Y]=I0(IY(Z[Y],!1));return $}function y$(Z,$){return $===!0?Z:I0(Z)}function IY(Z,$){return BY(Z)?y$(C8(),$):HY(Z)?y$(C8(),$):o1(Z)?I0(X6(tS(Z))):Y8(Z)?f$():$4(Z)?T$():K1(Z)?y$(D1(sS(Z)),$):SY(Z)?y$(n6([],C6()),$):t1(Z)?g$():DY(Z)?b$():AY(Z)?k$():AZ(Z)?v4():p0(Z)?J1(Z):$8(Z)?J1(Z):_1(Z)?J1(Z):D1({})}function w7(Z,$){return F(IY(Z,!0),$)}function M7(Z,$){return P6(Z)?X6(Z.parameters,$):r($)}function G7(Z,$){if(t1(Z))throw new Error("Enum undefined or empty");let Y=globalThis.Object.getOwnPropertyNames(Z).filter((W)=>isNaN(W)).map((W)=>Z[W]),X=[...new Set(Y)].map((W)=>J1(W));return H1(X,{...$,[Y6]:"Enum"})}class A7 extends p{}var K;(function(Z){Z[Z.Union=0]="Union",Z[Z.True=1]="True",Z[Z.False=2]="False"})(K||(K={}));function z6(Z){return Z===K.False?Z:K.True}function u4(Z){throw new A7(Z)}function a1(Z){return D.IsNever(Z)||D.IsIntersect(Z)||D.IsUnion(Z)||D.IsUnknown(Z)||D.IsAny(Z)}function e1(Z,$){return D.IsNever($)?O7(Z,$):D.IsIntersect($)?v$(Z,$):D.IsUnion($)?gY(Z,$):D.IsUnknown($)?j7(Z,$):D.IsAny($)?kY(Z,$):u4("StructuralRight")}function kY(Z,$){return K.True}function rS(Z,$){return D.IsIntersect($)?v$(Z,$):D.IsUnion($)&&$.anyOf.some((Y)=>D.IsAny(Y)||D.IsUnknown(Y))?K.True:D.IsUnion($)?K.Union:D.IsUnknown($)?K.True:D.IsAny($)?K.True:K.Union}function aS(Z,$){return D.IsUnknown(Z)?K.False:D.IsAny(Z)?K.Union:D.IsNever(Z)?K.True:K.False}function eS(Z,$){return D.IsObject($)&&d$($)?K.True:a1($)?e1(Z,$):!D.IsArray($)?K.False:z6(j1(Z.items,$.items))}function ZH(Z,$){return a1($)?e1(Z,$):!D.IsAsyncIterator($)?K.False:z6(j1(Z.items,$.items))}function $H(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsBigInt($)?K.True:K.False}function N7(Z,$){return D.IsLiteralBoolean(Z)?K.True:D.IsBoolean(Z)?K.True:K.False}function YH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsBoolean($)?K.True:K.False}function QH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):!D.IsConstructor($)?K.False:Z.parameters.length>$.parameters.length?K.False:!Z.parameters.every((Y,Q)=>z6(j1($.parameters[Q],Y))===K.True)?K.False:z6(j1(Z.returns,$.returns))}function XH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsDate($)?K.True:K.False}function WH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):!D.IsFunction($)?K.False:Z.parameters.length>$.parameters.length?K.False:!Z.parameters.every((Y,Q)=>z6(j1($.parameters[Q],Y))===K.True)?K.False:z6(j1(Z.returns,$.returns))}function L7(Z,$){return D.IsLiteral(Z)&&G0.IsNumber(Z.const)?K.True:D.IsNumber(Z)||D.IsInteger(Z)?K.True:K.False}function JH(Z,$){return D.IsInteger($)||D.IsNumber($)?K.True:a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):K.False}function v$(Z,$){return $.allOf.every((Y)=>j1(Z,Y)===K.True)?K.True:K.False}function zH(Z,$){return Z.allOf.some((Y)=>j1(Y,$)===K.True)?K.True:K.False}function qH(Z,$){return a1($)?e1(Z,$):!D.IsIterator($)?K.False:z6(j1(Z.items,$.items))}function UH(Z,$){return D.IsLiteral($)&&$.const===Z.const?K.True:a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsString($)?P7(Z,$):D.IsNumber($)?F7(Z,$):D.IsInteger($)?L7(Z,$):D.IsBoolean($)?N7(Z,$):K.False}function O7(Z,$){return K.False}function wH(Z,$){return K.True}function B7(Z){let[$,Y]=[Z,0];while(!0){if(!D.IsNot($))break;$=$.not,Y+=1}return Y%2===0?$:C6()}function MH(Z,$){return D.IsNot(Z)?j1(B7(Z),$):D.IsNot($)?j1(Z,B7($)):u4("Invalid fallthrough for Not")}function GH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsNull($)?K.True:K.False}function F7(Z,$){return D.IsLiteralNumber(Z)?K.True:D.IsNumber(Z)||D.IsInteger(Z)?K.True:K.False}function BH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsInteger($)||D.IsNumber($)?K.True:K.False}function T0(Z,$){return Object.getOwnPropertyNames(Z.properties).length===$}function S7(Z){return d$(Z)}function H7(Z){return T0(Z,0)||T0(Z,1)&&"description"in Z.properties&&D.IsUnion(Z.properties.description)&&Z.properties.description.anyOf.length===2&&(D.IsString(Z.properties.description.anyOf[0])&&D.IsUndefined(Z.properties.description.anyOf[1])||D.IsString(Z.properties.description.anyOf[1])&&D.IsUndefined(Z.properties.description.anyOf[0]))}function xY(Z){return T0(Z,0)}function D7(Z){return T0(Z,0)}function SH(Z){return T0(Z,0)}function HH(Z){return T0(Z,0)}function DH(Z){return d$(Z)}function AH(Z){let $=Q6();return T0(Z,0)||T0(Z,1)&&"length"in Z.properties&&z6(j1(Z.properties.length,$))===K.True}function NH(Z){return T0(Z,0)}function d$(Z){let $=Q6();return T0(Z,0)||T0(Z,1)&&"length"in Z.properties&&z6(j1(Z.properties.length,$))===K.True}function LH(Z){let $=n6([C8()],C8());return T0(Z,0)||T0(Z,1)&&"then"in Z.properties&&z6(j1(Z.properties.then,$))===K.True}function K7(Z,$){return j1(Z,$)===K.False?K.False:D.IsOptional(Z)&&!D.IsOptional($)?K.False:K.True}function H0(Z,$){return D.IsUnknown(Z)?K.False:D.IsAny(Z)?K.Union:D.IsNever(Z)||D.IsLiteralString(Z)&&S7($)||D.IsLiteralNumber(Z)&&xY($)||D.IsLiteralBoolean(Z)&&D7($)||D.IsSymbol(Z)&&H7($)||D.IsBigInt(Z)&&SH($)||D.IsString(Z)&&S7($)||D.IsSymbol(Z)&&H7($)||D.IsNumber(Z)&&xY($)||D.IsInteger(Z)&&xY($)||D.IsBoolean(Z)&&D7($)||D.IsUint8Array(Z)&&DH($)||D.IsDate(Z)&&HH($)||D.IsConstructor(Z)&&NH($)||D.IsFunction(Z)&&AH($)?K.True:D.IsRecord(Z)&&D.IsString(TY(Z))?(()=>{return $[Y6]==="Record"?K.True:K.False})():D.IsRecord(Z)&&D.IsNumber(TY(Z))?(()=>{return T0($,0)?K.True:K.False})():K.False}function OH(Z,$){return a1($)?e1(Z,$):D.IsRecord($)?q6(Z,$):!D.IsObject($)?K.False:(()=>{for(let Y of Object.getOwnPropertyNames($.properties)){if(!(Y in Z.properties)&&!D.IsOptional($.properties[Y]))return K.False;if(D.IsOptional($.properties[Y]))return K.True;if(K7(Z.properties[Y],$.properties[Y])===K.False)return K.False}return K.True})()}function FH(Z,$){return a1($)?e1(Z,$):D.IsObject($)&&LH($)?K.True:!D.IsPromise($)?K.False:z6(j1(Z.item,$.item))}function TY(Z){return i6 in Z.patternProperties?Q6():(l6 in Z.patternProperties)?F0():u4("Unknown record key pattern")}function bY(Z){return i6 in Z.patternProperties?Z.patternProperties[i6]:(l6 in Z.patternProperties)?Z.patternProperties[l6]:u4("Unable to get record value schema")}function q6(Z,$){let[Y,Q]=[TY($),bY($)];return D.IsLiteralString(Z)&&D.IsNumber(Y)&&z6(j1(Z,Q))===K.True?K.True:D.IsUint8Array(Z)&&D.IsNumber(Y)?j1(Z,Q):D.IsString(Z)&&D.IsNumber(Y)?j1(Z,Q):D.IsArray(Z)&&D.IsNumber(Y)?j1(Z,Q):D.IsObject(Z)?(()=>{for(let X of Object.getOwnPropertyNames(Z.properties))if(K7(Q,Z.properties[X])===K.False)return K.False;return K.True})():K.False}function KH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):!D.IsRecord($)?K.False:j1(bY(Z),bY($))}function PH(Z,$){let Y=D.IsRegExp(Z)?F0():Z,Q=D.IsRegExp($)?F0():$;return j1(Y,Q)}function P7(Z,$){return D.IsLiteral(Z)&&G0.IsString(Z.const)?K.True:D.IsString(Z)?K.True:K.False}function jH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsString($)?K.True:K.False}function RH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsSymbol($)?K.True:K.False}function _H(Z,$){return D.IsTemplateLiteral(Z)?j1(q4(Z),$):D.IsTemplateLiteral($)?j1(Z,q4($)):u4("Invalid fallthrough for TemplateLiteral")}function CH(Z,$){return D.IsArray($)&&Z.items!==void 0&&Z.items.every((Y)=>j1(Y,$.items)===K.True)}function VH(Z,$){return D.IsNever(Z)?K.True:D.IsUnknown(Z)?K.False:D.IsAny(Z)?K.Union:K.False}function EH(Z,$){return a1($)?e1(Z,$):D.IsObject($)&&d$($)?K.True:D.IsArray($)&&CH(Z,$)?K.True:!D.IsTuple($)?K.False:G0.IsUndefined(Z.items)&&!G0.IsUndefined($.items)||!G0.IsUndefined(Z.items)&&G0.IsUndefined($.items)?K.False:G0.IsUndefined(Z.items)&&!G0.IsUndefined($.items)?K.True:Z.items.every((Y,Q)=>j1(Y,$.items[Q])===K.True)?K.True:K.False}function IH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsUint8Array($)?K.True:K.False}function xH(Z,$){return a1($)?e1(Z,$):D.IsObject($)?H0(Z,$):D.IsRecord($)?q6(Z,$):D.IsVoid($)?kH(Z,$):D.IsUndefined($)?K.True:K.False}function gY(Z,$){return $.anyOf.some((Y)=>j1(Z,Y)===K.True)?K.True:K.False}function TH(Z,$){return Z.anyOf.every((Y)=>j1(Y,$)===K.True)?K.True:K.False}function j7(Z,$){return K.True}function bH(Z,$){return D.IsNever($)?O7(Z,$):D.IsIntersect($)?v$(Z,$):D.IsUnion($)?gY(Z,$):D.IsAny($)?kY(Z,$):D.IsString($)?P7(Z,$):D.IsNumber($)?F7(Z,$):D.IsInteger($)?L7(Z,$):D.IsBoolean($)?N7(Z,$):D.IsArray($)?aS(Z,$):D.IsTuple($)?VH(Z,$):D.IsObject($)?H0(Z,$):D.IsUnknown($)?K.True:K.False}function kH(Z,$){return D.IsUndefined(Z)?K.True:D.IsUndefined(Z)?K.True:K.False}function gH(Z,$){return D.IsIntersect($)?v$(Z,$):D.IsUnion($)?gY(Z,$):D.IsUnknown($)?j7(Z,$):D.IsAny($)?kY(Z,$):D.IsObject($)?H0(Z,$):D.IsVoid($)?K.True:K.False}function j1(Z,$){return D.IsTemplateLiteral(Z)||D.IsTemplateLiteral($)?_H(Z,$):D.IsRegExp(Z)||D.IsRegExp($)?PH(Z,$):D.IsNot(Z)||D.IsNot($)?MH(Z,$):D.IsAny(Z)?rS(Z,$):D.IsArray(Z)?eS(Z,$):D.IsBigInt(Z)?$H(Z,$):D.IsBoolean(Z)?YH(Z,$):D.IsAsyncIterator(Z)?ZH(Z,$):D.IsConstructor(Z)?QH(Z,$):D.IsDate(Z)?XH(Z,$):D.IsFunction(Z)?WH(Z,$):D.IsInteger(Z)?JH(Z,$):D.IsIntersect(Z)?zH(Z,$):D.IsIterator(Z)?qH(Z,$):D.IsLiteral(Z)?UH(Z,$):D.IsNever(Z)?wH(Z,$):D.IsNull(Z)?GH(Z,$):D.IsNumber(Z)?BH(Z,$):D.IsObject(Z)?OH(Z,$):D.IsRecord(Z)?KH(Z,$):D.IsString(Z)?jH(Z,$):D.IsSymbol(Z)?RH(Z,$):D.IsTuple(Z)?EH(Z,$):D.IsPromise(Z)?FH(Z,$):D.IsUint8Array(Z)?IH(Z,$):D.IsUndefined(Z)?xH(Z,$):D.IsUnion(Z)?TH(Z,$):D.IsUnknown(Z)?bH(Z,$):D.IsVoid(Z)?gH(Z,$):u4(`Unknown left type operand '${Z[N]}'`)}function E8(Z,$){return j1(Z,$)}function fH(Z,$,Y,Q,X){let W={};for(let J of globalThis.Object.getOwnPropertyNames(Z))W[J]=p4(Z[J],$,Y,Q,b1(X));return W}function yH(Z,$,Y,Q,X){return fH(Z.properties,$,Y,Q,X)}function R7(Z,$,Y,Q,X){let W=yH(Z,$,Y,Q,X);return w1(W)}function vH(Z,$,Y,Q){let X=E8(Z,$);return X===K.Union?H1([Y,Q]):X===K.True?Y:Q}function p4(Z,$,Y,Q,X){return g1(Z)?R7(Z,$,Y,Q,X):l0(Z)?F(_7(Z,$,Y,Q,X)):F(vH(Z,$,Y,Q),X)}function dH(Z,$,Y,Q,X){return{[Z]:p4(J1(Z),$,Y,Q,b1(X))}}function hH(Z,$,Y,Q,X){return Z.reduce((W,J)=>{return{...W,...dH(J,$,Y,Q,X)}},{})}function mH(Z,$,Y,Q,X){return hH(Z.keys,$,Y,Q,X)}function _7(Z,$,Y,Q,X){let W=mH(Z,$,Y,Q,X);return w1(W)}function uH(Z){return Z.allOf.every(($)=>M8($))}function pH(Z){return Z.anyOf.some(($)=>M8($))}function cH(Z){return!M8(Z.not)}function M8(Z){return Z[N]==="Intersect"?uH(Z):Z[N]==="Union"?pH(Z):Z[N]==="Not"?cH(Z):Z[N]==="Undefined"?!0:!1}function C7(Z,$){return c4(q4(Z),$)}function iH(Z,$){let Y=Z.filter((Q)=>E8(Q,$)===K.False);return Y.length===1?Y[0]:H1(Y)}function c4(Z,$,Y={}){if(n0(Z))return F(C7(Z,$),Y);if(g1(Z))return F(V7(Z,$),Y);return F(U1(Z)?iH(Z.anyOf,$):E8(Z,$)!==K.False?r():Z,Y)}function lH(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=c4(Z[Q],$);return Y}function nH(Z,$){return lH(Z.properties,$)}function V7(Z,$){let Y=nH(Z,$);return w1(Y)}function E7(Z,$){return i4(q4(Z),$)}function oH(Z,$){let Y=Z.filter((Q)=>E8(Q,$)!==K.False);return Y.length===1?Y[0]:H1(Y)}function i4(Z,$,Y){if(n0(Z))return F(E7(Z,$),Y);if(g1(Z))return F(I7(Z,$),Y);return F(U1(Z)?oH(Z.anyOf,$):E8(Z,$)!==K.False?Z:r(),Y)}function tH(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=i4(Z[Q],$);return Y}function sH(Z,$){return tH(Z.properties,$)}function I7(Z,$){let Y=sH(Z,$);return w1(Y)}function x7(Z,$){return P6(Z)?F(Z.returns,$):r($)}function h$(Z){return I0(B0(Z))}function U4(Z,$,Y){return F({[N]:"Record",type:"object",patternProperties:{[Z]:$}},Y)}function fY(Z,$,Y){let Q={};for(let X of Z)Q[X]=$;return D1(Q,{...Y,[Y6]:"Record"})}function rH(Z,$,Y){return _$(Z)?fY(E0(Z),$,Y):U4(Z.pattern,$,Y)}function aH(Z,$,Y){return fY(E0(H1(Z)),$,Y)}function eH(Z,$,Y){return fY([Z.toString()],$,Y)}function ZD(Z,$,Y){return U4(Z.source,$,Y)}function $D(Z,$,Y){let Q=t1(Z.pattern)?l6:Z.pattern;return U4(Q,$,Y)}function YD(Z,$,Y){return U4(l6,$,Y)}function QD(Z,$,Y){return U4(fX,$,Y)}function XD(Z,$,Y){return D1({true:$,false:$},Y)}function WD(Z,$,Y){return U4(i6,$,Y)}function JD(Z,$,Y){return U4(i6,$,Y)}function m$(Z,$,Y={}){return U1(Z)?aH(Z.anyOf,$,Y):n0(Z)?rH(Z,$,Y):i0(Z)?eH(Z.const,$,Y):W8(Z)?XD(Z,$,Y):R6(Z)?WD(Z,$,Y):_6(Z)?JD(Z,$,Y):FY(Z)?ZD(Z,$,Y):J8(Z)?$D(Z,$,Y):LY(Z)?YD(Z,$,Y):R8(Z)?QD(Z,$,Y):r(Y)}function u$(Z){return globalThis.Object.getOwnPropertyNames(Z.patternProperties)[0]}function T7(Z){let $=u$(Z);return $===l6?F0():$===i6?Q6():F0({pattern:$})}function p$(Z){return Z.patternProperties[u$(Z)]}function zD(Z,$){return $.parameters=IZ(Z,$.parameters),$.returns=V6(Z,$.returns),$}function qD(Z,$){return $.parameters=IZ(Z,$.parameters),$.returns=V6(Z,$.returns),$}function UD(Z,$){return $.allOf=IZ(Z,$.allOf),$}function wD(Z,$){return $.anyOf=IZ(Z,$.anyOf),$}function MD(Z,$){if(t1($.items))return $;return $.items=IZ(Z,$.items),$}function GD(Z,$){return $.items=V6(Z,$.items),$}function BD(Z,$){return $.items=V6(Z,$.items),$}function SD(Z,$){return $.items=V6(Z,$.items),$}function HD(Z,$){return $.item=V6(Z,$.item),$}function DD(Z,$){let Y=OD(Z,$.properties);return{...$,...D1(Y)}}function AD(Z,$){let Y=V6(Z,T7($)),Q=V6(Z,p$($)),X=m$(Y,Q);return{...$,...X}}function ND(Z,$){return $.index in Z?Z[$.index]:C6()}function LD(Z,$){let Y=E4($),Q=V0($),X=V6(Z,$);return Y&&Q?h$(X):Y&&!Q?I0(X):!Y&&Q?B0(X):X}function OD(Z,$){return globalThis.Object.getOwnPropertyNames($).reduce((Y,Q)=>{return{...Y,[Q]:LD(Z,$[Q])}},{})}function IZ(Z,$){return $.map((Y)=>V6(Z,Y))}function V6(Z,$){return P6($)?zD(Z,$):j6($)?qD(Z,$):m1($)?UD(Z,$):U1($)?wD(Z,$):o0($)?MD(Z,$):F6($)?GD(Z,$):Y4($)?BD(Z,$):X4($)?SD(Z,$):W4($)?HD(Z,$):s1($)?DD(Z,$):J4($)?AD(Z,$):OY($)?ND(Z,$):$}function b7(Z,$){return V6($,C4(Z))}function k7(Z){return F({[N]:"Integer",type:"integer"},Z)}function FD(Z,$,Y){return{[Z]:E6(J1(Z),$,b1(Y))}}function KD(Z,$,Y){return Z.reduce((X,W)=>{return{...X,...FD(W,$,Y)}},{})}function PD(Z,$,Y){return KD(Z.keys,$,Y)}function g7(Z,$,Y){let Q=PD(Z,$,Y);return w1(Q)}function jD(Z){let[$,Y]=[Z.slice(0,1),Z.slice(1)];return[$.toLowerCase(),Y].join("")}function RD(Z){let[$,Y]=[Z.slice(0,1),Z.slice(1)];return[$.toUpperCase(),Y].join("")}function _D(Z){return Z.toUpperCase()}function CD(Z){return Z.toLowerCase()}function VD(Z,$,Y){let Q=f4(Z.pattern);if(!z4(Q))return{...Z,pattern:f7(Z.pattern,$)};let J=[..._Z(Q)].map((U)=>J1(U)),z=y7(J,$),q=H1(z);return V$([q],Y)}function f7(Z,$){return typeof Z==="string"?$==="Uncapitalize"?jD(Z):$==="Capitalize"?RD(Z):$==="Uppercase"?_D(Z):$==="Lowercase"?CD(Z):Z:Z.toString()}function y7(Z,$){return Z.map((Y)=>E6(Y,$))}function E6(Z,$,Y={}){return l0(Z)?g7(Z,$,Y):n0(Z)?VD(Z,$,Y):U1(Z)?H1(y7(Z.anyOf,$),Y):i0(Z)?J1(f7(Z.const,$),Y):F(Z,Y)}function v7(Z,$={}){return E6(Z,"Capitalize",$)}function d7(Z,$={}){return E6(Z,"Lowercase",$)}function h7(Z,$={}){return E6(Z,"Uncapitalize",$)}function m7(Z,$={}){return E6(Z,"Uppercase",$)}function ED(Z,$,Y){let Q={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Q[X]=I8(Z[X],$,b1(Y));return Q}function ID(Z,$,Y){return ED(Z.properties,$,Y)}function u7(Z,$,Y){let Q=ID(Z,$,Y);return w1(Q)}function xD(Z,$){return Z.map((Y)=>yY(Y,$))}function TD(Z,$){return Z.map((Y)=>yY(Y,$))}function bD(Z,$){let{[$]:Y,...Q}=Z;return Q}function kD(Z,$){return $.reduce((Y,Q)=>bD(Y,Q),Z)}function gD(Z,$){let Y=u1(Z,[C1,"$id","required","properties"]),Q=kD(Z.properties,$);return D1(Q,Y)}function fD(Z){let $=Z.reduce((Y,Q)=>P$(Q)?[...Y,J1(Q)]:Y,[]);return H1($)}function yY(Z,$){return m1(Z)?S0(xD(Z.allOf,$)):U1(Z)?H1(TD(Z.anyOf,$)):s1(Z)?gD(Z,$):D1({})}function I8(Z,$,Y){let Q=o1($)?fD($):$,X=v1($)?E0($):$,W=n1(Z),J=n1($);return g1(Z)?u7(Z,X,Y):l0($)?p7(Z,$,Y):W&&J?x1("Omit",[Z,Q],Y):!W&&J?x1("Omit",[Z,Q],Y):W&&!J?x1("Omit",[Z,Q],Y):F({...yY(Z,X),...Y})}function yD(Z,$,Y){return{[$]:I8(Z,[$],b1(Y))}}function vD(Z,$,Y){return $.reduce((Q,X)=>{return{...Q,...yD(Z,X,Y)}},{})}function dD(Z,$,Y){return vD(Z,$.keys,Y)}function p7(Z,$,Y){let Q=dD(Z,$,Y);return w1(Q)}function hD(Z,$,Y){let Q={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Q[X]=x8(Z[X],$,b1(Y));return Q}function mD(Z,$,Y){return hD(Z.properties,$,Y)}function c7(Z,$,Y){let Q=mD(Z,$,Y);return w1(Q)}function uD(Z,$){return Z.map((Y)=>vY(Y,$))}function pD(Z,$){return Z.map((Y)=>vY(Y,$))}function cD(Z,$){let Y={};for(let Q of $)if(Q in Z)Y[Q]=Z[Q];return Y}function iD(Z,$){let Y=u1(Z,[C1,"$id","required","properties"]),Q=cD(Z.properties,$);return D1(Q,Y)}function lD(Z){let $=Z.reduce((Y,Q)=>P$(Q)?[...Y,J1(Q)]:Y,[]);return H1($)}function vY(Z,$){return m1(Z)?S0(uD(Z.allOf,$)):U1(Z)?H1(pD(Z.anyOf,$)):s1(Z)?iD(Z,$):D1({})}function x8(Z,$,Y){let Q=o1($)?lD($):$,X=v1($)?E0($):$,W=n1(Z),J=n1($);return g1(Z)?c7(Z,X,Y):l0($)?i7(Z,$,Y):W&&J?x1("Pick",[Z,Q],Y):!W&&J?x1("Pick",[Z,Q],Y):W&&!J?x1("Pick",[Z,Q],Y):F({...vY(Z,X),...Y})}function nD(Z,$,Y){return{[$]:x8(Z,[$],b1(Y))}}function oD(Z,$,Y){return $.reduce((Q,X)=>{return{...Q,...nD(Z,X,Y)}},{})}function tD(Z,$,Y){return oD(Z,$.keys,Y)}function i7(Z,$,Y){let Q=tD(Z,$,Y);return w1(Q)}function sD(Z,$){return x1("Partial",[x1(Z,$)])}function rD(Z){return x1("Partial",[J6(Z)])}function aD(Z){let $={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))$[Y]=B0(Z[Y]);return $}function eD(Z){let $=u1(Z,[C1,"$id","required","properties"]),Y=aD(Z.properties);return D1(Y,$)}function l7(Z){return Z.map(($)=>n7($))}function n7(Z){return K6(Z)?sD(Z.target,Z.parameters):n1(Z)?rD(Z.$ref):m1(Z)?S0(l7(Z.allOf)):U1(Z)?H1(l7(Z.anyOf)):s1(Z)?eD(Z):Q4(Z)?Z:W8(Z)?Z:R6(Z)?Z:i0(Z)?Z:OZ(Z)?Z:_6(Z)?Z:J8(Z)?Z:FZ(Z)?Z:z8(Z)?Z:D1({})}function l4(Z,$){if(g1(Z))return o7(Z,$);else return F({...n7(Z),...$})}function ZA(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=l4(Z[Q],b1($));return Y}function $A(Z,$){return ZA(Z.properties,$)}function o7(Z,$){let Y=$A(Z,$);return w1(Y)}function YA(Z,$){return x1("Required",[x1(Z,$)])}function QA(Z){return x1("Required",[J6(Z)])}function XA(Z){let $={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))$[Y]=u1(Z[Y],[z0]);return $}function WA(Z){let $=u1(Z,[C1,"$id","required","properties"]),Y=XA(Z.properties);return D1(Y,$)}function t7(Z){return Z.map(($)=>s7($))}function s7(Z){return K6(Z)?YA(Z.target,Z.parameters):n1(Z)?QA(Z.$ref):m1(Z)?S0(t7(Z.allOf)):U1(Z)?H1(t7(Z.anyOf)):s1(Z)?WA(Z):Q4(Z)?Z:W8(Z)?Z:R6(Z)?Z:i0(Z)?Z:OZ(Z)?Z:_6(Z)?Z:J8(Z)?Z:FZ(Z)?Z:z8(Z)?Z:D1({})}function n4(Z,$){if(g1(Z))return r7(Z,$);else return F({...s7(Z),...$})}function JA(Z,$){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=n4(Z[Q],$);return Y}function zA(Z,$){return JA(Z.properties,$)}function r7(Z,$){let Y=zA(Z,$);return w1(Y)}function qA(Z,$){return $.map((Y)=>{return n1(Y)?dY(Z,Y.$ref):t0(Z,Y)})}function dY(Z,$){return $ in Z?n1(Z[$])?dY(Z,Z[$].$ref):t0(Z,Z[$]):r()}function UA(Z){return h4(Z[0])}function wA(Z){return V8(Z[0],Z[1])}function MA(Z){return m4(Z[0])}function GA(Z){return l4(Z[0])}function BA(Z){return I8(Z[0],Z[1])}function SA(Z){return x8(Z[0],Z[1])}function HA(Z){return n4(Z[0])}function DA(Z,$,Y){let Q=qA(Z,Y);return $==="Awaited"?UA(Q):$==="Index"?wA(Q):$==="KeyOf"?MA(Q):$==="Partial"?GA(Q):$==="Omit"?BA(Q):$==="Pick"?SA(Q):$==="Required"?HA(Q):r()}function AA(Z,$){return T4(t0(Z,$))}function NA(Z,$){return b4(t0(Z,$))}function LA(Z,$,Y){return k4(xZ(Z,$),t0(Z,Y))}function OA(Z,$,Y){return n6(xZ(Z,$),t0(Z,Y))}function FA(Z,$){return S0(xZ(Z,$))}function KA(Z,$){return d4(t0(Z,$))}function PA(Z,$){return D1(globalThis.Object.keys($).reduce((Y,Q)=>{return{...Y,[Q]:t0(Z,$[Q])}},{}))}function jA(Z,$){let[Y,Q]=[t0(Z,p$($)),u$($)],X=C4($);return X.patternProperties[Q]=Y,X}function RA(Z,$){return n1($)?{...dY(Z,$.$ref),[C1]:$[C1]}:$}function _A(Z,$){return X6(xZ(Z,$))}function CA(Z,$){return H1(xZ(Z,$))}function xZ(Z,$){return $.map((Y)=>t0(Z,Y))}function t0(Z,$){return V0($)?F(t0(Z,u1($,[z0])),$):E4($)?F(t0(Z,u1($,[O6])),$):S1($)?F(RA(Z,$),$):F6($)?F(AA(Z,$.items),$):Y4($)?F(NA(Z,$.items),$):K6($)?F(DA(Z,$.target,$.parameters)):P6($)?F(LA(Z,$.parameters,$.returns),$):j6($)?F(OA(Z,$.parameters,$.returns),$):m1($)?F(FA(Z,$.allOf),$):X4($)?F(KA(Z,$.items),$):s1($)?F(PA(Z,$.properties),$):J4($)?F(jA(Z,$)):o0($)?F(_A(Z,$.items||[]),$):U1($)?F(CA(Z,$.anyOf),$):$}function VA(Z,$){return $ in Z?t0(Z,Z[$]):r()}function a7(Z){return globalThis.Object.getOwnPropertyNames(Z).reduce(($,Y)=>{return{...$,[Y]:VA(Z,Y)}},{})}class e7{constructor(Z){let $=a7(Z),Y=this.WithIdentifiers($);this.$defs=Y}Import(Z,$){let Y={...this.$defs,[Z]:F(this.$defs[Z],$)};return F({[N]:"Import",$defs:Y,$ref:Z})}WithIdentifiers(Z){return globalThis.Object.getOwnPropertyNames(Z).reduce(($,Y)=>{return{...$,[Y]:{...Z[Y],$id:Y}}},{})}}function ZW(Z){return new e7(Z)}function $W(Z,$){return F({[N]:"Not",not:Z},$)}function YW(Z,$){return j6(Z)?X6(Z.parameters,$):r()}var EA=0;function QW(Z,$={}){if(t1($.$id))$.$id=`T${EA++}`;let Y=C4(Z({[N]:"This",$ref:`${$.$id}`}));return Y.$id=$.$id,F({[Y6]:"Recursive",...Y},$)}function XW(Z,$){let Y=_1(Z)?new globalThis.RegExp(Z):Z;return F({[N]:"RegExp",type:"RegExp",source:Y.source,flags:Y.flags},$)}function IA(Z){return m1(Z)?Z.allOf:U1(Z)?Z.anyOf:o0(Z)?Z.items??[]:[]}function WW(Z){return IA(Z)}function JW(Z,$){return j6(Z)?F(Z.returns,$):r($)}class zW{constructor(Z){this.schema=Z}Decode(Z){return new qW(this.schema,Z)}}class qW{constructor(Z,$){this.schema=Z,this.decode=$}EncodeTransform(Z,$){let X={Encode:(W)=>$[C1].Encode(Z(W)),Decode:(W)=>this.decode($[C1].Decode(W))};return{...$,[C1]:X}}EncodeSchema(Z,$){let Y={Decode:this.decode,Encode:Z};return{...$,[C1]:Y}}Encode(Z){return S1(this.schema)?this.EncodeTransform(Z,this.schema):this.EncodeSchema(Z,this.schema)}}function UW(Z){return new zW(Z)}function c$(Z={}){return F({[N]:Z[N]??"Unsafe"},Z)}function wW(Z){return F({[N]:"Void",type:"void"},Z)}var hY={};e8(hY,{Void:()=>wW,Uppercase:()=>m7,Unsafe:()=>c$,Unknown:()=>C6,Union:()=>H1,Undefined:()=>g$,Uncapitalize:()=>h7,Uint8Array:()=>f$,Tuple:()=>X6,Transform:()=>UW,TemplateLiteral:()=>V$,Symbol:()=>k$,String:()=>F0,ReturnType:()=>JW,Rest:()=>WW,Required:()=>n4,RegExp:()=>XW,Ref:()=>J6,Recursive:()=>QW,Record:()=>m$,ReadonlyOptional:()=>h$,Readonly:()=>I0,Promise:()=>I$,Pick:()=>x8,Partial:()=>l4,Parameters:()=>YW,Optional:()=>B0,Omit:()=>I8,Object:()=>D1,Number:()=>Q6,Null:()=>b$,Not:()=>$W,Never:()=>r,Module:()=>ZW,Mapped:()=>Q7,Lowercase:()=>d7,Literal:()=>J1,KeyOf:()=>m4,Iterator:()=>d4,Intersect:()=>S0,Integer:()=>k7,Instantiate:()=>b7,InstanceType:()=>x7,Index:()=>V8,Function:()=>n6,Extract:()=>i4,Extends:()=>p4,Exclude:()=>c4,Enum:()=>G7,Date:()=>T$,ConstructorParameters:()=>M7,Constructor:()=>k4,Const:()=>w7,Composite:()=>U7,Capitalize:()=>v7,Boolean:()=>C$,BigInt:()=>v4,Awaited:()=>h4,AsyncIterator:()=>b4,Array:()=>T4,Argument:()=>mX,Any:()=>C8});var T8=hY;function xA(Z){switch(Z.errorType){case O.ArrayContains:return"Expected array to contain at least one matching value";case O.ArrayMaxContains:return`Expected array to contain no more than ${Z.schema.maxContains} matching values`;case O.ArrayMinContains:return`Expected array to contain at least ${Z.schema.minContains} matching values`;case O.ArrayMaxItems:return`Expected array length to be less or equal to ${Z.schema.maxItems}`;case O.ArrayMinItems:return`Expected array length to be greater or equal to ${Z.schema.minItems}`;case O.ArrayUniqueItems:return"Expected array elements to be unique";case O.Array:return"Expected array";case O.AsyncIterator:return"Expected AsyncIterator";case O.BigIntExclusiveMaximum:return`Expected bigint to be less than ${Z.schema.exclusiveMaximum}`;case O.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${Z.schema.exclusiveMinimum}`;case O.BigIntMaximum:return`Expected bigint to be less or equal to ${Z.schema.maximum}`;case O.BigIntMinimum:return`Expected bigint to be greater or equal to ${Z.schema.minimum}`;case O.BigIntMultipleOf:return`Expected bigint to be a multiple of ${Z.schema.multipleOf}`;case O.BigInt:return"Expected bigint";case O.Boolean:return"Expected boolean";case O.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${Z.schema.exclusiveMinimumTimestamp}`;case O.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${Z.schema.exclusiveMaximumTimestamp}`;case O.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${Z.schema.minimumTimestamp}`;case O.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${Z.schema.maximumTimestamp}`;case O.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${Z.schema.multipleOfTimestamp}`;case O.Date:return"Expected Date";case O.Function:return"Expected function";case O.IntegerExclusiveMaximum:return`Expected integer to be less than ${Z.schema.exclusiveMaximum}`;case O.IntegerExclusiveMinimum:return`Expected integer to be greater than ${Z.schema.exclusiveMinimum}`;case O.IntegerMaximum:return`Expected integer to be less or equal to ${Z.schema.maximum}`;case O.IntegerMinimum:return`Expected integer to be greater or equal to ${Z.schema.minimum}`;case O.IntegerMultipleOf:return`Expected integer to be a multiple of ${Z.schema.multipleOf}`;case O.Integer:return"Expected integer";case O.IntersectUnevaluatedProperties:return"Unexpected property";case O.Intersect:return"Expected all values to match";case O.Iterator:return"Expected Iterator";case O.Literal:return`Expected ${typeof Z.schema.const==="string"?`'${Z.schema.const}'`:Z.schema.const}`;case O.Never:return"Never";case O.Not:return"Value should not match";case O.Null:return"Expected null";case O.NumberExclusiveMaximum:return`Expected number to be less than ${Z.schema.exclusiveMaximum}`;case O.NumberExclusiveMinimum:return`Expected number to be greater than ${Z.schema.exclusiveMinimum}`;case O.NumberMaximum:return`Expected number to be less or equal to ${Z.schema.maximum}`;case O.NumberMinimum:return`Expected number to be greater or equal to ${Z.schema.minimum}`;case O.NumberMultipleOf:return`Expected number to be a multiple of ${Z.schema.multipleOf}`;case O.Number:return"Expected number";case O.Object:return"Expected object";case O.ObjectAdditionalProperties:return"Unexpected property";case O.ObjectMaxProperties:return`Expected object to have no more than ${Z.schema.maxProperties} properties`;case O.ObjectMinProperties:return`Expected object to have at least ${Z.schema.minProperties} properties`;case O.ObjectRequiredProperty:return"Expected required property";case O.Promise:return"Expected Promise";case O.RegExp:return"Expected string to match regular expression";case O.StringFormatUnknown:return`Unknown format '${Z.schema.format}'`;case O.StringFormat:return`Expected string to match '${Z.schema.format}' format`;case O.StringMaxLength:return`Expected string length less or equal to ${Z.schema.maxLength}`;case O.StringMinLength:return`Expected string length greater or equal to ${Z.schema.minLength}`;case O.StringPattern:return`Expected string to match '${Z.schema.pattern}'`;case O.String:return"Expected string";case O.Symbol:return"Expected symbol";case O.TupleLength:return`Expected tuple to have ${Z.schema.maxItems||0} elements`;case O.Tuple:return"Expected tuple";case O.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${Z.schema.maxByteLength}`;case O.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${Z.schema.minByteLength}`;case O.Uint8Array:return"Expected Uint8Array";case O.Undefined:return"Expected undefined";case O.Union:return"Expected union value";case O.Void:return"Expected void";case O.Kind:return`Expected kind '${Z.schema[N]}'`;default:return"Unknown error type"}}var TA=xA;function MW(){return TA}class GW extends p{constructor(Z){super(`Unable to dereference schema with $id '${Z.$ref}'`);this.schema=Z}}function bA(Z,$){let Y=$.find((Q)=>Q.$id===Z.$ref);if(Y===void 0)throw new GW(Z);return M1(Y,$)}function Y0(Z,$){if(!q1(Z.$id)||$.some((Y)=>Y.$id===Z.$id))return $;return $.push(Z),$}function M1(Z,$){return Z[N]==="This"||Z[N]==="Ref"?bA(Z,$):Z}class BW extends p{constructor(Z){super("Unable to hash value");this.value=Z}}var s0;(function(Z){Z[Z.Undefined=0]="Undefined",Z[Z.Null=1]="Null",Z[Z.Boolean=2]="Boolean",Z[Z.Number=3]="Number",Z[Z.String=4]="String",Z[Z.Object=5]="Object",Z[Z.Array=6]="Array",Z[Z.Date=7]="Date",Z[Z.Uint8Array=8]="Uint8Array",Z[Z.Symbol=9]="Symbol",Z[Z.BigInt=10]="BigInt"})(s0||(s0={}));var o4=BigInt("14695981039346656037"),[kA,gA]=[BigInt("1099511628211"),BigInt("18446744073709551616")],fA=Array.from({length:256}).map((Z,$)=>BigInt($)),SW=new Float64Array(1),HW=new DataView(SW.buffer),DW=new Uint8Array(SW.buffer);function*yA(Z){let $=Z===0?1:Math.ceil(Math.floor(Math.log2(Z)+1)/8);for(let Y=0;Y<$;Y++)yield Z>>8*($-1-Y)&255}function vA(Z){D0(s0.Array);for(let $ of Z)t4($)}function dA(Z){D0(s0.Boolean),D0(Z?1:0)}function hA(Z){D0(s0.BigInt),HW.setBigInt64(0,Z);for(let $ of DW)D0($)}function mA(Z){D0(s0.Date),t4(Z.getTime())}function uA(Z){D0(s0.Null)}function pA(Z){D0(s0.Number),HW.setFloat64(0,Z);for(let $ of DW)D0($)}function cA(Z){D0(s0.Object);for(let $ of globalThis.Object.getOwnPropertyNames(Z).sort())t4($),t4(Z[$])}function iA(Z){D0(s0.String);for(let $=0;$<Z.length;$++)for(let Y of yA(Z.charCodeAt($)))D0(Y)}function lA(Z){D0(s0.Symbol),t4(Z.description)}function nA(Z){D0(s0.Uint8Array);for(let $=0;$<Z.length;$++)D0(Z[$])}function oA(Z){return D0(s0.Undefined)}function t4(Z){if(i(Z))return vA(Z);if(c6(Z))return dA(Z);if(J0(Z))return hA(Z);if(O0(Z))return mA(Z);if(Q8(Z))return uA(Z);if(u(Z))return pA(Z);if(a(Z))return cA(Z);if(q1(Z))return iA(Z);if(X8(Z))return lA(Z);if(V4(Z))return nA(Z);if(k1(Z))return oA(Z);throw new BW(Z)}function D0(Z){o4=o4^fA[Z],o4=o4*kA%gA}function b8(Z){return o4=BigInt("14695981039346656037"),t4(Z),o4}class AW extends p{constructor(Z){super("Unknown type");this.schema=Z}}function tA(Z){return Z[N]==="Any"||Z[N]==="Unknown"}function Y1(Z){return Z!==void 0}function sA(Z,$,Y){return!0}function rA(Z,$,Y){return!0}function aA(Z,$,Y){if(!i(Y))return!1;if(Y1(Z.minItems)&&!(Y.length>=Z.minItems))return!1;if(Y1(Z.maxItems)&&!(Y.length<=Z.maxItems))return!1;if(!Y.every((W)=>Q0(Z.items,$,W)))return!1;if(Z.uniqueItems===!0&&!function(){let W=new Set;for(let J of Y){let z=b8(J);if(W.has(z))return!1;else W.add(z)}return!0}())return!1;if(!(Y1(Z.contains)||u(Z.minContains)||u(Z.maxContains)))return!0;let Q=Y1(Z.contains)?Z.contains:r(),X=Y.reduce((W,J)=>Q0(Q,$,J)?W+1:W,0);if(X===0)return!1;if(u(Z.minContains)&&X<Z.minContains)return!1;if(u(Z.maxContains)&&X>Z.maxContains)return!1;return!0}function eA(Z,$,Y){return L$(Y)}function ZN(Z,$,Y){if(!J0(Y))return!1;if(Y1(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))return!1;if(Y1(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))return!1;if(Y1(Z.maximum)&&!(Y<=Z.maximum))return!1;if(Y1(Z.minimum)&&!(Y>=Z.minimum))return!1;if(Y1(Z.multipleOf)&&Y%Z.multipleOf!==BigInt(0))return!1;return!0}function $N(Z,$,Y){return c6(Y)}function YN(Z,$,Y){return Q0(Z.returns,$,Y.prototype)}function QN(Z,$,Y){if(!O0(Y))return!1;if(Y1(Z.exclusiveMaximumTimestamp)&&!(Y.getTime()<Z.exclusiveMaximumTimestamp))return!1;if(Y1(Z.exclusiveMinimumTimestamp)&&!(Y.getTime()>Z.exclusiveMinimumTimestamp))return!1;if(Y1(Z.maximumTimestamp)&&!(Y.getTime()<=Z.maximumTimestamp))return!1;if(Y1(Z.minimumTimestamp)&&!(Y.getTime()>=Z.minimumTimestamp))return!1;if(Y1(Z.multipleOfTimestamp)&&Y.getTime()%Z.multipleOfTimestamp!==0)return!1;return!0}function XN(Z,$,Y){return j8(Y)}function WN(Z,$,Y){let Q=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];return Q0(X,[...$,...Q],Y)}function JN(Z,$,Y){if(!K$(Y))return!1;if(Y1(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))return!1;if(Y1(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))return!1;if(Y1(Z.maximum)&&!(Y<=Z.maximum))return!1;if(Y1(Z.minimum)&&!(Y>=Z.minimum))return!1;if(Y1(Z.multipleOf)&&Y%Z.multipleOf!==0)return!1;return!0}function zN(Z,$,Y){let Q=Z.allOf.every((X)=>Q0(X,$,Y));if(Z.unevaluatedProperties===!1){let X=new RegExp(w8(Z)),W=Object.getOwnPropertyNames(Y).every((J)=>X.test(J));return Q&&W}else if(v1(Z.unevaluatedProperties)){let X=new RegExp(w8(Z)),W=Object.getOwnPropertyNames(Y).every((J)=>X.test(J)||Q0(Z.unevaluatedProperties,$,Y[J]));return Q&&W}else return Q}function qN(Z,$,Y){return O$(Y)}function UN(Z,$,Y){return Y===Z.const}function wN(Z,$,Y){return!1}function MN(Z,$,Y){return!Q0(Z.not,$,Y)}function GN(Z,$,Y){return Q8(Y)}function BN(Z,$,Y){if(!I1.IsNumberLike(Y))return!1;if(Y1(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))return!1;if(Y1(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))return!1;if(Y1(Z.minimum)&&!(Y>=Z.minimum))return!1;if(Y1(Z.maximum)&&!(Y<=Z.maximum))return!1;if(Y1(Z.multipleOf)&&Y%Z.multipleOf!==0)return!1;return!0}function SN(Z,$,Y){if(!I1.IsObjectLike(Y))return!1;if(Y1(Z.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=Z.minProperties))return!1;if(Y1(Z.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=Z.maxProperties))return!1;let Q=Object.getOwnPropertyNames(Z.properties);for(let X of Q){let W=Z.properties[X];if(Z.required&&Z.required.includes(X)){if(!Q0(W,$,Y[X]))return!1;if((M8(W)||tA(W))&&!(X in Y))return!1}else if(I1.IsExactOptionalProperty(Y,X)&&!Q0(W,$,Y[X]))return!1}if(Z.additionalProperties===!1){let X=Object.getOwnPropertyNames(Y);if(Z.required&&Z.required.length===Q.length&&X.length===Q.length)return!0;else return X.every((W)=>Q.includes(W))}else if(typeof Z.additionalProperties==="object")return Object.getOwnPropertyNames(Y).every((W)=>Q.includes(W)||Q0(Z.additionalProperties,$,Y[W]));else return!0}function HN(Z,$,Y){return F$(Y)}function DN(Z,$,Y){if(!I1.IsRecordLike(Y))return!1;if(Y1(Z.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=Z.minProperties))return!1;if(Y1(Z.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=Z.maxProperties))return!1;let[Q,X]=Object.entries(Z.patternProperties)[0],W=new RegExp(Q),J=Object.entries(Y).every(([U,w])=>{return W.test(U)?Q0(X,$,w):!0}),z=typeof Z.additionalProperties==="object"?Object.entries(Y).every(([U,w])=>{return!W.test(U)?Q0(Z.additionalProperties,$,w):!0}):!0,q=Z.additionalProperties===!1?Object.getOwnPropertyNames(Y).every((U)=>{return W.test(U)}):!0;return J&&z&&q}function AN(Z,$,Y){return Q0(M1(Z,$),$,Y)}function NN(Z,$,Y){let Q=new RegExp(Z.source,Z.flags);if(Y1(Z.minLength)){if(!(Y.length>=Z.minLength))return!1}if(Y1(Z.maxLength)){if(!(Y.length<=Z.maxLength))return!1}return Q.test(Y)}function LN(Z,$,Y){if(!q1(Y))return!1;if(Y1(Z.minLength)){if(!(Y.length>=Z.minLength))return!1}if(Y1(Z.maxLength)){if(!(Y.length<=Z.maxLength))return!1}if(Y1(Z.pattern)){if(!new RegExp(Z.pattern).test(Y))return!1}if(Y1(Z.format)){if(!F1.Has(Z.format))return!1;return F1.Get(Z.format)(Y)}return!0}function ON(Z,$,Y){return X8(Y)}function FN(Z,$,Y){return q1(Y)&&new RegExp(Z.pattern).test(Y)}function KN(Z,$,Y){return Q0(M1(Z,$),$,Y)}function PN(Z,$,Y){if(!i(Y))return!1;if(Z.items===void 0&&Y.length!==0)return!1;if(Y.length!==Z.maxItems)return!1;if(!Z.items)return!0;for(let Q=0;Q<Z.items.length;Q++)if(!Q0(Z.items[Q],$,Y[Q]))return!1;return!0}function jN(Z,$,Y){return k1(Y)}function RN(Z,$,Y){return Z.anyOf.some((Q)=>Q0(Q,$,Y))}function _N(Z,$,Y){if(!V4(Y))return!1;if(Y1(Z.maxByteLength)&&!(Y.length<=Z.maxByteLength))return!1;if(Y1(Z.minByteLength)&&!(Y.length>=Z.minByteLength))return!1;return!0}function CN(Z,$,Y){return!0}function VN(Z,$,Y){return I1.IsVoidLike(Y)}function EN(Z,$,Y){if(!r1.Has(Z[N]))return!1;return r1.Get(Z[N])(Z,Y)}function Q0(Z,$,Y){let Q=Y1(Z.$id)?Y0(Z,$):$,X=Z;switch(X[N]){case"Any":return sA(X,Q,Y);case"Argument":return rA(X,Q,Y);case"Array":return aA(X,Q,Y);case"AsyncIterator":return eA(X,Q,Y);case"BigInt":return ZN(X,Q,Y);case"Boolean":return $N(X,Q,Y);case"Constructor":return YN(X,Q,Y);case"Date":return QN(X,Q,Y);case"Function":return XN(X,Q,Y);case"Import":return WN(X,Q,Y);case"Integer":return JN(X,Q,Y);case"Intersect":return zN(X,Q,Y);case"Iterator":return qN(X,Q,Y);case"Literal":return UN(X,Q,Y);case"Never":return wN(X,Q,Y);case"Not":return MN(X,Q,Y);case"Null":return GN(X,Q,Y);case"Number":return BN(X,Q,Y);case"Object":return SN(X,Q,Y);case"Promise":return HN(X,Q,Y);case"Record":return DN(X,Q,Y);case"Ref":return AN(X,Q,Y);case"RegExp":return NN(X,Q,Y);case"String":return LN(X,Q,Y);case"Symbol":return ON(X,Q,Y);case"TemplateLiteral":return FN(X,Q,Y);case"This":return KN(X,Q,Y);case"Tuple":return PN(X,Q,Y);case"Undefined":return jN(X,Q,Y);case"Union":return RN(X,Q,Y);case"Uint8Array":return _N(X,Q,Y);case"Unknown":return CN(X,Q,Y);case"Void":return VN(X,Q,Y);default:if(!r1.Has(X[N]))throw new AW(X);return EN(X,Q,Y)}}function e(...Z){return Z.length===3?Q0(Z[0],Z[1],Z[2]):Q0(Z[0],[],Z[1])}var O;(function(Z){Z[Z.ArrayContains=0]="ArrayContains",Z[Z.ArrayMaxContains=1]="ArrayMaxContains",Z[Z.ArrayMaxItems=2]="ArrayMaxItems",Z[Z.ArrayMinContains=3]="ArrayMinContains",Z[Z.ArrayMinItems=4]="ArrayMinItems",Z[Z.ArrayUniqueItems=5]="ArrayUniqueItems",Z[Z.Array=6]="Array",Z[Z.AsyncIterator=7]="AsyncIterator",Z[Z.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",Z[Z.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",Z[Z.BigIntMaximum=10]="BigIntMaximum",Z[Z.BigIntMinimum=11]="BigIntMinimum",Z[Z.BigIntMultipleOf=12]="BigIntMultipleOf",Z[Z.BigInt=13]="BigInt",Z[Z.Boolean=14]="Boolean",Z[Z.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",Z[Z.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",Z[Z.DateMaximumTimestamp=17]="DateMaximumTimestamp",Z[Z.DateMinimumTimestamp=18]="DateMinimumTimestamp",Z[Z.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",Z[Z.Date=20]="Date",Z[Z.Function=21]="Function",Z[Z.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",Z[Z.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",Z[Z.IntegerMaximum=24]="IntegerMaximum",Z[Z.IntegerMinimum=25]="IntegerMinimum",Z[Z.IntegerMultipleOf=26]="IntegerMultipleOf",Z[Z.Integer=27]="Integer",Z[Z.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",Z[Z.Intersect=29]="Intersect",Z[Z.Iterator=30]="Iterator",Z[Z.Kind=31]="Kind",Z[Z.Literal=32]="Literal",Z[Z.Never=33]="Never",Z[Z.Not=34]="Not",Z[Z.Null=35]="Null",Z[Z.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",Z[Z.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",Z[Z.NumberMaximum=38]="NumberMaximum",Z[Z.NumberMinimum=39]="NumberMinimum",Z[Z.NumberMultipleOf=40]="NumberMultipleOf",Z[Z.Number=41]="Number",Z[Z.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",Z[Z.ObjectMaxProperties=43]="ObjectMaxProperties",Z[Z.ObjectMinProperties=44]="ObjectMinProperties",Z[Z.ObjectRequiredProperty=45]="ObjectRequiredProperty",Z[Z.Object=46]="Object",Z[Z.Promise=47]="Promise",Z[Z.RegExp=48]="RegExp",Z[Z.StringFormatUnknown=49]="StringFormatUnknown",Z[Z.StringFormat=50]="StringFormat",Z[Z.StringMaxLength=51]="StringMaxLength",Z[Z.StringMinLength=52]="StringMinLength",Z[Z.StringPattern=53]="StringPattern",Z[Z.String=54]="String",Z[Z.Symbol=55]="Symbol",Z[Z.TupleLength=56]="TupleLength",Z[Z.Tuple=57]="Tuple",Z[Z.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",Z[Z.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",Z[Z.Uint8Array=60]="Uint8Array",Z[Z.Undefined=61]="Undefined",Z[Z.Union=62]="Union",Z[Z.Void=63]="Void"})(O||(O={}));class NW extends p{constructor(Z){super("Unknown type");this.schema=Z}}function G8(Z){return Z.replace(/~/g,"~0").replace(/\//g,"~1")}function Q1(Z){return Z!==void 0}class w4{constructor(Z){this.iterator=Z}[Symbol.iterator](){return this.iterator}First(){let Z=this.iterator.next();return Z.done?void 0:Z.value}}function b(Z,$,Y,Q,X=[]){return{type:Z,schema:$,path:Y,value:Q,message:MW()({errorType:Z,path:Y,schema:$,value:Q,errors:X}),errors:X}}function*IN(Z,$,Y,Q){}function*xN(Z,$,Y,Q){}function*TN(Z,$,Y,Q){if(!i(Q))return yield b(O.Array,Z,Y,Q);if(Q1(Z.minItems)&&!(Q.length>=Z.minItems))yield b(O.ArrayMinItems,Z,Y,Q);if(Q1(Z.maxItems)&&!(Q.length<=Z.maxItems))yield b(O.ArrayMaxItems,Z,Y,Q);for(let J=0;J<Q.length;J++)yield*X0(Z.items,$,`${Y}/${J}`,Q[J]);if(Z.uniqueItems===!0&&!function(){let J=new Set;for(let z of Q){let q=b8(z);if(J.has(q))return!1;else J.add(q)}return!0}())yield b(O.ArrayUniqueItems,Z,Y,Q);if(!(Q1(Z.contains)||Q1(Z.minContains)||Q1(Z.maxContains)))return;let X=Q1(Z.contains)?Z.contains:r(),W=Q.reduce((J,z,q)=>X0(X,$,`${Y}${q}`,z).next().done===!0?J+1:J,0);if(W===0)yield b(O.ArrayContains,Z,Y,Q);if(u(Z.minContains)&&W<Z.minContains)yield b(O.ArrayMinContains,Z,Y,Q);if(u(Z.maxContains)&&W>Z.maxContains)yield b(O.ArrayMaxContains,Z,Y,Q)}function*bN(Z,$,Y,Q){if(!L$(Q))yield b(O.AsyncIterator,Z,Y,Q)}function*kN(Z,$,Y,Q){if(!J0(Q))return yield b(O.BigInt,Z,Y,Q);if(Q1(Z.exclusiveMaximum)&&!(Q<Z.exclusiveMaximum))yield b(O.BigIntExclusiveMaximum,Z,Y,Q);if(Q1(Z.exclusiveMinimum)&&!(Q>Z.exclusiveMinimum))yield b(O.BigIntExclusiveMinimum,Z,Y,Q);if(Q1(Z.maximum)&&!(Q<=Z.maximum))yield b(O.BigIntMaximum,Z,Y,Q);if(Q1(Z.minimum)&&!(Q>=Z.minimum))yield b(O.BigIntMinimum,Z,Y,Q);if(Q1(Z.multipleOf)&&Q%Z.multipleOf!==BigInt(0))yield b(O.BigIntMultipleOf,Z,Y,Q)}function*gN(Z,$,Y,Q){if(!c6(Q))yield b(O.Boolean,Z,Y,Q)}function*fN(Z,$,Y,Q){yield*X0(Z.returns,$,Y,Q.prototype)}function*yN(Z,$,Y,Q){if(!O0(Q))return yield b(O.Date,Z,Y,Q);if(Q1(Z.exclusiveMaximumTimestamp)&&!(Q.getTime()<Z.exclusiveMaximumTimestamp))yield b(O.DateExclusiveMaximumTimestamp,Z,Y,Q);if(Q1(Z.exclusiveMinimumTimestamp)&&!(Q.getTime()>Z.exclusiveMinimumTimestamp))yield b(O.DateExclusiveMinimumTimestamp,Z,Y,Q);if(Q1(Z.maximumTimestamp)&&!(Q.getTime()<=Z.maximumTimestamp))yield b(O.DateMaximumTimestamp,Z,Y,Q);if(Q1(Z.minimumTimestamp)&&!(Q.getTime()>=Z.minimumTimestamp))yield b(O.DateMinimumTimestamp,Z,Y,Q);if(Q1(Z.multipleOfTimestamp)&&Q.getTime()%Z.multipleOfTimestamp!==0)yield b(O.DateMultipleOfTimestamp,Z,Y,Q)}function*vN(Z,$,Y,Q){if(!j8(Q))yield b(O.Function,Z,Y,Q)}function*dN(Z,$,Y,Q){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];yield*X0(W,[...$,...X],Y,Q)}function*hN(Z,$,Y,Q){if(!K$(Q))return yield b(O.Integer,Z,Y,Q);if(Q1(Z.exclusiveMaximum)&&!(Q<Z.exclusiveMaximum))yield b(O.IntegerExclusiveMaximum,Z,Y,Q);if(Q1(Z.exclusiveMinimum)&&!(Q>Z.exclusiveMinimum))yield b(O.IntegerExclusiveMinimum,Z,Y,Q);if(Q1(Z.maximum)&&!(Q<=Z.maximum))yield b(O.IntegerMaximum,Z,Y,Q);if(Q1(Z.minimum)&&!(Q>=Z.minimum))yield b(O.IntegerMinimum,Z,Y,Q);if(Q1(Z.multipleOf)&&Q%Z.multipleOf!==0)yield b(O.IntegerMultipleOf,Z,Y,Q)}function*mN(Z,$,Y,Q){let X=!1;for(let W of Z.allOf)for(let J of X0(W,$,Y,Q))X=!0,yield J;if(X)return yield b(O.Intersect,Z,Y,Q);if(Z.unevaluatedProperties===!1){let W=new RegExp(w8(Z));for(let J of Object.getOwnPropertyNames(Q))if(!W.test(J))yield b(O.IntersectUnevaluatedProperties,Z,`${Y}/${J}`,Q)}if(typeof Z.unevaluatedProperties==="object"){let W=new RegExp(w8(Z));for(let J of Object.getOwnPropertyNames(Q))if(!W.test(J)){let z=X0(Z.unevaluatedProperties,$,`${Y}/${J}`,Q[J]).next();if(!z.done)yield z.value}}}function*uN(Z,$,Y,Q){if(!O$(Q))yield b(O.Iterator,Z,Y,Q)}function*pN(Z,$,Y,Q){if(Q!==Z.const)yield b(O.Literal,Z,Y,Q)}function*cN(Z,$,Y,Q){yield b(O.Never,Z,Y,Q)}function*iN(Z,$,Y,Q){if(X0(Z.not,$,Y,Q).next().done===!0)yield b(O.Not,Z,Y,Q)}function*lN(Z,$,Y,Q){if(!Q8(Q))yield b(O.Null,Z,Y,Q)}function*nN(Z,$,Y,Q){if(!I1.IsNumberLike(Q))return yield b(O.Number,Z,Y,Q);if(Q1(Z.exclusiveMaximum)&&!(Q<Z.exclusiveMaximum))yield b(O.NumberExclusiveMaximum,Z,Y,Q);if(Q1(Z.exclusiveMinimum)&&!(Q>Z.exclusiveMinimum))yield b(O.NumberExclusiveMinimum,Z,Y,Q);if(Q1(Z.maximum)&&!(Q<=Z.maximum))yield b(O.NumberMaximum,Z,Y,Q);if(Q1(Z.minimum)&&!(Q>=Z.minimum))yield b(O.NumberMinimum,Z,Y,Q);if(Q1(Z.multipleOf)&&Q%Z.multipleOf!==0)yield b(O.NumberMultipleOf,Z,Y,Q)}function*oN(Z,$,Y,Q){if(!I1.IsObjectLike(Q))return yield b(O.Object,Z,Y,Q);if(Q1(Z.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=Z.minProperties))yield b(O.ObjectMinProperties,Z,Y,Q);if(Q1(Z.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=Z.maxProperties))yield b(O.ObjectMaxProperties,Z,Y,Q);let X=Array.isArray(Z.required)?Z.required:[],W=Object.getOwnPropertyNames(Z.properties),J=Object.getOwnPropertyNames(Q);for(let z of X){if(J.includes(z))continue;yield b(O.ObjectRequiredProperty,Z.properties[z],`${Y}/${G8(z)}`,void 0)}if(Z.additionalProperties===!1){for(let z of J)if(!W.includes(z))yield b(O.ObjectAdditionalProperties,Z,`${Y}/${G8(z)}`,Q[z])}if(typeof Z.additionalProperties==="object")for(let z of J){if(W.includes(z))continue;yield*X0(Z.additionalProperties,$,`${Y}/${G8(z)}`,Q[z])}for(let z of W){let q=Z.properties[z];if(Z.required&&Z.required.includes(z)){if(yield*X0(q,$,`${Y}/${G8(z)}`,Q[z]),M8(Z)&&!(z in Q))yield b(O.ObjectRequiredProperty,q,`${Y}/${G8(z)}`,void 0)}else if(I1.IsExactOptionalProperty(Q,z))yield*X0(q,$,`${Y}/${G8(z)}`,Q[z])}}function*tN(Z,$,Y,Q){if(!F$(Q))yield b(O.Promise,Z,Y,Q)}function*sN(Z,$,Y,Q){if(!I1.IsRecordLike(Q))return yield b(O.Object,Z,Y,Q);if(Q1(Z.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=Z.minProperties))yield b(O.ObjectMinProperties,Z,Y,Q);if(Q1(Z.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=Z.maxProperties))yield b(O.ObjectMaxProperties,Z,Y,Q);let[X,W]=Object.entries(Z.patternProperties)[0],J=new RegExp(X);for(let[z,q]of Object.entries(Q))if(J.test(z))yield*X0(W,$,`${Y}/${G8(z)}`,q);if(typeof Z.additionalProperties==="object"){for(let[z,q]of Object.entries(Q))if(!J.test(z))yield*X0(Z.additionalProperties,$,`${Y}/${G8(z)}`,q)}if(Z.additionalProperties===!1)for(let[z,q]of Object.entries(Q)){if(J.test(z))continue;return yield b(O.ObjectAdditionalProperties,Z,`${Y}/${G8(z)}`,q)}}function*rN(Z,$,Y,Q){yield*X0(M1(Z,$),$,Y,Q)}function*aN(Z,$,Y,Q){if(!q1(Q))return yield b(O.String,Z,Y,Q);if(Q1(Z.minLength)&&!(Q.length>=Z.minLength))yield b(O.StringMinLength,Z,Y,Q);if(Q1(Z.maxLength)&&!(Q.length<=Z.maxLength))yield b(O.StringMaxLength,Z,Y,Q);if(!new RegExp(Z.source,Z.flags).test(Q))return yield b(O.RegExp,Z,Y,Q)}function*eN(Z,$,Y,Q){if(!q1(Q))return yield b(O.String,Z,Y,Q);if(Q1(Z.minLength)&&!(Q.length>=Z.minLength))yield b(O.StringMinLength,Z,Y,Q);if(Q1(Z.maxLength)&&!(Q.length<=Z.maxLength))yield b(O.StringMaxLength,Z,Y,Q);if(q1(Z.pattern)){if(!new RegExp(Z.pattern).test(Q))yield b(O.StringPattern,Z,Y,Q)}if(q1(Z.format)){if(!F1.Has(Z.format))yield b(O.StringFormatUnknown,Z,Y,Q);else if(!F1.Get(Z.format)(Q))yield b(O.StringFormat,Z,Y,Q)}}function*ZL(Z,$,Y,Q){if(!X8(Q))yield b(O.Symbol,Z,Y,Q)}function*$L(Z,$,Y,Q){if(!q1(Q))return yield b(O.String,Z,Y,Q);if(!new RegExp(Z.pattern).test(Q))yield b(O.StringPattern,Z,Y,Q)}function*YL(Z,$,Y,Q){yield*X0(M1(Z,$),$,Y,Q)}function*QL(Z,$,Y,Q){if(!i(Q))return yield b(O.Tuple,Z,Y,Q);if(Z.items===void 0&&Q.length!==0)return yield b(O.TupleLength,Z,Y,Q);if(Q.length!==Z.maxItems)return yield b(O.TupleLength,Z,Y,Q);if(!Z.items)return;for(let X=0;X<Z.items.length;X++)yield*X0(Z.items[X],$,`${Y}/${X}`,Q[X])}function*XL(Z,$,Y,Q){if(!k1(Q))yield b(O.Undefined,Z,Y,Q)}function*WL(Z,$,Y,Q){if(e(Z,$,Q))return;let X=Z.anyOf.map((W)=>new w4(X0(W,$,Y,Q)));yield b(O.Union,Z,Y,Q,X)}function*JL(Z,$,Y,Q){if(!V4(Q))return yield b(O.Uint8Array,Z,Y,Q);if(Q1(Z.maxByteLength)&&!(Q.length<=Z.maxByteLength))yield b(O.Uint8ArrayMaxByteLength,Z,Y,Q);if(Q1(Z.minByteLength)&&!(Q.length>=Z.minByteLength))yield b(O.Uint8ArrayMinByteLength,Z,Y,Q)}function*zL(Z,$,Y,Q){}function*qL(Z,$,Y,Q){if(!I1.IsVoidLike(Q))yield b(O.Void,Z,Y,Q)}function*UL(Z,$,Y,Q){if(!r1.Get(Z[N])(Z,Q))yield b(O.Kind,Z,Y,Q)}function*X0(Z,$,Y,Q){let X=Q1(Z.$id)?[...$,Z]:$,W=Z;switch(W[N]){case"Any":return yield*IN(W,X,Y,Q);case"Argument":return yield*xN(W,X,Y,Q);case"Array":return yield*TN(W,X,Y,Q);case"AsyncIterator":return yield*bN(W,X,Y,Q);case"BigInt":return yield*kN(W,X,Y,Q);case"Boolean":return yield*gN(W,X,Y,Q);case"Constructor":return yield*fN(W,X,Y,Q);case"Date":return yield*yN(W,X,Y,Q);case"Function":return yield*vN(W,X,Y,Q);case"Import":return yield*dN(W,X,Y,Q);case"Integer":return yield*hN(W,X,Y,Q);case"Intersect":return yield*mN(W,X,Y,Q);case"Iterator":return yield*uN(W,X,Y,Q);case"Literal":return yield*pN(W,X,Y,Q);case"Never":return yield*cN(W,X,Y,Q);case"Not":return yield*iN(W,X,Y,Q);case"Null":return yield*lN(W,X,Y,Q);case"Number":return yield*nN(W,X,Y,Q);case"Object":return yield*oN(W,X,Y,Q);case"Promise":return yield*tN(W,X,Y,Q);case"Record":return yield*sN(W,X,Y,Q);case"Ref":return yield*rN(W,X,Y,Q);case"RegExp":return yield*aN(W,X,Y,Q);case"String":return yield*eN(W,X,Y,Q);case"Symbol":return yield*ZL(W,X,Y,Q);case"TemplateLiteral":return yield*$L(W,X,Y,Q);case"This":return yield*YL(W,X,Y,Q);case"Tuple":return yield*QL(W,X,Y,Q);case"Undefined":return yield*XL(W,X,Y,Q);case"Union":return yield*WL(W,X,Y,Q);case"Uint8Array":return yield*JL(W,X,Y,Q);case"Unknown":return yield*zL(W,X,Y,Q);case"Void":return yield*qL(W,X,Y,Q);default:if(!r1.Has(W[N]))throw new NW(Z);return yield*UL(W,X,Y,Q)}}function t6(...Z){let $=Z.length===3?X0(Z[0],Z[1],"",Z[2]):X0(Z[0],[],"",Z[1]);return new w4($)}class TZ extends p{constructor(Z,$,Y){super("Unable to decode value as it does not match the expected schema");this.schema=Z,this.value=$,this.error=Y}}class i$ extends p{constructor(Z,$,Y,Q){super(Q instanceof Error?Q.message:"Unknown error");this.schema=Z,this.path=$,this.value=Y,this.error=Q}}function d1(Z,$,Y){try{return S1(Z)?Z[C1].Decode(Y):Y}catch(Q){throw new i$(Z,$,Y,Q)}}function wL(Z,$,Y,Q){return i(Q)?d1(Z,Y,Q.map((X,W)=>I6(Z.items,$,`${Y}/${W}`,X))):d1(Z,Y,Q)}function ML(Z,$,Y,Q){if(!a(Q)||c0(Q))return d1(Z,Y,Q);let X=x$(Z),W=X.map((w)=>w[0]),J={...Q};for(let[w,M]of X)if(w in J)J[w]=I6(M,$,`${Y}/${w}`,J[w]);if(!S1(Z.unevaluatedProperties))return d1(Z,Y,J);let z=Object.getOwnPropertyNames(J),q=Z.unevaluatedProperties,U={...J};for(let w of z)if(!W.includes(w))U[w]=d1(q,`${Y}/${w}`,U[w]);return d1(Z,Y,U)}function GL(Z,$,Y,Q){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref],J=I6(W,[...$,...X],Y,Q);return d1(Z,Y,J)}function BL(Z,$,Y,Q){return d1(Z,Y,I6(Z.not,$,Y,Q))}function SL(Z,$,Y,Q){if(!a(Q))return d1(Z,Y,Q);let X=x0(Z),W={...Q};for(let U of X){if(!c(W,U))continue;if(k1(W[U])&&(!z8(Z.properties[U])||I1.IsExactOptionalProperty(W,U)))continue;W[U]=I6(Z.properties[U],$,`${Y}/${U}`,W[U])}if(!v1(Z.additionalProperties))return d1(Z,Y,W);let J=Object.getOwnPropertyNames(W),z=Z.additionalProperties,q={...W};for(let U of J)if(!X.includes(U))q[U]=d1(z,`${Y}/${U}`,q[U]);return d1(Z,Y,q)}function HL(Z,$,Y,Q){if(!a(Q))return d1(Z,Y,Q);let X=Object.getOwnPropertyNames(Z.patternProperties)[0],W=new RegExp(X),J={...Q};for(let w of Object.getOwnPropertyNames(Q))if(W.test(w))J[w]=I6(Z.patternProperties[X],$,`${Y}/${w}`,J[w]);if(!v1(Z.additionalProperties))return d1(Z,Y,J);let z=Object.getOwnPropertyNames(J),q=Z.additionalProperties,U={...J};for(let w of z)if(!W.test(w))U[w]=d1(q,`${Y}/${w}`,U[w]);return d1(Z,Y,U)}function DL(Z,$,Y,Q){let X=M1(Z,$);return d1(Z,Y,I6(X,$,Y,Q))}function AL(Z,$,Y,Q){let X=M1(Z,$);return d1(Z,Y,I6(X,$,Y,Q))}function NL(Z,$,Y,Q){return i(Q)&&i(Z.items)?d1(Z,Y,Z.items.map((X,W)=>I6(X,$,`${Y}/${W}`,Q[W]))):d1(Z,Y,Q)}function LL(Z,$,Y,Q){for(let X of Z.anyOf){if(!e(X,$,Q))continue;let W=I6(X,$,Y,Q);return d1(Z,Y,W)}return d1(Z,Y,Q)}function I6(Z,$,Y,Q){let X=Y0(Z,$),W=Z;switch(Z[N]){case"Array":return wL(W,X,Y,Q);case"Import":return GL(W,X,Y,Q);case"Intersect":return ML(W,X,Y,Q);case"Not":return BL(W,X,Y,Q);case"Object":return SL(W,X,Y,Q);case"Record":return HL(W,X,Y,Q);case"Ref":return DL(W,X,Y,Q);case"Symbol":return d1(W,Y,Q);case"This":return AL(W,X,Y,Q);case"Tuple":return NL(W,X,Y,Q);case"Union":return LL(W,X,Y,Q);default:return d1(W,Y,Q)}}function s4(Z,$,Y){return I6(Z,$,"",Y)}class bZ extends p{constructor(Z,$,Y){super("The encoded value does not match the expected schema");this.schema=Z,this.value=$,this.error=Y}}class LW extends p{constructor(Z,$,Y,Q){super(`${Q instanceof Error?Q.message:"Unknown error"}`);this.schema=Z,this.path=$,this.value=Y,this.error=Q}}function q0(Z,$,Y){try{return S1(Z)?Z[C1].Encode(Y):Y}catch(Q){throw new LW(Z,$,Y,Q)}}function OL(Z,$,Y,Q){let X=q0(Z,Y,Q);return i(X)?X.map((W,J)=>x6(Z.items,$,`${Y}/${J}`,W)):X}function FL(Z,$,Y,Q){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref],J=q0(Z,Y,Q);return x6(W,[...$,...X],Y,J)}function KL(Z,$,Y,Q){let X=q0(Z,Y,Q);if(!a(Q)||c0(Q))return X;let W=x$(Z),J=W.map((M)=>M[0]),z={...X};for(let[M,S]of W)if(M in z)z[M]=x6(S,$,`${Y}/${M}`,z[M]);if(!S1(Z.unevaluatedProperties))return z;let q=Object.getOwnPropertyNames(z),U=Z.unevaluatedProperties,w={...z};for(let M of q)if(!J.includes(M))w[M]=q0(U,`${Y}/${M}`,w[M]);return w}function PL(Z,$,Y,Q){return q0(Z.not,Y,q0(Z,Y,Q))}function jL(Z,$,Y,Q){let X=q0(Z,Y,Q);if(!a(X))return X;let W=x0(Z),J={...X};for(let w of W){if(!c(J,w))continue;if(k1(J[w])&&(!z8(Z.properties[w])||I1.IsExactOptionalProperty(J,w)))continue;J[w]=x6(Z.properties[w],$,`${Y}/${w}`,J[w])}if(!v1(Z.additionalProperties))return J;let z=Object.getOwnPropertyNames(J),q=Z.additionalProperties,U={...J};for(let w of z)if(!W.includes(w))U[w]=q0(q,`${Y}/${w}`,U[w]);return U}function RL(Z,$,Y,Q){let X=q0(Z,Y,Q);if(!a(Q))return X;let W=Object.getOwnPropertyNames(Z.patternProperties)[0],J=new RegExp(W),z={...X};for(let M of Object.getOwnPropertyNames(Q))if(J.test(M))z[M]=x6(Z.patternProperties[W],$,`${Y}/${M}`,z[M]);if(!v1(Z.additionalProperties))return z;let q=Object.getOwnPropertyNames(z),U=Z.additionalProperties,w={...z};for(let M of q)if(!J.test(M))w[M]=q0(U,`${Y}/${M}`,w[M]);return w}function _L(Z,$,Y,Q){let X=M1(Z,$),W=x6(X,$,Y,Q);return q0(Z,Y,W)}function CL(Z,$,Y,Q){let X=M1(Z,$),W=x6(X,$,Y,Q);return q0(Z,Y,W)}function VL(Z,$,Y,Q){let X=q0(Z,Y,Q);return i(Z.items)?Z.items.map((W,J)=>x6(W,$,`${Y}/${J}`,X[J])):[]}function EL(Z,$,Y,Q){for(let X of Z.anyOf){if(!e(X,$,Q))continue;let W=x6(X,$,Y,Q);return q0(Z,Y,W)}for(let X of Z.anyOf){let W=x6(X,$,Y,Q);if(!e(Z,$,W))continue;return q0(Z,Y,W)}return q0(Z,Y,Q)}function x6(Z,$,Y,Q){let X=Y0(Z,$),W=Z;switch(Z[N]){case"Array":return OL(W,X,Y,Q);case"Import":return FL(W,X,Y,Q);case"Intersect":return KL(W,X,Y,Q);case"Not":return PL(W,X,Y,Q);case"Object":return jL(W,X,Y,Q);case"Record":return RL(W,X,Y,Q);case"Ref":return _L(W,X,Y,Q);case"This":return CL(W,X,Y,Q);case"Tuple":return VL(W,X,Y,Q);case"Union":return EL(W,X,Y,Q);default:return q0(W,Y,Q)}}function r4(Z,$,Y){return x6(Z,$,"",Y)}function IL(Z,$){return S1(Z)||Z0(Z.items,$)}function xL(Z,$){return S1(Z)||Z0(Z.items,$)}function TL(Z,$){return S1(Z)||Z0(Z.returns,$)||Z.parameters.some((Y)=>Z0(Y,$))}function bL(Z,$){return S1(Z)||Z0(Z.returns,$)||Z.parameters.some((Y)=>Z0(Y,$))}function kL(Z,$){return S1(Z)||S1(Z.unevaluatedProperties)||Z.allOf.some((Y)=>Z0(Y,$))}function gL(Z,$){let Y=globalThis.Object.getOwnPropertyNames(Z.$defs).reduce((X,W)=>[...X,Z.$defs[W]],[]),Q=Z.$defs[Z.$ref];return S1(Z)||Z0(Q,[...Y,...$])}function fL(Z,$){return S1(Z)||Z0(Z.items,$)}function yL(Z,$){return S1(Z)||Z0(Z.not,$)}function vL(Z,$){return S1(Z)||Object.values(Z.properties).some((Y)=>Z0(Y,$))||v1(Z.additionalProperties)&&Z0(Z.additionalProperties,$)}function dL(Z,$){return S1(Z)||Z0(Z.item,$)}function hL(Z,$){let Y=Object.getOwnPropertyNames(Z.patternProperties)[0],Q=Z.patternProperties[Y];return S1(Z)||Z0(Q,$)||v1(Z.additionalProperties)&&S1(Z.additionalProperties)}function mL(Z,$){if(S1(Z))return!0;return Z0(M1(Z,$),$)}function uL(Z,$){if(S1(Z))return!0;return Z0(M1(Z,$),$)}function pL(Z,$){return S1(Z)||!k1(Z.items)&&Z.items.some((Y)=>Z0(Y,$))}function cL(Z,$){return S1(Z)||Z.anyOf.some((Y)=>Z0(Y,$))}function Z0(Z,$){let Y=Y0(Z,$),Q=Z;if(Z.$id&&mY.has(Z.$id))return!1;if(Z.$id)mY.add(Z.$id);switch(Z[N]){case"Array":return IL(Q,Y);case"AsyncIterator":return xL(Q,Y);case"Constructor":return TL(Q,Y);case"Function":return bL(Q,Y);case"Import":return gL(Q,Y);case"Intersect":return kL(Q,Y);case"Iterator":return fL(Q,Y);case"Not":return yL(Q,Y);case"Object":return vL(Q,Y);case"Promise":return dL(Q,Y);case"Record":return hL(Q,Y);case"Ref":return mL(Q,Y);case"This":return uL(Q,Y);case"Tuple":return pL(Q,Y);case"Union":return cL(Q,Y);default:return S1(Z)}}var mY=new Set;function B8(Z,$){return mY.clear(),Z0(Z,$)}class OW{constructor(Z,$,Y,Q){this.schema=Z,this.references=$,this.checkFunc=Y,this.code=Q,this.hasTransform=B8(Z,$)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(Z){return t6(this.schema,this.references,Z)}Check(Z){return this.checkFunc(Z)}Decode(Z){if(!this.checkFunc(Z))throw new TZ(this.schema,Z,this.Errors(Z).First());return this.hasTransform?s4(this.schema,this.references,Z):Z}Encode(Z){let $=this.hasTransform?r4(this.schema,this.references,Z):Z;if(!this.checkFunc($))throw new bZ(this.schema,Z,this.Errors(Z).First());return $}}var S8;(function(Z){function $(W){return W===36}Z.DollarSign=$;function Y(W){return W===95}Z.IsUnderscore=Y;function Q(W){return W>=65&&W<=90||W>=97&&W<=122}Z.IsAlpha=Q;function X(W){return W>=48&&W<=57}Z.IsNumeric=X})(S8||(S8={}));var l$;(function(Z){function $(W){if(W.length===0)return!1;return S8.IsNumeric(W.charCodeAt(0))}function Y(W){if($(W))return!1;for(let J=0;J<W.length;J++){let z=W.charCodeAt(J);if(!(S8.IsAlpha(z)||S8.IsNumeric(z)||S8.DollarSign(z)||S8.IsUnderscore(z)))return!1}return!0}function Q(W){return W.replace(/'/g,"\\'")}function X(W,J){return Y(J)?`${W}.${J}`:`${W}['${Q(J)}']`}Z.Encode=X})(l$||(l$={}));var uY;(function(Z){function $(Y){let Q=[];for(let X=0;X<Y.length;X++){let W=Y.charCodeAt(X);if(S8.IsNumeric(W)||S8.IsAlpha(W))Q.push(Y.charAt(X));else Q.push(`_${W}_`)}return Q.join("").replace(/__/g,"_")}Z.Encode=$})(uY||(uY={}));var pY;(function(Z){function $(Y){return Y.replace(/'/g,"\\'")}Z.Escape=$})(pY||(pY={}));class FW extends p{constructor(Z){super("Unknown type");this.schema=Z}}class cY extends p{constructor(Z){super("Preflight validation check failed to guard for the given schema");this.schema=Z}}var M4;(function(Z){function $(J,z,q){return I1.ExactOptionalPropertyTypes?`('${z}' in ${J} ? ${q} : true)`:`(${l$.Encode(J,z)} !== undefined ? ${q} : true)`}Z.IsExactOptionalProperty=$;function Y(J){return!I1.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}))`:`(typeof ${J} === 'object' && ${J} !== null)`}Z.IsObjectLike=Y;function Q(J){return!I1.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}) && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`:`(typeof ${J} === 'object' && ${J} !== null && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`}Z.IsRecordLike=Q;function X(J){return I1.AllowNaN?`typeof ${J} === 'number'`:`Number.isFinite(${J})`}Z.IsNumberLike=X;function W(J){return I1.AllowNullVoid?`(${J} === undefined || ${J} === null)`:`${J} === undefined`}Z.IsVoidLike=W})(M4||(M4={}));var k8;(function(Z){function $(H){return H[N]==="Any"||H[N]==="Unknown"}function*Y(H,C,A){yield"true"}function*Q(H,C,A){yield"true"}function*X(H,C,A){yield`Array.isArray(${A})`;let[d,T]=[E("value","any"),E("acc","number")];if(u(H.maxItems))yield`${A}.length <= ${H.maxItems}`;if(u(H.minItems))yield`${A}.length >= ${H.minItems}`;let h=u0(H.items,C,"value");if(yield`${A}.every((${d}) => ${h})`,f1(H.contains)||u(H.minContains)||u(H.maxContains)){let R1=f1(H.contains)?H.contains:r(),C0=u0(R1,C,"value"),Z8=u(H.minContains)?[`(count >= ${H.minContains})`]:[],L6=u(H.maxContains)?[`(count <= ${H.maxContains})`]:[],p6=`const count = value.reduce((${T}, ${d}) => ${C0} ? acc + 1 : acc, 0)`,H$=["(count > 0)",...Z8,...L6].join(" && ");yield`((${d}) => { ${p6}; return ${H$}})(${A})`}if(H.uniqueItems===!0)yield`((${d}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${A})`}function*W(H,C,A){yield`(typeof value === 'object' && Symbol.asyncIterator in ${A})`}function*J(H,C,A){if(yield`(typeof ${A} === 'bigint')`,J0(H.exclusiveMaximum))yield`${A} < BigInt(${H.exclusiveMaximum})`;if(J0(H.exclusiveMinimum))yield`${A} > BigInt(${H.exclusiveMinimum})`;if(J0(H.maximum))yield`${A} <= BigInt(${H.maximum})`;if(J0(H.minimum))yield`${A} >= BigInt(${H.minimum})`;if(J0(H.multipleOf))yield`(${A} % BigInt(${H.multipleOf})) === 0`}function*z(H,C,A){yield`(typeof ${A} === 'boolean')`}function*q(H,C,A){yield*A6(H.returns,C,`${A}.prototype`)}function*U(H,C,A){if(yield`(${A} instanceof Date) && Number.isFinite(${A}.getTime())`,u(H.exclusiveMaximumTimestamp))yield`${A}.getTime() < ${H.exclusiveMaximumTimestamp}`;if(u(H.exclusiveMinimumTimestamp))yield`${A}.getTime() > ${H.exclusiveMinimumTimestamp}`;if(u(H.maximumTimestamp))yield`${A}.getTime() <= ${H.maximumTimestamp}`;if(u(H.minimumTimestamp))yield`${A}.getTime() >= ${H.minimumTimestamp}`;if(u(H.multipleOfTimestamp))yield`(${A}.getTime() % ${H.multipleOfTimestamp}) === 0`}function*w(H,C,A){yield`(typeof ${A} === 'function')`}function*M(H,C,A){let d=globalThis.Object.getOwnPropertyNames(H.$defs).reduce((T,h)=>{return[...T,H.$defs[h]]},[]);yield*A6(J6(H.$ref),[...C,...d],A)}function*S(H,C,A){if(yield`Number.isInteger(${A})`,u(H.exclusiveMaximum))yield`${A} < ${H.exclusiveMaximum}`;if(u(H.exclusiveMinimum))yield`${A} > ${H.exclusiveMinimum}`;if(u(H.maximum))yield`${A} <= ${H.maximum}`;if(u(H.minimum))yield`${A} >= ${H.minimum}`;if(u(H.multipleOf))yield`(${A} % ${H.multipleOf}) === 0`}function*G(H,C,A){let d=H.allOf.map((T)=>u0(T,C,A)).join(" && ");if(H.unevaluatedProperties===!1){let T=P8(`${new RegExp(w8(H))};`),h=`Object.getOwnPropertyNames(${A}).every(key => ${T}.test(key))`;yield`(${d} && ${h})`}else if(f1(H.unevaluatedProperties)){let T=P8(`${new RegExp(w8(H))};`),h=`Object.getOwnPropertyNames(${A}).every(key => ${T}.test(key) || ${u0(H.unevaluatedProperties,C,`${A}[key]`)})`;yield`(${d} && ${h})`}else yield`(${d})`}function*L(H,C,A){yield`(typeof value === 'object' && Symbol.iterator in ${A})`}function*B(H,C,A){if(typeof H.const==="number"||typeof H.const==="boolean")yield`(${A} === ${H.const})`;else yield`(${A} === '${pY.Escape(H.const)}')`}function*P(H,C,A){yield"false"}function*I(H,C,A){yield`(!${u0(H.not,C,A)})`}function*n(H,C,A){yield`(${A} === null)`}function*s(H,C,A){if(yield M4.IsNumberLike(A),u(H.exclusiveMaximum))yield`${A} < ${H.exclusiveMaximum}`;if(u(H.exclusiveMinimum))yield`${A} > ${H.exclusiveMinimum}`;if(u(H.maximum))yield`${A} <= ${H.maximum}`;if(u(H.minimum))yield`${A} >= ${H.minimum}`;if(u(H.multipleOf))yield`(${A} % ${H.multipleOf}) === 0`}function*A1(H,C,A){if(yield M4.IsObjectLike(A),u(H.minProperties))yield`Object.getOwnPropertyNames(${A}).length >= ${H.minProperties}`;if(u(H.maxProperties))yield`Object.getOwnPropertyNames(${A}).length <= ${H.maxProperties}`;let d=Object.getOwnPropertyNames(H.properties);for(let T of d){let h=l$.Encode(A,T),R1=H.properties[T];if(H.required&&H.required.includes(T)){if(yield*A6(R1,C,h),M8(R1)||$(R1))yield`('${T}' in ${A})`}else{let C0=u0(R1,C,h);yield M4.IsExactOptionalProperty(A,T,C0)}}if(H.additionalProperties===!1)if(H.required&&H.required.length===d.length)yield`Object.getOwnPropertyNames(${A}).length === ${d.length}`;else{let T=`[${d.map((h)=>`'${h}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${A}).every(key => ${T}.includes(key))`}if(typeof H.additionalProperties==="object"){let T=u0(H.additionalProperties,C,`${A}[key]`),h=`[${d.map((R1)=>`'${R1}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${A}).every(key => ${h}.includes(key) || ${T}))`}}function*E1(H,C,A){yield`${A} instanceof Promise`}function*v(H,C,A){if(yield M4.IsRecordLike(A),u(H.minProperties))yield`Object.getOwnPropertyNames(${A}).length >= ${H.minProperties}`;if(u(H.maxProperties))yield`Object.getOwnPropertyNames(${A}).length <= ${H.maxProperties}`;let[d,T]=Object.entries(H.patternProperties)[0],h=P8(`${new RegExp(d)}`),R1=u0(T,C,"value"),C0=f1(H.additionalProperties)?u0(H.additionalProperties,C,A):H.additionalProperties===!1?"false":"true",Z8=`(${h}.test(key) ? ${R1} : ${C0})`;yield`(Object.entries(${A}).every(([key, value]) => ${Z8}))`}function*k(H,C,A){let d=M1(H,C);if(O1.functions.has(H.$ref))return yield`${K8(H.$ref)}(${A})`;yield*A6(d,C,A)}function*g(H,C,A){let d=P8(`${new RegExp(H.source,H.flags)};`);if(yield`(typeof ${A} === 'string')`,u(H.maxLength))yield`${A}.length <= ${H.maxLength}`;if(u(H.minLength))yield`${A}.length >= ${H.minLength}`;yield`${d}.test(${A})`}function*V(H,C,A){if(yield`(typeof ${A} === 'string')`,u(H.maxLength))yield`${A}.length <= ${H.maxLength}`;if(u(H.minLength))yield`${A}.length >= ${H.minLength}`;if(H.pattern!==void 0)yield`${P8(`${new RegExp(H.pattern)};`)}.test(${A})`;if(H.format!==void 0)yield`format('${H.format}', ${A})`}function*X1(H,C,A){yield`(typeof ${A} === 'symbol')`}function*N1(H,C,A){yield`(typeof ${A} === 'string')`,yield`${P8(`${new RegExp(H.pattern)};`)}.test(${A})`}function*L1(H,C,A){yield`${K8(H.$ref)}(${A})`}function*h1(H,C,A){if(yield`Array.isArray(${A})`,H.items===void 0)return yield`${A}.length === 0`;yield`(${A}.length === ${H.maxItems})`;for(let d=0;d<H.items.length;d++)yield`${u0(H.items[d],C,`${A}[${d}]`)}`}function*O8(H,C,A){yield`${A} === undefined`}function*l1(H,C,A){yield`(${H.anyOf.map((T)=>u0(T,C,A)).join(" || ")})`}function*F8(H,C,A){if(yield`${A} instanceof Uint8Array`,u(H.maxByteLength))yield`(${A}.length <= ${H.maxByteLength})`;if(u(H.minByteLength))yield`(${A}.length >= ${H.minByteLength})`}function*m0(H,C,A){yield"true"}function*a8(H,C,A){yield M4.IsVoidLike(A)}function*wY(H,C,A){let d=O1.instances.size;O1.instances.set(d,H),yield`kind('${H[N]}', ${d}, ${A})`}function*A6(H,C,A,d=!0){let T=q1(H.$id)?[...C,H]:C,h=H;if(d&&q1(H.$id)){let R1=K8(H.$id);if(O1.functions.has(R1))return yield`${R1}(${A})`;else{O1.functions.set(R1,"<deferred>");let C0=N6(R1,H,C,"value",!1);return O1.functions.set(R1,C0),yield`${R1}(${A})`}}switch(h[N]){case"Any":return yield*Y(h,T,A);case"Argument":return yield*Q(h,T,A);case"Array":return yield*X(h,T,A);case"AsyncIterator":return yield*W(h,T,A);case"BigInt":return yield*J(h,T,A);case"Boolean":return yield*z(h,T,A);case"Constructor":return yield*q(h,T,A);case"Date":return yield*U(h,T,A);case"Function":return yield*w(h,T,A);case"Import":return yield*M(h,T,A);case"Integer":return yield*S(h,T,A);case"Intersect":return yield*G(h,T,A);case"Iterator":return yield*L(h,T,A);case"Literal":return yield*B(h,T,A);case"Never":return yield*P(h,T,A);case"Not":return yield*I(h,T,A);case"Null":return yield*n(h,T,A);case"Number":return yield*s(h,T,A);case"Object":return yield*A1(h,T,A);case"Promise":return yield*E1(h,T,A);case"Record":return yield*v(h,T,A);case"Ref":return yield*k(h,T,A);case"RegExp":return yield*g(h,T,A);case"String":return yield*V(h,T,A);case"Symbol":return yield*X1(h,T,A);case"TemplateLiteral":return yield*N1(h,T,A);case"This":return yield*L1(h,T,A);case"Tuple":return yield*h1(h,T,A);case"Undefined":return yield*O8(h,T,A);case"Union":return yield*l1(h,T,A);case"Uint8Array":return yield*F8(h,T,A);case"Unknown":return yield*m0(h,T,A);case"Void":return yield*a8(h,T,A);default:if(!r1.Has(h[N]))throw new FW(H);return yield*wY(h,T,A)}}let O1={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function u0(H,C,A,d=!0){return`(${[...A6(H,C,A,d)].join(" && ")})`}function K8(H){return`check_${uY.Encode(H)}`}function P8(H){let C=`local_${O1.variables.size}`;return O1.variables.set(C,`const ${C} = ${H}`),C}function N6(H,C,A,d,T=!0){let[h,R1]=[`
`,(p6)=>"".padStart(p6," ")],C0=E("value","any"),Z8=R("boolean"),L6=[...A6(C,A,d,T)].map((p6)=>`${R1(4)}${p6}`).join(` &&${h}`);return`function ${H}(${C0})${Z8} {${h}${R1(2)}return (${h}${L6}${h}${R1(2)})
}`}function E(H,C){let A=O1.language==="typescript"?`: ${C}`:"";return`${H}${A}`}function R(H){return O1.language==="typescript"?`: ${H}`:""}function _(H,C,A){let d=N6("check",H,C,"value"),T=E("value","any"),h=R("boolean"),R1=[...O1.functions.values()],C0=[...O1.variables.values()],Z8=q1(H.$id)?`return function check(${T})${h} {
  return ${K8(H.$id)}(value)
}`:`return ${d}`;return[...C0,...R1,Z8].join(`
`)}function m(...H){let C={language:"javascript"},[A,d,T]=H.length===2&&i(H[1])?[H[0],H[1],C]:H.length===2&&!i(H[1])?[H[0],[],H[1]]:H.length===3?[H[0],H[1],H[2]]:H.length===1?[H[0],[],C]:[null,[],C];if(O1.language=T.language,O1.variables.clear(),O1.functions.clear(),O1.instances.clear(),!f1(A))throw new cY(A);for(let h of d)if(!f1(h))throw new cY(h);return _(A,d,T)}Z.Code=m;function l(H,C=[]){let A=m(H,C,{language:"javascript"}),d=globalThis.Function("kind","format","hash",A),T=new Map(O1.instances);function h(L6,p6,H$){if(!r1.Has(L6)||!T.has(p6))return!1;let kG=r1.Get(L6),gG=T.get(p6);return kG(gG,H$)}function R1(L6,p6){if(!F1.Has(L6))return!1;return F1.Get(L6)(p6)}function C0(L6){return b8(L6)}let Z8=d(h,R1,C0);return new OW(H,C,Z8,A)}Z.Compile=l})(k8||(k8={}));var iL=function(Z,$,Y,Q,X){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!X)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!X:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?X.call(Z,Y):X?X.value=Y:$.set(Z,Y),Y},PW=function(Z,$,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Q:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call(Z):Q?Q.value:$.get(Z)},iY,n$,jW;class RW extends p{constructor(Z){let $=Z.First();super($===void 0?"Invalid Value":$.message);iY.add(this),n$.set(this,void 0),iL(this,n$,Z,"f"),this.error=$}Errors(){return new w4(PW(this,iY,"m",jW).call(this))}}n$=new WeakMap,iY=new WeakSet,jW=function*Z(){if(this.error)yield this.error;yield*PW(this,n$,"f")};function KW(Z,$,Y){if(e(Z,$,Y))return;throw new RW(t6(Z,$,Y))}function o$(...Z){return Z.length===3?KW(Z[0],Z[1],Z[2]):KW(Z[0],[],Z[1])}function lL(Z){let $={};for(let Y of Object.getOwnPropertyNames(Z))$[Y]=G1(Z[Y]);for(let Y of Object.getOwnPropertySymbols(Z))$[Y]=G1(Z[Y]);return $}function nL(Z){return Z.map(($)=>G1($))}function oL(Z){return Z.slice()}function tL(Z){return new Map(G1([...Z.entries()]))}function sL(Z){return new Set(G1([...Z.entries()]))}function rL(Z){return new Date(Z.toISOString())}function aL(Z){return Z}function G1(Z){if(i(Z))return nL(Z);if(O0(Z))return rL(Z);if($6(Z))return oL(Z);if(pQ(Z))return tL(Z);if(cQ(Z))return sL(Z);if(a(Z))return lL(Z);if(c0(Z))return aL(Z);throw new Error("ValueClone: Unable to clone value")}class U6 extends p{constructor(Z,$){super($);this.schema=Z}}function B1(Z){return j8(Z)?Z():G1(Z)}function eL(Z,$){if(c(Z,"default"))return B1(Z.default);else return{}}function ZO(Z,$){return{}}function $O(Z,$){if(Z.uniqueItems===!0&&!c(Z,"default"))throw new U6(Z,"Array with the uniqueItems constraint requires a default value");else if("contains"in Z&&!c(Z,"default"))throw new U6(Z,"Array with the contains constraint requires a default value");else if("default"in Z)return B1(Z.default);else if(Z.minItems!==void 0)return Array.from({length:Z.minItems}).map((Y)=>{return b0(Z.items,$)});else return[]}function YO(Z,$){if(c(Z,"default"))return B1(Z.default);else return async function*(){}()}function QO(Z,$){if(c(Z,"default"))return B1(Z.default);else return BigInt(0)}function XO(Z,$){if(c(Z,"default"))return B1(Z.default);else return!1}function WO(Z,$){if(c(Z,"default"))return B1(Z.default);else{let Y=b0(Z.returns,$);if(typeof Y==="object"&&!Array.isArray(Y))return class{constructor(){for(let[Q,X]of Object.entries(Y)){let W=this;W[Q]=X}}};else return class{}}}function JO(Z,$){if(c(Z,"default"))return B1(Z.default);else if(Z.minimumTimestamp!==void 0)return new Date(Z.minimumTimestamp);else return new Date}function zO(Z,$){if(c(Z,"default"))return B1(Z.default);else return()=>b0(Z.returns,$)}function qO(Z,$){let Y=globalThis.Object.values(Z.$defs),Q=Z.$defs[Z.$ref];return b0(Q,[...$,...Y])}function UO(Z,$){if(c(Z,"default"))return B1(Z.default);else if(Z.minimum!==void 0)return Z.minimum;else return 0}function wO(Z,$){if(c(Z,"default"))return B1(Z.default);else{let Y=Z.allOf.reduce((Q,X)=>{let W=b0(X,$);return typeof W==="object"?{...Q,...W}:W},{});if(!e(Z,$,Y))throw new U6(Z,"Intersect produced invalid value. Consider using a default value.");return Y}}function MO(Z,$){if(c(Z,"default"))return B1(Z.default);else return function*(){}()}function GO(Z,$){if(c(Z,"default"))return B1(Z.default);else return Z.const}function BO(Z,$){if(c(Z,"default"))return B1(Z.default);else throw new U6(Z,"Never types cannot be created. Consider using a default value.")}function SO(Z,$){if(c(Z,"default"))return B1(Z.default);else throw new U6(Z,"Not types must have a default value")}function HO(Z,$){if(c(Z,"default"))return B1(Z.default);else return null}function DO(Z,$){if(c(Z,"default"))return B1(Z.default);else if(Z.minimum!==void 0)return Z.minimum;else return 0}function AO(Z,$){if(c(Z,"default"))return B1(Z.default);else{let Y=new Set(Z.required),Q={};for(let[X,W]of Object.entries(Z.properties)){if(!Y.has(X))continue;Q[X]=b0(W,$)}return Q}}function NO(Z,$){if(c(Z,"default"))return B1(Z.default);else return Promise.resolve(b0(Z.item,$))}function LO(Z,$){let[Y,Q]=Object.entries(Z.patternProperties)[0];if(c(Z,"default"))return B1(Z.default);else if(!(Y===l6||Y===i6)){let X=Y.slice(1,Y.length-1).split("|"),W={};for(let J of X)W[J]=b0(Q,$);return W}else return{}}function OO(Z,$){if(c(Z,"default"))return B1(Z.default);else return b0(M1(Z,$),$)}function FO(Z,$){if(c(Z,"default"))return B1(Z.default);else throw new U6(Z,"RegExp types cannot be created. Consider using a default value.")}function KO(Z,$){if(Z.pattern!==void 0)if(!c(Z,"default"))throw new U6(Z,"String types with patterns must specify a default value");else return B1(Z.default);else if(Z.format!==void 0)if(!c(Z,"default"))throw new U6(Z,"String types with formats must specify a default value");else return B1(Z.default);else if(c(Z,"default"))return B1(Z.default);else if(Z.minLength!==void 0)return Array.from({length:Z.minLength}).map(()=>" ").join("");else return""}function PO(Z,$){if(c(Z,"default"))return B1(Z.default);else if("value"in Z)return Symbol.for(Z.value);else return Symbol()}function jO(Z,$){if(c(Z,"default"))return B1(Z.default);if(!_$(Z))throw new U6(Z,"Can only create template literals that produce a finite variants. Consider using a default value.");return y4(Z)[0]}function RO(Z,$){if(_W++>bO)throw new U6(Z,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(c(Z,"default"))return B1(Z.default);else return b0(M1(Z,$),$)}function _O(Z,$){if(c(Z,"default"))return B1(Z.default);if(Z.items===void 0)return[];else return Array.from({length:Z.minItems}).map((Y,Q)=>b0(Z.items[Q],$))}function CO(Z,$){if(c(Z,"default"))return B1(Z.default);else return}function VO(Z,$){if(c(Z,"default"))return B1(Z.default);else if(Z.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return b0(Z.anyOf[0],$)}function EO(Z,$){if(c(Z,"default"))return B1(Z.default);else if(Z.minByteLength!==void 0)return new Uint8Array(Z.minByteLength);else return new Uint8Array(0)}function IO(Z,$){if(c(Z,"default"))return B1(Z.default);else return{}}function xO(Z,$){if(c(Z,"default"))return B1(Z.default);else return}function TO(Z,$){if(c(Z,"default"))return B1(Z.default);else throw new Error("User defined types must specify a default value")}function b0(Z,$){let Y=Y0(Z,$),Q=Z;switch(Q[N]){case"Any":return eL(Q,Y);case"Argument":return ZO(Q,Y);case"Array":return $O(Q,Y);case"AsyncIterator":return YO(Q,Y);case"BigInt":return QO(Q,Y);case"Boolean":return XO(Q,Y);case"Constructor":return WO(Q,Y);case"Date":return JO(Q,Y);case"Function":return zO(Q,Y);case"Import":return qO(Q,Y);case"Integer":return UO(Q,Y);case"Intersect":return wO(Q,Y);case"Iterator":return MO(Q,Y);case"Literal":return GO(Q,Y);case"Never":return BO(Q,Y);case"Not":return SO(Q,Y);case"Null":return HO(Q,Y);case"Number":return DO(Q,Y);case"Object":return AO(Q,Y);case"Promise":return NO(Q,Y);case"Record":return LO(Q,Y);case"Ref":return OO(Q,Y);case"RegExp":return FO(Q,Y);case"String":return KO(Q,Y);case"Symbol":return PO(Q,Y);case"TemplateLiteral":return jO(Q,Y);case"This":return RO(Q,Y);case"Tuple":return _O(Q,Y);case"Undefined":return CO(Q,Y);case"Union":return VO(Q,Y);case"Uint8Array":return EO(Q,Y);case"Unknown":return IO(Q,Y);case"Void":return xO(Q,Y);default:if(!r1.Has(Q[N]))throw new U6(Q,"Unknown type");return TO(Q,Y)}}var bO=512,_W=0;function w6(...Z){return _W=0,Z.length===2?b0(Z[0],Z[1]):b0(Z[0],[])}class lY extends p{constructor(Z,$){super($);this.schema=Z}}function kO(Z,$,Y){if(Z[N]==="Object"&&typeof Y==="object"&&!Q8(Y)){let Q=Z,X=Object.getOwnPropertyNames(Y),W=Object.entries(Q.properties),[J,z]=[1/W.length,W.length];return W.reduce((q,[U,w])=>{let M=w[N]==="Literal"&&w.const===Y[U]?z:0,S=e(w,$,Y[U])?J:0,G=X.includes(U)?J:0;return q+(M+S+G)},0)}else return e(Z,$,Y)?1:0}function gO(Z,$,Y){let Q=Z.anyOf.map((J)=>M1(J,$)),[X,W]=[Q[0],0];for(let J of Q){let z=kO(J,$,Y);if(z>W)X=J,W=z}return X}function fO(Z,$,Y){if("default"in Z)return typeof Y==="function"?Z.default:G1(Z.default);else{let Q=gO(Z,$,Y);return kZ(Q,$,Y)}}function yO(Z,$,Y){return e(Z,$,Y)?G1(Y):w6(Z,$)}function vO(Z,$,Y){return e(Z,$,Y)?Y:w6(Z,$)}function dO(Z,$,Y){if(e(Z,$,Y))return G1(Y);let Q=i(Y)?G1(Y):w6(Z,$),X=u(Z.minItems)&&Q.length<Z.minItems?[...Q,...Array.from({length:Z.minItems-Q.length},()=>null)]:Q,J=(u(Z.maxItems)&&X.length>Z.maxItems?X.slice(0,Z.maxItems):X).map((q)=>T6(Z.items,$,q));if(Z.uniqueItems!==!0)return J;let z=[...new Set(J)];if(!e(Z,$,z))throw new lY(Z,"Array cast produced invalid data due to uniqueItems constraint");return z}function hO(Z,$,Y){if(e(Z,$,Y))return w6(Z,$);let Q=new Set(Z.returns.required||[]),X=function(){};for(let[W,J]of Object.entries(Z.returns.properties)){if(!Q.has(W)&&Y.prototype[W]===void 0)continue;X.prototype[W]=T6(J,$,Y.prototype[W])}return X}function mO(Z,$,Y){let Q=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];return T6(X,[...$,...Q],Y)}function uO(Z,$,Y){let Q=w6(Z,$),X=a(Q)&&a(Y)?{...Q,...Y}:Y;return e(Z,$,X)?X:w6(Z,$)}function pO(Z,$,Y){throw new lY(Z,"Never types cannot be cast")}function cO(Z,$,Y){if(e(Z,$,Y))return Y;if(Y===null||typeof Y!=="object")return w6(Z,$);let Q=new Set(Z.required||[]),X={};for(let[W,J]of Object.entries(Z.properties)){if(!Q.has(W)&&Y[W]===void 0)continue;X[W]=T6(J,$,Y[W])}if(typeof Z.additionalProperties==="object"){let W=Object.getOwnPropertyNames(Z.properties);for(let J of Object.getOwnPropertyNames(Y)){if(W.includes(J))continue;X[J]=T6(Z.additionalProperties,$,Y[J])}}return X}function iO(Z,$,Y){if(e(Z,$,Y))return G1(Y);if(Y===null||typeof Y!=="object"||Array.isArray(Y)||Y instanceof Date)return w6(Z,$);let Q=Object.getOwnPropertyNames(Z.patternProperties)[0],X=Z.patternProperties[Q],W={};for(let[J,z]of Object.entries(Y))W[J]=T6(X,$,z);return W}function lO(Z,$,Y){return T6(M1(Z,$),$,Y)}function nO(Z,$,Y){return T6(M1(Z,$),$,Y)}function oO(Z,$,Y){if(e(Z,$,Y))return G1(Y);if(!i(Y))return w6(Z,$);if(Z.items===void 0)return[];return Z.items.map((Q,X)=>T6(Q,$,Y[X]))}function tO(Z,$,Y){return e(Z,$,Y)?G1(Y):fO(Z,$,Y)}function T6(Z,$,Y){let Q=q1(Z.$id)?Y0(Z,$):$,X=Z;switch(Z[N]){case"Array":return dO(X,Q,Y);case"Constructor":return hO(X,Q,Y);case"Import":return mO(X,Q,Y);case"Intersect":return uO(X,Q,Y);case"Never":return pO(X,Q,Y);case"Object":return cO(X,Q,Y);case"Record":return iO(X,Q,Y);case"Ref":return lO(X,Q,Y);case"This":return nO(X,Q,Y);case"Tuple":return oO(X,Q,Y);case"Union":return tO(X,Q,Y);case"Date":case"Symbol":case"Uint8Array":return yO(Z,$,Y);default:return vO(X,Q,Y)}}function kZ(...Z){return Z.length===3?T6(Z[0],Z[1],Z[2]):T6(Z[0],[],Z[1])}function sO(Z){return _8(Z)&&Z[N]!=="Unsafe"}function rO(Z,$,Y){if(!i(Y))return Y;return Y.map((Q)=>k0(Z.items,$,Q))}function aO(Z,$,Y){let Q=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];return k0(X,[...$,...Q],Y)}function eO(Z,$,Y){let Q=Z.unevaluatedProperties,W=Z.allOf.map((z)=>k0(z,$,G1(Y))).reduce((z,q)=>a(q)?{...z,...q}:q,{});if(!a(Y)||!a(W)||!_8(Q))return W;let J=x0(Z);for(let z of Object.getOwnPropertyNames(Y)){if(J.includes(z))continue;if(e(Q,$,Y[z]))W[z]=k0(Q,$,Y[z])}return W}function ZF(Z,$,Y){if(!a(Y)||i(Y))return Y;let Q=Z.additionalProperties;for(let X of Object.getOwnPropertyNames(Y)){if(c(Z.properties,X)){Y[X]=k0(Z.properties[X],$,Y[X]);continue}if(_8(Q)&&e(Q,$,Y[X])){Y[X]=k0(Q,$,Y[X]);continue}delete Y[X]}return Y}function $F(Z,$,Y){if(!a(Y))return Y;let Q=Z.additionalProperties,X=Object.getOwnPropertyNames(Y),[W,J]=Object.entries(Z.patternProperties)[0],z=new RegExp(W);for(let q of X){if(z.test(q)){Y[q]=k0(J,$,Y[q]);continue}if(_8(Q)&&e(Q,$,Y[q])){Y[q]=k0(Q,$,Y[q]);continue}delete Y[q]}return Y}function YF(Z,$,Y){return k0(M1(Z,$),$,Y)}function QF(Z,$,Y){return k0(M1(Z,$),$,Y)}function XF(Z,$,Y){if(!i(Y))return Y;if(k1(Z.items))return[];let Q=Math.min(Y.length,Z.items.length);for(let X=0;X<Q;X++)Y[X]=k0(Z.items[X],$,Y[X]);return Y.length>Q?Y.slice(0,Q):Y}function WF(Z,$,Y){for(let Q of Z.anyOf)if(sO(Q)&&e(Q,$,Y))return k0(Q,$,Y);return Y}function k0(Z,$,Y){let Q=q1(Z.$id)?Y0(Z,$):$,X=Z;switch(X[N]){case"Array":return rO(X,Q,Y);case"Import":return aO(X,Q,Y);case"Intersect":return eO(X,Q,Y);case"Object":return ZF(X,Q,Y);case"Record":return $F(X,Q,Y);case"Ref":return YF(X,Q,Y);case"This":return QF(X,Q,Y);case"Tuple":return XF(X,Q,Y);case"Union":return WF(X,Q,Y);default:return Y}}function t$(...Z){return Z.length===3?k0(Z[0],Z[1],Z[2]):k0(Z[0],[],Z[1])}function s$(Z){return q1(Z)&&!isNaN(Z)&&!isNaN(parseFloat(Z))}function JF(Z){return J0(Z)||c6(Z)||u(Z)}function gZ(Z){return Z===!0||u(Z)&&Z===1||J0(Z)&&Z===BigInt("1")||q1(Z)&&(Z.toLowerCase()==="true"||Z==="1")}function fZ(Z){return Z===!1||u(Z)&&(Z===0||Object.is(Z,-0))||J0(Z)&&Z===BigInt("0")||q1(Z)&&(Z.toLowerCase()==="false"||Z==="0"||Z==="-0")}function zF(Z){return q1(Z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Z)}function qF(Z){return q1(Z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Z)}function UF(Z){return q1(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Z)}function wF(Z){return q1(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Z)}function MF(Z){return q1(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(Z)}function GF(Z,$){let Y=VW(Z);return Y===$?Y:Z}function BF(Z,$){let Y=EW(Z);return Y===$?Y:Z}function SF(Z,$){let Y=CW(Z);return Y===$?Y:Z}function HF(Z,$){return q1(Z.const)?GF($,Z.const):u(Z.const)?BF($,Z.const):c6(Z.const)?SF($,Z.const):$}function CW(Z){return gZ(Z)?!0:fZ(Z)?!1:Z}function DF(Z){let $=(Y)=>Y.split(".")[0];return s$(Z)?BigInt($(Z)):u(Z)?BigInt(Math.trunc(Z)):fZ(Z)?BigInt(0):gZ(Z)?BigInt(1):Z}function VW(Z){return X8(Z)&&Z.description!==void 0?Z.description.toString():JF(Z)?Z.toString():Z}function EW(Z){return s$(Z)?parseFloat(Z):gZ(Z)?1:fZ(Z)?0:Z}function AF(Z){return s$(Z)?parseInt(Z):u(Z)?Math.trunc(Z):gZ(Z)?1:fZ(Z)?0:Z}function NF(Z){return q1(Z)&&Z.toLowerCase()==="null"?null:Z}function LF(Z){return q1(Z)&&Z==="undefined"?void 0:Z}function OF(Z){return O0(Z)?Z:u(Z)?new Date(Z):gZ(Z)?new Date(1):fZ(Z)?new Date(0):s$(Z)?new Date(parseInt(Z)):qF(Z)?new Date(`1970-01-01T${Z}.000Z`):zF(Z)?new Date(`1970-01-01T${Z}`):wF(Z)?new Date(`${Z}.000Z`):UF(Z)?new Date(Z):MF(Z)?new Date(`${Z}T00:00:00.000Z`):Z}function FF(Z){return Z}function KF(Z,$,Y){return(i(Y)?Y:[Y]).map((X)=>b6(Z.items,$,X))}function PF(Z,$,Y){return DF(Y)}function jF(Z,$,Y){return CW(Y)}function RF(Z,$,Y){return OF(Y)}function _F(Z,$,Y){let Q=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];return b6(X,[...$,...Q],Y)}function CF(Z,$,Y){return AF(Y)}function VF(Z,$,Y){return Z.allOf.reduce((Q,X)=>b6(X,$,Q),Y)}function EF(Z,$,Y){return HF(Z,Y)}function IF(Z,$,Y){return NF(Y)}function xF(Z,$,Y){return EW(Y)}function TF(Z,$,Y){if(!a(Y))return Y;for(let Q of Object.getOwnPropertyNames(Z.properties)){if(!c(Y,Q))continue;Y[Q]=b6(Z.properties[Q],$,Y[Q])}return Y}function bF(Z,$,Y){if(!a(Y))return Y;let X=Object.getOwnPropertyNames(Z.patternProperties)[0],W=Z.patternProperties[X];for(let[J,z]of Object.entries(Y))Y[J]=b6(W,$,z);return Y}function kF(Z,$,Y){return b6(M1(Z,$),$,Y)}function gF(Z,$,Y){return VW(Y)}function fF(Z,$,Y){return q1(Y)||u(Y)?Symbol(Y):Y}function yF(Z,$,Y){return b6(M1(Z,$),$,Y)}function vF(Z,$,Y){if(!(i(Y)&&!k1(Z.items)))return Y;return Y.map((X,W)=>{return W<Z.items.length?b6(Z.items[W],$,X):X})}function dF(Z,$,Y){return LF(Y)}function hF(Z,$,Y){for(let Q of Z.anyOf){let X=b6(Q,$,G1(Y));if(!e(Q,$,X))continue;return X}return Y}function b6(Z,$,Y){let Q=Y0(Z,$),X=Z;switch(Z[N]){case"Array":return KF(X,Q,Y);case"BigInt":return PF(X,Q,Y);case"Boolean":return jF(X,Q,Y);case"Date":return RF(X,Q,Y);case"Import":return _F(X,Q,Y);case"Integer":return CF(X,Q,Y);case"Intersect":return VF(X,Q,Y);case"Literal":return EF(X,Q,Y);case"Null":return IF(X,Q,Y);case"Number":return xF(X,Q,Y);case"Object":return TF(X,Q,Y);case"Record":return bF(X,Q,Y);case"Ref":return kF(X,Q,Y);case"String":return gF(X,Q,Y);case"Symbol":return fF(X,Q,Y);case"This":return yF(X,Q,Y);case"Tuple":return vF(X,Q,Y);case"Undefined":return dF(X,Q,Y);case"Union":return hF(X,Q,Y);default:return FF(Y)}}function r$(...Z){return Z.length===3?b6(Z[0],Z[1],Z[2]):b6(Z[0],[],Z[1])}function IW(...Z){let[$,Y,Q]=Z.length===3?[Z[0],Z[1],Z[2]]:[Z[0],[],Z[1]];if(!e($,Y,Q))throw new TZ($,Q,t6($,Y,Q).First());return B8($,Y)?s4($,Y,Q):Q}function H8(Z,$){let Y=c(Z,"default")?Z.default:void 0,Q=j8(Y)?Y():G1(Y);return k1($)?Q:a($)&&a(Q)?Object.assign(Q,$):$}function nY(Z){return _8(Z)&&"default"in Z}function mF(Z,$,Y){if(i(Y)){for(let X=0;X<Y.length;X++)Y[X]=K0(Z.items,$,Y[X]);return Y}let Q=H8(Z,Y);if(!i(Q))return Q;for(let X=0;X<Q.length;X++)Q[X]=K0(Z.items,$,Q[X]);return Q}function uF(Z,$,Y){return O0(Y)?Y:H8(Z,Y)}function pF(Z,$,Y){let Q=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];return K0(X,[...$,...Q],Y)}function cF(Z,$,Y){let Q=H8(Z,Y);return Z.allOf.reduce((X,W)=>{let J=K0(W,$,Q);return a(J)?{...X,...J}:J},{})}function iF(Z,$,Y){let Q=H8(Z,Y);if(!a(Q))return Q;let X=Object.getOwnPropertyNames(Z.properties);for(let W of X){let J=K0(Z.properties[W],$,Q[W]);if(k1(J))continue;Q[W]=K0(Z.properties[W],$,Q[W])}if(!nY(Z.additionalProperties))return Q;for(let W of Object.getOwnPropertyNames(Q)){if(X.includes(W))continue;Q[W]=K0(Z.additionalProperties,$,Q[W])}return Q}function lF(Z,$,Y){let Q=H8(Z,Y);if(!a(Q))return Q;let X=Z.additionalProperties,[W,J]=Object.entries(Z.patternProperties)[0],z=new RegExp(W);for(let q of Object.getOwnPropertyNames(Q)){if(!(z.test(q)&&nY(J)))continue;Q[q]=K0(J,$,Q[q])}if(!nY(X))return Q;for(let q of Object.getOwnPropertyNames(Q)){if(z.test(q))continue;Q[q]=K0(X,$,Q[q])}return Q}function nF(Z,$,Y){return K0(M1(Z,$),$,H8(Z,Y))}function oF(Z,$,Y){return K0(M1(Z,$),$,Y)}function tF(Z,$,Y){let Q=H8(Z,Y);if(!i(Q)||k1(Z.items))return Q;let[X,W]=[Z.items,Math.max(Z.items.length,Q.length)];for(let J=0;J<W;J++)if(J<X.length)Q[J]=K0(X[J],$,Q[J]);return Q}function sF(Z,$,Y){let Q=H8(Z,Y);for(let X of Z.anyOf){let W=K0(X,$,G1(Q));if(e(X,$,W))return W}return Q}function K0(Z,$,Y){let Q=Y0(Z,$),X=Z;switch(X[N]){case"Array":return mF(X,Q,Y);case"Date":return uF(X,Q,Y);case"Import":return pF(X,Q,Y);case"Intersect":return cF(X,Q,Y);case"Object":return iF(X,Q,Y);case"Record":return lF(X,Q,Y);case"Ref":return nF(X,Q,Y);case"This":return oF(X,Q,Y);case"Tuple":return tF(X,Q,Y);case"Union":return sF(X,Q,Y);default:return H8(X,Y)}}function a$(...Z){return Z.length===3?K0(Z[0],Z[1],Z[2]):K0(Z[0],[],Z[1])}var k6={};e8(k6,{ValuePointerRootSetError:()=>oY,ValuePointerRootDeleteError:()=>tY,Set:()=>rF,Has:()=>eF,Get:()=>Z3,Format:()=>yZ,Delete:()=>aF});class oY extends p{constructor(Z,$,Y){super("Cannot set root value");this.value=Z,this.path=$,this.update=Y}}class tY extends p{constructor(Z,$){super("Cannot delete root value");this.value=Z,this.path=$}}function xW(Z){return Z.indexOf("~")===-1?Z:Z.replace(/~1/g,"/").replace(/~0/g,"~")}function*yZ(Z){if(Z==="")return;let[$,Y]=[0,0];for(let Q=0;Q<Z.length;Q++)if(Z.charAt(Q)==="/")if(Q===0)$=Q+1;else Y=Q,yield xW(Z.slice($,Y)),$=Q+1;else Y=Q;yield xW(Z.slice($))}function rF(Z,$,Y){if($==="")throw new oY(Z,$,Y);let[Q,X,W]=[null,Z,""];for(let J of yZ($)){if(X[J]===void 0)X[J]={};Q=X,X=X[J],W=J}Q[W]=Y}function aF(Z,$){if($==="")throw new tY(Z,$);let[Y,Q,X]=[null,Z,""];for(let W of yZ($)){if(Q[W]===void 0||Q[W]===null)return;Y=Q,Q=Q[W],X=W}if(Array.isArray(Y)){let W=parseInt(X);Y.splice(W,1)}else delete Y[X]}function eF(Z,$){if($==="")return!0;let[Y,Q,X]=[null,Z,""];for(let W of yZ($)){if(Q[W]===void 0)return!1;Y=Q,Q=Q[W],X=W}return Object.getOwnPropertyNames(Y).includes(X)}function Z3(Z,$){if($==="")return Z;let Y=Z;for(let Q of yZ($)){if(Y[Q]===void 0)return;Y=Y[Q]}return Y}function $3(Z,$){if(!a($))return!1;let Y=[...Object.keys(Z),...Object.getOwnPropertySymbols(Z)],Q=[...Object.keys($),...Object.getOwnPropertySymbols($)];if(Y.length!==Q.length)return!1;return Y.every((X)=>G4(Z[X],$[X]))}function Y3(Z,$){return O0($)&&Z.getTime()===$.getTime()}function Q3(Z,$){if(!i($)||Z.length!==$.length)return!1;return Z.every((Y,Q)=>G4(Y,$[Q]))}function X3(Z,$){if(!$6($)||Z.length!==$.length||Object.getPrototypeOf(Z).constructor.name!==Object.getPrototypeOf($).constructor.name)return!1;return Z.every((Y,Q)=>G4(Y,$[Q]))}function W3(Z,$){return Z===$}function G4(Z,$){if(O0(Z))return Y3(Z,$);if($6(Z))return X3(Z,$);if(i(Z))return Q3(Z,$);if(a(Z))return $3(Z,$);if(c0(Z))return W3(Z,$);throw new Error("ValueEquals: Unable to compare value")}var J3=D1({type:J1("insert"),path:F0(),value:C6()}),z3=D1({type:J1("update"),path:F0(),value:C6()}),q3=D1({type:J1("delete"),path:F0()}),bW=H1([J3,z3,q3]);class sY extends p{constructor(Z,$){super($);this.value=Z}}function e$(Z,$){return{type:"update",path:Z,value:$}}function kW(Z,$){return{type:"insert",path:Z,value:$}}function gW(Z){return{type:"delete",path:Z}}function TW(Z){if(globalThis.Object.getOwnPropertySymbols(Z).length>0)throw new sY(Z,"Cannot diff objects with symbols")}function*U3(Z,$,Y){if(TW($),TW(Y),!NY(Y))return yield e$(Z,Y);let Q=globalThis.Object.getOwnPropertyNames($),X=globalThis.Object.getOwnPropertyNames(Y);for(let W of X){if(c($,W))continue;yield kW(`${Z}/${W}`,Y[W])}for(let W of Q){if(!c(Y,W))continue;if(G4($,Y))continue;yield*Z9(`${Z}/${W}`,$[W],Y[W])}for(let W of Q){if(c(Y,W))continue;yield gW(`${Z}/${W}`)}}function*w3(Z,$,Y){if(!i(Y))return yield e$(Z,Y);for(let Q=0;Q<Math.min($.length,Y.length);Q++)yield*Z9(`${Z}/${Q}`,$[Q],Y[Q]);for(let Q=0;Q<Y.length;Q++){if(Q<$.length)continue;yield kW(`${Z}/${Q}`,Y[Q])}for(let Q=$.length-1;Q>=0;Q--){if(Q<Y.length)continue;yield gW(`${Z}/${Q}`)}}function*M3(Z,$,Y){if(!$6(Y)||$.length!==Y.length||globalThis.Object.getPrototypeOf($).constructor.name!==globalThis.Object.getPrototypeOf(Y).constructor.name)return yield e$(Z,Y);for(let Q=0;Q<Math.min($.length,Y.length);Q++)yield*Z9(`${Z}/${Q}`,$[Q],Y[Q])}function*G3(Z,$,Y){if($===Y)return;yield e$(Z,Y)}function*Z9(Z,$,Y){if(NY($))return yield*U3(Z,$,Y);if(i($))return yield*w3(Z,$,Y);if($6($))return yield*M3(Z,$,Y);if(c0($))return yield*G3(Z,$,Y);throw new sY($,"Unable to diff value")}function fW(Z,$){return[...Z9("",Z,$)]}function B3(Z){return Z.length>0&&Z[0].path===""&&Z[0].type==="update"}function S3(Z){return Z.length===0}function yW(Z,$){if(B3($))return G1($[0].value);if(S3($))return G1(Z);let Y=G1(Z);for(let Q of $)switch(Q.type){case"insert":{k6.Set(Y,Q.path,Q.value);break}case"update":{k6.Set(Y,Q.path,Q.value);break}case"delete":{k6.Delete(Y,Q.path);break}}return Y}function vW(...Z){let[$,Y,Q]=Z.length===3?[Z[0],Z[1],Z[2]]:[Z[0],[],Z[1]],X=B8($,Y)?r4($,Y,Q):Q;if(!e($,Y,X))throw new bZ($,X,t6($,Y,X).First());return X}function $9(Z){return a(Z)&&!i(Z)}class rY extends p{constructor(Z){super(Z)}}function H3(Z,$,Y,Q){if(!$9(Y))k6.Set(Z,$,G1(Q));else{let X=Object.getOwnPropertyNames(Y),W=Object.getOwnPropertyNames(Q);for(let J of X)if(!W.includes(J))delete Y[J];for(let J of W)if(!X.includes(J))Y[J]=null;for(let J of W)aY(Z,`${$}/${J}`,Y[J],Q[J])}}function D3(Z,$,Y,Q){if(!i(Y))k6.Set(Z,$,G1(Q));else{for(let X=0;X<Q.length;X++)aY(Z,`${$}/${X}`,Y[X],Q[X]);Y.splice(Q.length)}}function A3(Z,$,Y,Q){if($6(Y)&&Y.length===Q.length)for(let X=0;X<Y.length;X++)Y[X]=Q[X];else k6.Set(Z,$,G1(Q))}function N3(Z,$,Y,Q){if(Y===Q)return;k6.Set(Z,$,Q)}function aY(Z,$,Y,Q){if(i(Q))return D3(Z,$,Y,Q);if($6(Q))return A3(Z,$,Y,Q);if($9(Q))return H3(Z,$,Y,Q);if(c0(Q))return N3(Z,$,Y,Q)}function dW(Z){return $6(Z)||c0(Z)}function L3(Z,$){return $9(Z)&&i($)||i(Z)&&$9($)}function hW(Z,$){if(dW(Z)||dW($))throw new rY("Only object and array types can be mutated at the root level");if(L3(Z,$))throw new rY("Cannot assign due type mismatch of assignable values");aY(Z,"",Z,$)}class Z5 extends p{constructor(Z){super(Z)}}var eY;(function(Z){let $=new Map([["Assert",(W,J,z)=>{return o$(W,J,z),z}],["Cast",(W,J,z)=>kZ(W,J,z)],["Clean",(W,J,z)=>t$(W,J,z)],["Clone",(W,J,z)=>G1(z)],["Convert",(W,J,z)=>r$(W,J,z)],["Decode",(W,J,z)=>B8(W,J)?s4(W,J,z):z],["Default",(W,J,z)=>a$(W,J,z)],["Encode",(W,J,z)=>B8(W,J)?r4(W,J,z):z]]);function Y(W){$.delete(W)}Z.Delete=Y;function Q(W,J){$.set(W,J)}Z.Set=Q;function X(W){return $.get(W)}Z.Get=X})(eY||(eY={}));var mW=["Clone","Clean","Default","Convert","Assert","Decode"];function O3(Z,$,Y,Q){return Z.reduce((X,W)=>{let J=eY.Get(W);if(k1(J))throw new Z5(`Unable to find Parse operation '${W}'`);return J($,Y,X)},Q)}function uW(...Z){let[$,Y,Q,X]=Z.length===4?[Z[0],Z[1],Z[2],Z[3]]:Z.length===3?i(Z[0])?[Z[0],Z[1],[],Z[2]]:[mW,Z[0],Z[1],Z[2]]:Z.length===2?[mW,Z[0],[],Z[1]]:(()=>{throw new Z5("Invalid Arguments")})();return O3($,Y,Q,X)}var o={};e8(o,{ValueErrorIterator:()=>w4,Patch:()=>yW,Parse:()=>uW,Mutate:()=>hW,Hash:()=>b8,Errors:()=>t6,Equal:()=>G4,Encode:()=>vW,Edit:()=>bW,Diff:()=>fW,Default:()=>a$,Decode:()=>IW,Create:()=>w6,Convert:()=>r$,Clone:()=>G1,Clean:()=>t$,Check:()=>e,Cast:()=>kZ,Assert:()=>o$});var G9=GY(lW(),1);var G5={date:HJ,time:q5(!0),"date-time":nW(!0),"iso-time":q5(!1),"iso-date-time":nW(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:h3,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:n3,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:m3,int32:{type:"number",validate:c3},int64:{type:"number",validate:i3},float:{type:"number",validate:tW},double:{type:"number",validate:tW},password:!0,binary:!0};function b3(Z){return Z%4===0&&(Z%100!==0||Z%400===0)}var k3=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,g3=[0,31,28,31,30,31,30,31,31,30,31,30,31];function HJ(Z){let $=k3.exec(Z);if(!$)return!1;let Y=+$[1],Q=+$[2],X=+$[3];return Q>=1&&Q<=12&&X>=1&&X<=(Q===2&&b3(Y)?29:g3[Q])}var f3=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function q5(Z){return function $(Y){let Q=f3.exec(Y);if(!Q)return!1;let X=+Q[1],W=+Q[2],J=+Q[3],z=Q[4],q=Q[5]==="-"?-1:1,U=+(Q[6]||0),w=+(Q[7]||0);if(U>23||w>59||Z&&!z)return!1;if(X<=23&&W<=59&&J<60)return!0;let M=W-w*q,S=X-U*q-(M<0?1:0);return(S===23||S===-1)&&(M===59||M===-1)&&J<61}}var y3=/t|\s/i;function nW(Z){let $=q5(Z);return function Y(Q){let X=Q.split(y3);return X.length===2&&HJ(X[0])&&$(X[1])}}var v3=/\/|:/,d3=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function h3(Z){return v3.test(Z)&&d3.test(Z)}var oW=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function m3(Z){return oW.lastIndex=0,oW.test(Z)}var u3=-2147483648,p3=2147483647;function c3(Z){return Number.isInteger(Z)&&Z<=p3&&Z>=u3}function i3(Z){return Number.isInteger(Z)}function tW(){return!0}var l3=/[^\\]\\Z/;function n3(Z){if(l3.test(Z))return!1;try{return new RegExp(Z),!0}catch($){return!1}}var W9="toJSON"in new Headers,sW=(Z,$)=>{let Y=new URL(Z);return Y.pathname=$,Y.toString()},o3=(Z)=>typeof Z==="function"&&/^\s*class\s+/.test(Z.toString())||Z.toString&&Z.toString().startsWith("[object ")&&Z.toString()!=="[object Object]"||B6(Object.getPrototypeOf(Z)),$5=(Z)=>Z&&typeof Z==="object"&&!Array.isArray(Z),f0=(Z,$,{skipKeys:Y,override:Q=!0}={})=>{if(!$5(Z)||!$5($))return Z;for(let[X,W]of Object.entries($)){if(Y?.includes(X))continue;if(!$5(W)||!(X in Z)||o3(W)){if(Q||!(X in Z))Z[X]=W;continue}Z[X]=f0(Z[X],W,{skipKeys:Y,override:Q})}return Z},t3=(Z,$)=>{let Y=f0(Object.assign({},Z),$,{skipKeys:["properties"]});if("properties"in Y)delete Y.properties;return Y},p1=(Z=[],$=[])=>{if(!Z)return;if(!$)return Z;let Y=[],Q=[];if(!Array.isArray(Z))Z=[Z];if(!Array.isArray($))$=[$];for(let X of Z)if(Y.push(X),X.checksum)Q.push(X.checksum);for(let X of $)if(!Q.includes(X.checksum))Y.push(X);return Y},s3=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],r3=s3.reduce((Z,$)=>(Z[$]=!0,Z),{}),DJ=(Z,$)=>{let Y=(Q)=>typeof Q==="object"&&Object.keys(Q).every(B5);if(Y(Z)&&Y($))return Object.assign(Z,$);else if(Z&&!Y(Z)&&Y($))return Object.assign({200:Z},$);return $??Z},vZ=(Z,$)=>{return{body:$?.body??Z?.body,headers:$?.headers??Z?.headers,params:$?.params??Z?.params,query:$?.query??Z?.query,cookie:$?.cookie??Z?.cookie,response:DJ(Z?.response,$?.response)}},D8=(Z,$)=>{let{resolve:Y,...Q}=Z??{},{resolve:X,...W}=$??{};return{...Q,...W,body:$?.body??Z?.body,headers:$?.headers??Z?.headers,params:$?.params??Z?.params,query:$?.query??Z?.query,cookie:$?.cookie??Z?.cookie,response:DJ(Z?.response,$?.response),type:Z?.type||$?.type,detail:f0($?.detail??{},Z?.detail??{}),parse:p1(Z?.parse,$?.parse),transform:p1(Z?.transform,$?.transform),beforeHandle:p1(p1(W0(Y,"resolve"),Z?.beforeHandle),p1(W0(X,"resolve"),$?.beforeHandle)),afterHandle:p1(Z?.afterHandle,$?.afterHandle),mapResponse:p1(Z?.mapResponse,$?.mapResponse),afterResponse:p1(Z?.afterResponse,$?.afterResponse),trace:p1(Z?.trace,$?.trace),error:p1(Z?.error,$?.error)}},U5=(Z,$,Y=!0)=>{if(!Array.isArray($))return $.original=Z,U0(Z,$,Y);for(let Q of $)Q.original=Z,Z=U0(Z,Q,Y);return Z},U0=(Z,$,Y=!0)=>{if(!Z)return Z;if($.untilObjectFound&&!Y&&Z.type==="object")return Z;let Q=$.from[N];if(Z.oneOf){for(let J=0;J<Z.oneOf.length;J++)Z.oneOf[J]=U0(Z.oneOf[J],$,Y);return Z}if(Z.anyOf){for(let J=0;J<Z.anyOf.length;J++)Z.anyOf[J]=U0(Z.anyOf[J],$,Y);return Z}if(Z.allOf){for(let J=0;J<Z.allOf.length;J++)Z.allOf[J]=U0(Z.allOf[J],$,Y);return Z}if(Z.not)return U0(Z.not,$,Y);let X=Y&&!!$.excludeRoot;if(Z[N]===Q){let{anyOf:J,oneOf:z,allOf:q,not:U,properties:w,items:M,...S}=Z,G=$.to(S);if(!G)return Z;let L,B=(P)=>{if(w&&P.type==="object"){let n={};for(let[s,A1]of Object.entries(w))n[s]=U0(A1,$,!1);return{...S,...P,properties:n}}if(M&&P.type==="array")return{...S,...P,items:U0(M,$,!1)};let I={...S,...P};if(delete I.required,w&&P.type==="string"&&P.format==="ObjectString"&&P.default==="{}")L=x.ObjectString(w,S),I.default=JSON.stringify(o.Create(x.Object(w))),I.properties=w;if(M&&P.type==="string"&&P.format==="ArrayString"&&P.default==="[]")L=x.ArrayString(M,S),I.default=JSON.stringify(o.Create(x.Array(M))),I.items=M;return I};if(X){if(w){let P={};for(let[I,n]of Object.entries(w))P[I]=U0(n,$,!1);return{...S,properties:P}}else if(M?.map)return{...S,items:M.map((P)=>U0(P,$,!1))};return S}if(G.anyOf)for(let P=0;P<G.anyOf.length;P++)G.anyOf[P]=B(G.anyOf[P]);else if(G.oneOf)for(let P=0;P<G.oneOf.length;P++)G.oneOf[P]=B(G.oneOf[P]);else if(G.allOf)for(let P=0;P<G.allOf.length;P++)G.allOf[P]=B(G.allOf[P]);else if(G.not)G.not=B(G.not);if(L)G[C1]=L[C1];if(G.anyOf||G.oneOf||G.allOf||G.not)return G;if(w){let P={};for(let[I,n]of Object.entries(w))P[I]=U0(n,$,!1);return{...S,...G,properties:P}}else if(M?.map)return{...S,...G,items:M.map((P)=>U0(P,$,!1))};return{...S,...G}}let W=Z?.properties;if(W&&Y&&$.rootOnly!==!0)for(let[J,z]of Object.entries(W))switch(z[N]){case Q:let{anyOf:q,oneOf:U,allOf:w,not:M,type:S,...G}=z,L=$.to(G);if(!L)return Z;if(L.anyOf)for(let B=0;B<L.anyOf.length;B++)L.anyOf[B]={...G,...L.anyOf[B]};else if(L.oneOf)for(let B=0;B<L.oneOf.length;B++)L.oneOf[B]={...G,...L.oneOf[B]};else if(L.allOf)for(let B=0;B<L.allOf.length;B++)L.allOf[B]={...G,...L.allOf[B]};else if(L.not)L.not={...G,...L.not};W[J]={...G,...U0(G,$,!1)};break;case"Object":case"Union":W[J]=U0(z,$,!1);break;default:if(Array.isArray(z.items))for(let B=0;B<z.items.length;B++)z.items[B]=U0(z.items[B],$,!1);else if(z.anyOf||z.oneOf||z.allOf||z.not)W[J]=U0(z,$,!1);else if(z.type==="array")z.items=U0(z.items,$,!1);break}return Z},uZ=(Z)=>($)=>{if(typeof $==="object")try{return o.Clean(Z,structuredClone($))}catch{try{return o.Clean(Z,$)}catch{return $}}return $},y0=(Z,{models:$={},dynamic:Y=!1,modules:Q,normalize:X=!1,additionalProperties:W=!1,coerce:J=!1,additionalCoerce:z=[]}={modules:x.Module({})})=>{if(!Z)return;let q;if(typeof Z!=="string")q=Z;else{let w=Z.endsWith("[]"),M=w?Z.substring(0,Z.length-2):Z;if(q=Q.Import(M)??$[M],w)q=x.Array(q)}if(!q)return;if(J||z)if(J)q=U5(q,[{from:x.Ref(""),to:(w)=>Q.Import(w.$ref)},{from:x.Number(),to:(w)=>x.Numeric(w),untilObjectFound:!0},{from:x.Boolean(),to:(w)=>x.BooleanString(w),untilObjectFound:!0},...Array.isArray(z)?z:[z]]);else q=U5(q,[{from:x.Ref(""),to:(w)=>Q.Import(w.$ref)},...Array.isArray(z)?z:[z]]);if(q.type==="object"&&"additionalProperties"in q===!1)q.additionalProperties=W;if(Y){let w={schema:q,references:"",checkFunc:()=>{},code:"",Check:(M)=>o.Check(q,M),Errors:(M)=>o.Errors(q,M),Code:()=>"",Clean:uZ(q),Decode:(M)=>o.Decode(q,M),Encode:(M)=>o.Encode(q,M)};if(X&&q.additionalProperties===!1)w.Clean=uZ(q);if(q.config){if(w.config=q.config,w?.schema?.config)delete w.schema.config}return w.parse=(M)=>{try{return w.Decode(M)}catch(S){throw[...w.Errors(M)].map(v6)}},w.safeParse=(M)=>{try{return{success:!0,data:w.Decode(M),error:null}}catch(S){let G=[...U.Errors(M)].map(v6);return{success:!1,data:null,error:G[0]?.summary,errors:G}}},w}let U=k8.Compile(q,Object.values($));if(U.Clean=uZ(q),q.config){if(U.config=q.config,U?.schema?.config)delete U.schema.config}return U.parse=(w)=>{try{return U.Decode(w)}catch(M){throw[...U.Errors(w)].map(v6)}},U.safeParse=(w)=>{try{return{success:!0,data:U.Decode(w),error:null}}catch(M){let S=[...U.Errors(w)].map(v6);return{success:!1,data:null,error:S[0]?.summary,errors:S}}},U},rW=(Z,{models:$={},modules:Y,dynamic:Q=!1,normalize:X=!1,additionalProperties:W=!1})=>{if(!Z)return;let J;if(typeof Z!=="string")J=Z;else{let w=Z.endsWith("[]"),M=w?Z.substring(0,Z.length-2):Z;if(J=Y.Import(M)??$[M],w)J=x.Array(J)}if(!J)return;let z=(w,M)=>{if(Q)return{schema:w,references:"",checkFunc:()=>{},code:"",Check:(G)=>o.Check(w,G),Errors:(G)=>o.Errors(w,G),Code:()=>"",Clean:uZ(w),Decode:(G)=>o.Decode(w,G),Encode:(G)=>o.Encode(w,G)};let S=k8.Compile(w,M);if(X&&w.additionalProperties===!1)S.Clean=uZ(w);return S},q=Object.values($);if(N in J){if("additionalProperties"in J===!1)J.additionalProperties=W;return{200:z(J,q)}}let U={};return Object.keys(J).forEach((w)=>{let M=J[+w];if(typeof M==="string"){if(M in $){let S=$[M];S.type==="object"&&"additionalProperties"in S,U[+w]=N in S?z(S,q):S}return}if(M.type==="object"&&"additionalProperties"in M===!1)M.additionalProperties=W;U[+w]=N in M?z(M,q):M}),U},a3=typeof Bun!=="undefined",e3=a3&&typeof Bun.hash==="function",dZ=(Z)=>{if(e3)return Bun.hash(Z);let $=9;for(let Y=0;Y<Z.length;)$=Math.imul($^Z.charCodeAt(Y++),387420489);return $=$^$>>>9},Y5,B4=()=>{if(!Y5)Y5=[{from:x.Object({}),to:()=>x.ObjectString({}),excludeRoot:!0},{from:x.Array(x.Any()),to:()=>x.ArrayString(x.Any())}];return Y5},Q5,aW=()=>{if(!Q5)Q5=[{from:x.Number(),to:(Z)=>x.Numeric(Z),rootOnly:!0},{from:x.Boolean(),to:(Z)=>x.BooleanString(Z),rootOnly:!0}];return Q5},AJ=({validator:Z,modules:$,defaultConfig:Y={},config:Q,dynamic:X,models:W})=>{let J=y0(Z,{modules:$,dynamic:X,models:W,additionalProperties:!0,coerce:!0,additionalCoerce:B4()});if(B6(Y))if(J)J.config=t3(J.config,Q);else J=y0(x.Cookie({}),{modules:$,dynamic:X,models:W,additionalProperties:!0}),J.config=Y;return J},g6=(Z,$)=>{if(!$)return;if(!Array.isArray($)){let Q=$;if(Z&&!Q.checksum)Q.checksum=Z;if(Q.scope==="scoped")Q.scope="local";return Q}let Y=[...$];for(let Q of Y){if(Z&&!Q.checksum)Q.checksum=Z;if(Q.scope==="scoped")Q.scope="local"}return Y},eW=(Z,$,Y)=>{return{start:p1(Z.start,g6(Y,$?.start)),request:p1(Z.request,g6(Y,$?.request)),parse:p1(Z.parse,g6(Y,$?.parse)),transform:p1(Z.transform,g6(Y,$?.transform)),beforeHandle:p1(p1(W0(Z.resolve,"resolve"),Z.beforeHandle),g6(Y,p1(W0($?.resolve,"resolve"),$?.beforeHandle))),afterHandle:p1(Z.afterHandle,g6(Y,$?.afterHandle)),mapResponse:p1(Z.mapResponse,g6(Y,$?.mapResponse)),afterResponse:p1(Z.afterResponse,g6(Y,$?.afterResponse)),trace:p1(Z.trace,g6(Y,$?.trace)),error:p1(Z.error,g6(Y,$?.error)),stop:p1(Z.stop,g6(Y,$?.stop))}},ZK=(Z,$,{skipIfHasType:Y=!1}={})=>{if(!Z)return Z;if(!Array.isArray(Z)){if(Y)Z.scope??=$;else Z.scope=$;return Z}for(let Q of Z)if(Y)Q.scope??=$;else Q.scope=$;return Z},g8=(Z)=>{if(!Z)return Z;if(!Array.isArray(Z))switch(Z.scope){case"global":case"scoped":return{...Z};default:return{fn:Z}}let $=[];for(let Y of Z)switch(Y.scope){case"global":case"scoped":$.push({...Y});break}return $},ZJ=(Z)=>{return{...Z,type:Z?.type,detail:Z?.detail,parse:g8(Z?.parse),transform:g8(Z?.transform),beforeHandle:g8(Z?.beforeHandle),afterHandle:g8(Z?.afterHandle),mapResponse:g8(Z?.mapResponse),afterResponse:g8(Z?.afterResponse),error:g8(Z?.error),trace:g8(Z?.trace)}},w9={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},$J=Object.fromEntries(Object.entries(w9).map(([Z,$])=>[$,Z]));function $K(Z){let $=Z;while($.endsWith("="))$=$.slice(0,-1);return $}var YJ=new TextEncoder,J9=async(Z,$)=>{if(typeof Z!=="string")throw new TypeError("Cookie value must be provided as a string.");if($===null)throw new TypeError("Secret key must be provided.");let Y=await crypto.subtle.importKey("raw",YJ.encode($),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Q=await crypto.subtle.sign("HMAC",Y,YJ.encode(Z));return Z+"."+$K(Buffer.from(Q).toString("base64"))},QJ=async(Z,$)=>{if(typeof Z!=="string")throw new TypeError("Signed cookie string must be provided.");if($===null)throw new TypeError("Secret key must be provided.");let Y=Z.slice(0,Z.lastIndexOf("."));return await J9(Y,$)===Z?Y:!1},YK=(Z,$,Y)=>{if(!Z||typeof Z!=="object"||!$)return;for(let[Q,X]of Object.entries($)){if(Q in r3||!(Q in Z))continue;let W=Z[Q];if(typeof W==="function"){let J=W(X);if(typeof J==="object")for(let[z,q]of Object.entries(J))Y(z)({fn:q})}delete $[Q]}},QK=({globalHook:Z,localHook:$})=>(Y)=>(Q,X)=>{if(typeof Q==="function")Q={fn:Q};if(Y==="resolve")Q={...Q,subType:"resolve"};if("fn"in Q||Array.isArray(Q)){if(!$[Y])$[Y]=[];if(typeof $[Y]==="function")$[Y]=[$[Y]];if(Array.isArray(Q))$[Y]=$[Y].concat(Q);else $[Y].push(Q);return}let{insert:W="after",stack:J="local"}=Q;if(typeof X==="function")X={fn:X};if(J==="global")if(!Array.isArray(X))if(W==="before")Z[Y].unshift(X);else Z[Y].push(X);else if(W==="before")Z[Y]=X.concat(Z[Y]);else Z[Y]=Z[Y].concat(X);else{if(!$[Y])$[Y]=[];if(typeof $[Y]==="function")$[Y]=[$[Y]];if(!Array.isArray(X))if(W==="before")$[Y].unshift(X);else $[Y].push(X);else if(W==="before")$[Y]=X.concat($[Y]);else $[Y]=$[Y].concat(X)}},XK=(Z)=>{if(typeof Z==="number")return Z;if(Z.length<16){if(Z.trim().length===0)return null;let $=Number(Z);if(Number.isNaN($))return null;return $}if(Z.length===16){if(Z.trim().length===0)return null;let $=Number(Z);if(Number.isNaN($)||$.toString()!==Z)return null;return $}return null},B5=(Z)=>XK(Z)!==null;class NJ{onError;root=null;promises=[];constructor(Z=console.error){this.onError=Z}get size(){return this.promises.length}add(Z){return this.promises.push(Z),this.root||=this.drain(),Z}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch(Z){this.onError(Z)}this.promises.shift()}this.root=null}then(Z,$){return(this.root??Promise.resolve()).then(Z,$)}}var W0=(Z,$)=>{if(!Z)return Z;if(!Array.isArray(Z)){if(typeof Z==="function"||typeof Z==="string")return $?{fn:Z,subType:$}:{fn:Z};else if("fn"in Z)return Z}let Y=[];for(let Q of Z)if(typeof Q==="function"||typeof Q==="string")Y.push($?{fn:Q,subType:$}:{fn:Q});else if("fn"in Q)Y.push(Q);return Y},WK=(Z)=>{return{...Z,start:W0(Z?.start),request:W0(Z?.request),parse:W0(Z?.parse),transform:W0(Z?.transform),beforeHandle:W0(Z?.beforeHandle),afterHandle:W0(Z?.afterHandle),mapResponse:W0(Z?.mapResponse),afterResponse:W0(Z?.afterResponse),trace:W0(Z?.trace),error:W0(Z?.error),stop:W0(Z?.stop)}},XJ=(Z)=>{let $={};if(Z.start?.map)$.start=Z.start.map((Y)=>Y.fn);if(Z.request?.map)$.request=Z.request.map((Y)=>Y.fn);if(Z.parse?.map)$.parse=Z.parse.map((Y)=>Y.fn);if(Z.transform?.map)$.transform=Z.transform.map((Y)=>Y.fn);if(Z.beforeHandle?.map)$.beforeHandle=Z.beforeHandle.map((Y)=>Y.fn);if(Z.afterHandle?.map)$.afterHandle=Z.afterHandle.map((Y)=>Y.fn);if(Z.mapResponse?.map)$.mapResponse=Z.mapResponse.map((Y)=>Y.fn);if(Z.afterResponse?.map)$.afterResponse=Z.afterResponse.map((Y)=>Y.fn);if(Z.trace?.map)$.trace=Z.trace.map((Y)=>Y.fn);if(Z.error?.map)$.error=Z.error.map((Y)=>Y.fn);if(Z.stop?.map)$.stop=Z.stop.map((Y)=>Y.fn);return $},X5=(Z)=>({body:Z.body,cookie:Z.cookie,headers:Z.headers,query:Z.query,set:Z.set,server:Z.server,request:Z.request,route:Z.route}),LJ=(Z,$=302)=>Response.redirect(Z,$),Ao=Symbol("ElysiaFormData"),M9=Symbol("ElysiaRequestId");var OJ=()=>{let Z=crypto.randomUUID();return Z.slice(0,8)+Z.slice(24,32)},WJ=(Z)=>{let $=[];for(let Y=0;Y<Z.length;Y++){let Q=Z[Y];if(Q.checksum){if($.includes(Q.checksum))Z.splice(Y,1),Y--;$.push(Q.checksum)}}return Z},A0=(Z,$="scoped")=>{if(!Z)return;if($==="scoped"){for(let Y of Z)if("scope"in Y&&Y.scope==="local")Y.scope="scoped";return}for(let Y of Z)if("scope"in Y)Y.scope="global"},a4=(Z)=>{if(Z.charCodeAt(Z.length-1)===47)return Z.slice(0,Z.length-1);return Z+"/"},B6=(Z)=>{if(!Z)return!1;for(let $ in Z)return!0;return!1},f6=(Z)=>{if(Array.isArray(Z))return Z.length===0;return!Z},W5=(Z)=>{let $={...Z};if(f6(Z.afterHandle))delete $.afterHandle;if(f6(Z.afterResponse))delete $.afterResponse;if(f6(Z.beforeHandle))delete $.beforeHandle;if(f6(Z.error))delete $.error;if(f6(Z.mapResponse))delete $.mapResponse;if(f6(Z.parse))delete $.parse;if(f6(Z.request))delete $.request;if(f6(Z.start))delete $.start;if(f6(Z.stop))delete $.stop;if(f6(Z.trace))delete $.trace;if(f6(Z.transform))delete $.transform;if(!$.type)delete $.type;if($.detail&&!Object.keys($.detail).length)delete $.detail;if(!$.body)delete $.body;if(!$.cookie)delete $.cookie;if(!$.headers)delete $.headers;if(!$.query)delete $.query;if(!$.params)delete $.params;if(!$.response)delete $.response;return $},hZ=(Z,{dynamic:$=!1}={})=>{let Y=encodeURIComponent(Z).replace(/%2F/g,"/");if($)Y=Y.replace(/%3A/g,":").replace(/%3F/g,"?");return Y},JJ=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,z9=Symbol("ElysiaErrorCode"),q9=(JJ?.NODE_ENV??JJ?.ENV)==="production";class d6{code;response;constructor(Z,$){let Y=$??(Z in $J?$J[Z]:Z);this.code=w9[Z]??Z,this.response=Y}}var FJ=(Z,$)=>new d6(Z,$);class KJ extends Error{code="INTERNAL_SERVER_ERROR";status=500;constructor(Z){super(Z??"INTERNAL_SERVER_ERROR")}}class S5 extends Error{code="NOT_FOUND";status=404;constructor(Z){super(Z??"NOT_FOUND")}}class PJ extends Error{code="PARSE";status=400;constructor(){super("Bad Request")}}class w5 extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor(Z,$){super($??`"${Z}" has invalid cookie signature`);this.key=Z}}var v6=(Z)=>{if(!Z)return{summary:void 0};let{message:$,path:Y,value:Q,type:X}=Z,W=Y.slice(1).replaceAll("/","."),J=Y==="";switch(X){case 42:return{...Z,summary:J?"Value should not be provided":`Property '${W}' should not be provided`};case 45:return{...Z,summary:J?"Value is missing":`Property '${W}' is missing`};case 50:let z=$.indexOf("'"),q=$.slice(z+1,$.indexOf("'",z+1));return{...Z,summary:J?"Value should be an email":`Property '${W}' should be ${q}`};case 54:return{...Z,summary:`${$.slice(0,9)} property '${W}' to be ${$.slice(8)} but found: ${Q}`};case 62:let U=Z.schema.anyOf.map((w)=>`'${w?.format??w.type}'`).join(", ");return{...Z,summary:J?`Value should be one of ${U}`:`Property '${W}' should be one of: ${U}`};default:return{summary:$,...Z}}};class Z1 extends Error{type;validator;value;code="VALIDATION";status=422;constructor(Z,$,Y){if(Y&&typeof Y==="object"&&Y instanceof d6)Y=Y.response;let Q=q9?void 0:("Errors"in $)?$.Errors(Y).First():o.Errors($,Y).First(),X=Q?.schema?.message||Q?.schema?.error!==void 0?typeof Q.schema.error==="function"?Q.schema.error({type:Z,validator:$,value:Y,get errors(){return[...$.Errors(Y)].map(v6)}}):Q.schema.error:void 0,W=Q?.path||"root",J="";if(X!==void 0)J=typeof X==="object"?JSON.stringify(X):X+"";else if(q9)J=JSON.stringify({type:"validation",on:Z,summary:v6(Q).summary,message:Q?.message,found:Y});else{let z=$?.schema??$,q="Errors"in $?[...$.Errors(Y)].map(v6):[...o.Errors($,Y)].map(v6),U;try{U=o.Create(z)}catch(w){U={type:"Could not create expected value",message:w?.message,error:w}}J=JSON.stringify({type:"validation",on:Z,summary:v6(Q).summary,property:W,message:Q?.message,expected:U,found:Y,errors:q},null,2)}super(J);this.type=Z,this.validator=$,this.value=Y,Object.setPrototypeOf(this,Z1.prototype)}get all(){return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(v6):[...o.Errors(this.validator,this.value)].map(v6)}static simplifyModel(Z){let $="schema"in Z?Z.schema:Z;try{return o.Create($)}catch{return $}}get model(){return Z1.simplifyModel(this.validator)}toResponse(Z){return new Response(this.message,{status:400,headers:{...Z,"content-type":"application/json"}})}}var jJ=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,RJ=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,_J=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,JK=G5.date,zK=G5["date-time"];if(!F1.Has("date"))F1.Set("date",(Z)=>{let $=Z.replace(/"/g,"");if(jJ.test($)||RJ.test($)||_J.test($)||JK($)){let Y=new Date($);if(!Number.isNaN(Y.getTime()))return!0}return!1});if(!F1.Has("date-time"))F1.Set("date-time",(Z)=>{let $=Z.replace(/"/g,"");if(jJ.test($)||RJ.test($)||_J.test($)||zK($)){let Y=new Date($);if(!Number.isNaN(Y.getTime()))return!0}return!1});Object.entries(G5).forEach((Z)=>{let[$,Y]=Z;if(!F1.Has($)){if(Y instanceof RegExp)F1.Set($,(Q)=>Y.test(Q));else if(typeof Y==="function")F1.Set($,Y)}});var x=Object.assign({},T8),zJ=(Z)=>{if(typeof Z==="string")switch(Z.slice(-1)){case"k":return+Z.slice(0,Z.length-1)*1024;case"m":return+Z.slice(0,Z.length-1)*1048576;default:return+Z}return Z},qJ=(Z,$)=>{if(Z.startsWith($))return!0;return $.charCodeAt($.length-1)===42&&$.charCodeAt($.length-2)===47&&Z.startsWith($.slice(0,-1))},M5=(Z,$)=>{if(!($ instanceof Blob))return!1;if(Z.minSize&&$.size<zJ(Z.minSize))return!1;if(Z.maxSize&&$.size>zJ(Z.maxSize))return!1;if(Z.extension){if(typeof Z.extension==="string")return qJ($.type,Z.extension);for(let Y=0;Y<Z.extension.length;Y++)if(qJ($.type,Z.extension[Y]))return!0;return!1}return!0},qK=CJ("File",M5),UK=CJ("Files",(Z,$)=>{if(!Array.isArray($))return M5(Z,$);if(Z.minItems&&$.length<Z.minItems)return!1;if(Z.maxItems&&$.length>Z.maxItems)return!1;for(let Y=0;Y<$.length;Y++)if(!M5(Z,$[Y]))return!1;return!0});if(!F1.Has("numeric"))F1.Set("numeric",(Z)=>!!Z&&!isNaN(+Z));if(!F1.Has("integer"))F1.Set("integer",(Z)=>!!Z&&Number.isInteger(+Z));if(!F1.Has("boolean"))F1.Set("boolean",(Z)=>Z==="true"||Z==="false");if(!F1.Has("ObjectString"))F1.Set("ObjectString",(Z)=>{let $=Z.charCodeAt(0);if($===9||$===10||$===32)$=Z.trimStart().charCodeAt(0);if($!==123&&$!==91)return!1;try{return JSON.parse(Z),!0}catch{return!1}});if(!F1.Has("ArrayString"))F1.Set("ArrayString",(Z)=>{let $=Z.charCodeAt(0);if($===9||$===10||$===32)$=Z.trimStart().charCodeAt(0);if($!==123&&$!==91)return!1;try{return JSON.parse(Z),!0}catch{return!1}});if(!r1.Has("UnionEnum"))r1.Set("UnionEnum",(Z,$)=>{return(typeof $==="number"||typeof $==="string"||$===null)&&Z.enum.includes($)});var S6={Numeric:(Z)=>{let $=T8.Number(Z);return x.Transform(x.Union([x.String({format:"numeric",default:0}),x.Number(Z)],Z)).Decode((Y)=>{let Q=+Y;if(isNaN(Q))return Y;if(Z&&!o.Check($,Q))throw new Z1("property",$,Q);return Q}).Encode((Y)=>Y)},Integer:(Z)=>{let $=T8.Integer(Z);return x.Transform(x.Union([x.String({format:"integer",default:0}),T8.Integer(Z)],Z)).Decode((Y)=>{let Q=+Y;if(!o.Check($,Q))throw new Z1("property",$,Q);return Q}).Encode((Y)=>Y)},Date:(Z)=>{let $=T8.Date(Z),Y=Z?.default?new Date(Z.default):void 0;return x.Transform(x.Union([T8.Date(Z),x.String({format:"date",default:Y?.toISOString()}),x.String({format:"date-time",default:Y?.toISOString()}),x.Number({default:Y?.getTime()})],Z)).Decode((Q)=>{if(typeof Q==="number"){let W=new Date(Q);if(!o.Check($,W))throw new Z1("property",$,W);return W}if(Q instanceof Date)return Q;let X=new Date(Q);if(!X||isNaN(X.getTime()))throw new Z1("property",$,X);if(!o.Check($,X))throw new Z1("property",$,X);return X}).Encode((Q)=>Q.toISOString())},BooleanString:(Z)=>{let $=T8.Boolean(Z);return x.Transform(x.Union([x.Boolean(Z),x.String({format:"boolean",default:!1})],Z)).Decode((Y)=>{if(typeof Y==="string")return Y==="true";if(Y!==void 0&&!o.Check($,Y))throw new Z1("property",$,Y);return Y}).Encode((Y)=>Y)},ObjectString:(Z,$)=>{let Y=x.Object(Z,$),Q=JSON.stringify(o.Create(Y)),X;try{X=k8.Compile(Y)}catch{}return x.Transform(x.Union([x.String({format:"ObjectString",default:Q}),Y])).Decode((W)=>{if(typeof W==="string"){if(W.charCodeAt(0)!==123)throw new Z1("property",Y,W);try{W=JSON.parse(W)}catch{throw new Z1("property",Y,W)}if(X){if(!X.Check(W))throw new Z1("property",Y,W);return X.Decode(W)}if(!o.Check(Y,W))throw new Z1("property",Y,W);return o.Decode(Y,W)}return W}).Encode((W)=>{if(typeof W==="string")try{W=JSON.parse(W)}catch{throw new Z1("property",Y,W)}if(!o.Check(Y,W))throw new Z1("property",Y,W);return JSON.stringify(W)})},ArrayString:(Z=x.String(),$)=>{let Y=x.Array(Z,$),Q;try{Q=k8.Compile(Y)}catch{}let X=(W,J=!1)=>{if(W.charCodeAt(0)===91){try{W=JSON.parse(W)}catch{throw new Z1("property",Y,W)}if(Q){if(!Q.Check(W))throw new Z1("property",Y,W);return Q.Decode(W)}if(!o.Check(Y,W))throw new Z1("property",Y,W);return o.Decode(Y,W)}if(W.indexOf(",")!==-1){let z=W.split(",").map((q)=>q.trim());if(Q){if(!Q.Check(z))throw new Z1("property",Y,W);return Q.Decode(z)}if(!o.Check(Y,z))throw new Z1("property",Y,z);return o.Decode(Y,z)}if(J)return W;throw new Z1("property",Y,W)};return x.Transform(x.Union([x.String({format:"ArrayString",default:$?.default}),Y])).Decode((W)=>{if(Array.isArray(W)){let J=[];for(let z=0;z<W.length;z++){let q=W[z];if(typeof q==="string"){let U=X(q,!0);if(Array.isArray(U))J=J.concat(U);else J.push(U);continue}J.push(q)}return J}if(typeof W==="string")return X(W);return W}).Encode((W)=>{if(typeof W==="string")try{W=JSON.parse(W)}catch{throw new Z1("property",Y,W)}if(!o.Check(Y,W))throw new Z1("property",Y,W);return JSON.stringify(W)})},File:qK,Files:(Z={})=>x.Transform(UK(Z)).Decode(($)=>{if(Array.isArray($))return $;return[$]}).Encode(($)=>$),Nullable:(Z,$)=>x.Union([Z,x.Null()],$),MaybeEmpty:(Z,$)=>x.Union([Z,x.Null(),x.Undefined()],$),Cookie:(Z,{domain:$,expires:Y,httpOnly:Q,maxAge:X,path:W,priority:J,sameSite:z,secure:q,secrets:U,sign:w,...M}={})=>{let S=x.Object(Z,M);return S.config={domain:$,expires:Y,httpOnly:Q,maxAge:X,path:W,priority:J,sameSite:z,secure:q,secrets:U,sign:w},S},UnionEnum:(Z,$={})=>{let Y=Z.every((Q)=>typeof Q==="string")?{type:"string"}:Z.every((Q)=>typeof Q==="number")?{type:"number"}:Z.every((Q)=>Q===null)?{type:"null"}:{};if(Z.some((Q)=>typeof Q==="object"&&Q!==null))throw new Error("This type does not support objects or arrays");return{default:Z[0],...$,[N]:"UnionEnum",...Y,enum:Z}}};x.BooleanString=S6.BooleanString;x.ObjectString=S6.ObjectString;x.ArrayString=S6.ArrayString;x.Numeric=S6.Numeric;x.Integer=S6.Integer;x.File=(Z={})=>S6.File({default:"File",...Z,extension:Z?.type,type:"string",format:"binary"});x.Files=(Z={})=>S6.Files({...Z,elysiaMeta:"Files",default:"Files",extension:Z?.type,type:"array",items:{...Z,default:"Files",type:"string",format:"binary"}});x.Nullable=(Z)=>S6.Nullable(Z);x.MaybeEmpty=S6.MaybeEmpty;x.Cookie=S6.Cookie;x.Date=S6.Date;x.UnionEnum=S6.UnionEnum;function CJ(Z,$){if(!r1.Has(Z))r1.Set(Z,$);return(Y={})=>c$({...Y,[N]:Z})}var pZ=(Z)=>{let $=typeof Z==="object"?Z.fn.toString():typeof Z==="string"?Z.toString():Z,Y=$.indexOf(")");if($.charCodeAt(Y+2)===61&&$.charCodeAt(Y+5)!==123)return!0;return $.includes("return")},wK=(Z)=>{if(Z.startsWith("async"))Z=Z.slice(5);Z=Z.trimStart();let $=-1;if(Z.charCodeAt(0)===40){if($=Z.indexOf("=>",Z.indexOf(")")),$!==-1){let X=$;while(X>0)if(Z.charCodeAt(--X)===41)break;let W=Z.slice($+2);if(W.charCodeAt(0)===32)W=W.trimStart();return[Z.slice(1,X),W,{isArrowReturn:W.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test(Z)){if($=Z.indexOf("=>"),$!==-1){let X=Z.slice($+2);if(X.charCodeAt(0)===32)X=X.trimStart();return[Z.slice(0,$),X,{isArrowReturn:X.charCodeAt(0)!==123}]}}if(Z.startsWith("function")){$=Z.indexOf("(");let X=Z.indexOf(")");return[Z.slice($+1,X),Z.slice(X+2),{isArrowReturn:!1}]}let Y=Z.indexOf("(");if(Y!==-1){let X=Z.indexOf(`
`,2),W=Z.slice(0,X),J=W.lastIndexOf(")")+1,z=Z.slice(X+1);return[W.slice(Y,J),"{"+z,{isArrowReturn:!1}]}let Q=Z.split(`
`,2);return[Q[0],Q[1],{isArrowReturn:!1}]},MK=(Z)=>{let $=Z.indexOf("{");if($===-1)return[-1,0];let Y=$+1,Q=1;for(;Y<Z.length;Y++){let X=Z.charCodeAt(Y);if(X===123)Q++;else if(X===125)Q--;if(Q===0)break}if(Q!==0)return[0,Z.length];return[$,Y+1]},GK=(Z)=>{let $=Z.lastIndexOf("}");if($===-1)return[-1,0];let Y=$-1,Q=1;for(;Y>=0;Y--){let X=Z.charCodeAt(Y);if(X===125)Q++;else if(X===123)Q--;if(Q===0)break}if(Q!==0)return[-1,0];return[Y,$+1]},VJ=(Z)=>{while(!0){let $=Z.indexOf(":");if($===-1)break;let Y=Z.indexOf(",",$);if(Y===-1)Y=Z.indexOf("}",$)-1;if(Y===-2)Y=Z.length;Z=Z.slice(0,$)+Z.slice(Y)}return Z},EJ=(Z)=>{let $=!1;if(Z.charCodeAt(0)===40)Z=Z.slice(1,-1);if(Z.charCodeAt(0)===123)$=!0,Z=Z.slice(1,-1);Z=Z.replace(/( |\t|\n)/g,"").trim();let Y=[];while(!0){let[X,W]=MK(Z);if(X===-1)break;if(Y.push(Z.slice(0,X-1)),Z.charCodeAt(W)===44)W++;Z=Z.slice(W)}if(Z=VJ(Z),Z)Y=Y.concat(Z.split(","));let Q=[];for(let X of Y){if(X.indexOf(",")===-1){Q.push(X);continue}for(let W of X.split(","))Q.push(W.trim())}return Y=Q,{hasParenthesis:$,parameters:Y}},BK=(Z,$)=>{let{parameters:Y,hasParenthesis:Q}=EJ(Z);if(!$.query&&Y.includes("query"))$.query=!0;if(!$.headers&&Y.includes("headers"))$.headers=!0;if(!$.body&&Y.includes("body"))$.body=!0;if(!$.cookie&&Y.includes("cookie"))$.cookie=!0;if(!$.set&&Y.includes("set"))$.set=!0;if(!$.server&&Y.includes("server"))$.server=!0;if(!$.request&&Y.includes("request"))$.request=!0;if(!$.route&&Y.includes("route"))$.route=!0;if(Q)return`{ ${Y.join(", ")} }`;return Y.join(", ")},UJ=(Z,$,Y)=>{let Q=$.indexOf(Z+`
`,Y),X=$.indexOf(Z+"\t",Y),W=$.indexOf(Z+",",Y),J=$.indexOf(Z+";",Y),z=$.indexOf(Z+" ",Y);return[Q,X,W,J,z].filter((q)=>q>0).sort((q,U)=>q-U)[0]||-1},IJ=(Z,$,Y=0)=>{if(Y>5)return[];let Q=[],X=$;while(!0){let W=UJ(" = "+Z,X);if(W===-1)W=UJ("="+Z,X);if(W===-1){let U=X.indexOf(" = "+Z);if(U===-1)U=X.indexOf("="+Z);if(U+3+Z.length!==X.length)break;W=U}let J=X.slice(0,W),z=J.lastIndexOf(" "),q=J.slice(z!==-1?z+1:-1);if(q==="}"){let[U,w]=GK(J);Q.push(VJ(X.slice(U,w))),X=X.slice(W+3+Z.length);continue}while(q.charCodeAt(0)===44)q=q.slice(1);while(q.charCodeAt(0)===9)q=q.slice(1);if(!q.includes("("))Q.push(q);X=X.slice(W+3+Z.length)}for(let W of Q){if(W.charCodeAt(0)===123)continue;let J=IJ(W,$);if(J.length>0)Q.push(...J)}return Q},SK=(Z)=>{if(!Z)return;if(Z.charCodeAt(0)!==123)return Z;if(Z=Z.slice(2,-2),!Z.includes(",")){if(Z.includes("..."))return Z.slice(Z.indexOf("...")+3);return}let $=Z.indexOf("...");if($===-1)return;return Z.slice($+3).trimEnd()},HK=(Z,$,Y)=>{let Q=(X,W)=>Z.includes(W+"."+X)||Z.includes(W+'["'+X+'"]')||Z.includes(W+"['"+X+"']");for(let X of $){if(!X)continue;if(X.charCodeAt(0)===123){let W=EJ(X).parameters;if(!Y.query&&W.includes("query"))Y.query=!0;if(!Y.headers&&W.includes("headers"))Y.headers=!0;if(!Y.body&&W.includes("body"))Y.body=!0;if(!Y.cookie&&W.includes("cookie"))Y.cookie=!0;if(!Y.set&&W.includes("set"))Y.set=!0;if(!Y.query&&W.includes("server"))Y.server=!0;if(!Y.request&&W.includes("request"))Y.request=!0;if(!Y.route&&W.includes("route"))Y.route=!0;continue}if(!Y.query&&Q("query",X))Y.query=!0;if(Z.includes("return "+X)||Z.includes("return "+X+".query"))Y.query=!0;if(!Y.headers&&Q("headers",X))Y.headers=!0;if(!Y.body&&Q("body",X))Y.body=!0;if(!Y.cookie&&Q("cookie",X))Y.cookie=!0;if(!Y.set&&Q("set",X))Y.set=!0;if(!Y.server&&Q("server",X))Y.server=!0;if(Y.query&&Y.headers&&Y.body&&Y.cookie&&Y.set&&Y.server&&Y.server&&Y.route)break}return $},DK=(Z,$,Y)=>{try{let Q=new RegExp(`(?:\\w)\\((?:.*)?${Z}`,"gs");Q.test($);let X=$.charCodeAt(Q.lastIndex);if(X===41||X===44)return Y.query=!0,Y.headers=!0,Y.body=!0,Y.cookie=!0,Y.set=!0,Y.server=!0,Y.route=!0,Y.request=!0,!0;return!1}catch(Q){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log($),console.log("--- context ---"),console.log(Z),!0}},xJ=(Z,$={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,request:!1,route:!1})=>{let Y=[];if(Z.handler&&typeof Z.handler==="function")Y.push(Z.handler);if(Z.request?.length)Y.push(...Z.request);if(Z.beforeHandle?.length)Y.push(...Z.beforeHandle);if(Z.parse?.length)Y.push(...Z.parse);if(Z.error?.length)Y.push(...Z.error);if(Z.transform?.length)Y.push(...Z.transform);if(Z.afterHandle?.length)Y.push(...Z.afterHandle);if(Z.mapResponse?.length)Y.push(...Z.mapResponse);if(Z.afterResponse?.length)Y.push(...Z.afterResponse);for(let Q of Y){if(!Q)continue;let X="fn"in Q?Q.fn:Q;if(typeof X!=="function")continue;let[W,J,{isArrowReturn:z}]=wK(X.toString()),q=BK(W,$),U=SK(q);if(U){let w=IJ(U,J.slice(1,-1));w.splice(0,-1,U);let M=J;if(M.charCodeAt(0)===123&&M.charCodeAt(J.length-1)===125)M=M.slice(1,-1);if(!DK(U,M,$))HK(M,w,$);if(!$.query&&M.includes("return "+U+".query"))$.query=!0}if($.query&&$.headers&&$.body&&$.cookie&&$.set&&$.server&&$.request&&$.route)break}return $},S4=[];for(let Z=48;Z<58;Z++)S4[Z]=Z-48;for(let Z=0;Z<6;Z++)S4[Z+65]=S4[Z+97]=Z+10;var AK=(Z,$)=>{if(Z in S4&&$ in S4)return S4[Z]<<4|S4[$];return 255},TJ=[...new Array(128).fill(0),...new Array(16).fill(1),...new Array(16).fill(2),...new Array(32).fill(3),4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4],NK=[0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0],wJ=TJ.map((Z)=>[127,63,63,63,0,31,15,15,15,7,7,7][Z]),y8=(Z)=>{let $=Z.indexOf("%");if($===-1)return Z;let Y=Z.length-3;if($>Y)return null;let Q="",X=0,W=0,J=$,z=12,q;for(;;){if(q=AK(Z.charCodeAt($+1),Z.charCodeAt($+2)),z=NK[z+TJ[q]],z===0)return null;if(z===12){if(Q+=Z.substring(X,J),W=W<<6|q&wJ[q],W>65535)Q+=String.fromCharCode(55232+(W>>10),56320+(W&1023));else Q+=String.fromCharCode(W);if(X=$+3,$=Z.indexOf("%",X),$===-1)return Q+Z.substring(X);if($>Y)return null;J=$,W=0}else{if($+=3,$>Y||Z.charCodeAt($)!==37)return null;W=W<<6|q&wJ[q]}}};class $Z{name;jar;initial;constructor(Z,$,Y={}){this.name=Z,this.jar=$,this.initial=Y}get cookie(){return this.jar[this.name]??this.initial}set cookie(Z){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=Z}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie(Z){this.cookie=Z}get value(){return this.cookie.value}set value(Z){this.setCookie.value=Z}get expires(){return this.cookie.expires}set expires(Z){this.setCookie.expires=Z}get maxAge(){return this.cookie.maxAge}set maxAge(Z){this.setCookie.maxAge=Z}get domain(){return this.cookie.domain}set domain(Z){this.setCookie.domain=Z}get path(){return this.cookie.path}set path(Z){this.setCookie.path=Z}get secure(){return this.cookie.secure}set secure(Z){this.setCookie.secure=Z}get httpOnly(){return this.cookie.httpOnly}set httpOnly(Z){this.setCookie.httpOnly=Z}get sameSite(){return this.cookie.sameSite}set sameSite(Z){this.setCookie.sameSite=Z}get priority(){return this.cookie.priority}set priority(Z){this.setCookie.priority=Z}get partitioned(){return this.cookie.partitioned}set partitioned(Z){this.setCookie.partitioned=Z}get secrets(){return this.cookie.secrets}set secrets(Z){this.setCookie.secrets=Z}update(Z){return this.setCookie=Object.assign(this.cookie,typeof Z==="function"?Z(this.cookie):Z),this}set(Z){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof Z==="function"?Z(this.cookie):Z),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var MJ=(Z,$,Y)=>{if(!Z.cookie)Z.cookie={};return new Proxy($,{get(Q,X){if(X in $)return new $Z(X,Z.cookie,Object.assign({},Y??{},$[X]));return new $Z(X,Z.cookie,Object.assign({},Y))}})},bJ=async(Z,$,{secrets:Y,sign:Q,...X}={})=>{if(!$)return MJ(Z,{},X);let W=typeof Y==="string";if(Q&&Q!==!0&&!Array.isArray(Q))Q=[Q];let J={},z=G9.parse($);for(let[q,U]of Object.entries(z)){if(U===void 0)continue;let w=y8(U);if(Q===!0||Q?.includes(q)){if(!Y)throw new Error("No secret is provided to cookie plugin");if(W){let M=await QJ(w,Y);if(M===!1)throw new w5(q);w=M}else{let M=!0;for(let S=0;S<Y.length;S++){let G=await QJ(w,Y[S]);if(G!==!1){M=!0,w=G;break}}if(!M)throw new w5(q)}}J[q]={value:w}}return MJ(Z,J,X)},kJ=(Z)=>{if(!Z||!B6(Z))return;let $=[];for(let[Y,Q]of Object.entries(Z)){if(!Y||!Q)continue;let X=Q.value;if(X===void 0||X===null)continue;$.push(G9.serialize(Y,typeof X==="object"?JSON.stringify(X):X+"",Q))}if($.length===0)return;if($.length===1)return $[0];return $},v8=(Z,$)=>{let Y=Z.size;if(!$&&Y||Y&&$&&$.status!==206&&$.status!==304&&$.status!==412&&$.status!==416){if($){if($.headers instanceof Headers){let Q={"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"};if(W9)Q=$.headers.toJSON();else{Q={};for(let[X,W]of $.headers.entries())if(X in $.headers)Q[X]=W}return new Response(Z,{status:$.status,headers:Q})}if(B6($.headers))return new Response(Z,{status:$.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"},$.headers)})}return new Response(Z,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"}})}return new Response(Z)},gJ=(Z,$)=>{if(!Z)return Z;Z.delete("set-cookie");for(let Y=0;Y<$.length;Y++){let Q=$[Y].indexOf("=");Z.append("set-cookie",`${$[Y].slice(0,Q)}=${$[Y].slice(Q+1)||""}`)}return Z},H4=(Z,$)=>{if($?.headers){if(Z){if(W9)Object.assign($.headers,Z.headers.toJSON());else for(let[Y,Q]of Z.headers.entries())if(Y in $.headers)$.headers[Y]=Q}if($.status===200)$.status=Z.status;if($.headers["content-encoding"])delete $.headers["content-encoding"];return $}if(!Z)return{headers:{},status:$?.status??200};if(W9){if($={headers:Z.headers.toJSON(),status:$?.status??200},$.headers["content-encoding"])delete $.headers["content-encoding"];return $}$={headers:{},status:$?.status??200};for(let[Y,Q]of Z.headers.entries()){if(Y==="content-encoding")continue;if(Y in $.headers)$.headers[Y]=Q}return $},G6=async(Z,$,Y)=>{let Q=Z.next();if(Q instanceof Promise)Q=await Q;if(Q.done){if($)return d0(Q.value,$,Y);return d8(Q.value,Y)}if($?.headers){if(!$.headers["transfer-encoding"])$.headers["transfer-encoding"]="chunked";if(!$.headers["content-type"])$.headers["content-type"]="text/event-stream; charset=utf-8"}else $={status:200,headers:{"content-type":"text/event-stream; charset=utf-8","transfer-encoding":"chunked"}};return new Response(new ReadableStream({async start(X){let W=!1;if(Y?.signal?.addEventListener("abort",()=>{W=!0;try{X.close()}catch{}}),Q.value!==void 0&&Q.value!==null)if(typeof Q.value==="object")try{X.enqueue(Buffer.from(JSON.stringify(Q.value)))}catch{X.enqueue(Buffer.from(Q.value.toString()))}else X.enqueue(Buffer.from(Q.value.toString()));for await(let J of Z){if(W)break;if(J===void 0||J===null)continue;if(typeof J==="object")try{X.enqueue(Buffer.from(JSON.stringify(J)))}catch{X.enqueue(Buffer.from(J.toString()))}else X.enqueue(Buffer.from(J.toString()));await new Promise((z)=>setTimeout(()=>z(),0))}try{X.close()}catch{}}}),$)};async function*D4(Z){let $=Z.body;if(!$)return;let Y=$.getReader(),Q=new TextDecoder;try{while(!0){let{done:X,value:W}=await Y.read();if(X)break;yield Q.decode(W)}}finally{Y.releaseLock()}}var fJ=(Z)=>{if(typeof Z.status==="string")Z.status=w9[Z.status];if(Z.cookie&&B6(Z.cookie)){let $=kJ(Z.cookie);if($)Z.headers["set-cookie"]=$}if(Z.headers["set-cookie"]&&Array.isArray(Z.headers["set-cookie"]))Z.headers=gJ(new Headers(Z.headers),Z.headers["set-cookie"])},U9=(Z,$)=>{if(Z.status!==$.status&&$.status!==200&&(Z.status<=300||Z.status>400))Z=new Response(Z.body,{headers:Z.headers,status:$.status});let Y=!1;if($.headers instanceof Headers)for(let Q of $.headers.keys())if(Q==="set-cookie"){if(Y)continue;Y=!0;for(let X of $.headers.getSetCookie())Z.headers.append("set-cookie",X)}else Z.headers.append(Q,$.headers?.get(Q)??"");else for(let Q in $.headers)Z.headers.append(Q,$.headers[Q]);return Z},d0=(Z,$,Y)=>{if(B6($.headers)||$.status!==200||$.cookie)switch(fJ($),Z?.constructor?.name){case"String":return new Response(Z,$);case"Array":case"Object":return Response.json(Z,$);case"ElysiaFile":return v8(Z.value);case"Blob":return v8(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,d0(Z.response,$,Y);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return new Response("",$);return Response.json(Z,$);case"Response":if(Z=U9(Z,$),!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z,$),Y);return Z;case"Error":return h8(Z,$);case"Promise":return Z.then((Q)=>d0(Q,$,Y));case"Function":return d0(Z(),$,Y);case"Number":case"Boolean":return new Response(Z.toString(),$);case"Cookie":if(Z instanceof $Z)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z,$);default:if(Z instanceof Response){if(Z=U9(Z,$),Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z,$),Y);return Z}if(Z instanceof Promise)return Z.then((Q)=>d0(Q,$));if(Z instanceof Error)return h8(Z,$);if(Z instanceof d6)return $.status=Z.code,d0(Z.response,$,Y);if(typeof Z?.next==="function")return G6(Z,$,Y);if(typeof Z?.then==="function")return Z.then((Q)=>d0(Q,$));if(typeof Z?.toResponse==="function")return d0(Z.toResponse(),$);if("charCodeAt"in Z){let Q=Z.charCodeAt(0);if(Q===123||Q===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}if(Z instanceof Response&&!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z,$),Y);if(typeof Z?.next==="function"||Z instanceof ReadableStream)return G6(Z,$,Y);return d8(Z,Y)},g0=(Z,$,Y)=>{if(Z===void 0||Z===null)return;if(B6($.headers)||$.status!==200||$.cookie)switch(fJ($),Z?.constructor?.name){case"String":return new Response(Z,$);case"Array":case"Object":return Response.json(Z,$);case"ElysiaFile":return v8(Z.value);case"Blob":return v8(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,g0(Z.response,$,Y);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return;return Response.json(Z,$);case"Response":if(Z=U9(Z,$),!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z,$),Y);return Z;case"Promise":return Z.then((Q)=>g0(Q,$));case"Error":return h8(Z,$);case"Function":return g0(Z(),$);case"Number":case"Boolean":return new Response(Z.toString(),$);case"FormData":return new Response(Z);case"Cookie":if(Z instanceof $Z)return new Response(Z.value,$);return new Response(Z?.toString(),$);default:if(Z instanceof Response){if(Z=U9(Z,$),Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z,$),Y);return Z}if(Z instanceof Promise)return Z.then((Q)=>g0(Q,$));if(Z instanceof Error)return h8(Z,$);if(Z instanceof d6)return $.status=Z.code,g0(Z.response,$,Y);if(typeof Z?.next==="function")return G6(Z,$,Y);if(typeof Z?.then==="function")return Z.then((Q)=>g0(Q,$));if(typeof Z?.toResponse==="function")return g0(Z.toResponse(),$);if("charCodeAt"in Z){let Q=Z.charCodeAt(0);if(Q===123||Q===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}else switch(Z?.constructor?.name){case"String":return new Response(Z);case"Array":case"Object":return Response.json(Z,$);case"ElysiaFile":return v8(Z.value);case"Blob":return v8(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,g0(Z.response,$,Y);case"ReadableStream":return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z),Y);return Z;case"Promise":return Z.then((Q)=>{let X=g0(Q,$);if(X!==void 0)return X});case"Error":return h8(Z,$);case"Function":return d8(Z(),Y);case"Number":case"Boolean":return new Response(Z.toString());case"Cookie":if(Z instanceof $Z)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Q)=>g0(Q,$));if(Z instanceof Error)return h8(Z,$);if(Z instanceof d6)return $.status=Z.code,g0(Z.response,$,Y);if(typeof Z?.next==="function")return G6(Z,$,Y);if(typeof Z?.then==="function")return Z.then((Q)=>g0(Q,$));if(typeof Z?.toResponse==="function")return g0(Z.toResponse(),$);if("charCodeAt"in Z){let Q=Z.charCodeAt(0);if(Q===123||Q===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z)}},d8=(Z,$)=>{switch(Z?.constructor?.name){case"String":return new Response(Z);case"Object":case"Array":return Response.json(Z);case"ElysiaFile":return v8(Z.value);case"Blob":return v8(Z);case"ElysiaCustomStatusResponse":return d0(Z.response,{status:Z.code,headers:{}});case"ReadableStream":return $?.signal?.addEventListener("abort",{handleEvent(){if($?.signal&&!$?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(Z.headers.get("transfer-encoding")==="chunked")return G6(D4(Z),H4(Z),$);return Z;case"Error":return h8(Z);case"Promise":return Z.then((Y)=>d8(Y,$));case"Function":return d8(Z(),$);case"Number":case"Boolean":return new Response(Z.toString());case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Y)=>d8(Y,$));if(Z instanceof Error)return h8(Z);if(Z instanceof d6)return d0(Z.response,{status:Z.code,headers:{}});if(typeof Z?.next==="function")return G6(Z,void 0,$);if(typeof Z?.then==="function")return Z.then((Y)=>d0(Y,set));if(typeof Z?.toResponse==="function")return d8(Z.toResponse());if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91)return new Response(JSON.stringify(Z),{headers:{"Content-Type":"application/json"}})}return new Response(Z)}},h8=(Z,$)=>new Response(JSON.stringify({name:Z?.name,message:Z?.message,cause:Z?.cause}),{status:$?.status!==200?$?.status??500:500,headers:$?.headers}),LK=(Z,$,Y={})=>{if(typeof Z==="function")return;let Q=d0(Z,{headers:Y});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length)return Q.clone.bind(Q)},Q9={name:"web-standard",isWebStandard:!0,handler:{mapResponse:d0,mapEarlyResponse:g0,mapCompactResponse:d8,createStaticHandler:LK},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`,parser:{json(Z){if(Z)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData(Z){let $=`
c.body={}
`;if(Z)$+="let form;try{form=await c.request.formData()}catch{}";else $+=`const form=await c.request.formData()
`;return $+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},composeGeneralHandler:{parameters:"r",createContext(Z){let $="",Y="",Q=Z.setHeaders;for(let J of Object.keys(Z.singleton.decorator))$+=`,${J}: decorator['${J}']`;let X=Z.config.handler?.standardHostname??!0,W=!!Z.event.trace?.length;if(Y+=`const u=r.url,s=u.indexOf('/',${X?11:7}),qi=u.indexOf('?', s + 1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,W)Y+=`const id=randomId()
`;if(Y+="const c={request:r,store,qi,path:p,url:u,redirect,error,set:{headers:",Y+=Object.keys(Q??{}).length?"Object.assign({}, app.setHeaders)":"{}",Y+=",status:200}",Z.inference.server)Y+=",get server(){return app.getServer()}";if(W)Y+=",[ELYSIA_REQUEST_ID]:id";return Y+=$,Y+=`}
`,Y},websocket(Z){let $="",Y=Z.router.static.ws,Q=Z.router.http;if(Q.build(),Object.keys(Y).length||Q.root.ws||Q.history.find((X)=>X["0"]==="ws")){$+="if(r.method==='GET'){switch(p){";for(let[X,W]of Object.entries(Y))$+=`case'${X}':`+(Z.config.strictPath!==!0?`case'${a4(X)}':`:"")+`if(r.headers.get('upgrade')==='websocket')return ht[${W}].composed(c)
`;$+=`default:if(r.headers.get('upgrade')==='websocket'){const route=router.find('ws',p)
if(route){c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)}}break}}`}return $},error404(Z,$){let Y="if(route===null)return ";if($)Y+=`app.handleError(c,notFound,false,${this.parameters})`;else Y+=Z?"new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"error404.clone()";return{declare:$?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:Y}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw new Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}},OK=(Z,$,Y={})=>{if(typeof Z==="function"||Z instanceof Blob)return;if(typeof Z==="object"&&Z?.toString()==="[object HTMLBundle]")return()=>Z;let Q=d0(Z,{headers:Y});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length){if(!Q.headers.has("content-type"))Q.headers.append("content-type","text/plain;charset=utf-8");return Q.clone.bind(Q)}},GJ={open(Z){Z.data.open?.(Z)},message(Z,$){Z.data.message?.(Z,$)},drain(Z){Z.data.drain?.(Z)},close(Z,$,Y){Z.data.close?.(Z,$,Y)}};class mZ{raw;data;body;validator;["~types"];get id(){return this.data.id}constructor(Z,$,Y=void 0){this.raw=Z,this.data=$,this.body=Y,this.validator=Z.data?.validator,this.sendText=Z.sendText.bind(Z),this.sendBinary=Z.sendBinary.bind(Z),this.close=Z.close.bind(Z),this.terminate=Z.terminate.bind(Z),this.publishText=Z.publishText.bind(Z),this.publishBinary=Z.publishBinary.bind(Z),this.subscribe=Z.subscribe.bind(Z),this.unsubscribe=Z.unsubscribe.bind(Z),this.isSubscribed=Z.isSubscribed.bind(Z),this.cork=Z.cork.bind(Z),this.remoteAddress=Z.remoteAddress,this.binaryType=Z.binaryType,this.data=Z.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send(Z,$){if(Buffer.isBuffer(Z))return this.raw.send(Z,$);if(this.validator?.Check(Z)===!1)return this.raw.send(new Z1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.send(Z,$)}ping(Z){if(Buffer.isBuffer(Z))return this.raw.ping(Z);if(this.validator?.Check(Z)===!1)return this.raw.send(new Z1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.ping(Z)}pong(Z){if(Buffer.isBuffer(Z))return this.raw.pong(Z);if(this.validator?.Check(Z)===!1)return this.raw.send(new Z1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.pong(Z)}publish(Z,$,Y){if(Buffer.isBuffer($))return this.raw.publish(Z,$,Y);if(this.validator?.Check($)===!1)return this.raw.send(new Z1("message",this.validator,$).message);if(typeof $==="object")$=JSON.stringify($);return this.raw.publish(Z,$,Y)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}}var FK=(Z)=>{let $=typeof Z==="function"?[Z]:Z;return async function Y(Q,X){if(typeof X==="string"){let W=X?.charCodeAt(0);if(W===34||W===47||W===91||W===123)try{X=JSON.parse(X)}catch{}else if(B5(X))X=+X;else if(X==="true")X=!0;else if(X==="false")X=!1;else if(X==="null")X=null}if($)for(let W=0;W<$.length;W++){let J=$[W](Q,X);if(J instanceof Promise)J=await J;if(J!==void 0)return J}return X}},KK=(Z)=>{let $=(Y,Q)=>{if(Q instanceof Promise)return Q.then((J)=>$(Y,J));if(Buffer.isBuffer(Q))return Y.send(Q.toString());if(Q===void 0)return;let X=(J)=>{if(Z?.Check(J)===!1)return Y.send(new Z1("message",Z,J).message);if(typeof J==="object")return Y.send(JSON.stringify(J));Y.send(J)};if(typeof Q?.next!=="function")return void X(Q);let W=Q.next();if(W instanceof Promise)return(async()=>{let J=await W;if(Z?.Check(J)===!1)return Y.send(new Z1("message",Z,J).message);if(X(J.value),!J.done)for await(let z of Q)X(z)})();if(X(W.value),!W.done)for(let J of Q)X(J)};return $},PK={...Q9,name:"bun",handler:{...Q9.handler,createNativeStaticHandler:OK},composeHandler:{...Q9.composeHandler,headers:W9?`c.headers = c.request.headers.toJSON()
`:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`},listen(Z){return($,Y)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(Z.compile(),typeof $==="string"){if(!B5($))throw new Error("Port must be a numeric value");$=parseInt($)}let Q=Z.fetch,X=typeof $==="object"?{development:!q9,reusePort:!0,...Z.config.serve||{},...$||{},static:{...Z.router.static.http.static,...Z.config.serve?.static},websocket:{...Z.config.websocket||{},...GJ||{}},fetch:Q,error:Z.outerErrorHandler}:{development:!q9,reusePort:!0,...Z.config.serve||{},static:Z.router.static.http.static,websocket:{...Z.config.websocket||{},...GJ||{}},port:$,fetch:Q,error:Z.outerErrorHandler};if(Z.server=Bun?.serve(X),Z.event.start)for(let W=0;W<Z.event.start.length;W++)Z.event.start[W].fn(Z);if(Y)Y(Z.server);process.on("beforeExit",()=>{if(Z.server){if(Z.server.stop?.(),Z.server=null,Z.event.stop)for(let W=0;W<Z.event.stop.length;W++)Z.event.stop[W].fn(Z)}}),Z.promisedModules.then(()=>{Bun?.gc(!1)})}},ws(Z,$,Y){let{parse:Q,body:X,response:W,...J}=Y,z=y0(X,{modules:Z.definitions.typebox,models:Z.definitions.type,normalize:Z.config.normalize}),q=y0(W,{modules:Z.definitions.typebox,models:Z.definitions.type,normalize:Z.config.normalize});Z.route("$INTERNALWS",$,async(U)=>{let w=Z.getServer(),{set:M,path:S,qi:G,headers:L,query:B,params:P}=U;if(U.validator=q,Y.upgrade){if(typeof Y.upgrade==="function"){let v=Y.upgrade(U);if(v instanceof Promise)await v}else if(Y.upgrade)Object.assign(M.headers,Y.upgrade)}if(M.cookie&&B6(M.cookie)){let v=kJ(M.cookie);if(v)M.headers["set-cookie"]=v}if(M.headers["set-cookie"]&&Array.isArray(M.headers["set-cookie"]))M.headers=gJ(new Headers(M.headers),M.headers["set-cookie"]);let I=KK(q),n=FK(Q),s,A1=[...Array.isArray(Y.error)?Y.error:[Y.error],...(Z.event.error??[]).map((v)=>typeof v==="function"?v:v.fn)],E1=!A1.length?()=>{}:async(v,k)=>{for(let g of A1){let V=g(Object.assign(U,{error:k}));if(V instanceof Promise)V=await V;if(await I(v,V),V)break}};if(w?.upgrade(U.request,{headers:B6(M.headers)?M.headers:void 0,data:{...U,get id(){if(s)return s;return s=OJ()},validator:q,ping(v){Y.ping?.(v)},pong(v){Y.pong?.(v)},open(v){try{I(v,Y.open?.(new mZ(v,U)))}catch(k){E1(v,k)}},message:async(v,k)=>{let g=await n(v,k);if(z?.Check(g)===!1)return void v.send(new Z1("message",z,g).message);try{I(v,Y.message?.(new mZ(v,U,g),g))}catch(V){E1(v,V)}},drain(v){try{I(v,Y.drain?.(new mZ(v,U)))}catch(k){E1(v,k)}},close(v,k,g){try{I(v,Y.close?.(new mZ(v,U),k,g))}catch(V){E1(v,V)}}}}))return;return M.status=400,"Expected a websocket connection"},{...J,websocket:Y})}},jK=typeof Bun!=="undefined",BJ=jK?Bun.env:typeof process!=="undefined"&&process?.env?process.env:{},e4=/\+/g;function RK(Z){let $={};if(typeof Z!=="string")return $;let Y="",Q="",X=-1,W=-1,J=0,z=Z.length;for(let q=0;q<z;q++)switch(Z.charCodeAt(q)){case 38:let U=W>X;if(!U)W=q;if(Y=Z.slice(X+1,W),U||Y.length>0){if(J&1)Y=Y.replace(e4," ");if(J&2)Y=y8(Y)||Y;if(!$[Y]){if(U){if(Q=Z.slice(W+1,q),J&4)Q=Q.replace(e4," ");if(J&8)Q=y8(Q)||Q}$[Y]=Q}}Y="",Q="",X=q,W=q,J=0;break;case 61:if(W<=X)W=q;else J|=8;break;case 43:if(W>X)J|=4;else J|=1;break;case 37:if(W>X)J|=8;else J|=2;break}if(X<z){let q=W>X;if(Y=Z.slice(X+1,q?W:z),q||Y.length>0){if(J&1)Y=Y.replace(e4," ");if(J&2)Y=y8(Y)||Y;if(!$[Y]){if(q){if(Q=Z.slice(W+1,z),J&4)Q=Q.replace(e4," ");if(J&8)Q=y8(Q)||Q}$[Y]=Q}}}return $}var X9=(Z)=>{let $={};if(typeof Z!=="string")return $;let Y=Z.length,Q="",X="",W=-1,J=-1,z=!1,q=!1,U=!1,w=!1,M=!1,S=0;for(let G=0;G<Y+1;G++){if(G!==Y)S=Z.charCodeAt(G);else S=38;switch(S){case 38:{if(M=J>W,!M)J=G;if(Q=Z.slice(W+1,J),M||Q.length>0){if(U)Q=Q.replace(e4," ");if(z)Q=y8(Q)||Q;if(M){if(X=Z.slice(J+1,G),w)X=X.replace(e4," ");if(q)X=y8(X)||X}let L=$[Q];if(L===void 0)$[Q]=X;else if(L.pop)L.push(X);else $[Q]=[L,X]}X="",W=G,J=G,z=!1,q=!1,U=!1,w=!1;break}case 61:if(J<=W)J=G;else q=!0;break;case 43:if(J>W)w=!0;else U=!0;break;case 37:if(J>W)q=!0;else z=!0;break}}return $},H5=Symbol("ElysiaTrace"),A8=()=>{let{promise:Z,resolve:$}=Promise.withResolvers(),{promise:Y,resolve:Q}=Promise.withResolvers(),{promise:X,resolve:W}=Promise.withResolvers(),J=[],z=[];return[(q)=>{if(q)J.push(q);return Z},(q)=>{let U=[],w=[],M=null;for(let G=0;G<(q.total??0);G++){let{promise:L,resolve:B}=Promise.withResolvers(),{promise:P,resolve:I}=Promise.withResolvers(),{promise:n,resolve:s}=Promise.withResolvers(),A1=[],E1=[];U.push((v)=>{if(v)A1.push(v);return L}),w.push((v)=>{let k={...v,end:P,error:n,index:G,onStop(g){if(g)E1.push(g);return P}};B(k);for(let g=0;g<A1.length;g++)A1[g](k);return(g=null)=>{let V=performance.now();if(g)M=g;let X1={end:V,error:g,get elapsed(){return V-v.begin}};for(let N1=0;N1<E1.length;N1++)E1[N1](X1);I(V),s(g)}})}let S={...q,end:Y,error:X,onEvent(G){for(let L=0;L<U.length;L++)U[L](G)},onStop(G){if(G)z.push(G);return Y}};$(S);for(let G=0;G<J.length;G++)J[G](S);return{resolveChild:w,resolve(G=null){let L=performance.now();if(!G&&M)G=M;let B={end:L,error:G,get elapsed(){return L-q.begin}};for(let P=0;P<z.length;P++)z[P](B);Q(L),W(G)}}}]},_K=(Z)=>{return($)=>{let[Y,Q]=A8(),[X,W]=A8(),[J,z]=A8(),[q,U]=A8(),[w,M]=A8(),[S,G]=A8(),[L,B]=A8(),[P,I]=A8(),[n,s]=A8();return Z({id:$[M9],context:$,set:$.set,onRequest:Y,onParse:X,onTransform:J,onBeforeHandle:q,onHandle:w,onAfterHandle:S,onMapResponse:P,onAfterResponse:n,onError:L}),{request:Q,parse:W,transform:z,beforeHandle:U,handle:M,afterHandle:G,error:B,mapResponse:I,afterResponse:s}}},A4={optional:Symbol.for("TypeBox.Optional"),kind:Symbol.for("TypeBox.Kind")},y6=(Z)=>{if(!Z)return!1;let $=Z?.schema;if($?.[A4.kind]==="Import")return Z.References().some(y6);return!!$&&A4.optional in $},w0=(Z,$)=>$?Z:"",CK=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],M6=(Z)=>{if(!Z)return!1;let $=Z?.schema??Z;if($[A4.kind]==="Import"&&Z.References())return Z.References().some(M6);if($.anyOf)return $.anyOf.some(M6);if($.someOf)return $.someOf.some(M6);if($.allOf)return $.allOf.some(M6);if($.not)return $.not.some(M6);if($.type==="object"){let Y=$.properties;if("additionalProperties"in $)return $.additionalProperties;if("patternProperties"in $)return!1;for(let Q of Object.keys(Y)){let X=Y[Q];if(X.type==="object"){if(M6(X))return!0}else if(X.anyOf){for(let W=0;W<X.anyOf.length;W++)if(M6(X.anyOf[W]))return!0}return X.additionalProperties}return!1}return!1},D5=({context:Z="c",trace:$=[],addFn:Y})=>{if(!$.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let Q=0;Q<$.length;Q++)Y(`let report${Q}, reportChild${Q}, reportErr${Q}, reportErrChild${Q};let trace${Q} = ${Z}[ELYSIA_TRACE]?.[${Q}] ?? trace[${Q}](${Z});
`);return(Q,{name:X,total:W=0}={})=>{if(!X)X="anonymous";let J=Q==="error"?"reportErr":"report";for(let z=0;z<$.length;z++)Y(`${J}${z} = trace${z}.${Q}({id,event:'${Q}',name:'${X}',begin:performance.now(),total:${W}})
`);return{resolve(){for(let z=0;z<$.length;z++)Y(`${J}${z}.resolve()
`)},resolveChild(z){for(let q=0;q<$.length;q++)Y(`${J}Child${q}=${J}${q}.resolveChild?.shift()?.({id,event:'${Q}',name:'${z}',begin:performance.now()})
`);return(q)=>{for(let U=0;U<$.length;U++)if(q)Y(`if(${q} instanceof Error){${J}Child${U}?.(${q}) }else{${J}Child${U}?.()}`);else Y(`${J}Child${U}?.()
`)}}}}},VK=({injectResponse:Z="",normalize:$=!1,validator:Y,encodeSchema:Q=!1})=>({composeValidation:(X,W=`c.${X}`)=>`c.set.status=422;throw new ValidationError('${X}',validator.${X},${W})`,composeResponseValidation:(X="r")=>{let W=Z+`
`;W+=`if(${X} instanceof ElysiaCustomStatusResponse){c.set.status=${X}.code
${X}=${X}.response}const isResponse=${X} instanceof Response
switch(c.set.status){`;for(let[J,z]of Object.entries(Y.response)){if(W+=`
case ${J}:if(!isResponse){`,$&&"Clean"in z&&!M6(z))W+=`${X}=validator.response['${J}'].Clean(${X})
`;if(Q&&(z.hasTransform||typeof z.Decode==="function"))W+=`${X}=validator.response['${J}'].Encode(${X})
`;W+=`if(validator.response['${J}'].Check(${X})===false){c.set.status=422
throw new ValidationError('response',validator.response['${J}'],${X})}c.set.status = ${J}}
`,W+=`break
`}return W+"}"}}),Oo=Symbol.for("TypeBox.Kind"),f8=(Z,$)=>{if(!$)return;let Y=$.schema??$;if(Y[A4.kind]==="Import")return $.References().some((Q)=>f8(Z,Q));if(Y.type==="object"){let Q=Y.properties;if(!Q)return!1;for(let X of Object.keys(Q)){let W=Q[X];if(Z in W)return!0;if(W.type==="object"){if(f8(Z,W))return!0}else if(W.anyOf){for(let J=0;J<W.anyOf.length;J++)if(f8(Z,W.anyOf[J]))return!0}}return!1}return Z in Y},EK=Symbol.for("TypeBox.Transform"),r0=(Z)=>{if(!Z)return!1;if(Z.$ref&&Z.$defs&&Z.$ref in Z.$defs&&r0(Z.$defs[Z.$ref]))return!0;if(Z.oneOf){for(let $=0;$<Z.oneOf.length;$++)if(r0(Z.oneOf[$]))return!0}if(Z.anyOf){for(let $=0;$<Z.anyOf.length;$++)if(r0(Z.anyOf[$]))return!0}if(Z.allOf){for(let $=0;$<Z.allOf.length;$++)if(r0(Z.allOf[$]))return!0}if(Z.not&&r0(Z.not))return!0;if(Z.type==="object"&&Z.properties){let $=Z.properties;for(let Y of Object.keys($)){let Q=$[Y];if(r0(Q))return!0;if(Q.type==="array"&&Q.items&&r0(Q.items))return!0}}if(Z.type==="array"&&Z.items&&r0(Z.items))return!0;return EK in Z},IK=/(?:return|=>) \S+\(/g,ZZ=(Z)=>{return(Z?.fn??Z).constructor.name==="AsyncFunction"},$0=(Z)=>{let $=Z?.fn??Z;if($.constructor.name==="AsyncFunction")return!0;let Y=$.toString();if(Y.includes("=> response.clone("))return!1;if(Y.includes("await"))return!0;if(Y.includes("async"))return!0;if(Y.includes("=>response.clone("))return!1;return!!Y.match(IK)},Y9=(Z)=>{let $=Z?.fn??Z;return $.constructor.name==="AsyncGeneratorFunction"||$.constructor.name==="GeneratorFunction"},xK=({app:Z,path:$,method:Y,hooks:Q,validator:X,handler:W,allowMeta:J=!1,inference:z,asManifest:q=!1})=>{let U=Z["~adapter"].composeHandler,w=Z["~adapter"].handler,M=typeof W==="function";if(!M){if(W=w.mapResponse(W,{headers:Z.setHeaders??{}}),Q.parse?.length&&Q.transform?.length&&Q.beforeHandle?.length&&Q.afterHandle?.length){if(W instanceof Response)return Function("a","return function(){return a.clone()}")(W);return Function("a","return function(){return a}")(W)}}let S=M?"handler(c)":"handler",G=!!Q.afterResponse?.length,L=!!Q.trace?.length,B="";if(z=xJ(Object.assign({},Q,{handler:W}),z),U.declare){let E=U.declare(z);if(E)B+=E}if(z.server)B+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;X.createBody?.(),X.createQuery?.(),X.createHeaders?.(),X.createParams?.(),X.createCookie?.(),X.createResponse?.();let P=X.body||X.headers||X.params||X.query||X.cookie||X.response,I=z.query||!!X.query,n=Q.parse?.length===1&&Q.parse[0].fn==="none",s=Y!=="$INTERNALWS"&&Y!=="GET"&&Y!=="HEAD"&&(z.body||!!X.body||!!Q.parse?.length)&&!n;if(s)B+=`let isParsing=false
`;let A1=Z.setHeaders,E1=A1&&!!Object.keys(A1).length,v=z.headers||X.headers||U.preferWebstandardHeaders!==!0&&z.body,k=z.cookie||!!X.cookie,g=k?AJ({modules:Z.definitions.typebox,validator:X.cookie,defaultConfig:Z.config.cookie,dynamic:!!Z.config.aot,config:X.cookie?.config??{},models:Z.definitions.type}):void 0,V=g?.config,X1="";if(V?.sign){if(!V.secrets)throw new Error(`t.Cookie required secret which is not set in (${Y}) ${$}.`);let E=!V.secrets?void 0:typeof V.secrets==="string"?V.secrets:V.secrets[0];if(X1+=`const _setCookie = c.set.cookie
if(_setCookie){`,V.sign===!0)X1+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${E}')}`;else for(let R of V.sign)X1+=`if(_setCookie['${R}']?.value){c.set.cookie['${R}'].value=await signCookie(_setCookie['${R}'].value,'${E}')}`;X1+=`}
`}let N1=Z.config.normalize,L1=Z.config.experimental?.encodeSchema,{composeValidation:h1,composeResponseValidation:O8}=VK({normalize:N1,validator:X,encodeSchema:L1});if(v)B+=U.headers;if(L)B+=`const id=c[ELYSIA_REQUEST_ID]
`;let l1=D5({trace:Q.trace,addFn:(E)=>{B+=E}});if(B+="try{",k){let E=(_,m)=>{let l=V?.[_]??m;if(!l)return typeof m==="string"?`${_}:"${m}",`:`${_}:${m},`;if(typeof l==="string")return`${_}:'${l}',`;if(l instanceof Date)return`${_}: new Date(${l.getTime()}),`;return`${_}:${l},`},R=V?`{secrets:${V.secrets!==void 0?typeof V.secrets==="string"?`'${V.secrets}'`:"["+V.secrets.reduce((_,m)=>_+`'${m}',`,"")+"]":"undefined"},sign:${V.sign===!0?!0:V.sign!==void 0?"["+V.sign.reduce((_,m)=>_+`'${m}',`,"")+"]":"undefined"},`+E("domain")+E("expires")+E("httpOnly")+E("maxAge")+E("path","/")+E("priority")+E("sameSite")+E("secure")+"}":"undefined";if(v)B+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${R})
`;else B+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${R})
`}if(I){let E=[];if(X.query&&X.query.schema.type==="object"){let R=X.query.schema.properties;if(!M6(X.query))for(let[_,m]of Object.entries(R)){let l=m,H=l.type==="array"||!!l.anyOf?.some((d)=>d.type==="string"&&d.format==="ArrayString");if(l&&A4.optional in l&&l.type==="array"&&l.items)l=l.items;let{type:C,anyOf:A}=l;E.push({key:_,isArray:H,isNestedObjectArray:H&&l.items?.type==="object"||!!l.items?.anyOf?.some((d)=>d.type==="object"||d.type==="array"),isObject:C==="object"||A?.some((d)=>d.type==="string"&&d.format==="ArrayString"),anyOf:!!A})}}if(!E.length)B+="if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url.slice(c.qi + 1))}";else{B+=`if(c.qi!==-1){let url='&'+c.url.slice(c.qi + 1)
`;let R=0;for(let{key:_,isArray:m,isObject:l,isNestedObjectArray:H,anyOf:C}of E){let A=(R===0?"let ":"")+`memory=url.indexOf('&${_}=')
let a${R}
`;if(m)if(B+=A,H)B+=`while(memory!==-1){const start=memory+${_.length+2}
memory=url.indexOf('&',start)
if(a${R}===undefined)
a${R}=''
else
a${R}+=','
let temp
if(memory===-1)temp=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else temp=decodeURIComponent(url.slice(start, memory).replace(/\\+/g,' '))
const charCode=temp.charCodeAt(0)
if(charCode!==91&&charCode !== 123)
temp='"'+temp+'"'
a${R}+=temp
if(memory===-1)break
memory=url.indexOf('&${_}=',memory)
if(memory===-1)break}try{if(a${R}.charCodeAt(0)===91)a${R} = JSON.parse(a${R})
else
a${R}=JSON.parse('['+a${R}+']')}catch{}
`;else B+=`while(memory!==-1){const start=memory+${_.length+2}
memory=url.indexOf('&',start)
if(a${R}===undefined)a${R}=[]
if(memory===-1){const temp=decodeURIComponent(url.slice(start)).replace(/\\+/g,' ')
if(temp.includes(',')){a${R}=a${R}.concat(temp.split(','))}else{a${R}.push(decodeURIComponent(url.slice(start)).replace(/\\+/g,' '))}
break}else{const temp=decodeURIComponent(url.slice(start, memory)).replace(/\\+/g,' ')
if(temp.includes(',')){a${R}=a${R}.concat(temp.split(','))}else{a${R}.push(temp)}
}memory=url.indexOf('&${_}=',memory)
if(memory===-1) break
}`;else if(l)B+=A+`if(memory!==-1){const start=memory+${_.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${R}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))else a${R}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))if(a${R}!==undefined)try{a${R}=JSON.parse(a${R})}catch{}}`;else{if(B+=A+`if(memory!==-1){const start=memory+${_.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${R}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else{a${R}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))`,C)B+=`
let deepMemory=url.indexOf('&${_}=',memory)
if(deepMemory!==-1){a${R}=[a${R}]
let first=true
while(true){const start=deepMemory+${_.length+2}
if(first)first=false
else deepMemory = url.indexOf('&', start)
let value
if(deepMemory===-1)value=url.slice(start).replace(/\\+/g,' ')
else value=url.slice(start, deepMemory).replace(/\\+/g,' ')
value=decodeURIComponent(value)
if(value===null){if(deepMemory===-1){break}else{continue}}
const vStart=value.charCodeAt(0)
const vEnd=value.charCodeAt(value.length - 1)
if((vStart===91&&vEnd===93)||(vStart===123&&vEnd===125))
try{a${R}.push(JSON.parse(value))}catch{a${R}.push(value)}if(deepMemory===-1)break}}`;B+="}}"}R++,B+=`
`}B+="c.query={"+E.map(({key:_},m)=>`'${_}':a${m}`).join(",")+"}",B+=`} else c.query = {}
`}}let F8=typeof W==="function"&&$0(W),m0=L||Q.afterResponse?.length?"c.response= ":"",a8=k||s||F8||!!Q.parse?.length||!!Q.afterHandle?.some($0)||!!Q.beforeHandle?.some($0)||!!Q.transform?.some($0)||!!Q.mapResponse?.some($0),wY=(typeof W==="function"?Y9(W):!1)||!!Q.beforeHandle?.some(Y9)||!!Q.afterHandle?.some(Y9)||!!Q.transform?.some(Y9),A6=z.cookie||z.set||v||L||X.response||M&&E1||wY,O1=U.mapResponseContext?`,${U.mapResponseContext}`:"";if(L||z.route)B+=`c.route=\`${$}\`
`;let u0=l1("parse",{total:Q.parse?.length});if(s){let E=y6(X.body),R=!!Q.parse?.length||z.body||X.body;if(U.parser.declare)B+=U.parser.declare;B+=`
isParsing=true
`;let _=typeof Q.parse==="string"?Q.parse:Array.isArray(Q.parse)&&Q.parse.length===1?typeof Q.parse[0]==="string"?Q.parse[0]:typeof Q.parse[0].fn==="string"?Q.parse[0].fn:void 0:void 0;if(_&&CK.includes(_)){let m=l1("parse",{total:Q.parse?.length});switch(_){case"json":case"application/json":B+=U.parser.json(E);break;case"text":case"text/plain":B+=U.parser.text(E);break;case"urlencoded":case"application/x-www-form-urlencoded":B+=U.parser.urlencoded(E);break;case"arrayBuffer":case"application/octet-stream":B+=U.parser.arrayBuffer(E);break;case"formdata":case"multipart/form-data":B+=U.parser.formData(E);break;default:if(_[0]in Z["~parser"])B+=v?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",B+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,B+=`let result=parser['${_}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}m.resolve()}else if(R){if(B+=`
`,B+=v?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",B+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,Q.parse?.length)B+=`let used=false
`;let m=l1("parse",{total:Q.parse?.length}),l=!1;if(Q.parse)for(let H=0;H<Q.parse.length;H++){let C=`bo${H}`;if(H!==0)B+=`
if(!used){`;if(typeof Q.parse[H].fn==="string"){let A=m.resolveChild(Q.parse[H].fn);switch(Q.parse[H].fn){case"json":case"application/json":l=!0,B+=U.parser.json(E);break;case"text":case"text/plain":l=!0,B+=U.parser.text(E);break;case"urlencoded":case"application/x-www-form-urlencoded":l=!0,B+=U.parser.urlencoded(E);break;case"arrayBuffer":case"application/octet-stream":l=!0,B+=U.parser.arrayBuffer(E);break;case"formdata":case"multipart/form-data":l=!0,B+=U.parser.formData(E);break;default:B+=`${C}=parser['${Q.parse[H].fn}'](c,contentType)
if(${C} instanceof Promise)${C}=await ${C}
if(${C}!==undefined){c.body=${C};used=true}
`}A()}else{let A=m.resolveChild(Q.parse[H].fn.name);B+=`let ${C}=e.parse[${H}]
${C}=${C}(c,contentType)
if(${C} instanceof Promise)${C}=await ${C}
if(${C}!==undefined){c.body=${C};used=true}`,A()}if(H!==0)B+="}";if(l)break}if(m.resolve(),!l){if(Q.parse?.length)B+=`
if(!used){
if(!contentType) throw new ParseError()
`;B+="switch(contentType){",B+=`case 'application/json':
`+U.parser.json(E)+`break
case 'text/plain':`+U.parser.text(E)+`break
case 'application/x-www-form-urlencoded':`+U.parser.urlencoded(E)+`break
case 'application/octet-stream':`+U.parser.arrayBuffer(E)+`break
case 'multipart/form-data':`+U.parser.formData(E)+`break
`;for(let H of Object.keys(Z["~parser"]))B+=`case '${H}':let bo${H}=parser['${H}'](c,contentType)
if(bo${H} instanceof Promise)bo${H}=await bo${H}
if(bo${H} instanceof ElysiaCustomStatusResponse)throw result
if(bo${H}!==undefined)c.body=bo${H}
break
`;if(Q.parse?.length)B+="}";B+="}"}}B+=`
delete c.contentType`,B+=`
isParsing=false
`}if(u0.resolve(),Q?.transform){let E=l1("transform",{total:Q.transform.length});if(Q.transform.length)B+=`let transformed
`;for(let R=0;R<Q.transform.length;R++){let _=Q.transform[R],m=E.resolveChild(_.fn.name);if(B+=$0(_)?`transformed=await e.transform[${R}](c)
`:`transformed=e.transform[${R}](c)
`,_.subType==="mapDerive")B+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else B+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else Object.assign(c,transformed)
`;m()}E.resolve()}if(X){if(X.headers){if(N1&&"Clean"in X.headers&&!M6(X.headers))B+=`c.headers=validator.headers.Clean(c.headers);
`;if(f8("default",X.headers))for(let[E,R]of Object.entries(o.Default(X.headers.schema,{}))){let _=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(_!==void 0)B+=`c.headers['${E}']??=${_}
`}if(y6(X.headers))B+="if(isNotEmpty(c.headers)){";if(B+="if(validator.headers.Check(c.headers) === false){"+h1("headers")+"}",r0(X.headers.schema))B+=`c.headers=validator.headers.Decode(c.headers)
`;if(y6(X.headers))B+="}"}if(X.params){if(f8("default",X.params))for(let[E,R]of Object.entries(o.Default(X.params.schema,{}))){let _=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(_!==void 0)B+=`c.params['${E}']??=${_}
`}if(B+="if(validator.params.Check(c.params)===false){"+h1("params")+"}",r0(X.params.schema))B+=`c.params=validator.params.Decode(c.params)
`}if(X.query){if(N1&&"Clean"in X.query&&!M6(X.query))B+=`c.query=validator.query.Clean(c.query)
`;if(f8("default",X.query))for(let[E,R]of Object.entries(o.Default(X.query.schema,{}))){let _=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(_!==void 0)B+=`if(c.query['${E}']===undefined)c.query['${E}']=${_}
`}if(y6(X.query))B+="if(isNotEmpty(c.query)){";if(B+="if(validator.query.Check(c.query)===false){"+h1("query")+"}",r0(X.query.schema))B+=`c.query=validator.query.Decode(Object.assign({},c.query))
`;if(y6(X.query))B+="}"}if(X.body){if(N1&&"Clean"in X.body&&!M6(X.body))B+=`c.body=validator.body.Clean(c.body)
`;let E=r0(X.body.schema);if(E||y6(X.body))B+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&isNotEmpty(c.body))
`;if(f8("default",X.body)){let R=X.body.schema,_=o.Default(R,R.type==="object"||R[A4.kind]==="Import"&&R.$defs[R.$ref][A4.kind]==="Object"?{}:void 0),m=typeof _==="object"?JSON.stringify(_):typeof _==="string"?`'${_}'`:_;if(B+="if(validator.body.Check(c.body)===false){",_!==void 0&&_!==null)B+=`if(typeof c.body==='object')c.body=Object.assign(${m},c.body)
else c.body=${m}
`;if(y6(X.body))B+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+h1("body")+"}";else B+="if(validator.body.Check(c.body)===false){"+h1("body")+"}";B+="}"}else if(y6(X.body))B+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+h1("body")+"}";else B+="if(validator.body.Check(c.body)===false){"+h1("body")+"}";if(E)B+=`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`}if(g&&B6(g?.schema?.properties??g?.schema?.schema??{})){if(B+=`const cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,f8("default",g))for(let[E,R]of Object.entries(o.Default(g.schema,{})))B+=`cookieValue['${E}'] = ${typeof R==="object"?JSON.stringify(R):R}
`;if(y6(X.cookie))B+="if(isNotEmpty(c.cookie)){";if(B+="if(validator.cookie.Check(cookieValue)===false){"+h1("cookie","cookieValue")+"}",r0(X.cookie.schema))B+=`for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue)))c.cookie[key].value=value
`;if(y6(X.cookie))B+="}"}}if(Q?.beforeHandle){let E=l1("beforeHandle",{total:Q.beforeHandle.length}),R=!1;for(let _=0;_<Q.beforeHandle.length;_++){let m=Q.beforeHandle[_],l=E.resolveChild(m.fn.name),H=pZ(m);if(m.subType==="resolve"||m.subType==="mapResolve"){if(!R)R=!0,B+=`
let resolved
`;if(B+=$0(m)?`resolved=await e.beforeHandle[${_}](c);
`:`resolved=e.beforeHandle[${_}](c);
`,m.subType==="mapResolve")B+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else{resolved.request = c.request
resolved.store = c.store
resolved.qi = c.qi
resolved.path = c.path
resolved.url = c.url
resolved.redirect = c.redirect
resolved.set = c.set
resolved.error = c.error
c = resolved}`;else B+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else Object.assign(c, resolved)
`}else if(!H)B+=$0(m)?`await e.beforeHandle[${_}](c)
`:`e.beforeHandle[${_}](c)
`,l();else{if(B+=$0(m)?`be=await e.beforeHandle[${_}](c)
`:`be=e.beforeHandle[${_}](c)
`,l("be"),B+="if(be!==undefined){",E.resolve(),Q.afterHandle?.length){l1("handle",{name:M?W.name:void 0}).resolve();let A=l1("afterHandle",{total:Q.afterHandle.length});for(let d=0;d<Q.afterHandle.length;d++){let T=Q.afterHandle[d],h=pZ(T),R1=A.resolveChild(T.fn.name);if(B+=`c.response = be
`,!h)B+=$0(T.fn)?`await e.afterHandle[${d}](c, be)
`:`e.afterHandle[${d}](c, be)
`;else B+=$0(T.fn)?`af = await e.afterHandle[${d}](c)
`:`af = e.afterHandle[${d}](c)
`,B+=`if(af!==undefined) c.response=be=af
`;R1("af")}A.resolve()}if(X.response)B+=O8("be");let C=l1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){B+=`c.response=be
`;for(let A=0;A<Q.mapResponse.length;A++){let d=Q.mapResponse[A],T=C.resolveChild(d.fn.name);B+=`if(mr===undefined){mr=${ZZ(d)?"await ":""}e.mapResponse[${A}](c)
if(mr!==undefined)be=c.response=mr}`,T()}}C.resolve(),B+=X1,B+=`return mapEarlyResponse(${m0}be,c.set${O1})}
`}}E.resolve()}if(Q.afterHandle?.length){let E=l1("handle",{name:M?W.name:void 0});if(Q.afterHandle.length)B+=F8?`let r=c.response=await ${S}
`:`let r=c.response=${S}
`;else B+=F8?`let r=await ${S}
`:`let r=${S}
`;E.resolve();let R=l1("afterHandle",{total:Q.afterHandle.length});for(let m=0;m<Q.afterHandle.length;m++){let l=Q.afterHandle[m],H=pZ(l),C=R.resolveChild(l.fn.name);if(!H)B+=$0(l.fn)?`await e.afterHandle[${m}](c)
`:`e.afterHandle[${m}](c)
`,C();else if(B+=$0(l.fn)?`af=await e.afterHandle[${m}](c)
`:`af=e.afterHandle[${m}](c)
`,C("af"),X.response)B+="if(af!==undefined){",R.resolve(),B+=O8("af"),B+="c.response=af}";else B+="if(af!==undefined){",R.resolve(),B+="c.response=af}"}if(R.resolve(),B+=`r=c.response
`,X.response)B+=O8();B+=X1;let _=l1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length)for(let m=0;m<Q.mapResponse.length;m++){let l=Q.mapResponse[m],H=_.resolveChild(l.fn.name);B+=`mr=${ZZ(l)?"await ":""}e.mapResponse[${m}](c)
if(mr!==undefined)r=c.response=mr
`,H()}if(_.resolve(),A6)B+=`return mapResponse(${m0}r,c.set${O1})
`;else B+=`return mapCompactResponse(${m0}r${O1})
`}else{let E=l1("handle",{name:M?W.name:void 0});if(X.response||Q.mapResponse?.length){if(B+=F8?`let r=await ${S}
`:`let r=${S}
`,E.resolve(),X.response)B+=O8();l1("afterHandle").resolve();let R=l1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){B+=`
c.response=r
`;for(let _=0;_<Q.mapResponse.length;_++){let m=Q.mapResponse[_],l=R.resolveChild(m.fn.name);B+=`
if(mr===undefined){mr=${ZZ(m)?"await ":""}e.mapResponse[${_}](c)
if(mr!==undefined)r=c.response=mr}
`,l()}}if(R.resolve(),B+=X1,W instanceof Response)B+=z.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${m0}${S}.clone(),c.set${O1})else return ${S}.clone()`:`return ${S}.clone()`,B+=`
`;else if(A6)B+=`return mapResponse(${m0}r,c.set${O1})
`;else B+=`return mapCompactResponse(${m0}r${O1})
`}else if(k||L){B+=F8?`let r=await ${S}
`:`let r=${S}
`,E.resolve(),l1("afterHandle").resolve();let R=l1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){B+=`c.response= r
`;for(let _=0;_<Q.mapResponse.length;_++){let m=Q.mapResponse[_],l=R.resolveChild(m.fn.name);B+=`if(mr===undefined){mr=${ZZ(m)?"await ":""}e.mapResponse[${_}](c)
if(mr!==undefined)r=c.response=mr}`,l()}}if(R.resolve(),B+=X1,A6)B+=`return mapResponse(${m0}r,c.set${O1})
`;else B+=`return mapCompactResponse(${m0}r${O1})
`}else{E.resolve();let R=F8?`await ${S}`:S;if(l1("afterHandle").resolve(),W instanceof Response)B+=z.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${m0}${S}.clone(),c.set${O1})
else return ${S}.clone()
`:`return ${S}.clone()
`;else if(A6)B+=`return mapResponse(${m0}${R},c.set${O1})
`;else B+=`return mapCompactResponse(${m0}${R}${O1})
`}}if(B+=`
}catch(error){`,s)B+=`if(isParsing)error=new ParseError()
`;if(!a8)B+="return(async()=>{";if(B+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,L&&Q.trace)for(let E=0;E<Q.trace.length;E++)B+=`report${E}?.resolve(error);reportChild${E}?.(error)
`;let K8=l1("error",{total:Q.error?.length});if(Q.error?.length){if(B+=`c.error=error
`,P)B+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else B+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;B+=`let er
`;for(let E=0;E<Q.error.length;E++){let R=K8.resolveChild(Q.error[E].fn.name);if($0(Q.error[E]))B+=`er=await e.error[${E}](c)
`;else B+=`er=e.error[${E}](c)
if(er instanceof Promise)er=await er
`;R();let _=l1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length)for(let m=0;m<Q.mapResponse.length;m++){let l=Q.mapResponse[m],H=_.resolveChild(l.fn.name);B+=`c.response=er
er=e.mapResponse[${m}](c)
if(er instanceof Promise)er=await er
`,H()}if(_.resolve(),B+=`er=mapEarlyResponse(er,set${O1})
`,B+="if(er){",L&&Q.trace){for(let m=0;m<Q.trace.length;m++)B+=`report${m}.resolve()
`;K8.resolve()}B+="return er}"}}if(K8.resolve(),B+="return handleError(c,error,true)",!a8)B+="})()";if(B+="}",G||L){if(B+="finally{ ",!a8)B+=";(async()=>{";let E=l1("afterResponse",{total:Q.afterResponse?.length});if(G&&Q.afterResponse)for(let R=0;R<Q.afterResponse.length;R++){let _=E.resolveChild(Q.afterResponse[R].fn.name);B+=`
await e.afterResponse[${R}](c)
`,_()}if(E.resolve(),!a8)B+="})()";B+="}"}let P8=U.inject?Object.keys(U.inject).join(",")+",":"",N6="const {handler,handleError,hooks:e, "+w0("validator,",P)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+w0("parseQuery,",s)+w0("parseQueryFromURL,",I)+"},error:{"+w0("ValidationError,",P)+"InternalServerError,"+w0("ParseError",s)+"},schema,definitions,ERROR_CODE,"+w0("parseCookie,",k)+w0("signCookie,",k)+w0("decodeURIComponent,",I)+"ElysiaCustomStatusResponse,"+w0("ELYSIA_TRACE,",L)+w0("ELYSIA_REQUEST_ID,",L)+w0("parser,",Q.parse?.length)+w0("getServer,",z.server)+P8+w0("TypeBoxError",P)+`}=hooks
const trace=e.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
return ${a8?"async ":""}function handle(c){`;if(Q.beforeHandle?.length)N6+=`let be
`;if(Q.afterHandle?.length)N6+=`let af
`;if(Q.mapResponse?.length)N6+=`let mr
`;if(J)N6+=`c.schema = schema
c.defs = definitions
`;N6+=B+"}";try{if(q)return Function("hooks",N6);return Function("hooks",N6)({handler:W,hooks:XJ(Q),validator:P?X:void 0,handleError:Z.handleError,mapResponse:w.mapResponse,mapCompactResponse:w.mapCompactResponse,mapEarlyResponse:w.mapEarlyResponse,isNotEmpty:B6,utils:{parseQuery:s?X9:void 0,parseQueryFromURL:I?RK:void 0},error:{ValidationError:P?Z1:void 0,InternalServerError:KJ,ParseError:s?PJ:void 0},schema:Z.router.history,definitions:Z.definitions.type,ERROR_CODE:z9,parseCookie:k?bJ:void 0,signCookie:k?J9:void 0,decodeURIComponent:I?y8:void 0,ElysiaCustomStatusResponse:d6,ELYSIA_TRACE:L?H5:void 0,ELYSIA_REQUEST_ID:L?M9:void 0,getServer:()=>Z.getServer(),TypeBoxError:P?p:void 0,parser:Z["~parser"],...U.inject})}catch(E){let R=XJ(Q);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof W==="function"?W.toString():W,instruction:N6,hooks:{...R,transform:R?.transform?.map?.((_)=>_.toString()),resolve:R?.resolve?.map?.((_)=>_.toString()),beforeHandle:R?.beforeHandle?.map?.((_)=>_.toString()),afterHandle:R?.afterHandle?.map?.((_)=>_.toString()),mapResponse:R?.mapResponse?.map?.((_)=>_.toString()),parse:R?.parse?.map?.((_)=>_.toString()),error:R?.error?.map?.((_)=>_.toString()),afterResponse:R?.afterResponse?.map?.((_)=>_.toString()),stop:R?.stop?.map?.((_)=>_.toString())},validator:X,definitions:Z.definitions.type,error:E,fnLiteral:B}),console.log("---"),process.exit(1)}},J5=(Z,{asManifest:$=!1}={})=>{let Y=Z["~adapter"].composeGeneralHandler;Z.router.http.build();let Q=Y.error404(!!Z.event.request?.length,!!Z.event.error?.length),X=Z.event.trace?.length,W="",J=Z.router,z="const route=router.find(r.method,p)";z+=J.http.root.ALL?`??router.find("ALL",p)
`:`
`,z+=Q.code,z+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)
`;let q="";for(let[G,L]of Object.entries(J.static.http.map)){if(q+=`case'${G}':`,Z.config.strictPath!==!0)q+=`case'${a4(G)}':`;let B=hZ(G);if(G!==B)q+=`case'${B}':`;q+=`switch(r.method){${L.code}
`+(L.all??"default: break map")+"}"}let U=!!Z.event.request?.some($0),w=Y.inject?Object.keys(Y.inject).join(",")+",":"";if(W+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,error,redirect,`+w0("ELYSIA_TRACE,",X)+w0("ELYSIA_REQUEST_ID,",X)+w+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,Z.event.request?.length)W+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(W+=Q.declare,Z.event.trace?.length)W+="const "+Z.event.trace.map((G,L)=>`tr${L}=app.event.trace[${L}].fn`).join(",")+`
`;if(W+=`${U?"async ":""}function map(${Y.parameters}){`,Z.event.request?.length)W+=`let re
`;if(W+=Y.createContext(Z),Z.event.trace?.length)W+="c[ELYSIA_TRACE]=["+Z.event.trace.map((G,L)=>`tr${L}(c)`).join(",")+`]
`;let M=D5({trace:Z.event.trace,addFn(G){W+=G}})("request",{total:Z.event.request?.length});if(Z.event.request?.length){W+="try{";for(let G=0;G<Z.event.request.length;G++){let L=Z.event.request[G],B=pZ(L),P=$0(L),I=M.resolveChild(Z.event.request[G].fn.name);if(B)W+=`re=mapEarlyResponse(${P?"await ":""}onRequest[${G}](c),c.set)
`,I("re"),W+=`if(re!==undefined)return re
`;else W+=`${P?"await ":""}onRequest[${G}](c)
`,I()}W+="}catch(error){return app.handleError(c,error,false)}"}if(M.resolve(),W+=Y.websocket(Z),W+=`
map:switch(p){
`+q+"default:break}"+z+`}
`,Z.extender.higherOrderFunctions.length){let G="map";for(let L=0;L<Z.extender.higherOrderFunctions.length;L++)G=`hoc[${L}](${G},${Y.parameters})`;W+=`return function hocMap(${Y.parameters}){return ${G}(${Y.parameters})}`}else W+="return map";let S=yJ(Z);return Z.handleError=S,Function("data",W)({app:Z,mapEarlyResponse:Z["~adapter"].handler.mapEarlyResponse,NotFoundError:S5,randomId:OJ,handleError:S,error:FJ,redirect:LJ,ELYSIA_TRACE:X?H5:void 0,ELYSIA_REQUEST_ID:X?M9:void 0,...Y.inject})},yJ=(Z)=>{let $=Z.event,Y="",Q=Z["~adapter"].composeError,X=Q.inject?Object.keys(Q.inject).join(",")+",":"",W=!!Z.event.trace?.length;if(Y+="const {app:{event:{error:onErrorContainer,afterResponse:resContainer,mapResponse:_onMapResponse,trace:_trace}},mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+w0("ELYSIA_TRACE,",W)+w0("ELYSIA_REQUEST_ID,",W)+X+`}=inject
`,Y+=`const trace=_trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const onMapResponse=[]
if(_onMapResponse)for(let i=0;i<_onMapResponse.length;i++)onMapResponse.push(_onMapResponse[i].fn??_onMapResponse[i])
delete _onMapResponse
const onError=onErrorContainer?.map(x=>x.fn)??[]
const res=resContainer?.map(x=>x.fn)??[]
return ${Z.event.error?.find($0)||Z.event.mapResponse?.find($0)?"async ":""}function(context,error,skipGlobal){`,Y+="",W)Y+=`const id=context[ELYSIA_REQUEST_ID]
`;let J=D5({context:"context",trace:$.trace,addFn:(U)=>{Y+=U}});if(Y+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,Q.declare)Y+=Q.declare;let z=W||!!$.afterResponse?.length||!!$.afterResponse?.length?"context.response = ":"";if(Z.event.error)for(let U=0;U<Z.event.error.length;U++){let w=Z.event.error[U],M=`${$0(w)?"await ":""}onError[${U}](context)
`;if(Y+="if(skipGlobal!==true){",pZ(w)){Y+=`_r=${M}
if(_r!==undefined){if(_r instanceof Response)return mapResponse(_r,set${Q.mapResponseContext})
if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let S=J("mapResponse",{total:$.mapResponse?.length,name:"context"});if($.mapResponse?.length)for(let G=0;G<$.mapResponse.length;G++){let L=$.mapResponse[G],B=S.resolveChild(L.fn.name);Y+=`context.response=_r_r=${ZZ(L)?"await ":""}onMapResponse[${G}](context)
`,B()}S.resolve(),Y+=`return mapResponse(${z}_r,set${Q.mapResponseContext})}`}else Y+=M;Y+="}"}Y+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){if(error.error)error=error.error
set.status=error.status??422
`+Q.validationError+"}",Y+="if(error instanceof Error){"+Q.unknownError+"}";let q=J("mapResponse",{total:$.mapResponse?.length,name:"context"});if(Y+=`
if(!context.response)context.response=error.message??error
`,$.mapResponse?.length){Y+=`let mr
`;for(let U=0;U<$.mapResponse.length;U++){let w=$.mapResponse[U],M=q.resolveChild(w.fn.name);Y+=`if(mr===undefined){mr=${ZZ(w)?"await ":""}onMapResponse[${U}](context)
if(mr!==undefined)error=context.response=mr}`,M()}}return q.resolve(),Y+=`
return mapResponse(${z}error,set${Q.mapResponseContext})}`,Function("inject",Y)({app:Z,mapResponse:Z["~adapter"].handler.mapResponse,ERROR_CODE:z9,ElysiaCustomStatusResponse:d6,ELYSIA_TRACE:W?H5:void 0,ELYSIA_REQUEST_ID:W?M9:void 0,...Q.inject})},z5=(Z,$)=>{for(let[Y,Q]of Object.entries(Z.schema.properties))$[Y]??=Q.default},SJ=(Z)=>{let{mapResponse:$,mapEarlyResponse:Y}=Z["~adapter"].handler;return async(Q)=>{let X=Q.url,W=X.indexOf("/",11),J=X.indexOf("?",W+1),z=J===-1?X.substring(W):X.substring(W,J),q={cookie:{},status:200,headers:{}},U=Object.assign({},Z.singleton.decorator,{set:q,store:Z.singleton.store,request:Q,path:z,qi:J,error:FJ,redirect:LJ});try{if(Z.event.request)for(let k=0;k<Z.event.request.length;k++){let g=Z.event.request[k].fn,V=g(U);if(V instanceof Promise)V=await V;if(V=Y(V,q),V)return U.response=V}let w=Z.router.dynamic.find(Q.method,z)??Z.router.dynamic.find("ALL",z);if(!w)throw new S5;let{handle:M,hooks:S,validator:G,content:L,route:B}=w.store,P;if(Q.method!=="GET"&&Q.method!=="HEAD")if(L)switch(L){case"application/json":P=await Q.json();break;case"text/plain":P=await Q.text();break;case"application/x-www-form-urlencoded":P=X9(await Q.text());break;case"application/octet-stream":P=await Q.arrayBuffer();break;case"multipart/form-data":P={};let k=await Q.formData();for(let g of k.keys()){if(P[g])continue;let V=k.getAll(g);if(V.length===1)P[g]=V[0];else P[g]=V}break}else{let k=Q.headers.get("content-type");if(k){let g=k.indexOf(";");if(g!==-1)k=k.slice(0,g);if(U.contentType=k,S.parse)for(let V=0;V<S.parse.length;V++){let X1=S.parse[V].fn,N1=X1(U,k);if(N1 instanceof Promise)N1=await N1;if(N1){P=N1;break}}if(delete U.contentType,P===void 0)switch(k){case"application/json":P=await Q.json();break;case"text/plain":P=await Q.text();break;case"application/x-www-form-urlencoded":P=X9(await Q.text());break;case"application/octet-stream":P=await Q.arrayBuffer();break;case"multipart/form-data":P={};let V=await Q.formData();for(let X1 of V.keys()){if(P[X1])continue;let N1=V.getAll(X1);if(N1.length===1)P[X1]=N1[0];else P[X1]=N1}break}}}U.route=B,U.body=P,U.params=w?.params||void 0,U.query=J===-1?{}:X9(X.substring(J+1)),U.headers={};for(let[k,g]of Q.headers.entries())U.headers[k]=g;let I=Object.assign({},Z.config?.cookie,G?.cookie?.config),n=Q.headers.get("cookie");U.cookie=await bJ(U.set,n,I?{secrets:I.secrets!==void 0?typeof I.secrets==="string"?I.secrets:I.secrets.join(","):void 0,sign:I.sign===!0?!0:I.sign!==void 0?typeof I.sign==="string"?I.sign:I.sign.join(","):void 0}:void 0);let s=G?.createHeaders?.();if(s)z5(s,U.headers);let A1=G?.createParams?.();if(A1)z5(A1,U.params);let E1=G?.createQuery?.();if(E1)z5(E1,U.query);if(S.transform)for(let k=0;k<S.transform.length;k++){let g=S.transform[k],V=g.fn(U);if(g.subType==="derive")if(V instanceof Promise)Object.assign(U,await V);else Object.assign(U,V);else if(V instanceof Promise)await V}if(G){if(s){let k=structuredClone(U.headers);for(let[g,V]of Q.headers)k[g]=V;if(G.headers.Check(k)===!1)throw new Z1("header",G.headers,k)}else if(G.headers?.Decode)U.headers=G.headers.Decode(U.headers);if(A1?.Check(U.params)===!1)throw new Z1("params",G.params,U.params);else if(G.params?.Decode)U.params=G.params.Decode(U.params);if(E1?.Check(U.query)===!1)throw new Z1("query",G.query,U.query);else if(G.query?.Decode)U.query=G.query.Decode(U.query);if(G.createCookie?.()){let k={};for(let[g,V]of Object.entries(U.cookie))k[g]=V.value;if(G.cookie.Check(k)===!1)throw new Z1("cookie",G.cookie,k);else if(G.cookie?.Decode)k=G.cookie.Decode(k)}if(G.createBody?.()?.Check(P)===!1)throw new Z1("body",G.body,P);else if(G.body?.Decode)U.body=G.body.Decode(P)}if(S.beforeHandle)for(let k=0;k<S.beforeHandle.length;k++){let g=S.beforeHandle[k],V=g.fn(U);if(g.subType==="resolve"){if(V instanceof d6){let X1=Y(V,U.set);if(X1)return U.response=X1}if(V instanceof Promise)Object.assign(U,await V);else Object.assign(U,V);continue}else if(V instanceof Promise)V=await V;if(V!==void 0){if(U.response=V,S.afterHandle)for(let N1=0;N1<S.afterHandle.length;N1++){let L1=S.afterHandle[N1].fn(U);if(L1 instanceof Promise)L1=await L1;if(L1)V=L1}let X1=Y(V,U.set);if(X1)return U.response=X1}}let v=typeof M==="function"?M(U):M;if(v instanceof Promise)v=await v;if(S.afterHandle)if(!S.afterHandle.length){let k=v instanceof d6?v.code:q.status?typeof q.status==="string"?w9[q.status]:q.status:200,g=G?.createResponse?.()?.[k];if(g?.Check(v)===!1)throw new Z1("response",g,v);else if(g?.Decode)v=g.Decode(v)}else{U.response=v;for(let k=0;k<S.afterHandle.length;k++){let g=S.afterHandle[k].fn(U);if(g instanceof Promise)g=await g;let V=Y(g,U.set);if(V!==void 0){let X1=G?.response?.[V.status];if(X1?.Check(V)===!1)throw new Z1("response",X1,V);else if(X1?.Decode)v=X1.Decode(v);return U.response=V}}}if(U.set.cookie&&I?.sign){let k=!I.secrets?void 0:typeof I.secrets==="string"?I.secrets:I.secrets[0];if(I.sign===!0)for(let[g,V]of Object.entries(U.set.cookie))U.set.cookie[g].value=await J9(V.value,"${secret}");else{let g=G?.cookie?.schema?.properties;for(let V of I.sign){if(!(V in g))continue;if(U.set.cookie[V]?.value)U.set.cookie[V].value=await J9(U.set.cookie[V].value,k)}}}return $(U.response=v,U.set)}catch(w){let M=w instanceof i$&&w.error?w.error:w;return Z.handleError(U,M)}finally{if(Z.event.afterResponse)for(let w of Z.event.afterResponse)await w.fn(U)}}},TK=(Z)=>{let{mapResponse:$}=Z["~adapter"].handler;return async(Y,Q)=>{let X=Object.assign(Y,{error:Q,code:Q.code});if(X.set=Y.set,Z.event.error)for(let W=0;W<Z.event.error.length;W++){let J=Z.event.error[W].fn(X);if(J instanceof Promise)J=await J;if(J!==void 0&&J!==null)return Y.response=$(J,Y.set)}return new Response(typeof Q.cause==="string"?Q.cause:Q.message,{headers:Y.set.headers,status:Q.status??500})}};class v0{config;server=null;dependencies={};_routes={};_types={Prefix:"",Singleton:{},Definitions:{},Metadata:{}};_ephemeral={};_volatile={};singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:x.Module({}),type:{},error:{}};extender={macros:[],higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){return vZ(vZ(this.global,this.scoped),this.local)}};event={};telemetry={stack:void 0};router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new Z4({lazy:!0});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new Z4;return this["~dynamic"]},static:{http:{static:{},map:{},all:""},ws:{}},history:[]};routeTree=new Map;get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,request:!1,route:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new NJ;return this._promisedModules}constructor(Z={}){if(Z.tags)if(!Z.detail)Z.detail={tags:Z.tags};else Z.detail.tags=Z.tags;if(Z.nativeStaticResponse===void 0)Z.nativeStaticResponse=!0;if(this.config={},this.applyConfig(Z??{}),this["~adapter"]=Z.adapter??(typeof Bun!=="undefined"?PK:Q9),Z?.analytic&&(Z?.name||Z?.seed!==void 0))this.telemetry.stack=new Error().stack}"~adapter";env(Z,$=BJ){if(y0(Z,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0}).Check($)===!1){let Y=new Z1("env",Z,$);throw new Error(Y.all.map((Q)=>Q.summary).join(`
`))}return this}wrap(Z){return this.extender.higherOrderFunctions.push({checksum:dZ(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Z.toString()})),fn:Z}),this}applyMacro(Z){if(this.extender.macros.length){let $=QK({globalHook:this.event,localHook:Z}),Y={events:{global:this.event,local:Z},get onParse(){return $("parse")},get onTransform(){return $("transform")},get onBeforeHandle(){return $("beforeHandle")},get onAfterHandle(){return $("afterHandle")},get mapResponse(){return $("mapResponse")},get onAfterResponse(){return $("afterResponse")},get onError(){return $("error")}};for(let Q of this.extender.macros)YK(Q.fn(Y),Z,$)}}applyConfig(Z){return this.config={prefix:"",aot:BJ.ELYSIA_AOT!=="false",normalize:!0,...Z,cookie:{path:"/",...Z?.cookie},experimental:Z?.experimental??{},seed:Z?.seed===void 0?"":Z?.seed},this}get models(){let Z={};for(let $ of Object.keys(this.definitions.type))Z[$]=y0(this.definitions.typebox.Import($));return Z.modules=this.definitions.typebox,Z}add(Z,$,Y,Q,{allowMeta:X=!1,skipPrefix:W=!1}={allowMeta:!1,skipPrefix:!1}){if(Q=W5(WK(Q)),$!==""&&$.charCodeAt(0)!==47)$="/"+$;if(this.config.prefix&&!W)$=this.config.prefix+$;if(Q?.type)switch(Q.type){case"text":Q.type="text/plain";break;case"json":Q.type="application/json";break;case"formdata":Q.type="multipart/form-data";break;case"urlencoded":Q.type="application/x-www-form-urlencoded";break;case"arrayBuffer":Q.type="application/octet-stream";break;default:break}let J=this.definitions.type,z=!this.config.aot,q={...this.validator.getCandidate()},U={body:Q?.body??q?.body,headers:Q?.headers??q?.headers,params:Q?.params??q?.params,query:Q?.query??q?.query,cookie:Q?.cookie??q?.cookie,response:Q?.response??q?.response},w=()=>U.cookie?AJ({modules:S,validator:U.cookie,defaultConfig:this.config.cookie,config:U.cookie?.config??{},dynamic:z,models:J}):void 0,M=this.config.normalize,S=this.definitions.typebox,G=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.schema===!0?{body:y0(U.body,{modules:S,dynamic:z,models:J,normalize:M,additionalCoerce:aW()}),headers:y0(U.headers,{modules:S,dynamic:z,models:J,additionalProperties:!this.config.normalize,coerce:!0,additionalCoerce:B4()}),params:y0(U.params,{modules:S,dynamic:z,models:J,coerce:!0,additionalCoerce:B4()}),query:y0(U.query,{modules:S,dynamic:z,models:J,normalize:M,coerce:!0,additionalCoerce:B4()}),cookie:w(),response:rW(U.response,{modules:S,dynamic:z,models:J,normalize:M})}:{createBody(){if(this.body)return this.body;return this.body=y0(U.body,{modules:S,dynamic:z,models:J,normalize:M,additionalCoerce:aW()})},createHeaders(){if(this.headers)return this.headers;return this.headers=y0(U.headers,{modules:S,dynamic:z,models:J,additionalProperties:!M,coerce:!0,additionalCoerce:B4()})},createParams(){if(this.params)return this.params;return this.params=y0(U.params,{modules:S,dynamic:z,models:J,coerce:!0,additionalCoerce:B4()})},createQuery(){if(this.query)return this.query;return this.query=y0(U.query,{modules:S,dynamic:z,models:J,coerce:!0,additionalCoerce:B4()})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=w()},createResponse(){if(this.response)return this.response;return this.response=rW(U.response,{modules:S,dynamic:z,models:J,normalize:M})}};if(Q=D8(Q,W5(q)),Q.tags)if(!Q.detail)Q.detail={tags:Q.tags};else Q.detail.tags=Q.tags;if(B6(this.config.detail))Q.detail=f0(Object.assign({},this.config.detail),Q.detail);this.applyMacro(Q);let L=W5(D8(this.event,Q));if(this.config.aot===!1){this.router.dynamic.add(Z,$,{validator:G,hooks:L,content:Q?.type,handle:Y,route:$});let L1=hZ($,{dynamic:!0});if($!==L1)this.router.dynamic.add(Z,L1,{validator:G,hooks:L,content:Q?.type,handle:Y,route:$});if(this.config.strictPath===!1){let h1=a4($);this.router.dynamic.add(Z,h1,{validator:G,hooks:L,content:Q?.type,handle:Y,route:$});let O8=hZ(h1);if(h1!==O8)this.router.dynamic.add(Z,h1,{validator:G,hooks:L,content:Q?.type,handle:Y,route:$})}this.router.history.push({method:Z,path:$,composed:null,handler:Y,hooks:L});return}let B=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,P=X5(this.inference),I=this["~adapter"].handler,n=typeof Y!=="function"&&typeof I.createStaticHandler==="function"?I.createStaticHandler(Y,L,this.setHeaders):void 0,s=typeof Y!=="function"?I.createNativeStaticHandler?.(Y,L,this.setHeaders):void 0;if(this.config.nativeStaticResponse===!0&&s&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[$]=s();let A1=(L1=!1)=>xK({app:this,path:$,method:Z,hooks:L,validator:G,handler:typeof Y!=="function"&&typeof I.createStaticHandler!=="function"?()=>Y:Y,allowMeta:X,inference:P,asManifest:L1}),E1;if(this.routeTree.has(Z+$))for(let L1=0;L1<this.router.history.length;L1++){let h1=this.router.history[L1];if(h1.path===$&&h1.method===Z){E1=L1;break}}else this.routeTree.set(Z+$,this.router.history.length);let v=this.router.history,k=E1??this.router.history.length,g=B?A1():(L1)=>{let h1=(v[k].composed=A1())(L1);return A1=void 0,h1};if(B)A1=void 0;let V=Z==="$INTERNALWS";if(E1!==void 0)this.router.history[E1]=Object.assign({method:Z,path:$,composed:g,handler:Y,hooks:L},Q.webSocket?{websocket:Q.websocket}:{});else this.router.history.push(Object.assign({method:Z,path:$,composed:g,handler:Y,hooks:L},Q.webSocket?{websocket:Q.websocket}:{}));let X1=this.router.static.http,N1={handler:B?g:void 0,compile(){return this.handler=A1()}};if(V){if(this.router.http.add("ws",$,N1),!this.config.strictPath)this.router.http.add("ws",a4($),N1);let L1=hZ($,{dynamic:!0});if(L1!==$)this.router.http.add("ws",L1,N1);return}if($.indexOf(":")===-1&&$.indexOf("*")===-1){if(!X1.map[$])X1.map[$]={code:""};let L1=n?"":"c";if(Z==="ALL")X1.map[$].all=`default:return ht[${k}].composed(${L1})
`;else X1.map[$].code=`case '${Z}':return ht[${k}].composed(${L1})
${X1.map[$].code}`;if(!this.config.strictPath&&this.config.nativeStaticResponse===!0&&s&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[a4($)]=s()}else{if(this.router.http.add(Z,$,N1),!this.config.strictPath){let h1=a4($);if(this.config.nativeStaticResponse===!0&&n&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[h1]=n();this.router.http.add(Z,h1,N1)}let L1=hZ($,{dynamic:!0});if($!==L1){if(this.router.http.add(Z,L1,N1),this.config.nativeStaticResponse===!0&&n&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[L1]=n();this.router.http.add(Z,L1,N1)}}}setHeaders;headers(Z){if(!Z)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=f0(this.setHeaders,Z),this}onStart(Z){return this.on("start",Z),this}onRequest(Z){return this.on("request",Z),this}onParse(Z,$){if(!$){if(typeof Z==="string")return this.on("parse",this["~parser"][Z]);return this.on("parse",Z)}return this.on(Z,"parse",$)}parser(Z,$){return this["~parser"][Z]=$,this}onTransform(Z,$){if(!$)return this.on("transform",Z);return this.on(Z,"transform",$)}resolve(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"resolve",fn:$};return this.onBeforeHandle(Z,Y)}mapResolve(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"mapResolve",fn:$};return this.onBeforeHandle(Z,Y)}onBeforeHandle(Z,$){if(!$)return this.on("beforeHandle",Z);return this.on(Z,"beforeHandle",$)}onAfterHandle(Z,$){if(!$)return this.on("afterHandle",Z);return this.on(Z,"afterHandle",$)}mapResponse(Z,$){if(!$)return this.on("mapResponse",Z);return this.on(Z,"mapResponse",$)}onAfterResponse(Z,$){if(!$)return this.on("afterResponse",Z);return this.on(Z,"afterResponse",$)}trace(Z,$){if(!$)$=Z,Z={as:"local"};if(!Array.isArray($))$=[$];for(let Y of $)this.on(Z,"trace",_K(Y));return this}error(Z,$){switch(typeof Z){case"string":return $.prototype[z9]=Z,this.definitions.error[Z]=$,this;case"function":return this.definitions.error=Z(this.definitions.error),this}for(let[Y,Q]of Object.entries(Z))Q.prototype[z9]=Y,this.definitions.error[Y]=Q;return this}onError(Z,$){if(!$)return this.on("error",Z);return this.on(Z,"error",$)}onStop(Z){return this.on("stop",Z),this}on(Z,$,Y){let Q;switch(typeof Z){case"string":Q=Z,Y=$;break;case"object":if(Q=$,!Array.isArray($)&&typeof $==="object")Y=$;break}if(Array.isArray(Y))Y=W0(Y);else if(typeof Y==="function")Y=[{fn:Y}];else Y=[Y];let X=Y;for(let W of X)if(W.scope=typeof Z==="string"?"local":Z?.as??"local",Q==="resolve"||Q==="derive")W.subType=Q;if(Q!=="trace")xJ({[Q]:X.map((W)=>W.fn)},this.inference);for(let W of X){let J=ZK(W,"global",{skipIfHasType:!0});switch(Q){case"start":this.event.start??=[],this.event.start.push(J);break;case"request":this.event.request??=[],this.event.request.push(J);break;case"parse":this.event.parse??=[],this.event.parse.push(J);break;case"transform":this.event.transform??=[],this.event.transform.push(J);break;case"derive":this.event.transform??=[],this.event.transform.push(W0(J,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(J);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push(W0(J,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(J);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(J);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(J);break;case"trace":this.event.trace??=[],this.event.trace.push(J);break;case"error":this.event.error??=[],this.event.error.push(J);break;case"stop":this.event.stop??=[],this.event.stop.push(J);break}}return this}propagate(){return A0(this.event.parse),A0(this.event.transform),A0(this.event.beforeHandle),A0(this.event.afterHandle),A0(this.event.mapResponse),A0(this.event.afterResponse),A0(this.event.trace),A0(this.event.error),this}as(Z){let $={plugin:"scoped",scoped:"scoped",global:"global"}[Z];if(A0(this.event.parse,$),A0(this.event.transform,$),A0(this.event.beforeHandle,$),A0(this.event.afterHandle,$),A0(this.event.mapResponse,$),A0(this.event.afterResponse,$),A0(this.event.trace,$),A0(this.event.error,$),Z==="plugin")this.validator.scoped=vZ(this.validator.scoped,this.validator.local),this.validator.local=null;else if(Z==="global")this.validator.global=vZ(this.validator.global,vZ(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null;return this}group(Z,$,Y){let Q=new v0({...this.config,prefix:""});Q.singleton={...this.singleton},Q.definitions={...this.definitions},Q.getServer=()=>this.getServer(),Q.inference=X5(this.inference),Q.extender={...this.extender};let X=typeof $==="object",W=(X?Y:$)(Q);if(this.singleton=f0(this.singleton,Q.singleton),this.definitions=f0(this.definitions,Q.definitions),W.event.request?.length)this.event.request=[...this.event.request||[],...W.event.request||[]];if(W.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...W.event.mapResponse||[]];return this.model(W.definitions.type),Object.values(Q.router.history).forEach(({method:J,path:z,handler:q,hooks:U})=>{if(z=(X?"":this.config.prefix)+Z+z,X){let w=$,M=U;this.add(J,z,q,D8(w,{...M||{},error:!M.error?W.event.error:Array.isArray(M.error)?[...M.error||{},...W.event.error||{}]:[M.error,...W.event.error||{}]}))}else this.add(J,z,q,D8(U,{error:W.event.error}),{skipPrefix:!0})}),this}guard(Z,$){if(!$){if(typeof Z==="object"){this.applyMacro(Z);let X=Z.as??"local";if(this.validator[X]={body:Z.body??this.validator[X]?.body,headers:Z.headers??this.validator[X]?.headers,params:Z.params??this.validator[X]?.params,query:Z.query??this.validator[X]?.query,response:Z.response??this.validator[X]?.response,cookie:Z.cookie??this.validator[X]?.cookie},Z.parse)this.on({as:X},"parse",Z.parse);if(Z.transform)this.on({as:X},"transform",Z.transform);if(Z.derive)this.on({as:X},"derive",Z.derive);if(Z.beforeHandle)this.on({as:X},"beforeHandle",Z.beforeHandle);if(Z.resolve)this.on({as:X},"resolve",Z.resolve);if(Z.afterHandle)this.on({as:X},"afterHandle",Z.afterHandle);if(Z.mapResponse)this.on({as:X},"mapResponse",Z.mapResponse);if(Z.afterResponse)this.on({as:X},"afterResponse",Z.afterResponse);if(Z.error)this.on({as:X},"error",Z.error);if(Z.detail)if(this.config.detail)this.config.detail=f0(Object.assign({},this.config.detail),Z.detail);else this.config.detail=Z.detail;if(Z?.tags)if(!this.config.detail)this.config.detail={tags:Z.tags};else this.config.detail.tags=Z.tags;return this}return this.guard({},Z)}let Y=new v0({...this.config,prefix:""});Y.singleton={...this.singleton},Y.definitions={...this.definitions},Y.inference=X5(this.inference),Y.extender={...this.extender};let Q=$(Y);if(this.singleton=f0(this.singleton,Y.singleton),this.definitions=f0(this.definitions,Y.definitions),Q.getServer=()=>this.server,Q.event.request?.length)this.event.request=[...this.event.request||[],...Q.event.request||[]];if(Q.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...Q.event.mapResponse||[]];return this.model(Q.definitions.type),Object.values(Y.router.history).forEach(({method:X,path:W,handler:J,hooks:z})=>{this.add(X,W,J,D8(Z,{...z||{},error:!z.error?Q.event.error:Array.isArray(z.error)?[...z.error||{},...Q.event.error||[]]:[z.error,...Q.event.error||[]]}))}),this}use(Z,$){if(Array.isArray(Z)){let Y=this;for(let Q of Z)Y=Y.use(Q);return Y}if($?.scoped)return this.guard({},(Y)=>Y.use(Z));if(Array.isArray(Z)){let Y=this;for(let Q of Z)Y=this.use(Q);return Y}if(Z instanceof Promise)return this.promisedModules.add(Z.then((Y)=>{if(typeof Y==="function")return Y(this);if(Y instanceof v0)return this._use(Y).compile();if(Y.constructor.name==="Elysia")return this._use(Y).compile();if(typeof Y.default==="function")return Y.default(this);if(Y.default instanceof v0)return this._use(Y.default);if(Y.constructor.name==="Elysia")return this._use(Y.default);if(Y.constructor.name==="_Elysia")return this._use(Y.default);try{return this._use(Y.default)}catch(Q){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),Q}}).then((Y)=>{if(Y&&typeof Y.compile==="function")Y.compile();return Y})),this;return this._use(Z)}propagatePromiseModules(Z){if(Z.promisedModules.size<=0)return this;for(let $ of Z.promisedModules.promises)this.promisedModules.add($.then((Y)=>{if(!Y)return;let Q=this._use(Y);if(Q instanceof Promise)return Q.then((X)=>{if(X)X.compile();else Y.compile()});return Y.compile()}));return this}_use(Z){if(typeof Z==="function"){let X=Z(this);if(X instanceof Promise)return this.promisedModules.add(X.then((W)=>{if(W instanceof v0){W.getServer=()=>this.getServer(),W.getGlobalRoutes=()=>this.getGlobalRoutes(),W.model(this.definitions.type),W.error(this.definitions.error);for(let{method:J,path:z,handler:q,hooks:U}of Object.values(W.router.history))this.add(J,z,q,D8(U,{error:W.event.error}));if(W.compile(),W===this)return;return this.propagatePromiseModules(W),W}if(typeof W==="function")return W(this);if(typeof W.default==="function")return W.default(this);return this._use(W)}).then((W)=>{if(W&&typeof W.compile==="function")W.compile();return W})),this;return X}this.propagatePromiseModules(Z);let{name:$,seed:Y}=Z.config;if(Z.getParent=()=>this,Z.getServer=()=>this.getServer(),Z.getGlobalRoutes=()=>this.getGlobalRoutes(),Z.model(this.definitions.type),Z.error(this.definitions.error),this["~parser"]={...Z["~parser"],...this["~parser"]},this.headers(Z.setHeaders),$){if(!($ in this.dependencies))this.dependencies[$]=[];let X=Y!==void 0?dZ($+JSON.stringify(Y)):0;if(!this.dependencies[$].some(({checksum:W})=>X===W))this.extender.macros=this.extender.macros.concat(Z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Z.extender.higherOrderFunctions)}else this.extender.macros=this.extender.macros.concat(Z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Z.extender.higherOrderFunctions);WJ(this.extender.macros),WJ(this.extender.higherOrderFunctions);let Q=[];for(let X=0;X<this.extender.higherOrderFunctions.length;X++){let W=this.extender.higherOrderFunctions[X];if(W.checksum){if(Q.includes(W.checksum))this.extender.higherOrderFunctions.splice(X,1),X--;Q.push(W.checksum)}}this.inference={body:this.inference.body||Z.inference.body,cookie:this.inference.cookie||Z.inference.cookie,headers:this.inference.headers||Z.inference.headers,query:this.inference.query||Z.inference.query,set:this.inference.set||Z.inference.set,server:this.inference.server||Z.inference.server,request:this.inference.request||Z.inference.request,route:this.inference.route||Z.inference.route},this.decorate(Z.singleton.decorator),this.state(Z.singleton.store),this.model(Z.definitions.type),this.error(Z.definitions.error),Z.extender.macros=this.extender.macros.concat(Z.extender.macros);for(let{method:X,path:W,handler:J,hooks:z}of Object.values(Z.router.history))this.add(X,W,J,D8(z,{error:Z.event.error}));if($){if(!($ in this.dependencies))this.dependencies[$]=[];let X=Y!==void 0?dZ($+JSON.stringify(Y)):0;if(this.dependencies[$].some(({checksum:W})=>X===W))return this;this.dependencies[$].push(this.config?.analytic?{name:Z.config.name,seed:Z.config.seed,checksum:X,dependencies:Z.dependencies,stack:Z.telemetry.stack,routes:Z.router.history,decorators:Z.singleton,store:Z.singleton.store,error:Z.definitions.error,derive:Z.event.transform?.filter((W)=>W?.subType==="derive").map((W)=>({fn:W.toString(),stack:new Error().stack??""})),resolve:Z.event.transform?.filter((W)=>W?.subType==="resolve").map((W)=>({fn:W.toString(),stack:new Error().stack??""}))}:{name:Z.config.name,seed:Z.config.seed,checksum:X,dependencies:Z.dependencies}),this.event=eW(this.event,ZJ(Z.event),X)}else this.event=eW(this.event,ZJ(Z.event));return this.validator.global=D8(this.validator.global,{...Z.validator.global}),this.validator.local=D8(this.validator.local,{...Z.validator.scoped}),this}macro(Z){if(typeof Z==="function"){let $={checksum:dZ(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Z.toString()})),fn:Z};this.extender.macros.push($)}else if(typeof Z==="object"){for(let Y of Object.keys(Z))if(typeof Z[Y]==="object"){let Q={...Z[Y]};Z[Y]=(X)=>{if(X===!0)return Q}}let $={checksum:dZ(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Object.entries(Z).map(([Y,Q])=>`${Y}+${Q}`).join(",")})),fn:()=>Z};this.extender.macros.push($)}return this}mount(Z,$){if(Z instanceof v0||typeof Z==="function"||Z.length===0||Z==="/"){let X=typeof Z==="function"?Z:Z instanceof v0?Z.compile().fetch:$ instanceof v0?$.compile().fetch:$,W=({request:J,path:z})=>X(new Request(sW(J.url,z),{method:J.method,headers:J.headers,signal:J.signal,credentials:J.credentials,referrerPolicy:J.referrerPolicy,duplex:J.duplex,redirect:J.redirect,mode:J.mode,keepalive:J.keepalive,integrity:J.integrity,body:J.body}));return this.all("/*",W,{parse:"none"}),this}if(!$)return this;let Y=Z.length-(Z.endsWith("*")?1:0);if($ instanceof v0)$=$.compile().fetch;let Q=({request:X,path:W})=>$(new Request(sW(X.url,W.slice(Y)||"/"),{method:X.method,headers:X.headers,signal:X.signal,credentials:X.credentials,referrerPolicy:X.referrerPolicy,duplex:X.duplex,redirect:X.redirect,mode:X.mode,keepalive:X.keepalive,integrity:X.integrity,body:X.body}));return this.all(Z,Q,{parse:"none"}),this.all(Z+(Z.endsWith("/")?"*":"/*"),Q,{parse:"none"}),this}get(Z,$,Y){return this.add("GET",Z,$,Y),this}post(Z,$,Y){return this.add("POST",Z,$,Y),this}put(Z,$,Y){return this.add("PUT",Z,$,Y),this}patch(Z,$,Y){return this.add("PATCH",Z,$,Y),this}delete(Z,$,Y){return this.add("DELETE",Z,$,Y),this}options(Z,$,Y){return this.add("OPTIONS",Z,$,Y),this}all(Z,$,Y){return this.add("ALL",Z,$,Y),this}head(Z,$,Y){return this.add("HEAD",Z,$,Y),this}connect(Z,$,Y){return this.add("CONNECT",Z,$,Y),this}route(Z,$,Y,Q){return this.add(Z.toUpperCase(),$,Y,Q,Q?.config),this}ws(Z,$){if(this["~adapter"].ws)this["~adapter"].ws(this,Z,$);else console.warn("Current adapter doesn't support WebSocket");return this}state(Z,$,Y){if($===void 0)Y=Z,Z={as:"append"},$="";else if(Y===void 0){if(typeof Z==="string")Y=$,$=Z,Z={as:"append"};else if(typeof Z==="object")Y=$,$=""}let{as:Q}=Z;if(typeof $!=="string")return this;switch(typeof Y){case"object":if($){if($ in this.singleton.store)this.singleton.store[$]=f0(this.singleton.store[$],Y,{override:Q==="override"});else this.singleton.store[$]=Y;return this}if(Y===null)return this;return this.singleton.store=f0(this.singleton.store,Y,{override:Q==="override"}),this;case"function":if($){if(Q==="override"||!($ in this.singleton.store))this.singleton.store[$]=Y}else this.singleton.store=Y(this.singleton.store);return this;default:if(Q==="override"||!($ in this.singleton.store))this.singleton.store[$]=Y;return this}}decorate(Z,$,Y){if($===void 0)Y=Z,Z={as:"append"},$="";else if(Y===void 0){if(typeof Z==="string")Y=$,$=Z,Z={as:"append"};else if(typeof Z==="object")Y=$,$=""}let{as:Q}=Z;if(typeof $!=="string")return this;switch(typeof Y){case"object":if($){if($ in this.singleton.decorator)this.singleton.decorator[$]=f0(this.singleton.decorator[$],Y,{override:Q==="override"});else this.singleton.decorator[$]=Y;return this}if(Y===null)return this;return this.singleton.decorator=f0(this.singleton.decorator,Y,{override:Q==="override"}),this;case"function":if($){if(Q==="override"||!($ in this.singleton.decorator))this.singleton.decorator[$]=Y}else this.singleton.decorator=Y(this.singleton.decorator);return this;default:if(Q==="override"||!($ in this.singleton.decorator))this.singleton.decorator[$]=Y;return this}}derive(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"derive",fn:$};return this.onTransform(Z,Y)}model(Z,$){let Y=(Q)=>U5(Q,[{from:x.Number(),to:(X)=>x.Numeric(X),untilObjectFound:!0},{from:x.Boolean(),to:(X)=>x.BooleanString(X),untilObjectFound:!0}]);switch(typeof Z){case"object":let Q={},X=Object.entries(Z);for(let[z,q]of X){if(z in this.definitions.type)continue;Q[z]=this.definitions.type[z]=Y(q),Q[z].$id??=`#/components/schemas/${z}`}return this.definitions.typebox=x.Module({...this.definitions.typebox.$defs,...Q}),this;case"function":let W=Y(Z(this.definitions.type));return this.definitions.type=W,this.definitions.typebox=x.Module(W),this;case"string":if(!$)break;let J={...$,id:$.$id??`#/components/schemas/${Z}`};return this.definitions.type[Z]=$,this.definitions.typebox=x.Module({...this.definitions.typebox.$defs,...J}),this}return this.definitions.type[Z]=$,this.definitions.typebox=x.Module({...this.definitions.typebox.$defs,[Z]:$}),this}mapDerive(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"mapDerive",fn:$};return this.onTransform(Z,Y)}affix(Z,$,Y){if(Y==="")return this;let Q=["_","-"," "],X=(q)=>q[0].toUpperCase()+q.slice(1),W=Z==="prefix"?(q,U)=>Q.includes(q.at(-1)??"")?q+U:q+X(U):Q.includes(Y.at(-1)??"")?(q,U)=>U+q:(q,U)=>U+X(q),J=(q)=>{let U={};switch(q){case"decorator":for(let w in this.singleton.decorator)U[W(Y,w)]=this.singleton.decorator[w];this.singleton.decorator=U;break;case"state":for(let w in this.singleton.store)U[W(Y,w)]=this.singleton.store[w];this.singleton.store=U;break;case"model":for(let w in this.definitions.type)U[W(Y,w)]=this.definitions.type[w];this.definitions.type=U;break;case"error":for(let w in this.definitions.error)U[W(Y,w)]=this.definitions.error[w];this.definitions.error=U;break}},z=Array.isArray($)?$:[$];for(let q of z.some((U)=>U==="all")?["decorator","state","model","error"]:z)J(q);return this}prefix(Z,$){return this.affix("prefix",Z,$)}suffix(Z,$){return this.affix("suffix",Z,$)}compile(){if(this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?J5(this):SJ(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=J5(this),this}handle=async(Z)=>this.fetch(Z);fetch=(Z)=>{return(this.fetch=this.config.aot?J5(this):SJ(this))(Z)};handleError=async(Z,$)=>{return(this.handleError=this.config.aot?yJ(this):TK(this))(Z,$)};outerErrorHandler=(Z)=>new Response(Z.message||Z.name||"Error",{status:Z?.status??500});listen=(Z,$)=>{return this["~adapter"].listen(this)(Z,$),this};stop=async(Z)=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(Z),this.server=null,this.event.stop?.length)for(let $=0;$<this.event.stop.length;$++)this.event.stop[$].fn(this)}};get modules(){return this.promisedModules}}var bK=typeof new Headers()?.toJSON==="function",kK=(Z)=>{if(bK)return Object.keys(Z.toJSON()).join(", ");let $="";if(Z.forEach((Y,Q)=>{$+=Q+", "}),$)$=$.slice(0,-1);return $},vJ=(Z,$,Y)=>{if(Array.isArray(Z))return Z.some((Q)=>vJ(Q,$,Y));switch(typeof Z){case"string":if(Z.indexOf("://")===-1)return Y.includes(Z);return Z===Y;case"function":return Z($)===!0;case"object":if(Z instanceof RegExp)return Z.test(Y)}return!1},dJ=(Z)=>{let{aot:$=!0,origin:Y=!0,methods:Q=!0,allowedHeaders:X=!0,exposeHeaders:W=!0,credentials:J=!0,maxAge:z=5,preflight:q=!0}=Z??{};if(Array.isArray(X))X=X.join(", ");if(Array.isArray(W))W=W.join(", ");let U=typeof Y==="boolean"?void 0:Array.isArray(Y)?Y:[Y],w=new v0({name:"@elysiajs/cors",seed:Z,aot:$}),M=U?.some((P)=>P==="*"),S=(P,I)=>{if(Y===!0){P.headers.vary="*",P.headers["access-control-allow-origin"]=I.headers.get("Origin")||"*";return}if(M){P.headers.vary="*",P.headers["access-control-allow-origin"]="*";return}if(!U?.length)return;let n=[];if(U.length){let s=I.headers.get("Origin")??"";for(let A1=0;A1<U.length;A1++){let E1=vJ(U[A1],I,s);if(E1===!0){P.headers.vary=Y?"Origin":"*",P.headers["access-control-allow-origin"]=s||"*";return}if(E1)n.push(E1)}}if(P.headers.vary="Origin",n.length)P.headers["access-control-allow-origin"]=n.join(", ")},G=(P,I)=>{if(!I)return;if(Q===!0)return P.headers["access-control-allow-methods"]=I??"*";if(Q===!1||!Q?.length)return;if(Q==="*")return P.headers["access-control-allow-methods"]="*";if(!Array.isArray(Q))return P.headers["access-control-allow-methods"]=Q;P.headers["access-control-allow-methods"]=Q.join(", ")},L={};if(typeof W==="string")L["access-control-expose-headers"]=W;if(typeof X==="string")L["access-control-allow-headers"]=X;if(J===!0)L["access-control-allow-credentials"]="true";w.headers(L);function B({set:P,request:I,headers:n}){if(S(P,I),G(P,I.headers.get("access-control-request-method")),X===!0||W===!0){if(X===!0)P.headers["access-control-allow-headers"]=n["access-control-request-headers"];if(W===!0)P.headers["access-control-expose-headers"]=Object.keys(n).join(",")}if(z)P.headers["access-control-max-age"]=z.toString();return new Response(null,{status:204})}if(q)w.options("/",B).options("/*",B);return w.onRequest(function P({set:I,request:n}){if(S(I,n),G(I,n.method),X===!0||W===!0){let s=kK(n.headers);if(X===!0)I.headers["access-control-allow-headers"]=s;if(W===!0)I.headers["access-control-expose-headers"]=s}})};var RG=GY(AU(),1);var u8={jwt:{EXPIRATION_TIME:3600,KEY_PREFIX:"jwt",REDIS_DB_KEY:0},avatar:{EXPIRATION_TIME:21600,KEY_PREFIX:"avatar",REDIS_DB_KEY:1},lessons:{EXPIRATION_TIME:3600,KEY_PREFIX:"lessons",REDIS_DB_KEY:2},periods:{EXPIRATION_TIME:3600,KEY_PREFIX:"periods",REDIS_DB_KEY:3},users:{EXPIRATION_TIME:86400,KEY_PREFIX:"users",REDIS_DB_KEY:9}};var PG=GY(FG(),1),jG=globalThis,vb=process.env.REDIS_URL||"",KG=2,qY=jG.redis||new PG.default(vb,{retryStrategy:(Z,$)=>{if($?.code==="ENOTFOUND")return console.error("Redis DNS hatas\u0131, tekrar denenmeyecek:",$),null;if(Z>=KG)return console.error(`Redis ba\u011Flant\u0131s\u0131 ${KG} kez ba\u015Far\u0131s\u0131z oldu, duruyor...`),null;return Math.min(Z*1000,5000)}});jG.redis=qY;var r8=async(Z,$,Y)=>{try{let Q=qY.pipeline();Q.select($),Q.get(Z);let X=await Q.exec();if(!X||X.length<2||X[1][0])return null;let W=X[1][1];if(typeof W!=="string")return null;return Y?JSON.parse(W):W}catch(Q){return console.error("Redis get error:",Q),null}},DZ=async(Z,$,Y,Q,X)=>{console.log("set cache");try{let W=qY.pipeline(),J=X?JSON.stringify($):$;W.select(Q),W.set(Z,J,"EX",Y),await W.exec()}catch(W){console.error("Redis set error:",W)}};var _G=process.env.JWT_SECRET_KEY,hQ=u8.jwt;if(!_G)throw new Error("JWT_SECRET_KEY is not defined in environment variables.");async function db(Z){try{let $=RG.default.verify(Z,_G),Y=Math.floor(Date.now()/1000);if(!$||!$.exp||$.exp<Y)return null;return await DZ(Z,$,hQ.EXPIRATION_TIME,hQ.REDIS_DB_KEY,!0),$}catch($){return null}}async function CG(Z){let $=Z.split(" ");if($.length!==2||$[0]!=="Bearer")return null;let Y=$[1],Q=Math.floor(Date.now()/1000),X=await r8(Y,hQ.REDIS_DB_KEY,!0);if(X?.exp&&X.exp>Q)return X;return await db(Y)}async function UY(Z,$){if(!Z.authorization)return{status:!1,message:"Access denied. No token provided."};let Y=await CG(Z.authorization);if(!Y)return{status:!1,message:"Access denied. User not found."};if(!Y.userId)return{status:!1,message:"Access denied. Invalid token."};if(!$.includes(Y.role))return{status:!1,message:"You do not have permission to access this resource."};return{status:!0,user:Y}}var{SQL:hb}=globalThis.Bun;var VG=new hb({url:process.env.DATABASE_URL});var EG=async({userId:Z})=>{if(!Z)return null;try{let $=u8.lessons,Y="SPRING",Q="c12d4575-d3d3-4a42-bb19-61409470331c",X=await r8(Z,$.REDIS_DB_KEY,!0);if(X)return X;let W=await VG`SELECT
                              to_jsonb (note) AS note,
                              to_jsonb (lesson) AS lesson,
                              to_jsonb (instructor) AS instructor,
                              period
                            FROM
                              "note"
                              INNER JOIN "lesson" ON "note"."lesson_id" = "lesson"."id"
                              INNER JOIN "instructor" ON "lesson"."instructor_id" = "instructor"."id"
                              INNER JOIN "note_to_period" ON "note_to_period"."note_id" = "note"."id"
                              INNER JOIN "period" ON "period"."id" = "note_to_period"."period_id"
                            WHERE
                              ("note"."user_id" = ${Z} AND "period"."id" = ${"c12d4575-d3d3-4a42-bb19-61409470331c"} AND "period"."semester" = ${"SPRING"})`;return await DZ(Z,W,$.EXPIRATION_TIME,$.REDIS_DB_KEY,!0),W}catch($){throw console.error("Error fetching lessons:",$),new Error("Failed to fetch lessons from the database")}};var IG=async({userId:Z})=>{if(!Z)return null;try{let $=u8.periods,Y=await r8(Z,$.REDIS_DB_KEY,!0);if(Y)return Y}catch($){throw console.error("Error fetching periods:",$),new Error("Failed to fetch periods from the database")}};var{S3Client:mb}=globalThis.Bun;var xG=new mb({accessKeyId:process.env.MINIO_ACCESS_KEY,secretAccessKey:process.env.MINIO_SECRET_KEY,endpoint:process.env.MINIO_END_POINT});var TG=async({userId:Z,bucketId:$})=>{if(!Z)return null;try{if(!Z||!$)return null;let Y=u8.avatar,Q=await r8(Z,Y.REDIS_DB_KEY,!1);if(Q)return Q;let X=xG.presign(`${$}/avatar/${Z}.png`,{expiresIn:21600,acl:"private"});if(!X)return null;return await DZ(Z,X,Y.EXPIRATION_TIME,Y.REDIS_DB_KEY,!1),X}catch(Y){throw console.error("Error fetching avatar:",Y),new Error("Failed to fetch avatar from the S3 server")}};var bG=["http://192.168.1.37:3000","http://localhost:3000","https://misy-dev.vercel.app","https://misy.online"];new v0().use(dJ({origin:bG,allowedHeaders:"Content-Type,Authorization,Expires,Cache-Control,Pragma",methods:"GET,POST,PUT,DELETE,OPTIONS"})).get("/api/avatar",async({headers:Z})=>{let $=await UY(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Y=await TG({userId:$.user?.userId,bucketId:$.user?.bucketId});return Y.length===0?{status:"success",message:"No avatar found."}:{status:"success",userId:$.user?.userId,data:Y}}).get("/api/lessons",async({headers:Z})=>{let $=await UY(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Y=await EG({userId:"d2bd42e7-55d3-4e6b-9d0f-5c024f7bf9a6"});return Y.length===0?{status:"success",message:"No lessons found."}:{status:"success",userId:$.user?.userId,data:Y}}).get("/api/periods",async({headers:Z})=>{let $=await UY(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Y=await IG({userId:$.user?.userId});return Y.length===0?{status:"success",message:"No periods found."}:{status:"success",userId:$.user?.userId,data:Y}}).get("/health",()=>{return new Response("OK")}).listen({idleTimeout:0,port:process.env.PORT||3001});
