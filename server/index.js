// @bun
import{a as CQ,b as y,c as v6,d as G8,e as YO}from"./index-m7fn6zwr.js";var gZ=y((kY,P5)=>{/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var pQ=G8("buffer"),v1=pQ.Buffer;function _5(Z,$){for(var Q in Z)$[Q]=Z[Q]}if(v1.from&&v1.alloc&&v1.allocUnsafe&&v1.allocUnsafeSlow)P5.exports=pQ;else _5(pQ,kY),kY.Buffer=$Z;function $Z(Z,$,Q){return v1(Z,$,Q)}$Z.prototype=Object.create(v1.prototype);_5(v1,$Z);$Z.from=function(Z,$,Q){if(typeof Z==="number")throw new TypeError("Argument must not be a number");return v1(Z,$,Q)};$Z.alloc=function(Z,$,Q){if(typeof Z!=="number")throw new TypeError("Argument must be a number");var Y=v1(Z);if($!==void 0)if(typeof Q==="string")Y.fill($,Q);else Y.fill($);else Y.fill(0);return Y};$Z.allocUnsafe=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return v1(Z)};$Z.allocUnsafeSlow=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return pQ.SlowBuffer(Z)}});var gY=y((Zv,K5)=>{var iQ=gZ().Buffer,GS=G8("stream"),MS=G8("util");function lQ(Z){if(this.buffer=null,this.writable=!0,this.readable=!0,!Z)return this.buffer=iQ.alloc(0),this;if(typeof Z.pipe==="function")return this.buffer=iQ.alloc(0),Z.pipe(this),this;if(Z.length||typeof Z==="object")return this.buffer=Z,this.writable=!1,process.nextTick(function(){this.emit("end",Z),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof Z+")")}MS.inherits(lQ,GS);lQ.prototype.write=function Z($){this.buffer=iQ.concat([this.buffer,iQ.from($)]),this.emit("data",$)};lQ.prototype.end=function Z($){if($)this.write($);this.emit("end",$),this.emit("close"),this.writable=!1,this.readable=!1};K5.exports=lQ});var j5=y(($v,C5)=>{var F$=G8("buffer").Buffer,fY=G8("buffer").SlowBuffer;C5.exports=nQ;function nQ(Z,$){if(!F$.isBuffer(Z)||!F$.isBuffer($))return!1;if(Z.length!==$.length)return!1;var Q=0;for(var Y=0;Y<Z.length;Y++)Q|=Z[Y]^$[Y];return Q===0}nQ.install=function(){F$.prototype.equal=fY.prototype.equal=function Z($){return nQ(this,$)}};var BS=F$.prototype.equal,HS=fY.prototype.equal;nQ.restore=function(){F$.prototype.equal=BS,fY.prototype.equal=HS}});var V5=y((Qv,R5)=>{function yY(Z){var $=(Z/8|0)+(Z%8===0?0:1);return $}var DS={ES256:yY(256),ES384:yY(384),ES512:yY(521)};function NS(Z){var $=DS[Z];if($)return $;throw new Error('Unknown algorithm "'+Z+'"')}R5.exports=NS});var g5=y((Yv,k5)=>{var oQ=gZ().Buffer,I5=V5(),tQ=128,b5=0,wS=32,AS=16,LS=2,x5=AS|wS|b5<<6,sQ=LS|b5<<6;function SS(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function T5(Z){if(oQ.isBuffer(Z))return Z;else if(typeof Z==="string")return oQ.from(Z,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function OS(Z,$){Z=T5(Z);var Q=I5($),Y=Q+1,W=Z.length,X=0;if(Z[X++]!==x5)throw new Error('Could not find expected "seq"');var J=Z[X++];if(J===(tQ|1))J=Z[X++];if(W-X<J)throw new Error('"seq" specified length of "'+J+'", only "'+(W-X)+'" remaining');if(Z[X++]!==sQ)throw new Error('Could not find expected "int" for "r"');var z=Z[X++];if(W-X-2<z)throw new Error('"r" specified length of "'+z+'", only "'+(W-X-2)+'" available');if(Y<z)throw new Error('"r" specified length of "'+z+'", max of "'+Y+'" is acceptable');var U=X;if(X+=z,Z[X++]!==sQ)throw new Error('Could not find expected "int" for "s"');var q=Z[X++];if(W-X!==q)throw new Error('"s" specified length of "'+q+'", expected "'+(W-X)+'"');if(Y<q)throw new Error('"s" specified length of "'+q+'", max of "'+Y+'" is acceptable');var G=X;if(X+=q,X!==W)throw new Error('Expected to consume entire buffer, but "'+(W-X)+'" bytes remain');var D=Q-z,A=Q-q,H=oQ.allocUnsafe(D+z+A+q);for(X=0;X<D;++X)H[X]=0;Z.copy(H,X,U+Math.max(-D,0),U+z),X=Q;for(var M=X;X<M+A;++X)H[X]=0;return Z.copy(H,X,G+Math.max(-A,0),G+q),H=H.toString("base64"),H=SS(H),H}function E5(Z,$,Q){var Y=0;while($+Y<Q&&Z[$+Y]===0)++Y;var W=Z[$+Y]>=tQ;if(W)--Y;return Y}function FS(Z,$){Z=T5(Z);var Q=I5($),Y=Z.length;if(Y!==Q*2)throw new TypeError('"'+$+'" signatures must be "'+Q*2+'" bytes, saw "'+Y+'"');var W=E5(Z,0,Q),X=E5(Z,Q,Z.length),J=Q-W,z=Q-X,U=2+J+1+1+z,q=U<tQ,G=oQ.allocUnsafe((q?2:3)+U),D=0;if(G[D++]=x5,q)G[D++]=U;else G[D++]=tQ|1,G[D++]=U&255;if(G[D++]=sQ,G[D++]=J,W<0)G[D++]=0,D+=Z.copy(G,D,0,Q);else D+=Z.copy(G,D,W,Q);if(G[D++]=sQ,G[D++]=z,X<0)G[D++]=0,Z.copy(G,D,Q);else Z.copy(G,D,Q+X);return G}k5.exports={derToJose:OS,joseToDer:FS}});var hY=y((Wv,p5)=>{var _S=j5(),yZ=gZ().Buffer,h1=G8("crypto"),y5=g5(),f5=G8("util"),PS=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,_$="secret must be a string or buffer",fZ="key must be a string or a buffer",KS="key must be a string, a buffer or an object",dY=typeof h1.createPublicKey==="function";if(dY)fZ+=" or a KeyObject",_$+="or a KeyObject";function d5(Z){if(yZ.isBuffer(Z))return;if(typeof Z==="string")return;if(!dY)throw R1(fZ);if(typeof Z!=="object")throw R1(fZ);if(typeof Z.type!=="string")throw R1(fZ);if(typeof Z.asymmetricKeyType!=="string")throw R1(fZ);if(typeof Z.export!=="function")throw R1(fZ)}function v5(Z){if(yZ.isBuffer(Z))return;if(typeof Z==="string")return;if(typeof Z==="object")return;throw R1(KS)}function CS(Z){if(yZ.isBuffer(Z))return;if(typeof Z==="string")return Z;if(!dY)throw R1(_$);if(typeof Z!=="object")throw R1(_$);if(Z.type!=="secret")throw R1(_$);if(typeof Z.export!=="function")throw R1(_$)}function vY(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function h5(Z){Z=Z.toString();var $=4-Z.length%4;if($!==4)for(var Q=0;Q<$;++Q)Z+="=";return Z.replace(/\-/g,"+").replace(/_/g,"/")}function R1(Z){var $=[].slice.call(arguments,1),Q=f5.format.bind(f5,Z).apply(null,$);return new TypeError(Q)}function jS(Z){return yZ.isBuffer(Z)||typeof Z==="string"}function P$(Z){if(!jS(Z))Z=JSON.stringify(Z);return Z}function m5(Z){return function $(Q,Y){CS(Y),Q=P$(Q);var W=h1.createHmac("sha"+Z,Y),X=(W.update(Q),W.digest("base64"));return vY(X)}}function RS(Z){return function $(Q,Y,W){var X=m5(Z)(Q,W);return _S(yZ.from(Y),yZ.from(X))}}function c5(Z){return function $(Q,Y){v5(Y),Q=P$(Q);var W=h1.createSign("RSA-SHA"+Z),X=(W.update(Q),W.sign(Y,"base64"));return vY(X)}}function u5(Z){return function $(Q,Y,W){d5(W),Q=P$(Q),Y=h5(Y);var X=h1.createVerify("RSA-SHA"+Z);return X.update(Q),X.verify(W,Y,"base64")}}function VS(Z){return function $(Q,Y){v5(Y),Q=P$(Q);var W=h1.createSign("RSA-SHA"+Z),X=(W.update(Q),W.sign({key:Y,padding:h1.constants.RSA_PKCS1_PSS_PADDING,saltLength:h1.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return vY(X)}}function ES(Z){return function $(Q,Y,W){d5(W),Q=P$(Q),Y=h5(Y);var X=h1.createVerify("RSA-SHA"+Z);return X.update(Q),X.verify({key:W,padding:h1.constants.RSA_PKCS1_PSS_PADDING,saltLength:h1.constants.RSA_PSS_SALTLEN_DIGEST},Y,"base64")}}function IS(Z){var $=c5(Z);return function Q(){var Y=$.apply(null,arguments);return Y=y5.derToJose(Y,"ES"+Z),Y}}function bS(Z){var $=u5(Z);return function Q(Y,W,X){W=y5.joseToDer(W,"ES"+Z).toString("base64");var J=$(Y,W,X);return J}}function xS(){return function Z(){return""}}function TS(){return function Z($,Q){return Q===""}}p5.exports=function Z($){var Q={hs:m5,rs:c5,ps:VS,es:IS,none:xS},Y={hs:RS,rs:u5,ps:ES,es:bS,none:TS},W=$.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!W)throw R1(PS,$);var X=(W[1]||W[3]).toLowerCase(),J=W[2];return{sign:Q[X](J),verify:Y[X](J)}}});var mY=y((Xv,i5)=>{var kS=G8("buffer").Buffer;i5.exports=function Z($){if(typeof $==="string")return $;if(typeof $==="number"||kS.isBuffer($))return $.toString();return JSON.stringify($)}});var r5=y((Jv,s5)=>{var gS=gZ().Buffer,l5=gY(),fS=hY(),yS=G8("stream"),n5=mY(),cY=G8("util");function o5(Z,$){return gS.from(Z,$).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function dS(Z,$,Q){Q=Q||"utf8";var Y=o5(n5(Z),"binary"),W=o5(n5($),Q);return cY.format("%s.%s",Y,W)}function t5(Z){var{header:$,payload:Q}=Z,Y=Z.secret||Z.privateKey,W=Z.encoding,X=fS($.alg),J=dS($,Q,W),z=X.sign(J,Y);return cY.format("%s.%s",J,z)}function rQ(Z){var $=Z.secret||Z.privateKey||Z.key,Q=new l5($);this.readable=!0,this.header=Z.header,this.encoding=Z.encoding,this.secret=this.privateKey=this.key=Q,this.payload=new l5(Z.payload),this.secret.once("close",function(){if(!this.payload.writable&&this.readable)this.sign()}.bind(this)),this.payload.once("close",function(){if(!this.secret.writable&&this.readable)this.sign()}.bind(this))}cY.inherits(rQ,yS);rQ.prototype.sign=function Z(){try{var $=t5({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",$),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Q){this.readable=!1,this.emit("error",Q),this.emit("close")}};rQ.sign=t5;s5.exports=rQ});var z7=y((zv,J7)=>{var e5=gZ().Buffer,a5=gY(),vS=hY(),hS=G8("stream"),Z7=mY(),mS=G8("util"),cS=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function uS(Z){return Object.prototype.toString.call(Z)==="[object Object]"}function pS(Z){if(uS(Z))return Z;try{return JSON.parse(Z)}catch($){return}}function $7(Z){var $=Z.split(".",1)[0];return pS(e5.from($,"base64").toString("binary"))}function iS(Z){return Z.split(".",2).join(".")}function Q7(Z){return Z.split(".")[2]}function lS(Z,$){$=$||"utf8";var Q=Z.split(".")[1];return e5.from(Q,"base64").toString($)}function Y7(Z){return cS.test(Z)&&!!$7(Z)}function W7(Z,$,Q){if(!$){var Y=new Error("Missing algorithm parameter for jws.verify");throw Y.code="MISSING_ALGORITHM",Y}Z=Z7(Z);var W=Q7(Z),X=iS(Z),J=vS($);return J.verify(X,W,Q)}function X7(Z,$){if($=$||{},Z=Z7(Z),!Y7(Z))return null;var Q=$7(Z);if(!Q)return null;var Y=lS(Z);if(Q.typ==="JWT"||$.json)Y=JSON.parse(Y,$.encoding);return{header:Q,payload:Y,signature:Q7(Z)}}function dZ(Z){Z=Z||{};var $=Z.secret||Z.publicKey||Z.key,Q=new a5($);this.readable=!0,this.algorithm=Z.algorithm,this.encoding=Z.encoding,this.secret=this.publicKey=this.key=Q,this.signature=new a5(Z.signature),this.secret.once("close",function(){if(!this.signature.writable&&this.readable)this.verify()}.bind(this)),this.signature.once("close",function(){if(!this.secret.writable&&this.readable)this.verify()}.bind(this))}mS.inherits(dZ,hS);dZ.prototype.verify=function Z(){try{var $=W7(this.signature.buffer,this.algorithm,this.key.buffer),Q=X7(this.signature.buffer,this.encoding);return this.emit("done",$,Q),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Y){this.readable=!1,this.emit("error",Y),this.emit("close")}};dZ.decode=X7;dZ.isValid=Y7;dZ.verify=W7;J7.exports=dZ});var eQ=y((oS)=>{var U7=r5(),aQ=z7(),nS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];oS.ALGORITHMS=nS;oS.sign=U7.sign;oS.verify=aQ.verify;oS.decode=aQ.decode;oS.isValid=aQ.isValid;oS.createSign=function Z($){return new U7($)};oS.createVerify=function Z($){return new aQ($)}});var uY=y((qv,q7)=>{var QO=eQ();q7.exports=function(Z,$){$=$||{};var Q=QO.decode(Z,$);if(!Q)return null;var Y=Q.payload;if(typeof Y==="string")try{var W=JSON.parse(Y);if(W!==null&&typeof W==="object")Y=W}catch(X){}if($.complete===!0)return{header:Q.header,payload:Y,signature:Q.signature};return Y}});var K$=y((Gv,G7)=>{var Z9=function(Z,$){if(Error.call(this,Z),Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);if(this.name="JsonWebTokenError",this.message=Z,$)this.inner=$};Z9.prototype=Object.create(Error.prototype);Z9.prototype.constructor=Z9;G7.exports=Z9});var pY=y((Mv,B7)=>{var M7=K$(),$9=function(Z,$){M7.call(this,Z),this.name="NotBeforeError",this.date=$};$9.prototype=Object.create(M7.prototype);$9.prototype.constructor=$9;B7.exports=$9});var iY=y((Bv,D7)=>{var H7=K$(),Q9=function(Z,$){H7.call(this,Z),this.name="TokenExpiredError",this.expiredAt=$};Q9.prototype=Object.create(H7.prototype);Q9.prototype.constructor=Q9;D7.exports=Q9});var lY=y((Hv,N7)=>{var WO=YO();N7.exports=function(Z,$){var Q=$||Math.floor(Date.now()/1000);if(typeof Z==="string"){var Y=WO(Z);if(typeof Y==="undefined")return;return Math.floor(Q+Y/1000)}else if(typeof Z==="number")return Q+Z;else return}});var C$=y((Dv,w7)=>{var XO=Number.MAX_SAFE_INTEGER||9007199254740991,JO=["major","premajor","minor","preminor","patch","prepatch","prerelease"];w7.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:XO,RELEASE_TYPES:JO,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var j$=y((Nv,A7)=>{var zO=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...Z)=>console.error("SEMVER",...Z):()=>{};A7.exports=zO});var vZ=y((m1,L7)=>{var{MAX_SAFE_COMPONENT_LENGTH:nY,MAX_SAFE_BUILD_LENGTH:UO,MAX_LENGTH:qO}=C$(),GO=j$();m1=L7.exports={};var MO=m1.re=[],BO=m1.safeRe=[],v=m1.src=[],HO=m1.safeSrc=[],h=m1.t={},DO=0,oY="[a-zA-Z0-9-]",NO=[["\\s",1],["\\d",qO],[oY,UO]],wO=(Z)=>{for(let[$,Q]of NO)Z=Z.split(`${$}*`).join(`${$}{0,${Q}}`).split(`${$}+`).join(`${$}{1,${Q}}`);return Z},s=(Z,$,Q)=>{let Y=wO($),W=DO++;GO(Z,W,$),h[Z]=W,v[W]=$,HO[W]=Y,MO[W]=new RegExp($,Q?"g":void 0),BO[W]=new RegExp(Y,Q?"g":void 0)};s("NUMERICIDENTIFIER","0|[1-9]\\d*");s("NUMERICIDENTIFIERLOOSE","\\d+");s("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${oY}*`);s("MAINVERSION",`(${v[h.NUMERICIDENTIFIER]})\\.(${v[h.NUMERICIDENTIFIER]})\\.(${v[h.NUMERICIDENTIFIER]})`);s("MAINVERSIONLOOSE",`(${v[h.NUMERICIDENTIFIERLOOSE]})\\.(${v[h.NUMERICIDENTIFIERLOOSE]})\\.(${v[h.NUMERICIDENTIFIERLOOSE]})`);s("PRERELEASEIDENTIFIER",`(?:${v[h.NUMERICIDENTIFIER]}|${v[h.NONNUMERICIDENTIFIER]})`);s("PRERELEASEIDENTIFIERLOOSE",`(?:${v[h.NUMERICIDENTIFIERLOOSE]}|${v[h.NONNUMERICIDENTIFIER]})`);s("PRERELEASE",`(?:-(${v[h.PRERELEASEIDENTIFIER]}(?:\\.${v[h.PRERELEASEIDENTIFIER]})*))`);s("PRERELEASELOOSE",`(?:-?(${v[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${v[h.PRERELEASEIDENTIFIERLOOSE]})*))`);s("BUILDIDENTIFIER",`${oY}+`);s("BUILD",`(?:\\+(${v[h.BUILDIDENTIFIER]}(?:\\.${v[h.BUILDIDENTIFIER]})*))`);s("FULLPLAIN",`v?${v[h.MAINVERSION]}${v[h.PRERELEASE]}?${v[h.BUILD]}?`);s("FULL",`^${v[h.FULLPLAIN]}$`);s("LOOSEPLAIN",`[v=\\s]*${v[h.MAINVERSIONLOOSE]}${v[h.PRERELEASELOOSE]}?${v[h.BUILD]}?`);s("LOOSE",`^${v[h.LOOSEPLAIN]}$`);s("GTLT","((?:<|>)?=?)");s("XRANGEIDENTIFIERLOOSE",`${v[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);s("XRANGEIDENTIFIER",`${v[h.NUMERICIDENTIFIER]}|x|X|\\*`);s("XRANGEPLAIN",`[v=\\s]*(${v[h.XRANGEIDENTIFIER]})(?:\\.(${v[h.XRANGEIDENTIFIER]})(?:\\.(${v[h.XRANGEIDENTIFIER]})(?:${v[h.PRERELEASE]})?${v[h.BUILD]}?)?)?`);s("XRANGEPLAINLOOSE",`[v=\\s]*(${v[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${v[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${v[h.XRANGEIDENTIFIERLOOSE]})(?:${v[h.PRERELEASELOOSE]})?${v[h.BUILD]}?)?)?`);s("XRANGE",`^${v[h.GTLT]}\\s*${v[h.XRANGEPLAIN]}$`);s("XRANGELOOSE",`^${v[h.GTLT]}\\s*${v[h.XRANGEPLAINLOOSE]}$`);s("COERCEPLAIN",`(^|[^\\d])(\\d{1,${nY}})(?:\\.(\\d{1,${nY}}))?(?:\\.(\\d{1,${nY}}))?`);s("COERCE",`${v[h.COERCEPLAIN]}(?:$|[^\\d])`);s("COERCEFULL",v[h.COERCEPLAIN]+`(?:${v[h.PRERELEASE]})?(?:${v[h.BUILD]})?(?:$|[^\\d])`);s("COERCERTL",v[h.COERCE],!0);s("COERCERTLFULL",v[h.COERCEFULL],!0);s("LONETILDE","(?:~>?)");s("TILDETRIM",`(\\s*)${v[h.LONETILDE]}\\s+`,!0);m1.tildeTrimReplace="$1~";s("TILDE",`^${v[h.LONETILDE]}${v[h.XRANGEPLAIN]}$`);s("TILDELOOSE",`^${v[h.LONETILDE]}${v[h.XRANGEPLAINLOOSE]}$`);s("LONECARET","(?:\\^)");s("CARETTRIM",`(\\s*)${v[h.LONECARET]}\\s+`,!0);m1.caretTrimReplace="$1^";s("CARET",`^${v[h.LONECARET]}${v[h.XRANGEPLAIN]}$`);s("CARETLOOSE",`^${v[h.LONECARET]}${v[h.XRANGEPLAINLOOSE]}$`);s("COMPARATORLOOSE",`^${v[h.GTLT]}\\s*(${v[h.LOOSEPLAIN]})$|^$`);s("COMPARATOR",`^${v[h.GTLT]}\\s*(${v[h.FULLPLAIN]})$|^$`);s("COMPARATORTRIM",`(\\s*)${v[h.GTLT]}\\s*(${v[h.LOOSEPLAIN]}|${v[h.XRANGEPLAIN]})`,!0);m1.comparatorTrimReplace="$1$2$3";s("HYPHENRANGE",`^\\s*(${v[h.XRANGEPLAIN]})\\s+-\\s+(${v[h.XRANGEPLAIN]})\\s*$`);s("HYPHENRANGELOOSE",`^\\s*(${v[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${v[h.XRANGEPLAINLOOSE]})\\s*$`);s("STAR","(<|>)?=?\\s*\\*");s("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");s("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Y9=y((wv,S7)=>{var AO=Object.freeze({loose:!0}),LO=Object.freeze({}),SO=(Z)=>{if(!Z)return LO;if(typeof Z!=="object")return AO;return Z};S7.exports=SO});var tY=y((Av,_7)=>{var O7=/^[0-9]+$/,F7=(Z,$)=>{let Q=O7.test(Z),Y=O7.test($);if(Q&&Y)Z=+Z,$=+$;return Z===$?0:Q&&!Y?-1:Y&&!Q?1:Z<$?-1:1},OO=(Z,$)=>F7($,Z);_7.exports={compareIdentifiers:F7,rcompareIdentifiers:OO}});var L8=y((Lv,j7)=>{var W9=j$(),{MAX_LENGTH:P7,MAX_SAFE_INTEGER:X9}=C$(),{safeRe:K7,safeSrc:C7,t:J9}=vZ(),FO=Y9(),{compareIdentifiers:hZ}=tY();class V1{constructor(Z,$){if($=FO($),Z instanceof V1)if(Z.loose===!!$.loose&&Z.includePrerelease===!!$.includePrerelease)return Z;else Z=Z.version;else if(typeof Z!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof Z}".`);if(Z.length>P7)throw new TypeError(`version is longer than ${P7} characters`);W9("SemVer",Z,$),this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease;let Q=Z.trim().match($.loose?K7[J9.LOOSE]:K7[J9.FULL]);if(!Q)throw new TypeError(`Invalid Version: ${Z}`);if(this.raw=Z,this.major=+Q[1],this.minor=+Q[2],this.patch=+Q[3],this.major>X9||this.major<0)throw new TypeError("Invalid major version");if(this.minor>X9||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>X9||this.patch<0)throw new TypeError("Invalid patch version");if(!Q[4])this.prerelease=[];else this.prerelease=Q[4].split(".").map((Y)=>{if(/^[0-9]+$/.test(Y)){let W=+Y;if(W>=0&&W<X9)return W}return Y});this.build=Q[5]?Q[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare(Z){if(W9("SemVer.compare",this.version,this.options,Z),!(Z instanceof V1)){if(typeof Z==="string"&&Z===this.version)return 0;Z=new V1(Z,this.options)}if(Z.version===this.version)return 0;return this.compareMain(Z)||this.comparePre(Z)}compareMain(Z){if(!(Z instanceof V1))Z=new V1(Z,this.options);return hZ(this.major,Z.major)||hZ(this.minor,Z.minor)||hZ(this.patch,Z.patch)}comparePre(Z){if(!(Z instanceof V1))Z=new V1(Z,this.options);if(this.prerelease.length&&!Z.prerelease.length)return-1;else if(!this.prerelease.length&&Z.prerelease.length)return 1;else if(!this.prerelease.length&&!Z.prerelease.length)return 0;let $=0;do{let Q=this.prerelease[$],Y=Z.prerelease[$];if(W9("prerelease compare",$,Q,Y),Q===void 0&&Y===void 0)return 0;else if(Y===void 0)return 1;else if(Q===void 0)return-1;else if(Q===Y)continue;else return hZ(Q,Y)}while(++$)}compareBuild(Z){if(!(Z instanceof V1))Z=new V1(Z,this.options);let $=0;do{let Q=this.build[$],Y=Z.build[$];if(W9("build compare",$,Q,Y),Q===void 0&&Y===void 0)return 0;else if(Y===void 0)return 1;else if(Q===void 0)return-1;else if(Q===Y)continue;else return hZ(Q,Y)}while(++$)}inc(Z,$,Q){if(Z.startsWith("pre")){if(!$&&Q===!1)throw new Error("invalid increment argument: identifier is empty");if($){let Y=new RegExp(`^${this.options.loose?C7[J9.PRERELEASELOOSE]:C7[J9.PRERELEASE]}$`),W=`-${$}`.match(Y);if(!W||W[1]!==$)throw new Error(`invalid identifier: ${$}`)}}switch(Z){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",$,Q);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",$,Q);break;case"prepatch":this.prerelease.length=0,this.inc("patch",$,Q),this.inc("pre",$,Q);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",$,Q);this.inc("pre",$,Q);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let Y=Number(Q)?1:0;if(this.prerelease.length===0)this.prerelease=[Y];else{let W=this.prerelease.length;while(--W>=0)if(typeof this.prerelease[W]==="number")this.prerelease[W]++,W=-2;if(W===-1){if($===this.prerelease.join(".")&&Q===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Y)}}if($){let W=[$,Y];if(Q===!1)W=[$];if(hZ(this.prerelease[0],$)===0){if(isNaN(this.prerelease[1]))this.prerelease=W}else this.prerelease=W}break}default:throw new Error(`invalid increment argument: ${Z}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}j7.exports=V1});var QZ=y((Sv,V7)=>{var R7=L8(),_O=(Z,$,Q=!1)=>{if(Z instanceof R7)return Z;try{return new R7(Z,$)}catch(Y){if(!Q)return null;throw Y}};V7.exports=_O});var I7=y((Ov,E7)=>{var PO=QZ(),KO=(Z,$)=>{let Q=PO(Z,$);return Q?Q.version:null};E7.exports=KO});var x7=y((Fv,b7)=>{var CO=QZ(),jO=(Z,$)=>{let Q=CO(Z.trim().replace(/^[=v]+/,""),$);return Q?Q.version:null};b7.exports=jO});var g7=y((_v,k7)=>{var T7=L8(),RO=(Z,$,Q,Y,W)=>{if(typeof Q==="string")W=Y,Y=Q,Q=void 0;try{return new T7(Z instanceof T7?Z.version:Z,Q).inc($,Y,W).version}catch(X){return null}};k7.exports=RO});var d7=y((Pv,y7)=>{var f7=QZ(),VO=(Z,$)=>{let Q=f7(Z,null,!0),Y=f7($,null,!0),W=Q.compare(Y);if(W===0)return null;let X=W>0,J=X?Q:Y,z=X?Y:Q,U=!!J.prerelease.length;if(!!z.prerelease.length&&!U){if(!z.patch&&!z.minor)return"major";if(z.compareMain(J)===0){if(z.minor&&!z.patch)return"minor";return"patch"}}let G=U?"pre":"";if(Q.major!==Y.major)return G+"major";if(Q.minor!==Y.minor)return G+"minor";if(Q.patch!==Y.patch)return G+"patch";return"prerelease"};y7.exports=VO});var h7=y((Kv,v7)=>{var EO=L8(),IO=(Z,$)=>new EO(Z,$).major;v7.exports=IO});var c7=y((Cv,m7)=>{var bO=L8(),xO=(Z,$)=>new bO(Z,$).minor;m7.exports=xO});var p7=y((jv,u7)=>{var TO=L8(),kO=(Z,$)=>new TO(Z,$).patch;u7.exports=kO});var l7=y((Rv,i7)=>{var gO=QZ(),fO=(Z,$)=>{let Q=gO(Z,$);return Q&&Q.prerelease.length?Q.prerelease:null};i7.exports=fO});var J1=y((Vv,o7)=>{var n7=L8(),yO=(Z,$,Q)=>new n7(Z,Q).compare(new n7($,Q));o7.exports=yO});var s7=y((Ev,t7)=>{var dO=J1(),vO=(Z,$,Q)=>dO($,Z,Q);t7.exports=vO});var a7=y((Iv,r7)=>{var hO=J1(),mO=(Z,$)=>hO(Z,$,!0);r7.exports=mO});var z9=y((bv,ZJ)=>{var e7=L8(),cO=(Z,$,Q)=>{let Y=new e7(Z,Q),W=new e7($,Q);return Y.compare(W)||Y.compareBuild(W)};ZJ.exports=cO});var QJ=y((xv,$J)=>{var uO=z9(),pO=(Z,$)=>Z.sort((Q,Y)=>uO(Q,Y,$));$J.exports=pO});var WJ=y((Tv,YJ)=>{var iO=z9(),lO=(Z,$)=>Z.sort((Q,Y)=>iO(Y,Q,$));YJ.exports=lO});var R$=y((kv,XJ)=>{var nO=J1(),oO=(Z,$,Q)=>nO(Z,$,Q)>0;XJ.exports=oO});var U9=y((gv,JJ)=>{var tO=J1(),sO=(Z,$,Q)=>tO(Z,$,Q)<0;JJ.exports=sO});var sY=y((fv,zJ)=>{var rO=J1(),aO=(Z,$,Q)=>rO(Z,$,Q)===0;zJ.exports=aO});var rY=y((yv,UJ)=>{var eO=J1(),ZF=(Z,$,Q)=>eO(Z,$,Q)!==0;UJ.exports=ZF});var q9=y((dv,qJ)=>{var $F=J1(),QF=(Z,$,Q)=>$F(Z,$,Q)>=0;qJ.exports=QF});var G9=y((vv,GJ)=>{var YF=J1(),WF=(Z,$,Q)=>YF(Z,$,Q)<=0;GJ.exports=WF});var aY=y((hv,MJ)=>{var XF=sY(),JF=rY(),zF=R$(),UF=q9(),qF=U9(),GF=G9(),MF=(Z,$,Q,Y)=>{switch($){case"===":if(typeof Z==="object")Z=Z.version;if(typeof Q==="object")Q=Q.version;return Z===Q;case"!==":if(typeof Z==="object")Z=Z.version;if(typeof Q==="object")Q=Q.version;return Z!==Q;case"":case"=":case"==":return XF(Z,Q,Y);case"!=":return JF(Z,Q,Y);case">":return zF(Z,Q,Y);case">=":return UF(Z,Q,Y);case"<":return qF(Z,Q,Y);case"<=":return GF(Z,Q,Y);default:throw new TypeError(`Invalid operator: ${$}`)}};MJ.exports=MF});var HJ=y((mv,BJ)=>{var BF=L8(),HF=QZ(),{safeRe:M9,t:B9}=vZ(),DF=(Z,$)=>{if(Z instanceof BF)return Z;if(typeof Z==="number")Z=String(Z);if(typeof Z!=="string")return null;$=$||{};let Q=null;if(!$.rtl)Q=Z.match($.includePrerelease?M9[B9.COERCEFULL]:M9[B9.COERCE]);else{let U=$.includePrerelease?M9[B9.COERCERTLFULL]:M9[B9.COERCERTL],q;while((q=U.exec(Z))&&(!Q||Q.index+Q[0].length!==Z.length)){if(!Q||q.index+q[0].length!==Q.index+Q[0].length)Q=q;U.lastIndex=q.index+q[1].length+q[2].length}U.lastIndex=-1}if(Q===null)return null;let Y=Q[2],W=Q[3]||"0",X=Q[4]||"0",J=$.includePrerelease&&Q[5]?`-${Q[5]}`:"",z=$.includePrerelease&&Q[6]?`+${Q[6]}`:"";return HF(`${Y}.${W}.${X}${J}${z}`,$)};BJ.exports=DF});var wJ=y((cv,NJ)=>{class DJ{constructor(){this.max=1000,this.map=new Map}get(Z){let $=this.map.get(Z);if($===void 0)return;else return this.map.delete(Z),this.map.set(Z,$),$}delete(Z){return this.map.delete(Z)}set(Z,$){if(!this.delete(Z)&&$!==void 0){if(this.map.size>=this.max){let Y=this.map.keys().next().value;this.delete(Y)}this.map.set(Z,$)}return this}}NJ.exports=DJ});var z1=y((uv,OJ)=>{var NF=/\s+/g;class V${constructor(Z,$){if($=AF($),Z instanceof V$)if(Z.loose===!!$.loose&&Z.includePrerelease===!!$.includePrerelease)return Z;else return new V$(Z.raw,$);if(Z instanceof eY)return this.raw=Z.value,this.set=[[Z]],this.formatted=void 0,this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=Z.trim().replace(NF," "),this.set=this.raw.split("||").map((Q)=>this.parseRange(Q.trim())).filter((Q)=>Q.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let Q=this.set[0];if(this.set=this.set.filter((Y)=>!LJ(Y[0])),this.set.length===0)this.set=[Q];else if(this.set.length>1){for(let Y of this.set)if(Y.length===1&&KF(Y[0])){this.set=[Y];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let Z=0;Z<this.set.length;Z++){if(Z>0)this.formatted+="||";let $=this.set[Z];for(let Q=0;Q<$.length;Q++){if(Q>0)this.formatted+=" ";this.formatted+=$[Q].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(Z){let Q=((this.options.includePrerelease&&_F)|(this.options.loose&&PF))+":"+Z,Y=AJ.get(Q);if(Y)return Y;let W=this.options.loose,X=W?h8[C8.HYPHENRANGELOOSE]:h8[C8.HYPHENRANGE];Z=Z.replace(X,kF(this.options.includePrerelease)),y0("hyphen replace",Z),Z=Z.replace(h8[C8.COMPARATORTRIM],SF),y0("comparator trim",Z),Z=Z.replace(h8[C8.TILDETRIM],OF),y0("tilde trim",Z),Z=Z.replace(h8[C8.CARETTRIM],FF),y0("caret trim",Z);let J=Z.split(" ").map((G)=>CF(G,this.options)).join(" ").split(/\s+/).map((G)=>TF(G,this.options));if(W)J=J.filter((G)=>{return y0("loose invalid filter",G,this.options),!!G.match(h8[C8.COMPARATORLOOSE])});y0("range list",J);let z=new Map,U=J.map((G)=>new eY(G,this.options));for(let G of U){if(LJ(G))return[G];z.set(G.value,G)}if(z.size>1&&z.has(""))z.delete("");let q=[...z.values()];return AJ.set(Q,q),q}intersects(Z,$){if(!(Z instanceof V$))throw new TypeError("a Range is required");return this.set.some((Q)=>{return SJ(Q,$)&&Z.set.some((Y)=>{return SJ(Y,$)&&Q.every((W)=>{return Y.every((X)=>{return W.intersects(X,$)})})})})}test(Z){if(!Z)return!1;if(typeof Z==="string")try{Z=new LF(Z,this.options)}catch($){return!1}for(let $=0;$<this.set.length;$++)if(gF(this.set[$],Z,this.options))return!0;return!1}}OJ.exports=V$;var wF=wJ(),AJ=new wF,AF=Y9(),eY=E$(),y0=j$(),LF=L8(),{safeRe:h8,t:C8,comparatorTrimReplace:SF,tildeTrimReplace:OF,caretTrimReplace:FF}=vZ(),{FLAG_INCLUDE_PRERELEASE:_F,FLAG_LOOSE:PF}=C$(),LJ=(Z)=>Z.value==="<0.0.0-0",KF=(Z)=>Z.value==="",SJ=(Z,$)=>{let Q=!0,Y=Z.slice(),W=Y.pop();while(Q&&Y.length)Q=Y.every((X)=>{return W.intersects(X,$)}),W=Y.pop();return Q},CF=(Z,$)=>{return y0("comp",Z,$),Z=VF(Z,$),y0("caret",Z),Z=jF(Z,$),y0("tildes",Z),Z=IF(Z,$),y0("xrange",Z),Z=xF(Z,$),y0("stars",Z),Z},j8=(Z)=>!Z||Z.toLowerCase()==="x"||Z==="*",jF=(Z,$)=>{return Z.trim().split(/\s+/).map((Q)=>RF(Q,$)).join(" ")},RF=(Z,$)=>{let Q=$.loose?h8[C8.TILDELOOSE]:h8[C8.TILDE];return Z.replace(Q,(Y,W,X,J,z)=>{y0("tilde",Z,Y,W,X,J,z);let U;if(j8(W))U="";else if(j8(X))U=`>=${W}.0.0 <${+W+1}.0.0-0`;else if(j8(J))U=`>=${W}.${X}.0 <${W}.${+X+1}.0-0`;else if(z)y0("replaceTilde pr",z),U=`>=${W}.${X}.${J}-${z} <${W}.${+X+1}.0-0`;else U=`>=${W}.${X}.${J} <${W}.${+X+1}.0-0`;return y0("tilde return",U),U})},VF=(Z,$)=>{return Z.trim().split(/\s+/).map((Q)=>EF(Q,$)).join(" ")},EF=(Z,$)=>{y0("caret",Z,$);let Q=$.loose?h8[C8.CARETLOOSE]:h8[C8.CARET],Y=$.includePrerelease?"-0":"";return Z.replace(Q,(W,X,J,z,U)=>{y0("caret",Z,W,X,J,z,U);let q;if(j8(X))q="";else if(j8(J))q=`>=${X}.0.0${Y} <${+X+1}.0.0-0`;else if(j8(z))if(X==="0")q=`>=${X}.${J}.0${Y} <${X}.${+J+1}.0-0`;else q=`>=${X}.${J}.0${Y} <${+X+1}.0.0-0`;else if(U)if(y0("replaceCaret pr",U),X==="0")if(J==="0")q=`>=${X}.${J}.${z}-${U} <${X}.${J}.${+z+1}-0`;else q=`>=${X}.${J}.${z}-${U} <${X}.${+J+1}.0-0`;else q=`>=${X}.${J}.${z}-${U} <${+X+1}.0.0-0`;else if(y0("no pr"),X==="0")if(J==="0")q=`>=${X}.${J}.${z}${Y} <${X}.${J}.${+z+1}-0`;else q=`>=${X}.${J}.${z}${Y} <${X}.${+J+1}.0-0`;else q=`>=${X}.${J}.${z} <${+X+1}.0.0-0`;return y0("caret return",q),q})},IF=(Z,$)=>{return y0("replaceXRanges",Z,$),Z.split(/\s+/).map((Q)=>bF(Q,$)).join(" ")},bF=(Z,$)=>{Z=Z.trim();let Q=$.loose?h8[C8.XRANGELOOSE]:h8[C8.XRANGE];return Z.replace(Q,(Y,W,X,J,z,U)=>{y0("xRange",Z,Y,W,X,J,z,U);let q=j8(X),G=q||j8(J),D=G||j8(z),A=D;if(W==="="&&A)W="";if(U=$.includePrerelease?"-0":"",q)if(W===">"||W==="<")Y="<0.0.0-0";else Y="*";else if(W&&A){if(G)J=0;if(z=0,W===">")if(W=">=",G)X=+X+1,J=0,z=0;else J=+J+1,z=0;else if(W==="<=")if(W="<",G)X=+X+1;else J=+J+1;if(W==="<")U="-0";Y=`${W+X}.${J}.${z}${U}`}else if(G)Y=`>=${X}.0.0${U} <${+X+1}.0.0-0`;else if(D)Y=`>=${X}.${J}.0${U} <${X}.${+J+1}.0-0`;return y0("xRange return",Y),Y})},xF=(Z,$)=>{return y0("replaceStars",Z,$),Z.trim().replace(h8[C8.STAR],"")},TF=(Z,$)=>{return y0("replaceGTE0",Z,$),Z.trim().replace(h8[$.includePrerelease?C8.GTE0PRE:C8.GTE0],"")},kF=(Z)=>($,Q,Y,W,X,J,z,U,q,G,D,A)=>{if(j8(Y))Q="";else if(j8(W))Q=`>=${Y}.0.0${Z?"-0":""}`;else if(j8(X))Q=`>=${Y}.${W}.0${Z?"-0":""}`;else if(J)Q=`>=${Q}`;else Q=`>=${Q}${Z?"-0":""}`;if(j8(q))U="";else if(j8(G))U=`<${+q+1}.0.0-0`;else if(j8(D))U=`<${q}.${+G+1}.0-0`;else if(A)U=`<=${q}.${G}.${D}-${A}`;else if(Z)U=`<${q}.${G}.${+D+1}-0`;else U=`<=${U}`;return`${Q} ${U}`.trim()},gF=(Z,$,Q)=>{for(let Y=0;Y<Z.length;Y++)if(!Z[Y].test($))return!1;if($.prerelease.length&&!Q.includePrerelease){for(let Y=0;Y<Z.length;Y++){if(y0(Z[Y].semver),Z[Y].semver===eY.ANY)continue;if(Z[Y].semver.prerelease.length>0){let W=Z[Y].semver;if(W.major===$.major&&W.minor===$.minor&&W.patch===$.patch)return!0}}return!1}return!0}});var E$=y((pv,jJ)=>{var I$=Symbol("SemVer ANY");class H9{static get ANY(){return I$}constructor(Z,$){if($=FJ($),Z instanceof H9)if(Z.loose===!!$.loose)return Z;else Z=Z.value;if(Z=Z.trim().split(/\s+/).join(" "),$2("comparator",Z,$),this.options=$,this.loose=!!$.loose,this.parse(Z),this.semver===I$)this.value="";else this.value=this.operator+this.semver.version;$2("comp",this)}parse(Z){let $=this.options.loose?_J[PJ.COMPARATORLOOSE]:_J[PJ.COMPARATOR],Q=Z.match($);if(!Q)throw new TypeError(`Invalid comparator: ${Z}`);if(this.operator=Q[1]!==void 0?Q[1]:"",this.operator==="=")this.operator="";if(!Q[2])this.semver=I$;else this.semver=new KJ(Q[2],this.options.loose)}toString(){return this.value}test(Z){if($2("Comparator.test",Z,this.options.loose),this.semver===I$||Z===I$)return!0;if(typeof Z==="string")try{Z=new KJ(Z,this.options)}catch($){return!1}return Z2(Z,this.operator,this.semver,this.options)}intersects(Z,$){if(!(Z instanceof H9))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new CJ(Z.value,$).test(this.value)}else if(Z.operator===""){if(Z.value==="")return!0;return new CJ(this.value,$).test(Z.semver)}if($=FJ($),$.includePrerelease&&(this.value==="<0.0.0-0"||Z.value==="<0.0.0-0"))return!1;if(!$.includePrerelease&&(this.value.startsWith("<0.0.0")||Z.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&Z.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&Z.operator.startsWith("<"))return!0;if(this.semver.version===Z.semver.version&&this.operator.includes("=")&&Z.operator.includes("="))return!0;if(Z2(this.semver,"<",Z.semver,$)&&this.operator.startsWith(">")&&Z.operator.startsWith("<"))return!0;if(Z2(this.semver,">",Z.semver,$)&&this.operator.startsWith("<")&&Z.operator.startsWith(">"))return!0;return!1}}jJ.exports=H9;var FJ=Y9(),{safeRe:_J,t:PJ}=vZ(),Z2=aY(),$2=j$(),KJ=L8(),CJ=z1()});var b$=y((iv,RJ)=>{var fF=z1(),yF=(Z,$,Q)=>{try{$=new fF($,Q)}catch(Y){return!1}return $.test(Z)};RJ.exports=yF});var EJ=y((lv,VJ)=>{var dF=z1(),vF=(Z,$)=>new dF(Z,$).set.map((Q)=>Q.map((Y)=>Y.value).join(" ").trim().split(" "));VJ.exports=vF});var bJ=y((nv,IJ)=>{var hF=L8(),mF=z1(),cF=(Z,$,Q)=>{let Y=null,W=null,X=null;try{X=new mF($,Q)}catch(J){return null}return Z.forEach((J)=>{if(X.test(J)){if(!Y||W.compare(J)===-1)Y=J,W=new hF(Y,Q)}}),Y};IJ.exports=cF});var TJ=y((ov,xJ)=>{var uF=L8(),pF=z1(),iF=(Z,$,Q)=>{let Y=null,W=null,X=null;try{X=new pF($,Q)}catch(J){return null}return Z.forEach((J)=>{if(X.test(J)){if(!Y||W.compare(J)===1)Y=J,W=new uF(Y,Q)}}),Y};xJ.exports=iF});var fJ=y((tv,gJ)=>{var Q2=L8(),lF=z1(),kJ=R$(),nF=(Z,$)=>{Z=new lF(Z,$);let Q=new Q2("0.0.0");if(Z.test(Q))return Q;if(Q=new Q2("0.0.0-0"),Z.test(Q))return Q;Q=null;for(let Y=0;Y<Z.set.length;++Y){let W=Z.set[Y],X=null;if(W.forEach((J)=>{let z=new Q2(J.semver.version);switch(J.operator){case">":if(z.prerelease.length===0)z.patch++;else z.prerelease.push(0);z.raw=z.format();case"":case">=":if(!X||kJ(z,X))X=z;break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${J.operator}`)}}),X&&(!Q||kJ(Q,X)))Q=X}if(Q&&Z.test(Q))return Q;return null};gJ.exports=nF});var dJ=y((sv,yJ)=>{var oF=z1(),tF=(Z,$)=>{try{return new oF(Z,$).range||"*"}catch(Q){return null}};yJ.exports=tF});var D9=y((rv,cJ)=>{var sF=L8(),mJ=E$(),{ANY:rF}=mJ,aF=z1(),eF=b$(),vJ=R$(),hJ=U9(),Z_=G9(),$_=q9(),Q_=(Z,$,Q,Y)=>{Z=new sF(Z,Y),$=new aF($,Y);let W,X,J,z,U;switch(Q){case">":W=vJ,X=Z_,J=hJ,z=">",U=">=";break;case"<":W=hJ,X=$_,J=vJ,z="<",U="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(eF(Z,$,Y))return!1;for(let q=0;q<$.set.length;++q){let G=$.set[q],D=null,A=null;if(G.forEach((H)=>{if(H.semver===rF)H=new mJ(">=0.0.0");if(D=D||H,A=A||H,W(H.semver,D.semver,Y))D=H;else if(J(H.semver,A.semver,Y))A=H}),D.operator===z||D.operator===U)return!1;if((!A.operator||A.operator===z)&&X(Z,A.semver))return!1;else if(A.operator===U&&J(Z,A.semver))return!1}return!0};cJ.exports=Q_});var pJ=y((av,uJ)=>{var Y_=D9(),W_=(Z,$,Q)=>Y_(Z,$,">",Q);uJ.exports=W_});var lJ=y((ev,iJ)=>{var X_=D9(),J_=(Z,$,Q)=>X_(Z,$,"<",Q);iJ.exports=J_});var tJ=y((Zh,oJ)=>{var nJ=z1(),z_=(Z,$,Q)=>{return Z=new nJ(Z,Q),$=new nJ($,Q),Z.intersects($,Q)};oJ.exports=z_});var rJ=y(($h,sJ)=>{var U_=b$(),q_=J1();sJ.exports=(Z,$,Q)=>{let Y=[],W=null,X=null,J=Z.sort((G,D)=>q_(G,D,Q));for(let G of J)if(U_(G,$,Q)){if(X=G,!W)W=G}else{if(X)Y.push([W,X]);X=null,W=null}if(W)Y.push([W,null]);let z=[];for(let[G,D]of Y)if(G===D)z.push(G);else if(!D&&G===J[0])z.push("*");else if(!D)z.push(`>=${G}`);else if(G===J[0])z.push(`<=${D}`);else z.push(`${G} - ${D}`);let U=z.join(" || "),q=typeof $.raw==="string"?$.raw:String($);return U.length<q.length?U:$}});var Yz=y((Qh,Qz)=>{var aJ=z1(),W2=E$(),{ANY:Y2}=W2,x$=b$(),X2=J1(),G_=(Z,$,Q={})=>{if(Z===$)return!0;Z=new aJ(Z,Q),$=new aJ($,Q);let Y=!1;Z:for(let W of Z.set){for(let X of $.set){let J=B_(W,X,Q);if(Y=Y||J!==null,J)continue Z}if(Y)return!1}return!0},M_=[new W2(">=0.0.0-0")],eJ=[new W2(">=0.0.0")],B_=(Z,$,Q)=>{if(Z===$)return!0;if(Z.length===1&&Z[0].semver===Y2)if($.length===1&&$[0].semver===Y2)return!0;else if(Q.includePrerelease)Z=M_;else Z=eJ;if($.length===1&&$[0].semver===Y2)if(Q.includePrerelease)return!0;else $=eJ;let Y=new Set,W,X;for(let H of Z)if(H.operator===">"||H.operator===">=")W=Zz(W,H,Q);else if(H.operator==="<"||H.operator==="<=")X=$z(X,H,Q);else Y.add(H.semver);if(Y.size>1)return null;let J;if(W&&X){if(J=X2(W.semver,X.semver,Q),J>0)return null;else if(J===0&&(W.operator!==">="||X.operator!=="<="))return null}for(let H of Y){if(W&&!x$(H,String(W),Q))return null;if(X&&!x$(H,String(X),Q))return null;for(let M of $)if(!x$(H,String(M),Q))return!1;return!0}let z,U,q,G,D=X&&!Q.includePrerelease&&X.semver.prerelease.length?X.semver:!1,A=W&&!Q.includePrerelease&&W.semver.prerelease.length?W.semver:!1;if(D&&D.prerelease.length===1&&X.operator==="<"&&D.prerelease[0]===0)D=!1;for(let H of $){if(G=G||H.operator===">"||H.operator===">=",q=q||H.operator==="<"||H.operator==="<=",W){if(A){if(H.semver.prerelease&&H.semver.prerelease.length&&H.semver.major===A.major&&H.semver.minor===A.minor&&H.semver.patch===A.patch)A=!1}if(H.operator===">"||H.operator===">="){if(z=Zz(W,H,Q),z===H&&z!==W)return!1}else if(W.operator===">="&&!x$(W.semver,String(H),Q))return!1}if(X){if(D){if(H.semver.prerelease&&H.semver.prerelease.length&&H.semver.major===D.major&&H.semver.minor===D.minor&&H.semver.patch===D.patch)D=!1}if(H.operator==="<"||H.operator==="<="){if(U=$z(X,H,Q),U===H&&U!==X)return!1}else if(X.operator==="<="&&!x$(X.semver,String(H),Q))return!1}if(!H.operator&&(X||W)&&J!==0)return!1}if(W&&q&&!X&&J!==0)return!1;if(X&&G&&!W&&J!==0)return!1;if(A||D)return!1;return!0},Zz=(Z,$,Q)=>{if(!Z)return $;let Y=X2(Z.semver,$.semver,Q);return Y>0?Z:Y<0?$:$.operator===">"&&Z.operator===">="?$:Z},$z=(Z,$,Q)=>{if(!Z)return $;let Y=X2(Z.semver,$.semver,Q);return Y<0?Z:Y>0?$:$.operator==="<"&&Z.operator==="<="?$:Z};Qz.exports=G_});var N9=y((Yh,Jz)=>{var J2=vZ(),Wz=C$(),H_=L8(),Xz=tY(),D_=QZ(),N_=I7(),w_=x7(),A_=g7(),L_=d7(),S_=h7(),O_=c7(),F_=p7(),__=l7(),P_=J1(),K_=s7(),C_=a7(),j_=z9(),R_=QJ(),V_=WJ(),E_=R$(),I_=U9(),b_=sY(),x_=rY(),T_=q9(),k_=G9(),g_=aY(),f_=HJ(),y_=E$(),d_=z1(),v_=b$(),h_=EJ(),m_=bJ(),c_=TJ(),u_=fJ(),p_=dJ(),i_=D9(),l_=pJ(),n_=lJ(),o_=tJ(),t_=rJ(),s_=Yz();Jz.exports={parse:D_,valid:N_,clean:w_,inc:A_,diff:L_,major:S_,minor:O_,patch:F_,prerelease:__,compare:P_,rcompare:K_,compareLoose:C_,compareBuild:j_,sort:R_,rsort:V_,gt:E_,lt:I_,eq:b_,neq:x_,gte:T_,lte:k_,cmp:g_,coerce:f_,Comparator:y_,Range:d_,satisfies:v_,toComparators:h_,maxSatisfying:m_,minSatisfying:c_,minVersion:u_,validRange:p_,outside:i_,gtr:l_,ltr:n_,intersects:o_,simplifyRange:t_,subset:s_,SemVer:H_,re:J2.re,src:J2.src,tokens:J2.t,SEMVER_SPEC_VERSION:Wz.SEMVER_SPEC_VERSION,RELEASE_TYPES:Wz.RELEASE_TYPES,compareIdentifiers:Xz.compareIdentifiers,rcompareIdentifiers:Xz.rcompareIdentifiers}});var Uz=y((Wh,zz)=>{var r_=N9();zz.exports=r_.satisfies(process.version,">=15.7.0")});var Gz=y((Xh,qz)=>{var a_=N9();qz.exports=a_.satisfies(process.version,">=16.9.0")});var z2=y((Jh,Mz)=>{var e_=Uz(),ZP=Gz(),$P={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},QP={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Mz.exports=function(Z,$){if(!Z||!$)return;let Q=$.asymmetricKeyType;if(!Q)return;let Y=$P[Q];if(!Y)throw new Error(`Unknown key type "${Q}".`);if(!Y.includes(Z))throw new Error(`"alg" parameter for "${Q}" key type must be one of: ${Y.join(", ")}.`);if(e_)switch(Q){case"ec":let W=$.asymmetricKeyDetails.namedCurve,X=QP[Z];if(W!==X)throw new Error(`"alg" parameter "${Z}" requires curve "${X}".`);break;case"rsa-pss":if(ZP){let J=parseInt(Z.slice(-3),10),{hashAlgorithm:z,mgf1HashAlgorithm:U,saltLength:q}=$.asymmetricKeyDetails;if(z!==`sha${J}`||U!==z)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${Z}.`);if(q!==void 0&&q>J>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${Z}.`)}break}}});var U2=y((zh,Bz)=>{var YP=N9();Bz.exports=YP.satisfies(process.version,"^6.12.0 || >=8.0.0")});var Nz=y((Uh,Dz)=>{var b0=K$(),WP=pY(),Hz=iY(),XP=uY(),JP=lY(),zP=z2(),UP=U2(),qP=eQ(),{KeyObject:GP,createSecretKey:MP,createPublicKey:BP}=G8("crypto"),q2=["RS256","RS384","RS512"],HP=["ES256","ES384","ES512"],G2=["RS256","RS384","RS512"],DP=["HS256","HS384","HS512"];if(UP)q2.splice(q2.length,0,"PS256","PS384","PS512"),G2.splice(G2.length,0,"PS256","PS384","PS512");Dz.exports=function(Z,$,Q,Y){if(typeof Q==="function"&&!Y)Y=Q,Q={};if(!Q)Q={};Q=Object.assign({},Q);let W;if(Y)W=Y;else W=function(G,D){if(G)throw G;return D};if(Q.clockTimestamp&&typeof Q.clockTimestamp!=="number")return W(new b0("clockTimestamp must be a number"));if(Q.nonce!==void 0&&(typeof Q.nonce!=="string"||Q.nonce.trim()===""))return W(new b0("nonce must be a non-empty string"));if(Q.allowInvalidAsymmetricKeyTypes!==void 0&&typeof Q.allowInvalidAsymmetricKeyTypes!=="boolean")return W(new b0("allowInvalidAsymmetricKeyTypes must be a boolean"));let X=Q.clockTimestamp||Math.floor(Date.now()/1000);if(!Z)return W(new b0("jwt must be provided"));if(typeof Z!=="string")return W(new b0("jwt must be a string"));let J=Z.split(".");if(J.length!==3)return W(new b0("jwt malformed"));let z;try{z=XP(Z,{complete:!0})}catch(G){return W(G)}if(!z)return W(new b0("invalid token"));let U=z.header,q;if(typeof $==="function"){if(!Y)return W(new b0("verify must be called asynchronous if secret or public key is provided as a callback"));q=$}else q=function(G,D){return D(null,$)};return q(U,function(G,D){if(G)return W(new b0("error in secret or public key callback: "+G.message));let A=J[2].trim()!=="";if(!A&&D)return W(new b0("jwt signature is required"));if(A&&!D)return W(new b0("secret or public key must be provided"));if(!A&&!Q.algorithms)return W(new b0('please specify "none" in "algorithms" to verify unsigned tokens'));if(D!=null&&!(D instanceof GP))try{D=BP(D)}catch(L){try{D=MP(typeof D==="string"?Buffer.from(D):D)}catch(O){return W(new b0("secretOrPublicKey is not valid key material"))}}if(!Q.algorithms)if(D.type==="secret")Q.algorithms=DP;else if(["rsa","rsa-pss"].includes(D.asymmetricKeyType))Q.algorithms=G2;else if(D.asymmetricKeyType==="ec")Q.algorithms=HP;else Q.algorithms=q2;if(Q.algorithms.indexOf(z.header.alg)===-1)return W(new b0("invalid algorithm"));if(U.alg.startsWith("HS")&&D.type!=="secret")return W(new b0(`secretOrPublicKey must be a symmetric key when using ${U.alg}`));else if(/^(?:RS|PS|ES)/.test(U.alg)&&D.type!=="public")return W(new b0(`secretOrPublicKey must be an asymmetric key when using ${U.alg}`));if(!Q.allowInvalidAsymmetricKeyTypes)try{zP(U.alg,D)}catch(L){return W(L)}let H;try{H=qP.verify(Z,z.header.alg,D)}catch(L){return W(L)}if(!H)return W(new b0("invalid signature"));let M=z.payload;if(typeof M.nbf!=="undefined"&&!Q.ignoreNotBefore){if(typeof M.nbf!=="number")return W(new b0("invalid nbf value"));if(M.nbf>X+(Q.clockTolerance||0))return W(new WP("jwt not active",new Date(M.nbf*1000)))}if(typeof M.exp!=="undefined"&&!Q.ignoreExpiration){if(typeof M.exp!=="number")return W(new b0("invalid exp value"));if(X>=M.exp+(Q.clockTolerance||0))return W(new Hz("jwt expired",new Date(M.exp*1000)))}if(Q.audience){let L=Array.isArray(Q.audience)?Q.audience:[Q.audience];if(!(Array.isArray(M.aud)?M.aud:[M.aud]).some(function(_){return L.some(function(b){return b instanceof RegExp?b.test(_):b===_})}))return W(new b0("jwt audience invalid. expected: "+L.join(" or ")))}if(Q.issuer){if(typeof Q.issuer==="string"&&M.iss!==Q.issuer||Array.isArray(Q.issuer)&&Q.issuer.indexOf(M.iss)===-1)return W(new b0("jwt issuer invalid. expected: "+Q.issuer))}if(Q.subject){if(M.sub!==Q.subject)return W(new b0("jwt subject invalid. expected: "+Q.subject))}if(Q.jwtid){if(M.jti!==Q.jwtid)return W(new b0("jwt jwtid invalid. expected: "+Q.jwtid))}if(Q.nonce){if(M.nonce!==Q.nonce)return W(new b0("jwt nonce invalid. expected: "+Q.nonce))}if(Q.maxAge){if(typeof M.iat!=="number")return W(new b0("iat required when maxAge is specified"));let L=JP(Q.maxAge,M.iat);if(typeof L==="undefined")return W(new b0('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(X>=L+(Q.clockTolerance||0))return W(new Hz("maxAge exceeded",new Date(L*1000)))}if(Q.complete===!0){let L=z.signature;return W(null,{header:U,payload:M,signature:L})}return W(null,M)})}});var Fz=y((qh,Oz)=>{var wz=1/0,Lz=9007199254740991,NP=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,Az=NaN,wP="[object Arguments]",AP="[object Function]",LP="[object GeneratorFunction]",SP="[object String]",OP="[object Symbol]",FP=/^\s+|\s+$/g,_P=/^[-+]0x[0-9a-f]+$/i,PP=/^0b[01]+$/i,KP=/^0o[0-7]+$/i,CP=/^(?:0|[1-9]\d*)$/,jP=parseInt;function RP(Z,$){var Q=-1,Y=Z?Z.length:0,W=Array(Y);while(++Q<Y)W[Q]=$(Z[Q],Q,Z);return W}function VP(Z,$,Q,Y){var W=Z.length,X=Q+(Y?1:-1);while(Y?X--:++X<W)if($(Z[X],X,Z))return X;return-1}function EP(Z,$,Q){if($!==$)return VP(Z,IP,Q);var Y=Q-1,W=Z.length;while(++Y<W)if(Z[Y]===$)return Y;return-1}function IP(Z){return Z!==Z}function bP(Z,$){var Q=-1,Y=Array(Z);while(++Q<Z)Y[Q]=$(Q);return Y}function xP(Z,$){return RP($,function(Q){return Z[Q]})}function TP(Z,$){return function(Q){return Z($(Q))}}var w9=Object.prototype,B2=w9.hasOwnProperty,A9=w9.toString,kP=w9.propertyIsEnumerable,gP=TP(Object.keys,Object),fP=Math.max;function yP(Z,$){var Q=Sz(Z)||cP(Z)?bP(Z.length,String):[],Y=Q.length,W=!!Y;for(var X in Z)if(($||B2.call(Z,X))&&!(W&&(X=="length"||vP(X,Y))))Q.push(X);return Q}function dP(Z){if(!hP(Z))return gP(Z);var $=[];for(var Q in Object(Z))if(B2.call(Z,Q)&&Q!="constructor")$.push(Q);return $}function vP(Z,$){return $=$==null?Lz:$,!!$&&(typeof Z=="number"||CP.test(Z))&&(Z>-1&&Z%1==0&&Z<$)}function hP(Z){var $=Z&&Z.constructor,Q=typeof $=="function"&&$.prototype||w9;return Z===Q}function mP(Z,$,Q,Y){Z=H2(Z)?Z:aP(Z),Q=Q&&!Y?tP(Q):0;var W=Z.length;if(Q<0)Q=fP(W+Q,0);return lP(Z)?Q<=W&&Z.indexOf($,Q)>-1:!!W&&EP(Z,$,Q)>-1}function cP(Z){return uP(Z)&&B2.call(Z,"callee")&&(!kP.call(Z,"callee")||A9.call(Z)==wP)}var Sz=Array.isArray;function H2(Z){return Z!=null&&iP(Z.length)&&!pP(Z)}function uP(Z){return D2(Z)&&H2(Z)}function pP(Z){var $=M2(Z)?A9.call(Z):"";return $==AP||$==LP}function iP(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=Lz}function M2(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function D2(Z){return!!Z&&typeof Z=="object"}function lP(Z){return typeof Z=="string"||!Sz(Z)&&D2(Z)&&A9.call(Z)==SP}function nP(Z){return typeof Z=="symbol"||D2(Z)&&A9.call(Z)==OP}function oP(Z){if(!Z)return Z===0?Z:0;if(Z=sP(Z),Z===wz||Z===-wz){var $=Z<0?-1:1;return $*NP}return Z===Z?Z:0}function tP(Z){var $=oP(Z),Q=$%1;return $===$?Q?$-Q:$:0}function sP(Z){if(typeof Z=="number")return Z;if(nP(Z))return Az;if(M2(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=M2($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(FP,"");var Q=PP.test(Z);return Q||KP.test(Z)?jP(Z.slice(2),Q?2:8):_P.test(Z)?Az:+Z}function rP(Z){return H2(Z)?yP(Z):dP(Z)}function aP(Z){return Z?xP(Z,rP(Z)):[]}Oz.exports=mP});var Pz=y((Gh,_z)=>{var eP="[object Boolean]",ZK=Object.prototype,$K=ZK.toString;function QK(Z){return Z===!0||Z===!1||YK(Z)&&$K.call(Z)==eP}function YK(Z){return!!Z&&typeof Z=="object"}_z.exports=QK});var Vz=y((Mh,Rz)=>{var Kz=1/0,WK=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,Cz=NaN,XK="[object Symbol]",JK=/^\s+|\s+$/g,zK=/^[-+]0x[0-9a-f]+$/i,UK=/^0b[01]+$/i,qK=/^0o[0-7]+$/i,GK=parseInt,MK=Object.prototype,BK=MK.toString;function HK(Z){return typeof Z=="number"&&Z==AK(Z)}function jz(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function DK(Z){return!!Z&&typeof Z=="object"}function NK(Z){return typeof Z=="symbol"||DK(Z)&&BK.call(Z)==XK}function wK(Z){if(!Z)return Z===0?Z:0;if(Z=LK(Z),Z===Kz||Z===-Kz){var $=Z<0?-1:1;return $*WK}return Z===Z?Z:0}function AK(Z){var $=wK(Z),Q=$%1;return $===$?Q?$-Q:$:0}function LK(Z){if(typeof Z=="number")return Z;if(NK(Z))return Cz;if(jz(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=jz($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(JK,"");var Q=UK.test(Z);return Q||qK.test(Z)?GK(Z.slice(2),Q?2:8):zK.test(Z)?Cz:+Z}Rz.exports=HK});var Iz=y((Bh,Ez)=>{var SK="[object Number]",OK=Object.prototype,FK=OK.toString;function _K(Z){return!!Z&&typeof Z=="object"}function PK(Z){return typeof Z=="number"||_K(Z)&&FK.call(Z)==SK}Ez.exports=PK});var kz=y((Hh,Tz)=>{var KK="[object Object]";function CK(Z){var $=!1;if(Z!=null&&typeof Z.toString!="function")try{$=!!(Z+"")}catch(Q){}return $}function jK(Z,$){return function(Q){return Z($(Q))}}var RK=Function.prototype,bz=Object.prototype,xz=RK.toString,VK=bz.hasOwnProperty,EK=xz.call(Object),IK=bz.toString,bK=jK(Object.getPrototypeOf,Object);function xK(Z){return!!Z&&typeof Z=="object"}function TK(Z){if(!xK(Z)||IK.call(Z)!=KK||CK(Z))return!1;var $=bK(Z);if($===null)return!0;var Q=VK.call($,"constructor")&&$.constructor;return typeof Q=="function"&&Q instanceof Q&&xz.call(Q)==EK}Tz.exports=TK});var fz=y((Dh,gz)=>{var kK="[object String]",gK=Object.prototype,fK=gK.toString,yK=Array.isArray;function dK(Z){return!!Z&&typeof Z=="object"}function vK(Z){return typeof Z=="string"||!yK(Z)&&dK(Z)&&fK.call(Z)==kK}gz.exports=vK});var mz=y((Nh,hz)=>{var hK="Expected a function",yz=1/0,mK=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,dz=NaN,cK="[object Symbol]",uK=/^\s+|\s+$/g,pK=/^[-+]0x[0-9a-f]+$/i,iK=/^0b[01]+$/i,lK=/^0o[0-7]+$/i,nK=parseInt,oK=Object.prototype,tK=oK.toString;function sK(Z,$){var Q;if(typeof $!="function")throw new TypeError(hK);return Z=$C(Z),function(){if(--Z>0)Q=$.apply(this,arguments);if(Z<=1)$=void 0;return Q}}function rK(Z){return sK(2,Z)}function vz(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function aK(Z){return!!Z&&typeof Z=="object"}function eK(Z){return typeof Z=="symbol"||aK(Z)&&tK.call(Z)==cK}function ZC(Z){if(!Z)return Z===0?Z:0;if(Z=QC(Z),Z===yz||Z===-yz){var $=Z<0?-1:1;return $*mK}return Z===Z?Z:0}function $C(Z){var $=ZC(Z),Q=$%1;return $===$?Q?$-Q:$:0}function QC(Z){if(typeof Z=="number")return Z;if(eK(Z))return dz;if(vz(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=vz($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(uK,"");var Q=iK.test(Z);return Q||lK.test(Z)?nK(Z.slice(2),Q?2:8):pK.test(Z)?dz:+Z}hz.exports=rK});var sz=y((wh,tz)=>{var cz=lY(),YC=U2(),WC=z2(),uz=eQ(),XC=Fz(),L9=Pz(),pz=Vz(),N2=Iz(),lz=kz(),g6=fz(),JC=mz(),{KeyObject:zC,createSecretKey:UC,createPrivateKey:qC}=G8("crypto"),nz=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];if(YC)nz.splice(3,0,"PS256","PS384","PS512");var GC={expiresIn:{isValid:function(Z){return pz(Z)||g6(Z)&&Z},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(Z){return pz(Z)||g6(Z)&&Z},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(Z){return g6(Z)||Array.isArray(Z)},message:'"audience" must be a string or array'},algorithm:{isValid:XC.bind(null,nz),message:'"algorithm" must be a valid string enum value'},header:{isValid:lz,message:'"header" must be an object'},encoding:{isValid:g6,message:'"encoding" must be a string'},issuer:{isValid:g6,message:'"issuer" must be a string'},subject:{isValid:g6,message:'"subject" must be a string'},jwtid:{isValid:g6,message:'"jwtid" must be a string'},noTimestamp:{isValid:L9,message:'"noTimestamp" must be a boolean'},keyid:{isValid:g6,message:'"keyid" must be a string'},mutatePayload:{isValid:L9,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:L9,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:L9,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},MC={iat:{isValid:N2,message:'"iat" should be a number of seconds'},exp:{isValid:N2,message:'"exp" should be a number of seconds'},nbf:{isValid:N2,message:'"nbf" should be a number of seconds'}};function oz(Z,$,Q,Y){if(!lz(Q))throw new Error('Expected "'+Y+'" to be a plain object.');Object.keys(Q).forEach(function(W){let X=Z[W];if(!X){if(!$)throw new Error('"'+W+'" is not allowed in "'+Y+'"');return}if(!X.isValid(Q[W]))throw new Error(X.message)})}function BC(Z){return oz(GC,!1,Z,"options")}function HC(Z){return oz(MC,!0,Z,"payload")}var iz={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},DC=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];tz.exports=function(Z,$,Q,Y){if(typeof Q==="function")Y=Q,Q={};else Q=Q||{};let W=typeof Z==="object"&&!Buffer.isBuffer(Z),X=Object.assign({alg:Q.algorithm||"HS256",typ:W?"JWT":void 0,kid:Q.keyid},Q.header);function J(q){if(Y)return Y(q);throw q}if(!$&&Q.algorithm!=="none")return J(new Error("secretOrPrivateKey must have a value"));if($!=null&&!($ instanceof zC))try{$=qC($)}catch(q){try{$=UC(typeof $==="string"?Buffer.from($):$)}catch(G){return J(new Error("secretOrPrivateKey is not valid key material"))}}if(X.alg.startsWith("HS")&&$.type!=="secret")return J(new Error(`secretOrPrivateKey must be a symmetric key when using ${X.alg}`));else if(/^(?:RS|PS|ES)/.test(X.alg)){if($.type!=="private")return J(new Error(`secretOrPrivateKey must be an asymmetric key when using ${X.alg}`));if(!Q.allowInsecureKeySizes&&!X.alg.startsWith("ES")&&$.asymmetricKeyDetails!==void 0&&$.asymmetricKeyDetails.modulusLength<2048)return J(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${X.alg}`))}if(typeof Z==="undefined")return J(new Error("payload is required"));else if(W){try{HC(Z)}catch(q){return J(q)}if(!Q.mutatePayload)Z=Object.assign({},Z)}else{let q=DC.filter(function(G){return typeof Q[G]!=="undefined"});if(q.length>0)return J(new Error("invalid "+q.join(",")+" option for "+typeof Z+" payload"))}if(typeof Z.exp!=="undefined"&&typeof Q.expiresIn!=="undefined")return J(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof Z.nbf!=="undefined"&&typeof Q.notBefore!=="undefined")return J(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{BC(Q)}catch(q){return J(q)}if(!Q.allowInvalidAsymmetricKeyTypes)try{WC(X.alg,$)}catch(q){return J(q)}let z=Z.iat||Math.floor(Date.now()/1000);if(Q.noTimestamp)delete Z.iat;else if(W)Z.iat=z;if(typeof Q.notBefore!=="undefined"){try{Z.nbf=cz(Q.notBefore,z)}catch(q){return J(q)}if(typeof Z.nbf==="undefined")return J(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof Q.expiresIn!=="undefined"&&typeof Z==="object"){try{Z.exp=cz(Q.expiresIn,z)}catch(q){return J(q)}if(typeof Z.exp==="undefined")return J(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(iz).forEach(function(q){let G=iz[q];if(typeof Q[q]!=="undefined"){if(typeof Z[G]!=="undefined")return J(new Error('Bad "options.'+q+'" option. The payload already has an "'+G+'" property.'));Z[G]=Q[q]}});let U=Q.encoding||"utf8";if(typeof Y==="function")Y=Y&&JC(Y),uz.createSign({header:X,privateKey:$,payload:Z,encoding:U}).once("error",Y).once("done",function(q){if(!Q.allowInsecureKeySizes&&/^(?:RS|PS)/.test(X.alg)&&q.length<256)return Y(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${X.alg}`));Y(null,q)});else{let q=uz.sign({header:X,payload:Z,secret:$,encoding:U});if(!Q.allowInsecureKeySizes&&/^(?:RS|PS)/.test(X.alg)&&q.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${X.alg}`);return q}}});var az=y((Ah,rz)=>{rz.exports={decode:uY(),verify:Nz(),sign:sz(),JsonWebTokenError:K$(),NotBeforeError:pY(),TokenExpiredError:iY()}});var H8={};v6(H8,{IsUndefined:()=>l0,IsUint8Array:()=>i1,IsSymbol:()=>j9,IsString:()=>j0,IsRegExp:()=>uZ,IsObject:()=>O0,IsNumber:()=>c8,IsNull:()=>C9,IsIterator:()=>K9,IsFunction:()=>P9,IsDate:()=>h6,IsBoolean:()=>p1,IsBigInt:()=>cZ,IsAsyncIterator:()=>_9,IsArray:()=>i0,HasPropertyKey:()=>g$});function g$(Z,$){return $ in Z}function _9(Z){return O0(Z)&&!i0(Z)&&!i1(Z)&&Symbol.asyncIterator in Z}function i0(Z){return Array.isArray(Z)}function cZ(Z){return typeof Z==="bigint"}function p1(Z){return typeof Z==="boolean"}function h6(Z){return Z instanceof globalThis.Date}function P9(Z){return typeof Z==="function"}function K9(Z){return O0(Z)&&!i0(Z)&&!i1(Z)&&Symbol.iterator in Z}function C9(Z){return Z===null}function c8(Z){return typeof Z==="number"}function O0(Z){return typeof Z==="object"&&Z!==null}function uZ(Z){return Z instanceof globalThis.RegExp}function j0(Z){return typeof Z==="string"}function j9(Z){return typeof Z==="symbol"}function i1(Z){return Z instanceof globalThis.Uint8Array}function l0(Z){return Z===void 0}function GU(Z){return Z.map(($)=>f$($))}function MU(Z){return new Date(Z.getTime())}function BU(Z){return new Uint8Array(Z)}function HU(Z){return new RegExp(Z.source,Z.flags)}function DU(Z){let $={};for(let Q of Object.getOwnPropertyNames(Z))$[Q]=f$(Z[Q]);for(let Q of Object.getOwnPropertySymbols(Z))$[Q]=f$(Z[Q]);return $}function f$(Z){return i0(Z)?GU(Z):h6(Z)?MU(Z):i1(Z)?BU(Z):uZ(Z)?HU(Z):O0(Z)?DU(Z):Z}function x0(Z){return f$(Z)}function WZ(Z,$){return $===void 0?x0(Z):x0({...$,...Z})}function y$(Z){return a(Z)&&globalThis.Symbol.asyncIterator in Z}function d$(Z){return a(Z)&&globalThis.Symbol.iterator in Z}function R9(Z){return a(Z)&&(globalThis.Object.getPrototypeOf(Z)===Object.prototype||globalThis.Object.getPrototypeOf(Z)===null)}function v$(Z){return Z instanceof globalThis.Promise}function S8(Z){return Z instanceof Date&&globalThis.Number.isFinite(Z.getTime())}function A2(Z){return Z instanceof globalThis.Map}function L2(Z){return Z instanceof globalThis.Set}function s8(Z){return globalThis.ArrayBuffer.isView(Z)}function XZ(Z){return Z instanceof globalThis.Uint8Array}function n(Z,$){return $ in Z}function a(Z){return Z!==null&&typeof Z==="object"}function o(Z){return globalThis.Array.isArray(Z)&&!globalThis.ArrayBuffer.isView(Z)}function T0(Z){return Z===void 0}function l1(Z){return Z===null}function I1(Z){return typeof Z==="boolean"}function u(Z){return typeof Z==="number"}function h$(Z){return globalThis.Number.isInteger(Z)}function z8(Z){return typeof Z==="bigint"}function J0(Z){return typeof Z==="string"}function A6(Z){return typeof Z==="function"}function n1(Z){return typeof Z==="symbol"}function u8(Z){return z8(Z)||I1(Z)||l1(Z)||u(Z)||J0(Z)||n1(Z)||T0(Z)}var V0;(function(Z){Z.InstanceMode="default",Z.ExactOptionalPropertyTypes=!1,Z.AllowArrayObject=!1,Z.AllowNaN=!1,Z.AllowNullVoid=!1;function $(J,z){return Z.ExactOptionalPropertyTypes?z in J:J[z]!==void 0}Z.IsExactOptionalProperty=$;function Q(J){let z=a(J);return Z.AllowArrayObject?z:z&&!o(J)}Z.IsObjectLike=Q;function Y(J){return Q(J)&&!(J instanceof Date)&&!(J instanceof Uint8Array)}Z.IsRecordLike=Y;function W(J){return Z.AllowNaN?u(J):Number.isFinite(J)}Z.IsNumberLike=W;function X(J){let z=T0(J);return Z.AllowNullVoid?z||J===null:z}Z.IsVoidLike=X})(V0||(V0={}));function NU(Z){return globalThis.Object.freeze(Z).map(($)=>pZ($))}function wU(Z){return Z}function AU(Z){return Z}function LU(Z){return Z}function SU(Z){let $={};for(let Q of Object.getOwnPropertyNames(Z))$[Q]=pZ(Z[Q]);for(let Q of Object.getOwnPropertySymbols(Z))$[Q]=pZ(Z[Q]);return globalThis.Object.freeze($)}function pZ(Z){return i0(Z)?NU(Z):h6(Z)?wU(Z):i1(Z)?AU(Z):uZ(Z)?LU(Z):O0(Z)?SU(Z):Z}function K(Z,$){let Q=$!==void 0?{...$,...Z}:Z;switch(V0.InstanceMode){case"freeze":return pZ(Q);case"clone":return x0(Q);default:return Q}}class i extends Error{constructor(Z){super(Z)}}var P0=Symbol.for("TypeBox.Transform"),q1=Symbol.for("TypeBox.Readonly"),n0=Symbol.for("TypeBox.Optional"),r8=Symbol.for("TypeBox.Hint"),S=Symbol.for("TypeBox.Kind");function JZ(Z){return O0(Z)&&Z[q1]==="Readonly"}function R8(Z){return O0(Z)&&Z[n0]==="Optional"}function V9(Z){return W0(Z,"Any")}function E9(Z){return W0(Z,"Argument")}function G1(Z){return W0(Z,"Array")}function m6(Z){return W0(Z,"AsyncIterator")}function c6(Z){return W0(Z,"BigInt")}function o1(Z){return W0(Z,"Boolean")}function M1(Z){return W0(Z,"Computed")}function B1(Z){return W0(Z,"Constructor")}function OU(Z){return W0(Z,"Date")}function H1(Z){return W0(Z,"Function")}function D1(Z){return W0(Z,"Integer")}function h0(Z){return W0(Z,"Intersect")}function u6(Z){return W0(Z,"Iterator")}function W0(Z,$){return O0(Z)&&S in Z&&Z[S]===$}function m$(Z){return p1(Z)||c8(Z)||j0(Z)}function p8(Z){return W0(Z,"Literal")}function i8(Z){return W0(Z,"MappedKey")}function k0(Z){return W0(Z,"MappedResult")}function L6(Z){return W0(Z,"Never")}function FU(Z){return W0(Z,"Not")}function iZ(Z){return W0(Z,"Null")}function N1(Z){return W0(Z,"Number")}function o0(Z){return W0(Z,"Object")}function p6(Z){return W0(Z,"Promise")}function i6(Z){return W0(Z,"Record")}function u0(Z){return W0(Z,"Ref")}function I9(Z){return W0(Z,"RegExp")}function t1(Z){return W0(Z,"String")}function lZ(Z){return W0(Z,"Symbol")}function l8(Z){return W0(Z,"TemplateLiteral")}function _U(Z){return W0(Z,"This")}function D0(Z){return O0(Z)&&P0 in Z}function n8(Z){return W0(Z,"Tuple")}function s1(Z){return W0(Z,"Undefined")}function z0(Z){return W0(Z,"Union")}function PU(Z){return W0(Z,"Uint8Array")}function KU(Z){return W0(Z,"Unknown")}function CU(Z){return W0(Z,"Unsafe")}function jU(Z){return W0(Z,"Void")}function S6(Z){return O0(Z)&&S in Z&&j0(Z[S])}function d0(Z){return V9(Z)||E9(Z)||G1(Z)||o1(Z)||c6(Z)||m6(Z)||M1(Z)||B1(Z)||OU(Z)||H1(Z)||D1(Z)||h0(Z)||u6(Z)||p8(Z)||i8(Z)||k0(Z)||L6(Z)||FU(Z)||iZ(Z)||N1(Z)||o0(Z)||p6(Z)||i6(Z)||u0(Z)||I9(Z)||t1(Z)||lZ(Z)||l8(Z)||_U(Z)||n8(Z)||s1(Z)||z0(Z)||PU(Z)||KU(Z)||CU(Z)||jU(Z)||S6(Z)}var w={};v6(w,{TypeGuardUnknownTypeError:()=>S2,IsVoid:()=>JW,IsUnsafe:()=>XW,IsUnknown:()=>WW,IsUnionLiteral:()=>gU,IsUnion:()=>T9,IsUndefined:()=>QW,IsUint8Array:()=>YW,IsTuple:()=>$W,IsTransform:()=>ZW,IsThis:()=>e2,IsTemplateLiteral:()=>a2,IsSymbol:()=>r2,IsString:()=>s2,IsSchema:()=>g0,IsRegExp:()=>t2,IsRef:()=>o2,IsRecursive:()=>kU,IsRecord:()=>n2,IsReadonly:()=>IU,IsProperties:()=>c$,IsPromise:()=>l2,IsOptional:()=>bU,IsObject:()=>i2,IsNumber:()=>p2,IsNull:()=>u2,IsNot:()=>c2,IsNever:()=>m2,IsMappedResult:()=>h2,IsMappedKey:()=>v2,IsLiteralValue:()=>d2,IsLiteralString:()=>f2,IsLiteralNumber:()=>y2,IsLiteralBoolean:()=>TU,IsLiteral:()=>oZ,IsKindOf:()=>$0,IsKind:()=>zW,IsIterator:()=>g2,IsIntersect:()=>k2,IsInteger:()=>T2,IsImport:()=>xU,IsFunction:()=>x2,IsDate:()=>b2,IsConstructor:()=>I2,IsComputed:()=>E2,IsBoolean:()=>V2,IsBigInt:()=>R2,IsAsyncIterator:()=>j2,IsArray:()=>C2,IsArgument:()=>K2,IsAny:()=>P2});class S2 extends i{}var RU=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function O2(Z){try{return new RegExp(Z),!0}catch{return!1}}function b9(Z){if(!j0(Z))return!1;for(let $=0;$<Z.length;$++){let Q=Z.charCodeAt($);if(Q>=7&&Q<=13||Q===27||Q===127)return!1}return!0}function F2(Z){return x9(Z)||g0(Z)}function nZ(Z){return l0(Z)||cZ(Z)}function R0(Z){return l0(Z)||c8(Z)}function x9(Z){return l0(Z)||p1(Z)}function F0(Z){return l0(Z)||j0(Z)}function VU(Z){return l0(Z)||j0(Z)&&b9(Z)&&O2(Z)}function EU(Z){return l0(Z)||j0(Z)&&b9(Z)}function _2(Z){return l0(Z)||g0(Z)}function IU(Z){return O0(Z)&&Z[q1]==="Readonly"}function bU(Z){return O0(Z)&&Z[n0]==="Optional"}function P2(Z){return $0(Z,"Any")&&F0(Z.$id)}function K2(Z){return $0(Z,"Argument")&&c8(Z.index)}function C2(Z){return $0(Z,"Array")&&Z.type==="array"&&F0(Z.$id)&&g0(Z.items)&&R0(Z.minItems)&&R0(Z.maxItems)&&x9(Z.uniqueItems)&&_2(Z.contains)&&R0(Z.minContains)&&R0(Z.maxContains)}function j2(Z){return $0(Z,"AsyncIterator")&&Z.type==="AsyncIterator"&&F0(Z.$id)&&g0(Z.items)}function R2(Z){return $0(Z,"BigInt")&&Z.type==="bigint"&&F0(Z.$id)&&nZ(Z.exclusiveMaximum)&&nZ(Z.exclusiveMinimum)&&nZ(Z.maximum)&&nZ(Z.minimum)&&nZ(Z.multipleOf)}function V2(Z){return $0(Z,"Boolean")&&Z.type==="boolean"&&F0(Z.$id)}function E2(Z){return $0(Z,"Computed")&&j0(Z.target)&&i0(Z.parameters)&&Z.parameters.every(($)=>g0($))}function I2(Z){return $0(Z,"Constructor")&&Z.type==="Constructor"&&F0(Z.$id)&&i0(Z.parameters)&&Z.parameters.every(($)=>g0($))&&g0(Z.returns)}function b2(Z){return $0(Z,"Date")&&Z.type==="Date"&&F0(Z.$id)&&R0(Z.exclusiveMaximumTimestamp)&&R0(Z.exclusiveMinimumTimestamp)&&R0(Z.maximumTimestamp)&&R0(Z.minimumTimestamp)&&R0(Z.multipleOfTimestamp)}function x2(Z){return $0(Z,"Function")&&Z.type==="Function"&&F0(Z.$id)&&i0(Z.parameters)&&Z.parameters.every(($)=>g0($))&&g0(Z.returns)}function xU(Z){return $0(Z,"Import")&&g$(Z,"$defs")&&O0(Z.$defs)&&c$(Z.$defs)&&g$(Z,"$ref")&&j0(Z.$ref)&&Z.$ref in Z.$defs}function T2(Z){return $0(Z,"Integer")&&Z.type==="integer"&&F0(Z.$id)&&R0(Z.exclusiveMaximum)&&R0(Z.exclusiveMinimum)&&R0(Z.maximum)&&R0(Z.minimum)&&R0(Z.multipleOf)}function c$(Z){return O0(Z)&&Object.entries(Z).every(([$,Q])=>b9($)&&g0(Q))}function k2(Z){return $0(Z,"Intersect")&&(j0(Z.type)&&Z.type!=="object"?!1:!0)&&i0(Z.allOf)&&Z.allOf.every(($)=>g0($)&&!ZW($))&&F0(Z.type)&&(x9(Z.unevaluatedProperties)||_2(Z.unevaluatedProperties))&&F0(Z.$id)}function g2(Z){return $0(Z,"Iterator")&&Z.type==="Iterator"&&F0(Z.$id)&&g0(Z.items)}function $0(Z,$){return O0(Z)&&S in Z&&Z[S]===$}function f2(Z){return oZ(Z)&&j0(Z.const)}function y2(Z){return oZ(Z)&&c8(Z.const)}function TU(Z){return oZ(Z)&&p1(Z.const)}function oZ(Z){return $0(Z,"Literal")&&F0(Z.$id)&&d2(Z.const)}function d2(Z){return p1(Z)||c8(Z)||j0(Z)}function v2(Z){return $0(Z,"MappedKey")&&i0(Z.keys)&&Z.keys.every(($)=>c8($)||j0($))}function h2(Z){return $0(Z,"MappedResult")&&c$(Z.properties)}function m2(Z){return $0(Z,"Never")&&O0(Z.not)&&Object.getOwnPropertyNames(Z.not).length===0}function c2(Z){return $0(Z,"Not")&&g0(Z.not)}function u2(Z){return $0(Z,"Null")&&Z.type==="null"&&F0(Z.$id)}function p2(Z){return $0(Z,"Number")&&Z.type==="number"&&F0(Z.$id)&&R0(Z.exclusiveMaximum)&&R0(Z.exclusiveMinimum)&&R0(Z.maximum)&&R0(Z.minimum)&&R0(Z.multipleOf)}function i2(Z){return $0(Z,"Object")&&Z.type==="object"&&F0(Z.$id)&&c$(Z.properties)&&F2(Z.additionalProperties)&&R0(Z.minProperties)&&R0(Z.maxProperties)}function l2(Z){return $0(Z,"Promise")&&Z.type==="Promise"&&F0(Z.$id)&&g0(Z.item)}function n2(Z){return $0(Z,"Record")&&Z.type==="object"&&F0(Z.$id)&&F2(Z.additionalProperties)&&O0(Z.patternProperties)&&(($)=>{let Q=Object.getOwnPropertyNames($.patternProperties);return Q.length===1&&O2(Q[0])&&O0($.patternProperties)&&g0($.patternProperties[Q[0]])})(Z)}function kU(Z){return O0(Z)&&r8 in Z&&Z[r8]==="Recursive"}function o2(Z){return $0(Z,"Ref")&&F0(Z.$id)&&j0(Z.$ref)}function t2(Z){return $0(Z,"RegExp")&&F0(Z.$id)&&j0(Z.source)&&j0(Z.flags)&&R0(Z.maxLength)&&R0(Z.minLength)}function s2(Z){return $0(Z,"String")&&Z.type==="string"&&F0(Z.$id)&&R0(Z.minLength)&&R0(Z.maxLength)&&VU(Z.pattern)&&EU(Z.format)}function r2(Z){return $0(Z,"Symbol")&&Z.type==="symbol"&&F0(Z.$id)}function a2(Z){return $0(Z,"TemplateLiteral")&&Z.type==="string"&&j0(Z.pattern)&&Z.pattern[0]==="^"&&Z.pattern[Z.pattern.length-1]==="$"}function e2(Z){return $0(Z,"This")&&F0(Z.$id)&&j0(Z.$ref)}function ZW(Z){return O0(Z)&&P0 in Z}function $W(Z){return $0(Z,"Tuple")&&Z.type==="array"&&F0(Z.$id)&&c8(Z.minItems)&&c8(Z.maxItems)&&Z.minItems===Z.maxItems&&(l0(Z.items)&&l0(Z.additionalItems)&&Z.minItems===0||i0(Z.items)&&Z.items.every(($)=>g0($)))}function QW(Z){return $0(Z,"Undefined")&&Z.type==="undefined"&&F0(Z.$id)}function gU(Z){return T9(Z)&&Z.anyOf.every(($)=>f2($)||y2($))}function T9(Z){return $0(Z,"Union")&&F0(Z.$id)&&O0(Z)&&i0(Z.anyOf)&&Z.anyOf.every(($)=>g0($))}function YW(Z){return $0(Z,"Uint8Array")&&Z.type==="Uint8Array"&&F0(Z.$id)&&R0(Z.minByteLength)&&R0(Z.maxByteLength)}function WW(Z){return $0(Z,"Unknown")&&F0(Z.$id)}function XW(Z){return $0(Z,"Unsafe")}function JW(Z){return $0(Z,"Void")&&Z.type==="void"&&F0(Z.$id)}function zW(Z){return O0(Z)&&S in Z&&j0(Z[S])&&!RU.includes(Z[S])}function g0(Z){return O0(Z)&&(P2(Z)||K2(Z)||C2(Z)||V2(Z)||R2(Z)||j2(Z)||E2(Z)||I2(Z)||b2(Z)||x2(Z)||T2(Z)||k2(Z)||g2(Z)||oZ(Z)||v2(Z)||h2(Z)||m2(Z)||c2(Z)||u2(Z)||p2(Z)||i2(Z)||l2(Z)||n2(Z)||o2(Z)||t2(Z)||s2(Z)||r2(Z)||a2(Z)||e2(Z)||$W(Z)||QW(Z)||T9(Z)||YW(Z)||WW(Z)||XW(Z)||JW(Z)||zW(Z))}var UW="(true|false)",u$="(0|[1-9][0-9]*)",qW="(.*)";var b1="^(0|[1-9][0-9]*)$",x1="^(.*)$",GW="^(?!.*)$";var S0={};v6(S0,{Set:()=>hU,Has:()=>vU,Get:()=>mU,Entries:()=>fU,Delete:()=>dU,Clear:()=>yU});var zZ=new Map;function fU(){return new Map(zZ)}function yU(){return zZ.clear()}function dU(Z){return zZ.delete(Z)}function vU(Z){return zZ.has(Z)}function hU(Z,$){zZ.set(Z,$)}function mU(Z){return zZ.get(Z)}var e0={};v6(e0,{Set:()=>lU,Has:()=>iU,Get:()=>nU,Entries:()=>cU,Delete:()=>pU,Clear:()=>uU});var UZ=new Map;function cU(){return new Map(UZ)}function uU(){return UZ.clear()}function pU(Z){return UZ.delete(Z)}function iU(Z){return UZ.has(Z)}function lU(Z,$){UZ.set(Z,$)}function nU(Z){return UZ.get(Z)}function MW(Z,$){return Z.includes($)}function BW(Z){return[...new Set(Z)]}function oU(Z,$){return Z.filter((Q)=>$.includes(Q))}function tU(Z,$){return Z.reduce((Q,Y)=>{return oU(Q,Y)},$)}function HW(Z){return Z.length===1?Z[0]:Z.length>1?tU(Z.slice(1),Z[0]):[]}function DW(Z){let $=[];for(let Q of Z)$.push(...Q);return $}function O6(Z){return K({[S]:"Any"},Z)}function qZ(Z,$){return K({[S]:"Array",type:"array",items:Z},$)}function NW(Z){return K({[S]:"Argument",index:Z})}function GZ(Z,$){return K({[S]:"AsyncIterator",type:"AsyncIterator",items:Z},$)}function E0(Z,$,Q){return K({[S]:"Computed",target:Z,parameters:$},Q)}function sU(Z,$){let{[$]:Q,...Y}=Z;return Y}function m0(Z,$){return $.reduce((Q,Y)=>sU(Q,Y),Z)}function r(Z){return K({[S]:"Never",not:{}},Z)}function G0(Z){return K({[S]:"MappedResult",properties:Z})}function MZ(Z,$,Q){return K({[S]:"Constructor",type:"Constructor",parameters:Z,returns:$},Q)}function T1(Z,$,Q){return K({[S]:"Function",type:"Function",parameters:Z,returns:$},Q)}function tZ(Z,$){return K({[S]:"Union",anyOf:Z},$)}function rU(Z){return Z.some(($)=>R8($))}function wW(Z){return Z.map(($)=>R8($)?aU($):$)}function aU(Z){return m0(Z,[n0])}function eU(Z,$){return rU(Z)?D8(tZ(wW(Z),$)):tZ(wW(Z),$)}function k1(Z,$){return Z.length===1?K(Z[0],$):Z.length===0?r($):eU(Z,$)}function N0(Z,$){return Z.length===0?r($):Z.length===1?K(Z[0],$):tZ(Z,$)}class k9 extends i{}function Zq(Z){return Z.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function g9(Z,$,Q){return Z[$]===Q&&Z.charCodeAt($-1)!==92}function a1(Z,$){return g9(Z,$,"(")}function sZ(Z,$){return g9(Z,$,")")}function AW(Z,$){return g9(Z,$,"|")}function $q(Z){if(!(a1(Z,0)&&sZ(Z,Z.length-1)))return!1;let $=0;for(let Q=0;Q<Z.length;Q++){if(a1(Z,Q))$+=1;if(sZ(Z,Q))$-=1;if($===0&&Q!==Z.length-1)return!1}return!0}function Qq(Z){return Z.slice(1,Z.length-1)}function Yq(Z){let $=0;for(let Q=0;Q<Z.length;Q++){if(a1(Z,Q))$+=1;if(sZ(Z,Q))$-=1;if(AW(Z,Q)&&$===0)return!0}return!1}function Wq(Z){for(let $=0;$<Z.length;$++)if(a1(Z,$))return!0;return!1}function Xq(Z){let[$,Q]=[0,0],Y=[];for(let X=0;X<Z.length;X++){if(a1(Z,X))$+=1;if(sZ(Z,X))$-=1;if(AW(Z,X)&&$===0){let J=Z.slice(Q,X);if(J.length>0)Y.push(BZ(J));Q=X+1}}let W=Z.slice(Q);if(W.length>0)Y.push(BZ(W));if(Y.length===0)return{type:"const",const:""};if(Y.length===1)return Y[0];return{type:"or",expr:Y}}function Jq(Z){function $(W,X){if(!a1(W,X))throw new k9("TemplateLiteralParser: Index must point to open parens");let J=0;for(let z=X;z<W.length;z++){if(a1(W,z))J+=1;if(sZ(W,z))J-=1;if(J===0)return[X,z]}throw new k9("TemplateLiteralParser: Unclosed group parens in expression")}function Q(W,X){for(let J=X;J<W.length;J++)if(a1(W,J))return[X,J];return[X,W.length]}let Y=[];for(let W=0;W<Z.length;W++)if(a1(Z,W)){let[X,J]=$(Z,W),z=Z.slice(X,J+1);Y.push(BZ(z)),W=J}else{let[X,J]=Q(Z,W),z=Z.slice(X,J);if(z.length>0)Y.push(BZ(z));W=J-1}return Y.length===0?{type:"const",const:""}:Y.length===1?Y[0]:{type:"and",expr:Y}}function BZ(Z){return $q(Z)?BZ(Qq(Z)):Yq(Z)?Xq(Z):Wq(Z)?Jq(Z):{type:"const",const:Zq(Z)}}function HZ(Z){return BZ(Z.slice(1,Z.length-1))}class LW extends i{}function zq(Z){return Z.type==="or"&&Z.expr.length===2&&Z.expr[0].type==="const"&&Z.expr[0].const==="0"&&Z.expr[1].type==="const"&&Z.expr[1].const==="[1-9][0-9]*"}function Uq(Z){return Z.type==="or"&&Z.expr.length===2&&Z.expr[0].type==="const"&&Z.expr[0].const==="true"&&Z.expr[1].type==="const"&&Z.expr[1].const==="false"}function qq(Z){return Z.type==="const"&&Z.const===".*"}function l6(Z){return zq(Z)||qq(Z)?!1:Uq(Z)?!0:Z.type==="and"?Z.expr.every(($)=>l6($)):Z.type==="or"?Z.expr.every(($)=>l6($)):Z.type==="const"?!0:(()=>{throw new LW("Unknown expression type")})()}function p$(Z){let $=HZ(Z.pattern);return l6($)}class SW extends i{}function*OW(Z){if(Z.length===1)return yield*Z[0];for(let $ of Z[0])for(let Q of OW(Z.slice(1)))yield`${$}${Q}`}function*Gq(Z){return yield*OW(Z.expr.map(($)=>[...rZ($)]))}function*Mq(Z){for(let $ of Z.expr)yield*rZ($)}function*Bq(Z){return yield Z.const}function*rZ(Z){return Z.type==="and"?yield*Gq(Z):Z.type==="or"?yield*Mq(Z):Z.type==="const"?yield*Bq(Z):(()=>{throw new SW("Unknown expression")})()}function DZ(Z){let $=HZ(Z.pattern);return l6($)?[...rZ($)]:[]}function X0(Z,$){return K({[S]:"Literal",const:Z,type:typeof Z},$)}function i$(Z){return K({[S]:"Boolean",type:"boolean"},Z)}function NZ(Z){return K({[S]:"BigInt",type:"bigint"},Z)}function a8(Z){return K({[S]:"Number",type:"number"},Z)}function O8(Z){return K({[S]:"String",type:"string"},Z)}function*Hq(Z){let $=Z.trim().replace(/"|'/g,"");return $==="boolean"?yield i$():$==="number"?yield a8():$==="bigint"?yield NZ():$==="string"?yield O8():yield(()=>{let Q=$.split("|").map((Y)=>X0(Y.trim()));return Q.length===0?r():Q.length===1?Q[0]:k1(Q)})()}function*Dq(Z){if(Z[1]!=="{"){let $=X0("$"),Q=f9(Z.slice(1));return yield*[$,...Q]}for(let $=2;$<Z.length;$++)if(Z[$]==="}"){let Q=Hq(Z.slice(2,$)),Y=f9(Z.slice($+1));return yield*[...Q,...Y]}yield X0(Z)}function*f9(Z){for(let $=0;$<Z.length;$++)if(Z[$]==="$"){let Q=X0(Z.slice(0,$)),Y=Dq(Z.slice($));return yield*[Q,...Y]}yield X0(Z)}function FW(Z){return[...f9(Z)]}class _W extends i{}function Nq(Z){return Z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function PW(Z,$){return l8(Z)?Z.pattern.slice(1,Z.pattern.length-1):z0(Z)?`(${Z.anyOf.map((Q)=>PW(Q,$)).join("|")})`:N1(Z)?`${$}${u$}`:D1(Z)?`${$}${u$}`:c6(Z)?`${$}${u$}`:t1(Z)?`${$}${qW}`:p8(Z)?`${$}${Nq(Z.const.toString())}`:o1(Z)?`${$}${UW}`:(()=>{throw new _W(`Unexpected Kind '${Z[S]}'`)})()}function y9(Z){return`^${Z.map(($)=>PW($,"")).join("")}$`}function n6(Z){let Q=DZ(Z).map((Y)=>X0(Y));return k1(Q)}function l$(Z,$){let Q=j0(Z)?y9(FW(Z)):y9(Z);return K({[S]:"TemplateLiteral",type:"string",pattern:Q},$)}function wq(Z){return DZ(Z).map((Q)=>Q.toString())}function Aq(Z){let $=[];for(let Q of Z)$.push(...V8(Q));return $}function Lq(Z){return[Z.toString()]}function V8(Z){return[...new Set(l8(Z)?wq(Z):z0(Z)?Aq(Z.anyOf):p8(Z)?Lq(Z.const):N1(Z)?["[number]"]:D1(Z)?["[number]"]:[])]}function Sq(Z,$,Q){let Y={};for(let W of Object.getOwnPropertyNames($))Y[W]=F6(Z,V8($[W]),Q);return Y}function Oq(Z,$,Q){return Sq(Z,$.properties,Q)}function KW(Z,$,Q){let Y=Oq(Z,$,Q);return G0(Y)}function jW(Z,$){return Z.map((Q)=>RW(Q,$))}function Fq(Z){return Z.filter(($)=>!L6($))}function _q(Z,$){return n$(Fq(jW(Z,$)))}function Pq(Z){return Z.some(($)=>L6($))?[]:Z}function Kq(Z,$){return k1(Pq(jW(Z,$)))}function Cq(Z,$){return $ in Z?Z[$]:$==="[number]"?k1(Z):r()}function jq(Z,$){return $==="[number]"?Z:r()}function Rq(Z,$){return $ in Z?Z[$]:r()}function RW(Z,$){return h0(Z)?_q(Z.allOf,$):z0(Z)?Kq(Z.anyOf,$):n8(Z)?Cq(Z.items??[],$):G1(Z)?jq(Z.items,$):o0(Z)?Rq(Z.properties,$):r()}function aZ(Z,$){return $.map((Q)=>RW(Z,Q))}function CW(Z,$){return k1(aZ(Z,$))}function F6(Z,$,Q){if(u0(Z)||u0($)){if(!d0(Z)||!d0($))throw new i("Index types using Ref parameters require both Type and Key to be of TSchema");return E0("Index",[Z,$])}if(k0($))return KW(Z,$,Q);if(i8($))return VW(Z,$,Q);return K(d0($)?CW(Z,V8($)):CW(Z,$),Q)}function Vq(Z,$,Q){return{[$]:F6(Z,[$],x0(Q))}}function Eq(Z,$,Q){return $.reduce((Y,W)=>{return{...Y,...Vq(Z,W,Q)}},{})}function Iq(Z,$,Q){return Eq(Z,$.keys,Q)}function VW(Z,$,Q){let Y=Iq(Z,$,Q);return G0(Y)}function wZ(Z,$){return K({[S]:"Iterator",type:"Iterator",items:Z},$)}function bq(Z){let $=[];for(let Q in Z)if(!R8(Z[Q]))$.push(Q);return $}function xq(Z,$){let Q=bq(Z),Y=Q.length>0?{[S]:"Object",type:"object",properties:Z,required:Q}:{[S]:"Object",type:"object",properties:Z};return K(Y,$)}var w0=xq;function o$(Z,$){return K({[S]:"Promise",type:"Promise",item:Z},$)}function Tq(Z){return K(m0(Z,[q1]))}function kq(Z){return K({...Z,[q1]:"Readonly"})}function gq(Z,$){return $===!1?Tq(Z):kq(Z)}function E8(Z,$){let Q=$??!0;return k0(Z)?EW(Z,Q):gq(Z,Q)}function fq(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=E8(Z[Y],$);return Q}function yq(Z,$){return fq(Z.properties,$)}function EW(Z,$){let Q=yq(Z,$);return G0(Q)}function e8(Z,$){return K(Z.length>0?{[S]:"Tuple",type:"array",items:Z,additionalItems:!1,minItems:Z.length,maxItems:Z.length}:{[S]:"Tuple",type:"array",minItems:Z.length,maxItems:Z.length},$)}function IW(Z,$){return Z in $?Z1(Z,$[Z]):G0($)}function dq(Z){return{[Z]:X0(Z)}}function vq(Z){let $={};for(let Q of Z)$[Q]=X0(Q);return $}function hq(Z,$){return MW($,Z)?dq(Z):vq($)}function mq(Z,$){let Q=hq(Z,$);return IW(Z,Q)}function eZ(Z,$){return $.map((Q)=>Z1(Z,Q))}function cq(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames($))Q[Y]=Z1(Z,$[Y]);return Q}function Z1(Z,$){let Q={...$};return R8($)?D8(Z1(Z,m0($,[n0]))):JZ($)?E8(Z1(Z,m0($,[q1]))):k0($)?IW(Z,$.properties):i8($)?mq(Z,$.keys):B1($)?MZ(eZ(Z,$.parameters),Z1(Z,$.returns),Q):H1($)?T1(eZ(Z,$.parameters),Z1(Z,$.returns),Q):m6($)?GZ(Z1(Z,$.items),Q):u6($)?wZ(Z1(Z,$.items),Q):h0($)?N8(eZ(Z,$.allOf),Q):z0($)?N0(eZ(Z,$.anyOf),Q):n8($)?e8(eZ(Z,$.items??[]),Q):o0($)?w0(cq(Z,$.properties),Q):G1($)?qZ(Z1(Z,$.items),Q):p6($)?o$(Z1(Z,$.item),Q):$}function uq(Z,$){let Q={};for(let Y of Z)Q[Y]=Z1(Y,$);return Q}function bW(Z,$,Q){let Y=d0(Z)?V8(Z):Z,W=$({[S]:"MappedKey",keys:Y}),X=uq(Y,W);return w0(X,Q)}function pq(Z){return K(m0(Z,[n0]))}function iq(Z){return K({...Z,[n0]:"Optional"})}function lq(Z,$){return $===!1?pq(Z):iq(Z)}function D8(Z,$){let Q=$??!0;return k0(Z)?xW(Z,Q):lq(Z,Q)}function nq(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=D8(Z[Y],$);return Q}function oq(Z,$){return nq(Z.properties,$)}function xW(Z,$){let Q=oq(Z,$);return G0(Q)}function Z$(Z,$={}){let Q=Z.every((W)=>o0(W)),Y=d0($.unevaluatedProperties)?{unevaluatedProperties:$.unevaluatedProperties}:{};return K($.unevaluatedProperties===!1||d0($.unevaluatedProperties)||Q?{...Y,[S]:"Intersect",type:"object",allOf:Z}:{...Y,[S]:"Intersect",allOf:Z},$)}function tq(Z){return Z.every(($)=>R8($))}function sq(Z){return m0(Z,[n0])}function TW(Z){return Z.map(($)=>R8($)?sq($):$)}function rq(Z,$){return tq(Z)?D8(Z$(TW(Z),$)):Z$(TW(Z),$)}function n$(Z,$={}){if(Z.length===1)return K(Z[0],$);if(Z.length===0)return r($);if(Z.some((Q)=>D0(Q)))throw new Error("Cannot intersect transform types");return rq(Z,$)}function N8(Z,$){if(Z.length===1)return K(Z[0],$);if(Z.length===0)return r($);if(Z.some((Q)=>D0(Q)))throw new Error("Cannot intersect transform types");return Z$(Z,$)}function $1(...Z){let[$,Q]=typeof Z[0]==="string"?[Z[0],Z[1]]:[Z[0].$id,Z[1]];if(typeof $!=="string")throw new i("Ref: $ref must be a string");return K({[S]:"Ref",$ref:$},Q)}function aq(Z,$){return E0("Awaited",[E0(Z,$)])}function eq(Z){return E0("Awaited",[$1(Z)])}function ZG(Z){return N8(kW(Z))}function $G(Z){return N0(kW(Z))}function QG(Z){return AZ(Z)}function kW(Z){return Z.map(($)=>AZ($))}function AZ(Z,$){return K(M1(Z)?aq(Z.target,Z.parameters):h0(Z)?ZG(Z.allOf):z0(Z)?$G(Z.anyOf):p6(Z)?QG(Z.item):u0(Z)?eq(Z.$ref):Z,$)}function gW(Z){let $=[];for(let Q of Z)$.push(I8(Q));return $}function YG(Z){let $=gW(Z);return DW($)}function WG(Z){let $=gW(Z);return HW($)}function XG(Z){return Z.map(($,Q)=>Q.toString())}function JG(Z){return["[number]"]}function zG(Z){return globalThis.Object.getOwnPropertyNames(Z)}function UG(Z){if(!d9)return[];return globalThis.Object.getOwnPropertyNames(Z).map((Q)=>{return Q[0]==="^"&&Q[Q.length-1]==="$"?Q.slice(1,Q.length-1):Q})}function I8(Z){return h0(Z)?YG(Z.allOf):z0(Z)?WG(Z.anyOf):n8(Z)?XG(Z.items??[]):G1(Z)?JG(Z.items):o0(Z)?zG(Z.properties):i6(Z)?UG(Z.patternProperties):[]}var d9=!1;function e1(Z){d9=!0;let $=I8(Z);return d9=!1,`^(${$.map((Y)=>`(${Y})`).join("|")})$`}function qG(Z,$){return E0("KeyOf",[E0(Z,$)])}function GG(Z){return E0("KeyOf",[$1(Z)])}function MG(Z,$){let Q=I8(Z),Y=BG(Q),W=k1(Y);return K(W,$)}function BG(Z){return Z.map(($)=>$==="[number]"?a8():X0($))}function LZ(Z,$){return M1(Z)?qG(Z.target,Z.parameters):u0(Z)?GG(Z.$ref):k0(Z)?fW(Z,$):MG(Z,$)}function HG(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=LZ(Z[Y],x0($));return Q}function DG(Z,$){return HG(Z.properties,$)}function fW(Z,$){let Q=DG(Z,$);return G0(Q)}function t$(Z){let $=I8(Z),Q=aZ(Z,$);return $.map((Y,W)=>[$[W],Q[W]])}function NG(Z){let $=[];for(let Q of Z)$.push(...I8(Q));return BW($)}function wG(Z){return Z.filter(($)=>!L6($))}function AG(Z,$){let Q=[];for(let Y of Z)Q.push(...aZ(Y,[$]));return wG(Q)}function LG(Z,$){let Q={};for(let Y of $)Q[Y]=n$(AG(Z,Y));return Q}function yW(Z,$){let Q=NG(Z),Y=LG(Z,Q);return w0(Y,$)}function s$(Z){return K({[S]:"Date",type:"Date"},Z)}function r$(Z){return K({[S]:"Null",type:"null"},Z)}function a$(Z){return K({[S]:"Symbol",type:"symbol"},Z)}function e$(Z){return K({[S]:"Undefined",type:"undefined"},Z)}function ZQ(Z){return K({[S]:"Uint8Array",type:"Uint8Array"},Z)}function w1(Z){return K({[S]:"Unknown"},Z)}function SG(Z){return Z.map(($)=>v9($,!1))}function OG(Z){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))$[Q]=E8(v9(Z[Q],!1));return $}function $Q(Z,$){return $===!0?Z:E8(Z)}function v9(Z,$){return _9(Z)?$Q(O6(),$):K9(Z)?$Q(O6(),$):i0(Z)?E8(e8(SG(Z))):i1(Z)?ZQ():h6(Z)?s$():O0(Z)?$Q(w0(OG(Z)),$):P9(Z)?$Q(T1([],w1()),$):l0(Z)?e$():C9(Z)?r$():j9(Z)?a$():cZ(Z)?NZ():c8(Z)?X0(Z):p1(Z)?X0(Z):j0(Z)?X0(Z):w0({})}function dW(Z,$){return K(v9(Z,!0),$)}function vW(Z,$){return B1(Z)?e8(Z.parameters,$):r($)}function hW(Z,$){if(l0(Z))throw new Error("Enum undefined or empty");let Q=globalThis.Object.getOwnPropertyNames(Z).filter((X)=>isNaN(X)).map((X)=>Z[X]),W=[...new Set(Q)].map((X)=>X0(X));return N0(W,{...$,[r8]:"Enum"})}class iW extends i{}var C;(function(Z){Z[Z.Union=0]="Union",Z[Z.True=1]="True",Z[Z.False=2]="False"})(C||(C={}));function Q1(Z){return Z===C.False?Z:C.True}function SZ(Z){throw new iW(Z)}function s0(Z){return w.IsNever(Z)||w.IsIntersect(Z)||w.IsUnion(Z)||w.IsUnknown(Z)||w.IsAny(Z)}function r0(Z,$){return w.IsNever($)?oW(Z,$):w.IsIntersect($)?QQ(Z,$):w.IsUnion($)?p9(Z,$):w.IsUnknown($)?aW(Z,$):w.IsAny($)?u9(Z,$):SZ("StructuralRight")}function u9(Z,$){return C.True}function FG(Z,$){return w.IsIntersect($)?QQ(Z,$):w.IsUnion($)&&$.anyOf.some((Q)=>w.IsAny(Q)||w.IsUnknown(Q))?C.True:w.IsUnion($)?C.Union:w.IsUnknown($)?C.True:w.IsAny($)?C.True:C.Union}function _G(Z,$){return w.IsUnknown(Z)?C.False:w.IsAny(Z)?C.Union:w.IsNever(Z)?C.True:C.False}function PG(Z,$){return w.IsObject($)&&YQ($)?C.True:s0($)?r0(Z,$):!w.IsArray($)?C.False:Q1(_0(Z.items,$.items))}function KG(Z,$){return s0($)?r0(Z,$):!w.IsAsyncIterator($)?C.False:Q1(_0(Z.items,$.items))}function CG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsBigInt($)?C.True:C.False}function lW(Z,$){return w.IsLiteralBoolean(Z)?C.True:w.IsBoolean(Z)?C.True:C.False}function jG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsBoolean($)?C.True:C.False}function RG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):!w.IsConstructor($)?C.False:Z.parameters.length>$.parameters.length?C.False:!Z.parameters.every((Q,Y)=>Q1(_0($.parameters[Y],Q))===C.True)?C.False:Q1(_0(Z.returns,$.returns))}function VG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsDate($)?C.True:C.False}function EG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):!w.IsFunction($)?C.False:Z.parameters.length>$.parameters.length?C.False:!Z.parameters.every((Q,Y)=>Q1(_0($.parameters[Y],Q))===C.True)?C.False:Q1(_0(Z.returns,$.returns))}function nW(Z,$){return w.IsLiteral(Z)&&H8.IsNumber(Z.const)?C.True:w.IsNumber(Z)||w.IsInteger(Z)?C.True:C.False}function IG(Z,$){return w.IsInteger($)||w.IsNumber($)?C.True:s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):C.False}function QQ(Z,$){return $.allOf.every((Q)=>_0(Z,Q)===C.True)?C.True:C.False}function bG(Z,$){return Z.allOf.some((Q)=>_0(Q,$)===C.True)?C.True:C.False}function xG(Z,$){return s0($)?r0(Z,$):!w.IsIterator($)?C.False:Q1(_0(Z.items,$.items))}function TG(Z,$){return w.IsLiteral($)&&$.const===Z.const?C.True:s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsString($)?rW(Z,$):w.IsNumber($)?tW(Z,$):w.IsInteger($)?nW(Z,$):w.IsBoolean($)?lW(Z,$):C.False}function oW(Z,$){return C.False}function kG(Z,$){return C.True}function mW(Z){let[$,Q]=[Z,0];while(!0){if(!w.IsNot($))break;$=$.not,Q+=1}return Q%2===0?$:w1()}function gG(Z,$){return w.IsNot(Z)?_0(mW(Z),$):w.IsNot($)?_0(Z,mW($)):SZ("Invalid fallthrough for Not")}function fG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsNull($)?C.True:C.False}function tW(Z,$){return w.IsLiteralNumber(Z)?C.True:w.IsNumber(Z)||w.IsInteger(Z)?C.True:C.False}function yG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsInteger($)||w.IsNumber($)?C.True:C.False}function b8(Z,$){return Object.getOwnPropertyNames(Z.properties).length===$}function cW(Z){return YQ(Z)}function uW(Z){return b8(Z,0)||b8(Z,1)&&"description"in Z.properties&&w.IsUnion(Z.properties.description)&&Z.properties.description.anyOf.length===2&&(w.IsString(Z.properties.description.anyOf[0])&&w.IsUndefined(Z.properties.description.anyOf[1])||w.IsString(Z.properties.description.anyOf[1])&&w.IsUndefined(Z.properties.description.anyOf[0]))}function h9(Z){return b8(Z,0)}function pW(Z){return b8(Z,0)}function dG(Z){return b8(Z,0)}function vG(Z){return b8(Z,0)}function hG(Z){return YQ(Z)}function mG(Z){let $=a8();return b8(Z,0)||b8(Z,1)&&"length"in Z.properties&&Q1(_0(Z.properties.length,$))===C.True}function cG(Z){return b8(Z,0)}function YQ(Z){let $=a8();return b8(Z,0)||b8(Z,1)&&"length"in Z.properties&&Q1(_0(Z.properties.length,$))===C.True}function uG(Z){let $=T1([O6()],O6());return b8(Z,0)||b8(Z,1)&&"then"in Z.properties&&Q1(_0(Z.properties.then,$))===C.True}function sW(Z,$){return _0(Z,$)===C.False?C.False:w.IsOptional(Z)&&!w.IsOptional($)?C.False:C.True}function w8(Z,$){return w.IsUnknown(Z)?C.False:w.IsAny(Z)?C.Union:w.IsNever(Z)||w.IsLiteralString(Z)&&cW($)||w.IsLiteralNumber(Z)&&h9($)||w.IsLiteralBoolean(Z)&&pW($)||w.IsSymbol(Z)&&uW($)||w.IsBigInt(Z)&&dG($)||w.IsString(Z)&&cW($)||w.IsSymbol(Z)&&uW($)||w.IsNumber(Z)&&h9($)||w.IsInteger(Z)&&h9($)||w.IsBoolean(Z)&&pW($)||w.IsUint8Array(Z)&&hG($)||w.IsDate(Z)&&vG($)||w.IsConstructor(Z)&&cG($)||w.IsFunction(Z)&&mG($)?C.True:w.IsRecord(Z)&&w.IsString(m9(Z))?(()=>{return $[r8]==="Record"?C.True:C.False})():w.IsRecord(Z)&&w.IsNumber(m9(Z))?(()=>{return b8($,0)?C.True:C.False})():C.False}function pG(Z,$){return s0($)?r0(Z,$):w.IsRecord($)?Y1(Z,$):!w.IsObject($)?C.False:(()=>{for(let Q of Object.getOwnPropertyNames($.properties)){if(!(Q in Z.properties)&&!w.IsOptional($.properties[Q]))return C.False;if(w.IsOptional($.properties[Q]))return C.True;if(sW(Z.properties[Q],$.properties[Q])===C.False)return C.False}return C.True})()}function iG(Z,$){return s0($)?r0(Z,$):w.IsObject($)&&uG($)?C.True:!w.IsPromise($)?C.False:Q1(_0(Z.item,$.item))}function m9(Z){return b1 in Z.patternProperties?a8():(x1 in Z.patternProperties)?O8():SZ("Unknown record key pattern")}function c9(Z){return b1 in Z.patternProperties?Z.patternProperties[b1]:(x1 in Z.patternProperties)?Z.patternProperties[x1]:SZ("Unable to get record value schema")}function Y1(Z,$){let[Q,Y]=[m9($),c9($)];return w.IsLiteralString(Z)&&w.IsNumber(Q)&&Q1(_0(Z,Y))===C.True?C.True:w.IsUint8Array(Z)&&w.IsNumber(Q)?_0(Z,Y):w.IsString(Z)&&w.IsNumber(Q)?_0(Z,Y):w.IsArray(Z)&&w.IsNumber(Q)?_0(Z,Y):w.IsObject(Z)?(()=>{for(let W of Object.getOwnPropertyNames(Z.properties))if(sW(Y,Z.properties[W])===C.False)return C.False;return C.True})():C.False}function lG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):!w.IsRecord($)?C.False:_0(c9(Z),c9($))}function nG(Z,$){let Q=w.IsRegExp(Z)?O8():Z,Y=w.IsRegExp($)?O8():$;return _0(Q,Y)}function rW(Z,$){return w.IsLiteral(Z)&&H8.IsString(Z.const)?C.True:w.IsString(Z)?C.True:C.False}function oG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsString($)?C.True:C.False}function tG(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsSymbol($)?C.True:C.False}function sG(Z,$){return w.IsTemplateLiteral(Z)?_0(n6(Z),$):w.IsTemplateLiteral($)?_0(Z,n6($)):SZ("Invalid fallthrough for TemplateLiteral")}function rG(Z,$){return w.IsArray($)&&Z.items!==void 0&&Z.items.every((Q)=>_0(Q,$.items)===C.True)}function aG(Z,$){return w.IsNever(Z)?C.True:w.IsUnknown(Z)?C.False:w.IsAny(Z)?C.Union:C.False}function eG(Z,$){return s0($)?r0(Z,$):w.IsObject($)&&YQ($)?C.True:w.IsArray($)&&rG(Z,$)?C.True:!w.IsTuple($)?C.False:H8.IsUndefined(Z.items)&&!H8.IsUndefined($.items)||!H8.IsUndefined(Z.items)&&H8.IsUndefined($.items)?C.False:H8.IsUndefined(Z.items)&&!H8.IsUndefined($.items)?C.True:Z.items.every((Q,Y)=>_0(Q,$.items[Y])===C.True)?C.True:C.False}function ZM(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsUint8Array($)?C.True:C.False}function $M(Z,$){return s0($)?r0(Z,$):w.IsObject($)?w8(Z,$):w.IsRecord($)?Y1(Z,$):w.IsVoid($)?WM(Z,$):w.IsUndefined($)?C.True:C.False}function p9(Z,$){return $.anyOf.some((Q)=>_0(Z,Q)===C.True)?C.True:C.False}function QM(Z,$){return Z.anyOf.every((Q)=>_0(Q,$)===C.True)?C.True:C.False}function aW(Z,$){return C.True}function YM(Z,$){return w.IsNever($)?oW(Z,$):w.IsIntersect($)?QQ(Z,$):w.IsUnion($)?p9(Z,$):w.IsAny($)?u9(Z,$):w.IsString($)?rW(Z,$):w.IsNumber($)?tW(Z,$):w.IsInteger($)?nW(Z,$):w.IsBoolean($)?lW(Z,$):w.IsArray($)?_G(Z,$):w.IsTuple($)?aG(Z,$):w.IsObject($)?w8(Z,$):w.IsUnknown($)?C.True:C.False}function WM(Z,$){return w.IsUndefined(Z)?C.True:w.IsUndefined(Z)?C.True:C.False}function XM(Z,$){return w.IsIntersect($)?QQ(Z,$):w.IsUnion($)?p9(Z,$):w.IsUnknown($)?aW(Z,$):w.IsAny($)?u9(Z,$):w.IsObject($)?w8(Z,$):w.IsVoid($)?C.True:C.False}function _0(Z,$){return w.IsTemplateLiteral(Z)||w.IsTemplateLiteral($)?sG(Z,$):w.IsRegExp(Z)||w.IsRegExp($)?nG(Z,$):w.IsNot(Z)||w.IsNot($)?gG(Z,$):w.IsAny(Z)?FG(Z,$):w.IsArray(Z)?PG(Z,$):w.IsBigInt(Z)?CG(Z,$):w.IsBoolean(Z)?jG(Z,$):w.IsAsyncIterator(Z)?KG(Z,$):w.IsConstructor(Z)?RG(Z,$):w.IsDate(Z)?VG(Z,$):w.IsFunction(Z)?EG(Z,$):w.IsInteger(Z)?IG(Z,$):w.IsIntersect(Z)?bG(Z,$):w.IsIterator(Z)?xG(Z,$):w.IsLiteral(Z)?TG(Z,$):w.IsNever(Z)?kG(Z,$):w.IsNull(Z)?fG(Z,$):w.IsNumber(Z)?yG(Z,$):w.IsObject(Z)?pG(Z,$):w.IsRecord(Z)?lG(Z,$):w.IsString(Z)?oG(Z,$):w.IsSymbol(Z)?tG(Z,$):w.IsTuple(Z)?eG(Z,$):w.IsPromise(Z)?iG(Z,$):w.IsUint8Array(Z)?ZM(Z,$):w.IsUndefined(Z)?$M(Z,$):w.IsUnion(Z)?QM(Z,$):w.IsUnknown(Z)?YM(Z,$):w.IsVoid(Z)?XM(Z,$):SZ(`Unknown left type operand '${Z[S]}'`)}function _6(Z,$){return _0(Z,$)}function JM(Z,$,Q,Y,W){let X={};for(let J of globalThis.Object.getOwnPropertyNames(Z))X[J]=OZ(Z[J],$,Q,Y,x0(W));return X}function zM(Z,$,Q,Y,W){return JM(Z.properties,$,Q,Y,W)}function eW(Z,$,Q,Y,W){let X=zM(Z,$,Q,Y,W);return G0(X)}function UM(Z,$,Q,Y){let W=_6(Z,$);return W===C.Union?N0([Q,Y]):W===C.True?Q:Y}function OZ(Z,$,Q,Y,W){return k0(Z)?eW(Z,$,Q,Y,W):i8(Z)?K(ZX(Z,$,Q,Y,W)):K(UM(Z,$,Q,Y),W)}function qM(Z,$,Q,Y,W){return{[Z]:OZ(X0(Z),$,Q,Y,x0(W))}}function GM(Z,$,Q,Y,W){return Z.reduce((X,J)=>{return{...X,...qM(J,$,Q,Y,W)}},{})}function MM(Z,$,Q,Y,W){return GM(Z.keys,$,Q,Y,W)}function ZX(Z,$,Q,Y,W){let X=MM(Z,$,Q,Y,W);return G0(X)}function BM(Z){return Z.allOf.every(($)=>Z6($))}function HM(Z){return Z.anyOf.some(($)=>Z6($))}function DM(Z){return!Z6(Z.not)}function Z6(Z){return Z[S]==="Intersect"?BM(Z):Z[S]==="Union"?HM(Z):Z[S]==="Not"?DM(Z):Z[S]==="Undefined"?!0:!1}function $X(Z,$){return FZ(n6(Z),$)}function NM(Z,$){let Q=Z.filter((Y)=>_6(Y,$)===C.False);return Q.length===1?Q[0]:N0(Q)}function FZ(Z,$,Q={}){if(l8(Z))return K($X(Z,$),Q);if(k0(Z))return K(QX(Z,$),Q);return K(z0(Z)?NM(Z.anyOf,$):_6(Z,$)!==C.False?r():Z,Q)}function wM(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=FZ(Z[Y],$);return Q}function AM(Z,$){return wM(Z.properties,$)}function QX(Z,$){let Q=AM(Z,$);return G0(Q)}function YX(Z,$){return _Z(n6(Z),$)}function LM(Z,$){let Q=Z.filter((Y)=>_6(Y,$)!==C.False);return Q.length===1?Q[0]:N0(Q)}function _Z(Z,$,Q){if(l8(Z))return K(YX(Z,$),Q);if(k0(Z))return K(WX(Z,$),Q);return K(z0(Z)?LM(Z.anyOf,$):_6(Z,$)!==C.False?Z:r(),Q)}function SM(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=_Z(Z[Y],$);return Q}function OM(Z,$){return SM(Z.properties,$)}function WX(Z,$){let Q=OM(Z,$);return G0(Q)}function XX(Z,$){return B1(Z)?K(Z.returns,$):r($)}function WQ(Z){return E8(D8(Z))}function o6(Z,$,Q){return K({[S]:"Record",type:"object",patternProperties:{[Z]:$}},Q)}function i9(Z,$,Q){let Y={};for(let W of Z)Y[W]=$;return w0(Y,{...Q,[r8]:"Record"})}function FM(Z,$,Q){return p$(Z)?i9(V8(Z),$,Q):o6(Z.pattern,$,Q)}function _M(Z,$,Q){return i9(V8(N0(Z)),$,Q)}function PM(Z,$,Q){return i9([Z.toString()],$,Q)}function KM(Z,$,Q){return o6(Z.source,$,Q)}function CM(Z,$,Q){let Y=l0(Z.pattern)?x1:Z.pattern;return o6(Y,$,Q)}function jM(Z,$,Q){return o6(x1,$,Q)}function RM(Z,$,Q){return o6(GW,$,Q)}function VM(Z,$,Q){return w0({true:$,false:$},Q)}function EM(Z,$,Q){return o6(b1,$,Q)}function IM(Z,$,Q){return o6(b1,$,Q)}function XQ(Z,$,Q={}){return z0(Z)?_M(Z.anyOf,$,Q):l8(Z)?FM(Z,$,Q):p8(Z)?PM(Z.const,$,Q):o1(Z)?VM(Z,$,Q):D1(Z)?EM(Z,$,Q):N1(Z)?IM(Z,$,Q):I9(Z)?KM(Z,$,Q):t1(Z)?CM(Z,$,Q):V9(Z)?jM(Z,$,Q):L6(Z)?RM(Z,$,Q):r(Q)}function JQ(Z){return globalThis.Object.getOwnPropertyNames(Z.patternProperties)[0]}function JX(Z){let $=JQ(Z);return $===x1?O8():$===b1?a8():O8({pattern:$})}function zQ(Z){return Z.patternProperties[JQ(Z)]}function bM(Z,$){return $.parameters=$$(Z,$.parameters),$.returns=A1(Z,$.returns),$}function xM(Z,$){return $.parameters=$$(Z,$.parameters),$.returns=A1(Z,$.returns),$}function TM(Z,$){return $.allOf=$$(Z,$.allOf),$}function kM(Z,$){return $.anyOf=$$(Z,$.anyOf),$}function gM(Z,$){if(l0($.items))return $;return $.items=$$(Z,$.items),$}function fM(Z,$){return $.items=A1(Z,$.items),$}function yM(Z,$){return $.items=A1(Z,$.items),$}function dM(Z,$){return $.items=A1(Z,$.items),$}function vM(Z,$){return $.item=A1(Z,$.item),$}function hM(Z,$){let Q=pM(Z,$.properties);return{...$,...w0(Q)}}function mM(Z,$){let Q=A1(Z,JX($)),Y=A1(Z,zQ($)),W=XQ(Q,Y);return{...$,...W}}function cM(Z,$){return $.index in Z?Z[$.index]:w1()}function uM(Z,$){let Q=JZ($),Y=R8($),W=A1(Z,$);return Q&&Y?WQ(W):Q&&!Y?E8(W):!Q&&Y?D8(W):W}function pM(Z,$){return globalThis.Object.getOwnPropertyNames($).reduce((Q,Y)=>{return{...Q,[Y]:uM(Z,$[Y])}},{})}function $$(Z,$){return $.map((Q)=>A1(Z,Q))}function A1(Z,$){return B1($)?bM(Z,$):H1($)?xM(Z,$):h0($)?TM(Z,$):z0($)?kM(Z,$):n8($)?gM(Z,$):G1($)?fM(Z,$):m6($)?yM(Z,$):u6($)?dM(Z,$):p6($)?vM(Z,$):o0($)?hM(Z,$):i6($)?mM(Z,$):E9($)?cM(Z,$):$}function zX(Z,$){return A1($,WZ(Z))}function UX(Z){return K({[S]:"Integer",type:"integer"},Z)}function iM(Z,$,Q){return{[Z]:L1(X0(Z),$,x0(Q))}}function lM(Z,$,Q){return Z.reduce((W,X)=>{return{...W,...iM(X,$,Q)}},{})}function nM(Z,$,Q){return lM(Z.keys,$,Q)}function qX(Z,$,Q){let Y=nM(Z,$,Q);return G0(Y)}function oM(Z){let[$,Q]=[Z.slice(0,1),Z.slice(1)];return[$.toLowerCase(),Q].join("")}function tM(Z){let[$,Q]=[Z.slice(0,1),Z.slice(1)];return[$.toUpperCase(),Q].join("")}function sM(Z){return Z.toUpperCase()}function rM(Z){return Z.toLowerCase()}function aM(Z,$,Q){let Y=HZ(Z.pattern);if(!l6(Y))return{...Z,pattern:GX(Z.pattern,$)};let J=[...rZ(Y)].map((q)=>X0(q)),z=MX(J,$),U=N0(z);return l$([U],Q)}function GX(Z,$){return typeof Z==="string"?$==="Uncapitalize"?oM(Z):$==="Capitalize"?tM(Z):$==="Uppercase"?sM(Z):$==="Lowercase"?rM(Z):Z:Z.toString()}function MX(Z,$){return Z.map((Q)=>L1(Q,$))}function L1(Z,$,Q={}){return i8(Z)?qX(Z,$,Q):l8(Z)?aM(Z,$,Q):z0(Z)?N0(MX(Z.anyOf,$),Q):p8(Z)?X0(GX(Z.const,$),Q):K(Z,Q)}function BX(Z,$={}){return L1(Z,"Capitalize",$)}function HX(Z,$={}){return L1(Z,"Lowercase",$)}function DX(Z,$={}){return L1(Z,"Uncapitalize",$)}function NX(Z,$={}){return L1(Z,"Uppercase",$)}function eM(Z,$,Q){let Y={};for(let W of globalThis.Object.getOwnPropertyNames(Z))Y[W]=P6(Z[W],$,x0(Q));return Y}function ZB(Z,$,Q){return eM(Z.properties,$,Q)}function wX(Z,$,Q){let Y=ZB(Z,$,Q);return G0(Y)}function $B(Z,$){return Z.map((Q)=>l9(Q,$))}function QB(Z,$){return Z.map((Q)=>l9(Q,$))}function YB(Z,$){let{[$]:Q,...Y}=Z;return Y}function WB(Z,$){return $.reduce((Q,Y)=>YB(Q,Y),Z)}function XB(Z,$){let Q=m0(Z,[P0,"$id","required","properties"]),Y=WB(Z.properties,$);return w0(Y,Q)}function JB(Z){let $=Z.reduce((Q,Y)=>m$(Y)?[...Q,X0(Y)]:Q,[]);return N0($)}function l9(Z,$){return h0(Z)?N8($B(Z.allOf,$)):z0(Z)?N0(QB(Z.anyOf,$)):o0(Z)?XB(Z,$):w0({})}function P6(Z,$,Q){let Y=i0($)?JB($):$,W=d0($)?V8($):$,X=u0(Z),J=u0($);return k0(Z)?wX(Z,W,Q):i8($)?AX(Z,$,Q):X&&J?E0("Omit",[Z,Y],Q):!X&&J?E0("Omit",[Z,Y],Q):X&&!J?E0("Omit",[Z,Y],Q):K({...l9(Z,W),...Q})}function zB(Z,$,Q){return{[$]:P6(Z,[$],x0(Q))}}function UB(Z,$,Q){return $.reduce((Y,W)=>{return{...Y,...zB(Z,W,Q)}},{})}function qB(Z,$,Q){return UB(Z,$.keys,Q)}function AX(Z,$,Q){let Y=qB(Z,$,Q);return G0(Y)}function GB(Z,$,Q){let Y={};for(let W of globalThis.Object.getOwnPropertyNames(Z))Y[W]=K6(Z[W],$,x0(Q));return Y}function MB(Z,$,Q){return GB(Z.properties,$,Q)}function LX(Z,$,Q){let Y=MB(Z,$,Q);return G0(Y)}function BB(Z,$){return Z.map((Q)=>n9(Q,$))}function HB(Z,$){return Z.map((Q)=>n9(Q,$))}function DB(Z,$){let Q={};for(let Y of $)if(Y in Z)Q[Y]=Z[Y];return Q}function NB(Z,$){let Q=m0(Z,[P0,"$id","required","properties"]),Y=DB(Z.properties,$);return w0(Y,Q)}function wB(Z){let $=Z.reduce((Q,Y)=>m$(Y)?[...Q,X0(Y)]:Q,[]);return N0($)}function n9(Z,$){return h0(Z)?N8(BB(Z.allOf,$)):z0(Z)?N0(HB(Z.anyOf,$)):o0(Z)?NB(Z,$):w0({})}function K6(Z,$,Q){let Y=i0($)?wB($):$,W=d0($)?V8($):$,X=u0(Z),J=u0($);return k0(Z)?LX(Z,W,Q):i8($)?SX(Z,$,Q):X&&J?E0("Pick",[Z,Y],Q):!X&&J?E0("Pick",[Z,Y],Q):X&&!J?E0("Pick",[Z,Y],Q):K({...n9(Z,W),...Q})}function AB(Z,$,Q){return{[$]:K6(Z,[$],x0(Q))}}function LB(Z,$,Q){return $.reduce((Y,W)=>{return{...Y,...AB(Z,W,Q)}},{})}function SB(Z,$,Q){return LB(Z,$.keys,Q)}function SX(Z,$,Q){let Y=SB(Z,$,Q);return G0(Y)}function OB(Z,$){return E0("Partial",[E0(Z,$)])}function FB(Z){return E0("Partial",[$1(Z)])}function _B(Z){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))$[Q]=D8(Z[Q]);return $}function PB(Z){let $=m0(Z,[P0,"$id","required","properties"]),Q=_B(Z.properties);return w0(Q,$)}function OX(Z){return Z.map(($)=>FX($))}function FX(Z){return M1(Z)?OB(Z.target,Z.parameters):u0(Z)?FB(Z.$ref):h0(Z)?N8(OX(Z.allOf)):z0(Z)?N0(OX(Z.anyOf)):o0(Z)?PB(Z):c6(Z)?Z:o1(Z)?Z:D1(Z)?Z:p8(Z)?Z:iZ(Z)?Z:N1(Z)?Z:t1(Z)?Z:lZ(Z)?Z:s1(Z)?Z:w0({})}function PZ(Z,$){if(k0(Z))return _X(Z,$);else return K({...FX(Z),...$})}function KB(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=PZ(Z[Y],x0($));return Q}function CB(Z,$){return KB(Z.properties,$)}function _X(Z,$){let Q=CB(Z,$);return G0(Q)}function jB(Z,$){return E0("Required",[E0(Z,$)])}function RB(Z){return E0("Required",[$1(Z)])}function VB(Z){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))$[Q]=m0(Z[Q],[n0]);return $}function EB(Z){let $=m0(Z,[P0,"$id","required","properties"]),Q=VB(Z.properties);return w0(Q,$)}function PX(Z){return Z.map(($)=>KX($))}function KX(Z){return M1(Z)?jB(Z.target,Z.parameters):u0(Z)?RB(Z.$ref):h0(Z)?N8(PX(Z.allOf)):z0(Z)?N0(PX(Z.anyOf)):o0(Z)?EB(Z):c6(Z)?Z:o1(Z)?Z:D1(Z)?Z:p8(Z)?Z:iZ(Z)?Z:N1(Z)?Z:t1(Z)?Z:lZ(Z)?Z:s1(Z)?Z:w0({})}function KZ(Z,$){if(k0(Z))return CX(Z,$);else return K({...KX(Z),...$})}function IB(Z,$){let Q={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))Q[Y]=KZ(Z[Y],$);return Q}function bB(Z,$){return IB(Z.properties,$)}function CX(Z,$){let Q=bB(Z,$);return G0(Q)}function xB(Z,$){return $.map((Q)=>{return u0(Q)?o9(Z,Q.$ref):o8(Z,Q)})}function o9(Z,$){return $ in Z?u0(Z[$])?o9(Z,Z[$].$ref):o8(Z,Z[$]):r()}function TB(Z){return AZ(Z[0])}function kB(Z){return F6(Z[0],Z[1])}function gB(Z){return LZ(Z[0])}function fB(Z){return PZ(Z[0])}function yB(Z){return P6(Z[0],Z[1])}function dB(Z){return K6(Z[0],Z[1])}function vB(Z){return KZ(Z[0])}function hB(Z,$,Q){let Y=xB(Z,Q);return $==="Awaited"?TB(Y):$==="Index"?kB(Y):$==="KeyOf"?gB(Y):$==="Partial"?fB(Y):$==="Omit"?yB(Y):$==="Pick"?dB(Y):$==="Required"?vB(Y):r()}function mB(Z,$){return qZ(o8(Z,$))}function cB(Z,$){return GZ(o8(Z,$))}function uB(Z,$,Q){return MZ(Q$(Z,$),o8(Z,Q))}function pB(Z,$,Q){return T1(Q$(Z,$),o8(Z,Q))}function iB(Z,$){return N8(Q$(Z,$))}function lB(Z,$){return wZ(o8(Z,$))}function nB(Z,$){return w0(globalThis.Object.keys($).reduce((Q,Y)=>{return{...Q,[Y]:o8(Z,$[Y])}},{}))}function oB(Z,$){let[Q,Y]=[o8(Z,zQ($)),JQ($)],W=WZ($);return W.patternProperties[Y]=Q,W}function tB(Z,$){return u0($)?{...o9(Z,$.$ref),[P0]:$[P0]}:$}function sB(Z,$){return e8(Q$(Z,$))}function rB(Z,$){return N0(Q$(Z,$))}function Q$(Z,$){return $.map((Q)=>o8(Z,Q))}function o8(Z,$){return R8($)?K(o8(Z,m0($,[n0])),$):JZ($)?K(o8(Z,m0($,[q1])),$):D0($)?K(tB(Z,$),$):G1($)?K(mB(Z,$.items),$):m6($)?K(cB(Z,$.items),$):M1($)?K(hB(Z,$.target,$.parameters)):B1($)?K(uB(Z,$.parameters,$.returns),$):H1($)?K(pB(Z,$.parameters,$.returns),$):h0($)?K(iB(Z,$.allOf),$):u6($)?K(lB(Z,$.items),$):o0($)?K(nB(Z,$.properties),$):i6($)?K(oB(Z,$)):n8($)?K(sB(Z,$.items||[]),$):z0($)?K(rB(Z,$.anyOf),$):$}function aB(Z,$){return $ in Z?o8(Z,Z[$]):r()}function jX(Z){return globalThis.Object.getOwnPropertyNames(Z).reduce(($,Q)=>{return{...$,[Q]:aB(Z,Q)}},{})}class RX{constructor(Z){let $=jX(Z),Q=this.WithIdentifiers($);this.$defs=Q}Import(Z,$){let Q={...this.$defs,[Z]:K(this.$defs[Z],$)};return K({[S]:"Import",$defs:Q,$ref:Z})}WithIdentifiers(Z){return globalThis.Object.getOwnPropertyNames(Z).reduce(($,Q)=>{return{...$,[Q]:{...Z[Q],$id:Q}}},{})}}function VX(Z){return new RX(Z)}function EX(Z,$){return K({[S]:"Not",not:Z},$)}function IX(Z,$){return H1(Z)?e8(Z.parameters,$):r()}var eB=0;function bX(Z,$={}){if(l0($.$id))$.$id=`T${eB++}`;let Q=WZ(Z({[S]:"This",$ref:`${$.$id}`}));return Q.$id=$.$id,K({[r8]:"Recursive",...Q},$)}function xX(Z,$){let Q=j0(Z)?new globalThis.RegExp(Z):Z;return K({[S]:"RegExp",type:"RegExp",source:Q.source,flags:Q.flags},$)}function ZH(Z){return h0(Z)?Z.allOf:z0(Z)?Z.anyOf:n8(Z)?Z.items??[]:[]}function TX(Z){return ZH(Z)}function kX(Z,$){return H1(Z)?K(Z.returns,$):r($)}class gX{constructor(Z){this.schema=Z}Decode(Z){return new fX(this.schema,Z)}}class fX{constructor(Z,$){this.schema=Z,this.decode=$}EncodeTransform(Z,$){let W={Encode:(X)=>$[P0].Encode(Z(X)),Decode:(X)=>this.decode($[P0].Decode(X))};return{...$,[P0]:W}}EncodeSchema(Z,$){let Q={Decode:this.decode,Encode:Z};return{...$,[P0]:Q}}Encode(Z){return D0(this.schema)?this.EncodeTransform(Z,this.schema):this.EncodeSchema(Z,this.schema)}}function yX(Z){return new gX(Z)}function UQ(Z={}){return K({[S]:Z[S]??"Unsafe"},Z)}function dX(Z){return K({[S]:"Void",type:"void"},Z)}var t9={};v6(t9,{Void:()=>dX,Uppercase:()=>NX,Unsafe:()=>UQ,Unknown:()=>w1,Union:()=>N0,Undefined:()=>e$,Uncapitalize:()=>DX,Uint8Array:()=>ZQ,Tuple:()=>e8,Transform:()=>yX,TemplateLiteral:()=>l$,Symbol:()=>a$,String:()=>O8,ReturnType:()=>kX,Rest:()=>TX,Required:()=>KZ,RegExp:()=>xX,Ref:()=>$1,Recursive:()=>bX,Record:()=>XQ,ReadonlyOptional:()=>WQ,Readonly:()=>E8,Promise:()=>o$,Pick:()=>K6,Partial:()=>PZ,Parameters:()=>IX,Optional:()=>D8,Omit:()=>P6,Object:()=>w0,Number:()=>a8,Null:()=>r$,Not:()=>EX,Never:()=>r,Module:()=>VX,Mapped:()=>bW,Lowercase:()=>HX,Literal:()=>X0,KeyOf:()=>LZ,Iterator:()=>wZ,Intersect:()=>N8,Integer:()=>UX,Instantiate:()=>zX,InstanceType:()=>XX,Index:()=>F6,Function:()=>T1,Extract:()=>_Z,Extends:()=>OZ,Exclude:()=>FZ,Enum:()=>hW,Date:()=>s$,ConstructorParameters:()=>vW,Constructor:()=>MZ,Const:()=>dW,Composite:()=>yW,Capitalize:()=>BX,Boolean:()=>i$,BigInt:()=>NZ,Awaited:()=>AZ,AsyncIterator:()=>GZ,Array:()=>qZ,Argument:()=>NW,Any:()=>O6});var $6=t9;function $H(Z){switch(Z.errorType){case P.ArrayContains:return"Expected array to contain at least one matching value";case P.ArrayMaxContains:return`Expected array to contain no more than ${Z.schema.maxContains} matching values`;case P.ArrayMinContains:return`Expected array to contain at least ${Z.schema.minContains} matching values`;case P.ArrayMaxItems:return`Expected array length to be less or equal to ${Z.schema.maxItems}`;case P.ArrayMinItems:return`Expected array length to be greater or equal to ${Z.schema.minItems}`;case P.ArrayUniqueItems:return"Expected array elements to be unique";case P.Array:return"Expected array";case P.AsyncIterator:return"Expected AsyncIterator";case P.BigIntExclusiveMaximum:return`Expected bigint to be less than ${Z.schema.exclusiveMaximum}`;case P.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${Z.schema.exclusiveMinimum}`;case P.BigIntMaximum:return`Expected bigint to be less or equal to ${Z.schema.maximum}`;case P.BigIntMinimum:return`Expected bigint to be greater or equal to ${Z.schema.minimum}`;case P.BigIntMultipleOf:return`Expected bigint to be a multiple of ${Z.schema.multipleOf}`;case P.BigInt:return"Expected bigint";case P.Boolean:return"Expected boolean";case P.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${Z.schema.exclusiveMinimumTimestamp}`;case P.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${Z.schema.exclusiveMaximumTimestamp}`;case P.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${Z.schema.minimumTimestamp}`;case P.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${Z.schema.maximumTimestamp}`;case P.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${Z.schema.multipleOfTimestamp}`;case P.Date:return"Expected Date";case P.Function:return"Expected function";case P.IntegerExclusiveMaximum:return`Expected integer to be less than ${Z.schema.exclusiveMaximum}`;case P.IntegerExclusiveMinimum:return`Expected integer to be greater than ${Z.schema.exclusiveMinimum}`;case P.IntegerMaximum:return`Expected integer to be less or equal to ${Z.schema.maximum}`;case P.IntegerMinimum:return`Expected integer to be greater or equal to ${Z.schema.minimum}`;case P.IntegerMultipleOf:return`Expected integer to be a multiple of ${Z.schema.multipleOf}`;case P.Integer:return"Expected integer";case P.IntersectUnevaluatedProperties:return"Unexpected property";case P.Intersect:return"Expected all values to match";case P.Iterator:return"Expected Iterator";case P.Literal:return`Expected ${typeof Z.schema.const==="string"?`'${Z.schema.const}'`:Z.schema.const}`;case P.Never:return"Never";case P.Not:return"Value should not match";case P.Null:return"Expected null";case P.NumberExclusiveMaximum:return`Expected number to be less than ${Z.schema.exclusiveMaximum}`;case P.NumberExclusiveMinimum:return`Expected number to be greater than ${Z.schema.exclusiveMinimum}`;case P.NumberMaximum:return`Expected number to be less or equal to ${Z.schema.maximum}`;case P.NumberMinimum:return`Expected number to be greater or equal to ${Z.schema.minimum}`;case P.NumberMultipleOf:return`Expected number to be a multiple of ${Z.schema.multipleOf}`;case P.Number:return"Expected number";case P.Object:return"Expected object";case P.ObjectAdditionalProperties:return"Unexpected property";case P.ObjectMaxProperties:return`Expected object to have no more than ${Z.schema.maxProperties} properties`;case P.ObjectMinProperties:return`Expected object to have at least ${Z.schema.minProperties} properties`;case P.ObjectRequiredProperty:return"Expected required property";case P.Promise:return"Expected Promise";case P.RegExp:return"Expected string to match regular expression";case P.StringFormatUnknown:return`Unknown format '${Z.schema.format}'`;case P.StringFormat:return`Expected string to match '${Z.schema.format}' format`;case P.StringMaxLength:return`Expected string length less or equal to ${Z.schema.maxLength}`;case P.StringMinLength:return`Expected string length greater or equal to ${Z.schema.minLength}`;case P.StringPattern:return`Expected string to match '${Z.schema.pattern}'`;case P.String:return"Expected string";case P.Symbol:return"Expected symbol";case P.TupleLength:return`Expected tuple to have ${Z.schema.maxItems||0} elements`;case P.Tuple:return"Expected tuple";case P.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${Z.schema.maxByteLength}`;case P.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${Z.schema.minByteLength}`;case P.Uint8Array:return"Expected Uint8Array";case P.Undefined:return"Expected undefined";case P.Union:return"Expected union value";case P.Void:return"Expected void";case P.Kind:return`Expected kind '${Z.schema[S]}'`;default:return"Unknown error type"}}var QH=$H;function vX(){return QH}class hX extends i{constructor(Z){super(`Unable to dereference schema with $id '${Z.$ref}'`);this.schema=Z}}function YH(Z,$){let Q=$.find((Y)=>Y.$id===Z.$ref);if(Q===void 0)throw new hX(Z);return M0(Q,$)}function Q8(Z,$){if(!J0(Z.$id)||$.some((Q)=>Q.$id===Z.$id))return $;return $.push(Z),$}function M0(Z,$){return Z[S]==="This"||Z[S]==="Ref"?YH(Z,$):Z}class mX extends i{constructor(Z){super("Unable to hash value");this.value=Z}}var t8;(function(Z){Z[Z.Undefined=0]="Undefined",Z[Z.Null=1]="Null",Z[Z.Boolean=2]="Boolean",Z[Z.Number=3]="Number",Z[Z.String=4]="String",Z[Z.Object=5]="Object",Z[Z.Array=6]="Array",Z[Z.Date=7]="Date",Z[Z.Uint8Array=8]="Uint8Array",Z[Z.Symbol=9]="Symbol",Z[Z.BigInt=10]="BigInt"})(t8||(t8={}));var CZ=BigInt("14695981039346656037"),[WH,XH]=[BigInt("1099511628211"),BigInt("18446744073709551616")],JH=Array.from({length:256}).map((Z,$)=>BigInt($)),cX=new Float64Array(1),uX=new DataView(cX.buffer),pX=new Uint8Array(cX.buffer);function*zH(Z){let $=Z===0?1:Math.ceil(Math.floor(Math.log2(Z)+1)/8);for(let Q=0;Q<$;Q++)yield Z>>8*($-1-Q)&255}function UH(Z){A8(t8.Array);for(let $ of Z)jZ($)}function qH(Z){A8(t8.Boolean),A8(Z?1:0)}function GH(Z){A8(t8.BigInt),uX.setBigInt64(0,Z);for(let $ of pX)A8($)}function MH(Z){A8(t8.Date),jZ(Z.getTime())}function BH(Z){A8(t8.Null)}function HH(Z){A8(t8.Number),uX.setFloat64(0,Z);for(let $ of pX)A8($)}function DH(Z){A8(t8.Object);for(let $ of globalThis.Object.getOwnPropertyNames(Z).sort())jZ($),jZ(Z[$])}function NH(Z){A8(t8.String);for(let $=0;$<Z.length;$++)for(let Q of zH(Z.charCodeAt($)))A8(Q)}function wH(Z){A8(t8.Symbol),jZ(Z.description)}function AH(Z){A8(t8.Uint8Array);for(let $=0;$<Z.length;$++)A8(Z[$])}function LH(Z){return A8(t8.Undefined)}function jZ(Z){if(o(Z))return UH(Z);if(I1(Z))return qH(Z);if(z8(Z))return GH(Z);if(S8(Z))return MH(Z);if(l1(Z))return BH(Z);if(u(Z))return HH(Z);if(a(Z))return DH(Z);if(J0(Z))return NH(Z);if(n1(Z))return wH(Z);if(XZ(Z))return AH(Z);if(T0(Z))return LH(Z);throw new mX(Z)}function A8(Z){CZ=CZ^JH[Z],CZ=CZ*WH%XH}function C6(Z){return CZ=BigInt("14695981039346656037"),jZ(Z),CZ}class iX extends i{constructor(Z){super("Unknown type");this.schema=Z}}function SH(Z){return Z[S]==="Any"||Z[S]==="Unknown"}function Q0(Z){return Z!==void 0}function OH(Z,$,Q){return!0}function FH(Z,$,Q){return!0}function _H(Z,$,Q){if(!o(Q))return!1;if(Q0(Z.minItems)&&!(Q.length>=Z.minItems))return!1;if(Q0(Z.maxItems)&&!(Q.length<=Z.maxItems))return!1;if(!Q.every((X)=>Y8(Z.items,$,X)))return!1;if(Z.uniqueItems===!0&&!function(){let X=new Set;for(let J of Q){let z=C6(J);if(X.has(z))return!1;else X.add(z)}return!0}())return!1;if(!(Q0(Z.contains)||u(Z.minContains)||u(Z.maxContains)))return!0;let Y=Q0(Z.contains)?Z.contains:r(),W=Q.reduce((X,J)=>Y8(Y,$,J)?X+1:X,0);if(W===0)return!1;if(u(Z.minContains)&&W<Z.minContains)return!1;if(u(Z.maxContains)&&W>Z.maxContains)return!1;return!0}function PH(Z,$,Q){return y$(Q)}function KH(Z,$,Q){if(!z8(Q))return!1;if(Q0(Z.exclusiveMaximum)&&!(Q<Z.exclusiveMaximum))return!1;if(Q0(Z.exclusiveMinimum)&&!(Q>Z.exclusiveMinimum))return!1;if(Q0(Z.maximum)&&!(Q<=Z.maximum))return!1;if(Q0(Z.minimum)&&!(Q>=Z.minimum))return!1;if(Q0(Z.multipleOf)&&Q%Z.multipleOf!==BigInt(0))return!1;return!0}function CH(Z,$,Q){return I1(Q)}function jH(Z,$,Q){return Y8(Z.returns,$,Q.prototype)}function RH(Z,$,Q){if(!S8(Q))return!1;if(Q0(Z.exclusiveMaximumTimestamp)&&!(Q.getTime()<Z.exclusiveMaximumTimestamp))return!1;if(Q0(Z.exclusiveMinimumTimestamp)&&!(Q.getTime()>Z.exclusiveMinimumTimestamp))return!1;if(Q0(Z.maximumTimestamp)&&!(Q.getTime()<=Z.maximumTimestamp))return!1;if(Q0(Z.minimumTimestamp)&&!(Q.getTime()>=Z.minimumTimestamp))return!1;if(Q0(Z.multipleOfTimestamp)&&Q.getTime()%Z.multipleOfTimestamp!==0)return!1;return!0}function VH(Z,$,Q){return A6(Q)}function EH(Z,$,Q){let Y=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return Y8(W,[...$,...Y],Q)}function IH(Z,$,Q){if(!h$(Q))return!1;if(Q0(Z.exclusiveMaximum)&&!(Q<Z.exclusiveMaximum))return!1;if(Q0(Z.exclusiveMinimum)&&!(Q>Z.exclusiveMinimum))return!1;if(Q0(Z.maximum)&&!(Q<=Z.maximum))return!1;if(Q0(Z.minimum)&&!(Q>=Z.minimum))return!1;if(Q0(Z.multipleOf)&&Q%Z.multipleOf!==0)return!1;return!0}function bH(Z,$,Q){let Y=Z.allOf.every((W)=>Y8(W,$,Q));if(Z.unevaluatedProperties===!1){let W=new RegExp(e1(Z)),X=Object.getOwnPropertyNames(Q).every((J)=>W.test(J));return Y&&X}else if(d0(Z.unevaluatedProperties)){let W=new RegExp(e1(Z)),X=Object.getOwnPropertyNames(Q).every((J)=>W.test(J)||Y8(Z.unevaluatedProperties,$,Q[J]));return Y&&X}else return Y}function xH(Z,$,Q){return d$(Q)}function TH(Z,$,Q){return Q===Z.const}function kH(Z,$,Q){return!1}function gH(Z,$,Q){return!Y8(Z.not,$,Q)}function fH(Z,$,Q){return l1(Q)}function yH(Z,$,Q){if(!V0.IsNumberLike(Q))return!1;if(Q0(Z.exclusiveMaximum)&&!(Q<Z.exclusiveMaximum))return!1;if(Q0(Z.exclusiveMinimum)&&!(Q>Z.exclusiveMinimum))return!1;if(Q0(Z.minimum)&&!(Q>=Z.minimum))return!1;if(Q0(Z.maximum)&&!(Q<=Z.maximum))return!1;if(Q0(Z.multipleOf)&&Q%Z.multipleOf!==0)return!1;return!0}function dH(Z,$,Q){if(!V0.IsObjectLike(Q))return!1;if(Q0(Z.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=Z.minProperties))return!1;if(Q0(Z.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=Z.maxProperties))return!1;let Y=Object.getOwnPropertyNames(Z.properties);for(let W of Y){let X=Z.properties[W];if(Z.required&&Z.required.includes(W)){if(!Y8(X,$,Q[W]))return!1;if((Z6(X)||SH(X))&&!(W in Q))return!1}else if(V0.IsExactOptionalProperty(Q,W)&&!Y8(X,$,Q[W]))return!1}if(Z.additionalProperties===!1){let W=Object.getOwnPropertyNames(Q);if(Z.required&&Z.required.length===Y.length&&W.length===Y.length)return!0;else return W.every((X)=>Y.includes(X))}else if(typeof Z.additionalProperties==="object")return Object.getOwnPropertyNames(Q).every((X)=>Y.includes(X)||Y8(Z.additionalProperties,$,Q[X]));else return!0}function vH(Z,$,Q){return v$(Q)}function hH(Z,$,Q){if(!V0.IsRecordLike(Q))return!1;if(Q0(Z.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=Z.minProperties))return!1;if(Q0(Z.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=Z.maxProperties))return!1;let[Y,W]=Object.entries(Z.patternProperties)[0],X=new RegExp(Y),J=Object.entries(Q).every(([q,G])=>{return X.test(q)?Y8(W,$,G):!0}),z=typeof Z.additionalProperties==="object"?Object.entries(Q).every(([q,G])=>{return!X.test(q)?Y8(Z.additionalProperties,$,G):!0}):!0,U=Z.additionalProperties===!1?Object.getOwnPropertyNames(Q).every((q)=>{return X.test(q)}):!0;return J&&z&&U}function mH(Z,$,Q){return Y8(M0(Z,$),$,Q)}function cH(Z,$,Q){let Y=new RegExp(Z.source,Z.flags);if(Q0(Z.minLength)){if(!(Q.length>=Z.minLength))return!1}if(Q0(Z.maxLength)){if(!(Q.length<=Z.maxLength))return!1}return Y.test(Q)}function uH(Z,$,Q){if(!J0(Q))return!1;if(Q0(Z.minLength)){if(!(Q.length>=Z.minLength))return!1}if(Q0(Z.maxLength)){if(!(Q.length<=Z.maxLength))return!1}if(Q0(Z.pattern)){if(!new RegExp(Z.pattern).test(Q))return!1}if(Q0(Z.format)){if(!S0.Has(Z.format))return!1;return S0.Get(Z.format)(Q)}return!0}function pH(Z,$,Q){return n1(Q)}function iH(Z,$,Q){return J0(Q)&&new RegExp(Z.pattern).test(Q)}function lH(Z,$,Q){return Y8(M0(Z,$),$,Q)}function nH(Z,$,Q){if(!o(Q))return!1;if(Z.items===void 0&&Q.length!==0)return!1;if(Q.length!==Z.maxItems)return!1;if(!Z.items)return!0;for(let Y=0;Y<Z.items.length;Y++)if(!Y8(Z.items[Y],$,Q[Y]))return!1;return!0}function oH(Z,$,Q){return T0(Q)}function tH(Z,$,Q){return Z.anyOf.some((Y)=>Y8(Y,$,Q))}function sH(Z,$,Q){if(!XZ(Q))return!1;if(Q0(Z.maxByteLength)&&!(Q.length<=Z.maxByteLength))return!1;if(Q0(Z.minByteLength)&&!(Q.length>=Z.minByteLength))return!1;return!0}function rH(Z,$,Q){return!0}function aH(Z,$,Q){return V0.IsVoidLike(Q)}function eH(Z,$,Q){if(!e0.Has(Z[S]))return!1;return e0.Get(Z[S])(Z,Q)}function Y8(Z,$,Q){let Y=Q0(Z.$id)?Q8(Z,$):$,W=Z;switch(W[S]){case"Any":return OH(W,Y,Q);case"Argument":return FH(W,Y,Q);case"Array":return _H(W,Y,Q);case"AsyncIterator":return PH(W,Y,Q);case"BigInt":return KH(W,Y,Q);case"Boolean":return CH(W,Y,Q);case"Constructor":return jH(W,Y,Q);case"Date":return RH(W,Y,Q);case"Function":return VH(W,Y,Q);case"Import":return EH(W,Y,Q);case"Integer":return IH(W,Y,Q);case"Intersect":return bH(W,Y,Q);case"Iterator":return xH(W,Y,Q);case"Literal":return TH(W,Y,Q);case"Never":return kH(W,Y,Q);case"Not":return gH(W,Y,Q);case"Null":return fH(W,Y,Q);case"Number":return yH(W,Y,Q);case"Object":return dH(W,Y,Q);case"Promise":return vH(W,Y,Q);case"Record":return hH(W,Y,Q);case"Ref":return mH(W,Y,Q);case"RegExp":return cH(W,Y,Q);case"String":return uH(W,Y,Q);case"Symbol":return pH(W,Y,Q);case"TemplateLiteral":return iH(W,Y,Q);case"This":return lH(W,Y,Q);case"Tuple":return nH(W,Y,Q);case"Undefined":return oH(W,Y,Q);case"Union":return tH(W,Y,Q);case"Uint8Array":return sH(W,Y,Q);case"Unknown":return rH(W,Y,Q);case"Void":return aH(W,Y,Q);default:if(!e0.Has(W[S]))throw new iX(W);return eH(W,Y,Q)}}function e(...Z){return Z.length===3?Y8(Z[0],Z[1],Z[2]):Y8(Z[0],[],Z[1])}var P;(function(Z){Z[Z.ArrayContains=0]="ArrayContains",Z[Z.ArrayMaxContains=1]="ArrayMaxContains",Z[Z.ArrayMaxItems=2]="ArrayMaxItems",Z[Z.ArrayMinContains=3]="ArrayMinContains",Z[Z.ArrayMinItems=4]="ArrayMinItems",Z[Z.ArrayUniqueItems=5]="ArrayUniqueItems",Z[Z.Array=6]="Array",Z[Z.AsyncIterator=7]="AsyncIterator",Z[Z.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",Z[Z.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",Z[Z.BigIntMaximum=10]="BigIntMaximum",Z[Z.BigIntMinimum=11]="BigIntMinimum",Z[Z.BigIntMultipleOf=12]="BigIntMultipleOf",Z[Z.BigInt=13]="BigInt",Z[Z.Boolean=14]="Boolean",Z[Z.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",Z[Z.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",Z[Z.DateMaximumTimestamp=17]="DateMaximumTimestamp",Z[Z.DateMinimumTimestamp=18]="DateMinimumTimestamp",Z[Z.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",Z[Z.Date=20]="Date",Z[Z.Function=21]="Function",Z[Z.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",Z[Z.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",Z[Z.IntegerMaximum=24]="IntegerMaximum",Z[Z.IntegerMinimum=25]="IntegerMinimum",Z[Z.IntegerMultipleOf=26]="IntegerMultipleOf",Z[Z.Integer=27]="Integer",Z[Z.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",Z[Z.Intersect=29]="Intersect",Z[Z.Iterator=30]="Iterator",Z[Z.Kind=31]="Kind",Z[Z.Literal=32]="Literal",Z[Z.Never=33]="Never",Z[Z.Not=34]="Not",Z[Z.Null=35]="Null",Z[Z.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",Z[Z.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",Z[Z.NumberMaximum=38]="NumberMaximum",Z[Z.NumberMinimum=39]="NumberMinimum",Z[Z.NumberMultipleOf=40]="NumberMultipleOf",Z[Z.Number=41]="Number",Z[Z.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",Z[Z.ObjectMaxProperties=43]="ObjectMaxProperties",Z[Z.ObjectMinProperties=44]="ObjectMinProperties",Z[Z.ObjectRequiredProperty=45]="ObjectRequiredProperty",Z[Z.Object=46]="Object",Z[Z.Promise=47]="Promise",Z[Z.RegExp=48]="RegExp",Z[Z.StringFormatUnknown=49]="StringFormatUnknown",Z[Z.StringFormat=50]="StringFormat",Z[Z.StringMaxLength=51]="StringMaxLength",Z[Z.StringMinLength=52]="StringMinLength",Z[Z.StringPattern=53]="StringPattern",Z[Z.String=54]="String",Z[Z.Symbol=55]="Symbol",Z[Z.TupleLength=56]="TupleLength",Z[Z.Tuple=57]="Tuple",Z[Z.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",Z[Z.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",Z[Z.Uint8Array=60]="Uint8Array",Z[Z.Undefined=61]="Undefined",Z[Z.Union=62]="Union",Z[Z.Void=63]="Void"})(P||(P={}));class lX extends i{constructor(Z){super("Unknown type");this.schema=Z}}function Q6(Z){return Z.replace(/~/g,"~0").replace(/\//g,"~1")}function Y0(Z){return Z!==void 0}class t6{constructor(Z){this.iterator=Z}[Symbol.iterator](){return this.iterator}First(){let Z=this.iterator.next();return Z.done?void 0:Z.value}}function f(Z,$,Q,Y,W=[]){return{type:Z,schema:$,path:Q,value:Y,message:vX()({errorType:Z,path:Q,schema:$,value:Y,errors:W}),errors:W}}function*ZD(Z,$,Q,Y){}function*$D(Z,$,Q,Y){}function*QD(Z,$,Q,Y){if(!o(Y))return yield f(P.Array,Z,Q,Y);if(Y0(Z.minItems)&&!(Y.length>=Z.minItems))yield f(P.ArrayMinItems,Z,Q,Y);if(Y0(Z.maxItems)&&!(Y.length<=Z.maxItems))yield f(P.ArrayMaxItems,Z,Q,Y);for(let J=0;J<Y.length;J++)yield*W8(Z.items,$,`${Q}/${J}`,Y[J]);if(Z.uniqueItems===!0&&!function(){let J=new Set;for(let z of Y){let U=C6(z);if(J.has(U))return!1;else J.add(U)}return!0}())yield f(P.ArrayUniqueItems,Z,Q,Y);if(!(Y0(Z.contains)||Y0(Z.minContains)||Y0(Z.maxContains)))return;let W=Y0(Z.contains)?Z.contains:r(),X=Y.reduce((J,z,U)=>W8(W,$,`${Q}${U}`,z).next().done===!0?J+1:J,0);if(X===0)yield f(P.ArrayContains,Z,Q,Y);if(u(Z.minContains)&&X<Z.minContains)yield f(P.ArrayMinContains,Z,Q,Y);if(u(Z.maxContains)&&X>Z.maxContains)yield f(P.ArrayMaxContains,Z,Q,Y)}function*YD(Z,$,Q,Y){if(!y$(Y))yield f(P.AsyncIterator,Z,Q,Y)}function*WD(Z,$,Q,Y){if(!z8(Y))return yield f(P.BigInt,Z,Q,Y);if(Y0(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))yield f(P.BigIntExclusiveMaximum,Z,Q,Y);if(Y0(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))yield f(P.BigIntExclusiveMinimum,Z,Q,Y);if(Y0(Z.maximum)&&!(Y<=Z.maximum))yield f(P.BigIntMaximum,Z,Q,Y);if(Y0(Z.minimum)&&!(Y>=Z.minimum))yield f(P.BigIntMinimum,Z,Q,Y);if(Y0(Z.multipleOf)&&Y%Z.multipleOf!==BigInt(0))yield f(P.BigIntMultipleOf,Z,Q,Y)}function*XD(Z,$,Q,Y){if(!I1(Y))yield f(P.Boolean,Z,Q,Y)}function*JD(Z,$,Q,Y){yield*W8(Z.returns,$,Q,Y.prototype)}function*zD(Z,$,Q,Y){if(!S8(Y))return yield f(P.Date,Z,Q,Y);if(Y0(Z.exclusiveMaximumTimestamp)&&!(Y.getTime()<Z.exclusiveMaximumTimestamp))yield f(P.DateExclusiveMaximumTimestamp,Z,Q,Y);if(Y0(Z.exclusiveMinimumTimestamp)&&!(Y.getTime()>Z.exclusiveMinimumTimestamp))yield f(P.DateExclusiveMinimumTimestamp,Z,Q,Y);if(Y0(Z.maximumTimestamp)&&!(Y.getTime()<=Z.maximumTimestamp))yield f(P.DateMaximumTimestamp,Z,Q,Y);if(Y0(Z.minimumTimestamp)&&!(Y.getTime()>=Z.minimumTimestamp))yield f(P.DateMinimumTimestamp,Z,Q,Y);if(Y0(Z.multipleOfTimestamp)&&Y.getTime()%Z.multipleOfTimestamp!==0)yield f(P.DateMultipleOfTimestamp,Z,Q,Y)}function*UD(Z,$,Q,Y){if(!A6(Y))yield f(P.Function,Z,Q,Y)}function*qD(Z,$,Q,Y){let W=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];yield*W8(X,[...$,...W],Q,Y)}function*GD(Z,$,Q,Y){if(!h$(Y))return yield f(P.Integer,Z,Q,Y);if(Y0(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))yield f(P.IntegerExclusiveMaximum,Z,Q,Y);if(Y0(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))yield f(P.IntegerExclusiveMinimum,Z,Q,Y);if(Y0(Z.maximum)&&!(Y<=Z.maximum))yield f(P.IntegerMaximum,Z,Q,Y);if(Y0(Z.minimum)&&!(Y>=Z.minimum))yield f(P.IntegerMinimum,Z,Q,Y);if(Y0(Z.multipleOf)&&Y%Z.multipleOf!==0)yield f(P.IntegerMultipleOf,Z,Q,Y)}function*MD(Z,$,Q,Y){let W=!1;for(let X of Z.allOf)for(let J of W8(X,$,Q,Y))W=!0,yield J;if(W)return yield f(P.Intersect,Z,Q,Y);if(Z.unevaluatedProperties===!1){let X=new RegExp(e1(Z));for(let J of Object.getOwnPropertyNames(Y))if(!X.test(J))yield f(P.IntersectUnevaluatedProperties,Z,`${Q}/${J}`,Y)}if(typeof Z.unevaluatedProperties==="object"){let X=new RegExp(e1(Z));for(let J of Object.getOwnPropertyNames(Y))if(!X.test(J)){let z=W8(Z.unevaluatedProperties,$,`${Q}/${J}`,Y[J]).next();if(!z.done)yield z.value}}}function*BD(Z,$,Q,Y){if(!d$(Y))yield f(P.Iterator,Z,Q,Y)}function*HD(Z,$,Q,Y){if(Y!==Z.const)yield f(P.Literal,Z,Q,Y)}function*DD(Z,$,Q,Y){yield f(P.Never,Z,Q,Y)}function*ND(Z,$,Q,Y){if(W8(Z.not,$,Q,Y).next().done===!0)yield f(P.Not,Z,Q,Y)}function*wD(Z,$,Q,Y){if(!l1(Y))yield f(P.Null,Z,Q,Y)}function*AD(Z,$,Q,Y){if(!V0.IsNumberLike(Y))return yield f(P.Number,Z,Q,Y);if(Y0(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))yield f(P.NumberExclusiveMaximum,Z,Q,Y);if(Y0(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))yield f(P.NumberExclusiveMinimum,Z,Q,Y);if(Y0(Z.maximum)&&!(Y<=Z.maximum))yield f(P.NumberMaximum,Z,Q,Y);if(Y0(Z.minimum)&&!(Y>=Z.minimum))yield f(P.NumberMinimum,Z,Q,Y);if(Y0(Z.multipleOf)&&Y%Z.multipleOf!==0)yield f(P.NumberMultipleOf,Z,Q,Y)}function*LD(Z,$,Q,Y){if(!V0.IsObjectLike(Y))return yield f(P.Object,Z,Q,Y);if(Y0(Z.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=Z.minProperties))yield f(P.ObjectMinProperties,Z,Q,Y);if(Y0(Z.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=Z.maxProperties))yield f(P.ObjectMaxProperties,Z,Q,Y);let W=Array.isArray(Z.required)?Z.required:[],X=Object.getOwnPropertyNames(Z.properties),J=Object.getOwnPropertyNames(Y);for(let z of W){if(J.includes(z))continue;yield f(P.ObjectRequiredProperty,Z.properties[z],`${Q}/${Q6(z)}`,void 0)}if(Z.additionalProperties===!1){for(let z of J)if(!X.includes(z))yield f(P.ObjectAdditionalProperties,Z,`${Q}/${Q6(z)}`,Y[z])}if(typeof Z.additionalProperties==="object")for(let z of J){if(X.includes(z))continue;yield*W8(Z.additionalProperties,$,`${Q}/${Q6(z)}`,Y[z])}for(let z of X){let U=Z.properties[z];if(Z.required&&Z.required.includes(z)){if(yield*W8(U,$,`${Q}/${Q6(z)}`,Y[z]),Z6(Z)&&!(z in Y))yield f(P.ObjectRequiredProperty,U,`${Q}/${Q6(z)}`,void 0)}else if(V0.IsExactOptionalProperty(Y,z))yield*W8(U,$,`${Q}/${Q6(z)}`,Y[z])}}function*SD(Z,$,Q,Y){if(!v$(Y))yield f(P.Promise,Z,Q,Y)}function*OD(Z,$,Q,Y){if(!V0.IsRecordLike(Y))return yield f(P.Object,Z,Q,Y);if(Y0(Z.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=Z.minProperties))yield f(P.ObjectMinProperties,Z,Q,Y);if(Y0(Z.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=Z.maxProperties))yield f(P.ObjectMaxProperties,Z,Q,Y);let[W,X]=Object.entries(Z.patternProperties)[0],J=new RegExp(W);for(let[z,U]of Object.entries(Y))if(J.test(z))yield*W8(X,$,`${Q}/${Q6(z)}`,U);if(typeof Z.additionalProperties==="object"){for(let[z,U]of Object.entries(Y))if(!J.test(z))yield*W8(Z.additionalProperties,$,`${Q}/${Q6(z)}`,U)}if(Z.additionalProperties===!1)for(let[z,U]of Object.entries(Y)){if(J.test(z))continue;return yield f(P.ObjectAdditionalProperties,Z,`${Q}/${Q6(z)}`,U)}}function*FD(Z,$,Q,Y){yield*W8(M0(Z,$),$,Q,Y)}function*_D(Z,$,Q,Y){if(!J0(Y))return yield f(P.String,Z,Q,Y);if(Y0(Z.minLength)&&!(Y.length>=Z.minLength))yield f(P.StringMinLength,Z,Q,Y);if(Y0(Z.maxLength)&&!(Y.length<=Z.maxLength))yield f(P.StringMaxLength,Z,Q,Y);if(!new RegExp(Z.source,Z.flags).test(Y))return yield f(P.RegExp,Z,Q,Y)}function*PD(Z,$,Q,Y){if(!J0(Y))return yield f(P.String,Z,Q,Y);if(Y0(Z.minLength)&&!(Y.length>=Z.minLength))yield f(P.StringMinLength,Z,Q,Y);if(Y0(Z.maxLength)&&!(Y.length<=Z.maxLength))yield f(P.StringMaxLength,Z,Q,Y);if(J0(Z.pattern)){if(!new RegExp(Z.pattern).test(Y))yield f(P.StringPattern,Z,Q,Y)}if(J0(Z.format)){if(!S0.Has(Z.format))yield f(P.StringFormatUnknown,Z,Q,Y);else if(!S0.Get(Z.format)(Y))yield f(P.StringFormat,Z,Q,Y)}}function*KD(Z,$,Q,Y){if(!n1(Y))yield f(P.Symbol,Z,Q,Y)}function*CD(Z,$,Q,Y){if(!J0(Y))return yield f(P.String,Z,Q,Y);if(!new RegExp(Z.pattern).test(Y))yield f(P.StringPattern,Z,Q,Y)}function*jD(Z,$,Q,Y){yield*W8(M0(Z,$),$,Q,Y)}function*RD(Z,$,Q,Y){if(!o(Y))return yield f(P.Tuple,Z,Q,Y);if(Z.items===void 0&&Y.length!==0)return yield f(P.TupleLength,Z,Q,Y);if(Y.length!==Z.maxItems)return yield f(P.TupleLength,Z,Q,Y);if(!Z.items)return;for(let W=0;W<Z.items.length;W++)yield*W8(Z.items[W],$,`${Q}/${W}`,Y[W])}function*VD(Z,$,Q,Y){if(!T0(Y))yield f(P.Undefined,Z,Q,Y)}function*ED(Z,$,Q,Y){if(e(Z,$,Y))return;let W=Z.anyOf.map((X)=>new t6(W8(X,$,Q,Y)));yield f(P.Union,Z,Q,Y,W)}function*ID(Z,$,Q,Y){if(!XZ(Y))return yield f(P.Uint8Array,Z,Q,Y);if(Y0(Z.maxByteLength)&&!(Y.length<=Z.maxByteLength))yield f(P.Uint8ArrayMaxByteLength,Z,Q,Y);if(Y0(Z.minByteLength)&&!(Y.length>=Z.minByteLength))yield f(P.Uint8ArrayMinByteLength,Z,Q,Y)}function*bD(Z,$,Q,Y){}function*xD(Z,$,Q,Y){if(!V0.IsVoidLike(Y))yield f(P.Void,Z,Q,Y)}function*TD(Z,$,Q,Y){if(!e0.Get(Z[S])(Z,Y))yield f(P.Kind,Z,Q,Y)}function*W8(Z,$,Q,Y){let W=Y0(Z.$id)?[...$,Z]:$,X=Z;switch(X[S]){case"Any":return yield*ZD(X,W,Q,Y);case"Argument":return yield*$D(X,W,Q,Y);case"Array":return yield*QD(X,W,Q,Y);case"AsyncIterator":return yield*YD(X,W,Q,Y);case"BigInt":return yield*WD(X,W,Q,Y);case"Boolean":return yield*XD(X,W,Q,Y);case"Constructor":return yield*JD(X,W,Q,Y);case"Date":return yield*zD(X,W,Q,Y);case"Function":return yield*UD(X,W,Q,Y);case"Import":return yield*qD(X,W,Q,Y);case"Integer":return yield*GD(X,W,Q,Y);case"Intersect":return yield*MD(X,W,Q,Y);case"Iterator":return yield*BD(X,W,Q,Y);case"Literal":return yield*HD(X,W,Q,Y);case"Never":return yield*DD(X,W,Q,Y);case"Not":return yield*ND(X,W,Q,Y);case"Null":return yield*wD(X,W,Q,Y);case"Number":return yield*AD(X,W,Q,Y);case"Object":return yield*LD(X,W,Q,Y);case"Promise":return yield*SD(X,W,Q,Y);case"Record":return yield*OD(X,W,Q,Y);case"Ref":return yield*FD(X,W,Q,Y);case"RegExp":return yield*_D(X,W,Q,Y);case"String":return yield*PD(X,W,Q,Y);case"Symbol":return yield*KD(X,W,Q,Y);case"TemplateLiteral":return yield*CD(X,W,Q,Y);case"This":return yield*jD(X,W,Q,Y);case"Tuple":return yield*RD(X,W,Q,Y);case"Undefined":return yield*VD(X,W,Q,Y);case"Union":return yield*ED(X,W,Q,Y);case"Uint8Array":return yield*ID(X,W,Q,Y);case"Unknown":return yield*bD(X,W,Q,Y);case"Void":return yield*xD(X,W,Q,Y);default:if(!e0.Has(X[S]))throw new lX(Z);return yield*TD(X,W,Q,Y)}}function g1(...Z){let $=Z.length===3?W8(Z[0],Z[1],"",Z[2]):W8(Z[0],[],"",Z[1]);return new t6($)}var kD=function(Z,$,Q,Y,W){if(Y==="m")throw new TypeError("Private method is not writable");if(Y==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Y==="a"?W.call(Z,Q):W?W.value=Q:$.set(Z,Q),Q},oX=function(Z,$,Q,Y){if(Q==="a"&&!Y)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!Y:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Q==="m"?Y:Q==="a"?Y.call(Z):Y?Y.value:$.get(Z)},s9,qQ,tX;class sX extends i{constructor(Z){let $=Z.First();super($===void 0?"Invalid Value":$.message);s9.add(this),qQ.set(this,void 0),kD(this,qQ,Z,"f"),this.error=$}Errors(){return new t6(oX(this,s9,"m",tX).call(this))}}qQ=new WeakMap,s9=new WeakSet,tX=function*Z(){if(this.error)yield this.error;yield*oX(this,qQ,"f")};function nX(Z,$,Q){if(e(Z,$,Q))return;throw new sX(g1(Z,$,Q))}function GQ(...Z){return Z.length===3?nX(Z[0],Z[1],Z[2]):nX(Z[0],[],Z[1])}function gD(Z){let $={};for(let Q of Object.getOwnPropertyNames(Z))$[Q]=B0(Z[Q]);for(let Q of Object.getOwnPropertySymbols(Z))$[Q]=B0(Z[Q]);return $}function fD(Z){return Z.map(($)=>B0($))}function yD(Z){return Z.slice()}function dD(Z){return new Map(B0([...Z.entries()]))}function vD(Z){return new Set(B0([...Z.entries()]))}function hD(Z){return new Date(Z.toISOString())}function mD(Z){return Z}function B0(Z){if(o(Z))return fD(Z);if(S8(Z))return hD(Z);if(s8(Z))return yD(Z);if(A2(Z))return dD(Z);if(L2(Z))return vD(Z);if(a(Z))return gD(Z);if(u8(Z))return mD(Z);throw new Error("ValueClone: Unable to clone value")}class W1 extends i{constructor(Z,$){super($);this.schema=Z}}function H0(Z){return A6(Z)?Z():B0(Z)}function cD(Z,$){if(n(Z,"default"))return H0(Z.default);else return{}}function uD(Z,$){return{}}function pD(Z,$){if(Z.uniqueItems===!0&&!n(Z,"default"))throw new W1(Z,"Array with the uniqueItems constraint requires a default value");else if("contains"in Z&&!n(Z,"default"))throw new W1(Z,"Array with the contains constraint requires a default value");else if("default"in Z)return H0(Z.default);else if(Z.minItems!==void 0)return Array.from({length:Z.minItems}).map((Q)=>{return x8(Z.items,$)});else return[]}function iD(Z,$){if(n(Z,"default"))return H0(Z.default);else return async function*(){}()}function lD(Z,$){if(n(Z,"default"))return H0(Z.default);else return BigInt(0)}function nD(Z,$){if(n(Z,"default"))return H0(Z.default);else return!1}function oD(Z,$){if(n(Z,"default"))return H0(Z.default);else{let Q=x8(Z.returns,$);if(typeof Q==="object"&&!Array.isArray(Q))return class{constructor(){for(let[Y,W]of Object.entries(Q)){let X=this;X[Y]=W}}};else return class{}}}function tD(Z,$){if(n(Z,"default"))return H0(Z.default);else if(Z.minimumTimestamp!==void 0)return new Date(Z.minimumTimestamp);else return new Date}function sD(Z,$){if(n(Z,"default"))return H0(Z.default);else return()=>x8(Z.returns,$)}function rD(Z,$){let Q=globalThis.Object.values(Z.$defs),Y=Z.$defs[Z.$ref];return x8(Y,[...$,...Q])}function aD(Z,$){if(n(Z,"default"))return H0(Z.default);else if(Z.minimum!==void 0)return Z.minimum;else return 0}function eD(Z,$){if(n(Z,"default"))return H0(Z.default);else{let Q=Z.allOf.reduce((Y,W)=>{let X=x8(W,$);return typeof X==="object"?{...Y,...X}:X},{});if(!e(Z,$,Q))throw new W1(Z,"Intersect produced invalid value. Consider using a default value.");return Q}}function ZN(Z,$){if(n(Z,"default"))return H0(Z.default);else return function*(){}()}function $N(Z,$){if(n(Z,"default"))return H0(Z.default);else return Z.const}function QN(Z,$){if(n(Z,"default"))return H0(Z.default);else throw new W1(Z,"Never types cannot be created. Consider using a default value.")}function YN(Z,$){if(n(Z,"default"))return H0(Z.default);else throw new W1(Z,"Not types must have a default value")}function WN(Z,$){if(n(Z,"default"))return H0(Z.default);else return null}function XN(Z,$){if(n(Z,"default"))return H0(Z.default);else if(Z.minimum!==void 0)return Z.minimum;else return 0}function JN(Z,$){if(n(Z,"default"))return H0(Z.default);else{let Q=new Set(Z.required),Y={};for(let[W,X]of Object.entries(Z.properties)){if(!Q.has(W))continue;Y[W]=x8(X,$)}return Y}}function zN(Z,$){if(n(Z,"default"))return H0(Z.default);else return Promise.resolve(x8(Z.item,$))}function UN(Z,$){let[Q,Y]=Object.entries(Z.patternProperties)[0];if(n(Z,"default"))return H0(Z.default);else if(!(Q===x1||Q===b1)){let W=Q.slice(1,Q.length-1).split("|"),X={};for(let J of W)X[J]=x8(Y,$);return X}else return{}}function qN(Z,$){if(n(Z,"default"))return H0(Z.default);else return x8(M0(Z,$),$)}function GN(Z,$){if(n(Z,"default"))return H0(Z.default);else throw new W1(Z,"RegExp types cannot be created. Consider using a default value.")}function MN(Z,$){if(Z.pattern!==void 0)if(!n(Z,"default"))throw new W1(Z,"String types with patterns must specify a default value");else return H0(Z.default);else if(Z.format!==void 0)if(!n(Z,"default"))throw new W1(Z,"String types with formats must specify a default value");else return H0(Z.default);else if(n(Z,"default"))return H0(Z.default);else if(Z.minLength!==void 0)return Array.from({length:Z.minLength}).map(()=>" ").join("");else return""}function BN(Z,$){if(n(Z,"default"))return H0(Z.default);else if("value"in Z)return Symbol.for(Z.value);else return Symbol()}function HN(Z,$){if(n(Z,"default"))return H0(Z.default);if(!p$(Z))throw new W1(Z,"Can only create template literals that produce a finite variants. Consider using a default value.");return DZ(Z)[0]}function DN(Z,$){if(rX++>_N)throw new W1(Z,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(n(Z,"default"))return H0(Z.default);else return x8(M0(Z,$),$)}function NN(Z,$){if(n(Z,"default"))return H0(Z.default);if(Z.items===void 0)return[];else return Array.from({length:Z.minItems}).map((Q,Y)=>x8(Z.items[Y],$))}function wN(Z,$){if(n(Z,"default"))return H0(Z.default);else return}function AN(Z,$){if(n(Z,"default"))return H0(Z.default);else if(Z.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return x8(Z.anyOf[0],$)}function LN(Z,$){if(n(Z,"default"))return H0(Z.default);else if(Z.minByteLength!==void 0)return new Uint8Array(Z.minByteLength);else return new Uint8Array(0)}function SN(Z,$){if(n(Z,"default"))return H0(Z.default);else return{}}function ON(Z,$){if(n(Z,"default"))return H0(Z.default);else return}function FN(Z,$){if(n(Z,"default"))return H0(Z.default);else throw new Error("User defined types must specify a default value")}function x8(Z,$){let Q=Q8(Z,$),Y=Z;switch(Y[S]){case"Any":return cD(Y,Q);case"Argument":return uD(Y,Q);case"Array":return pD(Y,Q);case"AsyncIterator":return iD(Y,Q);case"BigInt":return lD(Y,Q);case"Boolean":return nD(Y,Q);case"Constructor":return oD(Y,Q);case"Date":return tD(Y,Q);case"Function":return sD(Y,Q);case"Import":return rD(Y,Q);case"Integer":return aD(Y,Q);case"Intersect":return eD(Y,Q);case"Iterator":return ZN(Y,Q);case"Literal":return $N(Y,Q);case"Never":return QN(Y,Q);case"Not":return YN(Y,Q);case"Null":return WN(Y,Q);case"Number":return XN(Y,Q);case"Object":return JN(Y,Q);case"Promise":return zN(Y,Q);case"Record":return UN(Y,Q);case"Ref":return qN(Y,Q);case"RegExp":return GN(Y,Q);case"String":return MN(Y,Q);case"Symbol":return BN(Y,Q);case"TemplateLiteral":return HN(Y,Q);case"This":return DN(Y,Q);case"Tuple":return NN(Y,Q);case"Undefined":return wN(Y,Q);case"Union":return AN(Y,Q);case"Uint8Array":return LN(Y,Q);case"Unknown":return SN(Y,Q);case"Void":return ON(Y,Q);default:if(!e0.Has(Y[S]))throw new W1(Y,"Unknown type");return FN(Y,Q)}}var _N=512,rX=0;function X1(...Z){return rX=0,Z.length===2?x8(Z[0],Z[1]):x8(Z[0],[])}class r9 extends i{constructor(Z,$){super($);this.schema=Z}}function PN(Z,$,Q){if(Z[S]==="Object"&&typeof Q==="object"&&!l1(Q)){let Y=Z,W=Object.getOwnPropertyNames(Q),X=Object.entries(Y.properties),[J,z]=[1/X.length,X.length];return X.reduce((U,[q,G])=>{let D=G[S]==="Literal"&&G.const===Q[q]?z:0,A=e(G,$,Q[q])?J:0,H=W.includes(q)?J:0;return U+(D+A+H)},0)}else return e(Z,$,Q)?1:0}function KN(Z,$,Q){let Y=Z.anyOf.map((J)=>M0(J,$)),[W,X]=[Y[0],0];for(let J of Y){let z=PN(J,$,Q);if(z>X)W=J,X=z}return W}function CN(Z,$,Q){if("default"in Z)return typeof Q==="function"?Z.default:B0(Z.default);else{let Y=KN(Z,$,Q);return Y$(Y,$,Q)}}function jN(Z,$,Q){return e(Z,$,Q)?B0(Q):X1(Z,$)}function RN(Z,$,Q){return e(Z,$,Q)?Q:X1(Z,$)}function VN(Z,$,Q){if(e(Z,$,Q))return B0(Q);let Y=o(Q)?B0(Q):X1(Z,$),W=u(Z.minItems)&&Y.length<Z.minItems?[...Y,...Array.from({length:Z.minItems-Y.length},()=>null)]:Y,J=(u(Z.maxItems)&&W.length>Z.maxItems?W.slice(0,Z.maxItems):W).map((U)=>S1(Z.items,$,U));if(Z.uniqueItems!==!0)return J;let z=[...new Set(J)];if(!e(Z,$,z))throw new r9(Z,"Array cast produced invalid data due to uniqueItems constraint");return z}function EN(Z,$,Q){if(e(Z,$,Q))return X1(Z,$);let Y=new Set(Z.returns.required||[]),W=function(){};for(let[X,J]of Object.entries(Z.returns.properties)){if(!Y.has(X)&&Q.prototype[X]===void 0)continue;W.prototype[X]=S1(J,$,Q.prototype[X])}return W}function IN(Z,$,Q){let Y=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return S1(W,[...$,...Y],Q)}function bN(Z,$,Q){let Y=X1(Z,$),W=a(Y)&&a(Q)?{...Y,...Q}:Q;return e(Z,$,W)?W:X1(Z,$)}function xN(Z,$,Q){throw new r9(Z,"Never types cannot be cast")}function TN(Z,$,Q){if(e(Z,$,Q))return Q;if(Q===null||typeof Q!=="object")return X1(Z,$);let Y=new Set(Z.required||[]),W={};for(let[X,J]of Object.entries(Z.properties)){if(!Y.has(X)&&Q[X]===void 0)continue;W[X]=S1(J,$,Q[X])}if(typeof Z.additionalProperties==="object"){let X=Object.getOwnPropertyNames(Z.properties);for(let J of Object.getOwnPropertyNames(Q)){if(X.includes(J))continue;W[J]=S1(Z.additionalProperties,$,Q[J])}}return W}function kN(Z,$,Q){if(e(Z,$,Q))return B0(Q);if(Q===null||typeof Q!=="object"||Array.isArray(Q)||Q instanceof Date)return X1(Z,$);let Y=Object.getOwnPropertyNames(Z.patternProperties)[0],W=Z.patternProperties[Y],X={};for(let[J,z]of Object.entries(Q))X[J]=S1(W,$,z);return X}function gN(Z,$,Q){return S1(M0(Z,$),$,Q)}function fN(Z,$,Q){return S1(M0(Z,$),$,Q)}function yN(Z,$,Q){if(e(Z,$,Q))return B0(Q);if(!o(Q))return X1(Z,$);if(Z.items===void 0)return[];return Z.items.map((Y,W)=>S1(Y,$,Q[W]))}function dN(Z,$,Q){return e(Z,$,Q)?B0(Q):CN(Z,$,Q)}function S1(Z,$,Q){let Y=J0(Z.$id)?Q8(Z,$):$,W=Z;switch(Z[S]){case"Array":return VN(W,Y,Q);case"Constructor":return EN(W,Y,Q);case"Import":return IN(W,Y,Q);case"Intersect":return bN(W,Y,Q);case"Never":return xN(W,Y,Q);case"Object":return TN(W,Y,Q);case"Record":return kN(W,Y,Q);case"Ref":return gN(W,Y,Q);case"This":return fN(W,Y,Q);case"Tuple":return yN(W,Y,Q);case"Union":return dN(W,Y,Q);case"Date":case"Symbol":case"Uint8Array":return jN(Z,$,Q);default:return RN(W,Y,Q)}}function Y$(...Z){return Z.length===3?S1(Z[0],Z[1],Z[2]):S1(Z[0],[],Z[1])}function vN(Z){return S6(Z)&&Z[S]!=="Unsafe"}function hN(Z,$,Q){if(!o(Q))return Q;return Q.map((Y)=>T8(Z.items,$,Y))}function mN(Z,$,Q){let Y=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return T8(W,[...$,...Y],Q)}function cN(Z,$,Q){let Y=Z.unevaluatedProperties,X=Z.allOf.map((z)=>T8(z,$,B0(Q))).reduce((z,U)=>a(U)?{...z,...U}:U,{});if(!a(Q)||!a(X)||!S6(Y))return X;let J=I8(Z);for(let z of Object.getOwnPropertyNames(Q)){if(J.includes(z))continue;if(e(Y,$,Q[z]))X[z]=T8(Y,$,Q[z])}return X}function uN(Z,$,Q){if(!a(Q)||o(Q))return Q;let Y=Z.additionalProperties;for(let W of Object.getOwnPropertyNames(Q)){if(n(Z.properties,W)){Q[W]=T8(Z.properties[W],$,Q[W]);continue}if(S6(Y)&&e(Y,$,Q[W])){Q[W]=T8(Y,$,Q[W]);continue}delete Q[W]}return Q}function pN(Z,$,Q){if(!a(Q))return Q;let Y=Z.additionalProperties,W=Object.getOwnPropertyNames(Q),[X,J]=Object.entries(Z.patternProperties)[0],z=new RegExp(X);for(let U of W){if(z.test(U)){Q[U]=T8(J,$,Q[U]);continue}if(S6(Y)&&e(Y,$,Q[U])){Q[U]=T8(Y,$,Q[U]);continue}delete Q[U]}return Q}function iN(Z,$,Q){return T8(M0(Z,$),$,Q)}function lN(Z,$,Q){return T8(M0(Z,$),$,Q)}function nN(Z,$,Q){if(!o(Q))return Q;if(T0(Z.items))return[];let Y=Math.min(Q.length,Z.items.length);for(let W=0;W<Y;W++)Q[W]=T8(Z.items[W],$,Q[W]);return Q.length>Y?Q.slice(0,Y):Q}function oN(Z,$,Q){for(let Y of Z.anyOf)if(vN(Y)&&e(Y,$,Q))return T8(Y,$,Q);return Q}function T8(Z,$,Q){let Y=J0(Z.$id)?Q8(Z,$):$,W=Z;switch(W[S]){case"Array":return hN(W,Y,Q);case"Import":return mN(W,Y,Q);case"Intersect":return cN(W,Y,Q);case"Object":return uN(W,Y,Q);case"Record":return pN(W,Y,Q);case"Ref":return iN(W,Y,Q);case"This":return lN(W,Y,Q);case"Tuple":return nN(W,Y,Q);case"Union":return oN(W,Y,Q);default:return Q}}function MQ(...Z){return Z.length===3?T8(Z[0],Z[1],Z[2]):T8(Z[0],[],Z[1])}function BQ(Z){return J0(Z)&&!isNaN(Z)&&!isNaN(parseFloat(Z))}function tN(Z){return z8(Z)||I1(Z)||u(Z)}function W$(Z){return Z===!0||u(Z)&&Z===1||z8(Z)&&Z===BigInt("1")||J0(Z)&&(Z.toLowerCase()==="true"||Z==="1")}function X$(Z){return Z===!1||u(Z)&&(Z===0||Object.is(Z,-0))||z8(Z)&&Z===BigInt("0")||J0(Z)&&(Z.toLowerCase()==="false"||Z==="0"||Z==="-0")}function sN(Z){return J0(Z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Z)}function rN(Z){return J0(Z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Z)}function aN(Z){return J0(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Z)}function eN(Z){return J0(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Z)}function Zw(Z){return J0(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(Z)}function $w(Z,$){let Q=eX(Z);return Q===$?Q:Z}function Qw(Z,$){let Q=Z4(Z);return Q===$?Q:Z}function Yw(Z,$){let Q=aX(Z);return Q===$?Q:Z}function Ww(Z,$){return J0(Z.const)?$w($,Z.const):u(Z.const)?Qw($,Z.const):I1(Z.const)?Yw($,Z.const):$}function aX(Z){return W$(Z)?!0:X$(Z)?!1:Z}function Xw(Z){let $=(Q)=>Q.split(".")[0];return BQ(Z)?BigInt($(Z)):u(Z)?BigInt(Math.trunc(Z)):X$(Z)?BigInt(0):W$(Z)?BigInt(1):Z}function eX(Z){return n1(Z)&&Z.description!==void 0?Z.description.toString():tN(Z)?Z.toString():Z}function Z4(Z){return BQ(Z)?parseFloat(Z):W$(Z)?1:X$(Z)?0:Z}function Jw(Z){return BQ(Z)?parseInt(Z):u(Z)?Math.trunc(Z):W$(Z)?1:X$(Z)?0:Z}function zw(Z){return J0(Z)&&Z.toLowerCase()==="null"?null:Z}function Uw(Z){return J0(Z)&&Z==="undefined"?void 0:Z}function qw(Z){return S8(Z)?Z:u(Z)?new Date(Z):W$(Z)?new Date(1):X$(Z)?new Date(0):BQ(Z)?new Date(parseInt(Z)):rN(Z)?new Date(`1970-01-01T${Z}.000Z`):sN(Z)?new Date(`1970-01-01T${Z}`):eN(Z)?new Date(`${Z}.000Z`):aN(Z)?new Date(Z):Zw(Z)?new Date(`${Z}T00:00:00.000Z`):Z}function Gw(Z){return Z}function Mw(Z,$,Q){return(o(Q)?Q:[Q]).map((W)=>O1(Z.items,$,W))}function Bw(Z,$,Q){return Xw(Q)}function Hw(Z,$,Q){return aX(Q)}function Dw(Z,$,Q){return qw(Q)}function Nw(Z,$,Q){let Y=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return O1(W,[...$,...Y],Q)}function ww(Z,$,Q){return Jw(Q)}function Aw(Z,$,Q){return Z.allOf.reduce((Y,W)=>O1(W,$,Y),Q)}function Lw(Z,$,Q){return Ww(Z,Q)}function Sw(Z,$,Q){return zw(Q)}function Ow(Z,$,Q){return Z4(Q)}function Fw(Z,$,Q){if(!a(Q))return Q;for(let Y of Object.getOwnPropertyNames(Z.properties)){if(!n(Q,Y))continue;Q[Y]=O1(Z.properties[Y],$,Q[Y])}return Q}function _w(Z,$,Q){if(!a(Q))return Q;let W=Object.getOwnPropertyNames(Z.patternProperties)[0],X=Z.patternProperties[W];for(let[J,z]of Object.entries(Q))Q[J]=O1(X,$,z);return Q}function Pw(Z,$,Q){return O1(M0(Z,$),$,Q)}function Kw(Z,$,Q){return eX(Q)}function Cw(Z,$,Q){return J0(Q)||u(Q)?Symbol(Q):Q}function jw(Z,$,Q){return O1(M0(Z,$),$,Q)}function Rw(Z,$,Q){if(!(o(Q)&&!T0(Z.items)))return Q;return Q.map((W,X)=>{return X<Z.items.length?O1(Z.items[X],$,W):W})}function Vw(Z,$,Q){return Uw(Q)}function Ew(Z,$,Q){for(let Y of Z.anyOf){let W=O1(Y,$,B0(Q));if(!e(Y,$,W))continue;return W}return Q}function O1(Z,$,Q){let Y=Q8(Z,$),W=Z;switch(Z[S]){case"Array":return Mw(W,Y,Q);case"BigInt":return Bw(W,Y,Q);case"Boolean":return Hw(W,Y,Q);case"Date":return Dw(W,Y,Q);case"Import":return Nw(W,Y,Q);case"Integer":return ww(W,Y,Q);case"Intersect":return Aw(W,Y,Q);case"Literal":return Lw(W,Y,Q);case"Null":return Sw(W,Y,Q);case"Number":return Ow(W,Y,Q);case"Object":return Fw(W,Y,Q);case"Record":return _w(W,Y,Q);case"Ref":return Pw(W,Y,Q);case"String":return Kw(W,Y,Q);case"Symbol":return Cw(W,Y,Q);case"This":return jw(W,Y,Q);case"Tuple":return Rw(W,Y,Q);case"Undefined":return Vw(W,Y,Q);case"Union":return Ew(W,Y,Q);default:return Gw(Q)}}function HQ(...Z){return Z.length===3?O1(Z[0],Z[1],Z[2]):O1(Z[0],[],Z[1])}class J$ extends i{constructor(Z,$,Q){super("Unable to decode value as it does not match the expected schema");this.schema=Z,this.value=$,this.error=Q}}class DQ extends i{constructor(Z,$,Q,Y){super(Y instanceof Error?Y.message:"Unknown error");this.schema=Z,this.path=$,this.value=Q,this.error=Y}}function v0(Z,$,Q){try{return D0(Z)?Z[P0].Decode(Q):Q}catch(Y){throw new DQ(Z,$,Q,Y)}}function Iw(Z,$,Q,Y){return o(Y)?v0(Z,Q,Y.map((W,X)=>F1(Z.items,$,`${Q}/${X}`,W))):v0(Z,Q,Y)}function bw(Z,$,Q,Y){if(!a(Y)||u8(Y))return v0(Z,Q,Y);let W=t$(Z),X=W.map((G)=>G[0]),J={...Y};for(let[G,D]of W)if(G in J)J[G]=F1(D,$,`${Q}/${G}`,J[G]);if(!D0(Z.unevaluatedProperties))return v0(Z,Q,J);let z=Object.getOwnPropertyNames(J),U=Z.unevaluatedProperties,q={...J};for(let G of z)if(!X.includes(G))q[G]=v0(U,`${Q}/${G}`,q[G]);return v0(Z,Q,q)}function xw(Z,$,Q,Y){let W=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref],J=F1(X,[...$,...W],Q,Y);return v0(Z,Q,J)}function Tw(Z,$,Q,Y){return v0(Z,Q,F1(Z.not,$,Q,Y))}function kw(Z,$,Q,Y){if(!a(Y))return v0(Z,Q,Y);let W=I8(Z),X={...Y};for(let q of W){if(!n(X,q))continue;if(T0(X[q])&&(!s1(Z.properties[q])||V0.IsExactOptionalProperty(X,q)))continue;X[q]=F1(Z.properties[q],$,`${Q}/${q}`,X[q])}if(!d0(Z.additionalProperties))return v0(Z,Q,X);let J=Object.getOwnPropertyNames(X),z=Z.additionalProperties,U={...X};for(let q of J)if(!W.includes(q))U[q]=v0(z,`${Q}/${q}`,U[q]);return v0(Z,Q,U)}function gw(Z,$,Q,Y){if(!a(Y))return v0(Z,Q,Y);let W=Object.getOwnPropertyNames(Z.patternProperties)[0],X=new RegExp(W),J={...Y};for(let G of Object.getOwnPropertyNames(Y))if(X.test(G))J[G]=F1(Z.patternProperties[W],$,`${Q}/${G}`,J[G]);if(!d0(Z.additionalProperties))return v0(Z,Q,J);let z=Object.getOwnPropertyNames(J),U=Z.additionalProperties,q={...J};for(let G of z)if(!X.test(G))q[G]=v0(U,`${Q}/${G}`,q[G]);return v0(Z,Q,q)}function fw(Z,$,Q,Y){let W=M0(Z,$);return v0(Z,Q,F1(W,$,Q,Y))}function yw(Z,$,Q,Y){let W=M0(Z,$);return v0(Z,Q,F1(W,$,Q,Y))}function dw(Z,$,Q,Y){return o(Y)&&o(Z.items)?v0(Z,Q,Z.items.map((W,X)=>F1(W,$,`${Q}/${X}`,Y[X]))):v0(Z,Q,Y)}function vw(Z,$,Q,Y){for(let W of Z.anyOf){if(!e(W,$,Y))continue;let X=F1(W,$,Q,Y);return v0(Z,Q,X)}return v0(Z,Q,Y)}function F1(Z,$,Q,Y){let W=Q8(Z,$),X=Z;switch(Z[S]){case"Array":return Iw(X,W,Q,Y);case"Import":return xw(X,W,Q,Y);case"Intersect":return bw(X,W,Q,Y);case"Not":return Tw(X,W,Q,Y);case"Object":return kw(X,W,Q,Y);case"Record":return gw(X,W,Q,Y);case"Ref":return fw(X,W,Q,Y);case"Symbol":return v0(X,Q,Y);case"This":return yw(X,W,Q,Y);case"Tuple":return dw(X,W,Q,Y);case"Union":return vw(X,W,Q,Y);default:return v0(X,Q,Y)}}function RZ(Z,$,Q){return F1(Z,$,"",Q)}class z$ extends i{constructor(Z,$,Q){super("The encoded value does not match the expected schema");this.schema=Z,this.value=$,this.error=Q}}class $4 extends i{constructor(Z,$,Q,Y){super(`${Y instanceof Error?Y.message:"Unknown error"}`);this.schema=Z,this.path=$,this.value=Q,this.error=Y}}function U8(Z,$,Q){try{return D0(Z)?Z[P0].Encode(Q):Q}catch(Y){throw new $4(Z,$,Q,Y)}}function hw(Z,$,Q,Y){let W=U8(Z,Q,Y);return o(W)?W.map((X,J)=>_1(Z.items,$,`${Q}/${J}`,X)):W}function mw(Z,$,Q,Y){let W=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref],J=U8(Z,Q,Y);return _1(X,[...$,...W],Q,J)}function cw(Z,$,Q,Y){let W=U8(Z,Q,Y);if(!a(Y)||u8(Y))return W;let X=t$(Z),J=X.map((D)=>D[0]),z={...W};for(let[D,A]of X)if(D in z)z[D]=_1(A,$,`${Q}/${D}`,z[D]);if(!D0(Z.unevaluatedProperties))return z;let U=Object.getOwnPropertyNames(z),q=Z.unevaluatedProperties,G={...z};for(let D of U)if(!J.includes(D))G[D]=U8(q,`${Q}/${D}`,G[D]);return G}function uw(Z,$,Q,Y){return U8(Z.not,Q,U8(Z,Q,Y))}function pw(Z,$,Q,Y){let W=U8(Z,Q,Y);if(!a(W))return W;let X=I8(Z),J={...W};for(let G of X){if(!n(J,G))continue;if(T0(J[G])&&(!s1(Z.properties[G])||V0.IsExactOptionalProperty(J,G)))continue;J[G]=_1(Z.properties[G],$,`${Q}/${G}`,J[G])}if(!d0(Z.additionalProperties))return J;let z=Object.getOwnPropertyNames(J),U=Z.additionalProperties,q={...J};for(let G of z)if(!X.includes(G))q[G]=U8(U,`${Q}/${G}`,q[G]);return q}function iw(Z,$,Q,Y){let W=U8(Z,Q,Y);if(!a(Y))return W;let X=Object.getOwnPropertyNames(Z.patternProperties)[0],J=new RegExp(X),z={...W};for(let D of Object.getOwnPropertyNames(Y))if(J.test(D))z[D]=_1(Z.patternProperties[X],$,`${Q}/${D}`,z[D]);if(!d0(Z.additionalProperties))return z;let U=Object.getOwnPropertyNames(z),q=Z.additionalProperties,G={...z};for(let D of U)if(!J.test(D))G[D]=U8(q,`${Q}/${D}`,G[D]);return G}function lw(Z,$,Q,Y){let W=M0(Z,$),X=_1(W,$,Q,Y);return U8(Z,Q,X)}function nw(Z,$,Q,Y){let W=M0(Z,$),X=_1(W,$,Q,Y);return U8(Z,Q,X)}function ow(Z,$,Q,Y){let W=U8(Z,Q,Y);return o(Z.items)?Z.items.map((X,J)=>_1(X,$,`${Q}/${J}`,W[J])):[]}function tw(Z,$,Q,Y){for(let W of Z.anyOf){if(!e(W,$,Y))continue;let X=_1(W,$,Q,Y);return U8(Z,Q,X)}for(let W of Z.anyOf){let X=_1(W,$,Q,Y);if(!e(Z,$,X))continue;return U8(Z,Q,X)}return U8(Z,Q,Y)}function _1(Z,$,Q,Y){let W=Q8(Z,$),X=Z;switch(Z[S]){case"Array":return hw(X,W,Q,Y);case"Import":return mw(X,W,Q,Y);case"Intersect":return cw(X,W,Q,Y);case"Not":return uw(X,W,Q,Y);case"Object":return pw(X,W,Q,Y);case"Record":return iw(X,W,Q,Y);case"Ref":return lw(X,W,Q,Y);case"This":return nw(X,W,Q,Y);case"Tuple":return ow(X,W,Q,Y);case"Union":return tw(X,W,Q,Y);default:return U8(X,Q,Y)}}function VZ(Z,$,Q){return _1(Z,$,"",Q)}function sw(Z,$){return D0(Z)||Z8(Z.items,$)}function rw(Z,$){return D0(Z)||Z8(Z.items,$)}function aw(Z,$){return D0(Z)||Z8(Z.returns,$)||Z.parameters.some((Q)=>Z8(Q,$))}function ew(Z,$){return D0(Z)||Z8(Z.returns,$)||Z.parameters.some((Q)=>Z8(Q,$))}function ZA(Z,$){return D0(Z)||D0(Z.unevaluatedProperties)||Z.allOf.some((Q)=>Z8(Q,$))}function $A(Z,$){let Q=globalThis.Object.getOwnPropertyNames(Z.$defs).reduce((W,X)=>[...W,Z.$defs[X]],[]),Y=Z.$defs[Z.$ref];return D0(Z)||Z8(Y,[...Q,...$])}function QA(Z,$){return D0(Z)||Z8(Z.items,$)}function YA(Z,$){return D0(Z)||Z8(Z.not,$)}function WA(Z,$){return D0(Z)||Object.values(Z.properties).some((Q)=>Z8(Q,$))||d0(Z.additionalProperties)&&Z8(Z.additionalProperties,$)}function XA(Z,$){return D0(Z)||Z8(Z.item,$)}function JA(Z,$){let Q=Object.getOwnPropertyNames(Z.patternProperties)[0],Y=Z.patternProperties[Q];return D0(Z)||Z8(Y,$)||d0(Z.additionalProperties)&&D0(Z.additionalProperties)}function zA(Z,$){if(D0(Z))return!0;return Z8(M0(Z,$),$)}function UA(Z,$){if(D0(Z))return!0;return Z8(M0(Z,$),$)}function qA(Z,$){return D0(Z)||!T0(Z.items)&&Z.items.some((Q)=>Z8(Q,$))}function GA(Z,$){return D0(Z)||Z.anyOf.some((Q)=>Z8(Q,$))}function Z8(Z,$){let Q=Q8(Z,$),Y=Z;if(Z.$id&&a9.has(Z.$id))return!1;if(Z.$id)a9.add(Z.$id);switch(Z[S]){case"Array":return sw(Y,Q);case"AsyncIterator":return rw(Y,Q);case"Constructor":return aw(Y,Q);case"Function":return ew(Y,Q);case"Import":return $A(Y,Q);case"Intersect":return ZA(Y,Q);case"Iterator":return QA(Y,Q);case"Not":return YA(Y,Q);case"Object":return WA(Y,Q);case"Promise":return XA(Y,Q);case"Record":return JA(Y,Q);case"Ref":return zA(Y,Q);case"This":return UA(Y,Q);case"Tuple":return qA(Y,Q);case"Union":return GA(Y,Q);default:return D0(Z)}}var a9=new Set;function Y6(Z,$){return a9.clear(),Z8(Z,$)}function Q4(...Z){let[$,Q,Y]=Z.length===3?[Z[0],Z[1],Z[2]]:[Z[0],[],Z[1]];if(!e($,Q,Y))throw new J$($,Y,g1($,Q,Y).First());return Y6($,Q)?RZ($,Q,Y):Y}function W6(Z,$){let Q=n(Z,"default")?Z.default:void 0,Y=A6(Q)?Q():B0(Q);return T0($)?Y:a($)&&a(Y)?Object.assign(Y,$):$}function e9(Z){return S6(Z)&&"default"in Z}function MA(Z,$,Q){if(o(Q)){for(let W=0;W<Q.length;W++)Q[W]=F8(Z.items,$,Q[W]);return Q}let Y=W6(Z,Q);if(!o(Y))return Y;for(let W=0;W<Y.length;W++)Y[W]=F8(Z.items,$,Y[W]);return Y}function BA(Z,$,Q){return S8(Q)?Q:W6(Z,Q)}function HA(Z,$,Q){let Y=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return F8(W,[...$,...Y],Q)}function DA(Z,$,Q){let Y=W6(Z,Q);return Z.allOf.reduce((W,X)=>{let J=F8(X,$,Y);return a(J)?{...W,...J}:J},{})}function NA(Z,$,Q){let Y=W6(Z,Q);if(!a(Y))return Y;let W=Object.getOwnPropertyNames(Z.properties);for(let X of W){let J=F8(Z.properties[X],$,Y[X]);if(T0(J))continue;Y[X]=F8(Z.properties[X],$,Y[X])}if(!e9(Z.additionalProperties))return Y;for(let X of Object.getOwnPropertyNames(Y)){if(W.includes(X))continue;Y[X]=F8(Z.additionalProperties,$,Y[X])}return Y}function wA(Z,$,Q){let Y=W6(Z,Q);if(!a(Y))return Y;let W=Z.additionalProperties,[X,J]=Object.entries(Z.patternProperties)[0],z=new RegExp(X);for(let U of Object.getOwnPropertyNames(Y)){if(!(z.test(U)&&e9(J)))continue;Y[U]=F8(J,$,Y[U])}if(!e9(W))return Y;for(let U of Object.getOwnPropertyNames(Y)){if(z.test(U))continue;Y[U]=F8(W,$,Y[U])}return Y}function AA(Z,$,Q){return F8(M0(Z,$),$,W6(Z,Q))}function LA(Z,$,Q){return F8(M0(Z,$),$,Q)}function SA(Z,$,Q){let Y=W6(Z,Q);if(!o(Y)||T0(Z.items))return Y;let[W,X]=[Z.items,Math.max(Z.items.length,Y.length)];for(let J=0;J<X;J++)if(J<W.length)Y[J]=F8(W[J],$,Y[J]);return Y}function OA(Z,$,Q){let Y=W6(Z,Q);for(let W of Z.anyOf){let X=F8(W,$,B0(Y));if(e(W,$,X))return X}return Y}function F8(Z,$,Q){let Y=Q8(Z,$),W=Z;switch(W[S]){case"Array":return MA(W,Y,Q);case"Date":return BA(W,Y,Q);case"Import":return HA(W,Y,Q);case"Intersect":return DA(W,Y,Q);case"Object":return NA(W,Y,Q);case"Record":return wA(W,Y,Q);case"Ref":return AA(W,Y,Q);case"This":return LA(W,Y,Q);case"Tuple":return SA(W,Y,Q);case"Union":return OA(W,Y,Q);default:return W6(W,Q)}}function NQ(...Z){return Z.length===3?F8(Z[0],Z[1],Z[2]):F8(Z[0],[],Z[1])}var P1={};v6(P1,{ValuePointerRootSetError:()=>ZY,ValuePointerRootDeleteError:()=>$Y,Set:()=>FA,Has:()=>PA,Get:()=>KA,Format:()=>U$,Delete:()=>_A});class ZY extends i{constructor(Z,$,Q){super("Cannot set root value");this.value=Z,this.path=$,this.update=Q}}class $Y extends i{constructor(Z,$){super("Cannot delete root value");this.value=Z,this.path=$}}function Y4(Z){return Z.indexOf("~")===-1?Z:Z.replace(/~1/g,"/").replace(/~0/g,"~")}function*U$(Z){if(Z==="")return;let[$,Q]=[0,0];for(let Y=0;Y<Z.length;Y++)if(Z.charAt(Y)==="/")if(Y===0)$=Y+1;else Q=Y,yield Y4(Z.slice($,Q)),$=Y+1;else Q=Y;yield Y4(Z.slice($))}function FA(Z,$,Q){if($==="")throw new ZY(Z,$,Q);let[Y,W,X]=[null,Z,""];for(let J of U$($)){if(W[J]===void 0)W[J]={};Y=W,W=W[J],X=J}Y[X]=Q}function _A(Z,$){if($==="")throw new $Y(Z,$);let[Q,Y,W]=[null,Z,""];for(let X of U$($)){if(Y[X]===void 0||Y[X]===null)return;Q=Y,Y=Y[X],W=X}if(Array.isArray(Q)){let X=parseInt(W);Q.splice(X,1)}else delete Q[W]}function PA(Z,$){if($==="")return!0;let[Q,Y,W]=[null,Z,""];for(let X of U$($)){if(Y[X]===void 0)return!1;Q=Y,Y=Y[X],W=X}return Object.getOwnPropertyNames(Q).includes(W)}function KA(Z,$){if($==="")return Z;let Q=Z;for(let Y of U$($)){if(Q[Y]===void 0)return;Q=Q[Y]}return Q}function CA(Z,$){if(!a($))return!1;let Q=[...Object.keys(Z),...Object.getOwnPropertySymbols(Z)],Y=[...Object.keys($),...Object.getOwnPropertySymbols($)];if(Q.length!==Y.length)return!1;return Q.every((W)=>s6(Z[W],$[W]))}function jA(Z,$){return S8($)&&Z.getTime()===$.getTime()}function RA(Z,$){if(!o($)||Z.length!==$.length)return!1;return Z.every((Q,Y)=>s6(Q,$[Y]))}function VA(Z,$){if(!s8($)||Z.length!==$.length||Object.getPrototypeOf(Z).constructor.name!==Object.getPrototypeOf($).constructor.name)return!1;return Z.every((Q,Y)=>s6(Q,$[Y]))}function EA(Z,$){return Z===$}function s6(Z,$){if(S8(Z))return jA(Z,$);if(s8(Z))return VA(Z,$);if(o(Z))return RA(Z,$);if(a(Z))return CA(Z,$);if(u8(Z))return EA(Z,$);throw new Error("ValueEquals: Unable to compare value")}var IA=w0({type:X0("insert"),path:O8(),value:w1()}),bA=w0({type:X0("update"),path:O8(),value:w1()}),xA=w0({type:X0("delete"),path:O8()}),X4=N0([IA,bA,xA]);class QY extends i{constructor(Z,$){super($);this.value=Z}}function wQ(Z,$){return{type:"update",path:Z,value:$}}function J4(Z,$){return{type:"insert",path:Z,value:$}}function z4(Z){return{type:"delete",path:Z}}function W4(Z){if(globalThis.Object.getOwnPropertySymbols(Z).length>0)throw new QY(Z,"Cannot diff objects with symbols")}function*TA(Z,$,Q){if(W4($),W4(Q),!R9(Q))return yield wQ(Z,Q);let Y=globalThis.Object.getOwnPropertyNames($),W=globalThis.Object.getOwnPropertyNames(Q);for(let X of W){if(n($,X))continue;yield J4(`${Z}/${X}`,Q[X])}for(let X of Y){if(!n(Q,X))continue;if(s6($,Q))continue;yield*AQ(`${Z}/${X}`,$[X],Q[X])}for(let X of Y){if(n(Q,X))continue;yield z4(`${Z}/${X}`)}}function*kA(Z,$,Q){if(!o(Q))return yield wQ(Z,Q);for(let Y=0;Y<Math.min($.length,Q.length);Y++)yield*AQ(`${Z}/${Y}`,$[Y],Q[Y]);for(let Y=0;Y<Q.length;Y++){if(Y<$.length)continue;yield J4(`${Z}/${Y}`,Q[Y])}for(let Y=$.length-1;Y>=0;Y--){if(Y<Q.length)continue;yield z4(`${Z}/${Y}`)}}function*gA(Z,$,Q){if(!s8(Q)||$.length!==Q.length||globalThis.Object.getPrototypeOf($).constructor.name!==globalThis.Object.getPrototypeOf(Q).constructor.name)return yield wQ(Z,Q);for(let Y=0;Y<Math.min($.length,Q.length);Y++)yield*AQ(`${Z}/${Y}`,$[Y],Q[Y])}function*fA(Z,$,Q){if($===Q)return;yield wQ(Z,Q)}function*AQ(Z,$,Q){if(R9($))return yield*TA(Z,$,Q);if(o($))return yield*kA(Z,$,Q);if(s8($))return yield*gA(Z,$,Q);if(u8($))return yield*fA(Z,$,Q);throw new QY($,"Unable to diff value")}function U4(Z,$){return[...AQ("",Z,$)]}function yA(Z){return Z.length>0&&Z[0].path===""&&Z[0].type==="update"}function dA(Z){return Z.length===0}function q4(Z,$){if(yA($))return B0($[0].value);if(dA($))return B0(Z);let Q=B0(Z);for(let Y of $)switch(Y.type){case"insert":{P1.Set(Q,Y.path,Y.value);break}case"update":{P1.Set(Q,Y.path,Y.value);break}case"delete":{P1.Delete(Q,Y.path);break}}return Q}function G4(...Z){let[$,Q,Y]=Z.length===3?[Z[0],Z[1],Z[2]]:[Z[0],[],Z[1]],W=Y6($,Q)?VZ($,Q,Y):Y;if(!e($,Q,W))throw new z$($,W,g1($,Q,W).First());return W}function LQ(Z){return a(Z)&&!o(Z)}class YY extends i{constructor(Z){super(Z)}}function vA(Z,$,Q,Y){if(!LQ(Q))P1.Set(Z,$,B0(Y));else{let W=Object.getOwnPropertyNames(Q),X=Object.getOwnPropertyNames(Y);for(let J of W)if(!X.includes(J))delete Q[J];for(let J of X)if(!W.includes(J))Q[J]=null;for(let J of X)WY(Z,`${$}/${J}`,Q[J],Y[J])}}function hA(Z,$,Q,Y){if(!o(Q))P1.Set(Z,$,B0(Y));else{for(let W=0;W<Y.length;W++)WY(Z,`${$}/${W}`,Q[W],Y[W]);Q.splice(Y.length)}}function mA(Z,$,Q,Y){if(s8(Q)&&Q.length===Y.length)for(let W=0;W<Q.length;W++)Q[W]=Y[W];else P1.Set(Z,$,B0(Y))}function cA(Z,$,Q,Y){if(Q===Y)return;P1.Set(Z,$,Y)}function WY(Z,$,Q,Y){if(o(Y))return hA(Z,$,Q,Y);if(s8(Y))return mA(Z,$,Q,Y);if(LQ(Y))return vA(Z,$,Q,Y);if(u8(Y))return cA(Z,$,Q,Y)}function M4(Z){return s8(Z)||u8(Z)}function uA(Z,$){return LQ(Z)&&o($)||o(Z)&&LQ($)}function B4(Z,$){if(M4(Z)||M4($))throw new YY("Only object and array types can be mutated at the root level");if(uA(Z,$))throw new YY("Cannot assign due type mismatch of assignable values");WY(Z,"",Z,$)}class JY extends i{constructor(Z){super(Z)}}var XY;(function(Z){let $=new Map([["Assert",(X,J,z)=>{return GQ(X,J,z),z}],["Cast",(X,J,z)=>Y$(X,J,z)],["Clean",(X,J,z)=>MQ(X,J,z)],["Clone",(X,J,z)=>B0(z)],["Convert",(X,J,z)=>HQ(X,J,z)],["Decode",(X,J,z)=>Y6(X,J)?RZ(X,J,z):z],["Default",(X,J,z)=>NQ(X,J,z)],["Encode",(X,J,z)=>Y6(X,J)?VZ(X,J,z):z]]);function Q(X){$.delete(X)}Z.Delete=Q;function Y(X,J){$.set(X,J)}Z.Set=Y;function W(X){return $.get(X)}Z.Get=W})(XY||(XY={}));var H4=["Clone","Clean","Default","Convert","Assert","Decode"];function pA(Z,$,Q,Y){return Z.reduce((W,X)=>{let J=XY.Get(X);if(T0(J))throw new JY(`Unable to find Parse operation '${X}'`);return J($,Q,W)},Y)}function D4(...Z){let[$,Q,Y,W]=Z.length===4?[Z[0],Z[1],Z[2],Z[3]]:Z.length===3?o(Z[0])?[Z[0],Z[1],[],Z[2]]:[H4,Z[0],Z[1],Z[2]]:Z.length===2?[H4,Z[0],[],Z[1]]:(()=>{throw new JY("Invalid Arguments")})();return pA($,Q,Y,W)}var A0={};v6(A0,{ValueErrorIterator:()=>t6,Patch:()=>q4,Parse:()=>D4,Mutate:()=>B4,Hash:()=>C6,Errors:()=>g1,Equal:()=>s6,Encode:()=>G4,Edit:()=>X4,Diff:()=>U4,Default:()=>NQ,Decode:()=>Q4,Create:()=>X1,Convert:()=>HQ,Clone:()=>B0,Clean:()=>MQ,Check:()=>e,Cast:()=>Y$,Assert:()=>GQ});class N4{constructor(Z,$,Q,Y){this.schema=Z,this.references=$,this.checkFunc=Q,this.code=Y,this.hasTransform=Y6(Z,$)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(Z){return g1(this.schema,this.references,Z)}Check(Z){return this.checkFunc(Z)}Decode(Z){if(!this.checkFunc(Z))throw new J$(this.schema,Z,this.Errors(Z).First());return this.hasTransform?RZ(this.schema,this.references,Z):Z}Encode(Z){let $=this.hasTransform?VZ(this.schema,this.references,Z):Z;if(!this.checkFunc($))throw new z$(this.schema,Z,this.Errors(Z).First());return $}}var X6;(function(Z){function $(X){return X===36}Z.DollarSign=$;function Q(X){return X===95}Z.IsUnderscore=Q;function Y(X){return X>=65&&X<=90||X>=97&&X<=122}Z.IsAlpha=Y;function W(X){return X>=48&&X<=57}Z.IsNumeric=W})(X6||(X6={}));var SQ;(function(Z){function $(X){if(X.length===0)return!1;return X6.IsNumeric(X.charCodeAt(0))}function Q(X){if($(X))return!1;for(let J=0;J<X.length;J++){let z=X.charCodeAt(J);if(!(X6.IsAlpha(z)||X6.IsNumeric(z)||X6.DollarSign(z)||X6.IsUnderscore(z)))return!1}return!0}function Y(X){return X.replace(/'/g,"\\'")}function W(X,J){return Q(J)?`${X}.${J}`:`${X}['${Y(J)}']`}Z.Encode=W})(SQ||(SQ={}));var zY;(function(Z){function $(Q){let Y=[];for(let W=0;W<Q.length;W++){let X=Q.charCodeAt(W);if(X6.IsNumeric(X)||X6.IsAlpha(X))Y.push(Q.charAt(W));else Y.push(`_${X}_`)}return Y.join("").replace(/__/g,"_")}Z.Encode=$})(zY||(zY={}));var UY;(function(Z){function $(Q){return Q.replace(/'/g,"\\'")}Z.Escape=$})(UY||(UY={}));class w4 extends i{constructor(Z){super("Unknown type");this.schema=Z}}class qY extends i{constructor(Z){super("Preflight validation check failed to guard for the given schema");this.schema=Z}}var r6;(function(Z){function $(J,z,U){return V0.ExactOptionalPropertyTypes?`('${z}' in ${J} ? ${U} : true)`:`(${SQ.Encode(J,z)} !== undefined ? ${U} : true)`}Z.IsExactOptionalProperty=$;function Q(J){return!V0.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}))`:`(typeof ${J} === 'object' && ${J} !== null)`}Z.IsObjectLike=Q;function Y(J){return!V0.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}) && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`:`(typeof ${J} === 'object' && ${J} !== null && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`}Z.IsRecordLike=Y;function W(J){return V0.AllowNaN?`typeof ${J} === 'number'`:`Number.isFinite(${J})`}Z.IsNumberLike=W;function X(J){return V0.AllowNullVoid?`(${J} === undefined || ${J} === null)`:`${J} === undefined`}Z.IsVoidLike=X})(r6||(r6={}));var f1;(function(Z){function $(B){return B[S]==="Any"||B[S]==="Unknown"}function*Q(B,F,N){yield"true"}function*Y(B,F,N){yield"true"}function*W(B,F,N){yield`Array.isArray(${N})`;let[E,V]=[N6("value","any"),N6("acc","number")];if(u(B.maxItems))yield`${N}.length <= ${B.maxItems}`;if(u(B.minItems))yield`${N}.length >= ${B.minItems}`;let I=M8(B.items,F,"value");if(yield`${N}.every((${E}) => ${I})`,g0(B.contains)||u(B.minContains)||u(B.maxContains)){let c=g0(B.contains)?B.contains:r(),C0=M8(c,F,"value"),B8=u(B.minContains)?[`(count >= ${B.minContains})`]:[],J8=u(B.maxContains)?[`(count <= ${B.maxContains})`]:[],m8=`const count = value.reduce((${V}, ${E}) => ${C0} ? acc + 1 : acc, 0)`,u1=["(count > 0)",...B8,...J8].join(" && ");yield`((${E}) => { ${m8}; return ${u1}})(${N})`}if(B.uniqueItems===!0)yield`((${E}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${N})`}function*X(B,F,N){yield`(typeof value === 'object' && Symbol.asyncIterator in ${N})`}function*J(B,F,N){if(yield`(typeof ${N} === 'bigint')`,z8(B.exclusiveMaximum))yield`${N} < BigInt(${B.exclusiveMaximum})`;if(z8(B.exclusiveMinimum))yield`${N} > BigInt(${B.exclusiveMinimum})`;if(z8(B.maximum))yield`${N} <= BigInt(${B.maximum})`;if(z8(B.minimum))yield`${N} >= BigInt(${B.minimum})`;if(z8(B.multipleOf))yield`(${N} % BigInt(${B.multipleOf})) === 0`}function*z(B,F,N){yield`(typeof ${N} === 'boolean')`}function*U(B,F,N){yield*H6(B.returns,F,`${N}.prototype`)}function*q(B,F,N){if(yield`(${N} instanceof Date) && Number.isFinite(${N}.getTime())`,u(B.exclusiveMaximumTimestamp))yield`${N}.getTime() < ${B.exclusiveMaximumTimestamp}`;if(u(B.exclusiveMinimumTimestamp))yield`${N}.getTime() > ${B.exclusiveMinimumTimestamp}`;if(u(B.maximumTimestamp))yield`${N}.getTime() <= ${B.maximumTimestamp}`;if(u(B.minimumTimestamp))yield`${N}.getTime() >= ${B.minimumTimestamp}`;if(u(B.multipleOfTimestamp))yield`(${N}.getTime() % ${B.multipleOfTimestamp}) === 0`}function*G(B,F,N){yield`(typeof ${N} === 'function')`}function*D(B,F,N){let E=globalThis.Object.getOwnPropertyNames(B.$defs).reduce((V,I)=>{return[...V,B.$defs[I]]},[]);yield*H6($1(B.$ref),[...F,...E],N)}function*A(B,F,N){if(yield`Number.isInteger(${N})`,u(B.exclusiveMaximum))yield`${N} < ${B.exclusiveMaximum}`;if(u(B.exclusiveMinimum))yield`${N} > ${B.exclusiveMinimum}`;if(u(B.maximum))yield`${N} <= ${B.maximum}`;if(u(B.minimum))yield`${N} >= ${B.minimum}`;if(u(B.multipleOf))yield`(${N} % ${B.multipleOf}) === 0`}function*H(B,F,N){let E=B.allOf.map((V)=>M8(V,F,N)).join(" && ");if(B.unevaluatedProperties===!1){let V=D6(`${new RegExp(e1(B))};`),I=`Object.getOwnPropertyNames(${N}).every(key => ${V}.test(key))`;yield`(${E} && ${I})`}else if(g0(B.unevaluatedProperties)){let V=D6(`${new RegExp(e1(B))};`),I=`Object.getOwnPropertyNames(${N}).every(key => ${V}.test(key) || ${M8(B.unevaluatedProperties,F,`${N}[key]`)})`;yield`(${E} && ${I})`}else yield`(${E})`}function*M(B,F,N){yield`(typeof value === 'object' && Symbol.iterator in ${N})`}function*L(B,F,N){if(typeof B.const==="number"||typeof B.const==="boolean")yield`(${N} === ${B.const})`;else yield`(${N} === '${UY.Escape(B.const)}')`}function*O(B,F,N){yield"false"}function*m(B,F,N){yield`(!${M8(B.not,F,N)})`}function*_(B,F,N){yield`(${N} === null)`}function*b(B,F,N){if(yield r6.IsNumberLike(N),u(B.exclusiveMaximum))yield`${N} < ${B.exclusiveMaximum}`;if(u(B.exclusiveMinimum))yield`${N} > ${B.exclusiveMinimum}`;if(u(B.maximum))yield`${N} <= ${B.maximum}`;if(u(B.minimum))yield`${N} >= ${B.minimum}`;if(u(B.multipleOf))yield`(${N} % ${B.multipleOf}) === 0`}function*l(B,F,N){if(yield r6.IsObjectLike(N),u(B.minProperties))yield`Object.getOwnPropertyNames(${N}).length >= ${B.minProperties}`;if(u(B.maxProperties))yield`Object.getOwnPropertyNames(${N}).length <= ${B.maxProperties}`;let E=Object.getOwnPropertyNames(B.properties);for(let V of E){let I=SQ.Encode(N,V),c=B.properties[V];if(B.required&&B.required.includes(V)){if(yield*H6(c,F,I),Z6(c)||$(c))yield`('${V}' in ${N})`}else{let C0=M8(c,F,I);yield r6.IsExactOptionalProperty(N,V,C0)}}if(B.additionalProperties===!1)if(B.required&&B.required.length===E.length)yield`Object.getOwnPropertyNames(${N}).length === ${E.length}`;else{let V=`[${E.map((I)=>`'${I}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${N}).every(key => ${V}.includes(key))`}if(typeof B.additionalProperties==="object"){let V=M8(B.additionalProperties,F,`${N}[key]`),I=`[${E.map((c)=>`'${c}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${N}).every(key => ${I}.includes(key) || ${V}))`}}function*t(B,F,N){yield`${N} instanceof Promise`}function*T(B,F,N){if(yield r6.IsRecordLike(N),u(B.minProperties))yield`Object.getOwnPropertyNames(${N}).length >= ${B.minProperties}`;if(u(B.maxProperties))yield`Object.getOwnPropertyNames(${N}).length <= ${B.maxProperties}`;let[E,V]=Object.entries(B.patternProperties)[0],I=D6(`${new RegExp(E)}`),c=M8(V,F,"value"),C0=g0(B.additionalProperties)?M8(B.additionalProperties,F,N):B.additionalProperties===!1?"false":"true",B8=`(${I}.test(key) ? ${c} : ${C0})`;yield`(Object.entries(${N}).every(([key, value]) => ${B8}))`}function*x(B,F,N){let E=M0(B,F);if(t0.functions.has(B.$ref))return yield`${E1(B.$ref)}(${N})`;yield*H6(E,F,N)}function*d(B,F,N){let E=D6(`${new RegExp(B.source,B.flags)};`);if(yield`(typeof ${N} === 'string')`,u(B.maxLength))yield`${N}.length <= ${B.maxLength}`;if(u(B.minLength))yield`${N}.length >= ${B.minLength}`;yield`${E}.test(${N})`}function*j(B,F,N){if(yield`(typeof ${N} === 'string')`,u(B.maxLength))yield`${N}.length <= ${B.maxLength}`;if(u(B.minLength))yield`${N}.length >= ${B.minLength}`;if(B.pattern!==void 0)yield`${D6(`${new RegExp(B.pattern)};`)}.test(${N})`;if(B.format!==void 0)yield`format('${B.format}', ${N})`}function*p(B,F,N){yield`(typeof ${N} === 'symbol')`}function*Z0(B,F,N){yield`(typeof ${N} === 'string')`,yield`${D6(`${new RegExp(B.pattern)};`)}.test(${N})`}function*U0(B,F,N){yield`${E1(B.$ref)}(${N})`}function*q0(B,F,N){if(yield`Array.isArray(${N})`,B.items===void 0)return yield`${N}.length === 0`;yield`(${N}.length === ${B.maxItems})`;for(let E=0;E<B.items.length;E++)yield`${M8(B.items[E],F,`${N}[${E}]`)}`}function*U1(B,F,N){yield`${N} === undefined`}function*L0(B,F,N){yield`(${B.anyOf.map((V)=>M8(V,F,N)).join(" || ")})`}function*d6(B,F,N){if(yield`${N} instanceof Uint8Array`,u(B.maxByteLength))yield`(${N}.length <= ${B.maxByteLength})`;if(u(B.minByteLength))yield`(${N}.length >= ${B.minByteLength})`}function*T$(B,F,N){yield"true"}function*YZ(B,F,N){yield r6.IsVoidLike(N)}function*F9(B,F,N){let E=t0.instances.size;t0.instances.set(E,B),yield`kind('${B[S]}', ${E}, ${N})`}function*H6(B,F,N,E=!0){let V=J0(B.$id)?[...F,B]:F,I=B;if(E&&J0(B.$id)){let c=E1(B.$id);if(t0.functions.has(c))return yield`${c}(${N})`;else{t0.functions.set(c,"<deferred>");let C0=c1(c,B,F,"value",!1);return t0.functions.set(c,C0),yield`${c}(${N})`}}switch(I[S]){case"Any":return yield*Q(I,V,N);case"Argument":return yield*Y(I,V,N);case"Array":return yield*W(I,V,N);case"AsyncIterator":return yield*X(I,V,N);case"BigInt":return yield*J(I,V,N);case"Boolean":return yield*z(I,V,N);case"Constructor":return yield*U(I,V,N);case"Date":return yield*q(I,V,N);case"Function":return yield*G(I,V,N);case"Import":return yield*D(I,V,N);case"Integer":return yield*A(I,V,N);case"Intersect":return yield*H(I,V,N);case"Iterator":return yield*M(I,V,N);case"Literal":return yield*L(I,V,N);case"Never":return yield*O(I,V,N);case"Not":return yield*m(I,V,N);case"Null":return yield*_(I,V,N);case"Number":return yield*b(I,V,N);case"Object":return yield*l(I,V,N);case"Promise":return yield*t(I,V,N);case"Record":return yield*T(I,V,N);case"Ref":return yield*x(I,V,N);case"RegExp":return yield*d(I,V,N);case"String":return yield*j(I,V,N);case"Symbol":return yield*p(I,V,N);case"TemplateLiteral":return yield*Z0(I,V,N);case"This":return yield*U0(I,V,N);case"Tuple":return yield*q0(I,V,N);case"Undefined":return yield*U1(I,V,N);case"Union":return yield*L0(I,V,N);case"Uint8Array":return yield*d6(I,V,N);case"Unknown":return yield*T$(I,V,N);case"Void":return yield*YZ(I,V,N);default:if(!e0.Has(I[S]))throw new w4(B);return yield*F9(I,V,N)}}let t0={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function M8(B,F,N,E=!0){return`(${[...H6(B,F,N,E)].join(" && ")})`}function E1(B){return`check_${zY.Encode(B)}`}function D6(B){let F=`local_${t0.variables.size}`;return t0.variables.set(F,`const ${F} = ${B}`),F}function c1(B,F,N,E,V=!0){let[I,c]=[`
`,(m8)=>"".padStart(m8," ")],C0=N6("value","any"),B8=k$("boolean"),J8=[...H6(F,N,E,V)].map((m8)=>`${c(4)}${m8}`).join(` &&${I}`);return`function ${B}(${C0})${B8} {${I}${c(2)}return (${I}${J8}${I}${c(2)})
}`}function N6(B,F){let N=t0.language==="typescript"?`: ${F}`:"";return`${B}${N}`}function k$(B){return t0.language==="typescript"?`: ${B}`:""}function w6(B,F,N){let E=c1("check",B,F,"value"),V=N6("value","any"),I=k$("boolean"),c=[...t0.functions.values()],C0=[...t0.variables.values()],B8=J0(B.$id)?`return function check(${V})${I} {
  return ${E1(B.$id)}(value)
}`:`return ${E}`;return[...C0,...c,B8].join(`
`)}function g(...B){let F={language:"javascript"},[N,E,V]=B.length===2&&o(B[1])?[B[0],B[1],F]:B.length===2&&!o(B[1])?[B[0],[],B[1]]:B.length===3?[B[0],B[1],B[2]]:B.length===1?[B[0],[],F]:[null,[],F];if(t0.language=V.language,t0.variables.clear(),t0.functions.clear(),t0.instances.clear(),!g0(N))throw new qY(N);for(let I of E)if(!g0(I))throw new qY(I);return w6(N,E,V)}Z.Code=g;function R(B,F=[]){let N=g(B,F,{language:"javascript"}),E=globalThis.Function("kind","format","hash",N),V=new Map(t0.instances);function I(J8,m8,u1){if(!e0.Has(J8)||!V.has(m8))return!1;let UU=e0.Get(J8),qU=V.get(m8);return UU(qU,u1)}function c(J8,m8){if(!S0.Has(J8))return!1;return S0.Get(J8)(m8)}function C0(J8){return C6(J8)}let B8=E(I,c,C0);return new N4(B,F,B8,N)}Z.Compile=R})(f1||(f1={}));var iA=Object.create,{getPrototypeOf:lA,defineProperty:A4,getOwnPropertyNames:nA}=Object,oA=Object.prototype.hasOwnProperty,dQ=(Z,$,Q)=>{Q=Z!=null?iA(lA(Z)):{};let Y=$||!Z||!Z.__esModule?A4(Q,"default",{value:Z,enumerable:!0}):Q;for(let W of nA(Z))if(!oA.call(Y,W))A4(Y,W,{get:()=>Z[W],enumerable:!0});return Y},n4=(Z,$)=>()=>($||Z(($={exports:{}}).exports,$),$.exports);var tA=n4((Z)=>{Object.defineProperty(Z,"__esModule",{value:!0}),Z.parse=z,Z.serialize=G;var $=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Q=/^[\u0021-\u003A\u003C-\u007E]*$/,Y=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,W=/^[\u0020-\u003A\u003D-\u007E]*$/,X=Object.prototype.toString,J=(()=>{let H=function(){};return H.prototype=Object.create(null),H})();function z(H,M){let L=new J,O=H.length;if(O<2)return L;let m=M?.decode||D,_=0;do{let b=H.indexOf("=",_);if(b===-1)break;let l=H.indexOf(";",_),t=l===-1?O:l;if(b>t){_=H.lastIndexOf(";",b-1)+1;continue}let T=U(H,_,b),x=q(H,b,T),d=H.slice(T,x);if(L[d]===void 0){let j=U(H,b+1,t),p=q(H,t,j),Z0=m(H.slice(j,p));L[d]=Z0}_=t+1}while(_<O);return L}function U(H,M,L){do{let O=H.charCodeAt(M);if(O!==32&&O!==9)return M}while(++M<L);return L}function q(H,M,L){while(M>L){let O=H.charCodeAt(--M);if(O!==32&&O!==9)return M+1}return L}function G(H,M,L){let O=L?.encode||encodeURIComponent;if(!$.test(H))throw new TypeError(`argument name is invalid: ${H}`);let m=O(M);if(!Q.test(m))throw new TypeError(`argument val is invalid: ${M}`);let _=H+"="+m;if(!L)return _;if(L.maxAge!==void 0){if(!Number.isInteger(L.maxAge))throw new TypeError(`option maxAge is invalid: ${L.maxAge}`);_+="; Max-Age="+L.maxAge}if(L.domain){if(!Y.test(L.domain))throw new TypeError(`option domain is invalid: ${L.domain}`);_+="; Domain="+L.domain}if(L.path){if(!W.test(L.path))throw new TypeError(`option path is invalid: ${L.path}`);_+="; Path="+L.path}if(L.expires){if(!A(L.expires)||!Number.isFinite(L.expires.valueOf()))throw new TypeError(`option expires is invalid: ${L.expires}`);_+="; Expires="+L.expires.toUTCString()}if(L.httpOnly)_+="; HttpOnly";if(L.secure)_+="; Secure";if(L.partitioned)_+="; Partitioned";if(L.priority)switch(typeof L.priority==="string"?L.priority.toLowerCase():void 0){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${L.priority}`)}if(L.sameSite)switch(typeof L.sameSite==="string"?L.sameSite.toLowerCase():L.sameSite){case!0:case"strict":_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"none":_+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${L.sameSite}`)}return _}function D(H){if(H.indexOf("%")===-1)return H;try{return decodeURIComponent(H)}catch(M){return H}}function A(H){return X.call(H)==="[object Date]"}}),jY=n4((Z,$)=>{var Q=12,Y=0,W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7];function X(U){var q=U.indexOf("%");if(q===-1)return U;var G=U.length,D="",A=0,H=0,M=q,L=Q;while(q>-1&&q<G){var O=z(U[q+1],4),m=z(U[q+2],0),_=O|m,b=W[_];if(L=W[256+L+b],H=H<<6|_&W[364+b],L===Q)D+=U.slice(A,M),D+=H<=65535?String.fromCharCode(H):String.fromCharCode(55232+(H>>10),56320+(H&1023)),H=0,A=q+3,q=M=U.indexOf("%",A);else if(L===Y)return null;else{if(q+=3,q<G&&U.charCodeAt(q)===37)continue;return null}}return D+U.slice(A)}var J={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};function z(U,q){var G=J[U];return G===void 0?255:G<<q}$.exports=X}),EZ=(Z,$)=>{let Q=$?.length?{}:null;if(Q)for(let Y of $)Q[Y.part.charCodeAt(0)]=Y;return{part:Z,store:null,inert:Q,params:null,wildcardStore:null}},L4=(Z,$)=>({...Z,part:$}),S4=(Z)=>({name:Z,store:null,inert:null});class TZ{config;root={};history=[];deferred=[];constructor(Z={}){if(this.config=Z,Z.lazy)this.find=this.lazyFind}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/:.+?\?(?=\/|$)/g};lazyFind=(Z,$)=>{if(!this.config.lazy)return this.find;return this.build(),this.find(Z,$)};build(){if(!this.config.lazy)return;for(let[Z,$,Q]of this.deferred)this.add(Z,$,Q,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=(Z,$)=>{let Q=this.root[Z];if(!Q)return null;return jQ($,$.length,Q,0)}}add(Z,$,Q,{ignoreError:Y=!1,ignoreHistory:W=!1,lazy:X=this.config.lazy}={}){if(X)return this.find=this.lazyFind,this.deferred.push([Z,$,Q]),Q;if(typeof $!=="string")throw new TypeError("Route path must be a string");if($==="")$="/";else if($[0]!=="/")$=`/${$}`;let J=$[$.length-1]==="*",z=$.match(TZ.regex.optionalParams);if(z){let A=$.replaceAll("?","");this.add(Z,A,Q,{ignoreError:Y,ignoreHistory:W,lazy:X});for(let H=0;H<z.length;H++){let M=$.replace("/"+z[H],"");this.add(Z,M,Q,{ignoreError:!0,ignoreHistory:W,lazy:X})}return Q}if(z)$=$.replaceAll("?","");if(this.history.find(([A,H,M])=>A===Z&&H===$))return Q;if(J||z&&$.charCodeAt($.length-1)===63)$=$.slice(0,-1);if(!W)this.history.push([Z,$,Q]);let U=$.split(TZ.regex.static),q=$.match(TZ.regex.params)||[];if(U[U.length-1]==="")U.pop();let G;if(!this.root[Z])G=this.root[Z]=EZ("/");else G=this.root[Z];let D=0;for(let A=0;A<U.length;++A){let H=U[A];if(A>0){let M=q[D++].slice(1);if(G.params===null)G.params=S4(M);else if(G.params.name!==M)if(Y)return Q;else throw new Error(`Cannot create route "${$}" with parameter "${M}" because a route already exists with a different parameter name ("${G.params.name}") in the same location`);let L=G.params;if(L.inert===null){G=L.inert=EZ(H);continue}G=L.inert}for(let M=0;;){if(M===H.length){if(M<G.part.length){let L=L4(G,G.part.slice(M));Object.assign(G,EZ(H,[L]))}break}if(M===G.part.length){if(G.inert===null)G.inert={};let L=G.inert[H.charCodeAt(M)];if(L){G=L,H=H.slice(M),M=0;continue}let O=EZ(H.slice(M));G.inert[H.charCodeAt(M)]=O,G=O;break}if(H[M]!==G.part[M]){let L=L4(G,G.part.slice(M)),O=EZ(H.slice(M));Object.assign(G,EZ(G.part.slice(0,M),[L,O])),G=O;break}++M}}if(D<q.length){let A=q[D].slice(1);if(G.params===null)G.params=S4(A);else if(G.params.name!==A)if(Y)return Q;else throw new Error(`Cannot create route "${$}" with parameter "${A}" because a route already exists with a different parameter name ("${G.params.name}") in the same location`);if(G.params.store===null)G.params.store=Q;return G.params.store}if(J){if(G.wildcardStore===null)G.wildcardStore=Q;return G.wildcardStore}if(G.store===null)G.store=Q;return G.store}find(Z,$){let Q=this.root[Z];if(!Q)return null;return jQ($,$.length,Q,0)}}var jQ=(Z,$,Q,Y)=>{let W=Q.part,X=W.length,J=Y+X;if(X>1){if(J>$)return null;if(X<15){for(let z=1,U=Y+1;z<X;++z,++U)if(W.charCodeAt(z)!==Z.charCodeAt(U))return null}else if(Z.slice(Y,J)!==W)return null}if(J===$){if(Q.store!==null)return{store:Q.store,params:{}};if(Q.wildcardStore!==null)return{store:Q.wildcardStore,params:{"*":""}};return null}if(Q.inert!==null){let z=Q.inert[Z.charCodeAt(J)];if(z!==void 0){let U=jQ(Z,$,z,J);if(U!==null)return U}}if(Q.params!==null){let{store:z,name:U,inert:q}=Q.params,G=Z.indexOf("/",J);if(G!==J){if(G===-1||G>=$){if(z!==null){let D={};return D[U]=Z.substring(J,$),{store:z,params:D}}}else if(q!==null){let D=jQ(Z,$,q,G);if(D!==null)return D.params[U]=Z.substring(J,G),D}}}if(Q.wildcardStore!==null)return{store:Q.wildcardStore,params:{"*":Z.substring(J,$)}};return null},RY={date:o4,time:SY(!0),"date-time":O4(!0),"iso-time":SY(!1),"iso-date-time":O4(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:YL,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:GL,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:WL,int32:{type:"number",validate:zL},int64:{type:"number",validate:UL},float:{type:"number",validate:_4},double:{type:"number",validate:_4},password:!0,binary:!0};function sA(Z){return Z%4===0&&(Z%100!==0||Z%400===0)}var rA=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,aA=[0,31,28,31,30,31,30,31,31,30,31,30,31];function o4(Z){let $=rA.exec(Z);if(!$)return!1;let Q=+$[1],Y=+$[2],W=+$[3];return Y>=1&&Y<=12&&W>=1&&W<=(Y===2&&sA(Q)?29:aA[Y])}var eA=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function SY(Z){return function $(Q){let Y=eA.exec(Q);if(!Y)return!1;let W=+Y[1],X=+Y[2],J=+Y[3],z=Y[4],U=Y[5]==="-"?-1:1,q=+(Y[6]||0),G=+(Y[7]||0);if(q>23||G>59||Z&&!z)return!1;if(W<=23&&X<=59&&J<60)return!0;let D=X-G*U,A=W-q*U-(D<0?1:0);return(A===23||A===-1)&&(D===59||D===-1)&&J<61}}var t4=(Z)=>{if(Z.charCodeAt(Z.length-6)===32)return Z.slice(0,-6)+"+"+Z.slice(-5);return Z},ZL=/t|\s/i;function O4(Z){let $=SY(Z);return function Q(Y){let W=Y.split(ZL);return W.length===2&&o4(W[0])&&$(W[1])}}var $L=/\/|:/,QL=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function YL(Z){return $L.test(Z)&&QL.test(Z)}var F4=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function WL(Z){return F4.lastIndex=0,F4.test(Z)}var XL=-2147483648,JL=2147483647;function zL(Z){return Number.isInteger(Z)&&Z<=JL&&Z>=XL}function UL(Z){return Number.isInteger(Z)}function _4(){return!0}var qL=/[^\\]\\Z/;function GL(Z){if(qL.test(Z))return!1;try{return new RegExp(Z),!0}catch($){return!1}}var s4=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,r4=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,a4=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,ML=RY.date,BL=RY["date-time"];if(!S0.Has("date"))S0.Set("date",(Z)=>{let $=t4(Z).replace(/"/g,"");if(s4.test($)||r4.test($)||a4.test($)||ML($)){let Q=new Date($);if(!Number.isNaN(Q.getTime()))return!0}return!1});if(!S0.Has("date-time"))S0.Set("date-time",(Z)=>{let $=Z.replace(/"/g,"");if(s4.test($)||r4.test($)||a4.test($)||BL($)){let Q=new Date($);if(!Number.isNaN(Q.getTime()))return!0}return!1});Object.entries(RY).forEach((Z)=>{let[$,Q]=Z;if(!S0.Has($)){if(Q instanceof RegExp)S0.Set($,(Y)=>Q.test(Y));else if(typeof Q==="function")S0.Set($,Q)}});if(!S0.Has("numeric"))S0.Set("numeric",(Z)=>!!Z&&!isNaN(+Z));if(!S0.Has("integer"))S0.Set("integer",(Z)=>!!Z&&Number.isInteger(+Z));if(!S0.Has("boolean"))S0.Set("boolean",(Z)=>Z==="true"||Z==="false");if(!S0.Has("ObjectString"))S0.Set("ObjectString",(Z)=>{let $=Z.charCodeAt(0);if($===9||$===10||$===32)$=Z.trimStart().charCodeAt(0);if($!==123&&$!==91)return!1;try{return JSON.parse(Z),!0}catch{return!1}});if(!S0.Has("ArrayString"))S0.Set("ArrayString",(Z)=>{let $=Z.charCodeAt(0);if($===9||$===10||$===32)$=Z.trimStart().charCodeAt(0);if($!==123&&$!==91)return!1;try{return JSON.parse(Z),!0}catch{return!1}});var kZ=typeof Bun!=="undefined",HL={aac:"audio/aac",abw:"application/x-abiword",ai:"application/postscript",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",dll:"application/octet-stream",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi",midi:"audio/midi",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpa:"video/mpeg",mpe:"video/mpeg",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/x-wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",xlsx_OLD:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3gp_DOES_NOT_CONTAIN_VIDEO":"audio/3gpp","3gp2":"video/3gpp2","3gp2_DOES_NOT_CONTAIN_VIDEO":"audio/3gpp2","7z":"application/x-7z-compressed"},DL=(Z)=>{let $=Z.lastIndexOf(".");if($===-1)return"";return Z.slice($+1)};var GY,MY;class RQ{path;value;stats;constructor(Z){if(this.path=Z,kZ)this.value=Bun.file(Z);else if(typeof window!=="undefined")console.warn("Browser environment does not support file");else if(!GY||!MY)try{this.value=import("fs").then(($)=>{return GY=$.createReadStream,$.createReadStream(Z)}),this.stats=import("fs/promises").then(($)=>{return MY=$.stat,$.stat(Z)})}catch{}else this.value=GY(Z),this.stats=MY(Z)}get type(){return HL[DL(this.path)]||"application/octet-stream"}get length(){if(kZ)return this.value.size;return this.stats?.then((Z)=>Z.size)??0}}var VQ="toJSON"in new Headers,P4=(Z,$)=>{let Q=new URL(Z);return Q.pathname=$,Q.toString()},NL=(Z)=>typeof Z==="function"&&/^\s*class\s+/.test(Z.toString())||Z.toString&&Z.toString().startsWith("[object ")&&Z.toString()!=="[object Object]"||I0(Object.getPrototypeOf(Z)),BY=(Z)=>Z&&typeof Z==="object"&&!Array.isArray(Z),g8=(Z,$,Q)=>{let Y=Q?.skipKeys,W=Q?.override??!0;if(!BY(Z)||!BY($))return Z;for(let[X,J]of Object.entries($)){if(Y?.includes(X))continue;if(!BY(J)||!(X in Z)||NL(J)){if(W||!(X in Z))Z[X]=J;continue}Z[X]=g8(Z[X],J,{skipKeys:Y,override:W})}return Z},e4=(Z,$)=>{let Q=g8(Object.assign({},Z),$,{skipKeys:["properties"]});if(Q.properties)delete Q.properties;return Q},c0=(Z,$)=>{if(!$)return Z;let Q=[],Y=[];if(Z){if(!Array.isArray(Z))Z=[Z];for(let W of Z)if(Q.push(W),W.checksum)Y.push(W.checksum)}if($){if(!Array.isArray($))$=[$];for(let W of $)if(!Y.includes(W.checksum))Q.push(W)}return Q},wL=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],AL=wL.reduce((Z,$)=>(Z[$]=!0,Z),{}),Z5=(Z,$)=>{let Q=(Y)=>typeof Y==="object"&&Object.keys(Y).every(VY);if(Q(Z)&&Q($))return Object.assign(Z,$);else if(Z&&!Q(Z)&&Q($))return Object.assign({200:Z},$);return $??Z},q$=(Z,$)=>{return{body:$?.body??Z?.body,headers:$?.headers??Z?.headers,params:$?.params??Z?.params,query:$?.query??Z?.query,cookie:$?.cookie??Z?.cookie,response:Z5(Z?.response,$?.response)}},J6=(Z,$)=>{if(!Object.values($).find((Y)=>Y!==void 0&&Y!==null))return{...Z};let Q={...Z,...$,body:$?.body??Z?.body,headers:$?.headers??Z?.headers,params:$?.params??Z?.params,query:$?.query??Z?.query,cookie:$?.cookie??Z?.cookie,response:Z5(Z?.response,$?.response),type:Z?.type||$?.type,detail:g8($?.detail??{},Z?.detail??{}),parse:c0(Z?.parse,$?.parse),transform:c0(Z?.transform,$?.transform),beforeHandle:c0(c0($8(Z?.resolve,"resolve"),Z?.beforeHandle),c0($8($.resolve,"resolve"),$?.beforeHandle)),afterHandle:c0(Z?.afterHandle,$?.afterHandle),mapResponse:c0(Z?.mapResponse,$?.mapResponse),afterResponse:c0(Z?.afterResponse,$?.afterResponse),trace:c0(Z?.trace,$?.trace),error:c0(Z?.error,$?.error)};if(Q.resolve)delete Q.resolve;return Q},LL=(Z)=>{if(Z.parse&&!Array.isArray(Z.parse))Z.parse=[Z.parse];if(Z.transform&&!Array.isArray(Z.transform))Z.transform=[Z.transform];if(Z.afterHandle&&!Array.isArray(Z.afterHandle))Z.afterHandle=[Z.afterHandle];if(Z.mapResponse&&!Array.isArray(Z.mapResponse))Z.mapResponse=[Z.mapResponse];if(Z.afterResponse&&!Array.isArray(Z.afterResponse))Z.afterResponse=[Z.afterResponse];if(Z.trace&&!Array.isArray(Z.trace))Z.trace=[Z.trace];if(Z.error&&!Array.isArray(Z.error))Z.error=[Z.error];let $=[];if(Z.resolve)$=$8(Array.isArray(Z.resolve)?Z.resolve:[Z.resolve],"resolve"),delete Z.resolve;if(Z.beforeHandle)if($.length)$=$.concat(Array.isArray(Z.beforeHandle)?Z.beforeHandle:[Z.beforeHandle]);else $=Array.isArray(Z.beforeHandle)?Z.beforeHandle:[Z.beforeHandle];if($.length)Z.beforeHandle=$;return Z},SL=typeof Bun!=="undefined",cd=SL&&typeof Bun.hash==="function",bZ=(Z)=>{let $=9;for(let Q=0;Q<Z.length;)$=Math.imul($^Z.charCodeAt(Q++),387420489);return $=$^$>>>9},K1=(Z,$)=>{if(!$)return;if(!Array.isArray($)){let Y=$;if(Z&&!Y.checksum)Y.checksum=Z;if(Y.scope==="scoped")Y.scope="local";return Y}let Q=[...$];for(let Y of Q){if(Z&&!Y.checksum)Y.checksum=Z;if(Y.scope==="scoped")Y.scope="local"}return Q},K4=(Z,$,Q)=>{return{start:c0(Z.start,K1(Q,$?.start)),request:c0(Z.request,K1(Q,$?.request)),parse:c0(Z.parse,K1(Q,$?.parse)),transform:c0(Z.transform,K1(Q,$?.transform)),beforeHandle:c0(c0($8(Z.resolve,"resolve"),Z.beforeHandle),K1(Q,c0($8($?.resolve,"resolve"),$?.beforeHandle))),afterHandle:c0(Z.afterHandle,K1(Q,$?.afterHandle)),mapResponse:c0(Z.mapResponse,K1(Q,$?.mapResponse)),afterResponse:c0(Z.afterResponse,K1(Q,$?.afterResponse)),trace:c0(Z.trace,K1(Q,$?.trace)),error:c0(Z.error,K1(Q,$?.error)),stop:c0(Z.stop,K1(Q,$?.stop))}},OL=(Z,$,{skipIfHasType:Q=!1})=>{if(!Z)return Z;if(!Array.isArray(Z)){if(Q)Z.scope??=$;else Z.scope=$;return Z}for(let Y of Z)if(Q)Y.scope??=$;else Y.scope=$;return Z},j6=(Z)=>{if(!Z)return Z;if(!Array.isArray(Z))switch(Z.scope){case"global":case"scoped":return{...Z};default:return{fn:Z}}let $=[];for(let Q of Z)switch(Q.scope){case"global":case"scoped":$.push({...Q});break}return $},C4=(Z)=>{return{...Z,type:Z?.type,detail:Z?.detail,parse:j6(Z?.parse),transform:j6(Z?.transform),beforeHandle:j6(Z?.beforeHandle),afterHandle:j6(Z?.afterHandle),mapResponse:j6(Z?.mapResponse),afterResponse:j6(Z?.afterResponse),error:j6(Z?.error),trace:j6(Z?.trace)}},vQ={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},j4=Object.fromEntries(Object.entries(vQ).map(([Z,$])=>[$,Z]));function FL(Z){let $=Z;while($.endsWith("="))$=$.slice(0,-1);return $}var R4=new TextEncoder,EQ=async(Z,$)=>{if(typeof Z!=="string")throw new TypeError("Cookie value must be provided as a string.");if($===null)throw new TypeError("Secret key must be provided.");let Q=await crypto.subtle.importKey("raw",R4.encode($),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Y=await crypto.subtle.sign("HMAC",Q,R4.encode(Z));return Z+"."+FL(Buffer.from(Y).toString("base64"))},V4=async(Z,$)=>{if(typeof Z!=="string")throw new TypeError("Signed cookie string must be provided.");if($===null)throw new TypeError("Secret key must be provided.");let Q=Z.slice(0,Z.lastIndexOf("."));return await EQ(Q,$)===Z?Q:!1},_L=(Z,$,Q)=>{if(!Z||typeof Z!=="object"||!$)return;for(let[Y,W]of Object.entries($)){if(AL[Y]||!(Y in Z))continue;let X=Z[Y];if(typeof X==="function"){let J=X(W);if(typeof J==="object")for(let[z,U]of Object.entries(J))Q(z)({fn:U})}delete $[Y]}},PL=({globalHook:Z,localHook:$})=>(Q)=>(Y,W)=>{if(typeof Y==="function")Y={fn:Y};if(Q==="resolve")Y={...Y,subType:"resolve"};if(!$[Q])$[Q]=[];if(typeof $[Q]==="function")$[Q]=[$[Q]];if(!Array.isArray($[Q]))$[Q]=[$[Q]];if("fn"in Y||Array.isArray(Y)){if(Array.isArray(Y))$[Q]=$[Q].concat(Y);else $[Q].push(Y);return}let{insert:X="after",stack:J="local"}=Y;if(typeof W==="function")W={fn:W};if(J==="global")if(!Array.isArray(W))if(X==="before")Z[Q].unshift(W);else Z[Q].push(W);else if(X==="before")Z[Q]=W.concat(Z[Q]);else Z[Q]=Z[Q].concat(W);else if(!Array.isArray(W))if(X==="before")$[Q].unshift(W);else $[Q].push(W);else if(X==="before")$[Q]=W.concat($[Q]);else $[Q]=$[Q].concat(W)},KL=(Z)=>{if(typeof Z==="number")return Z;if(Z.length<16){if(Z.trim().length===0)return null;let $=Number(Z);if(Number.isNaN($))return null;return $}if(Z.length===16){if(Z.trim().length===0)return null;let $=Number(Z);if(Number.isNaN($)||$.toString()!==Z)return null;return $}return null},VY=(Z)=>KL(Z)!==null;class $5{onError;onFinally;root=null;promises=[];constructor(Z=console.error,$=()=>{}){this.onError=Z,this.onFinally=$}get size(){return this.promises.length}add(Z){if(this.promises.push(Z),this.root||=this.drain(),this.promises.length===1)this.then(this.onFinally);return Z}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch(Z){this.onError(Z)}this.promises.shift()}this.root=null}then(Z,$){return(this.root??Promise.resolve()).then(Z,$)}}var $8=(Z,$)=>{if(!Z)return Z;if(!Array.isArray(Z)){if(typeof Z==="function"||typeof Z==="string")return $?{fn:Z,subType:$}:{fn:Z};else if("fn"in Z)return Z}let Q=[];for(let Y of Z)if(typeof Y==="function"||typeof Y==="string")Q.push($?{fn:Y,subType:$}:{fn:Y});else if("fn"in Y)Q.push(Y);return Q},E4=(Z)=>{if(Z.start)Z.start=$8(Z.start);if(Z.request)Z.request=$8(Z.request);if(Z.parse)Z.parse=$8(Z.parse);if(Z.transform)Z.transform=$8(Z.transform);if(Z.beforeHandle)Z.beforeHandle=$8(Z.beforeHandle);if(Z.afterHandle)Z.afterHandle=$8(Z.afterHandle);if(Z.mapResponse)Z.mapResponse=$8(Z.mapResponse);if(Z.afterResponse)Z.afterResponse=$8(Z.afterResponse);if(Z.trace)Z.trace=$8(Z.trace);if(Z.error)Z.error=$8(Z.error);if(Z.stop)Z.stop=$8(Z.stop);return Z},I4=(Z)=>{if(Z.start?.map)Z.start=Z.start.map(($)=>$.fn);if(Z.request?.map)Z.request=Z.request.map(($)=>$.fn);if(Z.parse?.map)Z.parse=Z.parse.map(($)=>$.fn);if(Z.transform?.map)Z.transform=Z.transform.map(($)=>$.fn);if(Z.beforeHandle?.map)Z.beforeHandle=Z.beforeHandle.map(($)=>$.fn);if(Z.afterHandle?.map)Z.afterHandle=Z.afterHandle.map(($)=>$.fn);if(Z.mapResponse?.map)Z.mapResponse=Z.mapResponse.map(($)=>$.fn);if(Z.afterResponse?.map)Z.afterResponse=Z.afterResponse.map(($)=>$.fn);if(Z.trace?.map)Z.trace=Z.trace.map(($)=>$.fn);else Z.trace=[];if(Z.error?.map)Z.error=Z.error.map(($)=>$.fn);if(Z.stop?.map)Z.stop=Z.stop.map(($)=>$.fn);return Z},b4=(Z)=>({body:Z.body,cookie:Z.cookie,headers:Z.headers,query:Z.query,set:Z.set,server:Z.server,path:Z.path,route:Z.route,url:Z.url}),EY=(Z,$=302)=>Response.redirect(Z,$),ZZ=Symbol("ElysiaFormData"),O$=Symbol("ElysiaRequestId"),CL=(Z)=>{let $=new FormData;if($[ZZ]={},Z)for(let[Q,Y]of Object.entries(Z)){if(Array.isArray(Y)){$[ZZ][Q]=[];for(let W of Y){if(Y instanceof File)$.append(Q,Y,Y.name);else if(Y instanceof RQ)$.append(Q,Y.value,Y.value?.name);else $.append(Q,Y);$[ZZ][Q].push(Y)}continue}if(Y instanceof File)$.append(Q,Y,Y.name);else if(Y instanceof RQ)$.append(Q,Y.value,Y.value?.name);else $.append(Q,Y);$[ZZ][Q]=Y}return $},hQ=()=>{let Z=crypto.randomUUID();return Z.slice(0,8)+Z.slice(24,32)},x4=(Z)=>{let $=[];for(let Q=0;Q<Z.length;Q++){let Y=Z[Q];if(Y.checksum){if($.includes(Y.checksum))Z.splice(Q,1),Q--;$.push(Y.checksum)}}return Z},R6=(Z,$="scoped")=>{if(!Z)return;if($==="scoped"){for(let Q of Z)if("scope"in Q&&Q.scope==="local")Q.scope="scoped";return}for(let Q of Z)if("scope"in Q)Q.scope="global"},M$=(Z)=>{if(Z.charCodeAt(Z.length-1)===47)return Z.slice(0,Z.length-1);return Z+"/"},I0=(Z)=>{if(!Z)return!1;for(let $ in Z)return!0;return!1},B$=(Z,{dynamic:$=!1}={})=>{let Q=encodeURIComponent(Z).replace(/%2F/g,"/");if($)Q=Q.replace(/%3A/g,":").replace(/%3F/g,"?");return Q},Q5=(()=>{if(typeof Bun==="undefined")return!0;let Z=Bun.version.split(".");if(+Z[0]<1||+Z[1]<2||+Z[2]<14)return!1;return!0})(),T4=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,IQ=Symbol("ElysiaErrorCode"),L$=(T4?.NODE_ENV??T4?.ENV)==="production";class K8{code;response;constructor(Z,$){let Q=$??(Z in j4?j4[Z]:Z);this.code=vQ[Z]??Z,this.response=Q}}var bQ=(Z,$)=>new K8(Z,$);class IY extends Error{code="NOT_FOUND";status=404;constructor(Z){super(Z??"NOT_FOUND")}}class Y5 extends Error{code="PARSE";status=400;constructor(Z){super("Bad Request",{cause:Z})}}class OY extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor(Z,$){super($??`"${Z}" has invalid cookie signature`);this.key=Z}}var j1=(Z)=>{if(!Z)return{summary:void 0};let{message:$,path:Q,value:Y,type:W}=Z,X=Q.slice(1).replaceAll("/","."),J=Q==="";switch(W){case 42:return{...Z,summary:J?"Value should not be provided":`Property '${X}' should not be provided`};case 45:return{...Z,summary:J?"Value is missing":`Property '${X}' is missing`};case 50:let z=$.indexOf("'"),U=$.slice(z+1,$.indexOf("'",z+1));return{...Z,summary:J?"Value should be an email":`Property '${X}' should be ${U}`};case 54:return{...Z,summary:`${$.slice(0,9).trim()} property '${X}' to be ${$.slice(8).trim()} but found: ${Y}`};case 62:let q=Z.schema.anyOf.map((G)=>`'${G?.format??G.type}'`).join(", ");return{...Z,summary:J?`Value should be one of ${q}`:`Property '${X}' should be one of: ${q}`};default:return{summary:$,...Z}}};class N$ extends Error{property;expected;message;code="INVALID_FILE_TYPE";status=422;constructor(Z,$,Q=`"${Z}" has invalid file type`){super(Q);this.property=Z,this.expected=$,this.message=Q,Object.setPrototypeOf(this,N$.prototype)}toResponse(Z){if(L$)return new Response(JSON.stringify({type:"validation",on:"body"}),{status:422,headers:{...Z,"content-type":"application/json"}});return new Response(JSON.stringify({type:"validation",on:"body",summary:"Invalid file type",message:this.message,property:this.property,expected:this.expected}),{status:422,headers:{...Z,"content-type":"application/json"}})}}class K0 extends Error{type;validator;value;code="VALIDATION";status=422;constructor(Z,$,Q,Y){if(Q&&typeof Q==="object"&&Q instanceof K8)Q=Q.response;let W=Y?.First()||(L$?void 0:("Errors"in $)?$.Errors(Q).First():A0.Errors($,Q).First()),X=W?.schema?.message||W?.schema?.error!==void 0?typeof W.schema.error==="function"?W.schema.error({type:Z,validator:$,value:Q,get errors(){return[...$.Errors(Q)].map(j1)}}):W.schema.error:void 0,J=W?.path||"root",z="";if(X!==void 0)z=typeof X==="object"?JSON.stringify(X):X+"";else if(L$)z=JSON.stringify({type:"validation",on:Z,summary:j1(W).summary,message:W?.message,found:Q});else{let U=$?.schema??$,q="Errors"in $?[...$.Errors(Q)].map(j1):[...A0.Errors($,Q)].map(j1),G;try{G=A0.Create(U)}catch(D){G={type:"Could not create expected value",message:D?.message,error:D}}z=JSON.stringify({type:"validation",on:Z,summary:j1(W).summary,property:J,message:W?.message,expected:G,found:Q,errors:q},null,2)}super(z);this.type=Z,this.validator=$,this.value=Q,Object.setPrototypeOf(this,K0.prototype)}get all(){return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(j1):[...A0.Errors(this.validator,this.value)].map(j1)}static simplifyModel(Z){let $="schema"in Z?Z.schema:Z;try{return A0.Create($)}catch{return $}}get model(){return K0.simplifyModel(this.validator)}toResponse(Z){return new Response(this.message,{status:400,headers:{...Z,"content-type":"application/json"}})}}var OQ=(Z,$)=>{try{return JSON.parse(Z)}catch{throw new K0("property",$,Z)}};function mQ(Z,$){if(!e0.Has(Z))e0.Set(Z,$);return(Q={})=>UQ({...Q,[S]:Z})}var a6=(Z)=>{try{let $=f1.Compile(Z);return $.Create=()=>A0.Create(Z),$.Error=(Q)=>new K0("property",Z,Q,$.Errors(Q)),$}catch{return{Check:($)=>A0.Check(Z,$),CheckThrow:($)=>{if(!A0.Check(Z,$))throw new K0("property",Z,$,A0.Errors(Z,$))},Decode:($)=>A0.Decode(Z,$),Create:()=>A0.Create(Z),Error:($)=>new K0("property",Z,$,A0.Errors(Z,$))}}},k4=(Z)=>{if(typeof Z==="string")switch(Z.slice(-1)){case"k":return+Z.slice(0,Z.length-1)*1024;case"m":return+Z.slice(0,Z.length-1)*1048576;default:return+Z}return Z},xQ=(Z,$)=>{if(Z.startsWith($))return!0;return $.charCodeAt($.length-1)===42&&$.charCodeAt($.length-2)===47&&Z.startsWith($.slice(0,-1))},g4=!1,jL=()=>{if(!g4)console.warn("[Elysia] Attempt to validate file type without 'file-type'. This may lead to security risks. We recommend installing 'file-type' to properly validate file extension."),g4=!0},bY=async()=>import("./index-m85f3kpy.js").then((Z)=>{return TQ=Z.fileTypeFromBlob,TQ}).catch(jL),TQ,RL=(Z)=>{if(TQ)return TQ(Z);return bY().then(($)=>{if($)return $(Z)})},VL=async(Z,$,Q=Z?.name??"")=>{if(!Z)return;let Y=await RL(Z);if(!Y)throw new N$(Q,$);if(typeof $==="string"){if(!xQ(Y.mime,$))throw new N$(Q,$)}for(let W=0;W<$.length;W++)if(xQ(Y.mime,$[W]))return!0;throw new N$(Q,$)},FY=(Z,$)=>{if($ instanceof RQ)return!0;if(!($ instanceof Blob))return!1;if(Z.minSize&&$.size<k4(Z.minSize))return!1;if(Z.maxSize&&$.size>k4(Z.maxSize))return!1;if(Z.extension){if(typeof Z.extension==="string")return xQ($.type,Z.extension);for(let Q=0;Q<Z.extension.length;Q++)if(xQ($.type,Z.extension[Q]))return!0;return!1}return!0},k=Object.assign({},$6);mQ("UnionEnum",(Z,$)=>(typeof $==="number"||typeof $==="string"||$===null)&&Z.enum.includes($));var EL=mQ("Files",(Z,$)=>{if(!Array.isArray($))return FY(Z,$);if(Z.minItems&&$.length<Z.minItems)return!1;if(Z.maxItems&&$.length>Z.maxItems)return!1;for(let Q=0;Q<$.length;Q++)if(!FY(Z,$[Q]))return!1;return!0}),IL=mQ("ElysiaForm",({compiler:Z,...$},Q)=>{if(!(Q instanceof FormData))return!1;if(Z){if(!(ZZ in Q))throw new K0("property",$,Q);if(!Z.Check(Q[ZZ]))throw Z.Error(Q[ZZ])}return!0}),v8={String:(Z)=>$6.String(Z),Numeric:(Z)=>{let $=$6.Number(Z),Q=a6($);return k.Transform(k.Union([k.String({format:"numeric",default:0}),k.Number(Z)],Z)).Decode((Y)=>{let W=+Y;if(isNaN(W))return Y;if(Z&&!Q.Check(W))throw Q.Error(Y);return W}).Encode((Y)=>Y)},Integer:(Z)=>{let $=$6.Integer(Z),Q=a6($);return k.Transform(k.Union([k.String({format:"integer",default:0}),$6.Integer(Z)],Z)).Decode((Y)=>{let W=+Y;if(!Q.Check(W))throw Q.Error(W);return W}).Encode((Y)=>Y)},Date:(Z)=>{let $=$6.Date(Z),Q=a6($),Y=Z?.default?new Date(Z.default):void 0;return k.Transform(k.Union([$6.Date(Z),k.String({format:"date-time",default:Y?.toISOString()}),k.String({format:"date",default:Y?.toISOString()}),k.Number({default:Y?.getTime()})],Z)).Decode((W)=>{if(typeof W==="number"){let J=new Date(W);if(!Q.Check(J))throw Q.Error(J);return J}if(W instanceof Date)return W;let X=new Date(t4(W));if(!X||isNaN(X.getTime()))throw new K0("property",$,X);if(!Q.Check(X))throw Q.Error(X);return X}).Encode((W)=>W.toISOString())},BooleanString:(Z)=>{let $=$6.Boolean(Z),Q=a6($);return k.Transform(k.Union([k.Boolean(Z),k.String({format:"boolean",default:!1})],Z)).Decode((Y)=>{if(typeof Y==="string")return Y==="true";if(Y!==void 0&&!Q.Check(Y))throw Q.Error(Y);return Y}).Encode((Y)=>Y)},ObjectString:(Z,$)=>{let Q=k.Object(Z,$),Y=a6(Q),W=JSON.stringify(Y.Create());return k.Transform(k.Union([k.String({format:"ObjectString",default:W}),Q])).Decode((X)=>{if(typeof X==="string"){if(X.charCodeAt(0)!==123)throw new K0("property",Q,X);if(!Y.Check(X=OQ(X,Q)))throw Y.Error(X);return Y.Decode(X)}return X}).Encode((X)=>{let J;if(typeof X==="string")X=OQ(J=X,Q);if(!Y.Check(X))throw Y.Error(X);return J??JSON.stringify(X)})},ArrayString:(Z=k.String(),$)=>{let Q=k.Array(Z,$),Y=a6(Q),W=(X,J=!1)=>{if(X.charCodeAt(0)===91){if(!Y.Check(X=OQ(X,Q)))throw Y.Error(X);return Y.Decode(X)}if(X.indexOf(",")!==-1){if(!Y.Check(X))throw Y.Error(X);return Y.Decode(X)}if(J)return X;throw new K0("property",Q,X)};return k.Transform(k.Union([k.String({format:"ArrayString",default:$?.default}),Q])).Decode((X)=>{if(Array.isArray(X)){let J=[];for(let z=0;z<X.length;z++){let U=X[z];if(typeof U==="string"){let q=W(U,!0);if(Array.isArray(q))J=J.concat(q);else J.push(q);continue}J.push(U)}return J}if(typeof X==="string")return W(X);return X}).Encode((X)=>{let J;if(typeof X==="string")X=OQ(J=X,Q);if(!Y.Check(X))throw new K0("property",Q,X);return J??JSON.stringify(X)})},File:mQ("File",FY),Files:(Z={})=>k.Transform(EL(Z)).Decode(($)=>{if(Array.isArray($))return $;return[$]}).Encode(($)=>$),Nullable:(Z,$)=>k.Union([Z,k.Null()],$),MaybeEmpty:(Z,$)=>k.Union([Z,k.Null(),k.Undefined()],$),Cookie:(Z,{domain:$,expires:Q,httpOnly:Y,maxAge:W,path:X,priority:J,sameSite:z,secure:U,secrets:q,sign:G,...D}={})=>{let A=k.Object(Z,D);return A.config={domain:$,expires:Q,httpOnly:Y,maxAge:W,path:X,priority:J,sameSite:z,secure:U,secrets:q,sign:G},A},UnionEnum:(Z,$={})=>{let Q=Z.every((Y)=>typeof Y==="string")?{type:"string"}:Z.every((Y)=>typeof Y==="number")?{type:"number"}:Z.every((Y)=>Y===null)?{type:"null"}:{};if(Z.some((Y)=>typeof Y==="object"&&Y!==null))throw new Error("This type does not support objects or arrays");return{default:Z[0],...$,[S]:"UnionEnum",...Q,enum:Z}},NoValidate:(Z,$=!0)=>{return Z.noValidate=$,Z},Form:(Z,$={})=>{let Q=k.Object(Z,{default:CL({}),...$}),Y=a6(Q);return k.Union([Q,IL({compiler:Y})])}};k.BooleanString=v8.BooleanString;k.ObjectString=v8.ObjectString;k.ArrayString=v8.ArrayString;k.Numeric=v8.Numeric;k.Integer=v8.Integer;k.File=(Z)=>{if(Z?.type)bY();return v8.File({default:"File",...Z,extension:Z?.type,type:"string",format:"binary"})};k.Files=(Z)=>{if(Z?.type)bY();return v8.Files({...Z,elysiaMeta:"Files",default:"Files",extension:Z?.type,type:"array",items:{...Z,default:"Files",type:"string",format:"binary"}})};k.Nullable=(Z)=>v8.Nullable(Z);k.MaybeEmpty=v8.MaybeEmpty;k.Cookie=v8.Cookie;k.Date=v8.Date;k.UnionEnum=v8.UnionEnum;k.NoValidate=v8.NoValidate;k.Form=v8.Form;var bL=(Z)=>{if(Z.startsWith("async"))Z=Z.slice(5);Z=Z.trimStart();let $=-1;if(Z.charCodeAt(0)===40){if($=Z.indexOf("=>",Z.indexOf(")")),$!==-1){let W=$;while(W>0)if(Z.charCodeAt(--W)===41)break;let X=Z.slice($+2);if(X.charCodeAt(0)===32)X=X.trimStart();return[Z.slice(1,W),X,{isArrowReturn:X.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test(Z)){if($=Z.indexOf("=>"),$!==-1){let W=Z.slice($+2);if(W.charCodeAt(0)===32)W=W.trimStart();return[Z.slice(0,$),W,{isArrowReturn:W.charCodeAt(0)!==123}]}}if(Z.startsWith("function")){$=Z.indexOf("(");let W=Z.indexOf(")");return[Z.slice($+1,W),Z.slice(W+2),{isArrowReturn:!1}]}let Q=Z.indexOf("(");if(Q!==-1){let W=Z.indexOf(`
`,2),X=Z.slice(0,W),J=X.lastIndexOf(")")+1,z=Z.slice(W+1);return[X.slice(Q,J),"{"+z,{isArrowReturn:!1}]}let Y=Z.split(`
`,2);return[Y[0],Y[1],{isArrowReturn:!1}]},xL=(Z)=>{let $=Z.indexOf("{");if($===-1)return[-1,0];let Q=$+1,Y=1;for(;Q<Z.length;Q++){let W=Z.charCodeAt(Q);if(W===123)Y++;else if(W===125)Y--;if(Y===0)break}if(Y!==0)return[0,Z.length];return[$,Q+1]},TL=(Z)=>{let $=Z.lastIndexOf("}");if($===-1)return[-1,0];let Q=$-1,Y=1;for(;Q>=0;Q--){let W=Z.charCodeAt(Q);if(W===125)Y++;else if(W===123)Y--;if(Y===0)break}if(Y!==0)return[-1,0];return[Q,$+1]},W5=(Z)=>{while(!0){let $=Z.indexOf(":");if($===-1)break;let Q=Z.indexOf(",",$);if(Q===-1)Q=Z.indexOf("}",$)-1;if(Q===-2)Q=Z.length;Z=Z.slice(0,$)+Z.slice(Q)}return Z},X5=(Z)=>{let $=!1;if(Z.charCodeAt(0)===40)Z=Z.slice(1,-1);if(Z.charCodeAt(0)===123)$=!0,Z=Z.slice(1,-1);Z=Z.replace(/( |\t|\n)/g,"").trim();let Q=[];while(!0){let[W,X]=xL(Z);if(W===-1)break;if(Q.push(Z.slice(0,W-1)),Z.charCodeAt(X)===44)X++;Z=Z.slice(X)}if(Z=W5(Z),Z)Q=Q.concat(Z.split(","));let Y=Object.create(null);for(let W of Q){if(W.indexOf(",")===-1){Y[W]=!0;continue}for(let X of W.split(","))Y[X.trim()]=!0}return{hasParenthesis:$,parameters:Y}},kL=(Z,$)=>{let{parameters:Q,hasParenthesis:Y}=X5(Z);if(Q.query)$.query=!0;if(Q.headers)$.headers=!0;if(Q.body)$.body=!0;if(Q.cookie)$.cookie=!0;if(Q.set)$.set=!0;if(Q.server)$.server=!0;if(Q.route)$.route=!0;if(Q.url)$.url=!0;if(Q.path)$.path=!0;if(Y)return`{ ${Object.keys(Q).join(", ")} }`;return Object.keys(Q).join(", ")},f4=(Z,$,Q)=>{let Y=new RegExp(`${Z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}[\\n\\t,; ]`);if(Q!==void 0)Y.lastIndex=Q;let W=Y.exec($);return W?W.index:-1},J5=(Z,$,Q=0)=>{if(Q>5)return[];let Y=[],W=$;while(!0){let X=f4(" = "+Z,W);if(X===-1)X=f4("="+Z,W);if(X===-1){let q=W.indexOf(" = "+Z);if(q===-1)q=W.indexOf("="+Z);if(q+3+Z.length!==W.length)break;X=q}let J=W.slice(0,X),z=J.lastIndexOf(" "),U=J.slice(z!==-1?z+1:-1);if(U==="}"){let[q,G]=TL(J);Y.push(W5(W.slice(q,G))),W=W.slice(X+3+Z.length);continue}while(U.charCodeAt(0)===44)U=U.slice(1);while(U.charCodeAt(0)===9)U=U.slice(1);if(!U.includes("("))Y.push(U);W=W.slice(X+3+Z.length)}for(let X of Y){if(X.charCodeAt(0)===123)continue;let J=J5(X,$);if(J.length>0)Y.push(...J)}return Y},gL=(Z)=>{if(!Z)return;if(Z.charCodeAt(0)!==123)return Z;if(Z=Z.slice(2,-2),!Z.includes(",")){if(Z.indexOf("...")!==-1)return Z.slice(Z.indexOf("...")+3);return}let $=Z.indexOf("...");if($===-1)return;return Z.slice($+3).trimEnd()},fL=(Z,$,Q)=>{let Y=(W,X)=>new RegExp(`${X}\\.(${W})|${X}\\["${W}"\\]|${X}\\['${W}'\\]`).test(Z);for(let W of $){if(!W)continue;if(W.charCodeAt(0)===123){let X=X5(W).parameters;if(X.query)Q.query=!0;if(X.headers)Q.headers=!0;if(X.body)Q.body=!0;if(X.cookie)Q.cookie=!0;if(X.set)Q.set=!0;if(X.server)Q.server=!0;if(X.url)Q.url=!0;if(X.route)Q.route=!0;if(X.path)Q.path=!0;continue}if(!Q.query&&(Y("query",W)||Z.includes("return "+W)||Z.includes("return "+W+".query")))Q.query=!0;if(!Q.headers&&Y("headers",W))Q.headers=!0;if(!Q.body&&Y("body",W))Q.body=!0;if(!Q.cookie&&Y("cookie",W))Q.cookie=!0;if(!Q.set&&Y("set",W))Q.set=!0;if(!Q.server&&Y("server",W))Q.server=!0;if(!Q.route&&Y("route",W))Q.route=!0;if(!Q.url&&Y("url",W))Q.url=!0;if(!Q.path&&Y("path",W))Q.path=!0;if(Q.query&&Q.headers&&Q.body&&Q.cookie&&Q.set&&Q.server&&Q.route&&Q.url&&Q.path)break}return $},yL=(Z,$,Q)=>{try{let Y=new RegExp(`\\w\\((.*?)?${Z}`,"gs");Y.test($);let W=$.charCodeAt(Y.lastIndex);if(W===41||W===44)return Q.query=!0,Q.headers=!0,Q.body=!0,Q.cookie=!0,Q.set=!0,Q.server=!0,Q.url=!0,Q.route=!0,Q.path=!0,!0;return!1}catch(Y){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log($),console.log("--- context ---"),console.log(Z),!0}},FQ,PQ={},y4=(Z=0)=>{if(FQ)clearTimeout(FQ);FQ=setTimeout(()=>{if(PQ={},FQ=void 0,kZ)Bun.gc(!1)},Z)},_Y=(Z,$)=>{return{body:Z.body||$.body,cookie:Z.cookie||$.cookie,headers:Z.headers||$.headers,query:Z.query||$.query,set:Z.set||$.set,server:Z.server||$.server,url:Z.url||$.url,route:Z.route||$.route,path:Z.path||$.path}},S$=(Z,$={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,url:!1,route:!1,path:!1})=>{let Q=[];if(Z.request?.length)Q.push(...Z.request);if(Z.beforeHandle?.length)Q.push(...Z.beforeHandle);if(Z.parse?.length)Q.push(...Z.parse);if(Z.error?.length)Q.push(...Z.error);if(Z.transform?.length)Q.push(...Z.transform);if(Z.afterHandle?.length)Q.push(...Z.afterHandle);if(Z.mapResponse?.length)Q.push(...Z.mapResponse);if(Z.afterResponse?.length)Q.push(...Z.afterResponse);if(Z.handler&&typeof Z.handler==="function")Q.push(Z.handler);for(let Y=0;Y<Q.length;Y++){let W=Q[Y];if(!W)continue;let X=typeof W==="object"?W.fn:W;if(typeof X!=="function")continue;let J=X.toString(),z=bZ(J),U=PQ[z];if(U){$=_Y($,U);continue}let q={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,url:!1,route:!1,path:!1},[G,D]=bL(J),A=kL(G,q),H=gL(A);if(H){let M=J5(H,D.slice(1,-1));M.splice(0,-1,H);let L=D;if(L.charCodeAt(0)===123&&L.charCodeAt(D.length-1)===125)L=L.slice(1,-1);if(!yL(H,L,q))fL(L,M,q);if(!q.query&&L.includes("return "+H+".query"))q.query=!0}if(!PQ[z])PQ[z]=q;if($=_Y($,q),$.query&&$.headers&&$.body&&$.cookie&&$.set&&$.server&&$.url&&$.route&&$.path)break}return $},z5=dQ(tA(),1),dL=dQ(jY(),1);class B6{name;jar;initial;constructor(Z,$,Q={}){this.name=Z,this.jar=$,this.initial=Q}get cookie(){return this.jar[this.name]??this.initial}set cookie(Z){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=Z}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie(Z){this.cookie=Z}get value(){return this.cookie.value}set value(Z){this.setCookie.value=Z}get expires(){return this.cookie.expires}set expires(Z){this.setCookie.expires=Z}get maxAge(){return this.cookie.maxAge}set maxAge(Z){this.setCookie.maxAge=Z}get domain(){return this.cookie.domain}set domain(Z){this.setCookie.domain=Z}get path(){return this.cookie.path}set path(Z){this.setCookie.path=Z}get secure(){return this.cookie.secure}set secure(Z){this.setCookie.secure=Z}get httpOnly(){return this.cookie.httpOnly}set httpOnly(Z){this.setCookie.httpOnly=Z}get sameSite(){return this.cookie.sameSite}set sameSite(Z){this.setCookie.sameSite=Z}get priority(){return this.cookie.priority}set priority(Z){this.setCookie.priority=Z}get partitioned(){return this.cookie.partitioned}set partitioned(Z){this.setCookie.partitioned=Z}get secrets(){return this.cookie.secrets}set secrets(Z){this.setCookie.secrets=Z}update(Z){return this.setCookie=Object.assign(this.cookie,typeof Z==="function"?Z(this.cookie):Z),this}set(Z){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof Z==="function"?Z(this.cookie):Z),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var d4=(Z,$,Q)=>{if(!Z.cookie)Z.cookie={};return new Proxy($,{get(Y,W){if(W in $)return new B6(W,Z.cookie,Object.assign({},Q??{},$[W]));return new B6(W,Z.cookie,Object.assign({},Q))}})},U5=async(Z,$,{secrets:Q,sign:Y,...W}={})=>{if(!$)return d4(Z,{},W);let X=typeof Q==="string";if(Y&&Y!==!0&&!Array.isArray(Y))Y=[Y];let J={},z=z5.parse($);for(let[U,q]of Object.entries(z)){if(q===void 0)continue;let G=dL.default(q);if(Y===!0||Y?.includes(U)){if(!Q)throw new Error("No secret is provided to cookie plugin");if(X){let D=await V4(G,Q);if(D===!1)throw new OY(U);G=D}else{let D=!0;for(let A=0;A<Q.length;A++){let H=await V4(G,Q[A]);if(H!==!1){D=!0,G=H;break}}if(!D)throw new OY(U)}}J[U]={value:G}}return d4(Z,J,W)},q5=(Z)=>{if(!Z||!I0(Z))return;let $=[];for(let[Q,Y]of Object.entries(Z)){if(!Q||!Y)continue;let W=Y.value;if(W===void 0||W===null)continue;$.push(z5.serialize(Q,typeof W==="object"?JSON.stringify(W):W+"",Y))}if($.length===0)return;if($.length===1)return $[0];return $},f0=(Z,$)=>{if(!kZ&&Z instanceof Promise)return Z.then((Y)=>f0(Y,$));let Q=Z.size;if(!$&&Q||Q&&$&&$.status!==206&&$.status!==304&&$.status!==412&&$.status!==416){if($){if($.headers instanceof Headers){let Y={"accept-ranges":"bytes","content-range":`bytes 0-${Q-1}/${Q}`,"transfer-encoding":"chunked"};if(VQ)Y=$.headers.toJSON();else{Y={};for(let[W,X]of $.headers.entries())if(W in $.headers)Y[W]=X}return new Response(Z,{status:$.status,headers:Y})}if(I0($.headers))return new Response(Z,{status:$.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${Q-1}/${Q}`,"transfer-encoding":"chunked"},$.headers)})}return new Response(Z,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${Q-1}/${Q}`,"transfer-encoding":"chunked"}})}return new Response(Z)},G5=(Z,$)=>{if(!Z)return Z;Z.delete("set-cookie");for(let Q=0;Q<$.length;Q++){let Y=$[Q].indexOf("=");Z.append("set-cookie",`${$[Q].slice(0,Y)}=${$[Q].slice(Y+1)||""}`)}return Z},T6=(Z,$)=>{if($?.headers){if(Z){if(VQ)Object.assign($.headers,Z.headers.toJSON());else for(let[Q,Y]of Z.headers.entries())if(Q in $.headers)$.headers[Q]=Y}if($.status===200)$.status=Z.status;if($.headers["content-encoding"])delete $.headers["content-encoding"];return $}if(!Z)return{headers:{},status:$?.status??200};if(VQ){if($={headers:Z.headers.toJSON(),status:$?.status??200},$.headers["content-encoding"])delete $.headers["content-encoding"];return $}$={headers:{},status:$?.status??200};for(let[Q,Y]of Z.headers.entries()){if(Q==="content-encoding")continue;if(Q in $.headers)$.headers[Q]=Y}return $},xY=({mapResponse:Z,mapCompactResponse:$})=>async(Q,Y,W)=>{let X=Q.next();if(X instanceof Promise)X=await X;if(X.done){if(Y)return Z(X.value,Y,W);return $(X.value,W)}if(Y?.headers){if(!Y.headers["transfer-encoding"])Y.headers["transfer-encoding"]="chunked";if(!Y.headers["content-type"])Y.headers["content-type"]="text/event-stream; charset=utf-8"}else Y={status:200,headers:{"content-type":"text/event-stream; charset=utf-8","transfer-encoding":"chunked"}};return new Response(new ReadableStream({async start(J){let z=!1;if(W?.signal?.addEventListener("abort",()=>{z=!0;try{J.close()}catch{}}),X.value!==void 0&&X.value!==null)if(typeof X.value==="object")try{J.enqueue(Buffer.from(JSON.stringify(X.value)))}catch{J.enqueue(Buffer.from(X.value.toString()))}else J.enqueue(Buffer.from(X.value.toString()));for await(let U of Q){if(z)break;if(U===void 0||U===null)continue;if(typeof U==="object")try{J.enqueue(Buffer.from(JSON.stringify(U)))}catch{J.enqueue(Buffer.from(U.toString()))}else J.enqueue(Buffer.from(U.toString()));await new Promise((q)=>setTimeout(()=>q(),0))}try{J.close()}catch{}}}),Y)};async function*k6(Z){let $=Z.body;if(!$)return;let Q=$.getReader(),Y=new TextDecoder;try{while(!0){let{done:W,value:X}=await Q.read();if(W)break;yield Y.decode(X)}}finally{Q.releaseLock()}}var cQ=(Z)=>{if(typeof Z.status==="string")Z.status=vQ[Z.status];if(Z.cookie&&I0(Z.cookie)){let $=q5(Z.cookie);if($)Z.headers["set-cookie"]=$}if(Z.headers["set-cookie"]&&Array.isArray(Z.headers["set-cookie"]))Z.headers=G5(new Headers(Z.headers),Z.headers["set-cookie"])},M5=(Z)=>{let $=xY(Z);return(Q,Y,W)=>{let X=!1;if(Y.headers instanceof Headers)for(let z of Y.headers.keys())if(z==="set-cookie"){if(X)continue;X=!0;for(let U of Y.headers.getSetCookie())Q.headers.append("set-cookie",U)}else Q.headers.append(z,Y.headers?.get(z)??"");else for(let z in Y.headers)Q.headers.append(z,Y.headers[z]);let J=Y.status??200;if(Q.status!==J&&J!==200&&(Q.status<=300||Q.status>400))return Q.text().then((z)=>{let U=new Response(z,{headers:Q.headers,status:Y.status});if(!U.headers.has("content-length")&&U.headers.get("transfer-encoding")==="chunked")return $(k6(U),T6(U,Y),W);return U});if(!Q.headers.has("content-length")&&Q.headers.get("transfer-encoding")==="chunked")return $(k6(Q),T6(Q,Y),W);return Q}},y8=(Z,$,Q)=>{if(I0($.headers)||$.status!==200||$.cookie)switch(cQ($),Z?.constructor?.name){case"String":return $.headers["content-type"]="text/plain",new Response(Z,$);case"Array":case"Object":return $.headers["content-type"]="application/json",new Response(JSON.stringify(Z),$);case"ElysiaFile":return f0(Z.value);case"File":return f0(Z,$);case"Blob":return f0(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,y8(Z.response,$,Q);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Q?.signal?.addEventListener("abort",{handleEvent(){if(Q?.signal&&!Q?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return new Response("",$);return new Response(JSON.stringify(Z),$);case"Response":return kQ(Z,$,Q);case"Error":return E6(Z,$);case"Promise":return Z.then((Y)=>y8(Y,$,Q));case"Function":return y8(Z(),$,Q);case"Number":case"Boolean":return new Response(Z.toString(),$);case"Cookie":if(Z instanceof B6)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z,$);default:if(Z instanceof Response)return kQ(Z,$,Q);if(Z instanceof Promise)return Z.then((Y)=>y8(Y,$));if(Z instanceof Error)return E6(Z,$);if(Z instanceof K8)return $.status=Z.code,y8(Z.response,$,Q);if(typeof Z?.next==="function")return b6(Z,$,Q);if(typeof Z?.then==="function")return Z.then((Y)=>y8(Y,$));if(typeof Z?.toResponse==="function")return y8(Z.toResponse(),$);if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}if(Z instanceof Response&&!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return b6(k6(Z),T6(Z,$),Q);if(typeof Z?.next==="function"||Z instanceof ReadableStream)return b6(Z,$,Q);return G6(Z,Q)},k8=(Z,$,Q)=>{if(Z===void 0||Z===null)return;if(I0($.headers)||$.status!==200||$.cookie)switch(cQ($),Z?.constructor?.name){case"String":return $.headers["content-type"]="text/plain",new Response(Z,$);case"Array":case"Object":return $.headers["content-type"]="application/json",new Response(JSON.stringify(Z),$);case"ElysiaFile":return f0(Z.value);case"File":return f0(Z,$);case"Blob":return f0(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,k8(Z.response,$,Q);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Q?.signal?.addEventListener("abort",{handleEvent(){if(Q?.signal&&!Q?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return;return new Response(JSON.stringify(Z),$);case"Response":return kQ(Z,$,Q);case"Promise":return Z.then((Y)=>k8(Y,$));case"Error":return E6(Z,$);case"Function":return k8(Z(),$);case"Number":case"Boolean":return new Response(Z.toString(),$);case"FormData":return new Response(Z);case"Cookie":if(Z instanceof B6)return new Response(Z.value,$);return new Response(Z?.toString(),$);default:if(Z instanceof Response)return kQ(Z,$,Q);if(Z instanceof Promise)return Z.then((Y)=>k8(Y,$));if(Z instanceof Error)return E6(Z,$);if(Z instanceof K8)return $.status=Z.code,k8(Z.response,$,Q);if(typeof Z?.next==="function")return b6(Z,$,Q);if(typeof Z?.then==="function")return Z.then((Y)=>k8(Y,$));if(typeof Z?.toResponse==="function")return k8(Z.toResponse(),$);if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}else switch(Z?.constructor?.name){case"String":return $.headers["content-type"]="text/plain",new Response(Z);case"Array":case"Object":return $.headers["content-type"]="application/json",new Response(JSON.stringify(Z),$);case"ElysiaFile":return f0(Z.value);case"File":return f0(Z,$);case"Blob":return f0(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,k8(Z.response,$,Q);case"ReadableStream":return Q?.signal?.addEventListener("abort",{handleEvent(){if(Q?.signal&&!Q?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return b6(k6(Z),T6(Z),Q);return Z;case"Promise":return Z.then((Y)=>{let W=k8(Y,$);if(W!==void 0)return W});case"Error":return E6(Z,$);case"Function":return G6(Z(),Q);case"Number":case"Boolean":return new Response(Z.toString());case"Cookie":if(Z instanceof B6)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Y)=>k8(Y,$));if(Z instanceof Error)return E6(Z,$);if(Z instanceof K8)return $.status=Z.code,k8(Z.response,$,Q);if(typeof Z?.next==="function")return b6(Z,$,Q);if(typeof Z?.then==="function")return Z.then((Y)=>k8(Y,$));if(typeof Z?.toResponse==="function")return k8(Z.toResponse(),$);if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z)}},G6=(Z,$)=>{switch(Z?.constructor?.name){case"String":return new Response(Z,{headers:{"Content-Type":"text/plain"}});case"Object":case"Array":return new Response(JSON.stringify(Z),{headers:{"Content-Type":"application/json"}});case"ElysiaFile":return f0(Z.value);case"File":return f0(Z);case"Blob":return f0(Z);case"ElysiaCustomStatusResponse":return y8(Z.response,{status:Z.code,headers:{}});case"ReadableStream":return $?.signal?.addEventListener("abort",{handleEvent(){if($?.signal&&!$?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(Z.headers.get("transfer-encoding")==="chunked")return b6(k6(Z),T6(Z),$);return Z;case"Error":return E6(Z);case"Promise":return Z.then((Q)=>G6(Q,$));case"Function":return G6(Z(),$);case"Number":case"Boolean":return new Response(Z.toString());case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Q)=>G6(Q,$));if(Z instanceof Error)return E6(Z);if(Z instanceof K8)return y8(Z.response,{status:Z.code,headers:{}});if(typeof Z?.next==="function")return b6(Z,void 0,$);if(typeof Z?.then==="function")return Z.then((Q)=>y8(Q,set));if(typeof Z?.toResponse==="function")return G6(Z.toResponse());if("charCodeAt"in Z){let Q=Z.charCodeAt(0);if(Q===123||Q===91)return new Response(JSON.stringify(Z),{headers:{"Content-Type":"application/json"}})}return new Response(Z)}},E6=(Z,$)=>new Response(JSON.stringify({name:Z?.name,message:Z?.message,cause:Z?.cause}),{status:$?.status!==200?$?.status??500:500,headers:$?.headers}),vL=(Z,$,Q={})=>{if(typeof Z==="function")return;let Y=y8(Z,{headers:Q});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length)return Y.clone.bind(Y)},kQ=M5({mapResponse:y8,mapCompactResponse:G6}),b6=xY({mapResponse:y8,mapCompactResponse:G6}),PY={name:"web-standard",isWebStandard:!0,handler:{mapResponse:y8,mapEarlyResponse:k8,mapCompactResponse:G6,createStaticHandler:vL},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers={}
for(const [k,v] of c.request.headers.entries())c.headers[k]=v
`,parser:{json(Z){if(Z)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData(Z){let $=`
c.body={}
`;if(Z)$+="let form;try{form=await c.request.formData()}catch{}";else $+=`const form=await c.request.formData()
`;return $+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},composeGeneralHandler:{parameters:"r",createContext(Z){let $="",Q="",Y=Z.setHeaders;for(let J of Object.keys(Z.decorator))$+=`,'${J}':decorator['${J}']`;let W=Z.config.handler?.standardHostname??!0,X=!!Z.event.trace?.length;if(Q+=`const u=r.url,s=u.indexOf('/',${W?11:7}),qi=u.indexOf('?',s+1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,X)Q+=`const id=randomId()
`;if(Q+="const c={request:r,store,qi,path:p,url:u,redirect,error:status,status,set:{headers:",Q+=Object.keys(Y??{}).length?"Object.assign({},app.setHeaders)":"Object.create(null)",Q+=",status:200}",Z.inference.server)Q+=",get server(){return app.getServer()}";if(X)Q+=",[ELYSIA_REQUEST_ID]:id";return Q+=$,Q+=`}
`,Q},error404(Z,$){let Q="if(route===null)return ";if($)Q+=`app.handleError(c,notFound,false,${this.parameters})`;else Q+=Z?"new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"error404.clone()";return{declare:$?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:Q}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw new Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}},hL=dQ(jY(),1),gQ=dQ(jY(),1);function mL(Z,$=0){let Q=Object.create(null),Y=1,W=2,X=4,J=8,z=0,U=$-1,q=U,G=Z.length;for(let A=$;A<G;A++)switch(Z.charCodeAt(A)){case 38:D(A),U=A,q=A,z=0;break;case 61:if(q<=U)q=A;else z|=8;break;case 43:if(q>U)z|=4;else z|=1;break;case 37:if(q>U)z|=8;else z|=2;break}return D(G),Q;function D(A){let H=q>U,M=H?q:A;if(M<=U+1)return;let L=Z.slice(U+1,M);if(z&1)L=L.replace(/\+/g," ");if(z&2)L=gQ.default(L)||L;if(Q[L]!==void 0)return;let O="";if(H){if(O=Z.slice(q+1,A),z&4)O=O.replace(/\+/g," ");if(z&8)O=gQ.default(O)||O}Q[L]=O}}function KQ(Z){let $=Object.create(null),Q=0,Y=1,W=2,X=4,J=8,z=Z.length,U=-1,q=-1;for(let D=0;D<z;D++)switch(Z.charCodeAt(D)){case 38:G(Z,D),U=D,q=D,Q=0;break;case 61:if(q<=U)q=D;else Q|=J;break;case 43:if(q>U)Q|=X;else Q|=Y;break;case 37:if(q>U)Q|=J;else Q|=W;break}if(U<z)G(Z,z);return $;function G(D,A){let H=q>U,M=H?q:A,L=D.slice(U+1,M);if(!H&&L.length===0)return;let O=L;if(Q&Y)O=O.replace(/\+/g," ");if(Q&W)O=gQ.default(O)||O;let m="";if(H){let b=D.slice(q+1,A);if(Q&X)b=b.replace(/\+/g," ");if(Q&J)b=gQ.default(b)||b;m=b}let _=$[O];if(_===void 0)$[O]=m;else if(Array.isArray(_))_.push(m);else $[O]=[_,m]}}var uQ=Symbol("ElysiaTrace"),z6=()=>{let{promise:Z,resolve:$}=Promise.withResolvers(),{promise:Q,resolve:Y}=Promise.withResolvers(),{promise:W,resolve:X}=Promise.withResolvers(),J=[],z=[];return[(U)=>{if(U)J.push(U);return Z},(U)=>{let q=[],G=[],D=null;for(let H=0;H<(U.total??0);H++){let{promise:M,resolve:L}=Promise.withResolvers(),{promise:O,resolve:m}=Promise.withResolvers(),{promise:_,resolve:b}=Promise.withResolvers(),l=[],t=[];q.push((T)=>{if(T)l.push(T);return M}),G.push((T)=>{let x={...T,end:O,error:_,index:H,onStop(d){if(d)t.push(d);return O}};L(x);for(let d=0;d<l.length;d++)l[d](x);return(d=null)=>{let j=performance.now();if(d)D=d;let p={end:j,error:d,get elapsed(){return j-T.begin}};for(let Z0=0;Z0<t.length;Z0++)t[Z0](p);m(j),b(d)}})}let A={...U,end:Q,error:W,onEvent(H){for(let M=0;M<q.length;M++)q[M](H)},onStop(H){if(H)z.push(H);return Q}};$(A);for(let H=0;H<J.length;H++)J[H](A);return{resolveChild:G,resolve(H=null){let M=performance.now();if(!H&&D)H=D;let L={end:M,error:H,get elapsed(){return M-U.begin}};for(let O=0;O<z.length;O++)z[O](L);Y(M),X(H)}}}]},cL=(Z)=>{return($)=>{let[Q,Y]=z6(),[W,X]=z6(),[J,z]=z6(),[U,q]=z6(),[G,D]=z6(),[A,H]=z6(),[M,L]=z6(),[O,m]=z6(),[_,b]=z6();return Z({id:$[O$],context:$,set:$.set,onRequest:Q,onParse:W,onTransform:J,onBeforeHandle:U,onHandle:G,onAfterHandle:A,onMapResponse:O,onAfterResponse:_,onError:M,time:Date.now(),store:$.store}),{request:Y,parse:X,transform:z,beforeHandle:q,handle:D,afterHandle:H,error:L,mapResponse:m,afterResponse:b}}},d8=Symbol.for("TypeBox.Kind"),uL=Symbol.for("TypeBox.Hint"),B5=(Z)=>/(\ |-|\t|\n)/.test(Z),H5=(Z,$,Q=!1)=>{if(typeof $==="number")return`${Z}[${$}]`;if(B5($))return`${Z}${Q?"?.":""}["${$}"]`;return`${Z}${Q?"?":""}.${$}`},pL=(Z)=>B5(Z)?`"${Z}"`:Z,v4=(Z,$=0,Q)=>{if(Q.type!=="string"||Q.const||Q.trusted)return Z;let Y="";for(let W=$-1;W>=0;W--)Y+=`d.h${W}(`;return Y+Z+")".repeat($)},D5=(Z)=>{if(!Z.allOf||d8 in Z&&(Z[d8]!=="Intersect"||Z.type!=="object"))return Z;let{allOf:$,...Q}=Z;if(Q.properties={},d8 in Q)Q[d8]="Object";for(let Y of $){if(Y.type!=="object")continue;let{properties:W,required:X,type:J,[d8]:z,...U}=Y;if(X)Q.required=Q.required?Q.required.concat(X):X;Object.assign(Q,U);for(let q in Y.properties)Q.properties[q]=D5(Y.properties[q])}return Q},iL=(Z,$,Q)=>{let Y=Z.patternProperties["^(.*)$"]??Z.patternProperties[Object.keys(Z.patternProperties)[0]];if(!Y)return $;let W=Q.array;return Q.array++,`(()=>{const ar${W}s=Object.keys(${$}),ar${W}v={};for(let i=0;i<ar${W}s.length;i++){const ar${W}p=${$}[ar${W}s[i]];ar${W}v[ar${W}s[i]]=${U6(Y,`ar${W}p`,Q)}}return ar${W}v})()`},lL=(Z,$,Q)=>{let Y=Q.array;Q.array++;let W=$==="v"&&!Q.unions.length,X="";if(!W)X="(()=>{";X+=`const ar${Y}v=[`;for(let J=0;J<Z.length;J++){if(J!==0)X+=",";X+=U6(Z[J],H5($,J,Q.parentIsOptional),Q)}if(X+="];",!W)X+=`return ar${Y}v})()`;return X};function fQ(Z,$=new WeakMap){if(Z===null||typeof Z!=="object"||typeof Z==="function")return Z;if($.has(Z))return $.get(Z);if(Array.isArray(Z)){let Q=new Array(Z.length);$.set(Z,Q);for(let Y=0;Y<Z.length;Y++)Q[Y]=fQ(Z[Y],$);return Q}if(typeof Z==="object"){let Q=Object.keys(Z).concat(Object.getOwnPropertySymbols(Z)),Y={};for(let W of Q)Y[W]=fQ(Z[W],$);return Y}return Z}var nL=(Z,$,Q)=>{if(Q.TypeCompiler===void 0){if(!Q.typeCompilerWanred)console.warn(new Error("[exact-mirror] TypeBox's TypeCompiler is required to use Union")),Q.typeCompilerWanred=!0;return $}Q.unionKeys[$]=1;let Y=Q.unions.length,W=Q.unions[Y]=[],X=`(()=>{
`,J=(z)=>{if(!(d8 in z)||!z.$ref)return z;if(z[d8]==="This")return fQ(Q.definitions[z.$ref]);else if(z[d8]==="Ref")if(!Q.modules)console.warn(new Error("[exact-mirror] modules is required when using nested cyclic reference"));else return Q.modules.Import(z.$ref);return z};for(let z=0;z<Z.length;z++){let U=J(Z[z]);if(Array.isArray(U.anyOf))for(let q=0;q<U.anyOf.length;q++)U.anyOf[q]=J(U.anyOf[q]);else if(U.items)if(Array.isArray(U.items))for(let q=0;q<U.items.length;q++)U.items[q]=J(U.items[q]);else U.items=J(U.items);W.push(f1.Compile(U)),X+=`if(d.unions[${Y}][${z}].Check(${$})){return ${U6(U,$,{...Q,recursion:Q.recursion+1,parentIsOptional:!0})}}
`}return X+=`return ${Q.removeUnknownUnionType?"undefined":$}})()`,X},U6=(Z,$,Q)=>{if(!Z)return"";let Y=$==="v"&&!Q.unions.length;if(d8 in Z&&Z[d8]==="Import"&&Z.$ref in Z.$defs)return U6(Z.$defs[Z.$ref],$,{...Q,definitions:Object.assign(Q.definitions,Z.$defs)});if(Y&&Z.type!=="object"&&Z.type!=="array"&&!Z.anyOf)return`return ${v4("v",Q.sanitize?.length,Z)}`;if(Q.recursion>=Q.recursionLimit)return $;let W="";if(Z.$id&&uL in Z)Q.definitions[Z.$id]=Z;switch(Z.type){case"object":if(Z[d8]==="Record"){W=iL(Z,$,Q);break}if(Z=D5(Z),W+="{",Z.additionalProperties)W+=`...${$}`;let X=Object.keys(Z.properties);for(let q=0;q<X.length;q++){let G=X[q],D=Z.required&&!Z.required.includes(G)||Array.isArray(Z.properties[G].anyOf),A=H5($,G,Q.parentIsOptional);if(D){let M=Q.array;if($.startsWith("ar")){let L=A.slice(A.indexOf(".")+1),O=Q.optionalsInArray;if(O[M])O[M].push(L);else O[M]=[L]}else Q.optionals.push(A)}let H=Z.properties[G];if(Z.additionalProperties&&H.type!=="object")continue;if(q!==0)W+=",";W+=`${pL(G)}:${D?`${A}===undefined?undefined:`:""}${U6(H,A,{...Q,recursion:Q.recursion+1,parentIsOptional:D})}`}W+="}";break;case"array":if(Z.items.type!=="object"&&Z.items.type!=="array")if(Array.isArray(Z.items)){W=lL(Z.items,$,Q);break}else if(Y)return"return v";else if(d8 in Z.items&&Z.items.$ref&&(Z.items[d8]==="Ref"||Z.items[d8]==="This"))W=U6(fQ(Q.definitions[Z.items.$ref]),$,{...Q,parentIsOptional:!0,recursion:Q.recursion+1});else{W=$;break}let J=Q.array;Q.array++;let z=$;if(Y)W=`const ar${J}v=new Array(${$}.length);`;else z=`ar${J}s`,W=`((${z})=>{const ar${J}v=new Array(${z}.length);`;W+=`for(let i=0;i<${z}.length;i++){const ar${J}p=${z}[i];ar${J}v[i]=${U6(Z.items,`ar${J}p`,Q)}`;let U=Q.optionalsInArray[J+1];if(U)for(let q=0;q<U.length;q++){let G=`ar${J}v[i].${U[q]}`;W+=`;if(${G}===undefined)delete ${G}`}if(W+="}",!Y)W+=`return ar${J}v})(${$})`;break;default:if(Z.$ref&&Z.$ref in Q.definitions)return U6(Q.definitions[Z.$ref],$,Q);if(Array.isArray(Z.anyOf)){W=nL(Z.anyOf,$,Q);break}W=v4($,Q.sanitize?.length,Z);break}if(!Y)return W;if(Z.type==="array")return`${W}return ar0v`;W=`const x=${W}
`;for(let X=0;X<Q.optionals.length;X++){let J=Q.optionals[X],z=J.slice(1);if(W+=`if(${J}===undefined`,Q.unionKeys[J])W+=`||x${z}===undefined`;W+=`)delete x${z.charCodeAt(0)!==63?"?":""}${z}
`}return`${W}return x`},h4=(Z,{TypeCompiler:$,modules:Q,definitions:Y,sanitize:W,recursionLimit:X=8,removeUnknownUnionType:J=!1}={})=>{let z=[];if(typeof W==="function")W=[W];let U=U6(Z,"v",{optionals:[],optionalsInArray:[],array:0,parentIsOptional:!1,unions:z,unionKeys:{},TypeCompiler:$,modules:Q,definitions:Y??Q?.$defs??{},sanitize:W,recursion:0,recursionLimit:X,removeUnknownUnionType:J});if(!z.length&&!W?.length)return Function("v",U);let q;if(W?.length){q={};for(let G=0;G<W.length;G++)q[`h${G}`]=W[G]}return Function("d",`return function mirror(v){${U}}`)({unions:z,...q})},KY=(Z)=>{if(!Z)return!1;if(Z?.[S]==="Import"&&Z.References)return Z.References().some(KY);if(Z.schema)Z=Z.schema;return!!Z&&n0 in Z},y1=(Z)=>{if(!Z)return!1;let $=Z?.schema??Z;if($[S]==="Import"&&Z.References)return Z.References().some(y1);if($.anyOf)return $.anyOf.some(y1);if($.someOf)return $.someOf.some(y1);if($.allOf)return $.allOf.some(y1);if($.not)return $.not.some(y1);if($.type==="object"){let Q=$.properties;if("additionalProperties"in $)return $.additionalProperties;if("patternProperties"in $)return!1;for(let Y of Object.keys(Q)){let W=Q[Y];if(W.type==="object"){if(y1(W))return!0}else if(W.anyOf){for(let X=0;X<W.anyOf.length;X++)if(y1(W.anyOf[X]))return!0}return W.additionalProperties}return!1}if($.type==="array"&&$.items&&!Array.isArray($.items))return y1($.items);return!1},V6=(Z,$)=>{if(!$)return!1;if(S in $&&$[S]===Z)return!0;if($.type==="object"){let Q=$.properties;if(!Q)return!1;for(let Y of Object.keys(Q)){let W=Q[Y];if(W.type==="object"){if(V6(Z,W))return!0}else if(W.anyOf){for(let X=0;X<W.anyOf.length;X++)if(V6(Z,W.anyOf[X]))return!0}if(S in W&&W[S]===Z)return!0}return!1}return!!$.properties&&S in $.properties&&$.properties[S]===Z},w$=(Z,$)=>{if(!$)return;let Q=$.schema??$;if(Q[S]==="Import"&&$.References)return $.References().some((Y)=>w$(Z,Y));if(Q.type==="object"){let Y=Q.properties;if(!Y)return!1;for(let W of Object.keys(Y)){let X=Y[W];if(Z in X)return!0;if(X.type==="object"){if(w$(Z,X))return!0}else if(X.anyOf){for(let J=0;J<X.anyOf.length;J++)if(w$(Z,X.anyOf[J]))return!0}}return!1}return Z in Q},d1=(Z)=>{if(!Z)return!1;if(Z.oneOf){for(let $=0;$<Z.oneOf.length;$++)if(d1(Z.oneOf[$]))return!0}if(Z.anyOf){for(let $=0;$<Z.anyOf.length;$++)if(d1(Z.anyOf[$]))return!0}if(Z.oneOf){for(let $=0;$<Z.oneOf.length;$++)if(d1(Z.oneOf[$]))return!0}if(Z.allOf){for(let $=0;$<Z.allOf.length;$++)if(d1(Z.allOf[$]))return!0}if(Z.not&&d1(Z.not))return!0;if(Z.type==="object"&&Z.properties){let $=Z.properties;for(let Q of Object.keys($)){let Y=$[Q];if(d1(Y))return!0;if(Y.type==="array"&&Y.items&&d1(Y.items))return!0}}if(Z.type==="array"&&Z.items&&d1(Z.items))return!0;return Z[S]==="Ref"&&"$ref"in Z},C1=(Z)=>{if(!Z)return!1;if(Z.$ref&&Z.$defs&&Z.$ref in Z.$defs&&C1(Z.$defs[Z.$ref]))return!0;if(Z.oneOf){for(let $=0;$<Z.oneOf.length;$++)if(C1(Z.oneOf[$]))return!0}if(Z.anyOf){for(let $=0;$<Z.anyOf.length;$++)if(C1(Z.anyOf[$]))return!0}if(Z.allOf){for(let $=0;$<Z.allOf.length;$++)if(C1(Z.allOf[$]))return!0}if(Z.not&&C1(Z.not))return!0;if(Z.type==="object"&&Z.properties){let $=Z.properties;for(let Q of Object.keys($)){let Y=$[Q];if(C1(Y))return!0;if(Y.type==="array"&&Y.items&&C1(Y.items))return!0}}if(Z.type==="array"&&Z.items&&C1(Z.items))return!0;return P0 in Z},m4=(Z,$,Q={})=>{let Y=Q;if(Y.root=!0,!Array.isArray($))return $.original=Z,q8(Z,$,Y);for(let W of $)W.original=Z,Z=q8(Z,W,Y);return Z},q8=(Z,$,Q)=>{if(!Z)return Z;let Y=Q.root;if($.untilObjectFound&&!Y&&Z.type==="object")return Z;let W=$.from[S];if(Z.oneOf){for(let z=0;z<Z.oneOf.length;z++)Z.oneOf[z]=q8(Z.oneOf[z],$,Q);return Z}if(Z.anyOf){for(let z=0;z<Z.anyOf.length;z++)Z.anyOf[z]=q8(Z.anyOf[z],$,Q);return Z}if(Z.allOf){for(let z=0;z<Z.allOf.length;z++)Z.allOf[z]=q8(Z.allOf[z],$,Q);return Z}if(Z.not)return q8(Z.not,$,Q);let X=Y&&!!$.excludeRoot;if(Z[S]===W){let{anyOf:z,oneOf:U,allOf:q,not:G,properties:D,items:A,...H}=Z,M=$.to(H);if(!M)return Z;let L,O=(_)=>{let b=m(_);if(b.$id)delete b.$id;return b},m=(_)=>{if(D&&_.type==="object"){let l={};for(let[t,T]of Object.entries(D))l[t]=q8(T,$,{...Q,root:!1});return{...H,..._,properties:l}}if(A&&_.type==="array")return{...H,..._,items:q8(A,$,{...Q,root:!1})};let b={...H,..._};if(delete b.required,D&&_.type==="string"&&_.format==="ObjectString"&&_.default==="{}")L=k.ObjectString(D,H),b.default=JSON.stringify(A0.Create(k.Object(D))),b.properties=D;if(A&&_.type==="string"&&_.format==="ArrayString"&&_.default==="[]")L=k.ArrayString(A,H),b.default=JSON.stringify(A0.Create(k.Array(A))),b.items=A;return b};if(X){if(D){let _={};for(let[b,l]of Object.entries(D))_[b]=q8(l,$,{...Q,root:!1});return{...H,properties:_}}else if(A?.map)return{...H,items:A.map((_)=>q8(_,$,{...Q,root:!1}))};return H}if(M.anyOf)for(let _=0;_<M.anyOf.length;_++)M.anyOf[_]=O(M.anyOf[_]);else if(M.oneOf)for(let _=0;_<M.oneOf.length;_++)M.oneOf[_]=O(M.oneOf[_]);else if(M.allOf)for(let _=0;_<M.allOf.length;_++)M.allOf[_]=O(M.allOf[_]);else if(M.not)M.not=O(M.not);if(L)M[P0]=L[P0];if(M.anyOf||M.oneOf||M.allOf||M.not)return M;if(D){let _={};for(let[b,l]of Object.entries(D))_[b]=q8(l,$,{...Q,root:!1});return{...H,...M,properties:_}}else if(A?.map)return{...H,...M,items:A.map((_)=>q8(_,$,{...Q,root:!1}))};return{...H,...M}}let J=Z?.properties;if(J&&Y&&$.rootOnly!==!0)for(let[z,U]of Object.entries(J))switch(U[S]){case W:let{anyOf:q,oneOf:G,allOf:D,not:A,type:H,...M}=U,L=$.to(M);if(!L)return Z;if(L.anyOf)for(let O=0;O<L.anyOf.length;O++)L.anyOf[O]={...M,...L.anyOf[O]};else if(L.oneOf)for(let O=0;O<L.oneOf.length;O++)L.oneOf[O]={...M,...L.oneOf[O]};else if(L.allOf)for(let O=0;O<L.allOf.length;O++)L.allOf[O]={...M,...L.allOf[O]};else if(L.not)L.not={...M,...L.not};J[z]={...M,...q8(M,$,{...Q,root:!1})};break;case"Object":case"Union":J[z]=q8(U,$,{...Q,root:!1});break;default:if(Array.isArray(U.items))for(let O=0;O<U.items.length;O++)U.items[O]=q8(U.items[O],$,{...Q,root:!1});else if(U.anyOf||U.oneOf||U.allOf||U.not)J[z]=q8(U,$,{...Q,root:!1});else if(U.type==="array")U.items=q8(U.items,$,{...Q,root:!1});break}return Z},G$=(Z)=>($)=>{if(typeof $==="object")try{return A0.Clean(Z,$)}catch{try{return A0.Clean(Z,$)}catch{return $}}return $},X8=(Z,{models:$={},dynamic:Q=!1,modules:Y,normalize:W=!1,additionalProperties:X=!1,coerce:J=!1,additionalCoerce:z=[],validators:U,sanitize:q}={})=>{if(U=U?.filter((L)=>L),!Z){if(!U?.length)return;Z=U[0],U=U.slice(1)}let G=void 0,D=(L)=>{if(J)return m4(L,[{from:k.Number(),to:(O)=>k.Numeric(O),untilObjectFound:!0},{from:k.Boolean(),to:(O)=>k.BooleanString(O),untilObjectFound:!0},...Array.isArray(z)?z:[z]]);return m4(L,z)},A=(L)=>{let O;if(!L)return;if(typeof L!=="string")O=L;else{let _=L.endsWith("[]"),b=_?L.substring(0,L.length-2):L;if(O=Y?.Import(b)??$[b],_)O=k.Array(O)}if(!O)return;let m;if(O[S]!=="Import"&&(m=d1(O))){let _=hQ();if(G===void 0)G=m;O=k.Module({...Y?.$defs,[_]:O}).Import(_)}if(O[S]==="Import"){let _={};for(let[l,t]of Object.entries(O.$defs))_[l]=D(t);let b=O.$ref;O=k.Module(_).Import(b)}else if(J||z)O=D(O);return O},H=A(Z);if(U?.length){let L=!1,{schema:O,notObjects:m}=tL([H,...U.map(A)]);if(m){if(H=k.Intersect([...O?[O]:[],...m.map((_)=>{let b=A(_);if(b.type==="object"&&"additionalProperties"in b){if(!L&&b.additionalProperties===!1)L=!0;delete b.additionalProperties}return b})]),H.type==="object"&&L)H.additionalProperties=!1}}else if(H.type==="object"&&"additionalProperties"in H===!1)H.additionalProperties=X;if(Q){let L={schema:H,references:"",checkFunc:()=>{},code:"",Check:(O)=>A0.Check(H,O),Errors:(O)=>A0.Errors(H,O),Code:()=>"",Clean:G$(H),Decode:(O)=>A0.Decode(H,O),Encode:(O)=>A0.Encode(H,O),get hasAdditionalProperties(){if("~hasAdditionalProperties"in this)return this["~hasAdditionalProperties"];return this["~hasAdditionalProperties"]=y1(H)},get hasDefault(){if("~hasDefault"in this)return this["~hasDefault"];return this["~hasDefault"]=w$("default",H)},get isOptional(){if("~isOptional"in this)return this["~isOptional"];return this["~isOptional"]=KY(H)},get hasTransform(){if("~hasTransform"in this)return this["~hasTransform"];return this["~hasTransform"]=C1(H)},"~hasRef":G,get hasRef(){if("~hasRef"in this)return this["~hasRef"];return this["~hasRef"]=C1(H)}};if(H.config){if(L.config=H.config,L?.schema?.config)delete L.schema.config}if(W&&H.additionalProperties===!1)if(W===!0||W==="exactMirror")try{L.Clean=h4(H,{TypeCompiler:f1,sanitize:q?.(),modules:Y})}catch{console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.warn(H),L.Clean=G$(H)}else L.Clean=G$(H);return L.parse=(O)=>{try{return L.Decode(O)}catch(m){throw[...L.Errors(O)].map(j1)}},L.safeParse=(O)=>{try{return{success:!0,data:L.Decode(O),error:null}}catch(m){let _=[...M.Errors(O)].map(j1);return{success:!1,data:null,error:_[0]?.summary,errors:_}}},L}let M=f1.Compile(H,Object.values($));if(H.config){if(M.config=H.config,M?.schema?.config)delete M.schema.config}if(W===!0||W==="exactMirror")try{M.Clean=h4(H,{TypeCompiler:f1,sanitize:q?.(),modules:Y})}catch(L){console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.warn(H),M.Clean=G$(H)}else M.Clean=G$(H);return M.parse=(L)=>{try{return M.Decode(L)}catch(O){throw[...M.Errors(L)].map(j1)}},M.safeParse=(L)=>{try{return{success:!0,data:M.Decode(L),error:null}}catch(O){let m=[...M.Errors(L)].map(j1);return{success:!1,data:null,error:m[0]?.summary,errors:m}}},Object.assign(M,{get hasAdditionalProperties(){if("~hasAdditionalProperties"in this)return this["~hasAdditionalProperties"];return this["~hasAdditionalProperties"]=y1(M)},get hasDefault(){if("~hasDefault"in this)return this["~hasDefault"];return this["~hasDefault"]=w$("default",M)},get isOptional(){if("~isOptional"in this)return this["~isOptional"];return this["~isOptional"]=KY(M)},get hasTransform(){if("~hasTransform"in this)return this["~hasTransform"];return this["~hasTransform"]=C1(H)},get hasRef(){if("~hasRef"in this)return this["~hasRef"];return this["~hasRef"]=d1(H)},"~hasRef":G}),M},oL=(Z)=>Z[S]==="Union"||!Z.schema&&!!Z.anyOf,tL=(Z)=>{if(Z.length===0)return{schema:void 0,notObjects:[]};if(Z.length===1)return Z[0].type==="object"?{schema:Z[0],notObjects:[]}:{schema:void 0,notObjects:Z};let $,Q=[],Y=!1,W=!1;for(let X of Z){if(X.type!=="object"){Q.push(X);continue}if("additionalProperties"in X){if(X.additionalProperties===!0)Y=!0;else if(X.additionalProperties===!1)W=!0}if(!$){$=X;continue}$={...$,...X,properties:{...$.properties,...X.properties},required:[...$?.required??[],...X.required]}}if($){if($.required)$.required=[...new Set($.required)];if(W)$.additionalProperties=!1;else if(Y)$.additionalProperties=!0}return{schema:$,notObjects:Q}},c4=(Z,{models:$={},modules:Q,dynamic:Y=!1,normalize:W=!1,additionalProperties:X=!1,validators:J=[],sanitize:z})=>{if(J=J.filter((G)=>G),!Z){if(!J?.length)return;Z=J[0],J=J.slice(1)}let U;if(typeof Z!=="string")U=Z;else{let G=Z.endsWith("[]"),D=G?Z.substring(0,Z.length-2):Z;if(U=Q.Import(D)??$[D],G)U=k.Array(U)}if(!U)return;if(S in U)return{200:X8(U,{modules:Q,models:$,additionalProperties:X,dynamic:Y,normalize:W,coerce:!1,additionalCoerce:[],validators:J.map((G)=>G[200]),sanitize:z})};let q={};return Object.keys(U).forEach((G)=>{if(isNaN(+G))return;let D=U[+G];if(typeof D==="string"){if(D in $){let A=$[D];q[+G]=S in A?X8(A,{modules:Q,models:$,additionalProperties:X,dynamic:Y,normalize:W,coerce:!1,additionalCoerce:[],validators:J.map((H)=>H[+G]),sanitize:z}):A}return}q[+G]=S in D?X8(D,{modules:Q,models:$,additionalProperties:X,dynamic:Y,normalize:W,coerce:!1,additionalCoerce:[],validators:J.map((A)=>A[+G]),sanitize:z}):D}),q},HY,e6=()=>{if(!HY)HY=[{from:k.Object({}),to:()=>k.ObjectString({}),excludeRoot:!0},{from:k.Array(k.Any()),to:()=>k.ArrayString(k.Any())}];return HY},DY,CY=()=>{if(!DY)DY=[{from:k.Number(),to:(Z)=>k.Numeric(Z),rootOnly:!0},{from:k.Boolean(),to:(Z)=>k.BooleanString(Z),rootOnly:!0}];return DY},N5=({validator:Z,modules:$,defaultConfig:Q={},config:Y,dynamic:W,models:X,validators:J,sanitize:z})=>{let U=X8(Z,{modules:$,dynamic:W,models:X,additionalProperties:!0,coerce:!0,additionalCoerce:e6(),validators:J,sanitize:z});if(U)U.config=e4(U.config,Y);else U=X8(k.Cookie(k.Any()),{modules:$,dynamic:W,models:X,additionalProperties:!0,validators:J,sanitize:z}),U.config=Q;return U},p0=(Z,$)=>$?Z:"",sL=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],TY=({context:Z="c",trace:$=[],addFn:Q})=>{if(!$.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let Y=0;Y<$.length;Y++)Q(`let report${Y},reportChild${Y},reportErr${Y},reportErrChild${Y};let trace${Y}=${Z}[ELYSIA_TRACE]?.[${Y}]??trace[${Y}](${Z});
`);return(Y,{name:W,total:X=0}={})=>{if(!W)W="anonymous";let J=Y==="error"?"reportErr":"report";for(let z=0;z<$.length;z++)Q(`${J}${z} = trace${z}.${Y}({id,event:'${Y}',name:'${W}',begin:performance.now(),total:${X}})
`);return{resolve(){for(let z=0;z<$.length;z++)Q(`${J}${z}.resolve()
`)},resolveChild(z){for(let U=0;U<$.length;U++)Q(`${J}Child${U}=${J}${U}.resolveChild?.shift()?.({id,event:'${Y}',name:'${z}',begin:performance.now()})
`);return(U)=>{for(let q=0;q<$.length;q++)if(U)Q(`if(${U} instanceof Error){${J}Child${q}?.(${U}) }else{${J}Child${q}?.()}`);else Q(`${J}Child${q}?.()
`)}}}}},H$=({schema:Z,name:$,type:Q,typeAlias:Y=Q,normalize:W,ignoreTryCatch:X=!1})=>{if(!W||!Z.Clean||Z.hasAdditionalProperties)return"";if(W===!0||W==="exactMirror"){if(X)return`${$}=validator.${Y}.Clean(${$})
`;return`try{${$}=validator.${Y}.Clean(${$})
}catch{}`}if(W==="typebox")return`${$}=validator.${Y}.Clean(${$})
`;return""},rL=({injectResponse:Z="",normalize:$=!1,validator:Q,encodeSchema:Y=!1,isStaticResponse:W=!1,hasSanitize:X=!1})=>({validate:(J,z=`c.${J}`)=>`c.set.status=422;throw new ValidationError('${J}',validator.${J},${z})`,response:(J="r")=>{if(W)return"";let z=Z+`
`;z+=`if(${J} instanceof ElysiaCustomStatusResponse){c.set.status=${J}.code
${J}=${J}.response}switch(c.set.status){`;for(let[U,q]of Object.entries(Q.response)){z+=`
case ${U}:if(${J} instanceof Response)break
`;let G=q.schema?.noValidate===!0,D=G||X,A=({ignoreTryCatch:M=!1}={})=>H$({name:J,schema:q,type:"response",typeAlias:`response[${U}]`,normalize:$,ignoreTryCatch:M});if(D)z+=A();let H=!D&&$&&!G;if(Y&&q.hasTransform)z+=`try{${J}=validator.response[${U}].Encode(${J})
c.set.status=${U}}catch{`+(H?`try{
`+A({ignoreTryCatch:!0})+`${J}=validator.response[${U}].Encode(${J})
}catch{throw new ValidationError('response',validator.response[${U}],${J})}`:`throw new ValidationError('response',validator.response[${U}],${J})`)+"}";else{if(!D)z+=A();if(!G)z+=`if(validator.response[${U}].Check(${J})===false)throw new ValidationError('response',validator.response[${U}],${J})
c.set.status=${U}
`}z+=`break
`}return z+"}"}}),xZ=(Z)=>{return(Z?.fn??Z).constructor.name==="AsyncFunction"},aL=/=>\s?response\.clone\(/,eL=/(?:return|=>)\s?\S+\(|a(?:sync|wait)/,a0=(Z)=>{let $=typeof Z==="object";if($&&Z.isAsync!==void 0)return Z.isAsync;let Q=$?Z.fn:Z;if(Q.constructor.name==="AsyncFunction")return!0;let Y=Q.toString();if(aL.test(Y)){if($)Z.isAsync=!1;return!1}let W=eL.test(Y);if($)Z.isAsync=W;return W},A$=(Z)=>{let $=typeof Z==="object";if($&&Z.hasReturn!==void 0)return Z.hasReturn;let Q=$?Z.fn.toString():typeof Z==="string"?Z.toString():Z,Y=Q.indexOf(")");if(Q.charCodeAt(Y+2)===61&&Q.charCodeAt(Y+5)!==123){if($)Z.hasReturn=!0;return!0}let W=Q.includes("return");if($)Z.hasReturn=W;return W},_Q=(Z)=>{let $=Z?.fn??Z;return $.constructor.name==="AsyncGeneratorFunction"||$.constructor.name==="GeneratorFunction"},ZS=({app:Z,path:$,method:Q,hooks:Y,validator:W,handler:X,allowMeta:J=!1,inference:z})=>{let U=Z["~adapter"].composeHandler,q=Z["~adapter"].handler,G=typeof X==="function";if(!G){if(X=q.mapResponse(X,{headers:Z.setHeaders??{}}),Y.parse?.length&&Y.transform?.length&&Y.beforeHandle?.length&&Y.afterHandle?.length){if(X instanceof Response)return Function("a",`"use strict";
return function(){return a.clone()}`)(X);return Function("a",`"use strict";
return function(){return a}`)(X)}}let D=G?"handler(c)":"handler",A=!!Y.afterResponse?.length,H=!!Y.trace?.length,M="";if(z=S$(Y,z),z=S$({handler:X},z),U.declare){let g=U.declare(z);if(g)M+=g}if(z.server)M+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;W.createBody?.(),W.createQuery?.(),W.createHeaders?.(),W.createParams?.(),W.createCookie?.(),W.createResponse?.();let L=!!W.body||!!W.headers||!!W.params||!!W.query||!!W.cookie||!!W.response,O=z.query||!!W.query,m=Y.parse?.length===1&&Y.parse[0].fn==="none",_=Q!==""&&Q!=="GET"&&Q!=="HEAD"&&(z.body||!!W.body||!!Y.parse?.length)&&!m,b=Z.setHeaders,l=b&&!!Object.keys(b).length,t=z.headers||!!W.headers||U.preferWebstandardHeaders!==!0&&z.body,T=z.cookie||!!W.cookie,x=W.cookie?.config?e4(W?.cookie?.config,Z.config.cookie):Z.config.cookie,d="",j=()=>{if(d)return d;if(x?.sign){if(!x.secrets)throw new Error(`t.Cookie required secret which is not set in (${Q}) ${$}.`);let g=!x.secrets?void 0:typeof x.secrets==="string"?x.secrets:x.secrets[0];if(d+=`const _setCookie = c.set.cookie
if(_setCookie){`,x.sign===!0)d+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${g}')}`;else for(let R of x.sign)d+=`if(_setCookie['${R}']?.value)c.set.cookie['${R}'].value=await signCookie(_setCookie['${R}'].value,'${g}')
`;d+=`}
`}return d},p=Z.config.normalize,Z0=Z.config.encodeSchema,U0=rL({normalize:p,validator:W,encodeSchema:Z0,isStaticResponse:X instanceof Response,hasSanitize:!!Z.config.sanitize});if(t)M+=U.headers;if(H)M+=`const id=c[ELYSIA_REQUEST_ID]
`;let q0=TY({trace:Y.trace,addFn:(g)=>{M+=g}});if(M+="try{",T){let g=(B,F)=>{let N=x?.[B]??F;if(!N)return typeof F==="string"?`${B}:"${F}",`:`${B}:${F},`;if(typeof N==="string")return`${B}:'${N}',`;if(N instanceof Date)return`${B}: new Date(${N.getTime()}),`;return`${B}:${N},`},R=x?`{secrets:${x.secrets!==void 0?typeof x.secrets==="string"?`'${x.secrets}'`:"["+x.secrets.reduce((B,F)=>B+`'${F}',`,"")+"]":"undefined"},sign:${x.sign===!0?!0:x.sign!==void 0?"["+x.sign.reduce((B,F)=>B+`'${F}',`,"")+"]":"undefined"},`+g("domain")+g("expires")+g("httpOnly")+g("maxAge")+g("path","/")+g("priority")+g("sameSite")+g("secure")+"}":"undefined";if(t)M+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${R})
`;else M+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${R})
`}if(O){let g=[];if(W.query&&W.query.schema.type==="object"){let R=W.query.schema.properties;if(!W.query.hasAdditionalProperties)for(let[B,F]of Object.entries(R)){let N=F,E=N.type==="array"||!!N.anyOf?.some((c)=>c.type==="string"&&c.format==="ArrayString");if(N&&n0 in N&&N.type==="array"&&N.items)N=N.items;let{type:V,anyOf:I}=N;g.push({key:B,isArray:E,isNestedObjectArray:E&&N.items?.type==="object"||!!N.items?.anyOf?.some((c)=>c.type==="object"||c.type==="array"),isObject:V==="object"||I?.some((c)=>c.type==="string"&&c.format==="ArrayString"),anyOf:!!I})}}if(!g.length)M+="if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url,c.qi+1)}";else{M+=`if(c.qi!==-1){let url='&'+c.url.slice(c.qi+1)
`;let R=0;for(let{key:B,isArray:F,isObject:N,isNestedObjectArray:E,anyOf:V}of g){let I=(R===0?"let ":"")+`memory=url.indexOf('&${B}=')
let a${R}
`;if(F)if(M+=I,E)M+=`while(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(a${R}===undefined)
a${R}=''
else
a${R}+=','
let temp
if(memory===-1)temp=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else temp=decodeURIComponent(url.slice(start, memory).replace(/\\+/g,' '))
const charCode=temp.charCodeAt(0)
if(charCode!==91&&charCode !== 123)
temp='"'+temp+'"'
a${R}+=temp
if(memory===-1)break
memory=url.indexOf('&${B}=',memory)
if(memory===-1)break}try{if(a${R}.charCodeAt(0)===91)a${R} = JSON.parse(a${R})
else
a${R}=JSON.parse('['+a${R}+']')}catch{}
`;else M+=`while(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(a${R}===undefined)a${R}=[]
if(memory===-1){const temp=decodeURIComponent(url.slice(start)).replace(/\\+/g,' ')
if(temp.includes(',')){a${R}=a${R}.concat(temp.split(','))}else{a${R}.push(decodeURIComponent(url.slice(start)).replace(/\\+/g,' '))}
break}else{const temp=decodeURIComponent(url.slice(start, memory)).replace(/\\+/g,' ')
if(temp.includes(',')){a${R}=a${R}.concat(temp.split(','))}else{a${R}.push(temp)}
}memory=url.indexOf('&${B}=',memory)
if(memory===-1) break
}`;else if(N)M+=I+`if(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${R}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))else a${R}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))if(a${R}!==undefined)try{a${R}=JSON.parse(a${R})}catch{}}`;else{if(M+=I+`if(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${R}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else{a${R}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))`,V)M+=`
let deepMemory=url.indexOf('&${B}=',memory)
if(deepMemory!==-1){a${R}=[a${R}]
let first=true
while(true){const start=deepMemory+${B.length+2}
if(first)first=false
else deepMemory = url.indexOf('&', start)
let value
if(deepMemory===-1)value=url.slice(start).replace(/\\+/g,' ')
else value=url.slice(start, deepMemory).replace(/\\+/g,' ')
value=decodeURIComponent(value)
if(value===null){if(deepMemory===-1){break}else{continue}}
const vStart=value.charCodeAt(0)
const vEnd=value.charCodeAt(value.length - 1)
if((vStart===91&&vEnd===93)||(vStart===123&&vEnd===125))
try{a${R}.push(JSON.parse(value))}catch{a${R}.push(value)}if(deepMemory===-1)break}}`;M+="}}"}R++,M+=`
`}M+="c.query={"+g.map(({key:B},F)=>`'${B}':a${F}`).join(",")+"}",M+=`} else c.query = {}
`}}let U1=typeof X==="function"&&a0(X),L0=H||Y.afterResponse?.length?"c.response= ":"",d6=T||_||U1||!!Y.parse?.length||!!Y.afterHandle?.some(a0)||!!Y.beforeHandle?.some(a0)||!!Y.transform?.some(a0)||!!Y.mapResponse?.some(a0),T$=(typeof X==="function"?_Q(X):!1)||!!Y.beforeHandle?.some(_Q)||!!Y.afterHandle?.some(_Q)||!!Y.transform?.some(_Q),YZ=Object.keys(W.response??{}),F9=YZ.length>1,H6=YZ.length===0||YZ.length===1&&YZ[0]==="200",t0=z.cookie||z.set||t||H||F9||!H6||G&&l||T$,M8=(g="r")=>`return ${t0?"mapResponse":"mapCompactResponse"}(${L0}${g}${t0?",c.set":""}${E1})
`,E1=T$||U.mapResponseContext?`,${U.mapResponseContext}`:"";if(H||z.route)M+=`c.route=\`${$}\`
`;let D6=q0("parse",{total:Y.parse?.length});if(_){let g=!!Y.parse?.length||z.body||W.body;if(U.parser.declare)M+=U.parser.declare;M+=`
try{`;let R=typeof Y.parse==="string"?Y.parse:Array.isArray(Y.parse)&&Y.parse.length===1?typeof Y.parse[0]==="string"?Y.parse[0]:typeof Y.parse[0].fn==="string"?Y.parse[0].fn:void 0:void 0;if(!R&&W.body&&!Y.parse?.length){let B=W.body.schema;if(B&&B.anyOf&&B[S]==="Union"&&B.anyOf?.length===2&&B.anyOf?.find((F)=>F[S]==="ElysiaForm"))R="formdata"}if(R&&sL.includes(R)){let B=q0("parse",{total:Y.parse?.length}),F=!!W.body?.isOptional;switch(R){case"json":case"application/json":M+=U.parser.json(F);break;case"text":case"text/plain":M+=U.parser.text(F);break;case"urlencoded":case"application/x-www-form-urlencoded":M+=U.parser.urlencoded(F);break;case"arrayBuffer":case"application/octet-stream":M+=U.parser.arrayBuffer(F);break;case"formdata":case"multipart/form-data":M+=U.parser.formData(F);break;default:if(R[0]in Z["~parser"])M+=t?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",M+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0,index)}
else{contentType=''}c.contentType=contentType
let result=parser['${R}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}B.resolve()}else if(g){M+=`
`;let B=Y.parse?.length?"let":"const";M+=t?`${B} contentType=c.headers['content-type']
`:`${B} contentType=c.request.headers.get('content-type')
`;let F=!1;if(Y.parse?.length)M+=`if(contentType){
const index=contentType.indexOf(';')

if(index!==-1)contentType=contentType.substring(0,index)}else{contentType=''}let used=false
c.contentType=contentType
`;else{F=!0;let E=!!W.body?.isOptional;M+=`if(contentType)switch(contentType.charCodeAt(12)){
case 106:`+U.parser.json(E)+`break
case 120:`+U.parser.urlencoded(E)+`break
case 111:`+U.parser.arrayBuffer(E)+`break
case 114:`+U.parser.formData(E)+`break
default:if(contentType.charCodeAt(0)===116){`+U.parser.text(E)+`}break
}`}let N=q0("parse",{total:Y.parse?.length});if(Y.parse)for(let E=0;E<Y.parse.length;E++){let V=`bo${E}`;if(E!==0)M+=`
if(!used){`;if(typeof Y.parse[E].fn==="string"){let I=N.resolveChild(Y.parse[E].fn),c=!!W.body?.isOptional;switch(Y.parse[E].fn){case"json":case"application/json":F=!0,M+=U.parser.json(c);break;case"text":case"text/plain":F=!0,M+=U.parser.text(c);break;case"urlencoded":case"application/x-www-form-urlencoded":F=!0,M+=U.parser.urlencoded(c);break;case"arrayBuffer":case"application/octet-stream":F=!0,M+=U.parser.arrayBuffer(c);break;case"formdata":case"multipart/form-data":F=!0,M+=U.parser.formData(c);break;default:M+=`let ${V}=parser['${Y.parse[E].fn}'](c,contentType)
if(${V} instanceof Promise)${V}=await ${V}
if(${V}!==undefined){c.body=${V};used=true;}
`}I()}else{let I=N.resolveChild(Y.parse[E].fn.name);M+=`let ${V}=e.parse[${E}]
${V}=${V}(c,contentType)
if(${V} instanceof Promise)${V}=await ${V}
if(${V}!==undefined){c.body=${V};used=true}`,I()}if(E!==0)M+="}";if(F)break}if(N.resolve(),!F){let E=!!W.body?.isOptional;if(Y.parse?.length)M+=`
if(!used){
if(!contentType) throw new ParseError()
`;M+="switch(contentType){",M+=`case 'application/json':
`+U.parser.json(E)+`break
case 'text/plain':`+U.parser.text(E)+`break
case 'application/x-www-form-urlencoded':`+U.parser.urlencoded(E)+`break
case 'application/octet-stream':`+U.parser.arrayBuffer(E)+`break
case 'multipart/form-data':`+U.parser.formData(E)+`break
`;for(let V of Object.keys(Z["~parser"]))M+=`case '${V}':let bo${V}=parser['${V}'](c,contentType)
if(bo${V} instanceof Promise)bo${V}=await bo${V}
if(bo${V} instanceof ElysiaCustomStatusResponse)throw result
if(bo${V}!==undefined)c.body=bo${V}
break
`;if(Y.parse?.length)M+="}";M+="}"}if(Y.parse?.length)M+=`
delete c.contentType`}M+="}catch(error){throw new ParseError(error)}"}if(D6.resolve(),Y?.transform){let g=q0("transform",{total:Y.transform.length});if(Y.transform.length)M+=`let transformed
`;for(let R=0;R<Y.transform.length;R++){let B=Y.transform[R],F=g.resolveChild(B.fn.name);if(M+=a0(B)?`transformed=await e.transform[${R}](c)
`:`transformed=e.transform[${R}](c)
`,B.subType==="mapDerive")M+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else M+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else Object.assign(c,transformed)
`;F()}g.resolve()}let c1=[];if(W){if(W.headers){if(W.headers.hasDefault)for(let[g,R]of Object.entries(A0.Default(W.headers.schema,{}))){let B=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(B!==void 0)M+=`c.headers['${g}']??=${B}
`}if(M+=H$({name:"c.headers",schema:W.headers,type:"headers",normalize:p}),W.headers.isOptional)M+="if(isNotEmpty(c.headers)){";if(W.body?.schema?.noValidate!==!0)M+="if(validator.headers.Check(c.headers) === false){"+U0.validate("headers")+"}";if(W.headers.hasTransform)M+=`c.headers=validator.headers.Decode(c.headers)
`;if(W.headers.isOptional)M+="}"}if(W.params){if(W.params.hasDefault)for(let[g,R]of Object.entries(A0.Default(W.params.schema,{}))){let B=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(B!==void 0)M+=`c.params['${g}']??=${B}
`}if(W.params?.schema?.noValidate!==!0)M+="if(validator.params.Check(c.params)===false){"+U0.validate("params")+"}";if(W.params.hasTransform)M+=`c.params=validator.params.Decode(c.params)
`}if(W.query){if(W.query.hasDefault)for(let[g,R]of Object.entries(A0.Default(W.query.schema,{}))){let B=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(B!==void 0)M+=`if(c.query['${g}']===undefined)c.query['${g}']=${B}
`;M+=H$({name:"c.query",schema:W.query,type:"query",normalize:p})}if(W.query.isOptional)M+="if(isNotEmpty(c.query)){";if(W.query?.schema?.noValidate!==!0)M+="if(validator.query.Check(c.query)===false){"+U0.validate("query")+"}";if(W.query.hasTransform)M+=`c.query=validator.query.Decode(Object.assign({},c.query))
`;if(W.query.isOptional)M+="}"}if(_&&W.body){if(W.body.hasTransform||W.body.isOptional)M+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&isNotEmpty(c.body))
`;let g=oL(W.body.schema),R=!1;if(W.body.hasDefault){let B=A0.Default(W.body.schema,W.body.schema.type==="object"||W.body.schema[S]==="Import"&&W.body.schema.$defs[W.body.schema.$ref][S]==="Object"?{}:void 0);if(!g&&B&&typeof B==="object"&&(V6("File",W.body.schema)||V6("Files",W.body.schema))){R=!0;for(let[N,E]of Object.entries(B))if(E==="File"||E==="Files")delete B[N];if(!I0(B))B=void 0}let F=typeof B==="object"?JSON.stringify(B):typeof B==="string"?`'${B}'`:B;if(B!==void 0&&B!==null)if(Array.isArray(B))M+=`if(!c.body)c.body=${F}
`;else if(typeof B==="object")M+=`c.body=Object.assign(${F},c.body)
`;else M+=`c.body=${F}
`;if(M+=H$({name:"c.body",schema:W.body,type:"body",normalize:p}),W.body?.schema?.noValidate!==!0)if(W.body.isOptional)M+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+U0.validate("body")+"}";else M+="if(validator.body.Check(c.body)===false){"+U0.validate("body")+"}"}else if(M+=H$({name:"c.body",schema:W.body,type:"body",normalize:p}),W.body?.schema?.noValidate!==!0)if(W.body.isOptional)M+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+U0.validate("body")+"}";else M+="if(validator.body.Check(c.body)===false){"+U0.validate("body")+"}";if(W.body.hasTransform)M+=`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`;if(g&&W.body.schema.anyOf?.length){let B=Object.values(W.body.schema.anyOf);for(let F=0;F<B.length;F++){let N=B[F];if(V6("File",N)||V6("Files",N)){let E=X8(N,{modules:Z.definitions.typebox,dynamic:!Z.config.aot,models:Z.definitions.type,normalize:Z.config.normalize,additionalCoerce:CY(),sanitize:()=>Z.config.sanitize});if(E){let V=c1.length===0,I=Object.entries(N.properties),c=V?`
`:" else ";c+=`if(fileUnions[${c1.length}].Check(c.body)){`;let C0="",B8=0;for(let J8=0;J8<I.length;J8++){let[m8,u1]=I[J8];if(!u1.extension||u1[S]!=="File"&&u1[S]!=="Files")continue;if(B8)C0+=",";C0+=`validateFileExtension(c.body.${m8},${JSON.stringify(u1.extension)},'body.${m8}')`,B8++}if(C0){if(B8===1)c+=`await ${C0}
`;else if(B8>1)c+=`await Promise.all([${C0}])
`;c+="}",M+=c,c1.push(E)}}}}}else if(R||!g&&(V6("File",W.body.schema)||V6("Files",W.body.schema))){let B="",F=0;for(let[N,E]of Object.entries(W.body.schema.properties)){if(!E.extension||E[S]!=="File"&&E[S]!=="Files")continue;if(F)B+=",";B+=`validateFileExtension(c.body.${N},${JSON.stringify(E.extension)},'body.${N}')`,F++}if(F)M+=`
`;if(F===1)M+=`await ${B}
`;else if(F>1)M+=`await Promise.all([${B}])
`}}if(W.cookie){let g=N5({modules:Z.definitions.typebox,validator:W.cookie,defaultConfig:Z.config.cookie,dynamic:!!Z.config.aot,config:W.cookie?.config??{},models:Z.definitions.type});if(M+=`const cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,g.hasDefault)for(let[R,B]of Object.entries(A0.Default(g.schema,{})))M+=`cookieValue['${R}'] = ${typeof B==="object"?JSON.stringify(B):B}
`;if(g.isOptional)M+="if(isNotEmpty(c.cookie)){";if(W.body?.schema?.noValidate!==!0)M+="if(validator.cookie.Check(cookieValue)===false){"+U0.validate("cookie","cookieValue")+"}";if(g.hasTransform)M+=`for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue)))c.cookie[key].value=value
`;if(g.isOptional)M+="}"}}if(Y?.beforeHandle){let g=q0("beforeHandle",{total:Y.beforeHandle.length}),R=!1;for(let B=0;B<Y.beforeHandle.length;B++){let F=Y.beforeHandle[B],N=g.resolveChild(F.fn.name),E=A$(F);if(F.subType==="resolve"||F.subType==="mapResolve"){if(!R)R=!0,M+=`
let resolved
`;if(M+=a0(F)?`resolved=await e.beforeHandle[${B}](c);
`:`resolved=e.beforeHandle[${B}](c);
`,F.subType==="mapResolve")M+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else{resolved.request=c.request
resolved.store=c.store
resolved.qi=c.qi
resolved.path=c.path
resolved.url=c.url
resolved.redirect=c.redirect
resolved.set=c.set
resolved.error=c.error
c=resolved}`;else M+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else Object.assign(c, resolved)
`}else if(!E)M+=a0(F)?`await e.beforeHandle[${B}](c)
`:`e.beforeHandle[${B}](c)
`,N();else{if(M+=a0(F)?`be=await e.beforeHandle[${B}](c)
`:`be=e.beforeHandle[${B}](c)
`,N("be"),M+="if(be!==undefined){",g.resolve(),Y.afterHandle?.length){q0("handle",{name:G?X.name:void 0}).resolve();let I=q0("afterHandle",{total:Y.afterHandle.length});for(let c=0;c<Y.afterHandle.length;c++){let C0=Y.afterHandle[c],B8=A$(C0),J8=I.resolveChild(C0.fn.name);if(M+=`c.response = be
`,!B8)M+=a0(C0.fn)?`await e.afterHandle[${c}](c, be)
`:`e.afterHandle[${c}](c, be)
`;else M+=a0(C0.fn)?`af=await e.afterHandle[${c}](c)
`:`af=e.afterHandle[${c}](c)
`,M+=`if(af!==undefined) c.response=be=af
`;J8("af")}I.resolve()}if(W.response)M+=U0.response("be");let V=q0("mapResponse",{total:Y.mapResponse?.length});if(Y.mapResponse?.length){M+=`c.response=be
`;for(let I=0;I<Y.mapResponse.length;I++){let c=Y.mapResponse[I],C0=V.resolveChild(c.fn.name);M+=`if(mr===undefined){mr=${xZ(c)?"await ":""}e.mapResponse[${I}](c)
if(mr!==undefined)be=c.response=mr}`,C0()}}V.resolve(),M+=j(),M+=`return mapEarlyResponse(${L0}be,c.set${E1})}
`}}g.resolve()}if(Y.afterHandle?.length){let g=q0("handle",{name:G?X.name:void 0});if(Y.afterHandle.length)M+=U1?`let r=c.response=await ${D}
`:`let r=c.response=${D}
`;else M+=U1?`let r=await ${D}
`:`let r=${D}
`;g.resolve();let R=q0("afterHandle",{total:Y.afterHandle.length});for(let F=0;F<Y.afterHandle.length;F++){let N=Y.afterHandle[F],E=A$(N),V=R.resolveChild(N.fn.name);if(!E)M+=a0(N.fn)?`await e.afterHandle[${F}](c)
`:`e.afterHandle[${F}](c)
`,V();else if(M+=a0(N.fn)?`af=await e.afterHandle[${F}](c)
`:`af=e.afterHandle[${F}](c)
`,V("af"),W.response)M+="if(af!==undefined){",R.resolve(),M+=U0.response("af"),M+="c.response=af}";else M+="if(af!==undefined){",R.resolve(),M+="c.response=af}"}if(R.resolve(),M+=`r=c.response
`,W.response)M+=U0.response();M+=j();let B=q0("mapResponse",{total:Y.mapResponse?.length});if(Y.mapResponse?.length)for(let F=0;F<Y.mapResponse.length;F++){let N=Y.mapResponse[F],E=B.resolveChild(N.fn.name);M+=`mr=${xZ(N)?"await ":""}e.mapResponse[${F}](c)
if(mr!==undefined)r=c.response=mr
`,E()}B.resolve(),M+=M8()}else{let g=q0("handle",{name:G?X.name:void 0});if(W.response||Y.mapResponse?.length){if(M+=U1?`let r=await ${D}
`:`let r=${D}
`,g.resolve(),W.response)M+=U0.response();q0("afterHandle").resolve();let R=q0("mapResponse",{total:Y.mapResponse?.length});if(Y.mapResponse?.length){M+=`
c.response=r
`;for(let B=0;B<Y.mapResponse.length;B++){let F=Y.mapResponse[B],N=R.resolveChild(F.fn.name);M+=`
if(mr===undefined){mr=${xZ(F)?"await ":""}e.mapResponse[${B}](c)
if(mr!==undefined)r=c.response=mr}
`,N()}}if(R.resolve(),M+=j(),X instanceof Response)M+=z.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${L0}${D}.clone(),c.set${E1})else return ${D}.clone()`:`return ${D}.clone()`,M+=`
`;else M+=M8()}else if(T||H){M+=U1?`let r=await ${D}
`:`let r=${D}
`,g.resolve(),q0("afterHandle").resolve();let R=q0("mapResponse",{total:Y.mapResponse?.length});if(Y.mapResponse?.length){M+=`c.response= r
`;for(let B=0;B<Y.mapResponse.length;B++){let F=Y.mapResponse[B],N=R.resolveChild(F.fn.name);M+=`if(mr===undefined){mr=${xZ(F)?"await ":""}e.mapResponse[${B}](c)
if(mr!==undefined)r=c.response=mr}`,N()}}R.resolve(),M+=j()+M8()}else{g.resolve();let R=U1?`await ${D}`:D;if(q0("afterHandle").resolve(),X instanceof Response)M+=z.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${L0}${D}.clone(),c.set${E1})
else return ${D}.clone()
`:`return ${D}.clone()
`;else M+=M8(R)}}if(M+=`
}catch(error){`,!d6&&Y.error?.length)M+="return(async()=>{";if(M+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,T)M+=j();if(H&&Y.trace)for(let g=0;g<Y.trace.length;g++)M+=`report${g}?.resolve(error);reportChild${g}?.(error)
`;let N6=q0("error",{total:Y.error?.length});if(Y.error?.length){if(M+=`c.error=error
`,L)M+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else M+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;M+=`let er
`;for(let g=0;g<Y.error.length;g++){let R=N6.resolveChild(Y.error[g].fn.name);if(a0(Y.error[g]))M+=`er=await e.error[${g}](c)
`;else M+=`er=e.error[${g}](c)
if(er instanceof Promise)er=await er
`;R();let B=q0("mapResponse",{total:Y.mapResponse?.length});if(Y.mapResponse?.length)for(let F=0;F<Y.mapResponse.length;F++){let N=Y.mapResponse[F],E=B.resolveChild(N.fn.name);M+=`c.response=er
er=e.mapResponse[${F}](c)
if(er instanceof Promise)er=await er
`,E()}if(B.resolve(),M+=`er=mapEarlyResponse(er,set${E1})
`,M+="if(er){",H&&Y.trace){for(let F=0;F<Y.trace.length;F++)M+=`report${F}.resolve()
`;N6.resolve()}M+="return er}"}}if(N6.resolve(),M+="return handleError(c,error,true)",!d6&&Y.error?.length)M+="})()";if(M+="}",A||H){if(M+="finally{ ",!d6)M+=";(async()=>{";let g=q0("afterResponse",{total:Y.afterResponse?.length});if(A&&Y.afterResponse)for(let R=0;R<Y.afterResponse.length;R++){let B=g.resolveChild(Y.afterResponse[R].fn.name);M+=`
await e.afterResponse[${R}](c)
`,B()}if(g.resolve(),!d6)M+="})()";M+="}"}let k$=U.inject?Object.keys(U.inject).join(",")+",":"",w6="const {handler,handleError,hooks:e, "+p0("validator,",L)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+p0("parseQuery,",_)+p0("parseQueryFromURL,",O)+"},error:{"+p0("ValidationError,",L)+p0("ParseError",_)+"},validateFileExtension,schema,definitions,ERROR_CODE,"+p0("parseCookie,",T)+p0("signCookie,",T)+p0("decodeURIComponent,",O)+"ElysiaCustomStatusResponse,"+p0("ELYSIA_TRACE,",H)+p0("ELYSIA_REQUEST_ID,",H)+p0("parser,",Y.parse?.length)+p0("getServer,",z.server)+p0("fileUnions,",c1.length)+k$+p0("TypeBoxError",L)+`}=hooks
const trace=e.trace
return ${d6?"async ":""}function handle(c){`;if(Y.beforeHandle?.length)w6+=`let be
`;if(Y.afterHandle?.length)w6+=`let af
`;if(Y.mapResponse?.length)w6+=`let mr
`;if(J)w6+=`c.schema=schema
c.defs=definitions
`;M=w6+M+"}",w6="";try{return Function("hooks",`"use strict";
`+M)({handler:X,hooks:I4({...Y}),validator:L?W:void 0,handleError:Z.handleError,mapResponse:q.mapResponse,mapCompactResponse:q.mapCompactResponse,mapEarlyResponse:q.mapEarlyResponse,isNotEmpty:I0,utils:{parseQuery:_?KQ:void 0,parseQueryFromURL:O?mL:void 0},error:{ValidationError:L?K0:void 0,ParseError:_?Y5:void 0},validateFileExtension:VL,schema:Z.router.history,definitions:Z.definitions.type,ERROR_CODE:IQ,parseCookie:T?U5:void 0,signCookie:T?EQ:void 0,decodeURIComponent:O?hL.default:void 0,ElysiaCustomStatusResponse:K8,ELYSIA_TRACE:H?uQ:void 0,ELYSIA_REQUEST_ID:H?O$:void 0,getServer:()=>Z.getServer(),fileUnions:c1.length?c1:void 0,TypeBoxError:L?i:void 0,parser:Z["~parser"],...U.inject})}catch(g){let R=I4(Y);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof X==="function"?X.toString():X,instruction:M,hooks:{...R,transform:R?.transform?.map?.((B)=>B.toString()),resolve:R?.resolve?.map?.((B)=>B.toString()),beforeHandle:R?.beforeHandle?.map?.((B)=>B.toString()),afterHandle:R?.afterHandle?.map?.((B)=>B.toString()),mapResponse:R?.mapResponse?.map?.((B)=>B.toString()),parse:R?.parse?.map?.((B)=>B.toString()),error:R?.error?.map?.((B)=>B.toString()),afterResponse:R?.afterResponse?.map?.((B)=>B.toString()),stop:R?.stop?.map?.((B)=>B.toString())},validator:W,definitions:Z.definitions.type,error:g}),console.log("---"),process.exit(1)}},w5=(Z,$)=>{let Q="",Y=TY({trace:Z.event.trace,addFn:$??((W)=>{Q+=W})})("request",{total:Z.event.request?.length});if(Z.event.request?.length){Q+="try{";for(let W=0;W<Z.event.request.length;W++){let X=Z.event.request[W],J=A$(X),z=a0(X),U=Y.resolveChild(Z.event.request[W].fn.name);if(J)Q+=`re=mapEarlyResponse(${z?"await ":""}onRequest[${W}](c),c.set)
`,U("re"),Q+=`if(re!==undefined)return re
`;else Q+=`${z?"await ":""}onRequest[${W}](c)
`,U()}Q+="}catch(error){return app.handleError(c,error,false)}"}return Y.resolve(),Q},A5=(Z,$="map")=>{let Q=Z.extender.higherOrderFunctions;if(!Q.length)return"return "+$;let Y=Z["~adapter"].composeGeneralHandler,W=$;for(let X=0;X<Q.length;X++)W=`hoc[${X}](${W},${Y.parameters})`;return`return function hocMap(${Y.parameters}){return ${W}(${Y.parameters})}`},NY=(Z)=>{let $=Z["~adapter"].composeGeneralHandler;Z.router.http.build();let Q=$.error404(!!Z.event.request?.length,!!Z.event.error?.length),Y=Z.event.trace?.length,W="",X=Z.router,J=X.http.root.WS?`const route=router.find(r.method === "GET" && r.headers.get('upgrade')==='websocket'?'WS':r.method,p)`:"const route=router.find(r.method,p)";J+=X.http.root.ALL?`??router.find("ALL",p)
`:`
`,J+=Q.code,J+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return route.store.compile()(c)
`;let z="";for(let[D,A]of Object.entries(X.static)){if(z+=`case'${D}':`,Z.config.strictPath!==!0)z+=`case'${M$(D)}':`;let H=B$(D);if(D!==H)z+=`case'${H}':`;if(z+="switch(r.method){","GET"in A||"WS"in A){if(z+="case 'GET':","WS"in A)z+=`if(r.headers.get('upgrade')==='websocket')return ht[${A.WS}].composed(c)
`;if("GET"in A)z+=`return ht[${A.GET}].composed(c)
`}for(let[M,L]of Object.entries(A)){if(M==="ALL"||M==="GET"||M==="WS")continue;z+=`case '${M}':return ht[${L}].composed(c)
`}if("ALL"in A)z+=`default:return ht[${A.ALL}].composed(c)
`;else z+=`default:break map
`;z+="}"}let U=!!Z.event.request?.some(a0),q=$.inject?Object.keys($.inject).join(",")+",":"";if(W+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,status,redirect,`+p0("ELYSIA_TRACE,",Y)+p0("ELYSIA_REQUEST_ID,",Y)+q+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,Z.event.request?.length)W+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(W+=Q.declare,Z.event.trace?.length)W+="const "+Z.event.trace.map((D,A)=>`tr${A}=app.event.trace[${A}].fn`).join(",")+`
`;if(W+=`${U?"async ":""}function map(${$.parameters}){`,Z.event.request?.length)W+=`let re
`;if(W+=$.createContext(Z),Z.event.trace?.length)W+="c[ELYSIA_TRACE]=["+Z.event.trace.map((D,A)=>`tr${A}(c)`).join(",")+`]
`;if(W+=w5(Z),z)W+=`
map: switch(p){
`+z+"}";W+=J+`}
`+A5(Z),Z.handleError=L5(Z);let G=Function("data",`"use strict";
`+W)({app:Z,mapEarlyResponse:Z["~adapter"].handler.mapEarlyResponse,NotFoundError:IY,randomId:hQ,handleError:Z.handleError,status:bQ,redirect:EY,ELYSIA_TRACE:Y?uQ:void 0,ELYSIA_REQUEST_ID:Y?O$:void 0,...$.inject});if(kZ)Bun.gc(!1);return G},L5=(Z)=>{let $=Z.event,Q="",Y=Z["~adapter"].composeError,W=Y.inject?Object.keys(Y.inject).join(",")+",":"",X=!!Z.event.trace?.length;if(Q+="const {mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+p0("onError,",Z.event.error)+p0("afterResponse,",Z.event.afterResponse)+p0("trace,",Z.event.trace)+p0("onMapResponse,",Z.event.mapResponse)+p0("ELYSIA_TRACE,",X)+p0("ELYSIA_REQUEST_ID,",X)+W+`}=inject
`,Q+=`return ${Z.event.error?.find(a0)||Z.event.mapResponse?.find(a0)?"async ":""}function(context,error,skipGlobal){`,Q+="",X)Q+=`const id=context[ELYSIA_REQUEST_ID]
`;let J=TY({context:"context",trace:$.trace,addFn:(G)=>{Q+=G}});if(Q+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,Y.declare)Q+=Y.declare;let z=X||!!$.afterResponse?.length||!!$.afterResponse?.length?"context.response = ":"";if(Z.event.error)for(let G=0;G<Z.event.error.length;G++){let D=Z.event.error[G],A=`${a0(D)?"await ":""}onError[${G}](context)
`;if(Q+="if(skipGlobal!==true){",A$(D)){Q+=`_r=${A}
if(_r!==undefined){if(_r instanceof Response)return mapResponse(_r,set${Y.mapResponseContext})
if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let H=J("mapResponse",{total:$.mapResponse?.length,name:"context"});if($.mapResponse?.length)for(let M=0;M<$.mapResponse.length;M++){let L=$.mapResponse[M],O=H.resolveChild(L.fn.name);Q+=`context.response=_r_r=${xZ(L)?"await ":""}onMapResponse[${M}](context)
`,O()}H.resolve(),Q+=`return mapResponse(${z}_r,set${Y.mapResponseContext})}`}else Q+=A;Q+="}"}Q+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){
if(error.error)error=error.error
set.status=error.status??422
`+Y.validationError+`
}
`,Q+=`if(error instanceof Error){
if(typeof error.toResponse==='function')return context.response=error.toResponse()
`+Y.unknownError+`
}`;let U=J("mapResponse",{total:$.mapResponse?.length,name:"context"});if(Q+=`
if(!context.response)context.response=error.message??error
`,$.mapResponse?.length){Q+=`let mr
`;for(let G=0;G<$.mapResponse.length;G++){let D=$.mapResponse[G],A=U.resolveChild(D.fn.name);Q+=`if(mr===undefined){mr=${xZ(D)?"await ":""}onMapResponse[${G}](context)
if(mr!==undefined)error=context.response=mr}`,A()}}U.resolve(),Q+=`
return mapResponse(${z}error,set${Y.mapResponseContext})}`;let q=(G)=>typeof G==="function"?G:G.fn;return Function("inject",`"use strict";
`+Q)({mapResponse:Z["~adapter"].handler.mapResponse,ERROR_CODE:IQ,ElysiaCustomStatusResponse:K8,onError:Z.event.error?.map(q),afterResponse:Z.event.afterResponse?.map(q),trace:Z.event.trace?.map(q),onMapResponse:Z.event.mapResponse?.map(q),ELYSIA_TRACE:X?uQ:void 0,ELYSIA_REQUEST_ID:X?O$:void 0,...Y.inject})},P8=(Z,$,Q)=>{if(I0($.headers)||$.status!==200||$.cookie)switch(cQ($),Z?.constructor?.name){case"String":return new Response(Z,$);case"Array":case"Object":return $.headers["content-type"]="application/json",new Response(JSON.stringify(Z),$);case"ElysiaFile":return f0(Z.value);case"File":return f0(Z,$);case"Blob":return f0(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,P8(Z.response,$,Q);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Q?.signal?.addEventListener("abort",{handleEvent(){if(Q?.signal&&!Q?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return new Response("",$);return new Response(JSON.stringify(Z),$);case"Response":return yQ(Z,$,Q);case"Error":return I6(Z,$);case"Promise":return Z.then((Y)=>P8(Y,$,Q));case"Function":return P8(Z(),$,Q);case"Number":case"Boolean":return new Response(Z.toString(),$);case"Cookie":if(Z instanceof B6)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z,$);default:if(Z instanceof Response)return yQ(Z,$,Q);if(Z instanceof Promise)return Z.then((Y)=>P8(Y,$));if(Z instanceof Error)return I6(Z,$);if(Z instanceof K8)return $.status=Z.code,P8(Z.response,$,Q);if(typeof Z?.next==="function")return x6(Z,$,Q);if(typeof Z?.then==="function")return Z.then((Y)=>P8(Y,$));if(typeof Z?.toResponse==="function")return P8(Z.toResponse(),$);if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}if(Z instanceof Response&&!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return x6(k6(Z),T6(Z,$),Q);if(typeof Z?.next==="function"||Z instanceof ReadableStream)return x6(Z,$,Q);return M6(Z,Q)},_8=(Z,$,Q)=>{if(Z===void 0||Z===null)return;if(I0($.headers)||$.status!==200||$.cookie)switch(cQ($),Z?.constructor?.name){case"String":return new Response(Z,$);case"Array":case"Object":return $.headers["content-type"]="application/json",new Response(JSON.stringify(Z),$);case"ElysiaFile":return f0(Z.value);case"File":return f0(Z,$);case"Blob":return f0(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,_8(Z.response,$,Q);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Q?.signal?.addEventListener("abort",{handleEvent(){if(Q?.signal&&!Q?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return;return new Response(JSON.stringify(Z),$);case"Response":return yQ(Z,$,Q);case"Promise":return Z.then((Y)=>_8(Y,$));case"Error":return I6(Z,$);case"Function":return _8(Z(),$);case"Number":case"Boolean":return new Response(Z.toString(),$);case"FormData":return new Response(Z);case"Cookie":if(Z instanceof B6)return new Response(Z.value,$);return new Response(Z?.toString(),$);default:if(Z instanceof Response)return yQ(Z,$,Q);if(Z instanceof Promise)return Z.then((Y)=>_8(Y,$));if(Z instanceof Error)return I6(Z,$);if(Z instanceof K8)return $.status=Z.code,_8(Z.response,$,Q);if(typeof Z?.next==="function")return x6(Z,$,Q);if(typeof Z?.then==="function")return Z.then((Y)=>_8(Y,$));if(typeof Z?.toResponse==="function")return _8(Z.toResponse(),$);if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}else switch(Z?.constructor?.name){case"String":return new Response(Z);case"Array":case"Object":return $.headers["content-type"]="application/json",new Response(JSON.stringify(Z),$);case"ElysiaFile":return f0(Z.value);case"File":return f0(Z,$);case"Blob":return f0(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,_8(Z.response,$,Q);case"ReadableStream":return Q?.signal?.addEventListener("abort",{handleEvent(){if(Q?.signal&&!Q?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return x6(k6(Z),T6(Z),Q);return Z;case"Promise":return Z.then((Y)=>{let W=_8(Y,$);if(W!==void 0)return W});case"Error":return I6(Z,$);case"Function":return M6(Z(),Q);case"Number":case"Boolean":return new Response(Z.toString());case"Cookie":if(Z instanceof B6)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Y)=>_8(Y,$));if(Z instanceof Error)return I6(Z,$);if(Z instanceof K8)return $.status=Z.code,_8(Z.response,$,Q);if(typeof Z?.next==="function")return x6(Z,$,Q);if(typeof Z?.then==="function")return Z.then((Y)=>_8(Y,$));if(typeof Z?.toResponse==="function")return _8(Z.toResponse(),$);if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z)}},M6=(Z,$)=>{switch(Z?.constructor?.name){case"String":return new Response(Z);case"Object":case"Array":return new Response(JSON.stringify(Z),{headers:{"Content-Type":"application/json"}});case"ElysiaFile":return f0(Z.value);case"File":return f0(Z);case"Blob":return f0(Z);case"ElysiaCustomStatusResponse":return P8(Z.response,{status:Z.code,headers:{}});case"ReadableStream":return $?.signal?.addEventListener("abort",{handleEvent(){if($?.signal&&!$?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(Z.headers.get("transfer-encoding")==="chunked")return x6(k6(Z),T6(Z),$);return Z;case"Error":return I6(Z);case"Promise":return Z.then((Q)=>M6(Q,$));case"Function":return M6(Z(),$);case"Number":case"Boolean":return new Response(Z.toString());case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Q)=>M6(Q,$));if(Z instanceof Error)return I6(Z);if(Z instanceof K8)return P8(Z.response,{status:Z.code,headers:{}});if(typeof Z?.next==="function")return x6(Z,void 0,$);if(typeof Z?.then==="function")return Z.then((Q)=>P8(Q,set));if(typeof Z?.toResponse==="function")return M6(Z.toResponse());if("charCodeAt"in Z){let Q=Z.charCodeAt(0);if(Q===123||Q===91)return new Response(JSON.stringify(Z),{headers:{"Content-Type":"application/json"}})}return new Response(Z)}},I6=(Z,$)=>new Response(JSON.stringify({name:Z?.name,message:Z?.message,cause:Z?.cause}),{status:$?.status!==200?$?.status??500:500,headers:$?.headers}),$S=(Z,$,Q={})=>{if(typeof Z==="function")return;let Y=P8(Z,{headers:Q});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length)return Y.clone.bind(Y)},yQ=M5({mapResponse:P8,mapCompactResponse:M6}),x6=xY({mapResponse:P8,mapCompactResponse:M6}),q6=(Z,$)=>$?Z:"",u4=(Z,$,Q,Y=!1)=>{let W="",X=Z.setHeaders,J=!!Z.event.trace?.length;if(J)W+=`const id=randomId()
`;let z=/[:*]/.test($.path),U=`const u=request.url,s=u.indexOf('/',${Z.config.handler?.standardHostname??!0?11:7}),qi=u.indexOf('?', s + 1)
`;if(Q.query)W+=U;let q=!Q.path?"":!z?`path:'${$.path}',`:"get path(){"+(Q.query?"":U)+`if(qi===-1)return u.substring(s)
return u.substring(s,qi)
},`;if(W+=q6("const c=",!Y)+"{request,store,"+q6("qi,",Q.query)+q6("params:request.params,",z)+q+q6("url:request.url,",J||Q.url||Q.query)+"redirect,error:status,status,set:{headers:"+(I0(X)?"Object.assign({},app.setHeaders)":"Object.create(null)")+",status:200}",Q.server)W+=",get server(){return app.getServer()}";if(J)W+=",[ELYSIA_REQUEST_ID]:id";{let G="";for(let D of Object.keys(Z.singleton.decorator))G+=`,'${D}':decorator['${D}']`;W+=G}return W+=`}
`,W},wY=(Z,$)=>{let Q=!!Z.event.trace?.length,Y=!!Z.extender.higherOrderFunctions.length,W=S$($.hooks,Z.inference);W=S$({handler:$.handler},W);let X="const handler=data.handler,app=data.app,store=data.store,decorator=data.decorator,redirect=data.redirect,route=data.route,mapEarlyResponse=data.mapEarlyResponse,"+q6("randomId=data.randomId,",Q)+q6("ELYSIA_REQUEST_ID=data.ELYSIA_REQUEST_ID,",Q)+q6("ELYSIA_TRACE=data.ELYSIA_TRACE,",Q)+q6("trace=data.trace,",Q)+q6("hoc=data.hoc,",Y)+`status=data.status
`;if(Z.event.request?.length)X+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(X+=`${Z.event.request?.find(a0)?"async":""} function map(request){`,Q||W.query||Z.event.request?.length)X+=u4(Z,$,W),X+=w5(Z),X+="return handler(c)}";else X+=`return handler(${u4(Z,$,W,!0)})}`;return X+=A5(Z),Function("data",X)({app:Z,handler:$.compile?.()??$.composed,redirect:EY,status:bQ,hoc:Z.extender.higherOrderFunctions.map((J)=>J.fn),store:Z.store,decorator:Z.decorator,route:$.path,randomId:Q?hQ:void 0,ELYSIA_TRACE:Q?uQ:void 0,ELYSIA_REQUEST_ID:Q?O$:void 0,trace:Q?Z.event.trace?.map((J)=>J?.fn??J):void 0,mapEarlyResponse:_8})},QS=(Z,$,Q={})=>{if(typeof Z==="function"||Z instanceof Blob)return;if(typeof Z==="object"&&Z?.toString()==="[object HTMLBundle]")return()=>Z;let Y=P8(Z,{headers:Q});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length){if(Y instanceof Promise)return Y.then((W)=>{if(!W)return;if(!W.headers.has("content-type"))W.headers.append("content-type","text/plain");return W.clone()});if(!Y.headers.has("content-type"))Y.headers.append("content-type","text/plain");return Y.clone.bind(Y)}},p4={open(Z){Z.data.open?.(Z)},message(Z,$){Z.data.message?.(Z,$)},drain(Z){Z.data.drain?.(Z)},close(Z,$,Q){Z.data.close?.(Z,$,Q)}};class D${raw;data;body;validator;["~types"];get id(){return this.data.id}constructor(Z,$,Q=void 0){this.raw=Z,this.data=$,this.body=Q,this.validator=Z.data?.validator,this.sendText=Z.sendText.bind(Z),this.sendBinary=Z.sendBinary.bind(Z),this.close=Z.close.bind(Z),this.terminate=Z.terminate.bind(Z),this.publishText=Z.publishText.bind(Z),this.publishBinary=Z.publishBinary.bind(Z),this.subscribe=Z.subscribe.bind(Z),this.unsubscribe=Z.unsubscribe.bind(Z),this.isSubscribed=Z.isSubscribed.bind(Z),this.cork=Z.cork.bind(Z),this.remoteAddress=Z.remoteAddress,this.binaryType=Z.binaryType,this.data=Z.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send(Z,$){if(Buffer.isBuffer(Z))return this.raw.send(Z,$);if(this.validator?.Check(Z)===!1)return this.raw.send(new K0("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.send(Z,$)}ping(Z){if(Buffer.isBuffer(Z))return this.raw.ping(Z);if(this.validator?.Check(Z)===!1)return this.raw.send(new K0("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.ping(Z)}pong(Z){if(Buffer.isBuffer(Z))return this.raw.pong(Z);if(this.validator?.Check(Z)===!1)return this.raw.send(new K0("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.pong(Z)}publish(Z,$,Q){if(Buffer.isBuffer($))return this.raw.publish(Z,$,Q);if(this.validator?.Check($)===!1)return this.raw.send(new K0("message",this.validator,$).message);if(typeof $==="object")$=JSON.stringify($);return this.raw.publish(Z,$,Q)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}}var YS=(Z)=>{let $=typeof Z==="function"?[Z]:Z;return async function Q(Y,W){if(typeof W==="string"){let X=W?.charCodeAt(0);if(X===34||X===47||X===91||X===123)try{W=JSON.parse(W)}catch{}else if(VY(W))W=+W;else if(W==="true")W=!0;else if(W==="false")W=!1;else if(W==="null")W=null}if($)for(let X=0;X<$.length;X++){let J=$[X](Y,W);if(J instanceof Promise)J=await J;if(J!==void 0)return J}return W}},WS=(Z)=>{let $=(Q,Y)=>{if(Y instanceof Promise)return Y.then((J)=>$(Q,J));if(Buffer.isBuffer(Y))return Q.send(Y.toString());if(Y===void 0)return;let W=(J)=>{if(Z?.Check(J)===!1)return Q.send(new K0("message",Z,J).message);if(typeof J==="object")return Q.send(JSON.stringify(J));Q.send(J)};if(typeof Y?.next!=="function")return void W(Y);let X=Y.next();if(X instanceof Promise)return(async()=>{let J=await X;if(Z?.Check(J)===!1)return Q.send(new K0("message",Z,J).message);if(W(J.value),!J.done)for await(let z of Y)W(z)})();if(W(X.value),!X.done)for(let J of Y)W(J)};return $},XS=/:.+?\?(?=\/|$)/,S5=(Z)=>{let $=XS.exec(Z);if(!$)return[Z];let Q=[],Y=Z.slice(0,$.index),W=$[0].slice(0,-1),X=Z.slice($.index+$[0].length);Q.push(Y.slice(0,-1)),Q.push(Y+W);for(let J of S5(X)){if(!J)continue;if(!J.startsWith("/:"))Q.push(Y.slice(0,-1)+J);Q.push(Y+W+J)}return Q},O5={GET:!0,HEAD:!0,OPTIONS:!0,DELETE:!0,PATCH:!0,POST:!0,PUT:!0},AY=(Z)=>{if(!Z.config.aot||!Z.config.systemRouter)return;let $={},Q=(W,X)=>{if($[W.path]){if(!$[W.path][W.method])$[W.path][W.method]=X}else $[W.path]={[W.method]:X}},Y=Z.routeTree;for(let W of Z.router.history){if(typeof W.handler!=="function")continue;let X=W.method;if(X==="GET"&&`WS_${W.path}`in Y||X==="WS"||W.path.charCodeAt(W.path.length-1)===42||!(X in O5))continue;if(X==="ALL"){if(!(`WS_${W.path}`in Y))$[W.path]=W.hooks?.config?.mount?W.hooks.trace||Z.event.trace||Z.extender.higherOrderFunctions?wY(Z,W):W.hooks.mount||W.handler:W.handler;continue}let J,z=Z.config.precompile?wY(Z,W):(U)=>{if(J)return J(U);return(J=wY(Z,W))(U)};for(let U of S5(W.path))Q({method:X,path:U},z)}return $},IZ=(Z,$)=>{if(!$)return Z;for(let Q of Object.keys($)){if(Z[Q]===$[Q])continue;if(!Z[Q]){Z[Q]=$[Q];continue}if(Z[Q]&&$[Q]){if(typeof Z[Q]==="function"||Z[Q]instanceof Response){Z[Q]=$[Q];continue}Z[Q]={...Z[Q],...$[Q]}}}return Z},JS={...PY,name:"bun",handler:{mapResponse:P8,mapEarlyResponse:_8,mapCompactResponse:M6,createStaticHandler:$S,createNativeStaticHandler:QS},composeHandler:{...PY.composeHandler,headers:VQ?`c.headers=c.request.headers.toJSON()
`:`c.headers={}
for(const [k,v] of c.request.headers.entries())c.headers[k]=v
`},listen(Z){return($,Q)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(Z.compile(),typeof $==="string"){if(!VY($))throw new Error("Port must be a numeric value");$=parseInt($)}let Y=(X,{withAsync:J=!1}={})=>{let z={},U=[];for(let[q,G]of Object.entries(X))if(Q5){if(!G)continue;for(let[D,A]of Object.entries(G)){if(!A||!(D in O5))continue;if(A instanceof Promise){if(J){if(!z[q])z[q]={};U.push(A.then((H)=>{if(H instanceof Response)z[q][D]=H}))}continue}if(!(A instanceof Response))continue;if(!z[q])z[q]={};z[q][D]=A}}else{if(!G)continue;if(G instanceof Promise){if(J){if(!z[q])z[q]={};U.push(G.then((D)=>{if(D instanceof Response)z[q]=D}))}continue}if(!(G instanceof Response))continue;z[q]=G}if(J)return Promise.all(U).then(()=>z);return z},W=typeof $==="object"?{development:!L$,reusePort:!0,...Z.config.serve||{},...$||{},routes:IZ(IZ(Y(Z.router.response),AY(Z)),Z.config.serve?.routes),websocket:{...Z.config.websocket||{},...p4||{}},fetch:Z.fetch}:{development:!L$,reusePort:!0,...Z.config.serve||{},routes:IZ(IZ(Y(Z.router.response),AY(Z)),Z.config.serve?.routes),websocket:{...Z.config.websocket||{},...p4||{}},port:$,fetch:Z.fetch};if(Z.server=Bun.serve(W),Z.event.start)for(let X=0;X<Z.event.start.length;X++)Z.event.start[X].fn(Z);if(Q)Q(Z.server);process.on("beforeExit",()=>{if(Z.server){if(Z.server.stop?.(),Z.server=null,Z.event.stop)for(let X=0;X<Z.event.stop.length;X++)Z.event.stop[X].fn(Z)}}),Z.promisedModules.then(async()=>{Z.server?.reload({...W,fetch:Z.fetch,routes:IZ(IZ(await Y(Z.router.response,{withAsync:!0}),AY(Z)),Z.config.serve?.routes)}),Bun?.gc(!1)})}},ws(Z,$,Q){let{parse:Y,body:W,response:X,...J}=Q,z=X8(W,{modules:Z.definitions.typebox,models:Z.definitions.type,normalize:Z.config.normalize}),U=X8(X,{modules:Z.definitions.typebox,models:Z.definitions.type,normalize:Z.config.normalize});Z.route("WS",$,async(q)=>{let G=Z.getServer(),{set:D,path:A,qi:H,headers:M,query:L,params:O}=q;if(q.validator=U,Q.upgrade){if(typeof Q.upgrade==="function"){let T=Q.upgrade(q);if(T instanceof Promise)await T}else if(Q.upgrade)Object.assign(D.headers,Q.upgrade)}if(D.cookie&&I0(D.cookie)){let T=q5(D.cookie);if(T)D.headers["set-cookie"]=T}if(D.headers["set-cookie"]&&Array.isArray(D.headers["set-cookie"]))D.headers=G5(new Headers(D.headers),D.headers["set-cookie"]);let m=WS(U),_=YS(Y),b,l=[...Array.isArray(Q.error)?Q.error:[Q.error],...(Z.event.error??[]).map((T)=>typeof T==="function"?T:T.fn)].filter((T)=>T),t=!l.length?()=>{}:async(T,x)=>{for(let d of l){let j=d(Object.assign(q,{error:x}));if(j instanceof Promise)j=await j;if(await m(T,j),j)break}};if(G?.upgrade(q.request,{headers:I0(D.headers)?D.headers:void 0,data:{...q,get id(){if(b)return b;return b=hQ()},validator:U,ping(T){Q.ping?.(T)},pong(T){Q.pong?.(T)},open(T){try{m(T,Q.open?.(new D$(T,q)))}catch(x){t(T,x)}},message:async(T,x)=>{let d=await _(T,x);if(z?.Check(d)===!1)return void T.send(new K0("message",z,d).message);try{m(T,Q.message?.(new D$(T,q,d),d))}catch(j){t(T,j)}},drain(T){try{m(T,Q.drain?.(new D$(T,q)))}catch(x){t(T,x)}},close(T,x,d){try{m(T,Q.close?.(new D$(T,q),x,d))}catch(j){t(T,j)}}}}))return;return D.status=400,"Expected a websocket connection"},{...J,websocket:Q})}},i4=kZ?Bun.env:typeof process!=="undefined"&&process?.env?process.env:{},LY=(Z,$)=>{for(let[Q,Y]of Object.entries(Z.schema.properties))$[Q]??=Y.default},l4=(Z)=>{let{mapResponse:$,mapEarlyResponse:Q}=Z["~adapter"].handler;return async(Y)=>{let W=Y.url,X=W.indexOf("/",11),J=W.indexOf("?",X+1),z=J===-1?W.substring(X):W.substring(X,J),U={cookie:{},status:200,headers:{}},q=Object.assign({},Z.singleton.decorator,{set:U,store:Z.singleton.store,request:Y,path:z,qi:J,error:bQ,status:bQ,redirect:EY});try{if(Z.event.request)for(let x=0;x<Z.event.request.length;x++){let d=Z.event.request[x].fn,j=d(q);if(j instanceof Promise)j=await j;if(j=Q(j,U),j)return q.response=j}let G=Z.router.dynamic.find(Y.method,z)??Z.router.dynamic.find("ALL",z);if(!G)throw new IY;let{handle:D,hooks:A,validator:H,content:M,route:L}=G.store,O;if(Y.method!=="GET"&&Y.method!=="HEAD")if(M)switch(M){case"application/json":O=await Y.json();break;case"text/plain":O=await Y.text();break;case"application/x-www-form-urlencoded":O=KQ(await Y.text());break;case"application/octet-stream":O=await Y.arrayBuffer();break;case"multipart/form-data":O={};let x=await Y.formData();for(let d of x.keys()){if(O[d])continue;let j=x.getAll(d);if(j.length===1)O[d]=j[0];else O[d]=j}break}else{let x=Y.headers.get("content-type");if(x){let d=x.indexOf(";");if(d!==-1)x=x.slice(0,d);if(q.contentType=x,A.parse)for(let j=0;j<A.parse.length;j++){let p=A.parse[j].fn,Z0=p(q,x);if(Z0 instanceof Promise)Z0=await Z0;if(Z0){O=Z0;break}}if(delete q.contentType,O===void 0)switch(x){case"application/json":O=await Y.json();break;case"text/plain":O=await Y.text();break;case"application/x-www-form-urlencoded":O=KQ(await Y.text());break;case"application/octet-stream":O=await Y.arrayBuffer();break;case"multipart/form-data":O={};let j=await Y.formData();for(let p of j.keys()){if(O[p])continue;let Z0=j.getAll(p);if(Z0.length===1)O[p]=Z0[0];else O[p]=Z0}break}}}q.route=L,q.body=O,q.params=G?.params||void 0,q.query=J===-1?{}:KQ(W.substring(J+1)),q.headers={};for(let[x,d]of Y.headers.entries())q.headers[x]=d;let m=Object.assign({},Z.config?.cookie,H?.cookie?.config),_=Y.headers.get("cookie");q.cookie=await U5(q.set,_,m?{secrets:m.secrets!==void 0?typeof m.secrets==="string"?m.secrets:m.secrets.join(","):void 0,sign:m.sign===!0?!0:m.sign!==void 0?typeof m.sign==="string"?m.sign:m.sign.join(","):void 0}:void 0);let b=H?.createHeaders?.();if(b)LY(b,q.headers);let l=H?.createParams?.();if(l)LY(l,q.params);let t=H?.createQuery?.();if(t)LY(t,q.query);if(A.transform)for(let x=0;x<A.transform.length;x++){let d=A.transform[x],j=d.fn(q);if(d.subType==="derive")if(j instanceof Promise)Object.assign(q,await j);else Object.assign(q,j);else if(j instanceof Promise)await j}if(H){if(b){let x=structuredClone(q.headers);for(let[d,j]of Y.headers)x[d]=j;if(H.headers.Check(x)===!1)throw new K0("header",H.headers,x)}else if(H.headers?.Decode)q.headers=H.headers.Decode(q.headers);if(l?.Check(q.params)===!1)throw new K0("params",H.params,q.params);else if(H.params?.Decode)q.params=H.params.Decode(q.params);if(t?.Check(q.query)===!1)throw new K0("query",H.query,q.query);else if(H.query?.Decode)q.query=H.query.Decode(q.query);if(H.createCookie?.()){let x={};for(let[d,j]of Object.entries(q.cookie))x[d]=j.value;if(H.cookie.Check(x)===!1)throw new K0("cookie",H.cookie,x);else if(H.cookie?.Decode)x=H.cookie.Decode(x)}if(H.createBody?.()?.Check(O)===!1)throw new K0("body",H.body,O);else if(H.body?.Decode)q.body=H.body.Decode(O)}if(A.beforeHandle)for(let x=0;x<A.beforeHandle.length;x++){let d=A.beforeHandle[x],j=d.fn(q);if(d.subType==="resolve"){if(j instanceof K8){let p=Q(j,q.set);if(p)return q.response=p}if(j instanceof Promise)Object.assign(q,await j);else Object.assign(q,j);continue}else if(j instanceof Promise)j=await j;if(j!==void 0){if(q.response=j,A.afterHandle)for(let Z0=0;Z0<A.afterHandle.length;Z0++){let U0=A.afterHandle[Z0].fn(q);if(U0 instanceof Promise)U0=await U0;if(U0)j=U0}let p=Q(j,q.set);if(p)return q.response=p}}let T=typeof D==="function"?D(q):D;if(T instanceof Promise)T=await T;if(A.afterHandle)if(!A.afterHandle.length){let x=T instanceof K8?T.code:U.status?typeof U.status==="string"?vQ[U.status]:U.status:200,d=H?.createResponse?.()?.[x];if(d?.Check(T)===!1)throw new K0("response",d,T);else if(d?.Decode)T=d.Decode(T)}else{q.response=T;for(let x=0;x<A.afterHandle.length;x++){let d=A.afterHandle[x].fn(q);if(d instanceof Promise)d=await d;let j=Q(d,q.set);if(j!==void 0){let p=H?.response?.[j.status];if(p?.Check(j)===!1)throw new K0("response",p,j);else if(p?.Decode)T=p.Decode(T);return q.response=j}}}if(q.set.cookie&&m?.sign){let x=!m.secrets?void 0:typeof m.secrets==="string"?m.secrets:m.secrets[0];if(m.sign===!0)for(let[d,j]of Object.entries(q.set.cookie))q.set.cookie[d].value=await EQ(j.value,"${secret}");else{let d=H?.cookie?.schema?.properties;for(let j of m.sign){if(!(j in d))continue;if(q.set.cookie[j]?.value)q.set.cookie[j].value=await EQ(q.set.cookie[j].value,x)}}}return $(q.response=T,q.set)}catch(G){let D=G instanceof DQ&&G.error?G.error:G;return Z.handleError(q,D)}finally{if(Z.event.afterResponse)for(let G of Z.event.afterResponse)await G.fn(q)}}},zS=(Z)=>{let{mapResponse:$}=Z["~adapter"].handler;return async(Q,Y)=>{let W=Object.assign(Q,{error:Y,code:Y.code});if(W.set=Q.set,Z.event.error)for(let X=0;X<Z.event.error.length;X++){let J=Z.event.error[X].fn(W);if(J instanceof Promise)J=await J;if(J!==void 0&&J!==null)return Q.response=$(J,Q.set)}return new Response(typeof Y.cause==="string"?Y.cause:Y.message,{headers:Q.set.headers,status:Y.status??500})}};class f8{config;server=null;dependencies={};"~Prefix"="";"~Singleton"=null;"~Definitions"=null;"~Metadata"=null;"~Ephemeral"=null;"~Volatile"=null;"~Routes"=null;singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:k.Module({}),type:{},error:{}};extender={macros:[],higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){return q$(q$(this.global,this.scoped),this.local)}};standaloneValidator={global:null,scoped:null,local:null};event={};telemetry;router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new TZ({lazy:!0});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new TZ;return this["~dynamic"]},static:{},response:{},history:[]};routeTree={};get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}getGlobalDefinitions(){return this.definitions}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,path:!1,route:!1,url:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new $5(console.error,()=>{});return this._promisedModules}constructor(Z={}){if(Z.tags)if(!Z.detail)Z.detail={tags:Z.tags};else Z.detail.tags=Z.tags;if(this.config={prefix:"",aot:i4.ELYSIA_AOT!=="false",nativeStaticResponse:!0,systemRouter:!0,encodeSchema:!0,normalize:!0,...Z,cookie:{path:"/",...Z?.cookie},experimental:Z?.experimental??{},seed:Z?.seed===void 0?"":Z?.seed},this["~adapter"]=Z.adapter??(typeof Bun!=="undefined"?JS:PY),Z?.analytic&&(Z?.name||Z?.seed!==void 0))this.telemetry={stack:new Error().stack}}"~adapter";env(Z,$=i4){if(X8(Z,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0,sanitize:()=>this.config.sanitize}).Check($)===!1){let Q=new K0("env",Z,$);throw new Error(Q.all.map((Y)=>Y.summary).join(`
`))}return this}wrap(Z){return this.extender.higherOrderFunctions.push({checksum:bZ(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Z.toString()})),fn:Z}),this}applyMacro(Z){if(this.extender.macros.length){let $=PL({globalHook:this.event,localHook:Z}),Q={events:{global:this.event,local:Z},get onParse(){return $("parse")},get onTransform(){return $("transform")},get onBeforeHandle(){return $("beforeHandle")},get onAfterHandle(){return $("afterHandle")},get mapResponse(){return $("mapResponse")},get onAfterResponse(){return $("afterResponse")},get onError(){return $("error")}};for(let Y of this.extender.macros)_L(Y.fn(Q),Z,$)}}get models(){let Z={};for(let $ of Object.keys(this.definitions.type))Z[$]=X8(this.definitions.typebox.Import($));return Z.modules=this.definitions.typebox,Z}add(Z,$,Q,Y,W,X){let J=W?.skipPrefix??!1,z=W?.allowMeta??!1;if(Y??={},X===void 0){if(X=[],this.standaloneValidator.local)X=X.concat(this.standaloneValidator.local);if(this.standaloneValidator.scoped)X=X.concat(this.standaloneValidator.scoped);if(this.standaloneValidator.global)X=X.concat(this.standaloneValidator.global)}if($!==""&&$.charCodeAt(0)!==47)$="/"+$;if(this.config.prefix&&!J)$=this.config.prefix+$;if(Y?.type)switch(Y.type){case"text":Y.type="text/plain";break;case"json":Y.type="application/json";break;case"formdata":Y.type="multipart/form-data";break;case"urlencoded":Y.type="application/x-www-form-urlencoded";break;case"arrayBuffer":Y.type="application/octet-stream";break;default:break}let U=this.validator.getCandidate(),q={body:Y?.body??U?.body,headers:Y?.headers??U?.headers,params:Y?.params??U?.params,query:Y?.query??U?.query,cookie:Y?.cookie??U?.cookie,response:Y?.response??U?.response},G=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,D=()=>{let j=this.definitions.type,p=!this.config.aot,Z0=this.config.normalize,U0=this.definitions.typebox,q0=()=>this.config.sanitize,U1=()=>{if(q.cookie||X.find((L0)=>L0.cookie))return N5({modules:U0,validator:q.cookie,defaultConfig:this.config.cookie,config:q.cookie?.config??{},dynamic:p,models:j,validators:X.map((L0)=>L0.cookie),sanitize:q0})};return G?{body:X8(q.body,{modules:U0,dynamic:p,models:j,normalize:Z0,additionalCoerce:CY(),validators:X.map((L0)=>L0.body),sanitize:q0}),headers:X8(q.headers,{modules:U0,dynamic:p,models:j,additionalProperties:!0,coerce:!0,additionalCoerce:e6(),validators:X.map((L0)=>L0.headers),sanitize:q0}),params:X8(q.params,{modules:U0,dynamic:p,models:j,coerce:!0,additionalCoerce:e6(),validators:X.map((L0)=>L0.params),sanitize:q0}),query:X8(q.query,{modules:U0,dynamic:p,models:j,normalize:Z0,coerce:!0,additionalCoerce:e6(),validators:X.map((L0)=>L0.query),sanitize:q0}),cookie:U1(),response:c4(q.response,{modules:U0,dynamic:p,models:j,normalize:Z0,validators:X.map((L0)=>L0.response),sanitize:q0})}:{createBody(){if(this.body)return this.body;return this.body=X8(q.body,{modules:U0,dynamic:p,models:j,normalize:Z0,additionalCoerce:CY(),validators:X.map((L0)=>L0.body),sanitize:q0})},createHeaders(){if(this.headers)return this.headers;return this.headers=X8(q.headers,{modules:U0,dynamic:p,models:j,additionalProperties:!Z0,coerce:!0,additionalCoerce:e6(),validators:X.map((L0)=>L0.headers),sanitize:q0})},createParams(){if(this.params)return this.params;return this.params=X8(q.params,{modules:U0,dynamic:p,models:j,coerce:!0,additionalCoerce:e6(),validators:X.map((L0)=>L0.params),sanitize:q0})},createQuery(){if(this.query)return this.query;return this.query=X8(q.query,{modules:U0,dynamic:p,models:j,coerce:!0,additionalCoerce:e6(),validators:X.map((L0)=>L0.query),sanitize:q0})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=U1()},createResponse(){if(this.response)return this.response;return this.response=c4(q.response,{modules:U0,dynamic:p,models:j,normalize:Z0,validators:X.map((L0)=>L0.response),sanitize:q0})}}};if(U.body||U.cookie||U.headers||U.params||U.query||U.response)Y=J6(Y,U);if(Y.tags)if(!Y.detail)Y.detail={tags:Y.tags};else Y.detail.tags=Y.tags;if(I0(this.config.detail))Y.detail=g8(Object.assign({},this.config.detail),Y.detail);this.applyMacro(Y);let A=I0(this.event)?J6(this.event,E4(Y)):LL(E4(Y));if(this.config.aot===!1){let j=D();this.router.dynamic.add(Z,$,{validator:j,hooks:A,content:Y?.type,handle:Q,route:$});let p=B$($,{dynamic:!0});if($!==p)this.router.dynamic.add(Z,p,{validator:j,hooks:A,content:Y?.type,handle:Q,route:$});if(this.config.strictPath===!1){let Z0=M$($);this.router.dynamic.add(Z,Z0,{validator:j,hooks:A,content:Y?.type,handle:Q,route:$});let U0=B$(Z0);if(Z0!==U0)this.router.dynamic.add(Z,Z0,{validator:j,hooks:A,content:Y?.type,handle:Q,route:$})}this.router.history.push({method:Z,path:$,composed:null,handler:Q,compile:void 0,hooks:A,standaloneValidators:X});return}let H=this["~adapter"].handler,M=typeof Q!=="function"?()=>{let j=H.createNativeStaticHandler?.(Q,A,this.setHeaders);return j instanceof Promise?j.then((p)=>{if(p)return p}):j?.()}:void 0,L=this.config.nativeStaticResponse===!0,O=(j)=>{if(!L||!M)return;if(Q5)if(this.router.response[j])this.router.response[j][Z]=M();else this.router.response[j]={[Z]:M()};else this.router.response[j]=M()};O($);let m,_=()=>{if(m)return m;return m=ZS({app:this,path:$,method:Z,hooks:A,validator:D(),handler:typeof Q!=="function"&&typeof H.createStaticHandler!=="function"?()=>Q:Q,allowMeta:z,inference:this.inference})},b;if(`${Z}_${$}`in this.routeTree)for(let j=0;j<this.router.history.length;j++){let p=this.router.history[j];if(p.path===$&&p.method===Z){b=j;break}}else this.routeTree[`${Z}_${$}`]=this.router.history.length;let l=b??this.router.history.length,t=G?_():(j)=>(this.router.history[l].composed=_())(j);if(b!==void 0)this.router.history[b]=Object.assign({method:Z,path:$,composed:t,compile:_,handler:Q,hooks:A},X.length?{standaloneValidators:X}:void 0,Y.webSocket?{websocket:Y.websocket}:void 0);else this.router.history.push(Object.assign({method:Z,path:$,composed:t,compile:_,handler:Q,hooks:A},X.length?{standaloneValidators:X}:void 0,Y.webSocket?{websocket:Y.websocket}:void 0));let T={handler:G?t:void 0,compile(){return this.handler=_()}},x=this.router.static,d=$.indexOf(":")===-1&&$.indexOf("*")===-1;if(Z==="WS"){if(d){if($ in x)x[$][Z]=l;else x[$]={[Z]:l};return}if(this.router.http.add("WS",$,T),!this.config.strictPath)this.router.http.add("WS",M$($),T);let j=B$($,{dynamic:!0});if($!==j)this.router.http.add("WS",j,T);return}if(d){if($ in x)x[$][Z]=l;else x[$]={[Z]:l};if(!this.config.strictPath)O(M$($))}else{this.router.http.add(Z,$,T);let j=typeof Q!=="function"&&typeof H.createStaticHandler==="function"?H.createStaticHandler(Q,A,this.setHeaders):void 0;if(!this.config.strictPath){let Z0=M$($);O(Z0),this.router.http.add(Z,Z0,T)}let p=B$($,{dynamic:!0});if($!==p)this.router.http.add(Z,p,T),O(p)}}setHeaders;headers(Z){if(!Z)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=g8(this.setHeaders,Z),this}onStart(Z){return this.on("start",Z),this}onRequest(Z){return this.on("request",Z),this}onParse(Z,$){if(!$){if(typeof Z==="string")return this.on("parse",this["~parser"][Z]);return this.on("parse",Z)}return this.on(Z,"parse",$)}parser(Z,$){return this["~parser"][Z]=$,this}onTransform(Z,$){if(!$)return this.on("transform",Z);return this.on(Z,"transform",$)}resolve(Z,$){if(!$)$=Z,Z={as:"local"};let Q={subType:"resolve",fn:$};return this.onBeforeHandle(Z,Q)}mapResolve(Z,$){if(!$)$=Z,Z={as:"local"};let Q={subType:"mapResolve",fn:$};return this.onBeforeHandle(Z,Q)}onBeforeHandle(Z,$){if(!$)return this.on("beforeHandle",Z);return this.on(Z,"beforeHandle",$)}onAfterHandle(Z,$){if(!$)return this.on("afterHandle",Z);return this.on(Z,"afterHandle",$)}mapResponse(Z,$){if(!$)return this.on("mapResponse",Z);return this.on(Z,"mapResponse",$)}onAfterResponse(Z,$){if(!$)return this.on("afterResponse",Z);return this.on(Z,"afterResponse",$)}trace(Z,$){if(!$)$=Z,Z={as:"local"};if(!Array.isArray($))$=[$];for(let Q of $)this.on(Z,"trace",cL(Q));return this}error(Z,$){switch(typeof Z){case"string":return $.prototype[IQ]=Z,this.definitions.error[Z]=$,this;case"function":return this.definitions.error=Z(this.definitions.error),this}for(let[Q,Y]of Object.entries(Z))Y.prototype[IQ]=Q,this.definitions.error[Q]=Y;return this}onError(Z,$){if(!$)return this.on("error",Z);return this.on(Z,"error",$)}onStop(Z){return this.on("stop",Z),this}on(Z,$,Q){let Y;switch(typeof Z){case"string":Y=Z,Q=$;break;case"object":if(Y=$,!Array.isArray($)&&typeof $==="object")Q=$;break}if(Array.isArray(Q))Q=$8(Q);else if(typeof Q==="function")Q=[{fn:Q}];else Q=[Q];let W=Q;for(let X of W)if(X.scope=typeof Z==="string"?"local":Z?.as??"local",Y==="resolve"||Y==="derive")X.subType=Y;if(Y!=="trace")this.inference=S$({[Y]:W.map((X)=>X.fn)},this.inference);for(let X of W){let J=OL(X,"global",{skipIfHasType:!0});switch(Y){case"start":this.event.start??=[],this.event.start.push(J);break;case"request":this.event.request??=[],this.event.request.push(J);break;case"parse":this.event.parse??=[],this.event.parse.push(J);break;case"transform":this.event.transform??=[],this.event.transform.push(J);break;case"derive":this.event.transform??=[],this.event.transform.push($8(J,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(J);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push($8(J,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(J);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(J);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(J);break;case"trace":this.event.trace??=[],this.event.trace.push(J);break;case"error":this.event.error??=[],this.event.error.push(J);break;case"stop":this.event.stop??=[],this.event.stop.push(J);break}}return this}as(Z){if(R6(this.event.parse,Z),R6(this.event.transform,Z),R6(this.event.beforeHandle,Z),R6(this.event.afterHandle,Z),R6(this.event.mapResponse,Z),R6(this.event.afterResponse,Z),R6(this.event.trace,Z),R6(this.event.error,Z),Z==="scoped")this.validator.scoped=q$(this.validator.scoped,this.validator.local),this.validator.local=null;else if(Z==="global")this.validator.global=q$(this.validator.global,q$(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null;return this}group(Z,$,Q){let Y=new f8({...this.config,prefix:""});Y.singleton={...this.singleton},Y.definitions={...this.definitions},Y.getServer=()=>this.getServer(),Y.inference=b4(this.inference),Y.extender={...this.extender},Y["~parser"]=this["~parser"],Y.standaloneValidator={local:[...this.standaloneValidator.local??[]],scoped:[...this.standaloneValidator.scoped??[]],global:[...this.standaloneValidator.global??[]]};let W=typeof $==="object",X=(W?Q:$)(Y);if(this.singleton=g8(this.singleton,Y.singleton),this.definitions=g8(this.definitions,Y.definitions),X.event.request?.length)this.event.request=[...this.event.request||[],...X.event.request||[]];if(X.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...X.event.mapResponse||[]];return this.model(X.definitions.type),Object.values(Y.router.history).forEach(({method:J,path:z,handler:U,hooks:q,standaloneValidators:G})=>{if(z=(W?"":this.config.prefix)+Z+z,W){let D=$,A=q;this.add(J,z,U,J6(D,{...A||{},error:!A.error?X.event.error:Array.isArray(A.error)?[...A.error||{},...X.event.error||{}]:[A.error,...X.event.error||{}]}),void 0,G)}else this.add(J,z,U,J6(q,{error:X.event.error}),{skipPrefix:!0},G)}),this}guard(Z,$){if(!$){if(typeof Z==="object"){if(this.applyMacro(Z),Z.detail)if(this.config.detail)this.config.detail=g8(Object.assign({},this.config.detail),Z.detail);else this.config.detail=Z.detail;if(Z.tags)if(!this.config.detail)this.config.detail={tags:Z.tags};else this.config.detail.tags=Z.tags;let W=Z.as??"local";if(Z.schema==="standalone"){if(!this.standaloneValidator[W])this.standaloneValidator[W]=[];let X=Z?.response||typeof Z?.response==="string"||Z?.response&&S in Z.response?{200:Z.response}:Z?.response;return this.standaloneValidator[W].push({body:Z.body,headers:Z.headers,params:Z.params,query:Z.query,response:X,cookie:Z.cookie}),this}if(this.validator[W]={body:Z.body??this.validator[W]?.body,headers:Z.headers??this.validator[W]?.headers,params:Z.params??this.validator[W]?.params,query:Z.query??this.validator[W]?.query,response:Z.response??this.validator[W]?.response,cookie:Z.cookie??this.validator[W]?.cookie},Z.parse)this.on({as:W},"parse",Z.parse);if(Z.transform)this.on({as:W},"transform",Z.transform);if(Z.derive)this.on({as:W},"derive",Z.derive);if(Z.beforeHandle)this.on({as:W},"beforeHandle",Z.beforeHandle);if(Z.resolve)this.on({as:W},"resolve",Z.resolve);if(Z.afterHandle)this.on({as:W},"afterHandle",Z.afterHandle);if(Z.mapResponse)this.on({as:W},"mapResponse",Z.mapResponse);if(Z.afterResponse)this.on({as:W},"afterResponse",Z.afterResponse);if(Z.error)this.on({as:W},"error",Z.error);return this}return this.guard({},Z)}let Q=new f8({...this.config,prefix:""});Q.singleton={...this.singleton},Q.definitions={...this.definitions},Q.inference=b4(this.inference),Q.extender={...this.extender};let Y=$(Q);if(this.singleton=g8(this.singleton,Q.singleton),this.definitions=g8(this.definitions,Q.definitions),Y.getServer=()=>this.server,Y.event.request?.length)this.event.request=[...this.event.request||[],...Y.event.request||[]];if(Y.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...Y.event.mapResponse||[]];return this.model(Y.definitions.type),Object.values(Q.router.history).forEach(({method:W,path:X,handler:J,hooks:z})=>{this.add(W,X,J,J6(Z,{...z||{},error:!z.error?Y.event.error:Array.isArray(z.error)?[...z.error||{},...Y.event.error||[]]:[z.error,...Y.event.error||[]]}))}),this}use(Z,$){if(Array.isArray(Z)){let Q=this;for(let Y of Z)Q=Q.use(Y);return Q}if($?.scoped)return this.guard({},(Q)=>Q.use(Z));if(Array.isArray(Z)){let Q=this;for(let Y of Z)Q=this.use(Y);return Q}if(Z instanceof Promise)return this.promisedModules.add(Z.then((Q)=>{if(typeof Q==="function")return Q(this);if(Q instanceof f8)return this._use(Q).compile();if(Q.constructor.name==="Elysia")return this._use(Q).compile();if(typeof Q.default==="function")return Q.default(this);if(Q.default instanceof f8)return this._use(Q.default);if(Q.constructor.name==="Elysia")return this._use(Q.default);if(Q.constructor.name==="_Elysia")return this._use(Q.default);try{return this._use(Q.default)}catch(Y){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),Y}}).then((Q)=>{if(Q&&typeof Q.compile==="function")Q.compile();return Q})),this;return this._use(Z)}propagatePromiseModules(Z){if(Z.promisedModules.size<=0)return this;for(let $ of Z.promisedModules.promises)this.promisedModules.add($.then((Q)=>{if(!Q)return;let Y=this._use(Q);if(Y instanceof Promise)return Y.then((W)=>{if(W)W.compile();else Q.compile()});return Q.compile()}));return this}_use(Z){if(typeof Z==="function"){let W=Z(this);if(W instanceof Promise)return this.promisedModules.add(W.then((X)=>{if(X instanceof f8){X.getServer=()=>this.getServer(),X.getGlobalRoutes=()=>this.getGlobalRoutes(),X.getGlobalDefinitions=()=>this.getGlobalDefinitions(),X.model(this.definitions.type),X.error(this.definitions.error);for(let{method:J,path:z,handler:U,hooks:q,standaloneValidators:G}of Object.values(X.router.history))this.add(J,z,U,I0(X.event.error)?J6(q,{error:X.event.error}):q,void 0,G);if(X===this)return;return this.propagatePromiseModules(X),X}if(typeof X==="function")return X(this);if(typeof X.default==="function")return X.default(this);return this._use(X)}).then((X)=>{if(X&&typeof X.compile==="function")X.compile();return X})),this;return W}this.propagatePromiseModules(Z);let $=Z.config.name,Q=Z.config.seed;if(Z.getParent=()=>this,Z.getServer=()=>this.getServer(),Z.getGlobalRoutes=()=>this.getGlobalRoutes(),Z.getGlobalDefinitions=()=>this.getGlobalDefinitions(),Z.standaloneValidator?.scoped)if(this.standaloneValidator.local)this.standaloneValidator.local=this.standaloneValidator.local.concat(Z.standaloneValidator.scoped);else this.standaloneValidator.local=Z.standaloneValidator.scoped;if(Z.standaloneValidator?.global)if(this.standaloneValidator.global)this.standaloneValidator.global=this.standaloneValidator.global.concat(Z.standaloneValidator.global);else this.standaloneValidator.global=Z.standaloneValidator.global;if(I0(Z["~parser"]))this["~parser"]={...Z["~parser"],...this["~parser"]};if(Z.setHeaders)this.headers(Z.setHeaders);if($){if(!($ in this.dependencies))this.dependencies[$]=[];let W=Q!==void 0?bZ($+JSON.stringify(Q)):0;if(!this.dependencies[$].some(({checksum:X})=>W===X))this.extender.macros=this.extender.macros.concat(Z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Z.extender.higherOrderFunctions)}else{if(Z.extender.macros.length)this.extender.macros=this.extender.macros.concat(Z.extender.macros);if(Z.extender.higherOrderFunctions.length)this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Z.extender.higherOrderFunctions)}x4(this.extender.macros),x4(this.extender.higherOrderFunctions);let Y=[];for(let W=0;W<this.extender.higherOrderFunctions.length;W++){let X=this.extender.higherOrderFunctions[W];if(X.checksum){if(Y.includes(X.checksum))this.extender.higherOrderFunctions.splice(W,1),W--;Y.push(X.checksum)}}if(Y.length=0,this.inference=_Y(this.inference,Z.inference),I0(Z.singleton.decorator))this.decorate(Z.singleton.decorator);if(I0(Z.singleton.store))this.state(Z.singleton.store);if(I0(Z.definitions.type))this.model(Z.definitions.type);if(I0(Z.definitions.error))this.error(Z.definitions.error);if(I0(Z.definitions.error))Z.extender.macros=this.extender.macros.concat(Z.extender.macros);for(let{method:W,path:X,handler:J,hooks:z,standaloneValidators:U}of Object.values(Z.router.history))this.add(W,X,J,I0(Z.event.error)?J6(z,{error:Z.event.error}):z,void 0,U);if($){if(!($ in this.dependencies))this.dependencies[$]=[];let W=Q!==void 0?bZ($+JSON.stringify(Q)):0;if(this.dependencies[$].some(({checksum:X})=>W===X))return this;if(this.dependencies[$].push(this.config?.analytic?{name:Z.config.name,seed:Z.config.seed,checksum:W,dependencies:Z.dependencies,stack:Z.telemetry?.stack,routes:Z.router.history,decorators:Z.singleton,store:Z.singleton.store,error:Z.definitions.error,derive:Z.event.transform?.filter((X)=>X?.subType==="derive").map((X)=>({fn:X.toString(),stack:new Error().stack??""})),resolve:Z.event.transform?.filter((X)=>X?.subType==="resolve").map((X)=>({fn:X.toString(),stack:new Error().stack??""}))}:{name:Z.config.name,seed:Z.config.seed,checksum:W,dependencies:Z.dependencies}),I0(Z.event))this.event=K4(this.event,C4(Z.event),W)}else if(I0(Z.event))this.event=K4(this.event,C4(Z.event));if(Z.validator.global)this.validator.global=J6(this.validator.global,{...Z.validator.global});if(Z.validator.scoped)this.validator.local=J6(this.validator.local,{...Z.validator.scoped});return this}macro(Z){if(typeof Z==="function"){let $={checksum:bZ(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Z.toString()})),fn:Z};this.extender.macros.push($)}else if(typeof Z==="object"){for(let Q of Object.keys(Z))if(typeof Z[Q]==="object"){let Y={...Z[Q]};Z[Q]=(W)=>{if(W===!0)return Y}}let $={checksum:bZ(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Object.entries(Z).map(([Q,Y])=>`${Q}+${Y}`).join(",")})),fn:()=>Z};this.extender.macros.push($)}return this}mount(Z,$,Q){if(Z instanceof f8||typeof Z==="function"||Z.length===0||Z==="/"){let J=typeof Z==="function"?Z:Z instanceof f8?Z.compile().fetch:$ instanceof f8?$.compile().fetch:typeof $==="function"?$:(()=>{throw new Error("Invalid handler")})(),z=({request:U,path:q})=>J(new Request(P4(U.url,q),{method:U.method,headers:U.headers,signal:U.signal,credentials:U.credentials,referrerPolicy:U.referrerPolicy,duplex:U.duplex,redirect:U.redirect,mode:U.mode,keepalive:U.keepalive,integrity:U.integrity,body:U.body}));return this.route("ALL","/*",z,{parse:"none",...Q,detail:{...Q?.detail,hide:!0},config:{mount:J}}),this}let Y=$ instanceof f8?$.compile().fetch:typeof $==="function"?$:(()=>{throw new Error("Invalid handler")})(),W=Z.length-(Z.endsWith("*")?1:0),X=({request:J,path:z})=>Y(new Request(P4(J.url,z.slice(W)||"/"),{method:J.method,headers:J.headers,signal:J.signal,credentials:J.credentials,referrerPolicy:J.referrerPolicy,duplex:J.duplex,redirect:J.redirect,mode:J.mode,keepalive:J.keepalive,integrity:J.integrity,body:J.body}));return this.route("ALL",Z,X,{parse:"none",...Q,detail:{...Q?.detail,hide:!0},config:{mount:Y}}),this.route("ALL",Z+(Z.endsWith("/")?"*":"/*"),X,{parse:"none",...Q,detail:{...Q?.detail,hide:!0},config:{mount:Y}}),this}get(Z,$,Q){return this.add("GET",Z,$,Q),this}post(Z,$,Q){return this.add("POST",Z,$,Q),this}put(Z,$,Q){return this.add("PUT",Z,$,Q),this}patch(Z,$,Q){return this.add("PATCH",Z,$,Q),this}delete(Z,$,Q){return this.add("DELETE",Z,$,Q),this}options(Z,$,Q){return this.add("OPTIONS",Z,$,Q),this}all(Z,$,Q){return this.add("ALL",Z,$,Q),this}head(Z,$,Q){return this.add("HEAD",Z,$,Q),this}connect(Z,$,Q){return this.add("CONNECT",Z,$,Q),this}route(Z,$,Q,Y){return this.add(Z.toUpperCase(),$,Q,Y,Y?.config),this}ws(Z,$){if(this["~adapter"].ws)this["~adapter"].ws(this,Z,$);else console.warn("Current adapter doesn't support WebSocket");return this}state(Z,$,Q){if($===void 0)Q=Z,Z={as:"append"},$="";else if(Q===void 0){if(typeof Z==="string")Q=$,$=Z,Z={as:"append"};else if(typeof Z==="object")Q=$,$=""}let{as:Y}=Z;if(typeof $!=="string")return this;switch(typeof Q){case"object":if(!Q||!I0(Q))return this;if($){if($ in this.singleton.store)this.singleton.store[$]=g8(this.singleton.store[$],Q,{override:Y==="override"});else this.singleton.store[$]=Q;return this}if(Q===null)return this;return this.singleton.store=g8(this.singleton.store,Q,{override:Y==="override"}),this;case"function":if($){if(Y==="override"||!($ in this.singleton.store))this.singleton.store[$]=Q}else this.singleton.store=Q(this.singleton.store);return this;default:if(Y==="override"||!($ in this.singleton.store))this.singleton.store[$]=Q;return this}}decorate(Z,$,Q){if($===void 0)Q=Z,Z={as:"append"},$="";else if(Q===void 0){if(typeof Z==="string")Q=$,$=Z,Z={as:"append"};else if(typeof Z==="object")Q=$,$=""}let{as:Y}=Z;if(typeof $!=="string")return this;switch(typeof Q){case"object":if($){if($ in this.singleton.decorator)this.singleton.decorator[$]=g8(this.singleton.decorator[$],Q,{override:Y==="override"});else this.singleton.decorator[$]=Q;return this}if(Q===null)return this;return this.singleton.decorator=g8(this.singleton.decorator,Q,{override:Y==="override"}),this;case"function":if($){if(Y==="override"||!($ in this.singleton.decorator))this.singleton.decorator[$]=Q}else this.singleton.decorator=Q(this.singleton.decorator);return this;default:if(Y==="override"||!($ in this.singleton.decorator))this.singleton.decorator[$]=Q;return this}}derive(Z,$){if(!$)$=Z,Z={as:"local"};let Q={subType:"derive",fn:$};return this.onTransform(Z,Q)}model(Z,$){switch(typeof Z){case"object":let Q={},Y=Object.entries(Z);if(!Y.length)return this;for(let[J,z]of Y){if(J in this.definitions.type)continue;Q[J]=this.definitions.type[J]=z,Q[J].$id??=`#/components/schemas/${J}`}return this.definitions.typebox=k.Module({...this.definitions.typebox.$defs,...Q}),this;case"function":let W=Z(this.definitions.type);return this.definitions.type=W,this.definitions.typebox=k.Module(W),this;case"string":if(!$)break;let X={...$,id:$.$id??`#/components/schemas/${Z}`};return this.definitions.type[Z]=$,this.definitions.typebox=k.Module({...this.definitions.typebox.$defs,...X}),this}return this.definitions.type[Z]=$,this.definitions.typebox=k.Module({...this.definitions.typebox.$defs,[Z]:$}),this}Ref(Z){return k.Ref(Z)}mapDerive(Z,$){if(!$)$=Z,Z={as:"local"};let Q={subType:"mapDerive",fn:$};return this.onTransform(Z,Q)}affix(Z,$,Q){if(Q==="")return this;let Y=["_","-"," "],W=(U)=>U[0].toUpperCase()+U.slice(1),X=Z==="prefix"?(U,q)=>Y.includes(U.at(-1)??"")?U+q:U+W(q):Y.includes(Q.at(-1)??"")?(U,q)=>q+U:(U,q)=>q+W(U),J=(U)=>{let q={};switch(U){case"decorator":for(let G in this.singleton.decorator)q[X(Q,G)]=this.singleton.decorator[G];this.singleton.decorator=q;break;case"state":for(let G in this.singleton.store)q[X(Q,G)]=this.singleton.store[G];this.singleton.store=q;break;case"model":for(let G in this.definitions.type)q[X(Q,G)]=this.definitions.type[G];this.definitions.type=q;break;case"error":for(let G in this.definitions.error)q[X(Q,G)]=this.definitions.error[G];this.definitions.error=q;break}},z=Array.isArray($)?$:[$];for(let U of z.some((q)=>q==="all")?["decorator","state","model","error"]:z)J(U);return this}prefix(Z,$){return this.affix("prefix",Z,$)}suffix(Z,$){return this.affix("suffix",Z,$)}compile(){if(this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?NY(this):l4(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=NY(this),this}handle=async(Z)=>this.fetch(Z);fetch=(Z)=>{return(this.fetch=this.config.aot?NY(this):l4(this))(Z)};handleError=async(Z,$)=>{return(this.handleError=this.config.aot?L5(this):zS(this))(Z,$)};listen=(Z,$)=>{if(this["~adapter"].listen(this)(Z,$),this.promisedModules.size)y4(5000);return this.promisedModules.then(()=>{y4(1000)}),this};stop=async(Z)=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(Z),this.server=null,this.event.stop?.length)for(let $=0;$<this.event.stop.length;$++)this.event.stop[$].fn(this)}};get modules(){return this.promisedModules}}var US=typeof new Headers()?.toJSON==="function",qS=(Z)=>{if(US)return Object.keys(Z.toJSON()).join(", ");let $="",Q=0;return Z.forEach((Y,W)=>{if(Q)$=$+", "+W;else $=W;Q++}),$},F5=(Z)=>{let{aot:$=!0,origin:Q=!0,methods:Y=!0,allowedHeaders:W=!0,exposeHeaders:X=!0,credentials:J=!0,maxAge:z=5,preflight:U=!0}=Z??{};if(Array.isArray(W))W=W.join(", ");if(Array.isArray(X))X=X.join(", ");let q=typeof Q==="boolean"?void 0:Array.isArray(Q)?Q:[Q],G=new f8({name:"@elysiajs/cors",seed:Z,aot:$}),D=q?.some((_)=>_==="*"),A={};if(q){for(let _ of q)if(typeof _==="string")A[_]=!0}let H=(_,b,l)=>{if(Array.isArray(_))return _.some((t)=>H(t,b,l));switch(typeof _){case"string":if(l in A)return!0;let t=l.indexOf("://");if(t!==-1)l=l.slice(t+3);return _===l;case"function":return _(b)===!0;case"object":if(_ instanceof RegExp)return _.test(l)}return!1},M=(_,b)=>{if(Q===!0){_.headers.vary="*",_.headers["access-control-allow-origin"]=b.headers.get("Origin")||"*";return}if(D){_.headers.vary="*",_.headers["access-control-allow-origin"]="*";return}if(!q?.length)return;let l=[];if(q.length){let t=b.headers.get("Origin")??"";for(let T=0;T<q.length;T++)if(H(q[T],b,t)===!0){_.headers.vary=Q?"Origin":"*",_.headers["access-control-allow-origin"]=t||"*";return}}if(_.headers.vary="Origin",l.length)_.headers["access-control-allow-origin"]=l.join(", ")},L=(_,b)=>{if(!b)return;if(Y===!0)return _.headers["access-control-allow-methods"]=b??"*";if(Y===!1||!Y?.length)return;if(Y==="*")return _.headers["access-control-allow-methods"]="*";if(!Array.isArray(Y))return _.headers["access-control-allow-methods"]=Y;_.headers["access-control-allow-methods"]=Y.join(", ")},O={};if(typeof X==="string")O["access-control-expose-headers"]=X;if(typeof W==="string")O["access-control-allow-headers"]=W;if(J===!0)O["access-control-allow-credentials"]="true";G.headers(O);function m({set:_,request:b,headers:l}){if(M(_,b),L(_,b.headers.get("access-control-request-method")),W===!0||X===!0){if(W===!0)_.headers["access-control-allow-headers"]=l["access-control-request-headers"];if(X===!0)_.headers["access-control-expose-headers"]=Object.keys(l).join(",")}if(z)_.headers["access-control-max-age"]=z.toString();return new Response(null,{status:204})}if(U)G.options("/",m).options("/*",m);return G.onRequest(function _({set:b,request:l}){if(M(b,l),L(b,l.method),W===!0||X===!0){let t=qS(l.headers);if(W===!0)b.headers["access-control-allow-headers"]=t;if(X===!0)b.headers["access-control-expose-headers"]=t}})};var ez=CQ(az(),1);var f6={jwt:{EXPIRATION_TIME:3600,KEY_PREFIX:"jwt",REDIS_DB_KEY:0},avatar:{EXPIRATION_TIME:21600,KEY_PREFIX:"avatar",REDIS_DB_KEY:1},lessons:{EXPIRATION_TIME:3600,KEY_PREFIX:"lessons",REDIS_DB_KEY:2},periods:{EXPIRATION_TIME:3600,KEY_PREFIX:"periods",REDIS_DB_KEY:3},users:{EXPIRATION_TIME:86400,KEY_PREFIX:"users",REDIS_DB_KEY:9}};var{RedisClient:NC}=globalThis.Bun;var S9=new NC(process.env.REDIS_URL);var y6=async(Z,$,Q)=>{try{let Y=await S9.get(Z);if(!Y||Y.length<2||Y[1][0])return null;let W=Y[1][1];if(typeof W!=="string")return null;return Q?JSON.parse(W):W}catch(Y){return console.error("Redis get error:",Y),null}},mZ=async(Z,$,Q,Y,W)=>{console.log("set cache");try{let X=W?JSON.stringify($):$;if(!await S9.set(Z,X,"EX",Q))console.log("insert error!")}catch(X){console.error("Redis set error:",X)}};var ZU=process.env.JWT_SECRET_KEY,w2=f6.jwt;if(!ZU)throw new Error("JWT_SECRET_KEY is not defined in environment variables.");async function wC(Z){try{let $=ez.default.verify(Z,ZU),Q=Math.floor(Date.now()/1000);if(!$||!$.exp||$.exp<Q)return null;return await mZ(Z,$,w2.EXPIRATION_TIME,w2.REDIS_DB_KEY,!0),$}catch($){return null}}async function $U(Z){let $=Z.split(" ");if($.length!==2||$[0]!=="Bearer")return null;let Q=$[1],Y=Math.floor(Date.now()/1000),W=await y6(Q,w2.REDIS_DB_KEY,!0);if(W?.exp&&W.exp>Y)return W;return await wC(Q)}async function O9(Z,$){if(!Z.authorization)return{status:!1,message:"Access denied. No token provided."};let Q=await $U(Z.authorization);if(!Q)return{status:!1,message:"Access denied. User not found."};if(!Q.userId)return{status:!1,message:"Access denied. Invalid token."};if(!$.includes(Q.role))return{status:!1,message:"You do not have permission to access this resource."};return{status:!0,user:Q}}var{SQL:AC}=globalThis.Bun;var QU=new AC({url:process.env.DATABASE_URL});var YU=async({userId:Z})=>{if(!Z)return null;try{let $=f6.lessons,Q="SPRING",Y="c12d4575-d3d3-4a42-bb19-61409470331c",W=await y6(Z,$.REDIS_DB_KEY,!0);if(W)return W;let X=await QU`SELECT
                              to_jsonb (note) AS note,
                              to_jsonb (lesson) AS lesson,
                              to_jsonb (instructor) AS instructor,
                              period
                            FROM
                              "note"
                              INNER JOIN "lesson" ON "note"."lesson_id" = "lesson"."id"
                              INNER JOIN "instructor" ON "lesson"."instructor_id" = "instructor"."id"
                              INNER JOIN "note_to_period" ON "note_to_period"."note_id" = "note"."id"
                              INNER JOIN "period" ON "period"."id" = "note_to_period"."period_id"
                            WHERE
                              ("note"."user_id" = ${Z} AND "period"."id" = ${"c12d4575-d3d3-4a42-bb19-61409470331c"} AND "period"."semester" = ${"SPRING"})`;return await mZ(Z,X,$.EXPIRATION_TIME,$.REDIS_DB_KEY,!0),X}catch($){throw console.error("Error fetching lessons:",$),new Error("Failed to fetch lessons from the database")}};var WU=async({userId:Z})=>{if(!Z)return null;try{let $=f6.periods,Q=await y6(Z,$.REDIS_DB_KEY,!0);if(Q)return Q}catch($){throw console.error("Error fetching periods:",$),new Error("Failed to fetch periods from the database")}};var{S3Client:LC}=globalThis.Bun;var XU=new LC({accessKeyId:process.env.MINIO_ACCESS_KEY,secretAccessKey:process.env.MINIO_SECRET_KEY,endpoint:process.env.MINIO_END_POINT});var JU=async({userId:Z,bucketId:$})=>{if(!Z)return null;try{if(!Z||!$)return null;let Q=f6.avatar,Y=await y6(Z,Q.REDIS_DB_KEY,!1);if(Y)return Y;let W=XU.presign(`${$}/avatar/${Z}.png`,{expiresIn:21600,acl:"private"});if(!W)return null;return await mZ(Z,W,Q.EXPIRATION_TIME,Q.REDIS_DB_KEY,!1),W}catch(Q){throw console.error("Error fetching avatar:",Q),new Error("Failed to fetch avatar from the S3 server")}};var zU=["*","http://192.168.1.34:3000","http://localhost:3000","https://misy-dev.vercel.app","https://misy.online"];new f8().use(F5({origin:zU,allowedHeaders:"Content-Type,Authorization,Expires,Cache-Control,Pragma",methods:"GET,POST,PUT,DELETE,OPTIONS"})).get("/api/avatar",async({headers:Z})=>{let $=await O9(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Q=await JU({userId:$.user?.userId,bucketId:$.user?.bucketId});return Q.length===0?{status:"success",message:"No avatar found."}:{status:"success",userId:$.user?.userId,data:Q}}).get("/api/lessons",async({headers:Z})=>{let $=await O9(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Q=await YU({userId:"d2bd42e7-55d3-4e6b-9d0f-5c024f7bf9a6"});return Q.length===0?{status:"success",message:"No lessons found."}:{status:"success",userId:$.user?.userId,data:Q}}).get("/api/periods",async({headers:Z})=>{let $=await O9(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Q=await WU({userId:$.user?.userId});return Q.length===0?{status:"success",message:"No periods found."}:{status:"success",userId:$.user?.userId,data:Q}}).get("/health",()=>{return new Response("OK")}).listen({idleTimeout:0,port:process.env.PORT||3001});
