// @bun
var pF=Object.create;var{getPrototypeOf:mF,defineProperty:vX,getOwnPropertyNames:cF}=Object;var uF=Object.prototype.hasOwnProperty;var hX=(Z,$,Y)=>{Y=Z!=null?pF(mF(Z)):{};let X=$||!Z||!Z.__esModule?vX(Y,"default",{value:Z,enumerable:!0}):Y;for(let W of cF(Z))if(!uF.call(X,W))vX(X,W,{get:()=>Z[W],enumerable:!0});return X};var E=(Z,$)=>()=>($||Z(($={exports:{}}).exports,$),$.exports);var ZZ=(Z,$)=>{for(var Y in $)vX(Z,Y,{get:$[Y],enumerable:!0,configurable:!0,set:(X)=>$[Y]=()=>X})};var B1=import.meta.require;var $Q=E((ZQ)=>{Object.defineProperty(ZQ,"__esModule",{value:!0});ZQ.parse=TE;ZQ.serialize=kE;var EE=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,jE=/^[\u0021-\u003A\u003C-\u007E]*$/,CE=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,IE=/^[\u0020-\u003A\u003D-\u007E]*$/,PE=Object.prototype.toString,xE=(()=>{let Z=function(){};return Z.prototype=Object.create(null),Z})();function TE(Z,$){let Y=new xE,X=Z.length;if(X<2)return Y;let W=$?.decode||bE,J=0;do{let z=Z.indexOf("=",J);if(z===-1)break;let Q=Z.indexOf(";",J),U=Q===-1?X:Q;if(z>U){J=Z.lastIndexOf(";",z-1)+1;continue}let G=a2(Z,J,z),H=e2(Z,z,G),M=Z.slice(G,H);if(Y[M]===void 0){let q=a2(Z,z+1,U),w=e2(Z,U,q),B=W(Z.slice(q,w));Y[M]=B}J=U+1}while(J<X);return Y}function a2(Z,$,Y){do{let X=Z.charCodeAt($);if(X!==32&&X!==9)return $}while(++$<Y);return Y}function e2(Z,$,Y){while($>Y){let X=Z.charCodeAt(--$);if(X!==32&&X!==9)return $+1}return Y}function kE(Z,$,Y){let X=Y?.encode||encodeURIComponent;if(!EE.test(Z))throw new TypeError(`argument name is invalid: ${Z}`);let W=X($);if(!jE.test(W))throw new TypeError(`argument val is invalid: ${$}`);let J=Z+"="+W;if(!Y)return J;if(Y.maxAge!==void 0){if(!Number.isInteger(Y.maxAge))throw new TypeError(`option maxAge is invalid: ${Y.maxAge}`);J+="; Max-Age="+Y.maxAge}if(Y.domain){if(!CE.test(Y.domain))throw new TypeError(`option domain is invalid: ${Y.domain}`);J+="; Domain="+Y.domain}if(Y.path){if(!IE.test(Y.path))throw new TypeError(`option path is invalid: ${Y.path}`);J+="; Path="+Y.path}if(Y.expires){if(!fE(Y.expires)||!Number.isFinite(Y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${Y.expires}`);J+="; Expires="+Y.expires.toUTCString()}if(Y.httpOnly)J+="; HttpOnly";if(Y.secure)J+="; Secure";if(Y.partitioned)J+="; Partitioned";if(Y.priority)switch(typeof Y.priority==="string"?Y.priority.toLowerCase():void 0){case"low":J+="; Priority=Low";break;case"medium":J+="; Priority=Medium";break;case"high":J+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${Y.priority}`)}if(Y.sameSite)switch(typeof Y.sameSite==="string"?Y.sameSite.toLowerCase():Y.sameSite){case!0:case"strict":J+="; SameSite=Strict";break;case"lax":J+="; SameSite=Lax";break;case"none":J+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${Y.sameSite}`)}return J}function bE(Z){if(Z.indexOf("%")===-1)return Z;try{return decodeURIComponent(Z)}catch($){return Z}}function fE(Z){return PE.call(Z)==="[object Date]"}});var v$=E((u5,sQ)=>{/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var N9=B1("node:buffer"),K6=N9.Buffer;function tQ(Z,$){for(var Y in Z)$[Y]=Z[Y]}if(K6.from&&K6.alloc&&K6.allocUnsafe&&K6.allocUnsafeSlow)sQ.exports=N9;else tQ(N9,u5),u5.Buffer=tZ;function tZ(Z,$,Y){return K6(Z,$,Y)}tZ.prototype=Object.create(K6.prototype);tQ(K6,tZ);tZ.from=function(Z,$,Y){if(typeof Z==="number")throw new TypeError("Argument must not be a number");return K6(Z,$,Y)};tZ.alloc=function(Z,$,Y){if(typeof Z!=="number")throw new TypeError("Argument must be a number");var X=K6(Z);if($!==void 0)if(typeof Y==="string")X.fill($,Y);else X.fill($);else X.fill(0);return X};tZ.allocUnsafe=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return K6(Z)};tZ.allocUnsafeSlow=function(Z){if(typeof Z!=="number")throw new TypeError("Argument must be a number");return N9.SlowBuffer(Z)}});var i5=E((W11,rQ)=>{var B9=v$().Buffer,dj=B1("node:stream"),pj=B1("node:util");function L9(Z){if(this.buffer=null,this.writable=!0,this.readable=!0,!Z)return this.buffer=B9.alloc(0),this;if(typeof Z.pipe==="function")return this.buffer=B9.alloc(0),Z.pipe(this),this;if(Z.length||typeof Z==="object")return this.buffer=Z,this.writable=!1,process.nextTick(function(){this.emit("end",Z),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof Z+")")}pj.inherits(L9,dj);L9.prototype.write=function Z($){this.buffer=B9.concat([this.buffer,B9.from($)]),this.emit("data",$)};L9.prototype.end=function Z($){if($)this.write($);this.emit("end",$),this.emit("close"),this.writable=!1,this.readable=!1};rQ.exports=L9});var eQ=E((J11,aQ)=>{var b4=B1("node:buffer").Buffer,l5=B1("node:buffer").SlowBuffer;aQ.exports=_9;function _9(Z,$){if(!b4.isBuffer(Z)||!b4.isBuffer($))return!1;if(Z.length!==$.length)return!1;var Y=0;for(var X=0;X<Z.length;X++)Y|=Z[X]^$[X];return Y===0}_9.install=function(){b4.prototype.equal=l5.prototype.equal=function Z($){return _9(this,$)}};var mj=b4.prototype.equal,cj=l5.prototype.equal;_9.restore=function(){b4.prototype.equal=mj,l5.prototype.equal=cj}});var $G=E((z11,ZG)=>{function n5(Z){var $=(Z/8|0)+(Z%8===0?0:1);return $}var uj={ES256:n5(256),ES384:n5(384),ES512:n5(521)};function ij(Z){var $=uj[Z];if($)return $;throw new Error('Unknown algorithm "'+Z+'"')}ZG.exports=ij});var GG=E((Q11,QG)=>{var K9=v$().Buffer,XG=$G(),R9=128,WG=0,lj=32,nj=16,oj=2,JG=nj|lj|WG<<6,V9=oj|WG<<6;function tj(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function zG(Z){if(K9.isBuffer(Z))return Z;else if(typeof Z==="string")return K9.from(Z,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function sj(Z,$){Z=zG(Z);var Y=XG($),X=Y+1,W=Z.length,J=0;if(Z[J++]!==JG)throw new Error('Could not find expected "seq"');var z=Z[J++];if(z===(R9|1))z=Z[J++];if(W-J<z)throw new Error('"seq" specified length of "'+z+'", only "'+(W-J)+'" remaining');if(Z[J++]!==V9)throw new Error('Could not find expected "int" for "r"');var Q=Z[J++];if(W-J-2<Q)throw new Error('"r" specified length of "'+Q+'", only "'+(W-J-2)+'" available');if(X<Q)throw new Error('"r" specified length of "'+Q+'", max of "'+X+'" is acceptable');var U=J;if(J+=Q,Z[J++]!==V9)throw new Error('Could not find expected "int" for "s"');var G=Z[J++];if(W-J!==G)throw new Error('"s" specified length of "'+G+'", expected "'+(W-J)+'"');if(X<G)throw new Error('"s" specified length of "'+G+'", max of "'+X+'" is acceptable');var H=J;if(J+=G,J!==W)throw new Error('Expected to consume entire buffer, but "'+(W-J)+'" bytes remain');var M=Y-Q,q=Y-G,w=K9.allocUnsafe(M+Q+q+G);for(J=0;J<M;++J)w[J]=0;Z.copy(w,J,U+Math.max(-M,0),U+Q),J=Y;for(var B=J;J<B+q;++J)w[J]=0;return Z.copy(w,J,H+Math.max(-q,0),H+G),w=w.toString("base64"),w=tj(w),w}function YG(Z,$,Y){var X=0;while($+X<Y&&Z[$+X]===0)++X;var W=Z[$+X]>=R9;if(W)--X;return X}function rj(Z,$){Z=zG(Z);var Y=XG($),X=Z.length;if(X!==Y*2)throw new TypeError('"'+$+'" signatures must be "'+Y*2+'" bytes, saw "'+X+'"');var W=YG(Z,0,Y),J=YG(Z,Y,Z.length),z=Y-W,Q=Y-J,U=2+z+1+1+Q,G=U<R9,H=K9.allocUnsafe((G?2:3)+U),M=0;if(H[M++]=JG,G)H[M++]=U;else H[M++]=R9|1,H[M++]=U&255;if(H[M++]=V9,H[M++]=z,W<0)H[M++]=0,M+=Z.copy(H,M,0,Y);else M+=Z.copy(H,M,W,Y);if(H[M++]=V9,H[M++]=Q,J<0)H[M++]=0,Z.copy(H,M,Y);else Z.copy(H,M,Y+J);return H}QG.exports={derToJose:sj,joseToDer:rj}});var s5=E((G11,FG)=>{var aj=eQ(),d$=v$().Buffer,R6=B1("node:crypto"),HG=GG(),UG=B1("node:util"),ej=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,f4="secret must be a string or buffer",h$="key must be a string or a buffer",ZC="key must be a string, a buffer or an object",o5=typeof R6.createPublicKey==="function";if(o5)h$+=" or a KeyObject",f4+="or a KeyObject";function MG(Z){if(d$.isBuffer(Z))return;if(typeof Z==="string")return;if(!o5)throw H6(h$);if(typeof Z!=="object")throw H6(h$);if(typeof Z.type!=="string")throw H6(h$);if(typeof Z.asymmetricKeyType!=="string")throw H6(h$);if(typeof Z.export!=="function")throw H6(h$)}function wG(Z){if(d$.isBuffer(Z))return;if(typeof Z==="string")return;if(typeof Z==="object")return;throw H6(ZC)}function $C(Z){if(d$.isBuffer(Z))return;if(typeof Z==="string")return Z;if(!o5)throw H6(f4);if(typeof Z!=="object")throw H6(f4);if(Z.type!=="secret")throw H6(f4);if(typeof Z.export!=="function")throw H6(f4)}function t5(Z){return Z.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function DG(Z){Z=Z.toString();var $=4-Z.length%4;if($!==4)for(var Y=0;Y<$;++Y)Z+="=";return Z.replace(/\-/g,"+").replace(/_/g,"/")}function H6(Z){var $=[].slice.call(arguments,1),Y=UG.format.bind(UG,Z).apply(null,$);return new TypeError(Y)}function YC(Z){return d$.isBuffer(Z)||typeof Z==="string"}function g4(Z){if(!YC(Z))Z=JSON.stringify(Z);return Z}function qG(Z){return function $(Y,X){$C(X),Y=g4(Y);var W=R6.createHmac("sha"+Z,X),J=(W.update(Y),W.digest("base64"));return t5(J)}}function XC(Z){return function $(Y,X,W){var J=qG(Z)(Y,W);return aj(d$.from(X),d$.from(J))}}function AG(Z){return function $(Y,X){wG(X),Y=g4(Y);var W=R6.createSign("RSA-SHA"+Z),J=(W.update(Y),W.sign(X,"base64"));return t5(J)}}function OG(Z){return function $(Y,X,W){MG(W),Y=g4(Y),X=DG(X);var J=R6.createVerify("RSA-SHA"+Z);return J.update(Y),J.verify(W,X,"base64")}}function WC(Z){return function $(Y,X){wG(X),Y=g4(Y);var W=R6.createSign("RSA-SHA"+Z),J=(W.update(Y),W.sign({key:X,padding:R6.constants.RSA_PKCS1_PSS_PADDING,saltLength:R6.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return t5(J)}}function JC(Z){return function $(Y,X,W){MG(W),Y=g4(Y),X=DG(X);var J=R6.createVerify("RSA-SHA"+Z);return J.update(Y),J.verify({key:W,padding:R6.constants.RSA_PKCS1_PSS_PADDING,saltLength:R6.constants.RSA_PSS_SALTLEN_DIGEST},X,"base64")}}function zC(Z){var $=AG(Z);return function Y(){var X=$.apply(null,arguments);return X=HG.derToJose(X,"ES"+Z),X}}function QC(Z){var $=OG(Z);return function Y(X,W,J){W=HG.joseToDer(W,"ES"+Z).toString("base64");var z=$(X,W,J);return z}}function GC(){return function Z(){return""}}function UC(){return function Z($,Y){return Y===""}}FG.exports=function Z($){var Y={hs:qG,rs:AG,ps:WC,es:zC,none:GC},X={hs:XC,rs:OG,ps:JC,es:QC,none:UC},W=$.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!W)throw H6(ej,$);var J=(W[1]||W[3]).toLowerCase(),z=W[2];return{sign:Y[J](z),verify:X[J](z)}}});var r5=E((U11,SG)=>{var HC=B1("node:buffer").Buffer;SG.exports=function Z($){if(typeof $==="string")return $;if(typeof $==="number"||HC.isBuffer($))return $.toString();return JSON.stringify($)}});var RG=E((H11,KG)=>{var MC=v$().Buffer,NG=i5(),wC=s5(),DC=B1("node:stream"),BG=r5(),a5=B1("node:util");function LG(Z,$){return MC.from(Z,$).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function qC(Z,$,Y){Y=Y||"utf8";var X=LG(BG(Z),"binary"),W=LG(BG($),Y);return a5.format("%s.%s",X,W)}function _G(Z){var{header:$,payload:Y}=Z,X=Z.secret||Z.privateKey,W=Z.encoding,J=wC($.alg),z=qC($,Y,W),Q=J.sign(z,X);return a5.format("%s.%s",z,Q)}function E9(Z){var $=Z.secret||Z.privateKey||Z.key,Y=new NG($);this.readable=!0,this.header=Z.header,this.encoding=Z.encoding,this.secret=this.privateKey=this.key=Y,this.payload=new NG(Z.payload),this.secret.once("close",function(){if(!this.payload.writable&&this.readable)this.sign()}.bind(this)),this.payload.once("close",function(){if(!this.secret.writable&&this.readable)this.sign()}.bind(this))}a5.inherits(E9,DC);E9.prototype.sign=function Z(){try{var $=_G({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",$),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(Y){this.readable=!1,this.emit("error",Y),this.emit("close")}};E9.sign=_G;KG.exports=E9});var bG=E((M11,kG)=>{var EG=v$().Buffer,VG=i5(),AC=s5(),OC=B1("node:stream"),jG=r5(),FC=B1("node:util"),SC=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function NC(Z){return Object.prototype.toString.call(Z)==="[object Object]"}function BC(Z){if(NC(Z))return Z;try{return JSON.parse(Z)}catch($){return}}function CG(Z){var $=Z.split(".",1)[0];return BC(EG.from($,"base64").toString("binary"))}function LC(Z){return Z.split(".",2).join(".")}function IG(Z){return Z.split(".")[2]}function _C(Z,$){$=$||"utf8";var Y=Z.split(".")[1];return EG.from(Y,"base64").toString($)}function PG(Z){return SC.test(Z)&&!!CG(Z)}function xG(Z,$,Y){if(!$){var X=new Error("Missing algorithm parameter for jws.verify");throw X.code="MISSING_ALGORITHM",X}Z=jG(Z);var W=IG(Z),J=LC(Z),z=AC($);return z.verify(J,W,Y)}function TG(Z,$){if($=$||{},Z=jG(Z),!PG(Z))return null;var Y=CG(Z);if(!Y)return null;var X=_C(Z);if(Y.typ==="JWT"||$.json)X=JSON.parse(X,$.encoding);return{header:Y,payload:X,signature:IG(Z)}}function p$(Z){Z=Z||{};var $=Z.secret||Z.publicKey||Z.key,Y=new VG($);this.readable=!0,this.algorithm=Z.algorithm,this.encoding=Z.encoding,this.secret=this.publicKey=this.key=Y,this.signature=new VG(Z.signature),this.secret.once("close",function(){if(!this.signature.writable&&this.readable)this.verify()}.bind(this)),this.signature.once("close",function(){if(!this.secret.writable&&this.readable)this.verify()}.bind(this))}FC.inherits(p$,OC);p$.prototype.verify=function Z(){try{var $=xG(this.signature.buffer,this.algorithm,this.key.buffer),Y=TG(this.signature.buffer,this.encoding);return this.emit("done",$,Y),this.emit("data",$),this.emit("end"),this.readable=!1,$}catch(X){this.readable=!1,this.emit("error",X),this.emit("close")}};p$.decode=TG;p$.isValid=PG;p$.verify=xG;kG.exports=p$});var C9=E((RC)=>{var fG=RG(),j9=bG(),KC=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];RC.ALGORITHMS=KC;RC.sign=fG.sign;RC.verify=j9.verify;RC.decode=j9.decode;RC.isValid=j9.isValid;RC.createSign=function Z($){return new fG($)};RC.createVerify=function Z($){return new j9($)}});var e5=E((D11,gG)=>{var TC=C9();gG.exports=function(Z,$){$=$||{};var Y=TC.decode(Z,$);if(!Y)return null;var X=Y.payload;if(typeof X==="string")try{var W=JSON.parse(X);if(W!==null&&typeof W==="object")X=W}catch(J){}if($.complete===!0)return{header:Y.header,payload:X,signature:Y.signature};return X}});var y4=E((q11,yG)=>{var I9=function(Z,$){if(Error.call(this,Z),Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);if(this.name="JsonWebTokenError",this.message=Z,$)this.inner=$};I9.prototype=Object.create(Error.prototype);I9.prototype.constructor=I9;yG.exports=I9});var Z7=E((A11,hG)=>{var vG=y4(),P9=function(Z,$){vG.call(this,Z),this.name="NotBeforeError",this.date=$};P9.prototype=Object.create(vG.prototype);P9.prototype.constructor=P9;hG.exports=P9});var $7=E((O11,pG)=>{var dG=y4(),x9=function(Z,$){dG.call(this,Z),this.name="TokenExpiredError",this.expiredAt=$};x9.prototype=Object.create(dG.prototype);x9.prototype.constructor=x9;pG.exports=x9});var Y7=E((F11,mG)=>{var m$=1000,c$=m$*60,u$=c$*60,sZ=u$*24,kC=sZ*7,bC=sZ*365.25;mG.exports=function(Z,$){$=$||{};var Y=typeof Z;if(Y==="string"&&Z.length>0)return fC(Z);else if(Y==="number"&&isFinite(Z))return $.long?yC(Z):gC(Z);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Z))};function fC(Z){if(Z=String(Z),Z.length>100)return;var $=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Z);if(!$)return;var Y=parseFloat($[1]),X=($[2]||"ms").toLowerCase();switch(X){case"years":case"year":case"yrs":case"yr":case"y":return Y*bC;case"weeks":case"week":case"w":return Y*kC;case"days":case"day":case"d":return Y*sZ;case"hours":case"hour":case"hrs":case"hr":case"h":return Y*u$;case"minutes":case"minute":case"mins":case"min":case"m":return Y*c$;case"seconds":case"second":case"secs":case"sec":case"s":return Y*m$;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Y;default:return}}function gC(Z){var $=Math.abs(Z);if($>=sZ)return Math.round(Z/sZ)+"d";if($>=u$)return Math.round(Z/u$)+"h";if($>=c$)return Math.round(Z/c$)+"m";if($>=m$)return Math.round(Z/m$)+"s";return Z+"ms"}function yC(Z){var $=Math.abs(Z);if($>=sZ)return T9(Z,$,sZ,"day");if($>=u$)return T9(Z,$,u$,"hour");if($>=c$)return T9(Z,$,c$,"minute");if($>=m$)return T9(Z,$,m$,"second");return Z+" ms"}function T9(Z,$,Y,X){var W=$>=Y*1.5;return Math.round(Z/Y)+" "+X+(W?"s":"")}});var X7=E((S11,cG)=>{var vC=Y7();cG.exports=function(Z,$){var Y=$||Math.floor(Date.now()/1000);if(typeof Z==="string"){var X=vC(Z);if(typeof X==="undefined")return;return Math.floor(Y+X/1000)}else if(typeof Z==="number")return Y+Z;else return}});var v4=E((N11,uG)=>{var hC=Number.MAX_SAFE_INTEGER||9007199254740991,dC=["major","premajor","minor","preminor","patch","prepatch","prerelease"];uG.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:hC,RELEASE_TYPES:dC,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var h4=E((B11,iG)=>{var pC=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...Z)=>console.error("SEMVER",...Z):()=>{};iG.exports=pC});var i$=E((V6,lG)=>{var{MAX_SAFE_COMPONENT_LENGTH:W7,MAX_SAFE_BUILD_LENGTH:mC,MAX_LENGTH:cC}=v4(),uC=h4();V6=lG.exports={};var iC=V6.re=[],lC=V6.safeRe=[],m=V6.src=[],nC=V6.safeSrc=[],c=V6.t={},oC=0,J7="[a-zA-Z0-9-]",tC=[["\\s",1],["\\d",cC],[J7,mC]],sC=(Z)=>{for(let[$,Y]of tC)Z=Z.split(`${$}*`).join(`${$}{0,${Y}}`).split(`${$}+`).join(`${$}{1,${Y}}`);return Z},W1=(Z,$,Y)=>{let X=sC($),W=oC++;uC(Z,W,$),c[Z]=W,m[W]=$,nC[W]=X,iC[W]=new RegExp($,Y?"g":void 0),lC[W]=new RegExp(X,Y?"g":void 0)};W1("NUMERICIDENTIFIER","0|[1-9]\\d*");W1("NUMERICIDENTIFIERLOOSE","\\d+");W1("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${J7}*`);W1("MAINVERSION",`(${m[c.NUMERICIDENTIFIER]})\\.(${m[c.NUMERICIDENTIFIER]})\\.(${m[c.NUMERICIDENTIFIER]})`);W1("MAINVERSIONLOOSE",`(${m[c.NUMERICIDENTIFIERLOOSE]})\\.(${m[c.NUMERICIDENTIFIERLOOSE]})\\.(${m[c.NUMERICIDENTIFIERLOOSE]})`);W1("PRERELEASEIDENTIFIER",`(?:${m[c.NUMERICIDENTIFIER]}|${m[c.NONNUMERICIDENTIFIER]})`);W1("PRERELEASEIDENTIFIERLOOSE",`(?:${m[c.NUMERICIDENTIFIERLOOSE]}|${m[c.NONNUMERICIDENTIFIER]})`);W1("PRERELEASE",`(?:-(${m[c.PRERELEASEIDENTIFIER]}(?:\\.${m[c.PRERELEASEIDENTIFIER]})*))`);W1("PRERELEASELOOSE",`(?:-?(${m[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${m[c.PRERELEASEIDENTIFIERLOOSE]})*))`);W1("BUILDIDENTIFIER",`${J7}+`);W1("BUILD",`(?:\\+(${m[c.BUILDIDENTIFIER]}(?:\\.${m[c.BUILDIDENTIFIER]})*))`);W1("FULLPLAIN",`v?${m[c.MAINVERSION]}${m[c.PRERELEASE]}?${m[c.BUILD]}?`);W1("FULL",`^${m[c.FULLPLAIN]}$`);W1("LOOSEPLAIN",`[v=\\s]*${m[c.MAINVERSIONLOOSE]}${m[c.PRERELEASELOOSE]}?${m[c.BUILD]}?`);W1("LOOSE",`^${m[c.LOOSEPLAIN]}$`);W1("GTLT","((?:<|>)?=?)");W1("XRANGEIDENTIFIERLOOSE",`${m[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);W1("XRANGEIDENTIFIER",`${m[c.NUMERICIDENTIFIER]}|x|X|\\*`);W1("XRANGEPLAIN",`[v=\\s]*(${m[c.XRANGEIDENTIFIER]})(?:\\.(${m[c.XRANGEIDENTIFIER]})(?:\\.(${m[c.XRANGEIDENTIFIER]})(?:${m[c.PRERELEASE]})?${m[c.BUILD]}?)?)?`);W1("XRANGEPLAINLOOSE",`[v=\\s]*(${m[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${m[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${m[c.XRANGEIDENTIFIERLOOSE]})(?:${m[c.PRERELEASELOOSE]})?${m[c.BUILD]}?)?)?`);W1("XRANGE",`^${m[c.GTLT]}\\s*${m[c.XRANGEPLAIN]}$`);W1("XRANGELOOSE",`^${m[c.GTLT]}\\s*${m[c.XRANGEPLAINLOOSE]}$`);W1("COERCEPLAIN",`(^|[^\\d])(\\d{1,${W7}})(?:\\.(\\d{1,${W7}}))?(?:\\.(\\d{1,${W7}}))?`);W1("COERCE",`${m[c.COERCEPLAIN]}(?:$|[^\\d])`);W1("COERCEFULL",m[c.COERCEPLAIN]+`(?:${m[c.PRERELEASE]})?(?:${m[c.BUILD]})?(?:$|[^\\d])`);W1("COERCERTL",m[c.COERCE],!0);W1("COERCERTLFULL",m[c.COERCEFULL],!0);W1("LONETILDE","(?:~>?)");W1("TILDETRIM",`(\\s*)${m[c.LONETILDE]}\\s+`,!0);V6.tildeTrimReplace="$1~";W1("TILDE",`^${m[c.LONETILDE]}${m[c.XRANGEPLAIN]}$`);W1("TILDELOOSE",`^${m[c.LONETILDE]}${m[c.XRANGEPLAINLOOSE]}$`);W1("LONECARET","(?:\\^)");W1("CARETTRIM",`(\\s*)${m[c.LONECARET]}\\s+`,!0);V6.caretTrimReplace="$1^";W1("CARET",`^${m[c.LONECARET]}${m[c.XRANGEPLAIN]}$`);W1("CARETLOOSE",`^${m[c.LONECARET]}${m[c.XRANGEPLAINLOOSE]}$`);W1("COMPARATORLOOSE",`^${m[c.GTLT]}\\s*(${m[c.LOOSEPLAIN]})$|^$`);W1("COMPARATOR",`^${m[c.GTLT]}\\s*(${m[c.FULLPLAIN]})$|^$`);W1("COMPARATORTRIM",`(\\s*)${m[c.GTLT]}\\s*(${m[c.LOOSEPLAIN]}|${m[c.XRANGEPLAIN]})`,!0);V6.comparatorTrimReplace="$1$2$3";W1("HYPHENRANGE",`^\\s*(${m[c.XRANGEPLAIN]})\\s+-\\s+(${m[c.XRANGEPLAIN]})\\s*$`);W1("HYPHENRANGELOOSE",`^\\s*(${m[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${m[c.XRANGEPLAINLOOSE]})\\s*$`);W1("STAR","(<|>)?=?\\s*\\*");W1("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");W1("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var k9=E((L11,nG)=>{var rC=Object.freeze({loose:!0}),aC=Object.freeze({}),eC=(Z)=>{if(!Z)return aC;if(typeof Z!=="object")return rC;return Z};nG.exports=eC});var z7=E((_11,sG)=>{var oG=/^[0-9]+$/,tG=(Z,$)=>{let Y=oG.test(Z),X=oG.test($);if(Y&&X)Z=+Z,$=+$;return Z===$?0:Y&&!X?-1:X&&!Y?1:Z<$?-1:1},ZI=(Z,$)=>tG($,Z);sG.exports={compareIdentifiers:tG,rcompareIdentifiers:ZI}});var b0=E((K11,ZU)=>{var b9=h4(),{MAX_LENGTH:rG,MAX_SAFE_INTEGER:f9}=v4(),{safeRe:aG,safeSrc:eG,t:g9}=i$(),$I=k9(),{compareIdentifiers:l$}=z7();class M6{constructor(Z,$){if($=$I($),Z instanceof M6)if(Z.loose===!!$.loose&&Z.includePrerelease===!!$.includePrerelease)return Z;else Z=Z.version;else if(typeof Z!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof Z}".`);if(Z.length>rG)throw new TypeError(`version is longer than ${rG} characters`);b9("SemVer",Z,$),this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease;let Y=Z.trim().match($.loose?aG[g9.LOOSE]:aG[g9.FULL]);if(!Y)throw new TypeError(`Invalid Version: ${Z}`);if(this.raw=Z,this.major=+Y[1],this.minor=+Y[2],this.patch=+Y[3],this.major>f9||this.major<0)throw new TypeError("Invalid major version");if(this.minor>f9||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>f9||this.patch<0)throw new TypeError("Invalid patch version");if(!Y[4])this.prerelease=[];else this.prerelease=Y[4].split(".").map((X)=>{if(/^[0-9]+$/.test(X)){let W=+X;if(W>=0&&W<f9)return W}return X});this.build=Y[5]?Y[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare(Z){if(b9("SemVer.compare",this.version,this.options,Z),!(Z instanceof M6)){if(typeof Z==="string"&&Z===this.version)return 0;Z=new M6(Z,this.options)}if(Z.version===this.version)return 0;return this.compareMain(Z)||this.comparePre(Z)}compareMain(Z){if(!(Z instanceof M6))Z=new M6(Z,this.options);return l$(this.major,Z.major)||l$(this.minor,Z.minor)||l$(this.patch,Z.patch)}comparePre(Z){if(!(Z instanceof M6))Z=new M6(Z,this.options);if(this.prerelease.length&&!Z.prerelease.length)return-1;else if(!this.prerelease.length&&Z.prerelease.length)return 1;else if(!this.prerelease.length&&!Z.prerelease.length)return 0;let $=0;do{let Y=this.prerelease[$],X=Z.prerelease[$];if(b9("prerelease compare",$,Y,X),Y===void 0&&X===void 0)return 0;else if(X===void 0)return 1;else if(Y===void 0)return-1;else if(Y===X)continue;else return l$(Y,X)}while(++$)}compareBuild(Z){if(!(Z instanceof M6))Z=new M6(Z,this.options);let $=0;do{let Y=this.build[$],X=Z.build[$];if(b9("build compare",$,Y,X),Y===void 0&&X===void 0)return 0;else if(X===void 0)return 1;else if(Y===void 0)return-1;else if(Y===X)continue;else return l$(Y,X)}while(++$)}inc(Z,$,Y){if(Z.startsWith("pre")){if(!$&&Y===!1)throw new Error("invalid increment argument: identifier is empty");if($){let X=new RegExp(`^${this.options.loose?eG[g9.PRERELEASELOOSE]:eG[g9.PRERELEASE]}$`),W=`-${$}`.match(X);if(!W||W[1]!==$)throw new Error(`invalid identifier: ${$}`)}}switch(Z){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",$,Y);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",$,Y);break;case"prepatch":this.prerelease.length=0,this.inc("patch",$,Y),this.inc("pre",$,Y);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",$,Y);this.inc("pre",$,Y);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let X=Number(Y)?1:0;if(this.prerelease.length===0)this.prerelease=[X];else{let W=this.prerelease.length;while(--W>=0)if(typeof this.prerelease[W]==="number")this.prerelease[W]++,W=-2;if(W===-1){if($===this.prerelease.join(".")&&Y===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(X)}}if($){let W=[$,X];if(Y===!1)W=[$];if(l$(this.prerelease[0],$)===0){if(isNaN(this.prerelease[1]))this.prerelease=W}else this.prerelease=W}break}default:throw new Error(`invalid increment argument: ${Z}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}ZU.exports=M6});var rZ=E((R11,YU)=>{var $U=b0(),YI=(Z,$,Y=!1)=>{if(Z instanceof $U)return Z;try{return new $U(Z,$)}catch(X){if(!Y)return null;throw X}};YU.exports=YI});var WU=E((V11,XU)=>{var XI=rZ(),WI=(Z,$)=>{let Y=XI(Z,$);return Y?Y.version:null};XU.exports=WI});var zU=E((E11,JU)=>{var JI=rZ(),zI=(Z,$)=>{let Y=JI(Z.trim().replace(/^[=v]+/,""),$);return Y?Y.version:null};JU.exports=zI});var UU=E((j11,GU)=>{var QU=b0(),QI=(Z,$,Y,X,W)=>{if(typeof Y==="string")W=X,X=Y,Y=void 0;try{return new QU(Z instanceof QU?Z.version:Z,Y).inc($,X,W).version}catch(J){return null}};GU.exports=QI});var wU=E((C11,MU)=>{var HU=rZ(),GI=(Z,$)=>{let Y=HU(Z,null,!0),X=HU($,null,!0),W=Y.compare(X);if(W===0)return null;let J=W>0,z=J?Y:X,Q=J?X:Y,U=!!z.prerelease.length;if(!!Q.prerelease.length&&!U){if(!Q.patch&&!Q.minor)return"major";if(Q.compareMain(z)===0){if(Q.minor&&!Q.patch)return"minor";return"patch"}}let H=U?"pre":"";if(Y.major!==X.major)return H+"major";if(Y.minor!==X.minor)return H+"minor";if(Y.patch!==X.patch)return H+"patch";return"prerelease"};MU.exports=GI});var qU=E((I11,DU)=>{var UI=b0(),HI=(Z,$)=>new UI(Z,$).major;DU.exports=HI});var OU=E((P11,AU)=>{var MI=b0(),wI=(Z,$)=>new MI(Z,$).minor;AU.exports=wI});var SU=E((x11,FU)=>{var DI=b0(),qI=(Z,$)=>new DI(Z,$).patch;FU.exports=qI});var BU=E((T11,NU)=>{var AI=rZ(),OI=(Z,$)=>{let Y=AI(Z,$);return Y&&Y.prerelease.length?Y.prerelease:null};NU.exports=OI});var v8=E((k11,_U)=>{var LU=b0(),FI=(Z,$,Y)=>new LU(Z,Y).compare(new LU($,Y));_U.exports=FI});var RU=E((b11,KU)=>{var SI=v8(),NI=(Z,$,Y)=>SI($,Z,Y);KU.exports=NI});var EU=E((f11,VU)=>{var BI=v8(),LI=(Z,$)=>BI(Z,$,!0);VU.exports=LI});var y9=E((g11,CU)=>{var jU=b0(),_I=(Z,$,Y)=>{let X=new jU(Z,Y),W=new jU($,Y);return X.compare(W)||X.compareBuild(W)};CU.exports=_I});var PU=E((y11,IU)=>{var KI=y9(),RI=(Z,$)=>Z.sort((Y,X)=>KI(Y,X,$));IU.exports=RI});var TU=E((v11,xU)=>{var VI=y9(),EI=(Z,$)=>Z.sort((Y,X)=>VI(X,Y,$));xU.exports=EI});var d4=E((h11,kU)=>{var jI=v8(),CI=(Z,$,Y)=>jI(Z,$,Y)>0;kU.exports=CI});var v9=E((d11,bU)=>{var II=v8(),PI=(Z,$,Y)=>II(Z,$,Y)<0;bU.exports=PI});var Q7=E((p11,fU)=>{var xI=v8(),TI=(Z,$,Y)=>xI(Z,$,Y)===0;fU.exports=TI});var G7=E((m11,gU)=>{var kI=v8(),bI=(Z,$,Y)=>kI(Z,$,Y)!==0;gU.exports=bI});var h9=E((c11,yU)=>{var fI=v8(),gI=(Z,$,Y)=>fI(Z,$,Y)>=0;yU.exports=gI});var d9=E((u11,vU)=>{var yI=v8(),vI=(Z,$,Y)=>yI(Z,$,Y)<=0;vU.exports=vI});var U7=E((i11,hU)=>{var hI=Q7(),dI=G7(),pI=d4(),mI=h9(),cI=v9(),uI=d9(),iI=(Z,$,Y,X)=>{switch($){case"===":if(typeof Z==="object")Z=Z.version;if(typeof Y==="object")Y=Y.version;return Z===Y;case"!==":if(typeof Z==="object")Z=Z.version;if(typeof Y==="object")Y=Y.version;return Z!==Y;case"":case"=":case"==":return hI(Z,Y,X);case"!=":return dI(Z,Y,X);case">":return pI(Z,Y,X);case">=":return mI(Z,Y,X);case"<":return cI(Z,Y,X);case"<=":return uI(Z,Y,X);default:throw new TypeError(`Invalid operator: ${$}`)}};hU.exports=iI});var pU=E((l11,dU)=>{var lI=b0(),nI=rZ(),{safeRe:p9,t:m9}=i$(),oI=(Z,$)=>{if(Z instanceof lI)return Z;if(typeof Z==="number")Z=String(Z);if(typeof Z!=="string")return null;$=$||{};let Y=null;if(!$.rtl)Y=Z.match($.includePrerelease?p9[m9.COERCEFULL]:p9[m9.COERCE]);else{let U=$.includePrerelease?p9[m9.COERCERTLFULL]:p9[m9.COERCERTL],G;while((G=U.exec(Z))&&(!Y||Y.index+Y[0].length!==Z.length)){if(!Y||G.index+G[0].length!==Y.index+Y[0].length)Y=G;U.lastIndex=G.index+G[1].length+G[2].length}U.lastIndex=-1}if(Y===null)return null;let X=Y[2],W=Y[3]||"0",J=Y[4]||"0",z=$.includePrerelease&&Y[5]?`-${Y[5]}`:"",Q=$.includePrerelease&&Y[6]?`+${Y[6]}`:"";return nI(`${X}.${W}.${J}${z}${Q}`,$)};dU.exports=oI});var uU=E((n11,cU)=>{class mU{constructor(){this.max=1000,this.map=new Map}get(Z){let $=this.map.get(Z);if($===void 0)return;else return this.map.delete(Z),this.map.set(Z,$),$}delete(Z){return this.map.delete(Z)}set(Z,$){if(!this.delete(Z)&&$!==void 0){if(this.map.size>=this.max){let X=this.map.keys().next().value;this.delete(X)}this.map.set(Z,$)}return this}}cU.exports=mU});var h8=E((o11,oU)=>{var tI=/\s+/g;class p4{constructor(Z,$){if($=rI($),Z instanceof p4)if(Z.loose===!!$.loose&&Z.includePrerelease===!!$.includePrerelease)return Z;else return new p4(Z.raw,$);if(Z instanceof H7)return this.raw=Z.value,this.set=[[Z]],this.formatted=void 0,this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=Z.trim().replace(tI," "),this.set=this.raw.split("||").map((Y)=>this.parseRange(Y.trim())).filter((Y)=>Y.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let Y=this.set[0];if(this.set=this.set.filter((X)=>!lU(X[0])),this.set.length===0)this.set=[Y];else if(this.set.length>1){for(let X of this.set)if(X.length===1&&WP(X[0])){this.set=[X];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let Z=0;Z<this.set.length;Z++){if(Z>0)this.formatted+="||";let $=this.set[Z];for(let Y=0;Y<$.length;Y++){if(Y>0)this.formatted+=" ";this.formatted+=$[Y].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(Z){let Y=((this.options.includePrerelease&&YP)|(this.options.loose&&XP))+":"+Z,X=iU.get(Y);if(X)return X;let W=this.options.loose,J=W?J8[d0.HYPHENRANGELOOSE]:J8[d0.HYPHENRANGE];Z=Z.replace(J,qP(this.options.includePrerelease)),s1("hyphen replace",Z),Z=Z.replace(J8[d0.COMPARATORTRIM],eI),s1("comparator trim",Z),Z=Z.replace(J8[d0.TILDETRIM],ZP),s1("tilde trim",Z),Z=Z.replace(J8[d0.CARETTRIM],$P),s1("caret trim",Z);let z=Z.split(" ").map((H)=>JP(H,this.options)).join(" ").split(/\s+/).map((H)=>DP(H,this.options));if(W)z=z.filter((H)=>{return s1("loose invalid filter",H,this.options),!!H.match(J8[d0.COMPARATORLOOSE])});s1("range list",z);let Q=new Map,U=z.map((H)=>new H7(H,this.options));for(let H of U){if(lU(H))return[H];Q.set(H.value,H)}if(Q.size>1&&Q.has(""))Q.delete("");let G=[...Q.values()];return iU.set(Y,G),G}intersects(Z,$){if(!(Z instanceof p4))throw new TypeError("a Range is required");return this.set.some((Y)=>{return nU(Y,$)&&Z.set.some((X)=>{return nU(X,$)&&Y.every((W)=>{return X.every((J)=>{return W.intersects(J,$)})})})})}test(Z){if(!Z)return!1;if(typeof Z==="string")try{Z=new aI(Z,this.options)}catch($){return!1}for(let $=0;$<this.set.length;$++)if(AP(this.set[$],Z,this.options))return!0;return!1}}oU.exports=p4;var sI=uU(),iU=new sI,rI=k9(),H7=m4(),s1=h4(),aI=b0(),{safeRe:J8,t:d0,comparatorTrimReplace:eI,tildeTrimReplace:ZP,caretTrimReplace:$P}=i$(),{FLAG_INCLUDE_PRERELEASE:YP,FLAG_LOOSE:XP}=v4(),lU=(Z)=>Z.value==="<0.0.0-0",WP=(Z)=>Z.value==="",nU=(Z,$)=>{let Y=!0,X=Z.slice(),W=X.pop();while(Y&&X.length)Y=X.every((J)=>{return W.intersects(J,$)}),W=X.pop();return Y},JP=(Z,$)=>{return s1("comp",Z,$),Z=GP(Z,$),s1("caret",Z),Z=zP(Z,$),s1("tildes",Z),Z=HP(Z,$),s1("xrange",Z),Z=wP(Z,$),s1("stars",Z),Z},p0=(Z)=>!Z||Z.toLowerCase()==="x"||Z==="*",zP=(Z,$)=>{return Z.trim().split(/\s+/).map((Y)=>QP(Y,$)).join(" ")},QP=(Z,$)=>{let Y=$.loose?J8[d0.TILDELOOSE]:J8[d0.TILDE];return Z.replace(Y,(X,W,J,z,Q)=>{s1("tilde",Z,X,W,J,z,Q);let U;if(p0(W))U="";else if(p0(J))U=`>=${W}.0.0 <${+W+1}.0.0-0`;else if(p0(z))U=`>=${W}.${J}.0 <${W}.${+J+1}.0-0`;else if(Q)s1("replaceTilde pr",Q),U=`>=${W}.${J}.${z}-${Q} <${W}.${+J+1}.0-0`;else U=`>=${W}.${J}.${z} <${W}.${+J+1}.0-0`;return s1("tilde return",U),U})},GP=(Z,$)=>{return Z.trim().split(/\s+/).map((Y)=>UP(Y,$)).join(" ")},UP=(Z,$)=>{s1("caret",Z,$);let Y=$.loose?J8[d0.CARETLOOSE]:J8[d0.CARET],X=$.includePrerelease?"-0":"";return Z.replace(Y,(W,J,z,Q,U)=>{s1("caret",Z,W,J,z,Q,U);let G;if(p0(J))G="";else if(p0(z))G=`>=${J}.0.0${X} <${+J+1}.0.0-0`;else if(p0(Q))if(J==="0")G=`>=${J}.${z}.0${X} <${J}.${+z+1}.0-0`;else G=`>=${J}.${z}.0${X} <${+J+1}.0.0-0`;else if(U)if(s1("replaceCaret pr",U),J==="0")if(z==="0")G=`>=${J}.${z}.${Q}-${U} <${J}.${z}.${+Q+1}-0`;else G=`>=${J}.${z}.${Q}-${U} <${J}.${+z+1}.0-0`;else G=`>=${J}.${z}.${Q}-${U} <${+J+1}.0.0-0`;else if(s1("no pr"),J==="0")if(z==="0")G=`>=${J}.${z}.${Q}${X} <${J}.${z}.${+Q+1}-0`;else G=`>=${J}.${z}.${Q}${X} <${J}.${+z+1}.0-0`;else G=`>=${J}.${z}.${Q} <${+J+1}.0.0-0`;return s1("caret return",G),G})},HP=(Z,$)=>{return s1("replaceXRanges",Z,$),Z.split(/\s+/).map((Y)=>MP(Y,$)).join(" ")},MP=(Z,$)=>{Z=Z.trim();let Y=$.loose?J8[d0.XRANGELOOSE]:J8[d0.XRANGE];return Z.replace(Y,(X,W,J,z,Q,U)=>{s1("xRange",Z,X,W,J,z,Q,U);let G=p0(J),H=G||p0(z),M=H||p0(Q),q=M;if(W==="="&&q)W="";if(U=$.includePrerelease?"-0":"",G)if(W===">"||W==="<")X="<0.0.0-0";else X="*";else if(W&&q){if(H)z=0;if(Q=0,W===">")if(W=">=",H)J=+J+1,z=0,Q=0;else z=+z+1,Q=0;else if(W==="<=")if(W="<",H)J=+J+1;else z=+z+1;if(W==="<")U="-0";X=`${W+J}.${z}.${Q}${U}`}else if(H)X=`>=${J}.0.0${U} <${+J+1}.0.0-0`;else if(M)X=`>=${J}.${z}.0${U} <${J}.${+z+1}.0-0`;return s1("xRange return",X),X})},wP=(Z,$)=>{return s1("replaceStars",Z,$),Z.trim().replace(J8[d0.STAR],"")},DP=(Z,$)=>{return s1("replaceGTE0",Z,$),Z.trim().replace(J8[$.includePrerelease?d0.GTE0PRE:d0.GTE0],"")},qP=(Z)=>($,Y,X,W,J,z,Q,U,G,H,M,q)=>{if(p0(X))Y="";else if(p0(W))Y=`>=${X}.0.0${Z?"-0":""}`;else if(p0(J))Y=`>=${X}.${W}.0${Z?"-0":""}`;else if(z)Y=`>=${Y}`;else Y=`>=${Y}${Z?"-0":""}`;if(p0(G))U="";else if(p0(H))U=`<${+G+1}.0.0-0`;else if(p0(M))U=`<${G}.${+H+1}.0-0`;else if(q)U=`<=${G}.${H}.${M}-${q}`;else if(Z)U=`<${G}.${H}.${+M+1}-0`;else U=`<=${U}`;return`${Y} ${U}`.trim()},AP=(Z,$,Y)=>{for(let X=0;X<Z.length;X++)if(!Z[X].test($))return!1;if($.prerelease.length&&!Y.includePrerelease){for(let X=0;X<Z.length;X++){if(s1(Z[X].semver),Z[X].semver===H7.ANY)continue;if(Z[X].semver.prerelease.length>0){let W=Z[X].semver;if(W.major===$.major&&W.minor===$.minor&&W.patch===$.patch)return!0}}return!1}return!0}});var m4=E((t11,ZH)=>{var c4=Symbol("SemVer ANY");class c9{static get ANY(){return c4}constructor(Z,$){if($=tU($),Z instanceof c9)if(Z.loose===!!$.loose)return Z;else Z=Z.value;if(Z=Z.trim().split(/\s+/).join(" "),w7("comparator",Z,$),this.options=$,this.loose=!!$.loose,this.parse(Z),this.semver===c4)this.value="";else this.value=this.operator+this.semver.version;w7("comp",this)}parse(Z){let $=this.options.loose?sU[rU.COMPARATORLOOSE]:sU[rU.COMPARATOR],Y=Z.match($);if(!Y)throw new TypeError(`Invalid comparator: ${Z}`);if(this.operator=Y[1]!==void 0?Y[1]:"",this.operator==="=")this.operator="";if(!Y[2])this.semver=c4;else this.semver=new aU(Y[2],this.options.loose)}toString(){return this.value}test(Z){if(w7("Comparator.test",Z,this.options.loose),this.semver===c4||Z===c4)return!0;if(typeof Z==="string")try{Z=new aU(Z,this.options)}catch($){return!1}return M7(Z,this.operator,this.semver,this.options)}intersects(Z,$){if(!(Z instanceof c9))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new eU(Z.value,$).test(this.value)}else if(Z.operator===""){if(Z.value==="")return!0;return new eU(this.value,$).test(Z.semver)}if($=tU($),$.includePrerelease&&(this.value==="<0.0.0-0"||Z.value==="<0.0.0-0"))return!1;if(!$.includePrerelease&&(this.value.startsWith("<0.0.0")||Z.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&Z.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&Z.operator.startsWith("<"))return!0;if(this.semver.version===Z.semver.version&&this.operator.includes("=")&&Z.operator.includes("="))return!0;if(M7(this.semver,"<",Z.semver,$)&&this.operator.startsWith(">")&&Z.operator.startsWith("<"))return!0;if(M7(this.semver,">",Z.semver,$)&&this.operator.startsWith("<")&&Z.operator.startsWith(">"))return!0;return!1}}ZH.exports=c9;var tU=k9(),{safeRe:sU,t:rU}=i$(),M7=U7(),w7=h4(),aU=b0(),eU=h8()});var u4=E((s11,$H)=>{var OP=h8(),FP=(Z,$,Y)=>{try{$=new OP($,Y)}catch(X){return!1}return $.test(Z)};$H.exports=FP});var XH=E((r11,YH)=>{var SP=h8(),NP=(Z,$)=>new SP(Z,$).set.map((Y)=>Y.map((X)=>X.value).join(" ").trim().split(" "));YH.exports=NP});var JH=E((a11,WH)=>{var BP=b0(),LP=h8(),_P=(Z,$,Y)=>{let X=null,W=null,J=null;try{J=new LP($,Y)}catch(z){return null}return Z.forEach((z)=>{if(J.test(z)){if(!X||W.compare(z)===-1)X=z,W=new BP(X,Y)}}),X};WH.exports=_P});var QH=E((e11,zH)=>{var KP=b0(),RP=h8(),VP=(Z,$,Y)=>{let X=null,W=null,J=null;try{J=new RP($,Y)}catch(z){return null}return Z.forEach((z)=>{if(J.test(z)){if(!X||W.compare(z)===1)X=z,W=new KP(X,Y)}}),X};zH.exports=VP});var HH=E((Z01,UH)=>{var D7=b0(),EP=h8(),GH=d4(),jP=(Z,$)=>{Z=new EP(Z,$);let Y=new D7("0.0.0");if(Z.test(Y))return Y;if(Y=new D7("0.0.0-0"),Z.test(Y))return Y;Y=null;for(let X=0;X<Z.set.length;++X){let W=Z.set[X],J=null;if(W.forEach((z)=>{let Q=new D7(z.semver.version);switch(z.operator){case">":if(Q.prerelease.length===0)Q.patch++;else Q.prerelease.push(0);Q.raw=Q.format();case"":case">=":if(!J||GH(Q,J))J=Q;break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${z.operator}`)}}),J&&(!Y||GH(Y,J)))Y=J}if(Y&&Z.test(Y))return Y;return null};UH.exports=jP});var wH=E(($01,MH)=>{var CP=h8(),IP=(Z,$)=>{try{return new CP(Z,$).range||"*"}catch(Y){return null}};MH.exports=IP});var u9=E((Y01,OH)=>{var PP=b0(),AH=m4(),{ANY:xP}=AH,TP=h8(),kP=u4(),DH=d4(),qH=v9(),bP=d9(),fP=h9(),gP=(Z,$,Y,X)=>{Z=new PP(Z,X),$=new TP($,X);let W,J,z,Q,U;switch(Y){case">":W=DH,J=bP,z=qH,Q=">",U=">=";break;case"<":W=qH,J=fP,z=DH,Q="<",U="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(kP(Z,$,X))return!1;for(let G=0;G<$.set.length;++G){let H=$.set[G],M=null,q=null;if(H.forEach((w)=>{if(w.semver===xP)w=new AH(">=0.0.0");if(M=M||w,q=q||w,W(w.semver,M.semver,X))M=w;else if(z(w.semver,q.semver,X))q=w}),M.operator===Q||M.operator===U)return!1;if((!q.operator||q.operator===Q)&&J(Z,q.semver))return!1;else if(q.operator===U&&z(Z,q.semver))return!1}return!0};OH.exports=gP});var SH=E((X01,FH)=>{var yP=u9(),vP=(Z,$,Y)=>yP(Z,$,">",Y);FH.exports=vP});var BH=E((W01,NH)=>{var hP=u9(),dP=(Z,$,Y)=>hP(Z,$,"<",Y);NH.exports=dP});var KH=E((J01,_H)=>{var LH=h8(),pP=(Z,$,Y)=>{return Z=new LH(Z,Y),$=new LH($,Y),Z.intersects($,Y)};_H.exports=pP});var VH=E((z01,RH)=>{var mP=u4(),cP=v8();RH.exports=(Z,$,Y)=>{let X=[],W=null,J=null,z=Z.sort((H,M)=>cP(H,M,Y));for(let H of z)if(mP(H,$,Y)){if(J=H,!W)W=H}else{if(J)X.push([W,J]);J=null,W=null}if(W)X.push([W,null]);let Q=[];for(let[H,M]of X)if(H===M)Q.push(H);else if(!M&&H===z[0])Q.push("*");else if(!M)Q.push(`>=${H}`);else if(H===z[0])Q.push(`<=${M}`);else Q.push(`${H} - ${M}`);let U=Q.join(" || "),G=typeof $.raw==="string"?$.raw:String($);return U.length<G.length?U:$}});var xH=E((Q01,PH)=>{var EH=h8(),A7=m4(),{ANY:q7}=A7,i4=u4(),O7=v8(),uP=(Z,$,Y={})=>{if(Z===$)return!0;Z=new EH(Z,Y),$=new EH($,Y);let X=!1;Z:for(let W of Z.set){for(let J of $.set){let z=lP(W,J,Y);if(X=X||z!==null,z)continue Z}if(X)return!1}return!0},iP=[new A7(">=0.0.0-0")],jH=[new A7(">=0.0.0")],lP=(Z,$,Y)=>{if(Z===$)return!0;if(Z.length===1&&Z[0].semver===q7)if($.length===1&&$[0].semver===q7)return!0;else if(Y.includePrerelease)Z=iP;else Z=jH;if($.length===1&&$[0].semver===q7)if(Y.includePrerelease)return!0;else $=jH;let X=new Set,W,J;for(let w of Z)if(w.operator===">"||w.operator===">=")W=CH(W,w,Y);else if(w.operator==="<"||w.operator==="<=")J=IH(J,w,Y);else X.add(w.semver);if(X.size>1)return null;let z;if(W&&J){if(z=O7(W.semver,J.semver,Y),z>0)return null;else if(z===0&&(W.operator!==">="||J.operator!=="<="))return null}for(let w of X){if(W&&!i4(w,String(W),Y))return null;if(J&&!i4(w,String(J),Y))return null;for(let B of $)if(!i4(w,String(B),Y))return!1;return!0}let Q,U,G,H,M=J&&!Y.includePrerelease&&J.semver.prerelease.length?J.semver:!1,q=W&&!Y.includePrerelease&&W.semver.prerelease.length?W.semver:!1;if(M&&M.prerelease.length===1&&J.operator==="<"&&M.prerelease[0]===0)M=!1;for(let w of $){if(H=H||w.operator===">"||w.operator===">=",G=G||w.operator==="<"||w.operator==="<=",W){if(q){if(w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===q.major&&w.semver.minor===q.minor&&w.semver.patch===q.patch)q=!1}if(w.operator===">"||w.operator===">="){if(Q=CH(W,w,Y),Q===w&&Q!==W)return!1}else if(W.operator===">="&&!i4(W.semver,String(w),Y))return!1}if(J){if(M){if(w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===M.major&&w.semver.minor===M.minor&&w.semver.patch===M.patch)M=!1}if(w.operator==="<"||w.operator==="<="){if(U=IH(J,w,Y),U===w&&U!==J)return!1}else if(J.operator==="<="&&!i4(J.semver,String(w),Y))return!1}if(!w.operator&&(J||W)&&z!==0)return!1}if(W&&G&&!J&&z!==0)return!1;if(J&&H&&!W&&z!==0)return!1;if(q||M)return!1;return!0},CH=(Z,$,Y)=>{if(!Z)return $;let X=O7(Z.semver,$.semver,Y);return X>0?Z:X<0?$:$.operator===">"&&Z.operator===">="?$:Z},IH=(Z,$,Y)=>{if(!Z)return $;let X=O7(Z.semver,$.semver,Y);return X<0?Z:X>0?$:$.operator==="<"&&Z.operator==="<="?$:Z};PH.exports=uP});var i9=E((G01,bH)=>{var F7=i$(),TH=v4(),nP=b0(),kH=z7(),oP=rZ(),tP=WU(),sP=zU(),rP=UU(),aP=wU(),eP=qU(),Zx=OU(),$x=SU(),Yx=BU(),Xx=v8(),Wx=RU(),Jx=EU(),zx=y9(),Qx=PU(),Gx=TU(),Ux=d4(),Hx=v9(),Mx=Q7(),wx=G7(),Dx=h9(),qx=d9(),Ax=U7(),Ox=pU(),Fx=m4(),Sx=h8(),Nx=u4(),Bx=XH(),Lx=JH(),_x=QH(),Kx=HH(),Rx=wH(),Vx=u9(),Ex=SH(),jx=BH(),Cx=KH(),Ix=VH(),Px=xH();bH.exports={parse:oP,valid:tP,clean:sP,inc:rP,diff:aP,major:eP,minor:Zx,patch:$x,prerelease:Yx,compare:Xx,rcompare:Wx,compareLoose:Jx,compareBuild:zx,sort:Qx,rsort:Gx,gt:Ux,lt:Hx,eq:Mx,neq:wx,gte:Dx,lte:qx,cmp:Ax,coerce:Ox,Comparator:Fx,Range:Sx,satisfies:Nx,toComparators:Bx,maxSatisfying:Lx,minSatisfying:_x,minVersion:Kx,validRange:Rx,outside:Vx,gtr:Ex,ltr:jx,intersects:Cx,simplifyRange:Ix,subset:Px,SemVer:nP,re:F7.re,src:F7.src,tokens:F7.t,SEMVER_SPEC_VERSION:TH.SEMVER_SPEC_VERSION,RELEASE_TYPES:TH.RELEASE_TYPES,compareIdentifiers:kH.compareIdentifiers,rcompareIdentifiers:kH.rcompareIdentifiers}});var gH=E((U01,fH)=>{var xx=i9();fH.exports=xx.satisfies(process.version,">=15.7.0")});var vH=E((H01,yH)=>{var Tx=i9();yH.exports=Tx.satisfies(process.version,">=16.9.0")});var S7=E((M01,hH)=>{var kx=gH(),bx=vH(),fx={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},gx={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};hH.exports=function(Z,$){if(!Z||!$)return;let Y=$.asymmetricKeyType;if(!Y)return;let X=fx[Y];if(!X)throw new Error(`Unknown key type "${Y}".`);if(!X.includes(Z))throw new Error(`"alg" parameter for "${Y}" key type must be one of: ${X.join(", ")}.`);if(kx)switch(Y){case"ec":let W=$.asymmetricKeyDetails.namedCurve,J=gx[Z];if(W!==J)throw new Error(`"alg" parameter "${Z}" requires curve "${J}".`);break;case"rsa-pss":if(bx){let z=parseInt(Z.slice(-3),10),{hashAlgorithm:Q,mgf1HashAlgorithm:U,saltLength:G}=$.asymmetricKeyDetails;if(Q!==`sha${z}`||U!==Q)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${Z}.`);if(G!==void 0&&G>z>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${Z}.`)}break}}});var N7=E((w01,dH)=>{var yx=i9();dH.exports=yx.satisfies(process.version,"^6.12.0 || >=8.0.0")});var cH=E((D01,mH)=>{var u1=y4(),vx=Z7(),pH=$7(),hx=e5(),dx=X7(),px=S7(),mx=N7(),cx=C9(),{KeyObject:ux,createSecretKey:ix,createPublicKey:lx}=B1("node:crypto"),B7=["RS256","RS384","RS512"],nx=["ES256","ES384","ES512"],L7=["RS256","RS384","RS512"],ox=["HS256","HS384","HS512"];if(mx)B7.splice(B7.length,0,"PS256","PS384","PS512"),L7.splice(L7.length,0,"PS256","PS384","PS512");mH.exports=function(Z,$,Y,X){if(typeof Y==="function"&&!X)X=Y,Y={};if(!Y)Y={};Y=Object.assign({},Y);let W;if(X)W=X;else W=function(H,M){if(H)throw H;return M};if(Y.clockTimestamp&&typeof Y.clockTimestamp!=="number")return W(new u1("clockTimestamp must be a number"));if(Y.nonce!==void 0&&(typeof Y.nonce!=="string"||Y.nonce.trim()===""))return W(new u1("nonce must be a non-empty string"));if(Y.allowInvalidAsymmetricKeyTypes!==void 0&&typeof Y.allowInvalidAsymmetricKeyTypes!=="boolean")return W(new u1("allowInvalidAsymmetricKeyTypes must be a boolean"));let J=Y.clockTimestamp||Math.floor(Date.now()/1000);if(!Z)return W(new u1("jwt must be provided"));if(typeof Z!=="string")return W(new u1("jwt must be a string"));let z=Z.split(".");if(z.length!==3)return W(new u1("jwt malformed"));let Q;try{Q=hx(Z,{complete:!0})}catch(H){return W(H)}if(!Q)return W(new u1("invalid token"));let U=Q.header,G;if(typeof $==="function"){if(!X)return W(new u1("verify must be called asynchronous if secret or public key is provided as a callback"));G=$}else G=function(H,M){return M(null,$)};return G(U,function(H,M){if(H)return W(new u1("error in secret or public key callback: "+H.message));let q=z[2].trim()!=="";if(!q&&M)return W(new u1("jwt signature is required"));if(q&&!M)return W(new u1("secret or public key must be provided"));if(!q&&!Y.algorithms)return W(new u1('please specify "none" in "algorithms" to verify unsigned tokens'));if(M!=null&&!(M instanceof ux))try{M=lx(M)}catch(D){try{M=ix(typeof M==="string"?Buffer.from(M):M)}catch(L){return W(new u1("secretOrPublicKey is not valid key material"))}}if(!Y.algorithms)if(M.type==="secret")Y.algorithms=ox;else if(["rsa","rsa-pss"].includes(M.asymmetricKeyType))Y.algorithms=L7;else if(M.asymmetricKeyType==="ec")Y.algorithms=nx;else Y.algorithms=B7;if(Y.algorithms.indexOf(Q.header.alg)===-1)return W(new u1("invalid algorithm"));if(U.alg.startsWith("HS")&&M.type!=="secret")return W(new u1(`secretOrPublicKey must be a symmetric key when using ${U.alg}`));else if(/^(?:RS|PS|ES)/.test(U.alg)&&M.type!=="public")return W(new u1(`secretOrPublicKey must be an asymmetric key when using ${U.alg}`));if(!Y.allowInvalidAsymmetricKeyTypes)try{px(U.alg,M)}catch(D){return W(D)}let w;try{w=cx.verify(Z,Q.header.alg,M)}catch(D){return W(D)}if(!w)return W(new u1("invalid signature"));let B=Q.payload;if(typeof B.nbf!=="undefined"&&!Y.ignoreNotBefore){if(typeof B.nbf!=="number")return W(new u1("invalid nbf value"));if(B.nbf>J+(Y.clockTolerance||0))return W(new vx("jwt not active",new Date(B.nbf*1000)))}if(typeof B.exp!=="undefined"&&!Y.ignoreExpiration){if(typeof B.exp!=="number")return W(new u1("invalid exp value"));if(J>=B.exp+(Y.clockTolerance||0))return W(new pH("jwt expired",new Date(B.exp*1000)))}if(Y.audience){let D=Array.isArray(Y.audience)?Y.audience:[Y.audience];if(!(Array.isArray(B.aud)?B.aud:[B.aud]).some(function(s){return D.some(function(t){return t instanceof RegExp?t.test(s):t===s})}))return W(new u1("jwt audience invalid. expected: "+D.join(" or ")))}if(Y.issuer){if(typeof Y.issuer==="string"&&B.iss!==Y.issuer||Array.isArray(Y.issuer)&&Y.issuer.indexOf(B.iss)===-1)return W(new u1("jwt issuer invalid. expected: "+Y.issuer))}if(Y.subject){if(B.sub!==Y.subject)return W(new u1("jwt subject invalid. expected: "+Y.subject))}if(Y.jwtid){if(B.jti!==Y.jwtid)return W(new u1("jwt jwtid invalid. expected: "+Y.jwtid))}if(Y.nonce){if(B.nonce!==Y.nonce)return W(new u1("jwt nonce invalid. expected: "+Y.nonce))}if(Y.maxAge){if(typeof B.iat!=="number")return W(new u1("iat required when maxAge is specified"));let D=dx(Y.maxAge,B.iat);if(typeof D==="undefined")return W(new u1('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(J>=D+(Y.clockTolerance||0))return W(new pH("maxAge exceeded",new Date(D*1000)))}if(Y.complete===!0){let D=Q.signature;return W(null,{header:U,payload:B,signature:D})}return W(null,B)})}});var tH=E((q01,oH)=>{var uH=1/0,lH=9007199254740991,tx=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,iH=NaN,sx="[object Arguments]",rx="[object Function]",ax="[object GeneratorFunction]",ex="[object String]",ZT="[object Symbol]",$T=/^\s+|\s+$/g,YT=/^[-+]0x[0-9a-f]+$/i,XT=/^0b[01]+$/i,WT=/^0o[0-7]+$/i,JT=/^(?:0|[1-9]\d*)$/,zT=parseInt;function QT(Z,$){var Y=-1,X=Z?Z.length:0,W=Array(X);while(++Y<X)W[Y]=$(Z[Y],Y,Z);return W}function GT(Z,$,Y,X){var W=Z.length,J=Y+(X?1:-1);while(X?J--:++J<W)if($(Z[J],J,Z))return J;return-1}function UT(Z,$,Y){if($!==$)return GT(Z,HT,Y);var X=Y-1,W=Z.length;while(++X<W)if(Z[X]===$)return X;return-1}function HT(Z){return Z!==Z}function MT(Z,$){var Y=-1,X=Array(Z);while(++Y<Z)X[Y]=$(Y);return X}function wT(Z,$){return QT($,function(Y){return Z[Y]})}function DT(Z,$){return function(Y){return Z($(Y))}}var l9=Object.prototype,K7=l9.hasOwnProperty,n9=l9.toString,qT=l9.propertyIsEnumerable,AT=DT(Object.keys,Object),OT=Math.max;function FT(Z,$){var Y=nH(Z)||_T(Z)?MT(Z.length,String):[],X=Y.length,W=!!X;for(var J in Z)if(($||K7.call(Z,J))&&!(W&&(J=="length"||NT(J,X))))Y.push(J);return Y}function ST(Z){if(!BT(Z))return AT(Z);var $=[];for(var Y in Object(Z))if(K7.call(Z,Y)&&Y!="constructor")$.push(Y);return $}function NT(Z,$){return $=$==null?lH:$,!!$&&(typeof Z=="number"||JT.test(Z))&&(Z>-1&&Z%1==0&&Z<$)}function BT(Z){var $=Z&&Z.constructor,Y=typeof $=="function"&&$.prototype||l9;return Z===Y}function LT(Z,$,Y,X){Z=R7(Z)?Z:TT(Z),Y=Y&&!X?IT(Y):0;var W=Z.length;if(Y<0)Y=OT(W+Y,0);return ET(Z)?Y<=W&&Z.indexOf($,Y)>-1:!!W&&UT(Z,$,Y)>-1}function _T(Z){return KT(Z)&&K7.call(Z,"callee")&&(!qT.call(Z,"callee")||n9.call(Z)==sx)}var nH=Array.isArray;function R7(Z){return Z!=null&&VT(Z.length)&&!RT(Z)}function KT(Z){return V7(Z)&&R7(Z)}function RT(Z){var $=_7(Z)?n9.call(Z):"";return $==rx||$==ax}function VT(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=lH}function _7(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function V7(Z){return!!Z&&typeof Z=="object"}function ET(Z){return typeof Z=="string"||!nH(Z)&&V7(Z)&&n9.call(Z)==ex}function jT(Z){return typeof Z=="symbol"||V7(Z)&&n9.call(Z)==ZT}function CT(Z){if(!Z)return Z===0?Z:0;if(Z=PT(Z),Z===uH||Z===-uH){var $=Z<0?-1:1;return $*tx}return Z===Z?Z:0}function IT(Z){var $=CT(Z),Y=$%1;return $===$?Y?$-Y:$:0}function PT(Z){if(typeof Z=="number")return Z;if(jT(Z))return iH;if(_7(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=_7($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace($T,"");var Y=XT.test(Z);return Y||WT.test(Z)?zT(Z.slice(2),Y?2:8):YT.test(Z)?iH:+Z}function xT(Z){return R7(Z)?FT(Z):ST(Z)}function TT(Z){return Z?wT(Z,xT(Z)):[]}oH.exports=LT});var rH=E((A01,sH)=>{var kT="[object Boolean]",bT=Object.prototype,fT=bT.toString;function gT(Z){return Z===!0||Z===!1||yT(Z)&&fT.call(Z)==kT}function yT(Z){return!!Z&&typeof Z=="object"}sH.exports=gT});var YM=E((O01,$M)=>{var aH=1/0,vT=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,eH=NaN,hT="[object Symbol]",dT=/^\s+|\s+$/g,pT=/^[-+]0x[0-9a-f]+$/i,mT=/^0b[01]+$/i,cT=/^0o[0-7]+$/i,uT=parseInt,iT=Object.prototype,lT=iT.toString;function nT(Z){return typeof Z=="number"&&Z==rT(Z)}function ZM(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function oT(Z){return!!Z&&typeof Z=="object"}function tT(Z){return typeof Z=="symbol"||oT(Z)&&lT.call(Z)==hT}function sT(Z){if(!Z)return Z===0?Z:0;if(Z=aT(Z),Z===aH||Z===-aH){var $=Z<0?-1:1;return $*vT}return Z===Z?Z:0}function rT(Z){var $=sT(Z),Y=$%1;return $===$?Y?$-Y:$:0}function aT(Z){if(typeof Z=="number")return Z;if(tT(Z))return eH;if(ZM(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=ZM($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(dT,"");var Y=mT.test(Z);return Y||cT.test(Z)?uT(Z.slice(2),Y?2:8):pT.test(Z)?eH:+Z}$M.exports=nT});var WM=E((F01,XM)=>{var eT="[object Number]",Zk=Object.prototype,$k=Zk.toString;function Yk(Z){return!!Z&&typeof Z=="object"}function Xk(Z){return typeof Z=="number"||Yk(Z)&&$k.call(Z)==eT}XM.exports=Xk});var GM=E((S01,QM)=>{var Wk="[object Object]";function Jk(Z){var $=!1;if(Z!=null&&typeof Z.toString!="function")try{$=!!(Z+"")}catch(Y){}return $}function zk(Z,$){return function(Y){return Z($(Y))}}var Qk=Function.prototype,JM=Object.prototype,zM=Qk.toString,Gk=JM.hasOwnProperty,Uk=zM.call(Object),Hk=JM.toString,Mk=zk(Object.getPrototypeOf,Object);function wk(Z){return!!Z&&typeof Z=="object"}function Dk(Z){if(!wk(Z)||Hk.call(Z)!=Wk||Jk(Z))return!1;var $=Mk(Z);if($===null)return!0;var Y=Gk.call($,"constructor")&&$.constructor;return typeof Y=="function"&&Y instanceof Y&&zM.call(Y)==Uk}QM.exports=Dk});var HM=E((N01,UM)=>{var qk="[object String]",Ak=Object.prototype,Ok=Ak.toString,Fk=Array.isArray;function Sk(Z){return!!Z&&typeof Z=="object"}function Nk(Z){return typeof Z=="string"||!Fk(Z)&&Sk(Z)&&Ok.call(Z)==qk}UM.exports=Nk});var AM=E((B01,qM)=>{var Bk="Expected a function",MM=1/0,Lk=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,wM=NaN,_k="[object Symbol]",Kk=/^\s+|\s+$/g,Rk=/^[-+]0x[0-9a-f]+$/i,Vk=/^0b[01]+$/i,Ek=/^0o[0-7]+$/i,jk=parseInt,Ck=Object.prototype,Ik=Ck.toString;function Pk(Z,$){var Y;if(typeof $!="function")throw new TypeError(Bk);return Z=fk(Z),function(){if(--Z>0)Y=$.apply(this,arguments);if(Z<=1)$=void 0;return Y}}function xk(Z){return Pk(2,Z)}function DM(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function Tk(Z){return!!Z&&typeof Z=="object"}function kk(Z){return typeof Z=="symbol"||Tk(Z)&&Ik.call(Z)==_k}function bk(Z){if(!Z)return Z===0?Z:0;if(Z=gk(Z),Z===MM||Z===-MM){var $=Z<0?-1:1;return $*Lk}return Z===Z?Z:0}function fk(Z){var $=bk(Z),Y=$%1;return $===$?Y?$-Y:$:0}function gk(Z){if(typeof Z=="number")return Z;if(kk(Z))return wM;if(DM(Z)){var $=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=DM($)?$+"":$}if(typeof Z!="string")return Z===0?Z:+Z;Z=Z.replace(Kk,"");var Y=Vk.test(Z);return Y||Ek.test(Z)?jk(Z.slice(2),Y?2:8):Rk.test(Z)?wM:+Z}qM.exports=xk});var RM=E((L01,KM)=>{var OM=X7(),yk=N7(),vk=S7(),FM=C9(),hk=tH(),o9=rH(),SM=YM(),E7=WM(),BM=GM(),SZ=HM(),dk=AM(),{KeyObject:pk,createSecretKey:mk,createPrivateKey:ck}=B1("node:crypto"),LM=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];if(yk)LM.splice(3,0,"PS256","PS384","PS512");var uk={expiresIn:{isValid:function(Z){return SM(Z)||SZ(Z)&&Z},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(Z){return SM(Z)||SZ(Z)&&Z},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(Z){return SZ(Z)||Array.isArray(Z)},message:'"audience" must be a string or array'},algorithm:{isValid:hk.bind(null,LM),message:'"algorithm" must be a valid string enum value'},header:{isValid:BM,message:'"header" must be an object'},encoding:{isValid:SZ,message:'"encoding" must be a string'},issuer:{isValid:SZ,message:'"issuer" must be a string'},subject:{isValid:SZ,message:'"subject" must be a string'},jwtid:{isValid:SZ,message:'"jwtid" must be a string'},noTimestamp:{isValid:o9,message:'"noTimestamp" must be a boolean'},keyid:{isValid:SZ,message:'"keyid" must be a string'},mutatePayload:{isValid:o9,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:o9,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:o9,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},ik={iat:{isValid:E7,message:'"iat" should be a number of seconds'},exp:{isValid:E7,message:'"exp" should be a number of seconds'},nbf:{isValid:E7,message:'"nbf" should be a number of seconds'}};function _M(Z,$,Y,X){if(!BM(Y))throw new Error('Expected "'+X+'" to be a plain object.');Object.keys(Y).forEach(function(W){let J=Z[W];if(!J){if(!$)throw new Error('"'+W+'" is not allowed in "'+X+'"');return}if(!J.isValid(Y[W]))throw new Error(J.message)})}function lk(Z){return _M(uk,!1,Z,"options")}function nk(Z){return _M(ik,!0,Z,"payload")}var NM={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},ok=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];KM.exports=function(Z,$,Y,X){if(typeof Y==="function")X=Y,Y={};else Y=Y||{};let W=typeof Z==="object"&&!Buffer.isBuffer(Z),J=Object.assign({alg:Y.algorithm||"HS256",typ:W?"JWT":void 0,kid:Y.keyid},Y.header);function z(G){if(X)return X(G);throw G}if(!$&&Y.algorithm!=="none")return z(new Error("secretOrPrivateKey must have a value"));if($!=null&&!($ instanceof pk))try{$=ck($)}catch(G){try{$=mk(typeof $==="string"?Buffer.from($):$)}catch(H){return z(new Error("secretOrPrivateKey is not valid key material"))}}if(J.alg.startsWith("HS")&&$.type!=="secret")return z(new Error(`secretOrPrivateKey must be a symmetric key when using ${J.alg}`));else if(/^(?:RS|PS|ES)/.test(J.alg)){if($.type!=="private")return z(new Error(`secretOrPrivateKey must be an asymmetric key when using ${J.alg}`));if(!Y.allowInsecureKeySizes&&!J.alg.startsWith("ES")&&$.asymmetricKeyDetails!==void 0&&$.asymmetricKeyDetails.modulusLength<2048)return z(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${J.alg}`))}if(typeof Z==="undefined")return z(new Error("payload is required"));else if(W){try{nk(Z)}catch(G){return z(G)}if(!Y.mutatePayload)Z=Object.assign({},Z)}else{let G=ok.filter(function(H){return typeof Y[H]!=="undefined"});if(G.length>0)return z(new Error("invalid "+G.join(",")+" option for "+typeof Z+" payload"))}if(typeof Z.exp!=="undefined"&&typeof Y.expiresIn!=="undefined")return z(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof Z.nbf!=="undefined"&&typeof Y.notBefore!=="undefined")return z(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{lk(Y)}catch(G){return z(G)}if(!Y.allowInvalidAsymmetricKeyTypes)try{vk(J.alg,$)}catch(G){return z(G)}let Q=Z.iat||Math.floor(Date.now()/1000);if(Y.noTimestamp)delete Z.iat;else if(W)Z.iat=Q;if(typeof Y.notBefore!=="undefined"){try{Z.nbf=OM(Y.notBefore,Q)}catch(G){return z(G)}if(typeof Z.nbf==="undefined")return z(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof Y.expiresIn!=="undefined"&&typeof Z==="object"){try{Z.exp=OM(Y.expiresIn,Q)}catch(G){return z(G)}if(typeof Z.exp==="undefined")return z(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(NM).forEach(function(G){let H=NM[G];if(typeof Y[G]!=="undefined"){if(typeof Z[H]!=="undefined")return z(new Error('Bad "options.'+G+'" option. The payload already has an "'+H+'" property.'));Z[H]=Y[G]}});let U=Y.encoding||"utf8";if(typeof X==="function")X=X&&dk(X),FM.createSign({header:J,privateKey:$,payload:Z,encoding:U}).once("error",X).once("done",function(G){if(!Y.allowInsecureKeySizes&&/^(?:RS|PS)/.test(J.alg)&&G.length<256)return X(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${J.alg}`));X(null,G)});else{let G=FM.sign({header:J,payload:Z,secret:$,encoding:U});if(!Y.allowInsecureKeySizes&&/^(?:RS|PS)/.test(J.alg)&&G.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${J.alg}`);return G}}});var EM=E((_01,VM)=>{VM.exports={decode:e5(),verify:cH(),sign:RM(),JsonWebTokenError:y4(),NotBeforeError:Z7(),TokenExpiredError:$7()}});var jM=E((R01,tk)=>{tk.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var o$=E((B8)=>{var sk=B8&&B8.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(B8,"__esModule",{value:!0});B8.getKeyIndexes=B8.hasFlag=B8.exists=B8.list=void 0;var t9=sk(jM());B8.list=Object.keys(t9.default);var j7={};B8.list.forEach((Z)=>{j7[Z]=t9.default[Z].flags.reduce(function($,Y){return $[Y]=!0,$},{})});function rk(Z){return Boolean(t9.default[Z])}B8.exists=rk;function ak(Z,$){if(!j7[Z])throw new Error("Unknown command "+Z);return Boolean(j7[Z][$])}B8.hasFlag=ak;function ek(Z,$,Y){let X=t9.default[Z];if(!X)throw new Error("Unknown command "+Z);if(!Array.isArray($))throw new Error("Expect args to be an array");let W=[],J=Boolean(Y&&Y.parseExternalKey),z=(U,G)=>{let H=[],M=Number(U[G]);for(let q=0;q<M;q++)H.push(q+G+1);return H},Q=(U,G,H)=>{for(let M=G;M<U.length-1;M+=1)if(String(U[M]).toLowerCase()===H.toLowerCase())return M+1;return null};switch(Z){case"zunionstore":case"zinterstore":case"zdiffstore":W.push(0,...z($,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":W.push(...z($,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{W.push(...z($,0));break}case"georadius":{W.push(0);let U=Q($,5,"STORE");if(U)W.push(U);let G=Q($,5,"STOREDIST");if(G)W.push(G);break}case"georadiusbymember":{W.push(0);let U=Q($,4,"STORE");if(U)W.push(U);let G=Q($,4,"STOREDIST");if(G)W.push(G);break}case"sort":case"sort_ro":W.push(0);for(let U=1;U<$.length-1;U++){let G=$[U];if(typeof G!=="string")continue;let H=G.toUpperCase();if(H==="GET"){if(U+=1,G=$[U],G!=="#")if(J)W.push([U,CM(G)]);else W.push(U)}else if(H==="BY")if(U+=1,J)W.push([U,CM($[U])]);else W.push(U);else if(H==="STORE")U+=1,W.push(U)}break;case"migrate":if($[2]==="")for(let U=5;U<$.length-1;U++){let G=$[U];if(typeof G==="string"&&G.toUpperCase()==="KEYS"){for(let H=U+1;H<$.length;H++)W.push(H);break}}else W.push(2);break;case"xreadgroup":case"xread":for(let U=Z==="xread"?0:3;U<$.length-1;U++)if(String($[U]).toUpperCase()==="STREAMS"){for(let G=U+1;G<=U+($.length-1-U)/2;G++)W.push(G);break}break;default:if(X.step>0){let U=X.keyStart-1,G=X.keyStop>0?X.keyStop:$.length+X.keyStop+1;for(let H=U;H<G;H+=X.step)W.push(H)}break}return W}B8.getKeyIndexes=ek;function CM(Z){if(typeof Z!=="string")Z=String(Z);let $=Z.indexOf("->");return $===-1?Z.length:$}});var xM=E((IM)=>{Object.defineProperty(IM,"__esModule",{value:!0});IM.tryCatch=IM.errorObj=void 0;IM.errorObj={e:{}};var C7;function Zb(Z,$){try{let Y=C7;return C7=null,Y.apply(this,arguments)}catch(Y){return IM.errorObj.e=Y,IM.errorObj}}function $b(Z){return C7=Z,Zb}IM.tryCatch=$b});var NZ=E((kM)=>{Object.defineProperty(kM,"__esModule",{value:!0});var t$=xM();function TM(Z){setTimeout(function(){throw Z},0)}function Yb(Z,$,Y){if(typeof $==="function")Z.then((X)=>{let W;if(Y!==void 0&&Object(Y).spread&&Array.isArray(X))W=t$.tryCatch($).apply(void 0,[null].concat(X));else W=X===void 0?t$.tryCatch($)(null):t$.tryCatch($)(null,X);if(W===t$.errorObj)TM(W.e)},(X)=>{if(!X){let J=new Error(X+"");Object.assign(J,{cause:X}),X=J}let W=t$.tryCatch($)(X);if(W===t$.errorObj)TM(W.e)});return Z}kM.default=Yb});var gM=E((C01,fM)=>{var bM=B1("node:assert"),l4=B1("node:util");function s$(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}l4.inherits(s$,Error);Object.defineProperty(s$.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function P7(Z,$,Y){bM($),bM.strictEqual(typeof Y,"number"),Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0});let X=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=X,this.offset=Y,this.buffer=$}l4.inherits(P7,s$);Object.defineProperty(P7.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function x7(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0});let $=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=$}l4.inherits(x7,s$);Object.defineProperty(x7.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function s9(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}l4.inherits(s9,s$);Object.defineProperty(s9.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function T7(Z){Object.defineProperty(this,"message",{value:Z||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}l4.inherits(T7,s9);Object.defineProperty(T7.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});fM.exports={RedisError:s$,ParserError:P7,ReplyError:x7,AbortError:s9,InterruptError:T7}});var mM=E((I01,pM)=>{var yM=B1("node:assert");class n4 extends Error{get name(){return this.constructor.name}}class vM extends n4{constructor(Z,$,Y){yM($),yM.strictEqual(typeof Y,"number");let X=Error.stackTraceLimit;Error.stackTraceLimit=2;super(Z);Error.stackTraceLimit=X,this.offset=Y,this.buffer=$}get name(){return this.constructor.name}}class hM extends n4{constructor(Z){let $=Error.stackTraceLimit;Error.stackTraceLimit=2;super(Z);Error.stackTraceLimit=$}get name(){return this.constructor.name}}class k7 extends n4{get name(){return this.constructor.name}}class dM extends k7{get name(){return this.constructor.name}}pM.exports={RedisError:n4,ParserError:vM,ReplyError:hM,AbortError:k7,InterruptError:dM}});var aZ=E((P01,cM)=>{var Wb=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?gM():mM();cM.exports=Wb});var o4=E((x01,b7)=>{var uM=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],Jb=function Z($){var Y,X=0,W=0,J=[],z=$.length;for(;X<z;X++)if(Y=$.charCodeAt(X),Y<128)J[W++]=Y;else if(Y<2048)J[W++]=Y>>6|192,J[W++]=Y&63|128;else if((Y&64512)===55296&&X+1<$.length&&($.charCodeAt(X+1)&64512)===56320)Y=65536+((Y&1023)<<10)+($.charCodeAt(++X)&1023),J[W++]=Y>>18|240,J[W++]=Y>>12&63|128,J[W++]=Y>>6&63|128,J[W++]=Y&63|128;else J[W++]=Y>>12|224,J[W++]=Y>>6&63|128,J[W++]=Y&63|128;return J},iM=b7.exports=function Z($){var Y,X=0,W=-1,J=0,z=0,Q=typeof $==="string"?Jb($):$,U=Q.length;while(X<U){if(Y=Q[X++],W===-1){if(Y===123)W=X}else if(Y!==125)z=uM[(Y^z>>8)&255]^z<<8;else if(X-1!==W)return z&16383;J=uM[(Y^J>>8)&255]^J<<8}return J&16383};b7.exports.generateMulti=function Z($){var Y=1,X=$.length,W=iM($[0]);while(Y<X)if(iM($[Y++])!==W)return-1;return W}});var eM=E((T01,aM)=>{var nM=9007199254740991,zb="[object Arguments]",Qb="[object Function]",Gb="[object GeneratorFunction]",Ub=/^(?:0|[1-9]\d*)$/;function oM(Z,$,Y){switch(Y.length){case 0:return Z.call($);case 1:return Z.call($,Y[0]);case 2:return Z.call($,Y[0],Y[1]);case 3:return Z.call($,Y[0],Y[1],Y[2])}return Z.apply($,Y)}function Hb(Z,$){var Y=-1,X=Array(Z);while(++Y<Z)X[Y]=$(Y);return X}var t4=Object.prototype,s4=t4.hasOwnProperty,tM=t4.toString,Mb=t4.propertyIsEnumerable,lM=Math.max;function wb(Z,$){var Y=_b(Z)||Lb(Z)?Hb(Z.length,String):[],X=Y.length,W=!!X;for(var J in Z)if(($||s4.call(Z,J))&&!(W&&(J=="length"||rM(J,X))))Y.push(J);return Y}function Db(Z,$,Y,X){if(Z===void 0||f7(Z,t4[Y])&&!s4.call(X,Y))return $;return Z}function qb(Z,$,Y){var X=Z[$];if(!(s4.call(Z,$)&&f7(X,Y))||Y===void 0&&!($ in Z))Z[$]=Y}function Ab(Z){if(!y7(Z))return Bb(Z);var $=Nb(Z),Y=[];for(var X in Z)if(!(X=="constructor"&&($||!s4.call(Z,X))))Y.push(X);return Y}function sM(Z,$){return $=lM($===void 0?Z.length-1:$,0),function(){var Y=arguments,X=-1,W=lM(Y.length-$,0),J=Array(W);while(++X<W)J[X]=Y[$+X];X=-1;var z=Array($+1);while(++X<$)z[X]=Y[X];return z[$]=J,oM(Z,this,z)}}function Ob(Z,$,Y,X){Y||(Y={});var W=-1,J=$.length;while(++W<J){var z=$[W],Q=X?X(Y[z],Z[z],z,Y,Z):void 0;qb(Y,z,Q===void 0?Z[z]:Q)}return Y}function Fb(Z){return sM(function($,Y){var X=-1,W=Y.length,J=W>1?Y[W-1]:void 0,z=W>2?Y[2]:void 0;if(J=Z.length>3&&typeof J=="function"?(W--,J):void 0,z&&Sb(Y[0],Y[1],z))J=W<3?void 0:J,W=1;$=Object($);while(++X<W){var Q=Y[X];if(Q)Z($,Q,X,J)}return $})}function rM(Z,$){return $=$==null?nM:$,!!$&&(typeof Z=="number"||Ub.test(Z))&&(Z>-1&&Z%1==0&&Z<$)}function Sb(Z,$,Y){if(!y7(Y))return!1;var X=typeof $;if(X=="number"?g7(Y)&&rM($,Y.length):X=="string"&&($ in Y))return f7(Y[$],Z);return!1}function Nb(Z){var $=Z&&Z.constructor,Y=typeof $=="function"&&$.prototype||t4;return Z===Y}function Bb(Z){var $=[];if(Z!=null)for(var Y in Object(Z))$.push(Y);return $}function f7(Z,$){return Z===$||Z!==Z&&$!==$}function Lb(Z){return Kb(Z)&&s4.call(Z,"callee")&&(!Mb.call(Z,"callee")||tM.call(Z)==zb)}var _b=Array.isArray;function g7(Z){return Z!=null&&Vb(Z.length)&&!Rb(Z)}function Kb(Z){return Eb(Z)&&g7(Z)}function Rb(Z){var $=y7(Z)?tM.call(Z):"";return $==Qb||$==Gb}function Vb(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=nM}function y7(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function Eb(Z){return!!Z&&typeof Z=="object"}var jb=Fb(function(Z,$,Y,X){Ob($,Ib($),Z,X)}),Cb=sM(function(Z){return Z.push(void 0,Db),oM(jb,void 0,Z)});function Ib(Z){return g7(Z)?wb(Z,!0):Ab(Z)}aM.exports=Cb});var Yw=E((k01,$w)=>{var Pb=9007199254740991,xb="[object Arguments]",Tb="[object Function]",kb="[object GeneratorFunction]",v7=Object.prototype,bb=v7.hasOwnProperty,Zw=v7.toString,fb=v7.propertyIsEnumerable;function gb(Z){return vb(Z)&&bb.call(Z,"callee")&&(!fb.call(Z,"callee")||Zw.call(Z)==xb)}function yb(Z){return Z!=null&&db(Z.length)&&!hb(Z)}function vb(Z){return mb(Z)&&yb(Z)}function hb(Z){var $=pb(Z)?Zw.call(Z):"";return $==Tb||$==kb}function db(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=Pb}function pb(Z){var $=typeof Z;return!!Z&&($=="object"||$=="function")}function mb(Z){return!!Z&&typeof Z=="object"}$w.exports=gb});var r9=E((Xw)=>{Object.defineProperty(Xw,"__esModule",{value:!0});Xw.isArguments=Xw.defaults=Xw.noop=void 0;var cb=eM();Xw.defaults=cb;var ub=Yw();Xw.isArguments=ub;function ib(){}Xw.noop=ib});var h7=E((f01,Jw)=>{function ob(Z){Y.debug=Y,Y.default=Y,Y.coerce=U,Y.disable=z,Y.enable=W,Y.enabled=Q,Y.humanize=Y7(),Y.destroy=G,Object.keys(Z).forEach((H)=>{Y[H]=Z[H]}),Y.names=[],Y.skips=[],Y.formatters={};function $(H){let M=0;for(let q=0;q<H.length;q++)M=(M<<5)-M+H.charCodeAt(q),M|=0;return Y.colors[Math.abs(M)%Y.colors.length]}Y.selectColor=$;function Y(H){let M,q=null,w,B;function D(...L){if(!D.enabled)return;let b=D,s=Number(new Date),t=s-(M||s);if(b.diff=t,b.prev=M,b.curr=s,M=s,L[0]=Y.coerce(L[0]),typeof L[0]!=="string")L.unshift("%O");let J1=0;L[0]=L[0].replace(/%([a-zA-Z%])/g,(P,I)=>{if(P==="%%")return"%";J1++;let f=Y.formatters[I];if(typeof f==="function"){let T=L[J1];P=f.call(b,T),L.splice(J1,1),J1--}return P}),Y.formatArgs.call(b,L),(b.log||Y.log).apply(b,L)}if(D.namespace=H,D.useColors=Y.useColors(),D.color=Y.selectColor(H),D.extend=X,D.destroy=Y.destroy,Object.defineProperty(D,"enabled",{enumerable:!0,configurable:!1,get:()=>{if(q!==null)return q;if(w!==Y.namespaces)w=Y.namespaces,B=Y.enabled(H);return B},set:(L)=>{q=L}}),typeof Y.init==="function")Y.init(D);return D}function X(H,M){let q=Y(this.namespace+(typeof M==="undefined"?":":M)+H);return q.log=this.log,q}function W(H){Y.save(H),Y.namespaces=H,Y.names=[],Y.skips=[];let M=(typeof H==="string"?H:"").trim().replace(" ",",").split(",").filter(Boolean);for(let q of M)if(q[0]==="-")Y.skips.push(q.slice(1));else Y.names.push(q)}function J(H,M){let q=0,w=0,B=-1,D=0;while(q<H.length)if(w<M.length&&(M[w]===H[q]||M[w]==="*"))if(M[w]==="*")B=w,D=q,w++;else q++,w++;else if(B!==-1)w=B+1,D++,q=D;else return!1;while(w<M.length&&M[w]==="*")w++;return w===M.length}function z(){let H=[...Y.names,...Y.skips.map((M)=>"-"+M)].join(",");return Y.enable(""),H}function Q(H){for(let M of Y.skips)if(J(H,M))return!1;for(let M of Y.names)if(J(H,M))return!0;return!1}function U(H){if(H instanceof Error)return H.stack||H.message;return H}function G(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return Y.enable(Y.load()),Y}Jw.exports=ob});var Qw=E((zw,e9)=>{zw.formatArgs=sb;zw.save=rb;zw.load=ab;zw.useColors=tb;zw.storage=eb();zw.destroy=(()=>{let Z=!1;return()=>{if(!Z)Z=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}})();zw.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function tb(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let Z;return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&(Z=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(Z[1],10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function sb(Z){if(Z[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Z[0]+(this.useColors?"%c ":" ")+"+"+e9.exports.humanize(this.diff),!this.useColors)return;let $="color: "+this.color;Z.splice(1,0,$,"color: inherit");let Y=0,X=0;Z[0].replace(/%[a-zA-Z%]/g,(W)=>{if(W==="%%")return;if(Y++,W==="%c")X=Y}),Z.splice(X,0,$)}zw.log=console.debug||console.log||(()=>{});function rb(Z){try{if(Z)zw.storage.setItem("debug",Z);else zw.storage.removeItem("debug")}catch($){}}function ab(){let Z;try{Z=zw.storage.getItem("debug")}catch($){}if(!Z&&typeof process!=="undefined"&&"env"in process)Z=process.env.DEBUG;return Z}function eb(){try{return localStorage}catch(Z){}}e9.exports=h7()(zw);var{formatters:Zf}=e9.exports;Zf.j=function(Z){try{return JSON.stringify(Z)}catch($){return"[UnexpectedJSONParseError]: "+$.message}}});var Mw=E((Uw,$X)=>{var Gf=B1("node:tty"),ZX=B1("node:util");Uw.init=Af;Uw.log=wf;Uw.formatArgs=Hf;Uw.save=Df;Uw.load=qf;Uw.useColors=Uf;Uw.destroy=ZX.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Uw.colors=[6,2,3,4,5,1];try{let Z=(()=>{throw new Error("Cannot require module "+"supports-color");})();if(Z&&(Z.stderr||Z).level>=2)Uw.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}catch(Z){}Uw.inspectOpts=Object.keys(process.env).filter((Z)=>{return/^debug_/i.test(Z)}).reduce((Z,$)=>{let Y=$.substring(6).toLowerCase().replace(/_([a-z])/g,(W,J)=>{return J.toUpperCase()}),X=process.env[$];if(/^(yes|on|true|enabled)$/i.test(X))X=!0;else if(/^(no|off|false|disabled)$/i.test(X))X=!1;else if(X==="null")X=null;else X=Number(X);return Z[Y]=X,Z},{});function Uf(){return"colors"in Uw.inspectOpts?Boolean(Uw.inspectOpts.colors):Gf.isatty(process.stderr.fd)}function Hf(Z){let{namespace:$,useColors:Y}=this;if(Y){let X=this.color,W="\x1B[3"+(X<8?X:"8;5;"+X),J=`  ${W};1m${$} \x1B[0m`;Z[0]=J+Z[0].split(`
`).join(`
`+J),Z.push(W+"m+"+$X.exports.humanize(this.diff)+"\x1B[0m")}else Z[0]=Mf()+$+" "+Z[0]}function Mf(){if(Uw.inspectOpts.hideDate)return"";return new Date().toISOString()+" "}function wf(...Z){return process.stderr.write(ZX.formatWithOptions(Uw.inspectOpts,...Z)+`
`)}function Df(Z){if(Z)process.env.DEBUG=Z;else delete process.env.DEBUG}function qf(){return process.env.DEBUG}function Af(Z){Z.inspectOpts={};let $=Object.keys(Uw.inspectOpts);for(let Y=0;Y<$.length;Y++)Z.inspectOpts[$[Y]]=Uw.inspectOpts[$[Y]]}$X.exports=h7()(Uw);var{formatters:Gw}=$X.exports;Gw.o=function(Z){return this.inspectOpts.colors=this.useColors,ZX.inspect(Z,this.inspectOpts).split(`
`).map(($)=>$.trim()).join(" ")};Gw.O=function(Z){return this.inspectOpts.colors=this.useColors,ZX.inspect(Z,this.inspectOpts)}});var ww=E((v01,d7)=>{if(typeof process==="undefined"||process.type==="renderer"||!1||process.__nwjs)d7.exports=Qw();else d7.exports=Mw()});var Fw=E((Aw)=>{Object.defineProperty(Aw,"__esModule",{value:!0});Aw.genRedactedString=Aw.getStringValue=Aw.MAX_ARGUMENT_LENGTH=void 0;var Kf=ww(),p7=200;Aw.MAX_ARGUMENT_LENGTH=p7;var Rf="ioredis";function Dw(Z){if(Z===null)return;switch(typeof Z){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(Z))return Z.toString("hex");if(Array.isArray(Z))return Z.join(",");try{return JSON.stringify(Z)}catch($){return}case"string":return Z}}Aw.getStringValue=Dw;function qw(Z,$){let{length:Y}=Z;return Y<=$?Z:Z.slice(0,$)+' ... <REDACTED full-length="'+Y+'">'}Aw.genRedactedString=qw;function Vf(Z){let $=Kf.default(`${Rf}:${Z}`);function Y(...X){if(!$.enabled)return;for(let W=1;W<X.length;W++){let J=Dw(X[W]);if(typeof J==="string"&&J.length>p7)X[W]=qw(J,p7)}return $.apply(null,X)}return Object.defineProperties(Y,{namespace:{get(){return $.namespace}},enabled:{get(){return $.enabled}},destroy:{get(){return $.destroy}},log:{get(){return $.log},set(X){$.log=X}}}),Y}Aw.default=Vf});var Bw=E((Nw)=>{Object.defineProperty(Nw,"__esModule",{value:!0});var Sw=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,If={RedisCloudFixed:{ca:Sw},RedisCloudFlexible:{ca:Sw}};Nw.default=If});var E0=E((YX)=>{Object.defineProperty(YX,"__esModule",{value:!0});YX.noop=YX.defaults=YX.Debug=YX.zipMap=YX.CONNECTION_CLOSED_ERROR_MSG=YX.shuffle=YX.sample=YX.resolveTLSProfile=YX.parseURL=YX.optimizeErrorStack=YX.toArg=YX.convertMapToArray=YX.convertObjectToArray=YX.timeout=YX.packObject=YX.isInt=YX.wrapMultiResult=YX.convertBufferToString=void 0;var Lw=B1("node:url"),m7=r9();Object.defineProperty(YX,"defaults",{enumerable:!0,get:function(){return m7.defaults}});Object.defineProperty(YX,"noop",{enumerable:!0,get:function(){return m7.noop}});var xf=Fw();YX.Debug=xf.default;var Tf=Bw();function _w(Z,$){if(Z instanceof Buffer)return Z.toString($);if(Array.isArray(Z)){let Y=Z.length,X=Array(Y);for(let W=0;W<Y;++W)X[W]=Z[W]instanceof Buffer&&$==="utf8"?Z[W].toString():_w(Z[W],$);return X}return Z}YX.convertBufferToString=_w;function kf(Z){if(!Z)return null;let $=[],Y=Z.length;for(let X=0;X<Y;++X){let W=Z[X];if(W instanceof Error)$.push([W]);else $.push([null,W])}return $}YX.wrapMultiResult=kf;function Kw(Z){let $=parseFloat(Z);return!isNaN(Z)&&($|0)===$}YX.isInt=Kw;function bf(Z){let $={},Y=Z.length;for(let X=1;X<Y;X+=2)$[Z[X-1]]=Z[X];return $}YX.packObject=bf;function ff(Z,$){let Y=null,X=function(){if(Y)clearTimeout(Y),Y=null,Z.apply(this,arguments)};return Y=setTimeout(X,$,new Error("timeout")),X}YX.timeout=ff;function gf(Z){let $=[],Y=Object.keys(Z);for(let X=0,W=Y.length;X<W;X++)$.push(Y[X],Z[Y[X]]);return $}YX.convertObjectToArray=gf;function yf(Z){let $=[],Y=0;return Z.forEach(function(X,W){$[Y]=W,$[Y+1]=X,Y+=2}),$}YX.convertMapToArray=yf;function vf(Z){if(Z===null||typeof Z==="undefined")return"";return String(Z)}YX.toArg=vf;function hf(Z,$,Y){let X=$.split(`
`),W="",J;for(J=1;J<X.length;++J)if(X[J].indexOf(Y)===-1)break;for(let z=J;z<X.length;++z)W+=`
`+X[z];if(Z.stack){let z=Z.stack.indexOf(`
`);Z.stack=Z.stack.slice(0,z)+W}return Z}YX.optimizeErrorStack=hf;function df(Z){if(Kw(Z))return{port:Z};let $=Lw.parse(Z,!0,!0);if(!$.slashes&&Z[0]!=="/")Z="//"+Z,$=Lw.parse(Z,!0,!0);let Y=$.query||{},X={};if($.auth){let W=$.auth.indexOf(":");X.username=W===-1?$.auth:$.auth.slice(0,W),X.password=W===-1?"":$.auth.slice(W+1)}if($.pathname)if($.protocol==="redis:"||$.protocol==="rediss:"){if($.pathname.length>1)X.db=$.pathname.slice(1)}else X.path=$.pathname;if($.host)X.host=$.hostname;if($.port)X.port=$.port;if(typeof Y.family==="string"){let W=Number.parseInt(Y.family,10);if(!Number.isNaN(W))X.family=W}return m7.defaults(X,Y),X}YX.parseURL=df;function pf(Z){let $=Z===null||Z===void 0?void 0:Z.tls;if(typeof $==="string")$={profile:$};let Y=Tf.default[$===null||$===void 0?void 0:$.profile];if(Y)$=Object.assign({},Y,$),delete $.profile,Z=Object.assign({},Z,{tls:$});return Z}YX.resolveTLSProfile=pf;function mf(Z,$=0){let Y=Z.length;if($>=Y)return null;return Z[$+Math.floor(Math.random()*(Y-$))]}YX.sample=mf;function cf(Z){let $=Z.length;while($>0){let Y=Math.floor(Math.random()*$);$--,[Z[$],Z[Y]]=[Z[Y],Z[$]]}return Z}YX.shuffle=cf;YX.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function uf(Z,$){let Y=new Map;return Z.forEach((X,W)=>{Y.set(X,$[W])}),Y}YX.zipMap=uf});var l6=E((Cw)=>{var __dirname="C:\\Users\\Eray\\Desktop\\elysia-backend\\node_modules\\ioredis\\built";Object.defineProperty(Cw,"__esModule",{value:!0});var Rw=o$(),Ug=o4(),Hg=NZ(),Z$=E0();class L8{constructor(Z,$=[],Y={},X){if(this.name=Z,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=Y.replyEncoding,this.errorStack=Y.errorStack,this.args=$.flat(),this.callback=X,this.initPromise(),Y.keyPrefix){let W=Y.keyPrefix instanceof Buffer,J=W?Y.keyPrefix:null;this._iterateKeys((z)=>{if(z instanceof Buffer){if(J===null)J=Buffer.from(Y.keyPrefix);return Buffer.concat([J,z])}else if(W)return Buffer.concat([Y.keyPrefix,Buffer.from(String(z))]);return Y.keyPrefix+z})}if(Y.readOnly)this.isReadOnly=!0}static checkFlag(Z,$){return!!this.getFlagMap()[Z][$]}static setArgumentTransformer(Z,$){this._transformer.argument[Z]=$}static setReplyTransformer(Z,$){this._transformer.reply[Z]=$}static getFlagMap(){if(!this.flagMap)this.flagMap=Object.keys(L8.FLAGS).reduce((Z,$)=>{return Z[$]={},L8.FLAGS[$].forEach((Y)=>{Z[$][Y]=!0}),Z},{});return this.flagMap}getSlot(){if(typeof this.slot==="undefined"){let Z=this.getKeys()[0];this.slot=Z==null?null:Ug(Z)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(Z){let $,Y="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let X=new jw;X.push(Y);for(let W=0;W<this.args.length;++W){let J=this.args[W];if(J instanceof Buffer)if(J.length===0)X.push(`$0\r
\r
`);else X.push("$"+J.length+`\r
`),X.push(J),X.push(`\r
`);else X.push("$"+Buffer.byteLength(J)+`\r
`+J+`\r
`)}$=X.toBuffer()}else{$=Y;for(let X=0;X<this.args.length;++X){let W=this.args[X];$+="$"+Buffer.byteLength(W)+`\r
`+W+`\r
`}}return $}stringifyArguments(){for(let Z=0;Z<this.args.length;++Z){let $=this.args[Z];if(typeof $==="string");else if($ instanceof Buffer)this.bufferMode=!0;else this.args[Z]=Z$.toArg($)}}transformReply(Z){if(this.replyEncoding)Z=Z$.convertBufferToString(Z,this.replyEncoding);let $=L8._transformer.reply[this.name];if($)Z=$(Z);return Z}setTimeout(Z){if(!this._commandTimeoutTimer)this._commandTimeoutTimer=setTimeout(()=>{if(!this.isResolved)this.reject(new Error("Command timed out"))},Z)}initPromise(){let Z=new Promise(($,Y)=>{if(!this.transformed){this.transformed=!0;let X=L8._transformer.argument[this.name];if(X)this.args=X(this.args);this.stringifyArguments()}if(this.resolve=this._convertValue($),this.errorStack)this.reject=(X)=>{Y(Z$.optimizeErrorStack(X,this.errorStack.stack,__dirname))};else this.reject=Y});this.promise=Hg.default(Z,this.callback)}_iterateKeys(Z=($)=>$){if(typeof this.keys==="undefined"){if(this.keys=[],Rw.exists(this.name)){let $=Rw.getKeyIndexes(this.name,this.args);for(let Y of $)this.args[Y]=Z(this.args[Y]),this.keys.push(this.args[Y])}}return this.keys}_convertValue(Z){return($)=>{try{let Y=this._commandTimeoutTimer;if(Y)clearTimeout(Y),delete this._commandTimeoutTimer;Z(this.transformReply($)),this.isResolved=!0}catch(Y){this.reject(Y)}return this.promise}}}Cw.default=L8;L8.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]};L8._transformer={argument:{},reply:{}};var Vw=function(Z){if(Z.length===1){if(Z[0]instanceof Map)return Z$.convertMapToArray(Z[0]);if(typeof Z[0]==="object"&&Z[0]!==null)return Z$.convertObjectToArray(Z[0])}return Z},Ew=function(Z){if(Z.length===2){if(Z[1]instanceof Map)return[Z[0]].concat(Z$.convertMapToArray(Z[1]));if(typeof Z[1]==="object"&&Z[1]!==null)return[Z[0]].concat(Z$.convertObjectToArray(Z[1]))}return Z};L8.setArgumentTransformer("mset",Vw);L8.setArgumentTransformer("msetnx",Vw);L8.setArgumentTransformer("hset",Ew);L8.setArgumentTransformer("hmset",Ew);L8.setReplyTransformer("hgetall",function(Z){if(Array.isArray(Z)){let $={};for(let Y=0;Y<Z.length;Y+=2){let X=Z[Y],W=Z[Y+1];if(X in $)Object.defineProperty($,X,{value:W,configurable:!0,enumerable:!0,writable:!0});else $[X]=W}return $}return Z});class jw{constructor(){this.length=0,this.items=[]}push(Z){this.length+=Buffer.byteLength(Z),this.items.push(Z)}toBuffer(){let Z=Buffer.allocUnsafe(this.length),$=0;for(let Y of this.items){let X=Buffer.byteLength(Y);Buffer.isBuffer(Y)?Y.copy(Z,$):Z.write(Y,$,X),$+=X}return Z}}});var Pw=E((Iw)=>{Object.defineProperty(Iw,"__esModule",{value:!0});var wg=aZ();class c7 extends wg.RedisError{constructor(Z,$){super(Z);this.lastNodeError=$,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}Iw.default=c7;c7.defaultMessage="Failed to refresh slots cache."});var XX=E((Tw)=>{Object.defineProperty(Tw,"__esModule",{value:!0});var qg=B1("node:stream");class xw extends qg.Readable{constructor(Z){super(Z);this.opt=Z,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let Z=[this._redisCursor];if(this.opt.key)Z.unshift(this.opt.key);if(this.opt.match)Z.push("MATCH",this.opt.match);if(this.opt.type)Z.push("TYPE",this.opt.type);if(this.opt.count)Z.push("COUNT",String(this.opt.count));if(this.opt.noValues)Z.push("NOVALUES");this.opt.redis[this.opt.command](Z,($,Y)=>{if($){this.emit("error",$);return}if(this._redisCursor=Y[0]instanceof Buffer?Y[0].toString():Y[0],this._redisCursor==="0")this._redisDrained=!0;this.push(Y[1])})}close(){this._redisDrained=!0}}Tw.default=xw});var pw=E((vw)=>{Object.defineProperty(vw,"__esModule",{value:!0});vw.executeWithAutoPipelining=vw.getFirstValueInFlattenedArray=vw.shouldUseAutoPipelining=vw.notAllowedAutoPipelineCommands=vw.kCallbacks=vw.kExec=void 0;var bw=r9(),Og=o4(),kw=NZ();vw.kExec=Symbol("exec");vw.kCallbacks=Symbol("callbacks");vw.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"];function fw(Z,$){if(Z._runningAutoPipelines.has($))return;if(!Z._autoPipelines.has($))return;Z._runningAutoPipelines.add($);let Y=Z._autoPipelines.get($);Z._autoPipelines.delete($);let X=Y[vw.kCallbacks];Y[vw.kCallbacks]=null,Y.exec(function(W,J){if(Z._runningAutoPipelines.delete($),W)for(let z=0;z<X.length;z++)process.nextTick(X[z],W);else for(let z=0;z<X.length;z++)process.nextTick(X[z],...J[z]);if(Z._autoPipelines.has($))fw(Z,$)})}function Fg(Z,$,Y){return $&&Z.options.enableAutoPipelining&&!Z.isPipeline&&!vw.notAllowedAutoPipelineCommands.includes(Y)&&!Z.options.autoPipeliningIgnoredCommands.includes(Y)}vw.shouldUseAutoPipelining=Fg;function gw(Z){for(let $=0;$<Z.length;$++){let Y=Z[$];if(typeof Y==="string")return Y;else if(Array.isArray(Y)||bw.isArguments(Y)){if(Y.length===0)continue;return Y[0]}let X=[Y].flat();if(X.length>0)return X[0]}return}vw.getFirstValueInFlattenedArray=gw;function yw(Z,$,Y,X,W){if(Z.isCluster&&!Z.slots.length){if(Z.status==="wait")Z.connect().catch(bw.noop);return kw.default(new Promise(function(G,H){Z.delayUntilReady((M)=>{if(M){H(M);return}yw(Z,$,Y,X,null).then(G,H)})}),W)}let J=Z.options.keyPrefix||"",z=Z.isCluster?Z.slots[Og(`${J}${gw(X)}`)].join(","):"main";if(!Z._autoPipelines.has(z)){let G=Z.pipeline();G[vw.kExec]=!1,G[vw.kCallbacks]=[],Z._autoPipelines.set(z,G)}let Q=Z._autoPipelines.get(z);if(!Q[vw.kExec])Q[vw.kExec]=!0,setImmediate(fw,Z,z);let U=new Promise(function(G,H){if(Q[vw.kCallbacks].push(function(M,q){if(M){H(M);return}G(q)}),$==="call")X.unshift(Y);Q[$](...X)});return kw.default(U,W)}vw.executeWithAutoPipelining=yw});var uw=E((cw)=>{Object.defineProperty(cw,"__esModule",{value:!0});var Bg=B1("node:crypto"),Lg=l6(),_g=NZ();class mw{constructor(Z,$=null,Y="",X=!1){this.lua=Z,this.numberOfKeys=$,this.keyPrefix=Y,this.readOnly=X,this.sha=Bg.createHash("sha1").update(Z).digest("hex");let W=this.sha,J=new WeakSet;this.Command=class z extends Lg.default{toWritable(Q){let U=this.reject;if(this.reject=(G)=>{if(G.message.indexOf("NOSCRIPT")!==-1)J.delete(Q);U.call(this,G)},!J.has(Q))J.add(Q),this.name="eval",this.args[0]=Z;else if(this.name==="eval")this.name="evalsha",this.args[0]=W;return super.toWritable(Q)}}}execute(Z,$,Y,X){if(typeof this.numberOfKeys==="number")$.unshift(this.numberOfKeys);if(this.keyPrefix)Y.keyPrefix=this.keyPrefix;if(this.readOnly)Y.readOnly=!0;let W=new this.Command("evalsha",[this.sha,...$],Y);return W.promise=W.promise.catch((J)=>{if(J.message.indexOf("NOSCRIPT")===-1)throw J;let z=new this.Command("evalsha",[this.sha,...$],Y);return(Z.isPipeline?Z.redis:Z).sendCommand(z)}),_g.default(W.promise,X),Z.sendCommand(W)}}cw.default=mw});var zX=E((lw)=>{Object.defineProperty(lw,"__esModule",{value:!0});var Rg=o$(),JX=pw(),Vg=l6(),Eg=uw();class LZ{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return u7.slice(0)}createBuiltinCommand(Z){return{string:BZ(null,Z,"utf8"),buffer:BZ(null,Z,null)}}addBuiltinCommand(Z){this.addedBuiltinSet.add(Z),this[Z]=BZ(Z,Z,"utf8"),this[Z+"Buffer"]=BZ(Z+"Buffer",Z,null)}defineCommand(Z,$){let Y=new Eg.default($.lua,$.numberOfKeys,this.options.keyPrefix,$.readOnly);this.scriptsSet[Z]=Y,this[Z]=iw(Z,Z,Y,"utf8"),this[Z+"Buffer"]=iw(Z+"Buffer",Z,Y,null)}sendCommand(Z,$,Y){throw new Error('"sendCommand" is not implemented')}}var u7=Rg.list.filter((Z)=>Z!=="monitor");u7.push("sentinel");u7.forEach(function(Z){LZ.prototype[Z]=BZ(Z,Z,"utf8"),LZ.prototype[Z+"Buffer"]=BZ(Z+"Buffer",Z,null)});LZ.prototype.call=BZ("call","utf8");LZ.prototype.callBuffer=BZ("callBuffer",null);LZ.prototype.send_command=LZ.prototype.call;function BZ(Z,$,Y){if(typeof Y==="undefined")Y=$,$=null;return function(...X){let W=$||X.shift(),J=X[X.length-1];if(typeof J==="function")X.pop();else J=void 0;let z={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:Y};if(!JX.shouldUseAutoPipelining(this,Z,W))return this.sendCommand(new Vg.default(W,X,z,J));return JX.executeWithAutoPipelining(this,Z,W,X,J)}}function iw(Z,$,Y,X){return function(...W){let J=typeof W[W.length-1]==="function"?W.pop():void 0,z={replyEncoding:X};if(this.options.showFriendlyErrorStack)z.errorStack=new Error;if(!JX.shouldUseAutoPipelining(this,Z,$))return Y.execute(this,W,z,J);return JX.executeWithAutoPipelining(this,Z,$,W,J)}}lw.default=LZ});var l7=E((sw)=>{Object.defineProperty(sw,"__esModule",{value:!0});var i7=o4(),nw=o$(),ow=NZ(),Cg=B1("node:util"),Ig=l6(),Pg=E0(),xg=zX();function Tg(Z,$){let Y=i7($[0]),X=Z._groupsBySlot[Y];for(let W=1;W<$.length;W++)if(Z._groupsBySlot[i7($[W])]!==X)return-1;return Y}class $$ extends xg.default{constructor(Z){super();this.redis=Z,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=Z.options,Object.keys(Z.scriptsSet).forEach((Y)=>{let X=Z.scriptsSet[Y];this._shaToScript[X.sha]=X,this[Y]=Z[Y],this[Y+"Buffer"]=Z[Y+"Buffer"]}),Z.addedBuiltinSet.forEach((Y)=>{this[Y]=Z[Y],this[Y+"Buffer"]=Z[Y+"Buffer"]}),this.promise=new Promise((Y,X)=>{this.resolve=Y,this.reject=X});let $=this;Object.defineProperty(this,"length",{get:function(){return $._queue.length}})}fillResult(Z,$){if(this._queue[$].name==="exec"&&Array.isArray(Z[1])){let X=Z[1].length;for(let W=0;W<X;W++){if(Z[1][W]instanceof Error)continue;let J=this._queue[$-(X-W)];try{Z[1][W]=J.transformReply(Z[1][W])}catch(z){Z[1][W]=z}}}if(this._result[$]=Z,--this.replyPending)return;if(this.isCluster){let X=!0,W;for(let J=0;J<this._result.length;++J){let z=this._result[J][0],Q=this._queue[J];if(z){if(Q.name==="exec"&&z.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!W)W={name:z.name,message:z.message};else if(W.name!==z.name||W.message!==z.message){X=!1;break}}else if(!Q.inTransaction){if(!(nw.exists(Q.name)&&nw.hasFlag(Q.name,"readonly"))){X=!1;break}}}if(W&&X){let J=this,z=W.message.split(" "),Q=this._queue,U=!1;this._queue=[];for(let q=0;q<Q.length;++q){if(z[0]==="ASK"&&!U&&Q[q].name!=="asking"&&(!Q[q-1]||Q[q-1].name!=="asking")){let w=new Ig.default("asking");w.ignore=!0,this.sendCommand(w)}Q[q].initPromise(),this.sendCommand(Q[q]),U=Q[q].inTransaction}let G=!0;if(typeof this.leftRedirections==="undefined")this.leftRedirections={};let H=function(){J.exec()},M=this.redis;if(M.handleError(W,this.leftRedirections,{moved:function(q,w){J.preferKey=w,M.slots[z[1]]=[w],M._groupsBySlot[z[1]]=M._groupsIds[M.slots[z[1]].join(";")],M.refreshSlotsCache(),J.exec()},ask:function(q,w){J.preferKey=w,J.exec()},tryagain:H,clusterDown:H,connectionClosed:H,maxRedirections:()=>{G=!1},defaults:()=>{G=!1}}),G)return}}let Y=0;for(let X=0;X<this._queue.length-Y;++X){if(this._queue[X+Y].ignore)Y+=1;this._result[X]=this._result[X+Y]}this.resolve(this._result.slice(0,this._result.length-Y))}sendCommand(Z){if(this._transactions>0)Z.inTransaction=!0;let $=this._queue.length;return Z.pipelineIndex=$,Z.promise.then((Y)=>{this.fillResult([null,Y],$)}).catch((Y)=>{this.fillResult([Y],$)}),this._queue.push(Z),this}addBatch(Z){let $,Y,X;for(let W=0;W<Z.length;++W)$=Z[W],Y=$[0],X=$.slice(1),this[Y].apply(this,X);return this}}sw.default=$$;var kg=$$.prototype.multi;$$.prototype.multi=function(){return this._transactions+=1,kg.apply(this,arguments)};var tw=$$.prototype.execBuffer;$$.prototype.execBuffer=Cg.deprecate(function(){if(this._transactions>0)this._transactions-=1;return tw.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");$$.prototype.exec=function(Z){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(Pg.noop);if(Z&&!this.nodeifiedPromise)this.nodeifiedPromise=!0,ow.default(this.promise,Z);return this.redis.delayUntilReady((W)=>{if(W){this.reject(W);return}this.exec(Z)}),this.promise}if(this._transactions>0)return this._transactions-=1,tw.apply(this,arguments);if(!this.nodeifiedPromise)this.nodeifiedPromise=!0,ow.default(this.promise,Z);if(!this._queue.length)this.resolve([]);let $;if(this.isCluster){let W=[];for(let J=0;J<this._queue.length;J++){let z=this._queue[J].getKeys();if(z.length)W.push(z[0]);if(z.length&&i7.generateMulti(z)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(W.length){if($=Tg(this.redis,W),$<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else $=Math.random()*16384|0}let Y=this;return X(),this.promise;function X(){let W=Y.replyPending=Y._queue.length,J;if(Y.isCluster)J={slot:$,redis:Y.redis.connectionPool.nodes.all[Y.preferKey]};let z="",Q,U={isPipeline:!0,destination:Y.isCluster?J:{redis:Y.redis},write(G){if(typeof G!=="string"){if(!Q)Q=[];if(z)Q.push(Buffer.from(z,"utf8")),z="";Q.push(G)}else z+=G;if(!--W){if(Q){if(z)Q.push(Buffer.from(z,"utf8"));U.destination.redis.stream.write(Buffer.concat(Q))}else U.destination.redis.stream.write(z);W=Y._queue.length,z="",Q=void 0}}};for(let G=0;G<Y._queue.length;++G)Y.redis.sendCommand(Y._queue[G],U,J);return Y.promise}}});var t7=E((aw)=>{Object.defineProperty(aw,"__esModule",{value:!0});aw.addTransactionSupport=void 0;var n7=E0(),o7=NZ(),rw=l7();function fg(Z){Z.pipeline=function(X){let W=new rw.default(this);if(Array.isArray(X))W.addBatch(X);return W};let{multi:$}=Z;Z.multi=function(X,W){if(typeof W==="undefined"&&!Array.isArray(X))W=X,X=null;if(W&&W.pipeline===!1)return $.call(this);let J=new rw.default(this);if(J.multi(),Array.isArray(X))J.addBatch(X);let z=J.exec;J.exec=function(U){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(n7.noop);return o7.default(new Promise((H,M)=>{this.redis.delayUntilReady((q)=>{if(q){M(q);return}this.exec(J).then(H,M)})}),U)}if(this._transactions>0)z.call(J);if(this.nodeifiedPromise)return z.call(J);let G=z.call(J);return o7.default(G.then(function(H){let M=H[H.length-1];if(typeof M==="undefined")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(M[0]){M[0].previousErrors=[];for(let q=0;q<H.length-1;++q)if(H[q][0])M[0].previousErrors.push(H[q][0]);throw M[0]}return n7.wrapMultiResult(M[1])}),U)};let{execBuffer:Q}=J;return J.execBuffer=function(U){if(this._transactions>0)Q.call(J);return J.exec(U)},J};let{exec:Y}=Z;Z.exec=function(X){return o7.default(Y.call(this).then(function(W){if(Array.isArray(W))W=n7.wrapMultiResult(W);return W}),X)}}aw.addTransactionSupport=fg});var s7=E((ZD)=>{Object.defineProperty(ZD,"__esModule",{value:!0});function gg(Z,$){Object.getOwnPropertyNames($.prototype).forEach((Y)=>{Object.defineProperty(Z.prototype,Y,Object.getOwnPropertyDescriptor($.prototype,Y))})}ZD.default=gg});var WD=E((YD)=>{Object.defineProperty(YD,"__esModule",{value:!0});YD.DEFAULT_CLUSTER_OPTIONS=void 0;var $D=B1("node:dns");YD.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:(Z)=>Math.min(100+Z*2,2000),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1000,useSRVRecords:!1,resolveSrv:$D.resolveSrv,dnsLookup:$D.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}});var a4=E((zD)=>{Object.defineProperty(zD,"__esModule",{value:!0});zD.getConnectionName=zD.weightSrvRecords=zD.groupSrvRecords=zD.getUniqueHostnamesFromOptions=zD.normalizeNodeOptions=zD.nodeKeyToRedisOptions=zD.getNodeKey=void 0;var JD=E0(),vg=B1("node:net");function hg(Z){return Z.port=Z.port||6379,Z.host=Z.host||"127.0.0.1",Z.host+":"+Z.port}zD.getNodeKey=hg;function dg(Z){let $=Z.lastIndexOf(":");if($===-1)throw new Error(`Invalid node key ${Z}`);return{host:Z.slice(0,$),port:Number(Z.slice($+1))}}zD.nodeKeyToRedisOptions=dg;function pg(Z){return Z.map(($)=>{let Y={};if(typeof $==="object")Object.assign(Y,$);else if(typeof $==="string")Object.assign(Y,JD.parseURL($));else if(typeof $==="number")Y.port=$;else throw new Error("Invalid argument "+$);if(typeof Y.port==="string")Y.port=parseInt(Y.port,10);if(delete Y.db,!Y.port)Y.port=6379;if(!Y.host)Y.host="127.0.0.1";return JD.resolveTLSProfile(Y)})}zD.normalizeNodeOptions=pg;function mg(Z){let $={};return Z.forEach((Y)=>{$[Y.host]=!0}),Object.keys($).filter((Y)=>!vg.isIP(Y))}zD.getUniqueHostnamesFromOptions=mg;function cg(Z){let $={};for(let Y of Z)if(!$.hasOwnProperty(Y.priority))$[Y.priority]={totalWeight:Y.weight,records:[Y]};else $[Y.priority].totalWeight+=Y.weight,$[Y.priority].records.push(Y);return $}zD.groupSrvRecords=cg;function ug(Z){if(Z.records.length===1)return Z.totalWeight=0,Z.records.shift();let $=Math.floor(Math.random()*(Z.totalWeight+Z.records.length)),Y=0;for(let[X,W]of Z.records.entries())if(Y+=1+W.weight,Y>$)return Z.totalWeight-=W.weight,Z.records.splice(X,1),W}zD.weightSrvRecords=ug;function ig(Z,$){let Y=`ioredis-cluster(${Z})`;return $?`${Y}:${$}`:Y}zD.getConnectionName=ig});var a7=E((HD)=>{Object.defineProperty(HD,"__esModule",{value:!0});var GD=a4(),r7=E0(),ag=_Z(),n6=r7.Debug("cluster:subscriber");class UD{constructor(Z,$,Y=!1){this.connectionPool=Z,this.emitter=$,this.isSharded=Y,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){n6("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}n6("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(X,W)=>{if(!this.started||!this.subscriber)return;if(GD.getNodeKey(this.subscriber.options)===W)n6("subscriber has left, selecting a new one..."),this.selectSubscriber()}),this.connectionPool.on("+node",()=>{if(!this.started||this.subscriber)return;n6("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber()})}getInstance(){return this.subscriber}associateSlotRange(Z){if(this.isSharded)this.slotRange=Z;return this.slotRange}start(){this.started=!0,this.selectSubscriber(),n6("started")}stop(){if(this.started=!1,this.subscriber)this.subscriber.disconnect(),this.subscriber=null}isStarted(){return this.started}selectSubscriber(){let Z=this.lastActiveSubscriber;if(Z)Z.off("end",this.onSubscriberEnd),Z.disconnect();if(this.subscriber)this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect();let $=r7.sample(this.connectionPool.getNodes());if(!$){n6("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:Y}=$;n6("selected a subscriber %s:%s",Y.host,Y.port);let X="subscriber";if(this.isSharded)X="ssubscriber";this.subscriber=new ag.default({port:Y.port,host:Y.host,username:Y.username,password:Y.password,enableReadyCheck:!0,connectionName:GD.getConnectionName(X,Y.connectionName),lazyConnect:!0,tls:Y.tls,retryStrategy:null}),this.subscriber.on("error",r7.noop),this.subscriber.once("end",this.onSubscriberEnd);let W={subscribe:[],psubscribe:[],ssubscribe:[]};if(Z){let J=Z.condition||Z.prevCondition;if(J&&J.subscriber)W.subscribe=J.subscriber.channels("subscribe"),W.psubscribe=J.subscriber.channels("psubscribe"),W.ssubscribe=J.subscriber.channels("ssubscribe")}if(W.subscribe.length||W.psubscribe.length||W.ssubscribe.length){let J=0;for(let z of["subscribe","psubscribe","ssubscribe"]){let Q=W[z];if(Q.length)J+=1,n6("%s %d channels",z,Q.length),this.subscriber[z](Q).then(()=>{if(!--J)this.lastActiveSubscriber=this.subscriber}).catch(()=>{n6("failed to %s %d channels",z,Q.length)})}}else this.lastActiveSubscriber=this.subscriber;for(let J of["message","messageBuffer"])this.subscriber.on(J,(z,Q)=>{this.emitter.emit(J,z,Q)});for(let J of["pmessage","pmessageBuffer"])this.subscriber.on(J,(z,Q,U)=>{this.emitter.emit(J,z,Q,U)});if(this.isSharded==!0)for(let J of["smessage","smessageBuffer"])this.subscriber.on(J,(z,Q)=>{this.emitter.emit(J,z,Q)})}}HD.default=UD});var ZW=E((wD)=>{Object.defineProperty(wD,"__esModule",{value:!0});var Zy=B1("node:events"),QX=E0(),e7=a4(),$y=_Z(),e4=QX.Debug("cluster:connectionPool");class MD extends Zy.EventEmitter{constructor(Z){super();this.redisOptions=Z,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(Z="all"){let $=this.nodes[Z];return Object.keys($).map((Y)=>$[Y])}getInstanceByKey(Z){return this.nodes.all[Z]}getSampleInstance(Z){let $=Object.keys(this.nodes[Z]),Y=QX.sample($);return this.nodes[Z][Y]}addMasterNode(Z){let $=e7.getNodeKey(Z.options),Y=this.createRedisFromOptions(Z,Z.options.readOnly);if(!Z.options.readOnly)return this.nodes.all[$]=Y,this.nodes.master[$]=Y,!0;return!1}createRedisFromOptions(Z,$){return new $y.default(QX.defaults({retryStrategy:null,enableOfflineQueue:!0,readOnly:$},Z,this.redisOptions,{lazyConnect:!0}))}findOrCreate(Z,$=!1){let Y=e7.getNodeKey(Z);if($=Boolean($),this.specifiedOptions[Y])Object.assign(Z,this.specifiedOptions[Y]);else this.specifiedOptions[Y]=Z;let X;if(this.nodes.all[Y]){if(X=this.nodes.all[Y],X.options.readOnly!==$)if(X.options.readOnly=$,e4("Change role of %s to %s",Y,$?"slave":"master"),X[$?"readonly":"readwrite"]().catch(QX.noop),$)delete this.nodes.master[Y],this.nodes.slave[Y]=X;else delete this.nodes.slave[Y],this.nodes.master[Y]=X}else e4("Connecting to %s as %s",Y,$?"slave":"master"),X=this.createRedisFromOptions(Z,$),this.nodes.all[Y]=X,this.nodes[$?"slave":"master"][Y]=X,X.once("end",()=>{if(this.removeNode(Y),this.emit("-node",X,Y),!Object.keys(this.nodes.all).length)this.emit("drain")}),this.emit("+node",X,Y),X.on("error",function(W){this.emit("nodeError",W,Y)});return X}reset(Z){e4("Reset with %O",Z);let $={};Z.forEach((Y)=>{let X=e7.getNodeKey(Y);if(!(Y.readOnly&&$[X]))$[X]=Y}),Object.keys(this.nodes.all).forEach((Y)=>{if(!$[Y])e4("Disconnect %s because the node does not hold any slot",Y),this.nodes.all[Y].disconnect(),this.removeNode(Y)}),Object.keys($).forEach((Y)=>{let X=$[Y];this.findOrCreate(X,X.readOnly)})}removeNode(Z){let{nodes:$}=this;if($.all[Z])e4("Remove %s from the pool",Z),delete $.all[Z];delete $.master[Z],delete $.slave[Z]}}wD.default=MD});var GX=E((Y81,DD)=>{function Y0(Z,Y){var Y=Y||{};if(this._capacity=Y.capacity,this._head=0,this._tail=0,Array.isArray(Z))this._fromArray(Z);else this._capacityMask=3,this._list=new Array(4)}Y0.prototype.peekAt=function Z($){var Y=$;if(Y!==(Y|0))return;var X=this.size();if(Y>=X||Y<-X)return;if(Y<0)Y+=X;return Y=this._head+Y&this._capacityMask,this._list[Y]};Y0.prototype.get=function Z($){return this.peekAt($)};Y0.prototype.peek=function Z(){if(this._head===this._tail)return;return this._list[this._head]};Y0.prototype.peekFront=function Z(){return this.peek()};Y0.prototype.peekBack=function Z(){return this.peekAt(-1)};Object.defineProperty(Y0.prototype,"length",{get:function Z(){return this.size()}});Y0.prototype.size=function Z(){if(this._head===this._tail)return 0;if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};Y0.prototype.unshift=function Z($){if(arguments.length===0)return this.size();var Y=this._list.length;if(this._head=this._head-1+Y&this._capacityMask,this._list[this._head]=$,this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.pop();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};Y0.prototype.shift=function Z(){var $=this._head;if($===this._tail)return;var Y=this._list[$];if(this._list[$]=void 0,this._head=$+1&this._capacityMask,$<2&&this._tail>1e4&&this._tail<=this._list.length>>>2)this._shrinkArray();return Y};Y0.prototype.push=function Z($){if(arguments.length===0)return this.size();var Y=this._tail;if(this._list[Y]=$,this._tail=Y+1&this._capacityMask,this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.shift();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};Y0.prototype.pop=function Z(){var $=this._tail;if($===this._head)return;var Y=this._list.length;this._tail=$-1+Y&this._capacityMask;var X=this._list[this._tail];if(this._list[this._tail]=void 0,this._head<2&&$>1e4&&$<=Y>>>2)this._shrinkArray();return X};Y0.prototype.removeOne=function Z($){var Y=$;if(Y!==(Y|0))return;if(this._head===this._tail)return;var X=this.size(),W=this._list.length;if(Y>=X||Y<-X)return;if(Y<0)Y+=X;Y=this._head+Y&this._capacityMask;var J=this._list[Y],z;if($<X/2){for(z=$;z>0;z--)this._list[Y]=this._list[Y=Y-1+W&this._capacityMask];this._list[Y]=void 0,this._head=this._head+1+W&this._capacityMask}else{for(z=X-1-$;z>0;z--)this._list[Y]=this._list[Y=Y+1+W&this._capacityMask];this._list[Y]=void 0,this._tail=this._tail-1+W&this._capacityMask}return J};Y0.prototype.remove=function Z($,Y){var X=$,W,J=Y;if(X!==(X|0))return;if(this._head===this._tail)return;var z=this.size(),Q=this._list.length;if(X>=z||X<-z||Y<1)return;if(X<0)X+=z;if(Y===1||!Y)return W=new Array(1),W[0]=this.removeOne(X),W;if(X===0&&X+Y>=z)return W=this.toArray(),this.clear(),W;if(X+Y>z)Y=z-X;var U;W=new Array(Y);for(U=0;U<Y;U++)W[U]=this._list[this._head+X+U&this._capacityMask];if(X=this._head+X&this._capacityMask,$+Y===z){this._tail=this._tail-Y+Q&this._capacityMask;for(U=Y;U>0;U--)this._list[X=X+1+Q&this._capacityMask]=void 0;return W}if($===0){this._head=this._head+Y+Q&this._capacityMask;for(U=Y-1;U>0;U--)this._list[X=X+1+Q&this._capacityMask]=void 0;return W}if(X<z/2){this._head=this._head+$+Y+Q&this._capacityMask;for(U=$;U>0;U--)this.unshift(this._list[X=X-1+Q&this._capacityMask]);X=this._head-1+Q&this._capacityMask;while(J>0)this._list[X=X-1+Q&this._capacityMask]=void 0,J--;if($<0)this._tail=X}else{this._tail=X,X=X+Y+Q&this._capacityMask;for(U=z-(Y+$);U>0;U--)this.push(this._list[X++]);X=this._tail;while(J>0)this._list[X=X+1+Q&this._capacityMask]=void 0,J--}if(this._head<2&&this._tail>1e4&&this._tail<=Q>>>2)this._shrinkArray();return W};Y0.prototype.splice=function Z($,Y){var X=$;if(X!==(X|0))return;var W=this.size();if(X<0)X+=W;if(X>W)return;if(arguments.length>2){var J,z,Q,U=arguments.length,G=this._list.length,H=2;if(!W||X<W/2){z=new Array(X);for(J=0;J<X;J++)z[J]=this._list[this._head+J&this._capacityMask];if(Y===0){if(Q=[],X>0)this._head=this._head+X+G&this._capacityMask}else Q=this.remove(X,Y),this._head=this._head+X+G&this._capacityMask;while(U>H)this.unshift(arguments[--U]);for(J=X;J>0;J--)this.unshift(z[J-1])}else{z=new Array(W-(X+Y));var M=z.length;for(J=0;J<M;J++)z[J]=this._list[this._head+X+Y+J&this._capacityMask];if(Y===0){if(Q=[],X!=W)this._tail=this._head+X+G&this._capacityMask}else Q=this.remove(X,Y),this._tail=this._tail-M+G&this._capacityMask;while(H<U)this.push(arguments[H++]);for(J=0;J<M;J++)this.push(z[J])}return Q}else return this.remove(X,Y)};Y0.prototype.clear=function Z(){this._list=new Array(this._list.length),this._head=0,this._tail=0};Y0.prototype.isEmpty=function Z(){return this._head===this._tail};Y0.prototype.toArray=function Z(){return this._copyArray(!1)};Y0.prototype._fromArray=function Z($){var Y=$.length,X=this._nextPowerOf2(Y);this._list=new Array(X),this._capacityMask=X-1,this._tail=Y;for(var W=0;W<Y;W++)this._list[W]=$[W]};Y0.prototype._copyArray=function Z($,Y){var X=this._list,W=X.length,J=this.length;if(Y=Y|J,Y==J&&this._head<this._tail)return this._list.slice(this._head,this._tail);var z=new Array(Y),Q=0,U;if($||this._head>this._tail){for(U=this._head;U<W;U++)z[Q++]=X[U];for(U=0;U<this._tail;U++)z[Q++]=X[U]}else for(U=this._head;U<this._tail;U++)z[Q++]=X[U];return z};Y0.prototype._growArray=function Z(){if(this._head!=0){var $=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=$}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};Y0.prototype._shrinkArray=function Z(){this._list.length>>>=1,this._capacityMask>>>=1};Y0.prototype._nextPowerOf2=function Z($){var Y=Math.log($)/Math.log(2),X=1<<Y+1;return Math.max(X,4)};DD.exports=Y0});var OD=E((AD)=>{Object.defineProperty(AD,"__esModule",{value:!0});var Xy=E0(),Wy=GX(),Jy=Xy.Debug("delayqueue");class qD{constructor(){this.queues={},this.timeouts={}}push(Z,$,Y){let X=Y.callback||process.nextTick;if(!this.queues[Z])this.queues[Z]=new Wy;if(this.queues[Z].push($),!this.timeouts[Z])this.timeouts[Z]=setTimeout(()=>{X(()=>{this.timeouts[Z]=null,this.execute(Z)})},Y.timeout)}execute(Z){let $=this.queues[Z];if(!$)return;let{length:Y}=$;if(!Y)return;Jy("send %d commands in %s queue",Y,Z),this.queues[Z]=null;while($.length>0)$.shift()()}}AD.default=qD});var LD=E((BD)=>{Object.defineProperty(BD,"__esModule",{value:!0});var Qy=E0(),Gy=a7(),Uy=ZW(),FD=a4(),UX=o4(),SD=Qy.Debug("cluster:subscriberGroup");class ND{constructor(Z){this.cluster=Z,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,Z.on("+node",($)=>{this._addSubscriber($)}),Z.on("-node",($)=>{this._removeSubscriber($)}),Z.on("refresh",()=>{this._refreshSlots(Z)})}getResponsibleSubscriber(Z){let $=this.clusterSlots[Z][0];return this.shardedSubscribers.get($)}addChannels(Z){let $=UX(Z[0]);Z.forEach((X)=>{if(UX(X)!=$)return-1});let Y=this.channels.get($);if(!Y)this.channels.set($,Z);else this.channels.set($,Y.concat(Z));return[...this.channels.values()].flatMap((X)=>X).length}removeChannels(Z){let $=UX(Z[0]);Z.forEach((X)=>{if(UX(X)!=$)return-1});let Y=this.channels.get($);if(Y){let X=Y.filter((W)=>!Z.includes(W));this.channels.set($,X)}return[...this.channels.values()].flatMap((X)=>X).length}stop(){for(let Z of this.shardedSubscribers.values())Z.stop()}start(){for(let Z of this.shardedSubscribers.values())if(!Z.isStarted())Z.start()}_addSubscriber(Z){let $=new Uy.default(Z.options);if($.addMasterNode(Z)){let Y=new Gy.default($,this.cluster,!0),X=FD.getNodeKey(Z.options);return this.shardedSubscribers.set(X,Y),Y.start(),this._resubscribe(),this.cluster.emit("+subscriber"),Y}return null}_removeSubscriber(Z){let $=FD.getNodeKey(Z.options),Y=this.shardedSubscribers.get($);if(Y)Y.stop(),this.shardedSubscribers.delete($),this._resubscribe(),this.cluster.emit("-subscriber");return this.shardedSubscribers}_refreshSlots(Z){if(this._slotsAreEqual(Z.slots))SD("Nothing to refresh because the new cluster map is equal to the previous one.");else{SD("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let $=0;$<Z.slots.length;$++){let Y=Z.slots[$][0];if(!this.subscriberToSlotsIndex.has(Y))this.subscriberToSlotsIndex.set(Y,[]);this.subscriberToSlotsIndex.get(Y).push(Number($))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify(Z.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){if(this.shardedSubscribers)this.shardedSubscribers.forEach((Z,$)=>{let Y=this.subscriberToSlotsIndex.get($);if(Y)Z.associateSlotRange(Y),Y.forEach((X)=>{let W=Z.getInstance(),J=this.channels.get(X);if(J&&J.length>0){if(W)W.ssubscribe(J),W.on("ready",()=>{W.ssubscribe(J)})}})})}_slotsAreEqual(Z){if(this.clusterSlots===void 0)return!1;else return JSON.stringify(this.clusterSlots)===JSON.stringify(Z)}}BD.default=ND});var YW=E((CD)=>{Object.defineProperty(CD,"__esModule",{value:!0});var _D=o$(),jD=B1("node:events"),ZY=aZ(),KD=NZ(),RD=l6(),$W=Pw(),My=_Z(),wy=XX(),Dy=t7(),_8=E0(),qy=s7(),Ay=zX(),Oy=WD(),Fy=a7(),Sy=ZW(),Ny=OD(),r$=a4(),VD=GX(),By=LD(),W0=_8.Debug("cluster"),ED=new WeakSet;class $Y extends Ay.default{constructor(Z,$={}){super();if(this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new Ny.default,this.offlineQueue=new VD,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,jD.EventEmitter.call(this),this.startupNodes=Z,this.options=_8.defaults({},$,Oy.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers==!0)this.shardedSubscribers=new By.default(this);if(this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix)this.options.keyPrefix=this.options.redisOptions.keyPrefix;if(typeof this.options.scaleReads!=="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');if(this.connectionPool=new Sy.default(this.options.redisOptions),this.connectionPool.on("-node",(Y,X)=>{this.emit("-node",Y)}),this.connectionPool.on("+node",(Y)=>{this.emit("+node",Y)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(Y,X)=>{this.emit("node error",Y,X)}),this.subscriber=new Fy.default(this.connectionPool,this),this.options.scripts)Object.entries(this.options.scripts).forEach(([Y,X])=>{this.defineCommand(Y,X)});if(this.options.lazyConnect)this.setStatus("wait");else this.connect().catch((Y)=>{W0("connecting failed: %s",Y)})}connect(){return new Promise((Z,$)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){$(new Error("Redis is already connecting/connected"));return}let Y=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then((X)=>{if(this.connectionEpoch!==Y){W0("discard connecting after resolving startup nodes because epoch not match: %d != %d",Y,this.connectionEpoch),$(new ZY.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){W0("discard connecting after resolving startup nodes because the status changed to %s",this.status),$(new ZY.RedisError("Connection is aborted"));return}this.connectionPool.reset(X);let W=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),Z()},J=void 0,z=()=>{if(this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",J),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck)this.readyCheck((Q,U)=>{if(Q||U){if(W0("Ready check failed (%s). Reconnecting...",Q||U),this.status==="connect")this.disconnect(!0)}else W()});else W()};if(J=()=>{let Q=new Error("None of startup nodes is available");this.removeListener("refresh",z),this.invokeReadyDelayedCallbacks(Q),$(Q)},this.once("refresh",z),this.once("close",J),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache((Q)=>{if(Q&&Q.message===$W.default.defaultMessage)My.default.prototype.silentEmit.call(this,"error",Q),this.connectionPool.reset([])}),this.subscriber.start(),this.options.shardedSubscribers)this.shardedSubscribers.start()}).catch((X)=>{this.setStatus("close"),this.handleCloseEvent(X),this.invokeReadyDelayedCallbacks(X),$(X)})})}disconnect(Z=!1){let $=this.status;if(this.setStatus("disconnecting"),!Z)this.manuallyClosing=!0;if(this.reconnectTimeout&&!Z)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,W0("Canceled reconnecting attempts");if(this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers)this.shardedSubscribers.stop();if($==="wait")this.setStatus("close"),this.handleCloseEvent();else this.connectionPool.reset([])}quit(Z){let $=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null;if(this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers)this.shardedSubscribers.stop();if($==="wait"){let Y=KD.default(Promise.resolve("OK"),Z);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),Y}return KD.default(Promise.all(this.nodes().map((Y)=>Y.quit().catch((X)=>{if(X.message===_8.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw X}))).then(()=>"OK"),Z)}duplicate(Z=[],$={}){let Y=Z.length>0?Z:this.startupNodes.slice(0),X=Object.assign({},this.options,$);return new $Y(Y,X)}nodes(Z="all"){if(Z!=="all"&&Z!=="master"&&Z!=="slave")throw new Error('Invalid role "'+Z+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(Z)}delayUntilReady(Z){this._readyDelayedCallbacks.push(Z)}get autoPipelineQueueSize(){let Z=0;for(let $ of this._autoPipelines.values())Z+=$.length;return Z}refreshSlotsCache(Z){if(Z)this._refreshSlotsCacheCallbacks.push(Z);if(this.isRefreshing)return;this.isRefreshing=!0;let $=this,Y=(z)=>{this.isRefreshing=!1;for(let Q of this._refreshSlotsCacheCallbacks)Q(z);this._refreshSlotsCacheCallbacks=[]},X=_8.shuffle(this.connectionPool.getNodes()),W=null;function J(z){if(z===X.length){let G=new $W.default($W.default.defaultMessage,W);return Y(G)}let Q=X[z],U=`${Q.options.host}:${Q.options.port}`;W0("getting slot cache from %s",U),$.getInfoFromNode(Q,function(G){switch($.status){case"close":case"end":return Y(new Error("Cluster is disconnected."));case"disconnecting":return Y(new Error("Cluster is disconnecting."))}if(G)$.emit("node error",G,U),W=G,J(z+1);else $.emit("refresh"),Y()})}J(0)}sendCommand(Z,$,Y){if(this.status==="wait")this.connect().catch(_8.noop);if(this.status==="end")return Z.reject(new Error(_8.CONNECTION_CLOSED_ERROR_MSG)),Z.promise;let X=this.options.scaleReads;if(X!=="master"){if(!(Z.isReadOnly||_D.exists(Z.name)&&_D.hasFlag(Z.name,"readonly")))X="master"}let W=Y?Y.slot:Z.getSlot(),J={},z=this;if(!Y&&!ED.has(Z)){ED.add(Z);let U=Z.reject;Z.reject=function(G){let H=Q.bind(null,!0);z.handleError(G,J,{moved:function(M,q){if(W0("command %s is moved to %s",Z.name,q),W=Number(M),z.slots[M])z.slots[M][0]=q;else z.slots[M]=[q];z._groupsBySlot[M]=z._groupsIds[z.slots[M].join(";")],z.connectionPool.findOrCreate(z.natMapper(q)),Q(),W0("refreshing slot caches... (triggered by MOVED error)"),z.refreshSlotsCache()},ask:function(M,q){W0("command %s is required to ask %s:%s",Z.name,q);let w=z.natMapper(q);z.connectionPool.findOrCreate(w),Q(!1,`${w.host}:${w.port}`)},tryagain:H,clusterDown:H,connectionClosed:H,maxRedirections:function(M){U.call(Z,M)},defaults:function(){U.call(Z,G)}})}}Q();function Q(U,G){if(z.status==="end"){Z.reject(new ZY.AbortError("Cluster is ended."));return}let H;if(z.status==="ready"||Z.name==="cluster"){if(Y&&Y.redis)H=Y.redis;else if(RD.default.checkFlag("ENTER_SUBSCRIBER_MODE",Z.name)||RD.default.checkFlag("EXIT_SUBSCRIBER_MODE",Z.name)){if(z.options.shardedSubscribers==!0&&(Z.name=="ssubscribe"||Z.name=="sunsubscribe")){let M=z.shardedSubscribers.getResponsibleSubscriber(W),q=-1;if(Z.name=="ssubscribe")q=z.shardedSubscribers.addChannels(Z.getKeys());if(Z.name=="sunsubscribe")q=z.shardedSubscribers.removeChannels(Z.getKeys());if(q!==-1)H=M.getInstance();else Z.reject(new ZY.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else H=z.subscriber.getInstance();if(!H){Z.reject(new ZY.AbortError("No subscriber for the cluster"));return}}else{if(!U){if(typeof W==="number"&&z.slots[W]){let M=z.slots[W];if(typeof X==="function"){let q=M.map(function(w){return z.connectionPool.getInstanceByKey(w)});if(H=X(q,Z),Array.isArray(H))H=_8.sample(H);if(!H)H=q[0]}else{let q;if(X==="all")q=_8.sample(M);else if(X==="slave"&&M.length>1)q=_8.sample(M,1);else q=M[0];H=z.connectionPool.getInstanceByKey(q)}}if(G)H=z.connectionPool.getInstanceByKey(G),H.asking()}if(!H)H=(typeof X==="function"?null:z.connectionPool.getSampleInstance(X))||z.connectionPool.getSampleInstance("all")}if(Y&&!Y.redis)Y.redis=H}if(H)H.sendCommand(Z,$);else if(z.options.enableOfflineQueue)z.offlineQueue.push({command:Z,stream:$,node:Y});else Z.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return Z.promise}sscanStream(Z,$){return this.createScanStream("sscan",{key:Z,options:$})}sscanBufferStream(Z,$){return this.createScanStream("sscanBuffer",{key:Z,options:$})}hscanStream(Z,$){return this.createScanStream("hscan",{key:Z,options:$})}hscanBufferStream(Z,$){return this.createScanStream("hscanBuffer",{key:Z,options:$})}zscanStream(Z,$){return this.createScanStream("zscan",{key:Z,options:$})}zscanBufferStream(Z,$){return this.createScanStream("zscanBuffer",{key:Z,options:$})}handleError(Z,$,Y){if(typeof $.value==="undefined")$.value=this.options.maxRedirections;else $.value-=1;if($.value<=0){Y.maxRedirections(new Error("Too many Cluster redirections. Last error: "+Z));return}let X=Z.message.split(" ");if(X[0]==="MOVED"){let W=this.options.retryDelayOnMoved;if(W&&typeof W==="number")this.delayQueue.push("moved",Y.moved.bind(null,X[1],X[2]),{timeout:W});else Y.moved(X[1],X[2])}else if(X[0]==="ASK")Y.ask(X[1],X[2]);else if(X[0]==="TRYAGAIN")this.delayQueue.push("tryagain",Y.tryagain,{timeout:this.options.retryDelayOnTryAgain});else if(X[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0)this.delayQueue.push("clusterdown",Y.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)});else if(Z.message===_8.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready")this.delayQueue.push("failover",Y.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)});else Y.defaults()}resetOfflineQueue(){this.offlineQueue=new VD}clearNodesRefreshInterval(){if(this.slotsTimer)clearTimeout(this.slotsTimer),this.slotsTimer=null}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let Z=()=>{this.slotsTimer=setTimeout(()=>{W0('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{Z()})},this.options.slotsRefreshInterval)};Z()}setStatus(Z){W0("status: %s -> %s",this.status||"[empty]",Z),this.status=Z,process.nextTick(()=>{this.emit(Z)})}handleCloseEvent(Z){if(Z)W0("closed because %s",Z);let $;if(!this.manuallyClosing&&typeof this.options.clusterRetryStrategy==="function")$=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,Z);if(typeof $==="number")this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,W0("Cluster is disconnected. Retrying after %dms",$),this.connect().catch(function(Y){W0("Got error %s when reconnecting. Ignoring...",Y)})},$);else this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available"))}flushQueue(Z){let $;while($=this.offlineQueue.shift())$.command.reject(Z)}executeOfflineCommands(){if(this.offlineQueue.length){W0("send %d commands in offline queue",this.offlineQueue.length);let Z=this.offlineQueue;this.resetOfflineQueue();let $;while($=Z.shift())this.sendCommand($.command,$.stream,$.node)}}natMapper(Z){let $=typeof Z==="string"?Z:`${Z.host}:${Z.port}`,Y=null;if(this.options.natMap&&typeof this.options.natMap==="function")Y=this.options.natMap($);else if(this.options.natMap&&typeof this.options.natMap==="object")Y=this.options.natMap[$];if(Y)return W0("NAT mapping %s -> %O",$,Y),Object.assign({},Y);return typeof Z==="string"?r$.nodeKeyToRedisOptions(Z):Z}getInfoFromNode(Z,$){if(!Z)return $(new Error("Node is disconnected"));let Y=Z.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:r$.getConnectionName("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});Y.on("error",_8.noop),Y.cluster("SLOTS",_8.timeout((X,W)=>{if(Y.disconnect(),X)return $(X);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){W0("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",W.length,this.status),$();return}let J=[];W0("cluster slots result count: %d",W.length);for(let Q=0;Q<W.length;++Q){let U=W[Q],G=U[0],H=U[1],M=[];for(let q=2;q<U.length;q++){if(!U[q][0])continue;let w=this.natMapper({host:U[q][0],port:U[q][1]});w.readOnly=q!==2,J.push(w),M.push(w.host+":"+w.port)}W0("cluster slots result [%d]: slots %d~%d served by %s",Q,G,H,M);for(let q=G;q<=H;q++)this.slots[q]=M}this._groupsIds=Object.create(null);let z=0;for(let Q=0;Q<16384;Q++){let U=(this.slots[Q]||[]).join(";");if(!U.length){this._groupsBySlot[Q]=void 0;continue}if(!this._groupsIds[U])this._groupsIds[U]=++z;this._groupsBySlot[Q]=this._groupsIds[U]}this.connectionPool.reset(J),$()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(Z){for(let $ of this._readyDelayedCallbacks)process.nextTick($,Z);this._readyDelayedCallbacks=[]}readyCheck(Z){this.cluster("INFO",($,Y)=>{if($)return Z($);if(typeof Y!=="string")return Z();let X,W=Y.split(`\r
`);for(let J=0;J<W.length;++J){let z=W[J].split(":");if(z[0]==="cluster_state"){X=z[1];break}}if(X==="fail")W0("cluster state not ok (%s)",X),Z(null,X);else Z()})}resolveSrv(Z){return new Promise(($,Y)=>{this.options.resolveSrv(Z,(X,W)=>{if(X)return Y(X);let J=this,z=r$.groupSrvRecords(W),Q=Object.keys(z).sort((G,H)=>parseInt(G)-parseInt(H));function U(G){if(!Q.length)return Y(G);let H=Q[0],M=z[H],q=r$.weightSrvRecords(M);if(!M.records.length)Q.shift();J.dnsLookup(q.name).then((w)=>$({host:w,port:q.port}),U)}U()})})}dnsLookup(Z){return new Promise(($,Y)=>{this.options.dnsLookup(Z,(X,W)=>{if(X)W0("failed to resolve hostname %s to IP: %s",Z,X.message),Y(X);else W0("resolved hostname %s to IP %s",Z,W),$(W)})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let Z=r$.normalizeNodeOptions(this.startupNodes),$=r$.getUniqueHostnamesFromOptions(Z);if($.length===0)return Z;let Y=await Promise.all($.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),X=_8.zipMap($,Y);return Z.map((W)=>{let J=X.get(W.host);if(!J)return W;if(this.options.useSRVRecords)return Object.assign({},W,J);return Object.assign({},W,{host:J})})}createScanStream(Z,{key:$,options:Y={}}){return new wy.default({objectMode:!0,key:$,redis:this,command:Z,...Y})}}qy.default($Y,jD.EventEmitter);Dy.addTransactionSupport($Y.prototype);CD.default=$Y});var HX=E((PD)=>{Object.defineProperty(PD,"__esModule",{value:!0});var _y=E0(),Ky=_y.Debug("AbstractConnector");class ID{constructor(Z){this.connecting=!1,this.disconnectTimeout=Z}check(Z){return!0}disconnect(){if(this.connecting=!1,this.stream){let Z=this.stream,$=setTimeout(()=>{Ky("stream %s:%s still open, destroying it",Z.remoteAddress,Z.remotePort),Z.destroy()},this.disconnectTimeout);Z.on("close",()=>clearTimeout($)),Z.end()}}}PD.default=ID});var kD=E((TD)=>{Object.defineProperty(TD,"__esModule",{value:!0});var Vy=B1("node:net"),Ey=B1("node:tls"),jy=E0(),Cy=HX();class xD extends Cy.default{constructor(Z){super(Z.disconnectTimeout);this.options=Z}connect(Z){let{options:$}=this;this.connecting=!0;let Y;if("path"in $&&$.path)Y={path:$.path};else{if(Y={},"port"in $&&$.port!=null)Y.port=$.port;if("host"in $&&$.host!=null)Y.host=$.host;if("family"in $&&$.family!=null)Y.family=$.family}if($.tls)Object.assign(Y,$.tls);return new Promise((X,W)=>{process.nextTick(()=>{if(!this.connecting){W(new Error(jy.CONNECTION_CLOSED_ERROR_MSG));return}try{if($.tls)this.stream=Ey.connect(Y);else this.stream=Vy.createConnection(Y)}catch(J){W(J);return}this.stream.once("error",(J)=>{this.firstError=J}),X(this.stream)})})}}TD.default=xD});var gD=E((fD)=>{Object.defineProperty(fD,"__esModule",{value:!0});function Py(Z,$){return(Z.host||"127.0.0.1")===($.host||"127.0.0.1")&&(Z.port||26379)===($.port||26379)}class bD{constructor(Z){this.cursor=0,this.sentinels=Z.slice(0)}next(){let Z=this.cursor>=this.sentinels.length;return{done:Z,value:Z?void 0:this.sentinels[this.cursor++]}}reset(Z){if(Z&&this.sentinels.length>1&&this.cursor!==1)this.sentinels.unshift(...this.sentinels.splice(this.cursor-1));this.cursor=0}add(Z){for(let $=0;$<this.sentinels.length;$++)if(Py(Z,this.sentinels[$]))return!1;return this.sentinels.push(Z),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}fD.default=bD});var pD=E((hD)=>{Object.defineProperty(hD,"__esModule",{value:!0});hD.FailoverDetector=void 0;var Ty=E0(),XW=Ty.Debug("FailoverDetector"),yD="+switch-master";class vD{constructor(Z,$){this.isDisconnected=!1,this.connector=Z,this.sentinels=$}cleanup(){this.isDisconnected=!0;for(let Z of this.sentinels)Z.client.disconnect()}async subscribe(){XW("Starting FailoverDetector");let Z=[];for(let $ of this.sentinels){let Y=$.client.subscribe(yD).catch((X)=>{XW("Failed to subscribe to failover messages on sentinel %s:%s (%s)",$.address.host||"127.0.0.1",$.address.port||26739,X.message)});Z.push(Y),$.client.on("message",(X)=>{if(!this.isDisconnected&&X===yD)this.disconnect()})}await Promise.all(Z)}disconnect(){this.isDisconnected=!0,XW("Failover detected, disconnecting"),this.connector.disconnect()}}hD.FailoverDetector=vD});var MX=E((iD)=>{Object.defineProperty(iD,"__esModule",{value:!0});iD.SentinelIterator=void 0;var ky=B1("node:net"),YY=E0(),by=B1("node:tls"),mD=gD();iD.SentinelIterator=mD.default;var fy=HX(),gy=_Z(),yy=pD(),a$=YY.Debug("SentinelConnector");class cD extends fy.default{constructor(Z){super(Z.disconnectTimeout);if(this.options=Z,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new mD.default(this.options.sentinels)}check(Z){let $=!Z.role||this.options.role===Z.role;if(!$)a$("role invalid, expected %s, but got %s",this.options.role,Z.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0);return $}disconnect(){if(super.disconnect(),this.failoverDetector)this.failoverDetector.cleanup()}connect(Z){this.connecting=!0,this.retryAttempts=0;let $,Y=async()=>{let X=this.sentinelIterator.next();if(X.done){this.sentinelIterator.reset(!1);let Q=typeof this.options.sentinelRetryStrategy==="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,U=typeof Q!=="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${Q}ms.`;if($)U+=` Last error: ${$.message}`;a$(U);let G=new Error(U);if(typeof Q==="number")return Z("error",G),await new Promise((H)=>setTimeout(H,Q)),Y();else throw G}let W=null,J=null;try{W=await this.resolve(X.value)}catch(Q){J=Q}if(!this.connecting)throw new Error(YY.CONNECTION_CLOSED_ERROR_MSG);let z=X.value.host+":"+X.value.port;if(W){if(a$("resolved: %s:%s from sentinel %s",W.host,W.port,z),this.options.enableTLSForSentinelMode&&this.options.tls)Object.assign(W,this.options.tls),this.stream=by.connect(W),this.stream.once("secureConnect",this.initFailoverDetector.bind(this));else this.stream=ky.createConnection(W),this.stream.once("connect",this.initFailoverDetector.bind(this));return this.stream.once("error",(Q)=>{this.firstError=Q}),this.stream}else{let Q=J?"failed to connect to sentinel "+z+" because "+J.message:"connected to sentinel "+z+" successfully, but got an invalid reply: "+W;if(a$(Q),Z("sentinelError",new Error(Q)),J)$=J;return Y()}};return Y()}async updateSentinels(Z){if(!this.options.updateSentinels)return;let $=await Z.sentinel("sentinels",this.options.name);if(!Array.isArray($))return;$.map(YY.packObject).forEach((Y)=>{if((Y.flags?Y.flags.split(","):[]).indexOf("disconnected")===-1&&Y.ip&&Y.port){let W=this.sentinelNatResolve(uD(Y));if(this.sentinelIterator.add(W))a$("adding sentinel %s:%s",W.host,W.port)}}),a$("Updated internal sentinels: %s",this.sentinelIterator)}async resolveMaster(Z){let $=await Z.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(Z),this.sentinelNatResolve(Array.isArray($)?{host:$[0],port:Number($[1])}:null)}async resolveSlave(Z){let $=await Z.sentinel("slaves",this.options.name);if(!Array.isArray($))return null;let Y=$.map(YY.packObject).filter((X)=>X.flags&&!X.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(vy(Y,this.options.preferredSlaves))}sentinelNatResolve(Z){if(!Z||!this.options.natMap)return Z;let $=`${Z.host}:${Z.port}`,Y=Z;if(typeof this.options.natMap==="function")Y=this.options.natMap($)||Z;else if(typeof this.options.natMap==="object")Y=this.options.natMap[$]||Z;return Y}connectToSentinel(Z,$){return new gy.default({port:Z.port||26379,host:Z.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:Z.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...$})}async resolve(Z){let $=this.connectToSentinel(Z);$.on("error",hy);try{if(this.options.role==="slave")return await this.resolveSlave($);else return await this.resolveMaster($)}finally{$.disconnect()}}async initFailoverDetector(){var Z;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let $=[];while($.length<this.options.sentinelMaxConnections){let{done:Y,value:X}=this.sentinelIterator.next();if(Y)break;let W=this.connectToSentinel(X,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});W.on("reconnecting",()=>{var J;(J=this.emitter)===null||J===void 0||J.emit("sentinelReconnecting")}),$.push({address:X,client:W})}if(this.sentinelIterator.reset(!1),this.failoverDetector)this.failoverDetector.cleanup();this.failoverDetector=new yy.FailoverDetector(this,$),await this.failoverDetector.subscribe(),(Z=this.emitter)===null||Z===void 0||Z.emit("failoverSubscribed")}}iD.default=cD;function vy(Z,$){if(Z.length===0)return null;let Y;if(typeof $==="function")Y=$(Z);else if($!==null&&typeof $==="object"){let X=Array.isArray($)?$:[$];X.sort((W,J)=>{if(!W.prio)W.prio=1;if(!J.prio)J.prio=1;if(W.prio<J.prio)return-1;if(W.prio>J.prio)return 1;return 0});for(let W=0;W<X.length;W++){for(let J=0;J<Z.length;J++){let z=Z[J];if(z.ip===X[W].ip){if(z.port===X[W].port){Y=z;break}}}if(Y)break}}if(!Y)Y=YY.sample(Z);return uD(Y)}function uD(Z){return{host:Z.ip,port:Number(Z.port)}}function hy(){}});var tD=E((nD)=>{Object.defineProperty(nD,"__esModule",{value:!0});nD.SentinelConnector=nD.StandaloneConnector=void 0;var py=kD();nD.StandaloneConnector=py.default;var my=MX();nD.SentinelConnector=my.default});var aD=E((rD)=>{Object.defineProperty(rD,"__esModule",{value:!0});var uy=aZ();class sD extends uy.AbortError{constructor(Z){let $=`Reached the max retries per request limit (which is ${Z}). Refer to "maxRetriesPerRequest" option for details.`;super($);Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}rD.default=sD});var $q=E((eD)=>{Object.defineProperty(eD,"__esModule",{value:!0});eD.MaxRetriesPerRequestError=void 0;var ly=aD();eD.MaxRetriesPerRequestError=ly.default});var Uq=E((q81,Gq)=>{var GW=B1("node:buffer").Buffer,ny=B1("node:string_decoder").StringDecoder,WW=new ny,Yq=aZ(),oy=Yq.ReplyError,ty=Yq.ParserError,w6=GW.allocUnsafe(32768),m0=0,wX=null,XY=0,JW=0;function sy(Z){let $=Z.buffer.length-1;var Y=Z.offset,X=0,W=1;if(Z.buffer[Y]===45)W=-1,Y++;while(Y<$){let J=Z.buffer[Y++];if(J===13)return Z.offset=Y+1,W*X;X=X*10+(J-48)}}function ry(Z){let $=Z.buffer.length-1;var Y=Z.offset,X=0,W="";if(Z.buffer[Y]===45)W+="-",Y++;while(Y<$){var J=Z.buffer[Y++];if(J===13){if(Z.offset=Y+1,X!==0)W+=X;return W}else if(X>429496728)W+=X*10+(J-48),X=0;else if(J===48&&X===0)W+=0;else X=X*10+(J-48)}}function Xq(Z){let{offset:$,buffer:Y}=Z,X=Y.length-1;var W=$;while(W<X)if(Y[W++]===13){if(Z.offset=W+1,Z.optionReturnBuffers===!0)return Z.buffer.slice($,W-1);return Z.buffer.toString("utf8",$,W-1)}}function Wq(Z){let $=Z.buffer.length-1;var Y=Z.offset,X=0;while(Y<$){let W=Z.buffer[Y++];if(W===13)return Z.offset=Y+1,X;X=X*10+(W-48)}}function ay(Z){if(Z.optionStringNumbers===!0)return ry(Z);return sy(Z)}function ey(Z){let $=Wq(Z);if($===void 0)return;if($<0)return null;let Y=Z.offset+$;if(Y+2>Z.buffer.length){Z.bigStrSize=Y+2,Z.totalChunkSize=Z.buffer.length,Z.bufferCache.push(Z.buffer);return}let X=Z.offset;if(Z.offset=Y+2,Z.optionReturnBuffers===!0)return Z.buffer.slice(X,Y);return Z.buffer.toString("utf8",X,Y)}function Zv(Z){var $=Xq(Z);if($!==void 0){if(Z.optionReturnBuffers===!0)$=$.toString();return new oy($)}}function $v(Z,$){let Y=new ty("Protocol error, got "+JSON.stringify(String.fromCharCode($))+" as reply type byte",JSON.stringify(Z.buffer),Z.offset);Z.buffer=null,Z.returnFatalError(Y)}function Yv(Z){let $=Wq(Z);if($===void 0)return;if($<0)return null;let Y=new Array($);return Jq(Z,Y,0)}function zW(Z,$,Y){Z.arrayCache.push($),Z.arrayPos.push(Y)}function QW(Z){let $=Z.arrayCache.pop();var Y=Z.arrayPos.pop();if(Z.arrayCache.length){let X=QW(Z);if(X===void 0){zW(Z,$,Y);return}$[Y++]=X}return Jq(Z,$,Y)}function Jq(Z,$,Y){let X=Z.buffer.length;while(Y<$.length){let W=Z.offset;if(Z.offset>=X){zW(Z,$,Y);return}let J=zq(Z,Z.buffer[Z.offset++]);if(J===void 0){if(!(Z.arrayCache.length||Z.bufferCache.length))Z.offset=W;zW(Z,$,Y);return}$[Y]=J,Y++}return $}function zq(Z,$){switch($){case 36:return ey(Z);case 43:return Xq(Z);case 42:return Yv(Z);case 58:return ay(Z);case 45:return Zv(Z);default:return $v(Z,$)}}function Xv(){if(w6.length>51200)if(XY===1||JW>XY*2){let Z=Math.floor(w6.length/10),$=Z<m0?m0:Z;m0=0,w6=w6.slice($,w6.length)}else JW++,XY--;else clearInterval(wX),XY=0,JW=0,wX=null}function Wv(Z){if(w6.length<Z+m0){let $=Z>78643200?2:3;if(m0>116391936)m0=52428800;if(w6=GW.allocUnsafe(Z*$+m0),m0=0,XY++,wX===null)wX=setInterval(Xv,50)}}function Jv(Z){let{bufferCache:$,offset:Y}=Z;var X=$.length,W=Z.bigStrSize-Z.totalChunkSize;if(Z.offset=W,W<=2){if(X===2)return $[0].toString("utf8",Y,$[0].length+W-2);X--,W=$[$.length-2].length+W}var J=WW.write($[0].slice(Y));for(var z=1;z<X-1;z++)J+=WW.write($[z]);return J+=WW.end($[z].slice(0,W-2)),J}function zv(Z){let{bufferCache:$,offset:Y}=Z,X=Z.bigStrSize-Y-2;var W=$.length,J=Z.bigStrSize-Z.totalChunkSize;if(Z.offset=J,J<=2){if(W===2)return $[0].slice(Y,$[0].length+J-2);W--,J=$[$.length-2].length+J}Wv(X);let z=m0;$[0].copy(w6,z,Y,$[0].length),m0+=$[0].length-Y;for(var Q=1;Q<W-1;Q++)$[Q].copy(w6,m0),m0+=$[Q].length;return $[Q].copy(w6,m0,0,J-2),m0+=J-2,w6.slice(z,m0)}class Qq{constructor(Z){if(!Z)throw new TypeError("Options are mandatory.");if(typeof Z.returnError!=="function"||typeof Z.returnReply!=="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!Z.returnBuffers),this.setStringNumbers(!!Z.stringNumbers),this.returnError=Z.returnError,this.returnFatalError=Z.returnFatalError||Z.returnError,this.returnReply=Z.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(Z){if(typeof Z!=="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=Z}setStringNumbers(Z){if(typeof Z!=="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=Z}execute(Z){if(this.buffer===null)this.buffer=Z,this.offset=0;else if(this.bigStrSize===0){let Y=this.buffer.length,X=Y-this.offset,W=GW.allocUnsafe(X+Z.length);if(this.buffer.copy(W,0,this.offset,Y),Z.copy(W,X,0,Z.length),this.buffer=W,this.offset=0,this.arrayCache.length){let J=QW(this);if(J===void 0)return;this.returnReply(J)}}else if(this.totalChunkSize+Z.length>=this.bigStrSize){this.bufferCache.push(Z);var $=this.optionReturnBuffers?zv(this):Jv(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=Z,this.arrayCache.length){if(this.arrayCache[0][this.arrayPos[0]++]=$,$=QW(this),$===void 0)return}this.returnReply($)}else{this.bufferCache.push(Z),this.totalChunkSize+=Z.length;return}while(this.offset<this.buffer.length){let Y=this.offset,X=this.buffer[this.offset++],W=zq(this,X);if(W===void 0){if(!(this.arrayCache.length||this.bufferCache.length))this.offset=Y;return}if(X===45)this.returnError(W);else this.returnReply(W)}this.buffer=null}}Gq.exports=Qq});var wq=E((Mq)=>{Object.defineProperty(Mq,"__esModule",{value:!0});class Hq{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(Z,$){this.set[UW(Z)][$]=!0}del(Z,$){delete this.set[UW(Z)][$]}channels(Z){return Object.keys(this.set[UW(Z)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}}Mq.default=Hq;function UW(Z){if(Z==="unsubscribe")return"subscribe";if(Z==="punsubscribe")return"psubscribe";if(Z==="sunsubscribe")return"ssubscribe";return Z}});var Sq=E((Fq)=>{Object.defineProperty(Fq,"__esModule",{value:!0});var Dq=l6(),Gv=E0(),Uv=Uq(),Hv=wq(),Mv=Gv.Debug("dataHandler");class Oq{constructor(Z,$){this.redis=Z;let Y=new Uv({stringNumbers:$.stringNumbers,returnBuffers:!0,returnError:(X)=>{this.returnError(X)},returnFatalError:(X)=>{this.returnFatalError(X)},returnReply:(X)=>{this.returnReply(X)}});Z.stream.prependListener("data",(X)=>{Y.execute(X)}),Z.stream.resume()}returnFatalError(Z){Z.message+=". Please report this.",this.redis.recoverFromFatalError(Z,Z,{offlineQueue:!1})}returnError(Z){let $=this.shiftCommand(Z);if(!$)return;Z.command={name:$.command.name,args:$.command.args},this.redis.handleReconnection(Z,$)}returnReply(Z){if(this.handleMonitorReply(Z))return;if(this.handleSubscriberReply(Z))return;let $=this.shiftCommand(Z);if(!$)return;if(Dq.default.checkFlag("ENTER_SUBSCRIBER_MODE",$.command.name)){if(this.redis.condition.subscriber=new Hv.default,this.redis.condition.subscriber.add($.command.name,Z[1].toString()),!qq($.command,Z[2]))this.redis.commandQueue.unshift($)}else if(Dq.default.checkFlag("EXIT_SUBSCRIBER_MODE",$.command.name)){if(!Aq($.command,Z[2]))this.redis.commandQueue.unshift($)}else $.command.resolve(Z)}handleSubscriberReply(Z){if(!this.redis.condition.subscriber)return!1;let $=Array.isArray(Z)?Z[0].toString():null;switch(Mv('receive reply "%s" in subscriber mode',$),$){case"message":if(this.redis.listeners("message").length>0)this.redis.emit("message",Z[1].toString(),Z[2]?Z[2].toString():"");this.redis.emit("messageBuffer",Z[1],Z[2]);break;case"pmessage":{let Y=Z[1].toString();if(this.redis.listeners("pmessage").length>0)this.redis.emit("pmessage",Y,Z[2].toString(),Z[3].toString());this.redis.emit("pmessageBuffer",Y,Z[2],Z[3]);break}case"smessage":{if(this.redis.listeners("smessage").length>0)this.redis.emit("smessage",Z[1].toString(),Z[2]?Z[2].toString():"");this.redis.emit("smessageBuffer",Z[1],Z[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let Y=Z[1].toString();this.redis.condition.subscriber.add($,Y);let X=this.shiftCommand(Z);if(!X)return;if(!qq(X.command,Z[2]))this.redis.commandQueue.unshift(X);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let Y=Z[1]?Z[1].toString():null;if(Y)this.redis.condition.subscriber.del($,Y);let X=Z[2];if(Number(X)===0)this.redis.condition.subscriber=!1;let W=this.shiftCommand(Z);if(!W)return;if(!Aq(W.command,X))this.redis.commandQueue.unshift(W);break}default:{let Y=this.shiftCommand(Z);if(!Y)return;Y.command.resolve(Z)}}return!0}handleMonitorReply(Z){if(this.redis.status!=="monitoring")return!1;let $=Z.toString();if($==="OK")return!1;let Y=$.indexOf(" "),X=$.slice(0,Y),W=$.indexOf('"'),J=$.slice(W+1,-1).split('" "').map((Q)=>Q.replace(/\\"/g,'"')),z=$.slice(Y+2,W-2).split(" ");return this.redis.emit("monitor",X,J,z[1],z[0]),!0}shiftCommand(Z){let $=this.redis.commandQueue.shift();if(!$){let X=new Error("Command queue state error. If you can reproduce this, please report it."+(Z instanceof Error?` Last error: ${Z.message}`:` Last reply: ${Z.toString()}`));return this.redis.emit("error",X),null}return $}}Fq.default=Oq;var KZ=new WeakMap;function qq(Z,$){let Y=KZ.has(Z)?KZ.get(Z):Z.args.length;if(Y-=1,Y<=0)return Z.resolve($),KZ.delete(Z),!0;return KZ.set(Z,Y),!1}function Aq(Z,$){let Y=KZ.has(Z)?KZ.get(Z):Z.args.length;if(Y===0){if(Number($)===0)return KZ.delete(Z),Z.resolve($),!0;return!1}if(Y-=1,Y<=0)return Z.resolve($),!0;return KZ.set(Z,Y),!1}});var Bq=E((Nq)=>{Object.defineProperty(Nq,"__esModule",{value:!0});Nq.readyHandler=Nq.errorHandler=Nq.closeHandler=Nq.connectHandler=void 0;var Dv=aZ(),qv=l6(),Av=$q(),WY=E0(),Ov=Sq(),f0=WY.Debug("connection");function Fv(Z){return function(){Z.setStatus("connect"),Z.resetCommandQueue();let $=!1,{connectionEpoch:Y}=Z;if(Z.condition.auth)Z.auth(Z.condition.auth,function(X){if(Y!==Z.connectionEpoch)return;if(X)if(X.message.indexOf("no password is set")!==-1)console.warn("[WARN] Redis server does not require a password, but a password was supplied.");else if(X.message.indexOf("without any password configured for the default user")!==-1)console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied");else if(X.message.indexOf("wrong number of arguments for 'auth' command")!==-1)console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`);else $=!0,Z.recoverFromFatalError(X,X)});if(Z.condition.select)Z.select(Z.condition.select).catch((X)=>{Z.silentEmit("error",X)});if(!Z.options.enableReadyCheck)Nq.readyHandler(Z)();if(new Ov.default(Z,{stringNumbers:Z.options.stringNumbers}),Z.options.enableReadyCheck)Z._readyCheck(function(X,W){if(Y!==Z.connectionEpoch)return;if(X){if(!$)Z.recoverFromFatalError(new Error("Ready check failed: "+X.message),X)}else if(Z.connector.check(W))Nq.readyHandler(Z)();else Z.disconnect(!0)})}}Nq.connectHandler=Fv;function HW(Z){let $=new Dv.AbortError("Command aborted due to connection close");return $.command={name:Z.name,args:Z.args},$}function Sv(Z){var $;let Y=0;for(let X=0;X<Z.length;){let W=($=Z.peekAt(X))===null||$===void 0?void 0:$.command,J=W.pipelineIndex;if(J===void 0||J===0)Y=0;if(J!==void 0&&J!==Y++){Z.remove(X,1),W.reject(HW(W));continue}X++}}function Nv(Z){var $;for(let Y=0;Y<Z.length;){let X=($=Z.peekAt(Y))===null||$===void 0?void 0:$.command;if(X.name==="multi")break;if(X.name==="exec"){Z.remove(Y,1),X.reject(HW(X));break}if(X.inTransaction)Z.remove(Y,1),X.reject(HW(X));else Y++}}function Bv(Z){return function(){let Y=Z.status;if(Z.setStatus("close"),Z.commandQueue.length)Sv(Z.commandQueue);if(Z.offlineQueue.length)Nv(Z.offlineQueue);if(Y==="ready"){if(!Z.prevCondition)Z.prevCondition=Z.condition;if(Z.commandQueue.length)Z.prevCommandQueue=Z.commandQueue}if(Z.manuallyClosing)return Z.manuallyClosing=!1,f0("skip reconnecting since the connection is manually closed."),$();if(typeof Z.options.retryStrategy!=="function")return f0("skip reconnecting because `retryStrategy` is not a function"),$();let X=Z.options.retryStrategy(++Z.retryAttempts);if(typeof X!=="number")return f0("skip reconnecting because `retryStrategy` doesn't return a number"),$();f0("reconnect in %sms",X),Z.setStatus("reconnecting",X),Z.reconnectTimeout=setTimeout(function(){Z.reconnectTimeout=null,Z.connect().catch(WY.noop)},X);let{maxRetriesPerRequest:W}=Z.options;if(typeof W==="number"){if(W<0)f0("maxRetriesPerRequest is negative, ignoring...");else if(Z.retryAttempts%(W+1)===0)f0("reach maxRetriesPerRequest limitation, flushing command queue..."),Z.flushQueue(new Av.MaxRetriesPerRequestError(W))}};function $(){Z.setStatus("end"),Z.flushQueue(new Error(WY.CONNECTION_CLOSED_ERROR_MSG))}}Nq.closeHandler=Bv;function Lv(Z){return function($){f0("error: %s",$),Z.silentEmit("error",$)}}Nq.errorHandler=Lv;function _v(Z){return function(){if(Z.setStatus("ready"),Z.retryAttempts=0,Z.options.monitor){Z.call("monitor").then(()=>Z.setStatus("monitoring"),(X)=>Z.emit("error",X));let{sendCommand:Y}=Z;Z.sendCommand=function(X){if(qv.default.checkFlag("VALID_IN_MONITOR_MODE",X.name))return Y.call(Z,X);return X.reject(new Error("Connection is in monitoring mode, can't process commands.")),X.promise},Z.once("close",function(){delete Z.sendCommand});return}let $=Z.prevCondition?Z.prevCondition.select:Z.condition.select;if(Z.options.connectionName)f0("set the connection name [%s]",Z.options.connectionName),Z.client("setname",Z.options.connectionName).catch(WY.noop);if(Z.options.readOnly)f0("set the connection to readonly mode"),Z.readonly().catch(WY.noop);if(Z.prevCondition){let Y=Z.prevCondition;if(Z.prevCondition=null,Y.subscriber&&Z.options.autoResubscribe){if(Z.condition.select!==$)f0("connect to db [%d]",$),Z.select($);let X=Y.subscriber.channels("subscribe");if(X.length)f0("subscribe %d channels",X.length),Z.subscribe(X);let W=Y.subscriber.channels("psubscribe");if(W.length)f0("psubscribe %d channels",W.length),Z.psubscribe(W);let J=Y.subscriber.channels("ssubscribe");if(J.length)f0("ssubscribe %d channels",J.length),Z.ssubscribe(J)}}if(Z.prevCommandQueue)if(Z.options.autoResendUnfulfilledCommands){f0("resend %d unfulfilled commands",Z.prevCommandQueue.length);while(Z.prevCommandQueue.length>0){let Y=Z.prevCommandQueue.shift();if(Y.select!==Z.condition.select&&Y.command.name!=="select")Z.select(Y.select);Z.sendCommand(Y.command,Y.stream)}}else Z.prevCommandQueue=null;if(Z.offlineQueue.length){f0("send %d commands in offline queue",Z.offlineQueue.length);let Y=Z.offlineQueue;Z.resetOfflineQueue();while(Y.length>0){let X=Y.shift();if(X.select!==Z.condition.select&&X.command.name!=="select")Z.select(X.select);Z.sendCommand(X.command,X.stream)}}if(Z.condition.select!==$)f0("connect to db [%d]",$),Z.select($)}}Nq.readyHandler=_v});var Kq=E((Lq)=>{Object.defineProperty(Lq,"__esModule",{value:!0});Lq.DEFAULT_REDIS_OPTIONS=void 0;Lq.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2000,retryStrategy:function(Z){return Math.min(Z*50,2000)},keepAlive:0,noDelay:!0,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(Z){return Math.min(Z*10,1000)},sentinelReconnectStrategy:function(){return 60000},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var _Z=E((jq)=>{Object.defineProperty(jq,"__esModule",{value:!0});var Rq=o$(),Eq=B1("node:events"),MW=NZ(),Ev=YW(),wW=l6(),jv=tD(),Cv=MX(),RZ=Bq(),Iv=Kq(),Pv=XX(),xv=t7(),Y$=E0(),Tv=s7(),kv=zX(),VZ=r9(),Vq=GX(),EZ=Y$.Debug("redis");class E6 extends kv.default{constructor(Z,$,Y){super();if(this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(Z,$,Y),Eq.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let X=new Cv.default(this.options);X.emitter=this,this.connector=X}else this.connector=new jv.StandaloneConnector(this.options);if(this.options.scripts)Object.entries(this.options.scripts).forEach(([X,W])=>{this.defineCommand(X,W)});if(this.options.lazyConnect)this.setStatus("wait");else this.connect().catch(VZ.noop)}static createClient(...Z){return new E6(...Z)}get autoPipelineQueueSize(){let Z=0;for(let $ of this._autoPipelines.values())Z+=$.length;return Z}connect(Z){let $=new Promise((Y,X)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){X(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:W}=this;this.condition={select:W.db,auth:W.username?[W.username,W.password]:W.password,subscriber:!1};let J=this;MW.default(this.connector.connect(function(z,Q){J.silentEmit(z,Q)}),function(z,Q){if(z){J.flushQueue(z),J.silentEmit("error",z),X(z),J.setStatus("end");return}let U=W.tls?"secureConnect":"connect";if("sentinels"in W&&W.sentinels&&!W.enableTLSForSentinelMode)U="connect";if(J.stream=Q,W.noDelay)Q.setNoDelay(!0);if(typeof W.keepAlive==="number")if(Q.connecting)Q.once(U,()=>{Q.setKeepAlive(!0,W.keepAlive)});else Q.setKeepAlive(!0,W.keepAlive);if(Q.connecting){if(Q.once(U,RZ.connectHandler(J)),W.connectTimeout){let M=!1;Q.setTimeout(W.connectTimeout,function(){if(M)return;Q.setTimeout(0),Q.destroy();let q=new Error("connect ETIMEDOUT");q.errorno="ETIMEDOUT",q.code="ETIMEDOUT",q.syscall="connect",RZ.errorHandler(J)(q)}),Q.once(U,function(){M=!0,Q.setTimeout(0)})}}else if(Q.destroyed){let M=J.connector.firstError;if(M)process.nextTick(()=>{RZ.errorHandler(J)(M)});process.nextTick(RZ.closeHandler(J))}else process.nextTick(RZ.connectHandler(J));if(!Q.destroyed)Q.once("error",RZ.errorHandler(J)),Q.once("close",RZ.closeHandler(J));let G=function(){J.removeListener("close",H),Y()};var H=function(){J.removeListener("ready",G),X(new Error(Y$.CONNECTION_CLOSED_ERROR_MSG))};J.once("ready",G),J.once("close",H)})});return MW.default($,Z)}disconnect(Z=!1){if(!Z)this.manuallyClosing=!0;if(this.reconnectTimeout&&!Z)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null;if(this.status==="wait")RZ.closeHandler(this)();else this.connector.disconnect()}end(){this.disconnect()}duplicate(Z){return new E6({...this.options,...Z})}get mode(){var Z;return this.options.monitor?"monitor":((Z=this.condition)===null||Z===void 0?void 0:Z.subscriber)?"subscriber":"normal"}monitor(Z){let $=this.duplicate({monitor:!0,lazyConnect:!1});return MW.default(new Promise(function(Y,X){$.once("error",X),$.once("monitoring",function(){Y($)})}),Z)}sendCommand(Z,$){var Y,X;if(this.status==="wait")this.connect().catch(VZ.noop);if(this.status==="end")return Z.reject(new Error(Y$.CONNECTION_CLOSED_ERROR_MSG)),Z.promise;if(((Y=this.condition)===null||Y===void 0?void 0:Y.subscriber)&&!wW.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",Z.name))return Z.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),Z.promise;if(typeof this.options.commandTimeout==="number")Z.setTimeout(this.options.commandTimeout);let W=this.status==="ready"||!$&&this.status==="connect"&&Rq.exists(Z.name)&&Rq.hasFlag(Z.name,"loading");if(!this.stream)W=!1;else if(!this.stream.writable)W=!1;else if(this.stream._writableState&&this.stream._writableState.ended)W=!1;if(!W){if(!this.options.enableOfflineQueue)return Z.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),Z.promise;if(Z.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),Z.resolve(Buffer.from("OK")),Z.promise;if(EZ.enabled)EZ("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,Z.name,Z.args);this.offlineQueue.push({command:Z,stream:$,select:this.condition.select})}else{if(EZ.enabled)EZ("write command[%s]: %d -> %s(%o)",this._getDescription(),(X=this.condition)===null||X===void 0?void 0:X.select,Z.name,Z.args);if($)if("isPipeline"in $&&$.isPipeline)$.write(Z.toWritable($.destination.redis.stream));else $.write(Z.toWritable($));else this.stream.write(Z.toWritable(this.stream));if(this.commandQueue.push({command:Z,stream:$,select:this.condition.select}),wW.default.checkFlag("WILL_DISCONNECT",Z.name))this.manuallyClosing=!0;if(this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0)this.setSocketTimeout()}if(Z.name==="select"&&Y$.isInt(Z.args[0])){let J=parseInt(Z.args[0],10);if(this.condition.select!==J)this.condition.select=J,this.emit("select",J),EZ("switch to db [%d]",this.condition.select)}return Z.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{if(clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length===0)return;this.setSocketTimeout()})}scanStream(Z){return this.createScanStream("scan",{options:Z})}scanBufferStream(Z){return this.createScanStream("scanBuffer",{options:Z})}sscanStream(Z,$){return this.createScanStream("sscan",{key:Z,options:$})}sscanBufferStream(Z,$){return this.createScanStream("sscanBuffer",{key:Z,options:$})}hscanStream(Z,$){return this.createScanStream("hscan",{key:Z,options:$})}hscanBufferStream(Z,$){return this.createScanStream("hscanBuffer",{key:Z,options:$})}zscanStream(Z,$){return this.createScanStream("zscan",{key:Z,options:$})}zscanBufferStream(Z,$){return this.createScanStream("zscanBuffer",{key:Z,options:$})}silentEmit(Z,$){let Y;if(Z==="error"){if(Y=$,this.status==="end")return;if(this.manuallyClosing){if(Y instanceof Error&&(Y.message===Y$.CONNECTION_CLOSED_ERROR_MSG||Y.syscall==="connect"||Y.syscall==="read"))return}}if(this.listeners(Z).length>0)return this.emit.apply(this,arguments);if(Y&&Y instanceof Error)console.error("[ioredis] Unhandled error event:",Y.stack);return!1}recoverFromFatalError(Z,$,Y){this.flushQueue($,Y),this.silentEmit("error",$),this.disconnect(!0)}handleReconnection(Z,$){var Y;let X=!1;if(this.options.reconnectOnError)X=this.options.reconnectOnError(Z);switch(X){case 1:case!0:if(this.status!=="reconnecting")this.disconnect(!0);$.command.reject(Z);break;case 2:if(this.status!=="reconnecting")this.disconnect(!0);if(((Y=this.condition)===null||Y===void 0?void 0:Y.select)!==$.select&&$.command.name!=="select")this.select($.select);this.sendCommand($.command);break;default:$.command.reject(Z)}}_getDescription(){let Z;if("path"in this.options&&this.options.path)Z=this.options.path;else if(this.stream&&this.stream.remoteAddress&&this.stream.remotePort)Z=this.stream.remoteAddress+":"+this.stream.remotePort;else if("host"in this.options&&this.options.host)Z=this.options.host+":"+this.options.port;else Z="";if(this.options.connectionName)Z+=` (${this.options.connectionName})`;return Z}resetCommandQueue(){this.commandQueue=new Vq}resetOfflineQueue(){this.offlineQueue=new Vq}parseOptions(...Z){let $={},Y=!1;for(let X=0;X<Z.length;++X){let W=Z[X];if(W===null||typeof W==="undefined")continue;if(typeof W==="object")VZ.defaults($,W);else if(typeof W==="string"){if(VZ.defaults($,Y$.parseURL(W)),W.startsWith("rediss://"))Y=!0}else if(typeof W==="number")$.port=W;else throw new Error("Invalid argument "+W)}if(Y)VZ.defaults($,{tls:!0});if(VZ.defaults($,E6.defaultOptions),typeof $.port==="string")$.port=parseInt($.port,10);if(typeof $.db==="string")$.db=parseInt($.db,10);this.options=Y$.resolveTLSProfile($)}setStatus(Z,$){if(EZ.enabled)EZ("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",Z);this.status=Z,process.nextTick(this.emit.bind(this,Z,$))}createScanStream(Z,{key:$,options:Y={}}){return new Pv.default({objectMode:!0,key:$,redis:this,command:Z,...Y})}flushQueue(Z,$){$=VZ.defaults({},$,{offlineQueue:!0,commandQueue:!0});let Y;if($.offlineQueue)while(Y=this.offlineQueue.shift())Y.command.reject(Z);if($.commandQueue){if(this.commandQueue.length>0){if(this.stream)this.stream.removeAllListeners("data");while(Y=this.commandQueue.shift())Y.command.reject(Z)}}}_readyCheck(Z){let $=this;this.info(function(Y,X){if(Y){if(Y.message&&Y.message.includes("NOPERM"))return console.warn(`Skipping the ready check because INFO command fails: "${Y.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),Z(null,{});return Z(Y)}if(typeof X!=="string")return Z(null,X);let W={},J=X.split(`\r
`);for(let z=0;z<J.length;++z){let[Q,...U]=J[z].split(":"),G=U.join(":");if(G)W[Q]=G}if(!W.loading||W.loading==="0")Z(null,W);else{let z=(W.loading_eta_seconds||1)*1000,Q=$.options.maxLoadingRetryTime&&$.options.maxLoadingRetryTime<z?$.options.maxLoadingRetryTime:z;EZ("Redis server still loading, trying again in "+Q+"ms"),setTimeout(function(){$._readyCheck(Z)},Q)}}).catch(VZ.noop)}}E6.Cluster=Ev.default;E6.Command=wW.default;E6.defaultOptions=Iv.DEFAULT_REDIS_OPTIONS;Tv.default(E6,Eq.EventEmitter);xv.addTransactionSupport(E6.prototype);jq.default=E6});var Pq=E((c0,Iq)=>{Object.defineProperty(c0,"__esModule",{value:!0});c0.print=c0.ReplyError=c0.SentinelIterator=c0.SentinelConnector=c0.AbstractConnector=c0.Pipeline=c0.ScanStream=c0.Command=c0.Cluster=c0.Redis=c0.default=void 0;c0=Iq.exports=_Z().default;var fv=_Z();Object.defineProperty(c0,"default",{enumerable:!0,get:function(){return fv.default}});var gv=_Z();Object.defineProperty(c0,"Redis",{enumerable:!0,get:function(){return gv.default}});var yv=YW();Object.defineProperty(c0,"Cluster",{enumerable:!0,get:function(){return yv.default}});var vv=l6();Object.defineProperty(c0,"Command",{enumerable:!0,get:function(){return vv.default}});var hv=XX();Object.defineProperty(c0,"ScanStream",{enumerable:!0,get:function(){return hv.default}});var dv=l7();Object.defineProperty(c0,"Pipeline",{enumerable:!0,get:function(){return dv.default}});var pv=HX();Object.defineProperty(c0,"AbstractConnector",{enumerable:!0,get:function(){return pv.default}});var Cq=MX();Object.defineProperty(c0,"SentinelConnector",{enumerable:!0,get:function(){return Cq.default}});Object.defineProperty(c0,"SentinelIterator",{enumerable:!0,get:function(){return Cq.SentinelIterator}});c0.ReplyError=aZ().ReplyError;Object.defineProperty(c0,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(Z){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function mv(Z,$){if(Z)console.log("Error: "+Z);else console.log("Reply: "+$)}c0.print=mv});var G$=(Z,$)=>{let Y=$?.length?{}:null;if(Y)for(let X of $)Y[X.part.charCodeAt(0)]=X;return{part:Z,store:null,inert:Y,params:null,wildcardStore:null}},sW=(Z,$)=>({...Z,part:$}),rW=(Z)=>({name:Z,store:null,inert:null});class xZ{config;root={};history=[];deferred=[];constructor(Z={}){if(this.config=Z,Z.lazy)this.find=this.lazyFind}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/:.+?\?(?=\/|$)/g};lazyFind=(Z,$)=>{if(!this.config.lazy)return this.find;return this.build(),this.find(Z,$)};build(){if(!this.config.lazy)return;for(let[Z,$,Y]of this.deferred)this.add(Z,$,Y,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=(Z,$)=>{let Y=this.root[Z];if(!Y)return null;return _Y($,$.length,Y,0)}}add(Z,$,Y,{ignoreError:X=!1,ignoreHistory:W=!1,lazy:J=this.config.lazy}={}){if(J)return this.find=this.lazyFind,this.deferred.push([Z,$,Y]),Y;if(typeof $!=="string")throw new TypeError("Route path must be a string");if($==="")$="/";else if($[0]!=="/")$=`/${$}`;let z=$[$.length-1]==="*",Q=$.match(xZ.regex.optionalParams);if(Q){let q=$.replaceAll("?","");this.add(Z,q,Y,{ignoreError:X,ignoreHistory:W,lazy:J});for(let w=0;w<Q.length;w++){let B=$.replace("/"+Q[w],"");this.add(Z,B,Y,{ignoreError:!0,ignoreHistory:W,lazy:J})}return Y}if(Q)$=$.replaceAll("?","");if(this.history.find(([q,w,B])=>q===Z&&w===$))return Y;if(z||Q&&$.charCodeAt($.length-1)===63)$=$.slice(0,-1);if(!W)this.history.push([Z,$,Y]);let U=$.split(xZ.regex.static),G=$.match(xZ.regex.params)||[];if(U[U.length-1]==="")U.pop();let H;if(!this.root[Z])H=this.root[Z]=G$("/");else H=this.root[Z];let M=0;for(let q=0;q<U.length;++q){let w=U[q];if(q>0){let B=G[M++].slice(1);if(H.params===null)H.params=rW(B);else if(H.params.name!==B)if(X)return Y;else throw new Error(`Cannot create route "${$}" with parameter "${B}" because a route already exists with a different parameter name ("${H.params.name}") in the same location`);let D=H.params;if(D.inert===null){H=D.inert=G$(w);continue}H=D.inert}for(let B=0;;){if(B===w.length){if(B<H.part.length){let D=sW(H,H.part.slice(B));Object.assign(H,G$(w,[D]))}break}if(B===H.part.length){if(H.inert===null)H.inert={};let D=H.inert[w.charCodeAt(B)];if(D){H=D,w=w.slice(B),B=0;continue}let L=G$(w.slice(B));H.inert[w.charCodeAt(B)]=L,H=L;break}if(w[B]!==H.part[B]){let D=sW(H,H.part.slice(B)),L=G$(w.slice(B));Object.assign(H,G$(H.part.slice(0,B),[D,L])),H=L;break}++B}}if(M<G.length){let q=G[M].slice(1);if(H.params===null)H.params=rW(q);else if(H.params.name!==q)if(X)return Y;else throw new Error(`Cannot create route "${$}" with parameter "${q}" because a route already exists with a different parameter name ("${H.params.name}") in the same location`);if(H.params.store===null)H.params.store=Y;return H.params.store}if(z){if(H.wildcardStore===null)H.wildcardStore=Y;return H.wildcardStore}if(H.store===null)H.store=Y;return H.store}find(Z,$){let Y=this.root[Z];if(!Y)return null;return _Y($,$.length,Y,0)}}var _Y=(Z,$,Y,X)=>{let W=Y.part,J=W.length,z=X+J;if(J>1){if(z>$)return null;if(J<15){for(let Q=1,U=X+1;Q<J;++Q,++U)if(W.charCodeAt(Q)!==Z.charCodeAt(U))return null}else if(Z.slice(X,z)!==W)return null}if(z===$){if(Y.store!==null)return{store:Y.store,params:{}};if(Y.wildcardStore!==null)return{store:Y.wildcardStore,params:{"*":""}};return null}if(Y.inert!==null){let Q=Y.inert[Z.charCodeAt(z)];if(Q!==void 0){let U=_Y(Z,$,Q,z);if(U!==null)return U}}if(Y.params!==null){let{store:Q,name:U,inert:G}=Y.params,H=Z.indexOf("/",z);if(H!==z){if(H===-1||H>=$){if(Q!==null){let M={};return M[U]=Z.substring(z,$),{store:Q,params:M}}}else if(G!==null){let M=_Y(Z,$,G,H);if(M!==null)return M.params[U]=Z.substring(z,H),M}}}if(Y.wildcardStore!==null)return{store:Y.wildcardStore,params:{"*":Z.substring(z,$)}};return null};var C0={};ZZ(C0,{IsUndefined:()=>Q0,IsUint8Array:()=>P6,IsSymbol:()=>uX,IsString:()=>g1,IsRegExp:()=>G4,IsObject:()=>T1,IsNumber:()=>M8,IsNull:()=>cX,IsIterator:()=>mX,IsFunction:()=>pX,IsDate:()=>TZ,IsBoolean:()=>I6,IsBigInt:()=>Q4,IsAsyncIterator:()=>dX,IsArray:()=>z0,HasPropertyKey:()=>KY});function KY(Z,$){return $ in Z}function dX(Z){return T1(Z)&&!z0(Z)&&!P6(Z)&&Symbol.asyncIterator in Z}function z0(Z){return Array.isArray(Z)}function Q4(Z){return typeof Z==="bigint"}function I6(Z){return typeof Z==="boolean"}function TZ(Z){return Z instanceof globalThis.Date}function pX(Z){return typeof Z==="function"}function mX(Z){return T1(Z)&&!z0(Z)&&!P6(Z)&&Symbol.iterator in Z}function cX(Z){return Z===null}function M8(Z){return typeof Z==="number"}function T1(Z){return typeof Z==="object"&&Z!==null}function G4(Z){return Z instanceof globalThis.RegExp}function g1(Z){return typeof Z==="string"}function uX(Z){return typeof Z==="symbol"}function P6(Z){return Z instanceof globalThis.Uint8Array}function Q0(Z){return Z===void 0}function iF(Z){return Z.map(($)=>RY($))}function lF(Z){return new Date(Z.getTime())}function nF(Z){return new Uint8Array(Z)}function oF(Z){return new RegExp(Z.source,Z.flags)}function tF(Z){let $={};for(let Y of Object.getOwnPropertyNames(Z))$[Y]=RY(Z[Y]);for(let Y of Object.getOwnPropertySymbols(Z))$[Y]=RY(Z[Y]);return $}function RY(Z){return z0(Z)?iF(Z):TZ(Z)?lF(Z):P6(Z)?nF(Z):G4(Z)?oF(Z):T1(Z)?tF(Z):Z}function l1(Z){return RY(Z)}function U$(Z,$){return $===void 0?l1(Z):l1({...$,...Z})}function VY(Z){return U1(Z)&&globalThis.Symbol.asyncIterator in Z}function EY(Z){return U1(Z)&&globalThis.Symbol.iterator in Z}function iX(Z){return U1(Z)&&(globalThis.Object.getPrototypeOf(Z)===Object.prototype||globalThis.Object.getPrototypeOf(Z)===null)}function jY(Z){return Z instanceof globalThis.Promise}function y0(Z){return Z instanceof Date&&globalThis.Number.isFinite(Z.getTime())}function aW(Z){return Z instanceof globalThis.Map}function eW(Z){return Z instanceof globalThis.Set}function R8(Z){return globalThis.ArrayBuffer.isView(Z)}function H$(Z){return Z instanceof globalThis.Uint8Array}function e(Z,$){return $ in Z}function U1(Z){return Z!==null&&typeof Z==="object"}function Z1(Z){return globalThis.Array.isArray(Z)&&!globalThis.ArrayBuffer.isView(Z)}function n1(Z){return Z===void 0}function x6(Z){return Z===null}function F6(Z){return typeof Z==="boolean"}function r(Z){return typeof Z==="number"}function CY(Z){return globalThis.Number.isInteger(Z)}function L0(Z){return typeof Z==="bigint"}function L1(Z){return typeof Z==="string"}function $Z(Z){return typeof Z==="function"}function T6(Z){return typeof Z==="symbol"}function w8(Z){return L0(Z)||F6(Z)||x6(Z)||r(Z)||L1(Z)||T6(Z)||n1(Z)}var m1;(function(Z){Z.InstanceMode="default",Z.ExactOptionalPropertyTypes=!1,Z.AllowArrayObject=!1,Z.AllowNaN=!1,Z.AllowNullVoid=!1;function $(z,Q){return Z.ExactOptionalPropertyTypes?Q in z:z[Q]!==void 0}Z.IsExactOptionalProperty=$;function Y(z){let Q=U1(z);return Z.AllowArrayObject?Q:Q&&!Z1(z)}Z.IsObjectLike=Y;function X(z){return Y(z)&&!(z instanceof Date)&&!(z instanceof Uint8Array)}Z.IsRecordLike=X;function W(z){return Z.AllowNaN?r(z):Number.isFinite(z)}Z.IsNumberLike=W;function J(z){let Q=n1(z);return Z.AllowNullVoid?Q||z===null:Q}Z.IsVoidLike=J})(m1||(m1={}));function sF(Z){return globalThis.Object.freeze(Z).map(($)=>U4($))}function rF(Z){return Z}function aF(Z){return Z}function eF(Z){return Z}function Z3(Z){let $={};for(let Y of Object.getOwnPropertyNames(Z))$[Y]=U4(Z[Y]);for(let Y of Object.getOwnPropertySymbols(Z))$[Y]=U4(Z[Y]);return globalThis.Object.freeze($)}function U4(Z){return z0(Z)?sF(Z):TZ(Z)?rF(Z):P6(Z)?aF(Z):G4(Z)?eF(Z):T1(Z)?Z3(Z):Z}function R(Z,$){let Y=$!==void 0?{...$,...Z}:Z;switch(m1.InstanceMode){case"freeze":return U4(Y);case"clone":return l1(Y);default:return Y}}class a extends Error{constructor(Z){super(Z)}}var y1=Symbol.for("TypeBox.Transform"),u8=Symbol.for("TypeBox.Readonly"),_0=Symbol.for("TypeBox.Optional"),V8=Symbol.for("TypeBox.Hint"),_=Symbol.for("TypeBox.Kind");function M$(Z){return T1(Z)&&Z[u8]==="Readonly"}function n0(Z){return T1(Z)&&Z[_0]==="Optional"}function lX(Z){return F1(Z,"Any")}function nX(Z){return F1(Z,"Argument")}function i8(Z){return F1(Z,"Array")}function kZ(Z){return F1(Z,"AsyncIterator")}function bZ(Z){return F1(Z,"BigInt")}function k6(Z){return F1(Z,"Boolean")}function l8(Z){return F1(Z,"Computed")}function n8(Z){return F1(Z,"Constructor")}function $3(Z){return F1(Z,"Date")}function o8(Z){return F1(Z,"Function")}function t8(Z){return F1(Z,"Integer")}function e1(Z){return F1(Z,"Intersect")}function fZ(Z){return F1(Z,"Iterator")}function F1(Z,$){return T1(Z)&&_ in Z&&Z[_]===$}function IY(Z){return I6(Z)||M8(Z)||g1(Z)}function D8(Z){return F1(Z,"Literal")}function q8(Z){return F1(Z,"MappedKey")}function o1(Z){return F1(Z,"MappedResult")}function YZ(Z){return F1(Z,"Never")}function Y3(Z){return F1(Z,"Not")}function H4(Z){return F1(Z,"Null")}function s8(Z){return F1(Z,"Number")}function G0(Z){return F1(Z,"Object")}function gZ(Z){return F1(Z,"Promise")}function yZ(Z){return F1(Z,"Record")}function X0(Z){return F1(Z,"Ref")}function oX(Z){return F1(Z,"RegExp")}function b6(Z){return F1(Z,"String")}function M4(Z){return F1(Z,"Symbol")}function A8(Z){return F1(Z,"TemplateLiteral")}function X3(Z){return F1(Z,"This")}function j1(Z){return T1(Z)&&y1 in Z}function O8(Z){return F1(Z,"Tuple")}function f6(Z){return F1(Z,"Undefined")}function _1(Z){return F1(Z,"Union")}function W3(Z){return F1(Z,"Uint8Array")}function J3(Z){return F1(Z,"Unknown")}function z3(Z){return F1(Z,"Unsafe")}function Q3(Z){return F1(Z,"Void")}function XZ(Z){return T1(Z)&&_ in Z&&g1(Z[_])}function r1(Z){return lX(Z)||nX(Z)||i8(Z)||k6(Z)||bZ(Z)||kZ(Z)||l8(Z)||n8(Z)||$3(Z)||o8(Z)||t8(Z)||e1(Z)||fZ(Z)||D8(Z)||q8(Z)||o1(Z)||YZ(Z)||Y3(Z)||H4(Z)||s8(Z)||G0(Z)||gZ(Z)||yZ(Z)||X0(Z)||oX(Z)||b6(Z)||M4(Z)||A8(Z)||X3(Z)||O8(Z)||f6(Z)||_1(Z)||W3(Z)||J3(Z)||z3(Z)||Q3(Z)||XZ(Z)}var S={};ZZ(S,{TypeGuardUnknownTypeError:()=>ZJ,IsVoid:()=>pJ,IsUnsafe:()=>dJ,IsUnknown:()=>hJ,IsUnionLiteral:()=>O3,IsUnion:()=>rX,IsUndefined:()=>yJ,IsUint8Array:()=>vJ,IsTuple:()=>gJ,IsTransform:()=>fJ,IsThis:()=>bJ,IsTemplateLiteral:()=>kJ,IsSymbol:()=>TJ,IsString:()=>xJ,IsSchema:()=>t1,IsRegExp:()=>PJ,IsRef:()=>IJ,IsRecursive:()=>A3,IsRecord:()=>CJ,IsReadonly:()=>M3,IsProperties:()=>PY,IsPromise:()=>jJ,IsOptional:()=>w3,IsObject:()=>EJ,IsNumber:()=>VJ,IsNull:()=>RJ,IsNot:()=>KJ,IsNever:()=>_J,IsMappedResult:()=>LJ,IsMappedKey:()=>BJ,IsLiteralValue:()=>NJ,IsLiteralString:()=>FJ,IsLiteralNumber:()=>SJ,IsLiteralBoolean:()=>q3,IsLiteral:()=>D4,IsKindOf:()=>D1,IsKind:()=>mJ,IsIterator:()=>OJ,IsIntersect:()=>AJ,IsInteger:()=>qJ,IsImport:()=>D3,IsFunction:()=>DJ,IsDate:()=>wJ,IsConstructor:()=>MJ,IsComputed:()=>HJ,IsBoolean:()=>UJ,IsBigInt:()=>GJ,IsAsyncIterator:()=>QJ,IsArray:()=>zJ,IsArgument:()=>JJ,IsAny:()=>WJ});class ZJ extends a{}var G3=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function $J(Z){try{return new RegExp(Z),!0}catch{return!1}}function tX(Z){if(!g1(Z))return!1;for(let $=0;$<Z.length;$++){let Y=Z.charCodeAt($);if(Y>=7&&Y<=13||Y===27||Y===127)return!1}return!0}function YJ(Z){return sX(Z)||t1(Z)}function w4(Z){return Q0(Z)||Q4(Z)}function v1(Z){return Q0(Z)||M8(Z)}function sX(Z){return Q0(Z)||I6(Z)}function k1(Z){return Q0(Z)||g1(Z)}function U3(Z){return Q0(Z)||g1(Z)&&tX(Z)&&$J(Z)}function H3(Z){return Q0(Z)||g1(Z)&&tX(Z)}function XJ(Z){return Q0(Z)||t1(Z)}function M3(Z){return T1(Z)&&Z[u8]==="Readonly"}function w3(Z){return T1(Z)&&Z[_0]==="Optional"}function WJ(Z){return D1(Z,"Any")&&k1(Z.$id)}function JJ(Z){return D1(Z,"Argument")&&M8(Z.index)}function zJ(Z){return D1(Z,"Array")&&Z.type==="array"&&k1(Z.$id)&&t1(Z.items)&&v1(Z.minItems)&&v1(Z.maxItems)&&sX(Z.uniqueItems)&&XJ(Z.contains)&&v1(Z.minContains)&&v1(Z.maxContains)}function QJ(Z){return D1(Z,"AsyncIterator")&&Z.type==="AsyncIterator"&&k1(Z.$id)&&t1(Z.items)}function GJ(Z){return D1(Z,"BigInt")&&Z.type==="bigint"&&k1(Z.$id)&&w4(Z.exclusiveMaximum)&&w4(Z.exclusiveMinimum)&&w4(Z.maximum)&&w4(Z.minimum)&&w4(Z.multipleOf)}function UJ(Z){return D1(Z,"Boolean")&&Z.type==="boolean"&&k1(Z.$id)}function HJ(Z){return D1(Z,"Computed")&&g1(Z.target)&&z0(Z.parameters)&&Z.parameters.every(($)=>t1($))}function MJ(Z){return D1(Z,"Constructor")&&Z.type==="Constructor"&&k1(Z.$id)&&z0(Z.parameters)&&Z.parameters.every(($)=>t1($))&&t1(Z.returns)}function wJ(Z){return D1(Z,"Date")&&Z.type==="Date"&&k1(Z.$id)&&v1(Z.exclusiveMaximumTimestamp)&&v1(Z.exclusiveMinimumTimestamp)&&v1(Z.maximumTimestamp)&&v1(Z.minimumTimestamp)&&v1(Z.multipleOfTimestamp)}function DJ(Z){return D1(Z,"Function")&&Z.type==="Function"&&k1(Z.$id)&&z0(Z.parameters)&&Z.parameters.every(($)=>t1($))&&t1(Z.returns)}function D3(Z){return D1(Z,"Import")&&KY(Z,"$defs")&&T1(Z.$defs)&&PY(Z.$defs)&&KY(Z,"$ref")&&g1(Z.$ref)&&Z.$ref in Z.$defs}function qJ(Z){return D1(Z,"Integer")&&Z.type==="integer"&&k1(Z.$id)&&v1(Z.exclusiveMaximum)&&v1(Z.exclusiveMinimum)&&v1(Z.maximum)&&v1(Z.minimum)&&v1(Z.multipleOf)}function PY(Z){return T1(Z)&&Object.entries(Z).every(([$,Y])=>tX($)&&t1(Y))}function AJ(Z){return D1(Z,"Intersect")&&(g1(Z.type)&&Z.type!=="object"?!1:!0)&&z0(Z.allOf)&&Z.allOf.every(($)=>t1($)&&!fJ($))&&k1(Z.type)&&(sX(Z.unevaluatedProperties)||XJ(Z.unevaluatedProperties))&&k1(Z.$id)}function OJ(Z){return D1(Z,"Iterator")&&Z.type==="Iterator"&&k1(Z.$id)&&t1(Z.items)}function D1(Z,$){return T1(Z)&&_ in Z&&Z[_]===$}function FJ(Z){return D4(Z)&&g1(Z.const)}function SJ(Z){return D4(Z)&&M8(Z.const)}function q3(Z){return D4(Z)&&I6(Z.const)}function D4(Z){return D1(Z,"Literal")&&k1(Z.$id)&&NJ(Z.const)}function NJ(Z){return I6(Z)||M8(Z)||g1(Z)}function BJ(Z){return D1(Z,"MappedKey")&&z0(Z.keys)&&Z.keys.every(($)=>M8($)||g1($))}function LJ(Z){return D1(Z,"MappedResult")&&PY(Z.properties)}function _J(Z){return D1(Z,"Never")&&T1(Z.not)&&Object.getOwnPropertyNames(Z.not).length===0}function KJ(Z){return D1(Z,"Not")&&t1(Z.not)}function RJ(Z){return D1(Z,"Null")&&Z.type==="null"&&k1(Z.$id)}function VJ(Z){return D1(Z,"Number")&&Z.type==="number"&&k1(Z.$id)&&v1(Z.exclusiveMaximum)&&v1(Z.exclusiveMinimum)&&v1(Z.maximum)&&v1(Z.minimum)&&v1(Z.multipleOf)}function EJ(Z){return D1(Z,"Object")&&Z.type==="object"&&k1(Z.$id)&&PY(Z.properties)&&YJ(Z.additionalProperties)&&v1(Z.minProperties)&&v1(Z.maxProperties)}function jJ(Z){return D1(Z,"Promise")&&Z.type==="Promise"&&k1(Z.$id)&&t1(Z.item)}function CJ(Z){return D1(Z,"Record")&&Z.type==="object"&&k1(Z.$id)&&YJ(Z.additionalProperties)&&T1(Z.patternProperties)&&(($)=>{let Y=Object.getOwnPropertyNames($.patternProperties);return Y.length===1&&$J(Y[0])&&T1($.patternProperties)&&t1($.patternProperties[Y[0]])})(Z)}function A3(Z){return T1(Z)&&V8 in Z&&Z[V8]==="Recursive"}function IJ(Z){return D1(Z,"Ref")&&k1(Z.$id)&&g1(Z.$ref)}function PJ(Z){return D1(Z,"RegExp")&&k1(Z.$id)&&g1(Z.source)&&g1(Z.flags)&&v1(Z.maxLength)&&v1(Z.minLength)}function xJ(Z){return D1(Z,"String")&&Z.type==="string"&&k1(Z.$id)&&v1(Z.minLength)&&v1(Z.maxLength)&&U3(Z.pattern)&&H3(Z.format)}function TJ(Z){return D1(Z,"Symbol")&&Z.type==="symbol"&&k1(Z.$id)}function kJ(Z){return D1(Z,"TemplateLiteral")&&Z.type==="string"&&g1(Z.pattern)&&Z.pattern[0]==="^"&&Z.pattern[Z.pattern.length-1]==="$"}function bJ(Z){return D1(Z,"This")&&k1(Z.$id)&&g1(Z.$ref)}function fJ(Z){return T1(Z)&&y1 in Z}function gJ(Z){return D1(Z,"Tuple")&&Z.type==="array"&&k1(Z.$id)&&M8(Z.minItems)&&M8(Z.maxItems)&&Z.minItems===Z.maxItems&&(Q0(Z.items)&&Q0(Z.additionalItems)&&Z.minItems===0||z0(Z.items)&&Z.items.every(($)=>t1($)))}function yJ(Z){return D1(Z,"Undefined")&&Z.type==="undefined"&&k1(Z.$id)}function O3(Z){return rX(Z)&&Z.anyOf.every(($)=>FJ($)||SJ($))}function rX(Z){return D1(Z,"Union")&&k1(Z.$id)&&T1(Z)&&z0(Z.anyOf)&&Z.anyOf.every(($)=>t1($))}function vJ(Z){return D1(Z,"Uint8Array")&&Z.type==="Uint8Array"&&k1(Z.$id)&&v1(Z.minByteLength)&&v1(Z.maxByteLength)}function hJ(Z){return D1(Z,"Unknown")&&k1(Z.$id)}function dJ(Z){return D1(Z,"Unsafe")}function pJ(Z){return D1(Z,"Void")&&Z.type==="void"&&k1(Z.$id)}function mJ(Z){return T1(Z)&&_ in Z&&g1(Z[_])&&!G3.includes(Z[_])}function t1(Z){return T1(Z)&&(WJ(Z)||JJ(Z)||zJ(Z)||UJ(Z)||GJ(Z)||QJ(Z)||HJ(Z)||MJ(Z)||wJ(Z)||DJ(Z)||qJ(Z)||AJ(Z)||OJ(Z)||D4(Z)||BJ(Z)||LJ(Z)||_J(Z)||KJ(Z)||RJ(Z)||VJ(Z)||EJ(Z)||jJ(Z)||CJ(Z)||IJ(Z)||PJ(Z)||xJ(Z)||TJ(Z)||kJ(Z)||bJ(Z)||gJ(Z)||yJ(Z)||rX(Z)||vJ(Z)||hJ(Z)||dJ(Z)||pJ(Z)||mJ(Z))}var cJ="(true|false)",xY="(0|[1-9][0-9]*)",uJ="(.*)";var S6="^(0|[1-9][0-9]*)$",N6="^(.*)$",iJ="^(?!.*)$";var x1={};ZZ(x1,{Set:()=>L3,Has:()=>B3,Get:()=>_3,Entries:()=>F3,Delete:()=>N3,Clear:()=>S3});var w$=new Map;function F3(){return new Map(w$)}function S3(){return w$.clear()}function N3(Z){return w$.delete(Z)}function B3(Z){return w$.has(Z)}function L3(Z,$){w$.set(Z,$)}function _3(Z){return w$.get(Z)}var U0={};ZZ(U0,{Set:()=>j3,Has:()=>E3,Get:()=>C3,Entries:()=>K3,Delete:()=>V3,Clear:()=>R3});var D$=new Map;function K3(){return new Map(D$)}function R3(){return D$.clear()}function V3(Z){return D$.delete(Z)}function E3(Z){return D$.has(Z)}function j3(Z,$){D$.set(Z,$)}function C3(Z){return D$.get(Z)}function lJ(Z,$){return Z.includes($)}function nJ(Z){return[...new Set(Z)]}function I3(Z,$){return Z.filter((Y)=>$.includes(Y))}function P3(Z,$){return Z.reduce((Y,X)=>{return I3(Y,X)},$)}function oJ(Z){return Z.length===1?Z[0]:Z.length>1?P3(Z.slice(1),Z[0]):[]}function tJ(Z){let $=[];for(let Y of Z)$.push(...Y);return $}function WZ(Z){return R({[_]:"Any"},Z)}function q$(Z,$){return R({[_]:"Array",type:"array",items:Z},$)}function sJ(Z){return R({[_]:"Argument",index:Z})}function A$(Z,$){return R({[_]:"AsyncIterator",type:"AsyncIterator",items:Z},$)}function c1(Z,$,Y){return R({[_]:"Computed",target:Z,parameters:$},Y)}function x3(Z,$){let{[$]:Y,...X}=Z;return X}function Z0(Z,$){return $.reduce((Y,X)=>x3(Y,X),Z)}function Q1(Z){return R({[_]:"Never",not:{}},Z)}function K1(Z){return R({[_]:"MappedResult",properties:Z})}function O$(Z,$,Y){return R({[_]:"Constructor",type:"Constructor",parameters:Z,returns:$},Y)}function B6(Z,$,Y){return R({[_]:"Function",type:"Function",parameters:Z,returns:$},Y)}function q4(Z,$){return R({[_]:"Union",anyOf:Z},$)}function T3(Z){return Z.some(($)=>n0($))}function rJ(Z){return Z.map(($)=>n0($)?k3($):$)}function k3(Z){return Z0(Z,[_0])}function b3(Z,$){return T3(Z)?I0(q4(rJ(Z),$)):q4(rJ(Z),$)}function L6(Z,$){return Z.length===1?R(Z[0],$):Z.length===0?Q1($):b3(Z,$)}function C1(Z,$){return Z.length===0?Q1($):Z.length===1?R(Z[0],$):q4(Z,$)}class aX extends a{}function f3(Z){return Z.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function eX(Z,$,Y){return Z[$]===Y&&Z.charCodeAt($-1)!==92}function y6(Z,$){return eX(Z,$,"(")}function A4(Z,$){return eX(Z,$,")")}function aJ(Z,$){return eX(Z,$,"|")}function g3(Z){if(!(y6(Z,0)&&A4(Z,Z.length-1)))return!1;let $=0;for(let Y=0;Y<Z.length;Y++){if(y6(Z,Y))$+=1;if(A4(Z,Y))$-=1;if($===0&&Y!==Z.length-1)return!1}return!0}function y3(Z){return Z.slice(1,Z.length-1)}function v3(Z){let $=0;for(let Y=0;Y<Z.length;Y++){if(y6(Z,Y))$+=1;if(A4(Z,Y))$-=1;if(aJ(Z,Y)&&$===0)return!0}return!1}function h3(Z){for(let $=0;$<Z.length;$++)if(y6(Z,$))return!0;return!1}function d3(Z){let[$,Y]=[0,0],X=[];for(let J=0;J<Z.length;J++){if(y6(Z,J))$+=1;if(A4(Z,J))$-=1;if(aJ(Z,J)&&$===0){let z=Z.slice(Y,J);if(z.length>0)X.push(F$(z));Y=J+1}}let W=Z.slice(Y);if(W.length>0)X.push(F$(W));if(X.length===0)return{type:"const",const:""};if(X.length===1)return X[0];return{type:"or",expr:X}}function p3(Z){function $(W,J){if(!y6(W,J))throw new aX("TemplateLiteralParser: Index must point to open parens");let z=0;for(let Q=J;Q<W.length;Q++){if(y6(W,Q))z+=1;if(A4(W,Q))z-=1;if(z===0)return[J,Q]}throw new aX("TemplateLiteralParser: Unclosed group parens in expression")}function Y(W,J){for(let z=J;z<W.length;z++)if(y6(W,z))return[J,z];return[J,W.length]}let X=[];for(let W=0;W<Z.length;W++)if(y6(Z,W)){let[J,z]=$(Z,W),Q=Z.slice(J,z+1);X.push(F$(Q)),W=z}else{let[J,z]=Y(Z,W),Q=Z.slice(J,z);if(Q.length>0)X.push(F$(Q));W=z-1}return X.length===0?{type:"const",const:""}:X.length===1?X[0]:{type:"and",expr:X}}function F$(Z){return g3(Z)?F$(y3(Z)):v3(Z)?d3(Z):h3(Z)?p3(Z):{type:"const",const:f3(Z)}}function S$(Z){return F$(Z.slice(1,Z.length-1))}class eJ extends a{}function m3(Z){return Z.type==="or"&&Z.expr.length===2&&Z.expr[0].type==="const"&&Z.expr[0].const==="0"&&Z.expr[1].type==="const"&&Z.expr[1].const==="[1-9][0-9]*"}function c3(Z){return Z.type==="or"&&Z.expr.length===2&&Z.expr[0].type==="const"&&Z.expr[0].const==="true"&&Z.expr[1].type==="const"&&Z.expr[1].const==="false"}function u3(Z){return Z.type==="const"&&Z.const===".*"}function vZ(Z){return m3(Z)||u3(Z)?!1:c3(Z)?!0:Z.type==="and"?Z.expr.every(($)=>vZ($)):Z.type==="or"?Z.expr.every(($)=>vZ($)):Z.type==="const"?!0:(()=>{throw new eJ("Unknown expression type")})()}function TY(Z){let $=S$(Z.pattern);return vZ($)}class Zz extends a{}function*$z(Z){if(Z.length===1)return yield*Z[0];for(let $ of Z[0])for(let Y of $z(Z.slice(1)))yield`${$}${Y}`}function*i3(Z){return yield*$z(Z.expr.map(($)=>[...O4($)]))}function*l3(Z){for(let $ of Z.expr)yield*O4($)}function*n3(Z){return yield Z.const}function*O4(Z){return Z.type==="and"?yield*i3(Z):Z.type==="or"?yield*l3(Z):Z.type==="const"?yield*n3(Z):(()=>{throw new Zz("Unknown expression")})()}function N$(Z){let $=S$(Z.pattern);return vZ($)?[...O4($)]:[]}function S1(Z,$){return R({[_]:"Literal",const:Z,type:typeof Z},$)}function kY(Z){return R({[_]:"Boolean",type:"boolean"},Z)}function B$(Z){return R({[_]:"BigInt",type:"bigint"},Z)}function E8(Z){return R({[_]:"Number",type:"number"},Z)}function v0(Z){return R({[_]:"String",type:"string"},Z)}function*o3(Z){let $=Z.trim().replace(/"|'/g,"");return $==="boolean"?yield kY():$==="number"?yield E8():$==="bigint"?yield B$():$==="string"?yield v0():yield(()=>{let Y=$.split("|").map((X)=>S1(X.trim()));return Y.length===0?Q1():Y.length===1?Y[0]:L6(Y)})()}function*t3(Z){if(Z[1]!=="{"){let $=S1("$"),Y=Z5(Z.slice(1));return yield*[$,...Y]}for(let $=2;$<Z.length;$++)if(Z[$]==="}"){let Y=o3(Z.slice(2,$)),X=Z5(Z.slice($+1));return yield*[...Y,...X]}yield S1(Z)}function*Z5(Z){for(let $=0;$<Z.length;$++)if(Z[$]==="$"){let Y=S1(Z.slice(0,$)),X=t3(Z.slice($));return yield*[Y,...X]}yield S1(Z)}function Yz(Z){return[...Z5(Z)]}class Xz extends a{}function s3(Z){return Z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Wz(Z,$){return A8(Z)?Z.pattern.slice(1,Z.pattern.length-1):_1(Z)?`(${Z.anyOf.map((Y)=>Wz(Y,$)).join("|")})`:s8(Z)?`${$}${xY}`:t8(Z)?`${$}${xY}`:bZ(Z)?`${$}${xY}`:b6(Z)?`${$}${uJ}`:D8(Z)?`${$}${s3(Z.const.toString())}`:k6(Z)?`${$}${cJ}`:(()=>{throw new Xz(`Unexpected Kind '${Z[_]}'`)})()}function $5(Z){return`^${Z.map(($)=>Wz($,"")).join("")}$`}function hZ(Z){let Y=N$(Z).map((X)=>S1(X));return L6(Y)}function bY(Z,$){let Y=g1(Z)?$5(Yz(Z)):$5(Z);return R({[_]:"TemplateLiteral",type:"string",pattern:Y},$)}function r3(Z){return N$(Z).map((Y)=>Y.toString())}function a3(Z){let $=[];for(let Y of Z)$.push(...o0(Y));return $}function e3(Z){return[Z.toString()]}function o0(Z){return[...new Set(A8(Z)?r3(Z):_1(Z)?a3(Z.anyOf):D8(Z)?e3(Z.const):s8(Z)?["[number]"]:t8(Z)?["[number]"]:[])]}function ZS(Z,$,Y){let X={};for(let W of Object.getOwnPropertyNames($))X[W]=JZ(Z,o0($[W]),Y);return X}function $S(Z,$,Y){return ZS(Z,$.properties,Y)}function Jz(Z,$,Y){let X=$S(Z,$,Y);return K1(X)}function Qz(Z,$){return Z.map((Y)=>Gz(Y,$))}function YS(Z){return Z.filter(($)=>!YZ($))}function XS(Z,$){return fY(YS(Qz(Z,$)))}function WS(Z){return Z.some(($)=>YZ($))?[]:Z}function JS(Z,$){return L6(WS(Qz(Z,$)))}function zS(Z,$){return $ in Z?Z[$]:$==="[number]"?L6(Z):Q1()}function QS(Z,$){return $==="[number]"?Z:Q1()}function GS(Z,$){return $ in Z?Z[$]:Q1()}function Gz(Z,$){return e1(Z)?XS(Z.allOf,$):_1(Z)?JS(Z.anyOf,$):O8(Z)?zS(Z.items??[],$):i8(Z)?QS(Z.items,$):G0(Z)?GS(Z.properties,$):Q1()}function F4(Z,$){return $.map((Y)=>Gz(Z,Y))}function zz(Z,$){return L6(F4(Z,$))}function JZ(Z,$,Y){if(X0(Z)||X0($)){if(!r1(Z)||!r1($))throw new a("Index types using Ref parameters require both Type and Key to be of TSchema");return c1("Index",[Z,$])}if(o1($))return Jz(Z,$,Y);if(q8($))return Uz(Z,$,Y);return R(r1($)?zz(Z,o0($)):zz(Z,$),Y)}function US(Z,$,Y){return{[$]:JZ(Z,[$],l1(Y))}}function HS(Z,$,Y){return $.reduce((X,W)=>{return{...X,...US(Z,W,Y)}},{})}function MS(Z,$,Y){return HS(Z,$.keys,Y)}function Uz(Z,$,Y){let X=MS(Z,$,Y);return K1(X)}function L$(Z,$){return R({[_]:"Iterator",type:"Iterator",items:Z},$)}function wS(Z){let $=[];for(let Y in Z)if(!n0(Z[Y]))$.push(Y);return $}function DS(Z,$){let Y=wS(Z),X=Y.length>0?{[_]:"Object",type:"object",properties:Z,required:Y}:{[_]:"Object",type:"object",properties:Z};return R(X,$)}var I1=DS;function gY(Z,$){return R({[_]:"Promise",type:"Promise",item:Z},$)}function qS(Z){return R(Z0(Z,[u8]))}function AS(Z){return R({...Z,[u8]:"Readonly"})}function OS(Z,$){return $===!1?qS(Z):AS(Z)}function t0(Z,$){let Y=$??!0;return o1(Z)?Hz(Z,Y):OS(Z,Y)}function FS(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=t0(Z[X],$);return Y}function SS(Z,$){return FS(Z.properties,$)}function Hz(Z,$){let Y=SS(Z,$);return K1(Y)}function j8(Z,$){return R(Z.length>0?{[_]:"Tuple",type:"array",items:Z,additionalItems:!1,minItems:Z.length,maxItems:Z.length}:{[_]:"Tuple",type:"array",minItems:Z.length,maxItems:Z.length},$)}function Mz(Z,$){return Z in $?C8(Z,$[Z]):K1($)}function NS(Z){return{[Z]:S1(Z)}}function BS(Z){let $={};for(let Y of Z)$[Y]=S1(Y);return $}function LS(Z,$){return lJ($,Z)?NS(Z):BS($)}function _S(Z,$){let Y=LS(Z,$);return Mz(Z,Y)}function S4(Z,$){return $.map((Y)=>C8(Z,Y))}function KS(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames($))Y[X]=C8(Z,$[X]);return Y}function C8(Z,$){let Y={...$};return n0($)?I0(C8(Z,Z0($,[_0]))):M$($)?t0(C8(Z,Z0($,[u8]))):o1($)?Mz(Z,$.properties):q8($)?_S(Z,$.keys):n8($)?O$(S4(Z,$.parameters),C8(Z,$.returns),Y):o8($)?B6(S4(Z,$.parameters),C8(Z,$.returns),Y):kZ($)?A$(C8(Z,$.items),Y):fZ($)?L$(C8(Z,$.items),Y):e1($)?P0(S4(Z,$.allOf),Y):_1($)?C1(S4(Z,$.anyOf),Y):O8($)?j8(S4(Z,$.items??[]),Y):G0($)?I1(KS(Z,$.properties),Y):i8($)?q$(C8(Z,$.items),Y):gZ($)?gY(C8(Z,$.item),Y):$}function RS(Z,$){let Y={};for(let X of Z)Y[X]=C8(X,$);return Y}function wz(Z,$,Y){let X=r1(Z)?o0(Z):Z,W=$({[_]:"MappedKey",keys:X}),J=RS(X,W);return I1(J,Y)}function VS(Z){return R(Z0(Z,[_0]))}function ES(Z){return R({...Z,[_0]:"Optional"})}function jS(Z,$){return $===!1?VS(Z):ES(Z)}function I0(Z,$){let Y=$??!0;return o1(Z)?Dz(Z,Y):jS(Z,Y)}function CS(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=I0(Z[X],$);return Y}function IS(Z,$){return CS(Z.properties,$)}function Dz(Z,$){let Y=IS(Z,$);return K1(Y)}function N4(Z,$={}){let Y=Z.every((W)=>G0(W)),X=r1($.unevaluatedProperties)?{unevaluatedProperties:$.unevaluatedProperties}:{};return R($.unevaluatedProperties===!1||r1($.unevaluatedProperties)||Y?{...X,[_]:"Intersect",type:"object",allOf:Z}:{...X,[_]:"Intersect",allOf:Z},$)}function PS(Z){return Z.every(($)=>n0($))}function xS(Z){return Z0(Z,[_0])}function qz(Z){return Z.map(($)=>n0($)?xS($):$)}function TS(Z,$){return PS(Z)?I0(N4(qz(Z),$)):N4(qz(Z),$)}function fY(Z,$={}){if(Z.length===1)return R(Z[0],$);if(Z.length===0)return Q1($);if(Z.some((Y)=>j1(Y)))throw new Error("Cannot intersect transform types");return TS(Z,$)}function P0(Z,$){if(Z.length===1)return R(Z[0],$);if(Z.length===0)return Q1($);if(Z.some((Y)=>j1(Y)))throw new Error("Cannot intersect transform types");return N4(Z,$)}function I8(...Z){let[$,Y]=typeof Z[0]==="string"?[Z[0],Z[1]]:[Z[0].$id,Z[1]];if(typeof $!=="string")throw new a("Ref: $ref must be a string");return R({[_]:"Ref",$ref:$},Y)}function kS(Z,$){return c1("Awaited",[c1(Z,$)])}function bS(Z){return c1("Awaited",[I8(Z)])}function fS(Z){return P0(Az(Z))}function gS(Z){return C1(Az(Z))}function yS(Z){return _$(Z)}function Az(Z){return Z.map(($)=>_$($))}function _$(Z,$){return R(l8(Z)?kS(Z.target,Z.parameters):e1(Z)?fS(Z.allOf):_1(Z)?gS(Z.anyOf):gZ(Z)?yS(Z.item):X0(Z)?bS(Z.$ref):Z,$)}function Oz(Z){let $=[];for(let Y of Z)$.push(s0(Y));return $}function vS(Z){let $=Oz(Z);return tJ($)}function hS(Z){let $=Oz(Z);return oJ($)}function dS(Z){return Z.map(($,Y)=>Y.toString())}function pS(Z){return["[number]"]}function mS(Z){return globalThis.Object.getOwnPropertyNames(Z)}function cS(Z){if(!Y5)return[];return globalThis.Object.getOwnPropertyNames(Z).map((Y)=>{return Y[0]==="^"&&Y[Y.length-1]==="$"?Y.slice(1,Y.length-1):Y})}function s0(Z){return e1(Z)?vS(Z.allOf):_1(Z)?hS(Z.anyOf):O8(Z)?dS(Z.items??[]):i8(Z)?pS(Z.items):G0(Z)?mS(Z.properties):yZ(Z)?cS(Z.patternProperties):[]}var Y5=!1;function v6(Z){Y5=!0;let $=s0(Z);return Y5=!1,`^(${$.map((X)=>`(${X})`).join("|")})$`}function uS(Z,$){return c1("KeyOf",[c1(Z,$)])}function iS(Z){return c1("KeyOf",[I8(Z)])}function lS(Z,$){let Y=s0(Z),X=nS(Y),W=L6(X);return R(W,$)}function nS(Z){return Z.map(($)=>$==="[number]"?E8():S1($))}function K$(Z,$){return l8(Z)?uS(Z.target,Z.parameters):X0(Z)?iS(Z.$ref):o1(Z)?Fz(Z,$):lS(Z,$)}function oS(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=K$(Z[X],l1($));return Y}function tS(Z,$){return oS(Z.properties,$)}function Fz(Z,$){let Y=tS(Z,$);return K1(Y)}function yY(Z){let $=s0(Z),Y=F4(Z,$);return $.map((X,W)=>[$[W],Y[W]])}function sS(Z){let $=[];for(let Y of Z)$.push(...s0(Y));return nJ($)}function rS(Z){return Z.filter(($)=>!YZ($))}function aS(Z,$){let Y=[];for(let X of Z)Y.push(...F4(X,[$]));return rS(Y)}function eS(Z,$){let Y={};for(let X of $)Y[X]=fY(aS(Z,X));return Y}function Sz(Z,$){let Y=sS(Z),X=eS(Z,Y);return I1(X,$)}function vY(Z){return R({[_]:"Date",type:"Date"},Z)}function hY(Z){return R({[_]:"Null",type:"null"},Z)}function dY(Z){return R({[_]:"Symbol",type:"symbol"},Z)}function pY(Z){return R({[_]:"Undefined",type:"undefined"},Z)}function mY(Z){return R({[_]:"Uint8Array",type:"Uint8Array"},Z)}function r8(Z){return R({[_]:"Unknown"},Z)}function ZN(Z){return Z.map(($)=>X5($,!1))}function $N(Z){let $={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))$[Y]=t0(X5(Z[Y],!1));return $}function cY(Z,$){return $===!0?Z:t0(Z)}function X5(Z,$){return dX(Z)?cY(WZ(),$):mX(Z)?cY(WZ(),$):z0(Z)?t0(j8(ZN(Z))):P6(Z)?mY():TZ(Z)?vY():T1(Z)?cY(I1($N(Z)),$):pX(Z)?cY(B6([],r8()),$):Q0(Z)?pY():cX(Z)?hY():uX(Z)?dY():Q4(Z)?B$():M8(Z)?S1(Z):I6(Z)?S1(Z):g1(Z)?S1(Z):I1({})}function Nz(Z,$){return R(X5(Z,!0),$)}function Bz(Z,$){return n8(Z)?j8(Z.parameters,$):Q1($)}function Lz(Z,$){if(Q0(Z))throw new Error("Enum undefined or empty");let Y=globalThis.Object.getOwnPropertyNames(Z).filter((J)=>isNaN(J)).map((J)=>Z[J]),W=[...new Set(Y)].map((J)=>S1(J));return C1(W,{...$,[V8]:"Enum"})}class Ez extends a{}var V;(function(Z){Z[Z.Union=0]="Union",Z[Z.True=1]="True",Z[Z.False=2]="False"})(V||(V={}));function P8(Z){return Z===V.False?Z:V.True}function R$(Z){throw new Ez(Z)}function H0(Z){return S.IsNever(Z)||S.IsIntersect(Z)||S.IsUnion(Z)||S.IsUnknown(Z)||S.IsAny(Z)}function M0(Z,$){return S.IsNever($)?Iz(Z,$):S.IsIntersect($)?uY(Z,$):S.IsUnion($)?G5(Z,$):S.IsUnknown($)?kz(Z,$):S.IsAny($)?Q5(Z,$):R$("StructuralRight")}function Q5(Z,$){return V.True}function YN(Z,$){return S.IsIntersect($)?uY(Z,$):S.IsUnion($)&&$.anyOf.some((Y)=>S.IsAny(Y)||S.IsUnknown(Y))?V.True:S.IsUnion($)?V.Union:S.IsUnknown($)?V.True:S.IsAny($)?V.True:V.Union}function XN(Z,$){return S.IsUnknown(Z)?V.False:S.IsAny(Z)?V.Union:S.IsNever(Z)?V.True:V.False}function WN(Z,$){return S.IsObject($)&&iY($)?V.True:H0($)?M0(Z,$):!S.IsArray($)?V.False:P8(b1(Z.items,$.items))}function JN(Z,$){return H0($)?M0(Z,$):!S.IsAsyncIterator($)?V.False:P8(b1(Z.items,$.items))}function zN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsBigInt($)?V.True:V.False}function jz(Z,$){return S.IsLiteralBoolean(Z)?V.True:S.IsBoolean(Z)?V.True:V.False}function QN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsBoolean($)?V.True:V.False}function GN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):!S.IsConstructor($)?V.False:Z.parameters.length>$.parameters.length?V.False:!Z.parameters.every((Y,X)=>P8(b1($.parameters[X],Y))===V.True)?V.False:P8(b1(Z.returns,$.returns))}function UN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsDate($)?V.True:V.False}function HN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):!S.IsFunction($)?V.False:Z.parameters.length>$.parameters.length?V.False:!Z.parameters.every((Y,X)=>P8(b1($.parameters[X],Y))===V.True)?V.False:P8(b1(Z.returns,$.returns))}function Cz(Z,$){return S.IsLiteral(Z)&&C0.IsNumber(Z.const)?V.True:S.IsNumber(Z)||S.IsInteger(Z)?V.True:V.False}function MN(Z,$){return S.IsInteger($)||S.IsNumber($)?V.True:H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):V.False}function uY(Z,$){return $.allOf.every((Y)=>b1(Z,Y)===V.True)?V.True:V.False}function wN(Z,$){return Z.allOf.some((Y)=>b1(Y,$)===V.True)?V.True:V.False}function DN(Z,$){return H0($)?M0(Z,$):!S.IsIterator($)?V.False:P8(b1(Z.items,$.items))}function qN(Z,$){return S.IsLiteral($)&&$.const===Z.const?V.True:H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsString($)?Tz(Z,$):S.IsNumber($)?Pz(Z,$):S.IsInteger($)?Cz(Z,$):S.IsBoolean($)?jz(Z,$):V.False}function Iz(Z,$){return V.False}function AN(Z,$){return V.True}function _z(Z){let[$,Y]=[Z,0];while(!0){if(!S.IsNot($))break;$=$.not,Y+=1}return Y%2===0?$:r8()}function ON(Z,$){return S.IsNot(Z)?b1(_z(Z),$):S.IsNot($)?b1(Z,_z($)):R$("Invalid fallthrough for Not")}function FN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsNull($)?V.True:V.False}function Pz(Z,$){return S.IsLiteralNumber(Z)?V.True:S.IsNumber(Z)||S.IsInteger(Z)?V.True:V.False}function SN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsInteger($)||S.IsNumber($)?V.True:V.False}function r0(Z,$){return Object.getOwnPropertyNames(Z.properties).length===$}function Kz(Z){return iY(Z)}function Rz(Z){return r0(Z,0)||r0(Z,1)&&"description"in Z.properties&&S.IsUnion(Z.properties.description)&&Z.properties.description.anyOf.length===2&&(S.IsString(Z.properties.description.anyOf[0])&&S.IsUndefined(Z.properties.description.anyOf[1])||S.IsString(Z.properties.description.anyOf[1])&&S.IsUndefined(Z.properties.description.anyOf[0]))}function W5(Z){return r0(Z,0)}function Vz(Z){return r0(Z,0)}function NN(Z){return r0(Z,0)}function BN(Z){return r0(Z,0)}function LN(Z){return iY(Z)}function _N(Z){let $=E8();return r0(Z,0)||r0(Z,1)&&"length"in Z.properties&&P8(b1(Z.properties.length,$))===V.True}function KN(Z){return r0(Z,0)}function iY(Z){let $=E8();return r0(Z,0)||r0(Z,1)&&"length"in Z.properties&&P8(b1(Z.properties.length,$))===V.True}function RN(Z){let $=B6([WZ()],WZ());return r0(Z,0)||r0(Z,1)&&"then"in Z.properties&&P8(b1(Z.properties.then,$))===V.True}function xz(Z,$){return b1(Z,$)===V.False?V.False:S.IsOptional(Z)&&!S.IsOptional($)?V.False:V.True}function x0(Z,$){return S.IsUnknown(Z)?V.False:S.IsAny(Z)?V.Union:S.IsNever(Z)||S.IsLiteralString(Z)&&Kz($)||S.IsLiteralNumber(Z)&&W5($)||S.IsLiteralBoolean(Z)&&Vz($)||S.IsSymbol(Z)&&Rz($)||S.IsBigInt(Z)&&NN($)||S.IsString(Z)&&Kz($)||S.IsSymbol(Z)&&Rz($)||S.IsNumber(Z)&&W5($)||S.IsInteger(Z)&&W5($)||S.IsBoolean(Z)&&Vz($)||S.IsUint8Array(Z)&&LN($)||S.IsDate(Z)&&BN($)||S.IsConstructor(Z)&&KN($)||S.IsFunction(Z)&&_N($)?V.True:S.IsRecord(Z)&&S.IsString(J5(Z))?(()=>{return $[V8]==="Record"?V.True:V.False})():S.IsRecord(Z)&&S.IsNumber(J5(Z))?(()=>{return r0($,0)?V.True:V.False})():V.False}function VN(Z,$){return H0($)?M0(Z,$):S.IsRecord($)?x8(Z,$):!S.IsObject($)?V.False:(()=>{for(let Y of Object.getOwnPropertyNames($.properties)){if(!(Y in Z.properties)&&!S.IsOptional($.properties[Y]))return V.False;if(S.IsOptional($.properties[Y]))return V.True;if(xz(Z.properties[Y],$.properties[Y])===V.False)return V.False}return V.True})()}function EN(Z,$){return H0($)?M0(Z,$):S.IsObject($)&&RN($)?V.True:!S.IsPromise($)?V.False:P8(b1(Z.item,$.item))}function J5(Z){return S6 in Z.patternProperties?E8():(N6 in Z.patternProperties)?v0():R$("Unknown record key pattern")}function z5(Z){return S6 in Z.patternProperties?Z.patternProperties[S6]:(N6 in Z.patternProperties)?Z.patternProperties[N6]:R$("Unable to get record value schema")}function x8(Z,$){let[Y,X]=[J5($),z5($)];return S.IsLiteralString(Z)&&S.IsNumber(Y)&&P8(b1(Z,X))===V.True?V.True:S.IsUint8Array(Z)&&S.IsNumber(Y)?b1(Z,X):S.IsString(Z)&&S.IsNumber(Y)?b1(Z,X):S.IsArray(Z)&&S.IsNumber(Y)?b1(Z,X):S.IsObject(Z)?(()=>{for(let W of Object.getOwnPropertyNames(Z.properties))if(xz(X,Z.properties[W])===V.False)return V.False;return V.True})():V.False}function jN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):!S.IsRecord($)?V.False:b1(z5(Z),z5($))}function CN(Z,$){let Y=S.IsRegExp(Z)?v0():Z,X=S.IsRegExp($)?v0():$;return b1(Y,X)}function Tz(Z,$){return S.IsLiteral(Z)&&C0.IsString(Z.const)?V.True:S.IsString(Z)?V.True:V.False}function IN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsString($)?V.True:V.False}function PN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsSymbol($)?V.True:V.False}function xN(Z,$){return S.IsTemplateLiteral(Z)?b1(hZ(Z),$):S.IsTemplateLiteral($)?b1(Z,hZ($)):R$("Invalid fallthrough for TemplateLiteral")}function TN(Z,$){return S.IsArray($)&&Z.items!==void 0&&Z.items.every((Y)=>b1(Y,$.items)===V.True)}function kN(Z,$){return S.IsNever(Z)?V.True:S.IsUnknown(Z)?V.False:S.IsAny(Z)?V.Union:V.False}function bN(Z,$){return H0($)?M0(Z,$):S.IsObject($)&&iY($)?V.True:S.IsArray($)&&TN(Z,$)?V.True:!S.IsTuple($)?V.False:C0.IsUndefined(Z.items)&&!C0.IsUndefined($.items)||!C0.IsUndefined(Z.items)&&C0.IsUndefined($.items)?V.False:C0.IsUndefined(Z.items)&&!C0.IsUndefined($.items)?V.True:Z.items.every((Y,X)=>b1(Y,$.items[X])===V.True)?V.True:V.False}function fN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsUint8Array($)?V.True:V.False}function gN(Z,$){return H0($)?M0(Z,$):S.IsObject($)?x0(Z,$):S.IsRecord($)?x8(Z,$):S.IsVoid($)?hN(Z,$):S.IsUndefined($)?V.True:V.False}function G5(Z,$){return $.anyOf.some((Y)=>b1(Z,Y)===V.True)?V.True:V.False}function yN(Z,$){return Z.anyOf.every((Y)=>b1(Y,$)===V.True)?V.True:V.False}function kz(Z,$){return V.True}function vN(Z,$){return S.IsNever($)?Iz(Z,$):S.IsIntersect($)?uY(Z,$):S.IsUnion($)?G5(Z,$):S.IsAny($)?Q5(Z,$):S.IsString($)?Tz(Z,$):S.IsNumber($)?Pz(Z,$):S.IsInteger($)?Cz(Z,$):S.IsBoolean($)?jz(Z,$):S.IsArray($)?XN(Z,$):S.IsTuple($)?kN(Z,$):S.IsObject($)?x0(Z,$):S.IsUnknown($)?V.True:V.False}function hN(Z,$){return S.IsUndefined(Z)?V.True:S.IsUndefined(Z)?V.True:V.False}function dN(Z,$){return S.IsIntersect($)?uY(Z,$):S.IsUnion($)?G5(Z,$):S.IsUnknown($)?kz(Z,$):S.IsAny($)?Q5(Z,$):S.IsObject($)?x0(Z,$):S.IsVoid($)?V.True:V.False}function b1(Z,$){return S.IsTemplateLiteral(Z)||S.IsTemplateLiteral($)?xN(Z,$):S.IsRegExp(Z)||S.IsRegExp($)?CN(Z,$):S.IsNot(Z)||S.IsNot($)?ON(Z,$):S.IsAny(Z)?YN(Z,$):S.IsArray(Z)?WN(Z,$):S.IsBigInt(Z)?zN(Z,$):S.IsBoolean(Z)?QN(Z,$):S.IsAsyncIterator(Z)?JN(Z,$):S.IsConstructor(Z)?GN(Z,$):S.IsDate(Z)?UN(Z,$):S.IsFunction(Z)?HN(Z,$):S.IsInteger(Z)?MN(Z,$):S.IsIntersect(Z)?wN(Z,$):S.IsIterator(Z)?DN(Z,$):S.IsLiteral(Z)?qN(Z,$):S.IsNever(Z)?AN(Z,$):S.IsNull(Z)?FN(Z,$):S.IsNumber(Z)?SN(Z,$):S.IsObject(Z)?VN(Z,$):S.IsRecord(Z)?jN(Z,$):S.IsString(Z)?IN(Z,$):S.IsSymbol(Z)?PN(Z,$):S.IsTuple(Z)?bN(Z,$):S.IsPromise(Z)?EN(Z,$):S.IsUint8Array(Z)?fN(Z,$):S.IsUndefined(Z)?gN(Z,$):S.IsUnion(Z)?yN(Z,$):S.IsUnknown(Z)?vN(Z,$):S.IsVoid(Z)?dN(Z,$):R$(`Unknown left type operand '${Z[_]}'`)}function zZ(Z,$){return b1(Z,$)}function pN(Z,$,Y,X,W){let J={};for(let z of globalThis.Object.getOwnPropertyNames(Z))J[z]=V$(Z[z],$,Y,X,l1(W));return J}function mN(Z,$,Y,X,W){return pN(Z.properties,$,Y,X,W)}function bz(Z,$,Y,X,W){let J=mN(Z,$,Y,X,W);return K1(J)}function cN(Z,$,Y,X){let W=zZ(Z,$);return W===V.Union?C1([Y,X]):W===V.True?Y:X}function V$(Z,$,Y,X,W){return o1(Z)?bz(Z,$,Y,X,W):q8(Z)?R(fz(Z,$,Y,X,W)):R(cN(Z,$,Y,X),W)}function uN(Z,$,Y,X,W){return{[Z]:V$(S1(Z),$,Y,X,l1(W))}}function iN(Z,$,Y,X,W){return Z.reduce((J,z)=>{return{...J,...uN(z,$,Y,X,W)}},{})}function lN(Z,$,Y,X,W){return iN(Z.keys,$,Y,X,W)}function fz(Z,$,Y,X,W){let J=lN(Z,$,Y,X,W);return K1(J)}function nN(Z){return Z.allOf.every(($)=>h6($))}function oN(Z){return Z.anyOf.some(($)=>h6($))}function tN(Z){return!h6(Z.not)}function h6(Z){return Z[_]==="Intersect"?nN(Z):Z[_]==="Union"?oN(Z):Z[_]==="Not"?tN(Z):Z[_]==="Undefined"?!0:!1}function gz(Z,$){return E$(hZ(Z),$)}function sN(Z,$){let Y=Z.filter((X)=>zZ(X,$)===V.False);return Y.length===1?Y[0]:C1(Y)}function E$(Z,$,Y={}){if(A8(Z))return R(gz(Z,$),Y);if(o1(Z))return R(yz(Z,$),Y);return R(_1(Z)?sN(Z.anyOf,$):zZ(Z,$)!==V.False?Q1():Z,Y)}function rN(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=E$(Z[X],$);return Y}function aN(Z,$){return rN(Z.properties,$)}function yz(Z,$){let Y=aN(Z,$);return K1(Y)}function vz(Z,$){return j$(hZ(Z),$)}function eN(Z,$){let Y=Z.filter((X)=>zZ(X,$)!==V.False);return Y.length===1?Y[0]:C1(Y)}function j$(Z,$,Y){if(A8(Z))return R(vz(Z,$),Y);if(o1(Z))return R(hz(Z,$),Y);return R(_1(Z)?eN(Z.anyOf,$):zZ(Z,$)!==V.False?Z:Q1(),Y)}function ZB(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=j$(Z[X],$);return Y}function $B(Z,$){return ZB(Z.properties,$)}function hz(Z,$){let Y=$B(Z,$);return K1(Y)}function dz(Z,$){return n8(Z)?R(Z.returns,$):Q1($)}function lY(Z){return t0(I0(Z))}function dZ(Z,$,Y){return R({[_]:"Record",type:"object",patternProperties:{[Z]:$}},Y)}function U5(Z,$,Y){let X={};for(let W of Z)X[W]=$;return I1(X,{...Y,[V8]:"Record"})}function YB(Z,$,Y){return TY(Z)?U5(o0(Z),$,Y):dZ(Z.pattern,$,Y)}function XB(Z,$,Y){return U5(o0(C1(Z)),$,Y)}function WB(Z,$,Y){return U5([Z.toString()],$,Y)}function JB(Z,$,Y){return dZ(Z.source,$,Y)}function zB(Z,$,Y){let X=Q0(Z.pattern)?N6:Z.pattern;return dZ(X,$,Y)}function QB(Z,$,Y){return dZ(N6,$,Y)}function GB(Z,$,Y){return dZ(iJ,$,Y)}function UB(Z,$,Y){return I1({true:$,false:$},Y)}function HB(Z,$,Y){return dZ(S6,$,Y)}function MB(Z,$,Y){return dZ(S6,$,Y)}function nY(Z,$,Y={}){return _1(Z)?XB(Z.anyOf,$,Y):A8(Z)?YB(Z,$,Y):D8(Z)?WB(Z.const,$,Y):k6(Z)?UB(Z,$,Y):t8(Z)?HB(Z,$,Y):s8(Z)?MB(Z,$,Y):oX(Z)?JB(Z,$,Y):b6(Z)?zB(Z,$,Y):lX(Z)?QB(Z,$,Y):YZ(Z)?GB(Z,$,Y):Q1(Y)}function oY(Z){return globalThis.Object.getOwnPropertyNames(Z.patternProperties)[0]}function pz(Z){let $=oY(Z);return $===N6?v0():$===S6?E8():v0({pattern:$})}function tY(Z){return Z.patternProperties[oY(Z)]}function wB(Z,$){return $.parameters=B4(Z,$.parameters),$.returns=a8(Z,$.returns),$}function DB(Z,$){return $.parameters=B4(Z,$.parameters),$.returns=a8(Z,$.returns),$}function qB(Z,$){return $.allOf=B4(Z,$.allOf),$}function AB(Z,$){return $.anyOf=B4(Z,$.anyOf),$}function OB(Z,$){if(Q0($.items))return $;return $.items=B4(Z,$.items),$}function FB(Z,$){return $.items=a8(Z,$.items),$}function SB(Z,$){return $.items=a8(Z,$.items),$}function NB(Z,$){return $.items=a8(Z,$.items),$}function BB(Z,$){return $.item=a8(Z,$.item),$}function LB(Z,$){let Y=VB(Z,$.properties);return{...$,...I1(Y)}}function _B(Z,$){let Y=a8(Z,pz($)),X=a8(Z,tY($)),W=nY(Y,X);return{...$,...W}}function KB(Z,$){return $.index in Z?Z[$.index]:r8()}function RB(Z,$){let Y=M$($),X=n0($),W=a8(Z,$);return Y&&X?lY(W):Y&&!X?t0(W):!Y&&X?I0(W):W}function VB(Z,$){return globalThis.Object.getOwnPropertyNames($).reduce((Y,X)=>{return{...Y,[X]:RB(Z,$[X])}},{})}function B4(Z,$){return $.map((Y)=>a8(Z,Y))}function a8(Z,$){return n8($)?wB(Z,$):o8($)?DB(Z,$):e1($)?qB(Z,$):_1($)?AB(Z,$):O8($)?OB(Z,$):i8($)?FB(Z,$):kZ($)?SB(Z,$):fZ($)?NB(Z,$):gZ($)?BB(Z,$):G0($)?LB(Z,$):yZ($)?_B(Z,$):nX($)?KB(Z,$):$}function mz(Z,$){return a8($,U$(Z))}function cz(Z){return R({[_]:"Integer",type:"integer"},Z)}function EB(Z,$,Y){return{[Z]:e8(S1(Z),$,l1(Y))}}function jB(Z,$,Y){return Z.reduce((W,J)=>{return{...W,...EB(J,$,Y)}},{})}function CB(Z,$,Y){return jB(Z.keys,$,Y)}function uz(Z,$,Y){let X=CB(Z,$,Y);return K1(X)}function IB(Z){let[$,Y]=[Z.slice(0,1),Z.slice(1)];return[$.toLowerCase(),Y].join("")}function PB(Z){let[$,Y]=[Z.slice(0,1),Z.slice(1)];return[$.toUpperCase(),Y].join("")}function xB(Z){return Z.toUpperCase()}function TB(Z){return Z.toLowerCase()}function kB(Z,$,Y){let X=S$(Z.pattern);if(!vZ(X))return{...Z,pattern:iz(Z.pattern,$)};let z=[...O4(X)].map((G)=>S1(G)),Q=lz(z,$),U=C1(Q);return bY([U],Y)}function iz(Z,$){return typeof Z==="string"?$==="Uncapitalize"?IB(Z):$==="Capitalize"?PB(Z):$==="Uppercase"?xB(Z):$==="Lowercase"?TB(Z):Z:Z.toString()}function lz(Z,$){return Z.map((Y)=>e8(Y,$))}function e8(Z,$,Y={}){return q8(Z)?uz(Z,$,Y):A8(Z)?kB(Z,$,Y):_1(Z)?C1(lz(Z.anyOf,$),Y):D8(Z)?S1(iz(Z.const,$),Y):R(Z,Y)}function nz(Z,$={}){return e8(Z,"Capitalize",$)}function oz(Z,$={}){return e8(Z,"Lowercase",$)}function tz(Z,$={}){return e8(Z,"Uncapitalize",$)}function sz(Z,$={}){return e8(Z,"Uppercase",$)}function bB(Z,$,Y){let X={};for(let W of globalThis.Object.getOwnPropertyNames(Z))X[W]=QZ(Z[W],$,l1(Y));return X}function fB(Z,$,Y){return bB(Z.properties,$,Y)}function rz(Z,$,Y){let X=fB(Z,$,Y);return K1(X)}function gB(Z,$){return Z.map((Y)=>H5(Y,$))}function yB(Z,$){return Z.map((Y)=>H5(Y,$))}function vB(Z,$){let{[$]:Y,...X}=Z;return X}function hB(Z,$){return $.reduce((Y,X)=>vB(Y,X),Z)}function dB(Z,$){let Y=Z0(Z,[y1,"$id","required","properties"]),X=hB(Z.properties,$);return I1(X,Y)}function pB(Z){let $=Z.reduce((Y,X)=>IY(X)?[...Y,S1(X)]:Y,[]);return C1($)}function H5(Z,$){return e1(Z)?P0(gB(Z.allOf,$)):_1(Z)?C1(yB(Z.anyOf,$)):G0(Z)?dB(Z,$):I1({})}function QZ(Z,$,Y){let X=z0($)?pB($):$,W=r1($)?o0($):$,J=X0(Z),z=X0($);return o1(Z)?rz(Z,W,Y):q8($)?az(Z,$,Y):J&&z?c1("Omit",[Z,X],Y):!J&&z?c1("Omit",[Z,X],Y):J&&!z?c1("Omit",[Z,X],Y):R({...H5(Z,W),...Y})}function mB(Z,$,Y){return{[$]:QZ(Z,[$],l1(Y))}}function cB(Z,$,Y){return $.reduce((X,W)=>{return{...X,...mB(Z,W,Y)}},{})}function uB(Z,$,Y){return cB(Z,$.keys,Y)}function az(Z,$,Y){let X=uB(Z,$,Y);return K1(X)}function iB(Z,$,Y){let X={};for(let W of globalThis.Object.getOwnPropertyNames(Z))X[W]=GZ(Z[W],$,l1(Y));return X}function lB(Z,$,Y){return iB(Z.properties,$,Y)}function ez(Z,$,Y){let X=lB(Z,$,Y);return K1(X)}function nB(Z,$){return Z.map((Y)=>M5(Y,$))}function oB(Z,$){return Z.map((Y)=>M5(Y,$))}function tB(Z,$){let Y={};for(let X of $)if(X in Z)Y[X]=Z[X];return Y}function sB(Z,$){let Y=Z0(Z,[y1,"$id","required","properties"]),X=tB(Z.properties,$);return I1(X,Y)}function rB(Z){let $=Z.reduce((Y,X)=>IY(X)?[...Y,S1(X)]:Y,[]);return C1($)}function M5(Z,$){return e1(Z)?P0(nB(Z.allOf,$)):_1(Z)?C1(oB(Z.anyOf,$)):G0(Z)?sB(Z,$):I1({})}function GZ(Z,$,Y){let X=z0($)?rB($):$,W=r1($)?o0($):$,J=X0(Z),z=X0($);return o1(Z)?ez(Z,W,Y):q8($)?Z2(Z,$,Y):J&&z?c1("Pick",[Z,X],Y):!J&&z?c1("Pick",[Z,X],Y):J&&!z?c1("Pick",[Z,X],Y):R({...M5(Z,W),...Y})}function aB(Z,$,Y){return{[$]:GZ(Z,[$],l1(Y))}}function eB(Z,$,Y){return $.reduce((X,W)=>{return{...X,...aB(Z,W,Y)}},{})}function ZL(Z,$,Y){return eB(Z,$.keys,Y)}function Z2(Z,$,Y){let X=ZL(Z,$,Y);return K1(X)}function $L(Z,$){return c1("Partial",[c1(Z,$)])}function YL(Z){return c1("Partial",[I8(Z)])}function XL(Z){let $={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))$[Y]=I0(Z[Y]);return $}function WL(Z){let $=Z0(Z,[y1,"$id","required","properties"]),Y=XL(Z.properties);return I1(Y,$)}function $2(Z){return Z.map(($)=>Y2($))}function Y2(Z){return l8(Z)?$L(Z.target,Z.parameters):X0(Z)?YL(Z.$ref):e1(Z)?P0($2(Z.allOf)):_1(Z)?C1($2(Z.anyOf)):G0(Z)?WL(Z):bZ(Z)?Z:k6(Z)?Z:t8(Z)?Z:D8(Z)?Z:H4(Z)?Z:s8(Z)?Z:b6(Z)?Z:M4(Z)?Z:f6(Z)?Z:I1({})}function C$(Z,$){if(o1(Z))return X2(Z,$);else return R({...Y2(Z),...$})}function JL(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=C$(Z[X],l1($));return Y}function zL(Z,$){return JL(Z.properties,$)}function X2(Z,$){let Y=zL(Z,$);return K1(Y)}function QL(Z,$){return c1("Required",[c1(Z,$)])}function GL(Z){return c1("Required",[I8(Z)])}function UL(Z){let $={};for(let Y of globalThis.Object.getOwnPropertyNames(Z))$[Y]=Z0(Z[Y],[_0]);return $}function HL(Z){let $=Z0(Z,[y1,"$id","required","properties"]),Y=UL(Z.properties);return I1(Y,$)}function W2(Z){return Z.map(($)=>J2($))}function J2(Z){return l8(Z)?QL(Z.target,Z.parameters):X0(Z)?GL(Z.$ref):e1(Z)?P0(W2(Z.allOf)):_1(Z)?C1(W2(Z.anyOf)):G0(Z)?HL(Z):bZ(Z)?Z:k6(Z)?Z:t8(Z)?Z:D8(Z)?Z:H4(Z)?Z:s8(Z)?Z:b6(Z)?Z:M4(Z)?Z:f6(Z)?Z:I1({})}function I$(Z,$){if(o1(Z))return z2(Z,$);else return R({...J2(Z),...$})}function ML(Z,$){let Y={};for(let X of globalThis.Object.getOwnPropertyNames(Z))Y[X]=I$(Z[X],$);return Y}function wL(Z,$){return ML(Z.properties,$)}function z2(Z,$){let Y=wL(Z,$);return K1(Y)}function DL(Z,$){return $.map((Y)=>{return X0(Y)?w5(Z,Y.$ref):F8(Z,Y)})}function w5(Z,$){return $ in Z?X0(Z[$])?w5(Z,Z[$].$ref):F8(Z,Z[$]):Q1()}function qL(Z){return _$(Z[0])}function AL(Z){return JZ(Z[0],Z[1])}function OL(Z){return K$(Z[0])}function FL(Z){return C$(Z[0])}function SL(Z){return QZ(Z[0],Z[1])}function NL(Z){return GZ(Z[0],Z[1])}function BL(Z){return I$(Z[0])}function LL(Z,$,Y){let X=DL(Z,Y);return $==="Awaited"?qL(X):$==="Index"?AL(X):$==="KeyOf"?OL(X):$==="Partial"?FL(X):$==="Omit"?SL(X):$==="Pick"?NL(X):$==="Required"?BL(X):Q1()}function _L(Z,$){return q$(F8(Z,$))}function KL(Z,$){return A$(F8(Z,$))}function RL(Z,$,Y){return O$(L4(Z,$),F8(Z,Y))}function VL(Z,$,Y){return B6(L4(Z,$),F8(Z,Y))}function EL(Z,$){return P0(L4(Z,$))}function jL(Z,$){return L$(F8(Z,$))}function CL(Z,$){return I1(globalThis.Object.keys($).reduce((Y,X)=>{return{...Y,[X]:F8(Z,$[X])}},{}))}function IL(Z,$){let[Y,X]=[F8(Z,tY($)),oY($)],W=U$($);return W.patternProperties[X]=Y,W}function PL(Z,$){return X0($)?{...w5(Z,$.$ref),[y1]:$[y1]}:$}function xL(Z,$){return j8(L4(Z,$))}function TL(Z,$){return C1(L4(Z,$))}function L4(Z,$){return $.map((Y)=>F8(Z,Y))}function F8(Z,$){return n0($)?R(F8(Z,Z0($,[_0])),$):M$($)?R(F8(Z,Z0($,[u8])),$):j1($)?R(PL(Z,$),$):i8($)?R(_L(Z,$.items),$):kZ($)?R(KL(Z,$.items),$):l8($)?R(LL(Z,$.target,$.parameters)):n8($)?R(RL(Z,$.parameters,$.returns),$):o8($)?R(VL(Z,$.parameters,$.returns),$):e1($)?R(EL(Z,$.allOf),$):fZ($)?R(jL(Z,$.items),$):G0($)?R(CL(Z,$.properties),$):yZ($)?R(IL(Z,$)):O8($)?R(xL(Z,$.items||[]),$):_1($)?R(TL(Z,$.anyOf),$):$}function kL(Z,$){return $ in Z?F8(Z,Z[$]):Q1()}function Q2(Z){return globalThis.Object.getOwnPropertyNames(Z).reduce(($,Y)=>{return{...$,[Y]:kL(Z,Y)}},{})}class G2{constructor(Z){let $=Q2(Z),Y=this.WithIdentifiers($);this.$defs=Y}Import(Z,$){let Y={...this.$defs,[Z]:R(this.$defs[Z],$)};return R({[_]:"Import",$defs:Y,$ref:Z})}WithIdentifiers(Z){return globalThis.Object.getOwnPropertyNames(Z).reduce(($,Y)=>{return{...$,[Y]:{...Z[Y],$id:Y}}},{})}}function U2(Z){return new G2(Z)}function H2(Z,$){return R({[_]:"Not",not:Z},$)}function M2(Z,$){return o8(Z)?j8(Z.parameters,$):Q1()}var bL=0;function w2(Z,$={}){if(Q0($.$id))$.$id=`T${bL++}`;let Y=U$(Z({[_]:"This",$ref:`${$.$id}`}));return Y.$id=$.$id,R({[V8]:"Recursive",...Y},$)}function D2(Z,$){let Y=g1(Z)?new globalThis.RegExp(Z):Z;return R({[_]:"RegExp",type:"RegExp",source:Y.source,flags:Y.flags},$)}function fL(Z){return e1(Z)?Z.allOf:_1(Z)?Z.anyOf:O8(Z)?Z.items??[]:[]}function q2(Z){return fL(Z)}function A2(Z,$){return o8(Z)?R(Z.returns,$):Q1($)}class O2{constructor(Z){this.schema=Z}Decode(Z){return new F2(this.schema,Z)}}class F2{constructor(Z,$){this.schema=Z,this.decode=$}EncodeTransform(Z,$){let W={Encode:(J)=>$[y1].Encode(Z(J)),Decode:(J)=>this.decode($[y1].Decode(J))};return{...$,[y1]:W}}EncodeSchema(Z,$){let Y={Decode:this.decode,Encode:Z};return{...$,[y1]:Y}}Encode(Z){return j1(this.schema)?this.EncodeTransform(Z,this.schema):this.EncodeSchema(Z,this.schema)}}function S2(Z){return new O2(Z)}function sY(Z={}){return R({[_]:Z[_]??"Unsafe"},Z)}function N2(Z){return R({[_]:"Void",type:"void"},Z)}var D5={};ZZ(D5,{Void:()=>N2,Uppercase:()=>sz,Unsafe:()=>sY,Unknown:()=>r8,Union:()=>C1,Undefined:()=>pY,Uncapitalize:()=>tz,Uint8Array:()=>mY,Tuple:()=>j8,Transform:()=>S2,TemplateLiteral:()=>bY,Symbol:()=>dY,String:()=>v0,ReturnType:()=>A2,Rest:()=>q2,Required:()=>I$,RegExp:()=>D2,Ref:()=>I8,Recursive:()=>w2,Record:()=>nY,ReadonlyOptional:()=>lY,Readonly:()=>t0,Promise:()=>gY,Pick:()=>GZ,Partial:()=>C$,Parameters:()=>M2,Optional:()=>I0,Omit:()=>QZ,Object:()=>I1,Number:()=>E8,Null:()=>hY,Not:()=>H2,Never:()=>Q1,Module:()=>U2,Mapped:()=>wz,Lowercase:()=>oz,Literal:()=>S1,KeyOf:()=>K$,Iterator:()=>L$,Intersect:()=>P0,Integer:()=>cz,Instantiate:()=>mz,InstanceType:()=>dz,Index:()=>JZ,Function:()=>B6,Extract:()=>j$,Extends:()=>V$,Exclude:()=>E$,Enum:()=>Lz,Date:()=>vY,ConstructorParameters:()=>Bz,Constructor:()=>O$,Const:()=>Nz,Composite:()=>Sz,Capitalize:()=>nz,Boolean:()=>kY,BigInt:()=>B$,Awaited:()=>_$,AsyncIterator:()=>A$,Array:()=>q$,Argument:()=>sJ,Any:()=>WZ});var UZ=D5;function gL(Z){switch(Z.errorType){case K.ArrayContains:return"Expected array to contain at least one matching value";case K.ArrayMaxContains:return`Expected array to contain no more than ${Z.schema.maxContains} matching values`;case K.ArrayMinContains:return`Expected array to contain at least ${Z.schema.minContains} matching values`;case K.ArrayMaxItems:return`Expected array length to be less or equal to ${Z.schema.maxItems}`;case K.ArrayMinItems:return`Expected array length to be greater or equal to ${Z.schema.minItems}`;case K.ArrayUniqueItems:return"Expected array elements to be unique";case K.Array:return"Expected array";case K.AsyncIterator:return"Expected AsyncIterator";case K.BigIntExclusiveMaximum:return`Expected bigint to be less than ${Z.schema.exclusiveMaximum}`;case K.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${Z.schema.exclusiveMinimum}`;case K.BigIntMaximum:return`Expected bigint to be less or equal to ${Z.schema.maximum}`;case K.BigIntMinimum:return`Expected bigint to be greater or equal to ${Z.schema.minimum}`;case K.BigIntMultipleOf:return`Expected bigint to be a multiple of ${Z.schema.multipleOf}`;case K.BigInt:return"Expected bigint";case K.Boolean:return"Expected boolean";case K.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${Z.schema.exclusiveMinimumTimestamp}`;case K.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${Z.schema.exclusiveMaximumTimestamp}`;case K.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${Z.schema.minimumTimestamp}`;case K.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${Z.schema.maximumTimestamp}`;case K.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${Z.schema.multipleOfTimestamp}`;case K.Date:return"Expected Date";case K.Function:return"Expected function";case K.IntegerExclusiveMaximum:return`Expected integer to be less than ${Z.schema.exclusiveMaximum}`;case K.IntegerExclusiveMinimum:return`Expected integer to be greater than ${Z.schema.exclusiveMinimum}`;case K.IntegerMaximum:return`Expected integer to be less or equal to ${Z.schema.maximum}`;case K.IntegerMinimum:return`Expected integer to be greater or equal to ${Z.schema.minimum}`;case K.IntegerMultipleOf:return`Expected integer to be a multiple of ${Z.schema.multipleOf}`;case K.Integer:return"Expected integer";case K.IntersectUnevaluatedProperties:return"Unexpected property";case K.Intersect:return"Expected all values to match";case K.Iterator:return"Expected Iterator";case K.Literal:return`Expected ${typeof Z.schema.const==="string"?`'${Z.schema.const}'`:Z.schema.const}`;case K.Never:return"Never";case K.Not:return"Value should not match";case K.Null:return"Expected null";case K.NumberExclusiveMaximum:return`Expected number to be less than ${Z.schema.exclusiveMaximum}`;case K.NumberExclusiveMinimum:return`Expected number to be greater than ${Z.schema.exclusiveMinimum}`;case K.NumberMaximum:return`Expected number to be less or equal to ${Z.schema.maximum}`;case K.NumberMinimum:return`Expected number to be greater or equal to ${Z.schema.minimum}`;case K.NumberMultipleOf:return`Expected number to be a multiple of ${Z.schema.multipleOf}`;case K.Number:return"Expected number";case K.Object:return"Expected object";case K.ObjectAdditionalProperties:return"Unexpected property";case K.ObjectMaxProperties:return`Expected object to have no more than ${Z.schema.maxProperties} properties`;case K.ObjectMinProperties:return`Expected object to have at least ${Z.schema.minProperties} properties`;case K.ObjectRequiredProperty:return"Expected required property";case K.Promise:return"Expected Promise";case K.RegExp:return"Expected string to match regular expression";case K.StringFormatUnknown:return`Unknown format '${Z.schema.format}'`;case K.StringFormat:return`Expected string to match '${Z.schema.format}' format`;case K.StringMaxLength:return`Expected string length less or equal to ${Z.schema.maxLength}`;case K.StringMinLength:return`Expected string length greater or equal to ${Z.schema.minLength}`;case K.StringPattern:return`Expected string to match '${Z.schema.pattern}'`;case K.String:return"Expected string";case K.Symbol:return"Expected symbol";case K.TupleLength:return`Expected tuple to have ${Z.schema.maxItems||0} elements`;case K.Tuple:return"Expected tuple";case K.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${Z.schema.maxByteLength}`;case K.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${Z.schema.minByteLength}`;case K.Uint8Array:return"Expected Uint8Array";case K.Undefined:return"Expected undefined";case K.Union:return"Expected union value";case K.Void:return"Expected void";case K.Kind:return`Expected kind '${Z.schema[_]}'`;default:return"Unknown error type"}}var yL=gL;function B2(){return yL}class L2 extends a{constructor(Z){super(`Unable to dereference schema with $id '${Z.$ref}'`);this.schema=Z}}function vL(Z,$){let Y=$.find((X)=>X.$id===Z.$ref);if(Y===void 0)throw new L2(Z);return R1(Y,$)}function F0(Z,$){if(!L1(Z.$id)||$.some((Y)=>Y.$id===Z.$id))return $;return $.push(Z),$}function R1(Z,$){return Z[_]==="This"||Z[_]==="Ref"?vL(Z,$):Z}class _2 extends a{constructor(Z){super("Unable to hash value");this.value=Z}}var S8;(function(Z){Z[Z.Undefined=0]="Undefined",Z[Z.Null=1]="Null",Z[Z.Boolean=2]="Boolean",Z[Z.Number=3]="Number",Z[Z.String=4]="String",Z[Z.Object=5]="Object",Z[Z.Array=6]="Array",Z[Z.Date=7]="Date",Z[Z.Uint8Array=8]="Uint8Array",Z[Z.Symbol=9]="Symbol",Z[Z.BigInt=10]="BigInt"})(S8||(S8={}));var P$=BigInt("14695981039346656037"),[hL,dL]=[BigInt("1099511628211"),BigInt("18446744073709551616")],pL=Array.from({length:256}).map((Z,$)=>BigInt($)),K2=new Float64Array(1),R2=new DataView(K2.buffer),V2=new Uint8Array(K2.buffer);function*mL(Z){let $=Z===0?1:Math.ceil(Math.floor(Math.log2(Z)+1)/8);for(let Y=0;Y<$;Y++)yield Z>>8*($-1-Y)&255}function cL(Z){T0(S8.Array);for(let $ of Z)x$($)}function uL(Z){T0(S8.Boolean),T0(Z?1:0)}function iL(Z){T0(S8.BigInt),R2.setBigInt64(0,Z);for(let $ of V2)T0($)}function lL(Z){T0(S8.Date),x$(Z.getTime())}function nL(Z){T0(S8.Null)}function oL(Z){T0(S8.Number),R2.setFloat64(0,Z);for(let $ of V2)T0($)}function tL(Z){T0(S8.Object);for(let $ of globalThis.Object.getOwnPropertyNames(Z).sort())x$($),x$(Z[$])}function sL(Z){T0(S8.String);for(let $=0;$<Z.length;$++)for(let Y of mL(Z.charCodeAt($)))T0(Y)}function rL(Z){T0(S8.Symbol),x$(Z.description)}function aL(Z){T0(S8.Uint8Array);for(let $=0;$<Z.length;$++)T0(Z[$])}function eL(Z){return T0(S8.Undefined)}function x$(Z){if(Z1(Z))return cL(Z);if(F6(Z))return uL(Z);if(L0(Z))return iL(Z);if(y0(Z))return lL(Z);if(x6(Z))return nL(Z);if(r(Z))return oL(Z);if(U1(Z))return tL(Z);if(L1(Z))return sL(Z);if(T6(Z))return rL(Z);if(H$(Z))return aL(Z);if(n1(Z))return eL(Z);throw new _2(Z)}function T0(Z){P$=P$^pL[Z],P$=P$*hL%dL}function HZ(Z){return P$=BigInt("14695981039346656037"),x$(Z),P$}class E2 extends a{constructor(Z){super("Unknown type");this.schema=Z}}function Z_(Z){return Z[_]==="Any"||Z[_]==="Unknown"}function A1(Z){return Z!==void 0}function $_(Z,$,Y){return!0}function Y_(Z,$,Y){return!0}function X_(Z,$,Y){if(!Z1(Y))return!1;if(A1(Z.minItems)&&!(Y.length>=Z.minItems))return!1;if(A1(Z.maxItems)&&!(Y.length<=Z.maxItems))return!1;if(!Y.every((J)=>S0(Z.items,$,J)))return!1;if(Z.uniqueItems===!0&&!function(){let J=new Set;for(let z of Y){let Q=HZ(z);if(J.has(Q))return!1;else J.add(Q)}return!0}())return!1;if(!(A1(Z.contains)||r(Z.minContains)||r(Z.maxContains)))return!0;let X=A1(Z.contains)?Z.contains:Q1(),W=Y.reduce((J,z)=>S0(X,$,z)?J+1:J,0);if(W===0)return!1;if(r(Z.minContains)&&W<Z.minContains)return!1;if(r(Z.maxContains)&&W>Z.maxContains)return!1;return!0}function W_(Z,$,Y){return VY(Y)}function J_(Z,$,Y){if(!L0(Y))return!1;if(A1(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))return!1;if(A1(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))return!1;if(A1(Z.maximum)&&!(Y<=Z.maximum))return!1;if(A1(Z.minimum)&&!(Y>=Z.minimum))return!1;if(A1(Z.multipleOf)&&Y%Z.multipleOf!==BigInt(0))return!1;return!0}function z_(Z,$,Y){return F6(Y)}function Q_(Z,$,Y){return S0(Z.returns,$,Y.prototype)}function G_(Z,$,Y){if(!y0(Y))return!1;if(A1(Z.exclusiveMaximumTimestamp)&&!(Y.getTime()<Z.exclusiveMaximumTimestamp))return!1;if(A1(Z.exclusiveMinimumTimestamp)&&!(Y.getTime()>Z.exclusiveMinimumTimestamp))return!1;if(A1(Z.maximumTimestamp)&&!(Y.getTime()<=Z.maximumTimestamp))return!1;if(A1(Z.minimumTimestamp)&&!(Y.getTime()>=Z.minimumTimestamp))return!1;if(A1(Z.multipleOfTimestamp)&&Y.getTime()%Z.multipleOfTimestamp!==0)return!1;return!0}function U_(Z,$,Y){return $Z(Y)}function H_(Z,$,Y){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return S0(W,[...$,...X],Y)}function M_(Z,$,Y){if(!CY(Y))return!1;if(A1(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))return!1;if(A1(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))return!1;if(A1(Z.maximum)&&!(Y<=Z.maximum))return!1;if(A1(Z.minimum)&&!(Y>=Z.minimum))return!1;if(A1(Z.multipleOf)&&Y%Z.multipleOf!==0)return!1;return!0}function w_(Z,$,Y){let X=Z.allOf.every((W)=>S0(W,$,Y));if(Z.unevaluatedProperties===!1){let W=new RegExp(v6(Z)),J=Object.getOwnPropertyNames(Y).every((z)=>W.test(z));return X&&J}else if(r1(Z.unevaluatedProperties)){let W=new RegExp(v6(Z)),J=Object.getOwnPropertyNames(Y).every((z)=>W.test(z)||S0(Z.unevaluatedProperties,$,Y[z]));return X&&J}else return X}function D_(Z,$,Y){return EY(Y)}function q_(Z,$,Y){return Y===Z.const}function A_(Z,$,Y){return!1}function O_(Z,$,Y){return!S0(Z.not,$,Y)}function F_(Z,$,Y){return x6(Y)}function S_(Z,$,Y){if(!m1.IsNumberLike(Y))return!1;if(A1(Z.exclusiveMaximum)&&!(Y<Z.exclusiveMaximum))return!1;if(A1(Z.exclusiveMinimum)&&!(Y>Z.exclusiveMinimum))return!1;if(A1(Z.minimum)&&!(Y>=Z.minimum))return!1;if(A1(Z.maximum)&&!(Y<=Z.maximum))return!1;if(A1(Z.multipleOf)&&Y%Z.multipleOf!==0)return!1;return!0}function N_(Z,$,Y){if(!m1.IsObjectLike(Y))return!1;if(A1(Z.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=Z.minProperties))return!1;if(A1(Z.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=Z.maxProperties))return!1;let X=Object.getOwnPropertyNames(Z.properties);for(let W of X){let J=Z.properties[W];if(Z.required&&Z.required.includes(W)){if(!S0(J,$,Y[W]))return!1;if((h6(J)||Z_(J))&&!(W in Y))return!1}else if(m1.IsExactOptionalProperty(Y,W)&&!S0(J,$,Y[W]))return!1}if(Z.additionalProperties===!1){let W=Object.getOwnPropertyNames(Y);if(Z.required&&Z.required.length===X.length&&W.length===X.length)return!0;else return W.every((J)=>X.includes(J))}else if(typeof Z.additionalProperties==="object")return Object.getOwnPropertyNames(Y).every((J)=>X.includes(J)||S0(Z.additionalProperties,$,Y[J]));else return!0}function B_(Z,$,Y){return jY(Y)}function L_(Z,$,Y){if(!m1.IsRecordLike(Y))return!1;if(A1(Z.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=Z.minProperties))return!1;if(A1(Z.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=Z.maxProperties))return!1;let[X,W]=Object.entries(Z.patternProperties)[0],J=new RegExp(X),z=Object.entries(Y).every(([G,H])=>{return J.test(G)?S0(W,$,H):!0}),Q=typeof Z.additionalProperties==="object"?Object.entries(Y).every(([G,H])=>{return!J.test(G)?S0(Z.additionalProperties,$,H):!0}):!0,U=Z.additionalProperties===!1?Object.getOwnPropertyNames(Y).every((G)=>{return J.test(G)}):!0;return z&&Q&&U}function __(Z,$,Y){return S0(R1(Z,$),$,Y)}function K_(Z,$,Y){let X=new RegExp(Z.source,Z.flags);if(A1(Z.minLength)){if(!(Y.length>=Z.minLength))return!1}if(A1(Z.maxLength)){if(!(Y.length<=Z.maxLength))return!1}return X.test(Y)}function R_(Z,$,Y){if(!L1(Y))return!1;if(A1(Z.minLength)){if(!(Y.length>=Z.minLength))return!1}if(A1(Z.maxLength)){if(!(Y.length<=Z.maxLength))return!1}if(A1(Z.pattern)){if(!new RegExp(Z.pattern).test(Y))return!1}if(A1(Z.format)){if(!x1.Has(Z.format))return!1;return x1.Get(Z.format)(Y)}return!0}function V_(Z,$,Y){return T6(Y)}function E_(Z,$,Y){return L1(Y)&&new RegExp(Z.pattern).test(Y)}function j_(Z,$,Y){return S0(R1(Z,$),$,Y)}function C_(Z,$,Y){if(!Z1(Y))return!1;if(Z.items===void 0&&Y.length!==0)return!1;if(Y.length!==Z.maxItems)return!1;if(!Z.items)return!0;for(let X=0;X<Z.items.length;X++)if(!S0(Z.items[X],$,Y[X]))return!1;return!0}function I_(Z,$,Y){return n1(Y)}function P_(Z,$,Y){return Z.anyOf.some((X)=>S0(X,$,Y))}function x_(Z,$,Y){if(!H$(Y))return!1;if(A1(Z.maxByteLength)&&!(Y.length<=Z.maxByteLength))return!1;if(A1(Z.minByteLength)&&!(Y.length>=Z.minByteLength))return!1;return!0}function T_(Z,$,Y){return!0}function k_(Z,$,Y){return m1.IsVoidLike(Y)}function b_(Z,$,Y){if(!U0.Has(Z[_]))return!1;return U0.Get(Z[_])(Z,Y)}function S0(Z,$,Y){let X=A1(Z.$id)?F0(Z,$):$,W=Z;switch(W[_]){case"Any":return $_(W,X,Y);case"Argument":return Y_(W,X,Y);case"Array":return X_(W,X,Y);case"AsyncIterator":return W_(W,X,Y);case"BigInt":return J_(W,X,Y);case"Boolean":return z_(W,X,Y);case"Constructor":return Q_(W,X,Y);case"Date":return G_(W,X,Y);case"Function":return U_(W,X,Y);case"Import":return H_(W,X,Y);case"Integer":return M_(W,X,Y);case"Intersect":return w_(W,X,Y);case"Iterator":return D_(W,X,Y);case"Literal":return q_(W,X,Y);case"Never":return A_(W,X,Y);case"Not":return O_(W,X,Y);case"Null":return F_(W,X,Y);case"Number":return S_(W,X,Y);case"Object":return N_(W,X,Y);case"Promise":return B_(W,X,Y);case"Record":return L_(W,X,Y);case"Ref":return __(W,X,Y);case"RegExp":return K_(W,X,Y);case"String":return R_(W,X,Y);case"Symbol":return V_(W,X,Y);case"TemplateLiteral":return E_(W,X,Y);case"This":return j_(W,X,Y);case"Tuple":return C_(W,X,Y);case"Undefined":return I_(W,X,Y);case"Union":return P_(W,X,Y);case"Uint8Array":return x_(W,X,Y);case"Unknown":return T_(W,X,Y);case"Void":return k_(W,X,Y);default:if(!U0.Has(W[_]))throw new E2(W);return b_(W,X,Y)}}function M1(...Z){return Z.length===3?S0(Z[0],Z[1],Z[2]):S0(Z[0],[],Z[1])}var K;(function(Z){Z[Z.ArrayContains=0]="ArrayContains",Z[Z.ArrayMaxContains=1]="ArrayMaxContains",Z[Z.ArrayMaxItems=2]="ArrayMaxItems",Z[Z.ArrayMinContains=3]="ArrayMinContains",Z[Z.ArrayMinItems=4]="ArrayMinItems",Z[Z.ArrayUniqueItems=5]="ArrayUniqueItems",Z[Z.Array=6]="Array",Z[Z.AsyncIterator=7]="AsyncIterator",Z[Z.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",Z[Z.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",Z[Z.BigIntMaximum=10]="BigIntMaximum",Z[Z.BigIntMinimum=11]="BigIntMinimum",Z[Z.BigIntMultipleOf=12]="BigIntMultipleOf",Z[Z.BigInt=13]="BigInt",Z[Z.Boolean=14]="Boolean",Z[Z.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",Z[Z.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",Z[Z.DateMaximumTimestamp=17]="DateMaximumTimestamp",Z[Z.DateMinimumTimestamp=18]="DateMinimumTimestamp",Z[Z.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",Z[Z.Date=20]="Date",Z[Z.Function=21]="Function",Z[Z.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",Z[Z.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",Z[Z.IntegerMaximum=24]="IntegerMaximum",Z[Z.IntegerMinimum=25]="IntegerMinimum",Z[Z.IntegerMultipleOf=26]="IntegerMultipleOf",Z[Z.Integer=27]="Integer",Z[Z.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",Z[Z.Intersect=29]="Intersect",Z[Z.Iterator=30]="Iterator",Z[Z.Kind=31]="Kind",Z[Z.Literal=32]="Literal",Z[Z.Never=33]="Never",Z[Z.Not=34]="Not",Z[Z.Null=35]="Null",Z[Z.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",Z[Z.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",Z[Z.NumberMaximum=38]="NumberMaximum",Z[Z.NumberMinimum=39]="NumberMinimum",Z[Z.NumberMultipleOf=40]="NumberMultipleOf",Z[Z.Number=41]="Number",Z[Z.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",Z[Z.ObjectMaxProperties=43]="ObjectMaxProperties",Z[Z.ObjectMinProperties=44]="ObjectMinProperties",Z[Z.ObjectRequiredProperty=45]="ObjectRequiredProperty",Z[Z.Object=46]="Object",Z[Z.Promise=47]="Promise",Z[Z.RegExp=48]="RegExp",Z[Z.StringFormatUnknown=49]="StringFormatUnknown",Z[Z.StringFormat=50]="StringFormat",Z[Z.StringMaxLength=51]="StringMaxLength",Z[Z.StringMinLength=52]="StringMinLength",Z[Z.StringPattern=53]="StringPattern",Z[Z.String=54]="String",Z[Z.Symbol=55]="Symbol",Z[Z.TupleLength=56]="TupleLength",Z[Z.Tuple=57]="Tuple",Z[Z.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",Z[Z.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",Z[Z.Uint8Array=60]="Uint8Array",Z[Z.Undefined=61]="Undefined",Z[Z.Union=62]="Union",Z[Z.Void=63]="Void"})(K||(K={}));class j2 extends a{constructor(Z){super("Unknown type");this.schema=Z}}function d6(Z){return Z.replace(/~/g,"~0").replace(/\//g,"~1")}function O1(Z){return Z!==void 0}class pZ{constructor(Z){this.iterator=Z}[Symbol.iterator](){return this.iterator}First(){let Z=this.iterator.next();return Z.done?void 0:Z.value}}function d(Z,$,Y,X,W=[]){return{type:Z,schema:$,path:Y,value:X,message:B2()({errorType:Z,path:Y,schema:$,value:X,errors:W}),errors:W}}function*f_(Z,$,Y,X){}function*g_(Z,$,Y,X){}function*y_(Z,$,Y,X){if(!Z1(X))return yield d(K.Array,Z,Y,X);if(O1(Z.minItems)&&!(X.length>=Z.minItems))yield d(K.ArrayMinItems,Z,Y,X);if(O1(Z.maxItems)&&!(X.length<=Z.maxItems))yield d(K.ArrayMaxItems,Z,Y,X);for(let z=0;z<X.length;z++)yield*N0(Z.items,$,`${Y}/${z}`,X[z]);if(Z.uniqueItems===!0&&!function(){let z=new Set;for(let Q of X){let U=HZ(Q);if(z.has(U))return!1;else z.add(U)}return!0}())yield d(K.ArrayUniqueItems,Z,Y,X);if(!(O1(Z.contains)||O1(Z.minContains)||O1(Z.maxContains)))return;let W=O1(Z.contains)?Z.contains:Q1(),J=X.reduce((z,Q,U)=>N0(W,$,`${Y}${U}`,Q).next().done===!0?z+1:z,0);if(J===0)yield d(K.ArrayContains,Z,Y,X);if(r(Z.minContains)&&J<Z.minContains)yield d(K.ArrayMinContains,Z,Y,X);if(r(Z.maxContains)&&J>Z.maxContains)yield d(K.ArrayMaxContains,Z,Y,X)}function*v_(Z,$,Y,X){if(!VY(X))yield d(K.AsyncIterator,Z,Y,X)}function*h_(Z,$,Y,X){if(!L0(X))return yield d(K.BigInt,Z,Y,X);if(O1(Z.exclusiveMaximum)&&!(X<Z.exclusiveMaximum))yield d(K.BigIntExclusiveMaximum,Z,Y,X);if(O1(Z.exclusiveMinimum)&&!(X>Z.exclusiveMinimum))yield d(K.BigIntExclusiveMinimum,Z,Y,X);if(O1(Z.maximum)&&!(X<=Z.maximum))yield d(K.BigIntMaximum,Z,Y,X);if(O1(Z.minimum)&&!(X>=Z.minimum))yield d(K.BigIntMinimum,Z,Y,X);if(O1(Z.multipleOf)&&X%Z.multipleOf!==BigInt(0))yield d(K.BigIntMultipleOf,Z,Y,X)}function*d_(Z,$,Y,X){if(!F6(X))yield d(K.Boolean,Z,Y,X)}function*p_(Z,$,Y,X){yield*N0(Z.returns,$,Y,X.prototype)}function*m_(Z,$,Y,X){if(!y0(X))return yield d(K.Date,Z,Y,X);if(O1(Z.exclusiveMaximumTimestamp)&&!(X.getTime()<Z.exclusiveMaximumTimestamp))yield d(K.DateExclusiveMaximumTimestamp,Z,Y,X);if(O1(Z.exclusiveMinimumTimestamp)&&!(X.getTime()>Z.exclusiveMinimumTimestamp))yield d(K.DateExclusiveMinimumTimestamp,Z,Y,X);if(O1(Z.maximumTimestamp)&&!(X.getTime()<=Z.maximumTimestamp))yield d(K.DateMaximumTimestamp,Z,Y,X);if(O1(Z.minimumTimestamp)&&!(X.getTime()>=Z.minimumTimestamp))yield d(K.DateMinimumTimestamp,Z,Y,X);if(O1(Z.multipleOfTimestamp)&&X.getTime()%Z.multipleOfTimestamp!==0)yield d(K.DateMultipleOfTimestamp,Z,Y,X)}function*c_(Z,$,Y,X){if(!$Z(X))yield d(K.Function,Z,Y,X)}function*u_(Z,$,Y,X){let W=globalThis.Object.values(Z.$defs),J=Z.$defs[Z.$ref];yield*N0(J,[...$,...W],Y,X)}function*i_(Z,$,Y,X){if(!CY(X))return yield d(K.Integer,Z,Y,X);if(O1(Z.exclusiveMaximum)&&!(X<Z.exclusiveMaximum))yield d(K.IntegerExclusiveMaximum,Z,Y,X);if(O1(Z.exclusiveMinimum)&&!(X>Z.exclusiveMinimum))yield d(K.IntegerExclusiveMinimum,Z,Y,X);if(O1(Z.maximum)&&!(X<=Z.maximum))yield d(K.IntegerMaximum,Z,Y,X);if(O1(Z.minimum)&&!(X>=Z.minimum))yield d(K.IntegerMinimum,Z,Y,X);if(O1(Z.multipleOf)&&X%Z.multipleOf!==0)yield d(K.IntegerMultipleOf,Z,Y,X)}function*l_(Z,$,Y,X){let W=!1;for(let J of Z.allOf)for(let z of N0(J,$,Y,X))W=!0,yield z;if(W)return yield d(K.Intersect,Z,Y,X);if(Z.unevaluatedProperties===!1){let J=new RegExp(v6(Z));for(let z of Object.getOwnPropertyNames(X))if(!J.test(z))yield d(K.IntersectUnevaluatedProperties,Z,`${Y}/${z}`,X)}if(typeof Z.unevaluatedProperties==="object"){let J=new RegExp(v6(Z));for(let z of Object.getOwnPropertyNames(X))if(!J.test(z)){let Q=N0(Z.unevaluatedProperties,$,`${Y}/${z}`,X[z]).next();if(!Q.done)yield Q.value}}}function*n_(Z,$,Y,X){if(!EY(X))yield d(K.Iterator,Z,Y,X)}function*o_(Z,$,Y,X){if(X!==Z.const)yield d(K.Literal,Z,Y,X)}function*t_(Z,$,Y,X){yield d(K.Never,Z,Y,X)}function*s_(Z,$,Y,X){if(N0(Z.not,$,Y,X).next().done===!0)yield d(K.Not,Z,Y,X)}function*r_(Z,$,Y,X){if(!x6(X))yield d(K.Null,Z,Y,X)}function*a_(Z,$,Y,X){if(!m1.IsNumberLike(X))return yield d(K.Number,Z,Y,X);if(O1(Z.exclusiveMaximum)&&!(X<Z.exclusiveMaximum))yield d(K.NumberExclusiveMaximum,Z,Y,X);if(O1(Z.exclusiveMinimum)&&!(X>Z.exclusiveMinimum))yield d(K.NumberExclusiveMinimum,Z,Y,X);if(O1(Z.maximum)&&!(X<=Z.maximum))yield d(K.NumberMaximum,Z,Y,X);if(O1(Z.minimum)&&!(X>=Z.minimum))yield d(K.NumberMinimum,Z,Y,X);if(O1(Z.multipleOf)&&X%Z.multipleOf!==0)yield d(K.NumberMultipleOf,Z,Y,X)}function*e_(Z,$,Y,X){if(!m1.IsObjectLike(X))return yield d(K.Object,Z,Y,X);if(O1(Z.minProperties)&&!(Object.getOwnPropertyNames(X).length>=Z.minProperties))yield d(K.ObjectMinProperties,Z,Y,X);if(O1(Z.maxProperties)&&!(Object.getOwnPropertyNames(X).length<=Z.maxProperties))yield d(K.ObjectMaxProperties,Z,Y,X);let W=Array.isArray(Z.required)?Z.required:[],J=Object.getOwnPropertyNames(Z.properties),z=Object.getOwnPropertyNames(X);for(let Q of W){if(z.includes(Q))continue;yield d(K.ObjectRequiredProperty,Z.properties[Q],`${Y}/${d6(Q)}`,void 0)}if(Z.additionalProperties===!1){for(let Q of z)if(!J.includes(Q))yield d(K.ObjectAdditionalProperties,Z,`${Y}/${d6(Q)}`,X[Q])}if(typeof Z.additionalProperties==="object")for(let Q of z){if(J.includes(Q))continue;yield*N0(Z.additionalProperties,$,`${Y}/${d6(Q)}`,X[Q])}for(let Q of J){let U=Z.properties[Q];if(Z.required&&Z.required.includes(Q)){if(yield*N0(U,$,`${Y}/${d6(Q)}`,X[Q]),h6(Z)&&!(Q in X))yield d(K.ObjectRequiredProperty,U,`${Y}/${d6(Q)}`,void 0)}else if(m1.IsExactOptionalProperty(X,Q))yield*N0(U,$,`${Y}/${d6(Q)}`,X[Q])}}function*ZK(Z,$,Y,X){if(!jY(X))yield d(K.Promise,Z,Y,X)}function*$K(Z,$,Y,X){if(!m1.IsRecordLike(X))return yield d(K.Object,Z,Y,X);if(O1(Z.minProperties)&&!(Object.getOwnPropertyNames(X).length>=Z.minProperties))yield d(K.ObjectMinProperties,Z,Y,X);if(O1(Z.maxProperties)&&!(Object.getOwnPropertyNames(X).length<=Z.maxProperties))yield d(K.ObjectMaxProperties,Z,Y,X);let[W,J]=Object.entries(Z.patternProperties)[0],z=new RegExp(W);for(let[Q,U]of Object.entries(X))if(z.test(Q))yield*N0(J,$,`${Y}/${d6(Q)}`,U);if(typeof Z.additionalProperties==="object"){for(let[Q,U]of Object.entries(X))if(!z.test(Q))yield*N0(Z.additionalProperties,$,`${Y}/${d6(Q)}`,U)}if(Z.additionalProperties===!1)for(let[Q,U]of Object.entries(X)){if(z.test(Q))continue;return yield d(K.ObjectAdditionalProperties,Z,`${Y}/${d6(Q)}`,U)}}function*YK(Z,$,Y,X){yield*N0(R1(Z,$),$,Y,X)}function*XK(Z,$,Y,X){if(!L1(X))return yield d(K.String,Z,Y,X);if(O1(Z.minLength)&&!(X.length>=Z.minLength))yield d(K.StringMinLength,Z,Y,X);if(O1(Z.maxLength)&&!(X.length<=Z.maxLength))yield d(K.StringMaxLength,Z,Y,X);if(!new RegExp(Z.source,Z.flags).test(X))return yield d(K.RegExp,Z,Y,X)}function*WK(Z,$,Y,X){if(!L1(X))return yield d(K.String,Z,Y,X);if(O1(Z.minLength)&&!(X.length>=Z.minLength))yield d(K.StringMinLength,Z,Y,X);if(O1(Z.maxLength)&&!(X.length<=Z.maxLength))yield d(K.StringMaxLength,Z,Y,X);if(L1(Z.pattern)){if(!new RegExp(Z.pattern).test(X))yield d(K.StringPattern,Z,Y,X)}if(L1(Z.format)){if(!x1.Has(Z.format))yield d(K.StringFormatUnknown,Z,Y,X);else if(!x1.Get(Z.format)(X))yield d(K.StringFormat,Z,Y,X)}}function*JK(Z,$,Y,X){if(!T6(X))yield d(K.Symbol,Z,Y,X)}function*zK(Z,$,Y,X){if(!L1(X))return yield d(K.String,Z,Y,X);if(!new RegExp(Z.pattern).test(X))yield d(K.StringPattern,Z,Y,X)}function*QK(Z,$,Y,X){yield*N0(R1(Z,$),$,Y,X)}function*GK(Z,$,Y,X){if(!Z1(X))return yield d(K.Tuple,Z,Y,X);if(Z.items===void 0&&X.length!==0)return yield d(K.TupleLength,Z,Y,X);if(X.length!==Z.maxItems)return yield d(K.TupleLength,Z,Y,X);if(!Z.items)return;for(let W=0;W<Z.items.length;W++)yield*N0(Z.items[W],$,`${Y}/${W}`,X[W])}function*UK(Z,$,Y,X){if(!n1(X))yield d(K.Undefined,Z,Y,X)}function*HK(Z,$,Y,X){if(M1(Z,$,X))return;let W=Z.anyOf.map((J)=>new pZ(N0(J,$,Y,X)));yield d(K.Union,Z,Y,X,W)}function*MK(Z,$,Y,X){if(!H$(X))return yield d(K.Uint8Array,Z,Y,X);if(O1(Z.maxByteLength)&&!(X.length<=Z.maxByteLength))yield d(K.Uint8ArrayMaxByteLength,Z,Y,X);if(O1(Z.minByteLength)&&!(X.length>=Z.minByteLength))yield d(K.Uint8ArrayMinByteLength,Z,Y,X)}function*wK(Z,$,Y,X){}function*DK(Z,$,Y,X){if(!m1.IsVoidLike(X))yield d(K.Void,Z,Y,X)}function*qK(Z,$,Y,X){if(!U0.Get(Z[_])(Z,X))yield d(K.Kind,Z,Y,X)}function*N0(Z,$,Y,X){let W=O1(Z.$id)?[...$,Z]:$,J=Z;switch(J[_]){case"Any":return yield*f_(J,W,Y,X);case"Argument":return yield*g_(J,W,Y,X);case"Array":return yield*y_(J,W,Y,X);case"AsyncIterator":return yield*v_(J,W,Y,X);case"BigInt":return yield*h_(J,W,Y,X);case"Boolean":return yield*d_(J,W,Y,X);case"Constructor":return yield*p_(J,W,Y,X);case"Date":return yield*m_(J,W,Y,X);case"Function":return yield*c_(J,W,Y,X);case"Import":return yield*u_(J,W,Y,X);case"Integer":return yield*i_(J,W,Y,X);case"Intersect":return yield*l_(J,W,Y,X);case"Iterator":return yield*n_(J,W,Y,X);case"Literal":return yield*o_(J,W,Y,X);case"Never":return yield*t_(J,W,Y,X);case"Not":return yield*s_(J,W,Y,X);case"Null":return yield*r_(J,W,Y,X);case"Number":return yield*a_(J,W,Y,X);case"Object":return yield*e_(J,W,Y,X);case"Promise":return yield*ZK(J,W,Y,X);case"Record":return yield*$K(J,W,Y,X);case"Ref":return yield*YK(J,W,Y,X);case"RegExp":return yield*XK(J,W,Y,X);case"String":return yield*WK(J,W,Y,X);case"Symbol":return yield*JK(J,W,Y,X);case"TemplateLiteral":return yield*zK(J,W,Y,X);case"This":return yield*QK(J,W,Y,X);case"Tuple":return yield*GK(J,W,Y,X);case"Undefined":return yield*UK(J,W,Y,X);case"Union":return yield*HK(J,W,Y,X);case"Uint8Array":return yield*MK(J,W,Y,X);case"Unknown":return yield*wK(J,W,Y,X);case"Void":return yield*DK(J,W,Y,X);default:if(!U0.Has(J[_]))throw new j2(Z);return yield*qK(J,W,Y,X)}}function _6(...Z){let $=Z.length===3?N0(Z[0],Z[1],"",Z[2]):N0(Z[0],[],"",Z[1]);return new pZ($)}class _4 extends a{constructor(Z,$,Y){super("Unable to decode value as it does not match the expected schema");this.schema=Z,this.value=$,this.error=Y}}class rY extends a{constructor(Z,$,Y,X){super(X instanceof Error?X.message:"Unknown error");this.schema=Z,this.path=$,this.value=Y,this.error=X}}function a1(Z,$,Y){try{return j1(Z)?Z[y1].Decode(Y):Y}catch(X){throw new rY(Z,$,Y,X)}}function AK(Z,$,Y,X){return Z1(X)?a1(Z,Y,X.map((W,J)=>Z6(Z.items,$,`${Y}/${J}`,W))):a1(Z,Y,X)}function OK(Z,$,Y,X){if(!U1(X)||w8(X))return a1(Z,Y,X);let W=yY(Z),J=W.map((H)=>H[0]),z={...X};for(let[H,M]of W)if(H in z)z[H]=Z6(M,$,`${Y}/${H}`,z[H]);if(!j1(Z.unevaluatedProperties))return a1(Z,Y,z);let Q=Object.getOwnPropertyNames(z),U=Z.unevaluatedProperties,G={...z};for(let H of Q)if(!J.includes(H))G[H]=a1(U,`${Y}/${H}`,G[H]);return a1(Z,Y,G)}function FK(Z,$,Y,X){let W=globalThis.Object.values(Z.$defs),J=Z.$defs[Z.$ref],z=Z6(J,[...$,...W],Y,X);return a1(Z,Y,z)}function SK(Z,$,Y,X){return a1(Z,Y,Z6(Z.not,$,Y,X))}function NK(Z,$,Y,X){if(!U1(X))return a1(Z,Y,X);let W=s0(Z),J={...X};for(let G of W){if(!e(J,G))continue;if(n1(J[G])&&(!f6(Z.properties[G])||m1.IsExactOptionalProperty(J,G)))continue;J[G]=Z6(Z.properties[G],$,`${Y}/${G}`,J[G])}if(!r1(Z.additionalProperties))return a1(Z,Y,J);let z=Object.getOwnPropertyNames(J),Q=Z.additionalProperties,U={...J};for(let G of z)if(!W.includes(G))U[G]=a1(Q,`${Y}/${G}`,U[G]);return a1(Z,Y,U)}function BK(Z,$,Y,X){if(!U1(X))return a1(Z,Y,X);let W=Object.getOwnPropertyNames(Z.patternProperties)[0],J=new RegExp(W),z={...X};for(let H of Object.getOwnPropertyNames(X))if(J.test(H))z[H]=Z6(Z.patternProperties[W],$,`${Y}/${H}`,z[H]);if(!r1(Z.additionalProperties))return a1(Z,Y,z);let Q=Object.getOwnPropertyNames(z),U=Z.additionalProperties,G={...z};for(let H of Q)if(!J.test(H))G[H]=a1(U,`${Y}/${H}`,G[H]);return a1(Z,Y,G)}function LK(Z,$,Y,X){let W=R1(Z,$);return a1(Z,Y,Z6(W,$,Y,X))}function _K(Z,$,Y,X){let W=R1(Z,$);return a1(Z,Y,Z6(W,$,Y,X))}function KK(Z,$,Y,X){return Z1(X)&&Z1(Z.items)?a1(Z,Y,Z.items.map((W,J)=>Z6(W,$,`${Y}/${J}`,X[J]))):a1(Z,Y,X)}function RK(Z,$,Y,X){for(let W of Z.anyOf){if(!M1(W,$,X))continue;let J=Z6(W,$,Y,X);return a1(Z,Y,J)}return a1(Z,Y,X)}function Z6(Z,$,Y,X){let W=F0(Z,$),J=Z;switch(Z[_]){case"Array":return AK(J,W,Y,X);case"Import":return FK(J,W,Y,X);case"Intersect":return OK(J,W,Y,X);case"Not":return SK(J,W,Y,X);case"Object":return NK(J,W,Y,X);case"Record":return BK(J,W,Y,X);case"Ref":return LK(J,W,Y,X);case"Symbol":return a1(J,Y,X);case"This":return _K(J,W,Y,X);case"Tuple":return KK(J,W,Y,X);case"Union":return RK(J,W,Y,X);default:return a1(J,Y,X)}}function T$(Z,$,Y){return Z6(Z,$,"",Y)}class K4 extends a{constructor(Z,$,Y){super("The encoded value does not match the expected schema");this.schema=Z,this.value=$,this.error=Y}}class C2 extends a{constructor(Z,$,Y,X){super(`${X instanceof Error?X.message:"Unknown error"}`);this.schema=Z,this.path=$,this.value=Y,this.error=X}}function K0(Z,$,Y){try{return j1(Z)?Z[y1].Encode(Y):Y}catch(X){throw new C2(Z,$,Y,X)}}function VK(Z,$,Y,X){let W=K0(Z,Y,X);return Z1(W)?W.map((J,z)=>$6(Z.items,$,`${Y}/${z}`,J)):W}function EK(Z,$,Y,X){let W=globalThis.Object.values(Z.$defs),J=Z.$defs[Z.$ref],z=K0(Z,Y,X);return $6(J,[...$,...W],Y,z)}function jK(Z,$,Y,X){let W=K0(Z,Y,X);if(!U1(X)||w8(X))return W;let J=yY(Z),z=J.map((M)=>M[0]),Q={...W};for(let[M,q]of J)if(M in Q)Q[M]=$6(q,$,`${Y}/${M}`,Q[M]);if(!j1(Z.unevaluatedProperties))return Q;let U=Object.getOwnPropertyNames(Q),G=Z.unevaluatedProperties,H={...Q};for(let M of U)if(!z.includes(M))H[M]=K0(G,`${Y}/${M}`,H[M]);return H}function CK(Z,$,Y,X){return K0(Z.not,Y,K0(Z,Y,X))}function IK(Z,$,Y,X){let W=K0(Z,Y,X);if(!U1(W))return W;let J=s0(Z),z={...W};for(let H of J){if(!e(z,H))continue;if(n1(z[H])&&(!f6(Z.properties[H])||m1.IsExactOptionalProperty(z,H)))continue;z[H]=$6(Z.properties[H],$,`${Y}/${H}`,z[H])}if(!r1(Z.additionalProperties))return z;let Q=Object.getOwnPropertyNames(z),U=Z.additionalProperties,G={...z};for(let H of Q)if(!J.includes(H))G[H]=K0(U,`${Y}/${H}`,G[H]);return G}function PK(Z,$,Y,X){let W=K0(Z,Y,X);if(!U1(X))return W;let J=Object.getOwnPropertyNames(Z.patternProperties)[0],z=new RegExp(J),Q={...W};for(let M of Object.getOwnPropertyNames(X))if(z.test(M))Q[M]=$6(Z.patternProperties[J],$,`${Y}/${M}`,Q[M]);if(!r1(Z.additionalProperties))return Q;let U=Object.getOwnPropertyNames(Q),G=Z.additionalProperties,H={...Q};for(let M of U)if(!z.test(M))H[M]=K0(G,`${Y}/${M}`,H[M]);return H}function xK(Z,$,Y,X){let W=R1(Z,$),J=$6(W,$,Y,X);return K0(Z,Y,J)}function TK(Z,$,Y,X){let W=R1(Z,$),J=$6(W,$,Y,X);return K0(Z,Y,J)}function kK(Z,$,Y,X){let W=K0(Z,Y,X);return Z1(Z.items)?Z.items.map((J,z)=>$6(J,$,`${Y}/${z}`,W[z])):[]}function bK(Z,$,Y,X){for(let W of Z.anyOf){if(!M1(W,$,X))continue;let J=$6(W,$,Y,X);return K0(Z,Y,J)}for(let W of Z.anyOf){let J=$6(W,$,Y,X);if(!M1(Z,$,J))continue;return K0(Z,Y,J)}return K0(Z,Y,X)}function $6(Z,$,Y,X){let W=F0(Z,$),J=Z;switch(Z[_]){case"Array":return VK(J,W,Y,X);case"Import":return EK(J,W,Y,X);case"Intersect":return jK(J,W,Y,X);case"Not":return CK(J,W,Y,X);case"Object":return IK(J,W,Y,X);case"Record":return PK(J,W,Y,X);case"Ref":return xK(J,W,Y,X);case"This":return TK(J,W,Y,X);case"Tuple":return kK(J,W,Y,X);case"Union":return bK(J,W,Y,X);default:return K0(J,Y,X)}}function k$(Z,$,Y){return $6(Z,$,"",Y)}function fK(Z,$){return j1(Z)||w0(Z.items,$)}function gK(Z,$){return j1(Z)||w0(Z.items,$)}function yK(Z,$){return j1(Z)||w0(Z.returns,$)||Z.parameters.some((Y)=>w0(Y,$))}function vK(Z,$){return j1(Z)||w0(Z.returns,$)||Z.parameters.some((Y)=>w0(Y,$))}function hK(Z,$){return j1(Z)||j1(Z.unevaluatedProperties)||Z.allOf.some((Y)=>w0(Y,$))}function dK(Z,$){let Y=globalThis.Object.getOwnPropertyNames(Z.$defs).reduce((W,J)=>[...W,Z.$defs[J]],[]),X=Z.$defs[Z.$ref];return j1(Z)||w0(X,[...Y,...$])}function pK(Z,$){return j1(Z)||w0(Z.items,$)}function mK(Z,$){return j1(Z)||w0(Z.not,$)}function cK(Z,$){return j1(Z)||Object.values(Z.properties).some((Y)=>w0(Y,$))||r1(Z.additionalProperties)&&w0(Z.additionalProperties,$)}function uK(Z,$){return j1(Z)||w0(Z.item,$)}function iK(Z,$){let Y=Object.getOwnPropertyNames(Z.patternProperties)[0],X=Z.patternProperties[Y];return j1(Z)||w0(X,$)||r1(Z.additionalProperties)&&j1(Z.additionalProperties)}function lK(Z,$){if(j1(Z))return!0;return w0(R1(Z,$),$)}function nK(Z,$){if(j1(Z))return!0;return w0(R1(Z,$),$)}function oK(Z,$){return j1(Z)||!n1(Z.items)&&Z.items.some((Y)=>w0(Y,$))}function tK(Z,$){return j1(Z)||Z.anyOf.some((Y)=>w0(Y,$))}function w0(Z,$){let Y=F0(Z,$),X=Z;if(Z.$id&&q5.has(Z.$id))return!1;if(Z.$id)q5.add(Z.$id);switch(Z[_]){case"Array":return fK(X,Y);case"AsyncIterator":return gK(X,Y);case"Constructor":return yK(X,Y);case"Function":return vK(X,Y);case"Import":return dK(X,Y);case"Intersect":return hK(X,Y);case"Iterator":return pK(X,Y);case"Not":return mK(X,Y);case"Object":return cK(X,Y);case"Promise":return uK(X,Y);case"Record":return iK(X,Y);case"Ref":return lK(X,Y);case"This":return nK(X,Y);case"Tuple":return oK(X,Y);case"Union":return tK(X,Y);default:return j1(Z)}}var q5=new Set;function p6(Z,$){return q5.clear(),w0(Z,$)}class I2{constructor(Z,$,Y,X){this.schema=Z,this.references=$,this.checkFunc=Y,this.code=X,this.hasTransform=p6(Z,$)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(Z){return _6(this.schema,this.references,Z)}Check(Z){return this.checkFunc(Z)}Decode(Z){if(!this.checkFunc(Z))throw new _4(this.schema,Z,this.Errors(Z).First());return this.hasTransform?T$(this.schema,this.references,Z):Z}Encode(Z){let $=this.hasTransform?k$(this.schema,this.references,Z):Z;if(!this.checkFunc($))throw new K4(this.schema,Z,this.Errors(Z).First());return $}}var m6;(function(Z){function $(J){return J===36}Z.DollarSign=$;function Y(J){return J===95}Z.IsUnderscore=Y;function X(J){return J>=65&&J<=90||J>=97&&J<=122}Z.IsAlpha=X;function W(J){return J>=48&&J<=57}Z.IsNumeric=W})(m6||(m6={}));var aY;(function(Z){function $(J){if(J.length===0)return!1;return m6.IsNumeric(J.charCodeAt(0))}function Y(J){if($(J))return!1;for(let z=0;z<J.length;z++){let Q=J.charCodeAt(z);if(!(m6.IsAlpha(Q)||m6.IsNumeric(Q)||m6.DollarSign(Q)||m6.IsUnderscore(Q)))return!1}return!0}function X(J){return J.replace(/'/g,"\\'")}function W(J,z){return Y(z)?`${J}.${z}`:`${J}['${X(z)}']`}Z.Encode=W})(aY||(aY={}));var A5;(function(Z){function $(Y){let X=[];for(let W=0;W<Y.length;W++){let J=Y.charCodeAt(W);if(m6.IsNumeric(J)||m6.IsAlpha(J))X.push(Y.charAt(W));else X.push(`_${J}_`)}return X.join("").replace(/__/g,"_")}Z.Encode=$})(A5||(A5={}));var O5;(function(Z){function $(Y){return Y.replace(/'/g,"\\'")}Z.Escape=$})(O5||(O5={}));class P2 extends a{constructor(Z){super("Unknown type");this.schema=Z}}class F5 extends a{constructor(Z){super("Preflight validation check failed to guard for the given schema");this.schema=Z}}var mZ;(function(Z){function $(z,Q,U){return m1.ExactOptionalPropertyTypes?`('${Q}' in ${z} ? ${U} : true)`:`(${aY.Encode(z,Q)} !== undefined ? ${U} : true)`}Z.IsExactOptionalProperty=$;function Y(z){return!m1.AllowArrayObject?`(typeof ${z} === 'object' && ${z} !== null && !Array.isArray(${z}))`:`(typeof ${z} === 'object' && ${z} !== null)`}Z.IsObjectLike=Y;function X(z){return!m1.AllowArrayObject?`(typeof ${z} === 'object' && ${z} !== null && !Array.isArray(${z}) && !(${z} instanceof Date) && !(${z} instanceof Uint8Array))`:`(typeof ${z} === 'object' && ${z} !== null && !(${z} instanceof Date) && !(${z} instanceof Uint8Array))`}Z.IsRecordLike=X;function W(z){return m1.AllowNaN?`typeof ${z} === 'number'`:`Number.isFinite(${z})`}Z.IsNumberLike=W;function J(z){return m1.AllowNullVoid?`(${z} === undefined || ${z} === null)`:`${z} === undefined`}Z.IsVoidLike=J})(mZ||(mZ={}));var MZ;(function(Z){function $(A){return A[_]==="Any"||A[_]==="Unknown"}function*Y(A,k,N){yield"true"}function*X(A,k,N){yield"true"}function*W(A,k,N){yield`Array.isArray(${N})`;let[u,h]=[g("value","any"),g("acc","number")];if(r(A.maxItems))yield`${N}.length <= ${A.maxItems}`;if(r(A.minItems))yield`${N}.length >= ${A.minItems}`;let i=H8(A.items,k,"value");if(yield`${N}.every((${u}) => ${i})`,t1(A.contains)||r(A.minContains)||r(A.maxContains)){let f1=t1(A.contains)?A.contains:Q1(),l0=H8(f1,k,"value"),C6=r(A.minContains)?[`(count >= ${A.minContains})`]:[],c8=r(A.maxContains)?[`(count <= ${A.maxContains})`]:[],O6=`const count = value.reduce((${h}, ${u}) => ${l0} ? acc + 1 : acc, 0)`,LY=["(count > 0)",...C6,...c8].join(" && ");yield`((${u}) => { ${O6}; return ${LY}})(${N})`}if(A.uniqueItems===!0)yield`((${u}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${N})`}function*J(A,k,N){yield`(typeof value === 'object' && Symbol.asyncIterator in ${N})`}function*z(A,k,N){if(yield`(typeof ${N} === 'bigint')`,L0(A.exclusiveMaximum))yield`${N} < BigInt(${A.exclusiveMaximum})`;if(L0(A.exclusiveMinimum))yield`${N} > BigInt(${A.exclusiveMinimum})`;if(L0(A.maximum))yield`${N} <= BigInt(${A.maximum})`;if(L0(A.minimum))yield`${N} >= BigInt(${A.minimum})`;if(L0(A.multipleOf))yield`(${N} % BigInt(${A.multipleOf})) === 0`}function*Q(A,k,N){yield`(typeof ${N} === 'boolean')`}function*U(A,k,N){yield*p8(A.returns,k,`${N}.prototype`)}function*G(A,k,N){if(yield`(${N} instanceof Date) && Number.isFinite(${N}.getTime())`,r(A.exclusiveMaximumTimestamp))yield`${N}.getTime() < ${A.exclusiveMaximumTimestamp}`;if(r(A.exclusiveMinimumTimestamp))yield`${N}.getTime() > ${A.exclusiveMinimumTimestamp}`;if(r(A.maximumTimestamp))yield`${N}.getTime() <= ${A.maximumTimestamp}`;if(r(A.minimumTimestamp))yield`${N}.getTime() >= ${A.minimumTimestamp}`;if(r(A.multipleOfTimestamp))yield`(${N}.getTime() % ${A.multipleOfTimestamp}) === 0`}function*H(A,k,N){yield`(typeof ${N} === 'function')`}function*M(A,k,N){let u=globalThis.Object.getOwnPropertyNames(A.$defs).reduce((h,i)=>{return[...h,A.$defs[i]]},[]);yield*p8(I8(A.$ref),[...k,...u],N)}function*q(A,k,N){if(yield`Number.isInteger(${N})`,r(A.exclusiveMaximum))yield`${N} < ${A.exclusiveMaximum}`;if(r(A.exclusiveMinimum))yield`${N} > ${A.exclusiveMinimum}`;if(r(A.maximum))yield`${N} <= ${A.maximum}`;if(r(A.minimum))yield`${N} >= ${A.minimum}`;if(r(A.multipleOf))yield`(${N} % ${A.multipleOf}) === 0`}function*w(A,k,N){let u=A.allOf.map((h)=>H8(h,k,N)).join(" && ");if(A.unevaluatedProperties===!1){let h=e6(`${new RegExp(v6(A))};`),i=`Object.getOwnPropertyNames(${N}).every(key => ${h}.test(key))`;yield`(${u} && ${i})`}else if(t1(A.unevaluatedProperties)){let h=e6(`${new RegExp(v6(A))};`),i=`Object.getOwnPropertyNames(${N}).every(key => ${h}.test(key) || ${H8(A.unevaluatedProperties,k,`${N}[key]`)})`;yield`(${u} && ${i})`}else yield`(${u})`}function*B(A,k,N){yield`(typeof value === 'object' && Symbol.iterator in ${N})`}function*D(A,k,N){if(typeof A.const==="number"||typeof A.const==="boolean")yield`(${N} === ${A.const})`;else yield`(${N} === '${O5.Escape(A.const)}')`}function*L(A,k,N){yield"false"}function*b(A,k,N){yield`(!${H8(A.not,k,N)})`}function*s(A,k,N){yield`(${N} === null)`}function*t(A,k,N){if(yield mZ.IsNumberLike(N),r(A.exclusiveMaximum))yield`${N} < ${A.exclusiveMaximum}`;if(r(A.exclusiveMinimum))yield`${N} > ${A.exclusiveMinimum}`;if(r(A.maximum))yield`${N} <= ${A.maximum}`;if(r(A.minimum))yield`${N} >= ${A.minimum}`;if(r(A.multipleOf))yield`(${N} % ${A.multipleOf}) === 0`}function*J1(A,k,N){if(yield mZ.IsObjectLike(N),r(A.minProperties))yield`Object.getOwnPropertyNames(${N}).length >= ${A.minProperties}`;if(r(A.maxProperties))yield`Object.getOwnPropertyNames(${N}).length <= ${A.maxProperties}`;let u=Object.getOwnPropertyNames(A.properties);for(let h of u){let i=aY.Encode(N,h),f1=A.properties[h];if(A.required&&A.required.includes(h)){if(yield*p8(f1,k,i),h6(f1)||$(f1))yield`('${h}' in ${N})`}else{let l0=H8(f1,k,i);yield mZ.IsExactOptionalProperty(N,h,l0)}}if(A.additionalProperties===!1)if(A.required&&A.required.length===u.length)yield`Object.getOwnPropertyNames(${N}).length === ${u.length}`;else{let h=`[${u.map((i)=>`'${i}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${N}).every(key => ${h}.includes(key))`}if(typeof A.additionalProperties==="object"){let h=H8(A.additionalProperties,k,`${N}[key]`),i=`[${u.map((f1)=>`'${f1}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${N}).every(key => ${i}.includes(key) || ${h}))`}}function*Y1(A,k,N){yield`${N} instanceof Promise`}function*P(A,k,N){if(yield mZ.IsRecordLike(N),r(A.minProperties))yield`Object.getOwnPropertyNames(${N}).length >= ${A.minProperties}`;if(r(A.maxProperties))yield`Object.getOwnPropertyNames(${N}).length <= ${A.maxProperties}`;let[u,h]=Object.entries(A.patternProperties)[0],i=e6(`${new RegExp(u)}`),f1=H8(h,k,"value"),l0=t1(A.additionalProperties)?H8(A.additionalProperties,k,N):A.additionalProperties===!1?"false":"true",C6=`(${i}.test(key) ? ${f1} : ${l0})`;yield`(Object.entries(${N}).every(([key, value]) => ${C6}))`}function*I(A,k,N){let u=R1(A,k);if(P1.functions.has(A.$ref))return yield`${a6(A.$ref)}(${N})`;yield*p8(u,k,N)}function*f(A,k,N){let u=e6(`${new RegExp(A.source,A.flags)};`);if(yield`(typeof ${N} === 'string')`,r(A.maxLength))yield`${N}.length <= ${A.maxLength}`;if(r(A.minLength))yield`${N}.length >= ${A.minLength}`;yield`${u}.test(${N})`}function*T(A,k,N){if(yield`(typeof ${N} === 'string')`,r(A.maxLength))yield`${N}.length <= ${A.maxLength}`;if(r(A.minLength))yield`${N}.length >= ${A.minLength}`;if(A.pattern!==void 0)yield`${e6(`${new RegExp(A.pattern)};`)}.test(${N})`;if(A.format!==void 0)yield`format('${A.format}', ${N})`}function*G1(A,k,N){yield`(typeof ${N} === 'symbol')`}function*H1(A,k,N){yield`(typeof ${N} === 'string')`,yield`${e6(`${new RegExp(A.pattern)};`)}.test(${N})`}function*z1(A,k,N){yield`${a6(A.$ref)}(${N})`}function*q1(A,k,N){if(yield`Array.isArray(${N})`,A.items===void 0)return yield`${N}.length === 0`;yield`(${N}.length === ${A.maxItems})`;for(let u=0;u<A.items.length;u++)yield`${H8(A.items[u],k,`${N}[${u}]`)}`}function*O0(A,k,N){yield`${N} === undefined`}function*p1(A,k,N){yield`(${A.anyOf.map((h)=>H8(h,k,N)).join(" || ")})`}function*A6(A,k,N){if(yield`${N} instanceof Uint8Array`,r(A.maxByteLength))yield`(${N}.length <= ${A.maxByteLength})`;if(r(A.minByteLength))yield`(${N}.length >= ${A.minByteLength})`}function*g0(A,k,N){yield"true"}function*PZ(A,k,N){yield mZ.IsVoidLike(N)}function*yX(A,k,N){let u=P1.instances.size;P1.instances.set(u,A),yield`kind('${A[_]}', ${u}, ${N})`}function*p8(A,k,N,u=!0){let h=L1(A.$id)?[...k,A]:k,i=A;if(u&&L1(A.$id)){let f1=a6(A.$id);if(P1.functions.has(f1))return yield`${f1}(${N})`;else{P1.functions.set(f1,"<deferred>");let l0=m8(f1,A,k,"value",!1);return P1.functions.set(f1,l0),yield`${f1}(${N})`}}switch(i[_]){case"Any":return yield*Y(i,h,N);case"Argument":return yield*X(i,h,N);case"Array":return yield*W(i,h,N);case"AsyncIterator":return yield*J(i,h,N);case"BigInt":return yield*z(i,h,N);case"Boolean":return yield*Q(i,h,N);case"Constructor":return yield*U(i,h,N);case"Date":return yield*G(i,h,N);case"Function":return yield*H(i,h,N);case"Import":return yield*M(i,h,N);case"Integer":return yield*q(i,h,N);case"Intersect":return yield*w(i,h,N);case"Iterator":return yield*B(i,h,N);case"Literal":return yield*D(i,h,N);case"Never":return yield*L(i,h,N);case"Not":return yield*b(i,h,N);case"Null":return yield*s(i,h,N);case"Number":return yield*t(i,h,N);case"Object":return yield*J1(i,h,N);case"Promise":return yield*Y1(i,h,N);case"Record":return yield*P(i,h,N);case"Ref":return yield*I(i,h,N);case"RegExp":return yield*f(i,h,N);case"String":return yield*T(i,h,N);case"Symbol":return yield*G1(i,h,N);case"TemplateLiteral":return yield*H1(i,h,N);case"This":return yield*z1(i,h,N);case"Tuple":return yield*q1(i,h,N);case"Undefined":return yield*O0(i,h,N);case"Union":return yield*p1(i,h,N);case"Uint8Array":return yield*A6(i,h,N);case"Unknown":return yield*g0(i,h,N);case"Void":return yield*PZ(i,h,N);default:if(!U0.Has(i[_]))throw new P2(A);return yield*yX(i,h,N)}}let P1={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function H8(A,k,N,u=!0){return`(${[...p8(A,k,N,u)].join(" && ")})`}function a6(A){return`check_${A5.Encode(A)}`}function e6(A){let k=`local_${P1.variables.size}`;return P1.variables.set(k,`const ${k} = ${A}`),k}function m8(A,k,N,u,h=!0){let[i,f1]=[`
`,(O6)=>"".padStart(O6," ")],l0=g("value","any"),C6=C("boolean"),c8=[...p8(k,N,u,h)].map((O6)=>`${f1(4)}${O6}`).join(` &&${i}`);return`function ${A}(${l0})${C6} {${i}${f1(2)}return (${i}${c8}${i}${f1(2)})
}`}function g(A,k){let N=P1.language==="typescript"?`: ${k}`:"";return`${A}${N}`}function C(A){return P1.language==="typescript"?`: ${A}`:""}function x(A,k,N){let u=m8("check",A,k,"value"),h=g("value","any"),i=C("boolean"),f1=[...P1.functions.values()],l0=[...P1.variables.values()],C6=L1(A.$id)?`return function check(${h})${i} {
  return ${a6(A.$id)}(value)
}`:`return ${u}`;return[...l0,...f1,C6].join(`
`)}function o(...A){let k={language:"javascript"},[N,u,h]=A.length===2&&Z1(A[1])?[A[0],A[1],k]:A.length===2&&!Z1(A[1])?[A[0],[],A[1]]:A.length===3?[A[0],A[1],A[2]]:A.length===1?[A[0],[],k]:[null,[],k];if(P1.language=h.language,P1.variables.clear(),P1.functions.clear(),P1.instances.clear(),!t1(N))throw new F5(N);for(let i of u)if(!t1(i))throw new F5(i);return x(N,u,h)}Z.Code=o;function $1(A,k=[]){let N=o(A,k,{language:"javascript"}),u=globalThis.Function("kind","format","hash",N),h=new Map(P1.instances);function i(c8,O6,LY){if(!U0.Has(c8)||!h.has(O6))return!1;let hF=U0.Get(c8),dF=h.get(O6);return hF(dF,LY)}function f1(c8,O6){if(!x1.Has(c8))return!1;return x1.Get(c8)(O6)}function l0(c8){return HZ(c8)}let C6=u(i,f1,l0);return new I2(A,k,C6,N)}Z.Compile=$1})(MZ||(MZ={}));var sK=function(Z,$,Y,X,W){if(X==="m")throw new TypeError("Private method is not writable");if(X==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof $==="function"?Z!==$||!W:!$.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return X==="a"?W.call(Z,Y):W?W.value=Y:$.set(Z,Y),Y},T2=function(Z,$,Y,X){if(Y==="a"&&!X)throw new TypeError("Private accessor was defined without a getter");if(typeof $==="function"?Z!==$||!X:!$.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?X:Y==="a"?X.call(Z):X?X.value:$.get(Z)},S5,eY,k2;class b2 extends a{constructor(Z){let $=Z.First();super($===void 0?"Invalid Value":$.message);S5.add(this),eY.set(this,void 0),sK(this,eY,Z,"f"),this.error=$}Errors(){return new pZ(T2(this,S5,"m",k2).call(this))}}eY=new WeakMap,S5=new WeakSet,k2=function*Z(){if(this.error)yield this.error;yield*T2(this,eY,"f")};function x2(Z,$,Y){if(M1(Z,$,Y))return;throw new b2(_6(Z,$,Y))}function Z9(...Z){return Z.length===3?x2(Z[0],Z[1],Z[2]):x2(Z[0],[],Z[1])}function rK(Z){let $={};for(let Y of Object.getOwnPropertyNames(Z))$[Y]=V1(Z[Y]);for(let Y of Object.getOwnPropertySymbols(Z))$[Y]=V1(Z[Y]);return $}function aK(Z){return Z.map(($)=>V1($))}function eK(Z){return Z.slice()}function ZR(Z){return new Map(V1([...Z.entries()]))}function $R(Z){return new Set(V1([...Z.entries()]))}function YR(Z){return new Date(Z.toISOString())}function XR(Z){return Z}function V1(Z){if(Z1(Z))return aK(Z);if(y0(Z))return YR(Z);if(R8(Z))return eK(Z);if(aW(Z))return ZR(Z);if(eW(Z))return $R(Z);if(U1(Z))return rK(Z);if(w8(Z))return XR(Z);throw new Error("ValueClone: Unable to clone value")}class T8 extends a{constructor(Z,$){super($);this.schema=Z}}function E1(Z){return $Z(Z)?Z():V1(Z)}function WR(Z,$){if(e(Z,"default"))return E1(Z.default);else return{}}function JR(Z,$){return{}}function zR(Z,$){if(Z.uniqueItems===!0&&!e(Z,"default"))throw new T8(Z,"Array with the uniqueItems constraint requires a default value");else if("contains"in Z&&!e(Z,"default"))throw new T8(Z,"Array with the contains constraint requires a default value");else if("default"in Z)return E1(Z.default);else if(Z.minItems!==void 0)return Array.from({length:Z.minItems}).map((Y)=>{return a0(Z.items,$)});else return[]}function QR(Z,$){if(e(Z,"default"))return E1(Z.default);else return async function*(){}()}function GR(Z,$){if(e(Z,"default"))return E1(Z.default);else return BigInt(0)}function UR(Z,$){if(e(Z,"default"))return E1(Z.default);else return!1}function HR(Z,$){if(e(Z,"default"))return E1(Z.default);else{let Y=a0(Z.returns,$);if(typeof Y==="object"&&!Array.isArray(Y))return class{constructor(){for(let[X,W]of Object.entries(Y)){let J=this;J[X]=W}}};else return class{}}}function MR(Z,$){if(e(Z,"default"))return E1(Z.default);else if(Z.minimumTimestamp!==void 0)return new Date(Z.minimumTimestamp);else return new Date}function wR(Z,$){if(e(Z,"default"))return E1(Z.default);else return()=>a0(Z.returns,$)}function DR(Z,$){let Y=globalThis.Object.values(Z.$defs),X=Z.$defs[Z.$ref];return a0(X,[...$,...Y])}function qR(Z,$){if(e(Z,"default"))return E1(Z.default);else if(Z.minimum!==void 0)return Z.minimum;else return 0}function AR(Z,$){if(e(Z,"default"))return E1(Z.default);else{let Y=Z.allOf.reduce((X,W)=>{let J=a0(W,$);return typeof J==="object"?{...X,...J}:J},{});if(!M1(Z,$,Y))throw new T8(Z,"Intersect produced invalid value. Consider using a default value.");return Y}}function OR(Z,$){if(e(Z,"default"))return E1(Z.default);else return function*(){}()}function FR(Z,$){if(e(Z,"default"))return E1(Z.default);else return Z.const}function SR(Z,$){if(e(Z,"default"))return E1(Z.default);else throw new T8(Z,"Never types cannot be created. Consider using a default value.")}function NR(Z,$){if(e(Z,"default"))return E1(Z.default);else throw new T8(Z,"Not types must have a default value")}function BR(Z,$){if(e(Z,"default"))return E1(Z.default);else return null}function LR(Z,$){if(e(Z,"default"))return E1(Z.default);else if(Z.minimum!==void 0)return Z.minimum;else return 0}function _R(Z,$){if(e(Z,"default"))return E1(Z.default);else{let Y=new Set(Z.required),X={};for(let[W,J]of Object.entries(Z.properties)){if(!Y.has(W))continue;X[W]=a0(J,$)}return X}}function KR(Z,$){if(e(Z,"default"))return E1(Z.default);else return Promise.resolve(a0(Z.item,$))}function RR(Z,$){let[Y,X]=Object.entries(Z.patternProperties)[0];if(e(Z,"default"))return E1(Z.default);else if(!(Y===N6||Y===S6)){let W=Y.slice(1,Y.length-1).split("|"),J={};for(let z of W)J[z]=a0(X,$);return J}else return{}}function VR(Z,$){if(e(Z,"default"))return E1(Z.default);else return a0(R1(Z,$),$)}function ER(Z,$){if(e(Z,"default"))return E1(Z.default);else throw new T8(Z,"RegExp types cannot be created. Consider using a default value.")}function jR(Z,$){if(Z.pattern!==void 0)if(!e(Z,"default"))throw new T8(Z,"String types with patterns must specify a default value");else return E1(Z.default);else if(Z.format!==void 0)if(!e(Z,"default"))throw new T8(Z,"String types with formats must specify a default value");else return E1(Z.default);else if(e(Z,"default"))return E1(Z.default);else if(Z.minLength!==void 0)return Array.from({length:Z.minLength}).map(()=>" ").join("");else return""}function CR(Z,$){if(e(Z,"default"))return E1(Z.default);else if("value"in Z)return Symbol.for(Z.value);else return Symbol()}function IR(Z,$){if(e(Z,"default"))return E1(Z.default);if(!TY(Z))throw new T8(Z,"Can only create template literals that produce a finite variants. Consider using a default value.");return N$(Z)[0]}function PR(Z,$){if(f2++>vR)throw new T8(Z,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(e(Z,"default"))return E1(Z.default);else return a0(R1(Z,$),$)}function xR(Z,$){if(e(Z,"default"))return E1(Z.default);if(Z.items===void 0)return[];else return Array.from({length:Z.minItems}).map((Y,X)=>a0(Z.items[X],$))}function TR(Z,$){if(e(Z,"default"))return E1(Z.default);else return}function kR(Z,$){if(e(Z,"default"))return E1(Z.default);else if(Z.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return a0(Z.anyOf[0],$)}function bR(Z,$){if(e(Z,"default"))return E1(Z.default);else if(Z.minByteLength!==void 0)return new Uint8Array(Z.minByteLength);else return new Uint8Array(0)}function fR(Z,$){if(e(Z,"default"))return E1(Z.default);else return{}}function gR(Z,$){if(e(Z,"default"))return E1(Z.default);else return}function yR(Z,$){if(e(Z,"default"))return E1(Z.default);else throw new Error("User defined types must specify a default value")}function a0(Z,$){let Y=F0(Z,$),X=Z;switch(X[_]){case"Any":return WR(X,Y);case"Argument":return JR(X,Y);case"Array":return zR(X,Y);case"AsyncIterator":return QR(X,Y);case"BigInt":return GR(X,Y);case"Boolean":return UR(X,Y);case"Constructor":return HR(X,Y);case"Date":return MR(X,Y);case"Function":return wR(X,Y);case"Import":return DR(X,Y);case"Integer":return qR(X,Y);case"Intersect":return AR(X,Y);case"Iterator":return OR(X,Y);case"Literal":return FR(X,Y);case"Never":return SR(X,Y);case"Not":return NR(X,Y);case"Null":return BR(X,Y);case"Number":return LR(X,Y);case"Object":return _R(X,Y);case"Promise":return KR(X,Y);case"Record":return RR(X,Y);case"Ref":return VR(X,Y);case"RegExp":return ER(X,Y);case"String":return jR(X,Y);case"Symbol":return CR(X,Y);case"TemplateLiteral":return IR(X,Y);case"This":return PR(X,Y);case"Tuple":return xR(X,Y);case"Undefined":return TR(X,Y);case"Union":return kR(X,Y);case"Uint8Array":return bR(X,Y);case"Unknown":return fR(X,Y);case"Void":return gR(X,Y);default:if(!U0.Has(X[_]))throw new T8(X,"Unknown type");return yR(X,Y)}}var vR=512,f2=0;function k8(...Z){return f2=0,Z.length===2?a0(Z[0],Z[1]):a0(Z[0],[])}class N5 extends a{constructor(Z,$){super($);this.schema=Z}}function hR(Z,$,Y){if(Z[_]==="Object"&&typeof Y==="object"&&!x6(Y)){let X=Z,W=Object.getOwnPropertyNames(Y),J=Object.entries(X.properties),[z,Q]=[1/J.length,J.length];return J.reduce((U,[G,H])=>{let M=H[_]==="Literal"&&H.const===Y[G]?Q:0,q=M1(H,$,Y[G])?z:0,w=W.includes(G)?z:0;return U+(M+q+w)},0)}else return M1(Z,$,Y)?1:0}function dR(Z,$,Y){let X=Z.anyOf.map((z)=>R1(z,$)),[W,J]=[X[0],0];for(let z of X){let Q=hR(z,$,Y);if(Q>J)W=z,J=Q}return W}function pR(Z,$,Y){if("default"in Z)return typeof Y==="function"?Z.default:V1(Z.default);else{let X=dR(Z,$,Y);return R4(X,$,Y)}}function mR(Z,$,Y){return M1(Z,$,Y)?V1(Y):k8(Z,$)}function cR(Z,$,Y){return M1(Z,$,Y)?Y:k8(Z,$)}function uR(Z,$,Y){if(M1(Z,$,Y))return V1(Y);let X=Z1(Y)?V1(Y):k8(Z,$),W=r(Z.minItems)&&X.length<Z.minItems?[...X,...Array.from({length:Z.minItems-X.length},()=>null)]:X,z=(r(Z.maxItems)&&W.length>Z.maxItems?W.slice(0,Z.maxItems):W).map((U)=>Y6(Z.items,$,U));if(Z.uniqueItems!==!0)return z;let Q=[...new Set(z)];if(!M1(Z,$,Q))throw new N5(Z,"Array cast produced invalid data due to uniqueItems constraint");return Q}function iR(Z,$,Y){if(M1(Z,$,Y))return k8(Z,$);let X=new Set(Z.returns.required||[]),W=function(){};for(let[J,z]of Object.entries(Z.returns.properties)){if(!X.has(J)&&Y.prototype[J]===void 0)continue;W.prototype[J]=Y6(z,$,Y.prototype[J])}return W}function lR(Z,$,Y){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return Y6(W,[...$,...X],Y)}function nR(Z,$,Y){let X=k8(Z,$),W=U1(X)&&U1(Y)?{...X,...Y}:Y;return M1(Z,$,W)?W:k8(Z,$)}function oR(Z,$,Y){throw new N5(Z,"Never types cannot be cast")}function tR(Z,$,Y){if(M1(Z,$,Y))return Y;if(Y===null||typeof Y!=="object")return k8(Z,$);let X=new Set(Z.required||[]),W={};for(let[J,z]of Object.entries(Z.properties)){if(!X.has(J)&&Y[J]===void 0)continue;W[J]=Y6(z,$,Y[J])}if(typeof Z.additionalProperties==="object"){let J=Object.getOwnPropertyNames(Z.properties);for(let z of Object.getOwnPropertyNames(Y)){if(J.includes(z))continue;W[z]=Y6(Z.additionalProperties,$,Y[z])}}return W}function sR(Z,$,Y){if(M1(Z,$,Y))return V1(Y);if(Y===null||typeof Y!=="object"||Array.isArray(Y)||Y instanceof Date)return k8(Z,$);let X=Object.getOwnPropertyNames(Z.patternProperties)[0],W=Z.patternProperties[X],J={};for(let[z,Q]of Object.entries(Y))J[z]=Y6(W,$,Q);return J}function rR(Z,$,Y){return Y6(R1(Z,$),$,Y)}function aR(Z,$,Y){return Y6(R1(Z,$),$,Y)}function eR(Z,$,Y){if(M1(Z,$,Y))return V1(Y);if(!Z1(Y))return k8(Z,$);if(Z.items===void 0)return[];return Z.items.map((X,W)=>Y6(X,$,Y[W]))}function ZV(Z,$,Y){return M1(Z,$,Y)?V1(Y):pR(Z,$,Y)}function Y6(Z,$,Y){let X=L1(Z.$id)?F0(Z,$):$,W=Z;switch(Z[_]){case"Array":return uR(W,X,Y);case"Constructor":return iR(W,X,Y);case"Import":return lR(W,X,Y);case"Intersect":return nR(W,X,Y);case"Never":return oR(W,X,Y);case"Object":return tR(W,X,Y);case"Record":return sR(W,X,Y);case"Ref":return rR(W,X,Y);case"This":return aR(W,X,Y);case"Tuple":return eR(W,X,Y);case"Union":return ZV(W,X,Y);case"Date":case"Symbol":case"Uint8Array":return mR(Z,$,Y);default:return cR(W,X,Y)}}function R4(...Z){return Z.length===3?Y6(Z[0],Z[1],Z[2]):Y6(Z[0],[],Z[1])}function $V(Z){return XZ(Z)&&Z[_]!=="Unsafe"}function YV(Z,$,Y){if(!Z1(Y))return Y;return Y.map((X)=>e0(Z.items,$,X))}function XV(Z,$,Y){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return e0(W,[...$,...X],Y)}function WV(Z,$,Y){let X=Z.unevaluatedProperties,J=Z.allOf.map((Q)=>e0(Q,$,V1(Y))).reduce((Q,U)=>U1(U)?{...Q,...U}:U,{});if(!U1(Y)||!U1(J)||!XZ(X))return J;let z=s0(Z);for(let Q of Object.getOwnPropertyNames(Y)){if(z.includes(Q))continue;if(M1(X,$,Y[Q]))J[Q]=e0(X,$,Y[Q])}return J}function JV(Z,$,Y){if(!U1(Y)||Z1(Y))return Y;let X=Z.additionalProperties;for(let W of Object.getOwnPropertyNames(Y)){if(e(Z.properties,W)){Y[W]=e0(Z.properties[W],$,Y[W]);continue}if(XZ(X)&&M1(X,$,Y[W])){Y[W]=e0(X,$,Y[W]);continue}delete Y[W]}return Y}function zV(Z,$,Y){if(!U1(Y))return Y;let X=Z.additionalProperties,W=Object.getOwnPropertyNames(Y),[J,z]=Object.entries(Z.patternProperties)[0],Q=new RegExp(J);for(let U of W){if(Q.test(U)){Y[U]=e0(z,$,Y[U]);continue}if(XZ(X)&&M1(X,$,Y[U])){Y[U]=e0(X,$,Y[U]);continue}delete Y[U]}return Y}function QV(Z,$,Y){return e0(R1(Z,$),$,Y)}function GV(Z,$,Y){return e0(R1(Z,$),$,Y)}function UV(Z,$,Y){if(!Z1(Y))return Y;if(n1(Z.items))return[];let X=Math.min(Y.length,Z.items.length);for(let W=0;W<X;W++)Y[W]=e0(Z.items[W],$,Y[W]);return Y.length>X?Y.slice(0,X):Y}function HV(Z,$,Y){for(let X of Z.anyOf)if($V(X)&&M1(X,$,Y))return e0(X,$,Y);return Y}function e0(Z,$,Y){let X=L1(Z.$id)?F0(Z,$):$,W=Z;switch(W[_]){case"Array":return YV(W,X,Y);case"Import":return XV(W,X,Y);case"Intersect":return WV(W,X,Y);case"Object":return JV(W,X,Y);case"Record":return zV(W,X,Y);case"Ref":return QV(W,X,Y);case"This":return GV(W,X,Y);case"Tuple":return UV(W,X,Y);case"Union":return HV(W,X,Y);default:return Y}}function $9(...Z){return Z.length===3?e0(Z[0],Z[1],Z[2]):e0(Z[0],[],Z[1])}function Y9(Z){return L1(Z)&&!isNaN(Z)&&!isNaN(parseFloat(Z))}function MV(Z){return L0(Z)||F6(Z)||r(Z)}function V4(Z){return Z===!0||r(Z)&&Z===1||L0(Z)&&Z===BigInt("1")||L1(Z)&&(Z.toLowerCase()==="true"||Z==="1")}function E4(Z){return Z===!1||r(Z)&&(Z===0||Object.is(Z,-0))||L0(Z)&&Z===BigInt("0")||L1(Z)&&(Z.toLowerCase()==="false"||Z==="0"||Z==="-0")}function wV(Z){return L1(Z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Z)}function DV(Z){return L1(Z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Z)}function qV(Z){return L1(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Z)}function AV(Z){return L1(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Z)}function OV(Z){return L1(Z)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(Z)}function FV(Z,$){let Y=y2(Z);return Y===$?Y:Z}function SV(Z,$){let Y=v2(Z);return Y===$?Y:Z}function NV(Z,$){let Y=g2(Z);return Y===$?Y:Z}function BV(Z,$){return L1(Z.const)?FV($,Z.const):r(Z.const)?SV($,Z.const):F6(Z.const)?NV($,Z.const):$}function g2(Z){return V4(Z)?!0:E4(Z)?!1:Z}function LV(Z){let $=(Y)=>Y.split(".")[0];return Y9(Z)?BigInt($(Z)):r(Z)?BigInt(Math.trunc(Z)):E4(Z)?BigInt(0):V4(Z)?BigInt(1):Z}function y2(Z){return T6(Z)&&Z.description!==void 0?Z.description.toString():MV(Z)?Z.toString():Z}function v2(Z){return Y9(Z)?parseFloat(Z):V4(Z)?1:E4(Z)?0:Z}function _V(Z){return Y9(Z)?parseInt(Z):r(Z)?Math.trunc(Z):V4(Z)?1:E4(Z)?0:Z}function KV(Z){return L1(Z)&&Z.toLowerCase()==="null"?null:Z}function RV(Z){return L1(Z)&&Z==="undefined"?void 0:Z}function VV(Z){return y0(Z)?Z:r(Z)?new Date(Z):V4(Z)?new Date(1):E4(Z)?new Date(0):Y9(Z)?new Date(parseInt(Z)):DV(Z)?new Date(`1970-01-01T${Z}.000Z`):wV(Z)?new Date(`1970-01-01T${Z}`):AV(Z)?new Date(`${Z}.000Z`):qV(Z)?new Date(Z):OV(Z)?new Date(`${Z}T00:00:00.000Z`):Z}function EV(Z){return Z}function jV(Z,$,Y){return(Z1(Y)?Y:[Y]).map((W)=>X6(Z.items,$,W))}function CV(Z,$,Y){return LV(Y)}function IV(Z,$,Y){return g2(Y)}function PV(Z,$,Y){return VV(Y)}function xV(Z,$,Y){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return X6(W,[...$,...X],Y)}function TV(Z,$,Y){return _V(Y)}function kV(Z,$,Y){return Z.allOf.reduce((X,W)=>X6(W,$,X),Y)}function bV(Z,$,Y){return BV(Z,Y)}function fV(Z,$,Y){return KV(Y)}function gV(Z,$,Y){return v2(Y)}function yV(Z,$,Y){if(!U1(Y))return Y;for(let X of Object.getOwnPropertyNames(Z.properties)){if(!e(Y,X))continue;Y[X]=X6(Z.properties[X],$,Y[X])}return Y}function vV(Z,$,Y){if(!U1(Y))return Y;let W=Object.getOwnPropertyNames(Z.patternProperties)[0],J=Z.patternProperties[W];for(let[z,Q]of Object.entries(Y))Y[z]=X6(J,$,Q);return Y}function hV(Z,$,Y){return X6(R1(Z,$),$,Y)}function dV(Z,$,Y){return y2(Y)}function pV(Z,$,Y){return L1(Y)||r(Y)?Symbol(Y):Y}function mV(Z,$,Y){return X6(R1(Z,$),$,Y)}function cV(Z,$,Y){if(!(Z1(Y)&&!n1(Z.items)))return Y;return Y.map((W,J)=>{return J<Z.items.length?X6(Z.items[J],$,W):W})}function uV(Z,$,Y){return RV(Y)}function iV(Z,$,Y){for(let X of Z.anyOf){let W=X6(X,$,V1(Y));if(!M1(X,$,W))continue;return W}return Y}function X6(Z,$,Y){let X=F0(Z,$),W=Z;switch(Z[_]){case"Array":return jV(W,X,Y);case"BigInt":return CV(W,X,Y);case"Boolean":return IV(W,X,Y);case"Date":return PV(W,X,Y);case"Import":return xV(W,X,Y);case"Integer":return TV(W,X,Y);case"Intersect":return kV(W,X,Y);case"Literal":return bV(W,X,Y);case"Null":return fV(W,X,Y);case"Number":return gV(W,X,Y);case"Object":return yV(W,X,Y);case"Record":return vV(W,X,Y);case"Ref":return hV(W,X,Y);case"String":return dV(W,X,Y);case"Symbol":return pV(W,X,Y);case"This":return mV(W,X,Y);case"Tuple":return cV(W,X,Y);case"Undefined":return uV(W,X,Y);case"Union":return iV(W,X,Y);default:return EV(Y)}}function X9(...Z){return Z.length===3?X6(Z[0],Z[1],Z[2]):X6(Z[0],[],Z[1])}function h2(...Z){let[$,Y,X]=Z.length===3?[Z[0],Z[1],Z[2]]:[Z[0],[],Z[1]];if(!M1($,Y,X))throw new _4($,X,_6($,Y,X).First());return p6($,Y)?T$($,Y,X):X}function c6(Z,$){let Y=e(Z,"default")?Z.default:void 0,X=$Z(Y)?Y():V1(Y);return n1($)?X:U1($)&&U1(X)?Object.assign(X,$):$}function B5(Z){return XZ(Z)&&"default"in Z}function lV(Z,$,Y){if(Z1(Y)){for(let W=0;W<Y.length;W++)Y[W]=h0(Z.items,$,Y[W]);return Y}let X=c6(Z,Y);if(!Z1(X))return X;for(let W=0;W<X.length;W++)X[W]=h0(Z.items,$,X[W]);return X}function nV(Z,$,Y){return y0(Y)?Y:c6(Z,Y)}function oV(Z,$,Y){let X=globalThis.Object.values(Z.$defs),W=Z.$defs[Z.$ref];return h0(W,[...$,...X],Y)}function tV(Z,$,Y){let X=c6(Z,Y);return Z.allOf.reduce((W,J)=>{let z=h0(J,$,X);return U1(z)?{...W,...z}:z},{})}function sV(Z,$,Y){let X=c6(Z,Y);if(!U1(X))return X;let W=Object.getOwnPropertyNames(Z.properties);for(let J of W){let z=h0(Z.properties[J],$,X[J]);if(n1(z))continue;X[J]=h0(Z.properties[J],$,X[J])}if(!B5(Z.additionalProperties))return X;for(let J of Object.getOwnPropertyNames(X)){if(W.includes(J))continue;X[J]=h0(Z.additionalProperties,$,X[J])}return X}function rV(Z,$,Y){let X=c6(Z,Y);if(!U1(X))return X;let W=Z.additionalProperties,[J,z]=Object.entries(Z.patternProperties)[0],Q=new RegExp(J);for(let U of Object.getOwnPropertyNames(X)){if(!(Q.test(U)&&B5(z)))continue;X[U]=h0(z,$,X[U])}if(!B5(W))return X;for(let U of Object.getOwnPropertyNames(X)){if(Q.test(U))continue;X[U]=h0(W,$,X[U])}return X}function aV(Z,$,Y){return h0(R1(Z,$),$,c6(Z,Y))}function eV(Z,$,Y){return h0(R1(Z,$),$,Y)}function ZE(Z,$,Y){let X=c6(Z,Y);if(!Z1(X)||n1(Z.items))return X;let[W,J]=[Z.items,Math.max(Z.items.length,X.length)];for(let z=0;z<J;z++)if(z<W.length)X[z]=h0(W[z],$,X[z]);return X}function $E(Z,$,Y){let X=c6(Z,Y);for(let W of Z.anyOf){let J=h0(W,$,V1(X));if(M1(W,$,J))return J}return X}function h0(Z,$,Y){let X=F0(Z,$),W=Z;switch(W[_]){case"Array":return lV(W,X,Y);case"Date":return nV(W,X,Y);case"Import":return oV(W,X,Y);case"Intersect":return tV(W,X,Y);case"Object":return sV(W,X,Y);case"Record":return rV(W,X,Y);case"Ref":return aV(W,X,Y);case"This":return eV(W,X,Y);case"Tuple":return ZE(W,X,Y);case"Union":return $E(W,X,Y);default:return c6(W,Y)}}function W9(...Z){return Z.length===3?h0(Z[0],Z[1],Z[2]):h0(Z[0],[],Z[1])}var W6={};ZZ(W6,{ValuePointerRootSetError:()=>L5,ValuePointerRootDeleteError:()=>_5,Set:()=>YE,Has:()=>WE,Get:()=>JE,Format:()=>j4,Delete:()=>XE});class L5 extends a{constructor(Z,$,Y){super("Cannot set root value");this.value=Z,this.path=$,this.update=Y}}class _5 extends a{constructor(Z,$){super("Cannot delete root value");this.value=Z,this.path=$}}function d2(Z){return Z.indexOf("~")===-1?Z:Z.replace(/~1/g,"/").replace(/~0/g,"~")}function*j4(Z){if(Z==="")return;let[$,Y]=[0,0];for(let X=0;X<Z.length;X++)if(Z.charAt(X)==="/")if(X===0)$=X+1;else Y=X,yield d2(Z.slice($,Y)),$=X+1;else Y=X;yield d2(Z.slice($))}function YE(Z,$,Y){if($==="")throw new L5(Z,$,Y);let[X,W,J]=[null,Z,""];for(let z of j4($)){if(W[z]===void 0)W[z]={};X=W,W=W[z],J=z}X[J]=Y}function XE(Z,$){if($==="")throw new _5(Z,$);let[Y,X,W]=[null,Z,""];for(let J of j4($)){if(X[J]===void 0||X[J]===null)return;Y=X,X=X[J],W=J}if(Array.isArray(Y)){let J=parseInt(W);Y.splice(J,1)}else delete Y[W]}function WE(Z,$){if($==="")return!0;let[Y,X,W]=[null,Z,""];for(let J of j4($)){if(X[J]===void 0)return!1;Y=X,X=X[J],W=J}return Object.getOwnPropertyNames(Y).includes(W)}function JE(Z,$){if($==="")return Z;let Y=Z;for(let X of j4($)){if(Y[X]===void 0)return;Y=Y[X]}return Y}function zE(Z,$){if(!U1($))return!1;let Y=[...Object.keys(Z),...Object.getOwnPropertySymbols(Z)],X=[...Object.keys($),...Object.getOwnPropertySymbols($)];if(Y.length!==X.length)return!1;return Y.every((W)=>cZ(Z[W],$[W]))}function QE(Z,$){return y0($)&&Z.getTime()===$.getTime()}function GE(Z,$){if(!Z1($)||Z.length!==$.length)return!1;return Z.every((Y,X)=>cZ(Y,$[X]))}function UE(Z,$){if(!R8($)||Z.length!==$.length||Object.getPrototypeOf(Z).constructor.name!==Object.getPrototypeOf($).constructor.name)return!1;return Z.every((Y,X)=>cZ(Y,$[X]))}function HE(Z,$){return Z===$}function cZ(Z,$){if(y0(Z))return QE(Z,$);if(R8(Z))return UE(Z,$);if(Z1(Z))return GE(Z,$);if(U1(Z))return zE(Z,$);if(w8(Z))return HE(Z,$);throw new Error("ValueEquals: Unable to compare value")}var ME=I1({type:S1("insert"),path:v0(),value:r8()}),wE=I1({type:S1("update"),path:v0(),value:r8()}),DE=I1({type:S1("delete"),path:v0()}),m2=C1([ME,wE,DE]);class K5 extends a{constructor(Z,$){super($);this.value=Z}}function J9(Z,$){return{type:"update",path:Z,value:$}}function c2(Z,$){return{type:"insert",path:Z,value:$}}function u2(Z){return{type:"delete",path:Z}}function p2(Z){if(globalThis.Object.getOwnPropertySymbols(Z).length>0)throw new K5(Z,"Cannot diff objects with symbols")}function*qE(Z,$,Y){if(p2($),p2(Y),!iX(Y))return yield J9(Z,Y);let X=globalThis.Object.getOwnPropertyNames($),W=globalThis.Object.getOwnPropertyNames(Y);for(let J of W){if(e($,J))continue;yield c2(`${Z}/${J}`,Y[J])}for(let J of X){if(!e(Y,J))continue;if(cZ($,Y))continue;yield*z9(`${Z}/${J}`,$[J],Y[J])}for(let J of X){if(e(Y,J))continue;yield u2(`${Z}/${J}`)}}function*AE(Z,$,Y){if(!Z1(Y))return yield J9(Z,Y);for(let X=0;X<Math.min($.length,Y.length);X++)yield*z9(`${Z}/${X}`,$[X],Y[X]);for(let X=0;X<Y.length;X++){if(X<$.length)continue;yield c2(`${Z}/${X}`,Y[X])}for(let X=$.length-1;X>=0;X--){if(X<Y.length)continue;yield u2(`${Z}/${X}`)}}function*OE(Z,$,Y){if(!R8(Y)||$.length!==Y.length||globalThis.Object.getPrototypeOf($).constructor.name!==globalThis.Object.getPrototypeOf(Y).constructor.name)return yield J9(Z,Y);for(let X=0;X<Math.min($.length,Y.length);X++)yield*z9(`${Z}/${X}`,$[X],Y[X])}function*FE(Z,$,Y){if($===Y)return;yield J9(Z,Y)}function*z9(Z,$,Y){if(iX($))return yield*qE(Z,$,Y);if(Z1($))return yield*AE(Z,$,Y);if(R8($))return yield*OE(Z,$,Y);if(w8($))return yield*FE(Z,$,Y);throw new K5($,"Unable to diff value")}function i2(Z,$){return[...z9("",Z,$)]}function SE(Z){return Z.length>0&&Z[0].path===""&&Z[0].type==="update"}function NE(Z){return Z.length===0}function l2(Z,$){if(SE($))return V1($[0].value);if(NE($))return V1(Z);let Y=V1(Z);for(let X of $)switch(X.type){case"insert":{W6.Set(Y,X.path,X.value);break}case"update":{W6.Set(Y,X.path,X.value);break}case"delete":{W6.Delete(Y,X.path);break}}return Y}function n2(...Z){let[$,Y,X]=Z.length===3?[Z[0],Z[1],Z[2]]:[Z[0],[],Z[1]],W=p6($,Y)?k$($,Y,X):X;if(!M1($,Y,W))throw new K4($,W,_6($,Y,W).First());return W}function Q9(Z){return U1(Z)&&!Z1(Z)}class R5 extends a{constructor(Z){super(Z)}}function BE(Z,$,Y,X){if(!Q9(Y))W6.Set(Z,$,V1(X));else{let W=Object.getOwnPropertyNames(Y),J=Object.getOwnPropertyNames(X);for(let z of W)if(!J.includes(z))delete Y[z];for(let z of J)if(!W.includes(z))Y[z]=null;for(let z of J)V5(Z,`${$}/${z}`,Y[z],X[z])}}function LE(Z,$,Y,X){if(!Z1(Y))W6.Set(Z,$,V1(X));else{for(let W=0;W<X.length;W++)V5(Z,`${$}/${W}`,Y[W],X[W]);Y.splice(X.length)}}function _E(Z,$,Y,X){if(R8(Y)&&Y.length===X.length)for(let W=0;W<Y.length;W++)Y[W]=X[W];else W6.Set(Z,$,V1(X))}function KE(Z,$,Y,X){if(Y===X)return;W6.Set(Z,$,X)}function V5(Z,$,Y,X){if(Z1(X))return LE(Z,$,Y,X);if(R8(X))return _E(Z,$,Y,X);if(Q9(X))return BE(Z,$,Y,X);if(w8(X))return KE(Z,$,Y,X)}function o2(Z){return R8(Z)||w8(Z)}function RE(Z,$){return Q9(Z)&&Z1($)||Z1(Z)&&Q9($)}function t2(Z,$){if(o2(Z)||o2($))throw new R5("Only object and array types can be mutated at the root level");if(RE(Z,$))throw new R5("Cannot assign due type mismatch of assignable values");V5(Z,"",Z,$)}class j5 extends a{constructor(Z){super(Z)}}var E5;(function(Z){let $=new Map([["Assert",(J,z,Q)=>{return Z9(J,z,Q),Q}],["Cast",(J,z,Q)=>R4(J,z,Q)],["Clean",(J,z,Q)=>$9(J,z,Q)],["Clone",(J,z,Q)=>V1(Q)],["Convert",(J,z,Q)=>X9(J,z,Q)],["Decode",(J,z,Q)=>p6(J,z)?T$(J,z,Q):Q],["Default",(J,z,Q)=>W9(J,z,Q)],["Encode",(J,z,Q)=>p6(J,z)?k$(J,z,Q):Q]]);function Y(J){$.delete(J)}Z.Delete=Y;function X(J,z){$.set(J,z)}Z.Set=X;function W(J){return $.get(J)}Z.Get=W})(E5||(E5={}));var s2=["Clone","Clean","Default","Convert","Assert","Decode"];function VE(Z,$,Y,X){return Z.reduce((W,J)=>{let z=E5.Get(J);if(n1(z))throw new j5(`Unable to find Parse operation '${J}'`);return z($,Y,W)},X)}function r2(...Z){let[$,Y,X,W]=Z.length===4?[Z[0],Z[1],Z[2],Z[3]]:Z.length===3?Z1(Z[0])?[Z[0],Z[1],[],Z[2]]:[s2,Z[0],Z[1],Z[2]]:Z.length===2?[s2,Z[0],[],Z[1]]:(()=>{throw new j5("Invalid Arguments")})();return VE($,Y,X,W)}var X1={};ZZ(X1,{ValueErrorIterator:()=>pZ,Patch:()=>l2,Parse:()=>r2,Mutate:()=>t2,Hash:()=>HZ,Errors:()=>_6,Equal:()=>cZ,Encode:()=>n2,Edit:()=>m2,Diff:()=>i2,Default:()=>W9,Decode:()=>h2,Create:()=>k8,Convert:()=>X9,Clone:()=>V1,Clean:()=>$9,Check:()=>M1,Cast:()=>R4,Assert:()=>Z9});var S9=hX($Q(),1);var h5={date:RQ,time:f5(!0),"date-time":YQ(!0),"iso-time":f5(!1),"iso-date-time":YQ(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:iE,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:aE,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:lE,int32:{type:"number",validate:tE},int64:{type:"number",validate:sE},float:{type:"number",validate:WQ},double:{type:"number",validate:WQ},password:!0,binary:!0};function vE(Z){return Z%4===0&&(Z%100!==0||Z%400===0)}var hE=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,dE=[0,31,28,31,30,31,30,31,31,30,31,30,31];function RQ(Z){let $=hE.exec(Z);if(!$)return!1;let Y=+$[1],X=+$[2],W=+$[3];return X>=1&&X<=12&&W>=1&&W<=(X===2&&vE(Y)?29:dE[X])}var pE=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function f5(Z){return function $(Y){let X=pE.exec(Y);if(!X)return!1;let W=+X[1],J=+X[2],z=+X[3],Q=X[4],U=X[5]==="-"?-1:1,G=+(X[6]||0),H=+(X[7]||0);if(G>23||H>59||Z&&!Q)return!1;if(W<=23&&J<=59&&z<60)return!0;let M=J-H*U,q=W-G*U-(M<0?1:0);return(q===23||q===-1)&&(M===59||M===-1)&&z<61}}var mE=/t|\s/i;function YQ(Z){let $=f5(Z);return function Y(X){let W=X.split(mE);return W.length===2&&RQ(W[0])&&$(W[1])}}var cE=/\/|:/,uE=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function iE(Z){return cE.test(Z)&&uE.test(Z)}var XQ=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function lE(Z){return XQ.lastIndex=0,XQ.test(Z)}var nE=-2147483648,oE=2147483647;function tE(Z){return Number.isInteger(Z)&&Z<=oE&&Z>=nE}function sE(Z){return Number.isInteger(Z)}function WQ(){return!0}var rE=/[^\\]\\Z/;function aE(Z){if(rE.test(Z))return!1;try{return new RegExp(Z),!0}catch($){return!1}}var M9="toJSON"in new Headers,JQ=(Z,$)=>{let Y=new URL(Z);return Y.pathname=$,Y.toString()},eE=(Z)=>typeof Z==="function"&&/^\s*class\s+/.test(Z.toString())||Z.toString&&Z.toString().startsWith("[object ")&&Z.toString()!=="[object Object]"||g8(Object.getPrototypeOf(Z)),C5=(Z)=>Z&&typeof Z==="object"&&!Array.isArray(Z),$8=(Z,$,{skipKeys:Y,override:X=!0}={})=>{if(!C5(Z)||!C5($))return Z;for(let[W,J]of Object.entries($)){if(Y?.includes(W))continue;if(!C5(J)||!(W in Z)||eE(J)){if(X||!(W in Z))Z[W]=J;continue}Z[W]=$8(Z[W],J,{skipKeys:Y,override:X})}return Z},Zj=(Z,$)=>{let Y=$8(Object.assign({},Z),$,{skipKeys:["properties"]});if("properties"in Y)delete Y.properties;return Y},$0=(Z=[],$=[])=>{if(!Z)return;if(!$)return Z;let Y=[],X=[];if(!Array.isArray(Z))Z=[Z];if(!Array.isArray($))$=[$];for(let W of Z)if(Y.push(W),W.checksum)X.push(W.checksum);for(let W of $)if(!X.includes(W.checksum))Y.push(W);return Y},$j=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],Yj=$j.reduce((Z,$)=>(Z[$]=!0,Z),{}),VQ=(Z,$)=>{let Y=(X)=>typeof X==="object"&&Object.keys(X).every(d5);if(Y(Z)&&Y($))return Object.assign(Z,$);else if(Z&&!Y(Z)&&Y($))return Object.assign({200:Z},$);return $??Z},C4=(Z,$)=>{return{body:$?.body??Z?.body,headers:$?.headers??Z?.headers,params:$?.params??Z?.params,query:$?.query??Z?.query,cookie:$?.cookie??Z?.cookie,response:VQ(Z?.response,$?.response)}},u6=(Z,$)=>{let{resolve:Y,...X}=Z??{},{resolve:W,...J}=$??{};return{...X,...J,body:$?.body??Z?.body,headers:$?.headers??Z?.headers,params:$?.params??Z?.params,query:$?.query??Z?.query,cookie:$?.cookie??Z?.cookie,response:VQ(Z?.response,$?.response),type:Z?.type||$?.type,detail:$8($?.detail??{},Z?.detail??{}),parse:$0(Z?.parse,$?.parse),transform:$0(Z?.transform,$?.transform),beforeHandle:$0($0(B0(Y,"resolve"),Z?.beforeHandle),$0(B0(W,"resolve"),$?.beforeHandle)),afterHandle:$0(Z?.afterHandle,$?.afterHandle),mapResponse:$0(Z?.mapResponse,$?.mapResponse),afterResponse:$0(Z?.afterResponse,$?.afterResponse),trace:$0(Z?.trace,$?.trace),error:$0(Z?.error,$?.error)}},g5=(Z,$,Y=!0)=>{if(!Array.isArray($))return $.original=Z,R0(Z,$,Y);for(let X of $)X.original=Z,Z=R0(Z,X,Y);return Z},R0=(Z,$,Y=!0)=>{if(!Z)return Z;if($.untilObjectFound&&!Y&&Z.type==="object")return Z;let X=$.from[_];if(Z.oneOf){for(let z=0;z<Z.oneOf.length;z++)Z.oneOf[z]=R0(Z.oneOf[z],$,Y);return Z}if(Z.anyOf){for(let z=0;z<Z.anyOf.length;z++)Z.anyOf[z]=R0(Z.anyOf[z],$,Y);return Z}if(Z.allOf){for(let z=0;z<Z.allOf.length;z++)Z.allOf[z]=R0(Z.allOf[z],$,Y);return Z}if(Z.not)return R0(Z.not,$,Y);let W=Y&&!!$.excludeRoot;if(Z[_]===X){let{anyOf:z,oneOf:Q,allOf:U,not:G,properties:H,items:M,...q}=Z,w=$.to(q);if(!w)return Z;let B,D=(L)=>{if(H&&L.type==="object"){let s={};for(let[t,J1]of Object.entries(H))s[t]=R0(J1,$,!1);return{...q,...L,properties:s}}if(M&&L.type==="array")return{...q,...L,items:R0(M,$,!1)};let b={...q,...L};if(delete b.required,H&&L.type==="string"&&L.format==="ObjectString"&&L.default==="{}")B=v.ObjectString(H,q),b.default=JSON.stringify(X1.Create(v.Object(H))),b.properties=H;if(M&&L.type==="string"&&L.format==="ArrayString"&&L.default==="[]")B=v.ArrayString(M,q),b.default=JSON.stringify(X1.Create(v.Array(M))),b.items=M;return b};if(W){if(H){let L={};for(let[b,s]of Object.entries(H))L[b]=R0(s,$,!1);return{...q,properties:L}}else if(M?.map)return{...q,items:M.map((L)=>R0(L,$,!1))};return q}if(w.anyOf)for(let L=0;L<w.anyOf.length;L++)w.anyOf[L]=D(w.anyOf[L]);else if(w.oneOf)for(let L=0;L<w.oneOf.length;L++)w.oneOf[L]=D(w.oneOf[L]);else if(w.allOf)for(let L=0;L<w.allOf.length;L++)w.allOf[L]=D(w.allOf[L]);else if(w.not)w.not=D(w.not);if(B)w[y1]=B[y1];if(w.anyOf||w.oneOf||w.allOf||w.not)return w;if(H){let L={};for(let[b,s]of Object.entries(H))L[b]=R0(s,$,!1);return{...q,...w,properties:L}}else if(M?.map)return{...q,...w,items:M.map((L)=>R0(L,$,!1))};return{...q,...w}}let J=Z?.properties;if(J&&Y&&$.rootOnly!==!0)for(let[z,Q]of Object.entries(J))switch(Q[_]){case X:let{anyOf:U,oneOf:G,allOf:H,not:M,type:q,...w}=Q,B=$.to(w);if(!B)return Z;if(B.anyOf)for(let D=0;D<B.anyOf.length;D++)B.anyOf[D]={...w,...B.anyOf[D]};else if(B.oneOf)for(let D=0;D<B.oneOf.length;D++)B.oneOf[D]={...w,...B.oneOf[D]};else if(B.allOf)for(let D=0;D<B.allOf.length;D++)B.allOf[D]={...w,...B.allOf[D]};else if(B.not)B.not={...w,...B.not};J[z]={...w,...R0(w,$,!1)};break;case"Object":case"Union":J[z]=R0(Q,$,!1);break;default:if(Array.isArray(Q.items))for(let D=0;D<Q.items.length;D++)Q.items[D]=R0(Q.items[D],$,!1);else if(Q.anyOf||Q.oneOf||Q.allOf||Q.not)J[z]=R0(Q,$,!1);else if(Q.type==="array")Q.items=R0(Q.items,$,!1);break}return Z},T4=(Z)=>($)=>{if(typeof $==="object")try{return X1.Clean(Z,structuredClone($))}catch{try{return X1.Clean(Z,$)}catch{return $}}return $},Y8=(Z,{models:$={},dynamic:Y=!1,modules:X,normalize:W=!1,additionalProperties:J=!1,coerce:z=!1,additionalCoerce:Q=[]}={modules:v.Module({})})=>{if(!Z)return;let U;if(typeof Z!=="string")U=Z;else{let H=Z.endsWith("[]"),M=H?Z.substring(0,Z.length-2):Z;if(U=X.Import(M)??$[M],H)U=v.Array(U)}if(!U)return;if(z||Q)if(z)U=g5(U,[{from:v.Ref(""),to:(H)=>X.Import(H.$ref)},{from:v.Number(),to:(H)=>v.Numeric(H),untilObjectFound:!0},{from:v.Boolean(),to:(H)=>v.BooleanString(H),untilObjectFound:!0},...Array.isArray(Q)?Q:[Q]]);else U=g5(U,[{from:v.Ref(""),to:(H)=>X.Import(H.$ref)},...Array.isArray(Q)?Q:[Q]]);if(U.type==="object"&&"additionalProperties"in U===!1)U.additionalProperties=J;if(Y){let H={schema:U,references:"",checkFunc:()=>{},code:"",Check:(M)=>X1.Check(U,M),Errors:(M)=>X1.Errors(U,M),Code:()=>"",Clean:T4(U),Decode:(M)=>X1.Decode(U,M),Encode:(M)=>X1.Encode(U,M)};if(W&&U.additionalProperties===!1)H.Clean=T4(U);if(U.config){if(H.config=U.config,H?.schema?.config)delete H.schema.config}return H.parse=(M)=>{try{return H.Decode(M)}catch(q){throw[...H.Errors(M)].map(G6)}},H.safeParse=(M)=>{try{return{success:!0,data:H.Decode(M),error:null}}catch(q){let w=[...G.Errors(M)].map(G6);return{success:!1,data:null,error:w[0]?.summary,errors:w}}},H}let G=MZ.Compile(U,Object.values($));if(G.Clean=T4(U),U.config){if(G.config=U.config,G?.schema?.config)delete G.schema.config}return G.parse=(H)=>{try{return G.Decode(H)}catch(M){throw[...G.Errors(H)].map(G6)}},G.safeParse=(H)=>{try{return{success:!0,data:G.Decode(H),error:null}}catch(M){let q=[...G.Errors(H)].map(G6);return{success:!1,data:null,error:q[0]?.summary,errors:q}}},G},zQ=(Z,{models:$={},modules:Y,dynamic:X=!1,normalize:W=!1,additionalProperties:J=!1})=>{if(!Z)return;let z;if(typeof Z!=="string")z=Z;else{let H=Z.endsWith("[]"),M=H?Z.substring(0,Z.length-2):Z;if(z=Y.Import(M)??$[M],H)z=v.Array(z)}if(!z)return;let Q=(H,M)=>{if(X)return{schema:H,references:"",checkFunc:()=>{},code:"",Check:(w)=>X1.Check(H,w),Errors:(w)=>X1.Errors(H,w),Code:()=>"",Clean:T4(H),Decode:(w)=>X1.Decode(H,w),Encode:(w)=>X1.Encode(H,w)};let q=MZ.Compile(H,M);if(W&&H.additionalProperties===!1)q.Clean=T4(H);return q},U=Object.values($);if(_ in z){if("additionalProperties"in z===!1)z.additionalProperties=J;return{200:Q(z,U)}}let G={};return Object.keys(z).forEach((H)=>{let M=z[+H];if(typeof M==="string"){if(M in $){let q=$[M];q.type==="object"&&"additionalProperties"in q,G[+H]=_ in q?Q(q,U):q}return}if(M.type==="object"&&"additionalProperties"in M===!1)M.additionalProperties=J;G[+H]=_ in M?Q(M,U):M}),G},Xj=typeof Bun!=="undefined",Wj=Xj&&typeof Bun.hash==="function",I4=(Z)=>{if(Wj)return Bun.hash(Z);let $=9;for(let Y=0;Y<Z.length;)$=Math.imul($^Z.charCodeAt(Y++),387420489);return $=$^$>>>9},I5,uZ=()=>{if(!I5)I5=[{from:v.Object({}),to:()=>v.ObjectString({}),excludeRoot:!0},{from:v.Array(v.Any()),to:()=>v.ArrayString(v.Any())}];return I5},P5,QQ=()=>{if(!P5)P5=[{from:v.Number(),to:(Z)=>v.Numeric(Z),rootOnly:!0},{from:v.Boolean(),to:(Z)=>v.BooleanString(Z),rootOnly:!0}];return P5},EQ=({validator:Z,modules:$,defaultConfig:Y={},config:X,dynamic:W,models:J})=>{let z=Y8(Z,{modules:$,dynamic:W,models:J,additionalProperties:!0,coerce:!0,additionalCoerce:uZ()});if(g8(Y))if(z)z.config=Zj(z.config,X);else z=Y8(v.Cookie({}),{modules:$,dynamic:W,models:J,additionalProperties:!0}),z.config=Y;return z},J6=(Z,$)=>{if(!$)return;if(!Array.isArray($)){let X=$;if(Z&&!X.checksum)X.checksum=Z;if(X.scope==="scoped")X.scope="local";return X}let Y=[...$];for(let X of Y){if(Z&&!X.checksum)X.checksum=Z;if(X.scope==="scoped")X.scope="local"}return Y},GQ=(Z,$,Y)=>{return{start:$0(Z.start,J6(Y,$?.start)),request:$0(Z.request,J6(Y,$?.request)),parse:$0(Z.parse,J6(Y,$?.parse)),transform:$0(Z.transform,J6(Y,$?.transform)),beforeHandle:$0($0(B0(Z.resolve,"resolve"),Z.beforeHandle),J6(Y,$0(B0($?.resolve,"resolve"),$?.beforeHandle))),afterHandle:$0(Z.afterHandle,J6(Y,$?.afterHandle)),mapResponse:$0(Z.mapResponse,J6(Y,$?.mapResponse)),afterResponse:$0(Z.afterResponse,J6(Y,$?.afterResponse)),trace:$0(Z.trace,J6(Y,$?.trace)),error:$0(Z.error,J6(Y,$?.error)),stop:$0(Z.stop,J6(Y,$?.stop))}},Jj=(Z,$,{skipIfHasType:Y=!1}={})=>{if(!Z)return Z;if(!Array.isArray(Z)){if(Y)Z.scope??=$;else Z.scope=$;return Z}for(let X of Z)if(Y)X.scope??=$;else X.scope=$;return Z},wZ=(Z)=>{if(!Z)return Z;if(!Array.isArray(Z))switch(Z.scope){case"global":case"scoped":return{...Z};default:return{fn:Z}}let $=[];for(let Y of Z)switch(Y.scope){case"global":case"scoped":$.push({...Y});break}return $},UQ=(Z)=>{return{...Z,type:Z?.type,detail:Z?.detail,parse:wZ(Z?.parse),transform:wZ(Z?.transform),beforeHandle:wZ(Z?.beforeHandle),afterHandle:wZ(Z?.afterHandle),mapResponse:wZ(Z?.mapResponse),afterResponse:wZ(Z?.afterResponse),error:wZ(Z?.error),trace:wZ(Z?.trace)}},O9={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},HQ=Object.fromEntries(Object.entries(O9).map(([Z,$])=>[$,Z]));function zj(Z){let $=Z;while($.endsWith("="))$=$.slice(0,-1);return $}var MQ=new TextEncoder,w9=async(Z,$)=>{if(typeof Z!=="string")throw new TypeError("Cookie value must be provided as a string.");if($===null)throw new TypeError("Secret key must be provided.");let Y=await crypto.subtle.importKey("raw",MQ.encode($),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),X=await crypto.subtle.sign("HMAC",Y,MQ.encode(Z));return Z+"."+zj(Buffer.from(X).toString("base64"))},wQ=async(Z,$)=>{if(typeof Z!=="string")throw new TypeError("Signed cookie string must be provided.");if($===null)throw new TypeError("Secret key must be provided.");let Y=Z.slice(0,Z.lastIndexOf("."));return await w9(Y,$)===Z?Y:!1},Qj=(Z,$,Y)=>{if(!Z||typeof Z!=="object"||!$)return;for(let[X,W]of Object.entries($)){if(X in Yj||!(X in Z))continue;let J=Z[X];if(typeof J==="function"){let z=J(W);if(typeof z==="object")for(let[Q,U]of Object.entries(z))Y(Q)({fn:U})}delete $[X]}},Gj=({globalHook:Z,localHook:$})=>(Y)=>(X,W)=>{if(typeof X==="function")X={fn:X};if(Y==="resolve")X={...X,subType:"resolve"};if("fn"in X||Array.isArray(X)){if(!$[Y])$[Y]=[];if(typeof $[Y]==="function")$[Y]=[$[Y]];if(Array.isArray(X))$[Y]=$[Y].concat(X);else $[Y].push(X);return}let{insert:J="after",stack:z="local"}=X;if(typeof W==="function")W={fn:W};if(z==="global")if(!Array.isArray(W))if(J==="before")Z[Y].unshift(W);else Z[Y].push(W);else if(J==="before")Z[Y]=W.concat(Z[Y]);else Z[Y]=Z[Y].concat(W);else{if(!$[Y])$[Y]=[];if(typeof $[Y]==="function")$[Y]=[$[Y]];if(!Array.isArray(W))if(J==="before")$[Y].unshift(W);else $[Y].push(W);else if(J==="before")$[Y]=W.concat($[Y]);else $[Y]=$[Y].concat(W)}},Uj=(Z)=>{if(typeof Z==="number")return Z;if(Z.length<16){if(Z.trim().length===0)return null;let $=Number(Z);if(Number.isNaN($))return null;return $}if(Z.length===16){if(Z.trim().length===0)return null;let $=Number(Z);if(Number.isNaN($)||$.toString()!==Z)return null;return $}return null},d5=(Z)=>Uj(Z)!==null;class jQ{onError;root=null;promises=[];constructor(Z=console.error){this.onError=Z}get size(){return this.promises.length}add(Z){return this.promises.push(Z),this.root||=this.drain(),Z}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch(Z){this.onError(Z)}this.promises.shift()}this.root=null}then(Z,$){return(this.root??Promise.resolve()).then(Z,$)}}var B0=(Z,$)=>{if(!Z)return Z;if(!Array.isArray(Z)){if(typeof Z==="function"||typeof Z==="string")return $?{fn:Z,subType:$}:{fn:Z};else if("fn"in Z)return Z}let Y=[];for(let X of Z)if(typeof X==="function"||typeof X==="string")Y.push($?{fn:X,subType:$}:{fn:X});else if("fn"in X)Y.push(X);return Y},Hj=(Z)=>{return{...Z,start:B0(Z?.start),request:B0(Z?.request),parse:B0(Z?.parse),transform:B0(Z?.transform),beforeHandle:B0(Z?.beforeHandle),afterHandle:B0(Z?.afterHandle),mapResponse:B0(Z?.mapResponse),afterResponse:B0(Z?.afterResponse),trace:B0(Z?.trace),error:B0(Z?.error),stop:B0(Z?.stop)}},DQ=(Z)=>{let $={};if(Z.start?.map)$.start=Z.start.map((Y)=>Y.fn);if(Z.request?.map)$.request=Z.request.map((Y)=>Y.fn);if(Z.parse?.map)$.parse=Z.parse.map((Y)=>Y.fn);if(Z.transform?.map)$.transform=Z.transform.map((Y)=>Y.fn);if(Z.beforeHandle?.map)$.beforeHandle=Z.beforeHandle.map((Y)=>Y.fn);if(Z.afterHandle?.map)$.afterHandle=Z.afterHandle.map((Y)=>Y.fn);if(Z.mapResponse?.map)$.mapResponse=Z.mapResponse.map((Y)=>Y.fn);if(Z.afterResponse?.map)$.afterResponse=Z.afterResponse.map((Y)=>Y.fn);if(Z.trace?.map)$.trace=Z.trace.map((Y)=>Y.fn);if(Z.error?.map)$.error=Z.error.map((Y)=>Y.fn);if(Z.stop?.map)$.stop=Z.stop.map((Y)=>Y.fn);return $},x5=(Z)=>({body:Z.body,cookie:Z.cookie,headers:Z.headers,query:Z.query,set:Z.set,server:Z.server,request:Z.request,route:Z.route}),CQ=(Z,$=302)=>Response.redirect(Z,$),te=Symbol("ElysiaFormData"),F9=Symbol("ElysiaRequestId");var IQ=()=>{let Z=crypto.randomUUID();return Z.slice(0,8)+Z.slice(24,32)},qQ=(Z)=>{let $=[];for(let Y=0;Y<Z.length;Y++){let X=Z[Y];if(X.checksum){if($.includes(X.checksum))Z.splice(Y,1),Y--;$.push(X.checksum)}}return Z},k0=(Z,$="scoped")=>{if(!Z)return;if($==="scoped"){for(let Y of Z)if("scope"in Y&&Y.scope==="local")Y.scope="scoped";return}for(let Y of Z)if("scope"in Y)Y.scope="global"},b$=(Z)=>{if(Z.charCodeAt(Z.length-1)===47)return Z.slice(0,Z.length-1);return Z+"/"},g8=(Z)=>{if(!Z)return!1;for(let $ in Z)return!0;return!1},z6=(Z)=>{if(Array.isArray(Z))return Z.length===0;return!Z},T5=(Z)=>{let $={...Z};if(z6(Z.afterHandle))delete $.afterHandle;if(z6(Z.afterResponse))delete $.afterResponse;if(z6(Z.beforeHandle))delete $.beforeHandle;if(z6(Z.error))delete $.error;if(z6(Z.mapResponse))delete $.mapResponse;if(z6(Z.parse))delete $.parse;if(z6(Z.request))delete $.request;if(z6(Z.start))delete $.start;if(z6(Z.stop))delete $.stop;if(z6(Z.trace))delete $.trace;if(z6(Z.transform))delete $.transform;if(!$.type)delete $.type;if($.detail&&!Object.keys($.detail).length)delete $.detail;if(!$.body)delete $.body;if(!$.cookie)delete $.cookie;if(!$.headers)delete $.headers;if(!$.query)delete $.query;if(!$.params)delete $.params;if(!$.response)delete $.response;return $},P4=(Z,{dynamic:$=!1}={})=>{let Y=encodeURIComponent(Z).replace(/%2F/g,"/");if($)Y=Y.replace(/%3A/g,":").replace(/%3F/g,"?");return Y},AQ=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,D9=Symbol("ElysiaErrorCode"),q9=(AQ?.NODE_ENV??AQ?.ENV)==="production";class U6{code;response;constructor(Z,$){let Y=$??(Z in HQ?HQ[Z]:Z);this.code=O9[Z]??Z,this.response=Y}}var PQ=(Z,$)=>new U6(Z,$);class xQ extends Error{code="INTERNAL_SERVER_ERROR";status=500;constructor(Z){super(Z??"INTERNAL_SERVER_ERROR")}}class p5 extends Error{code="NOT_FOUND";status=404;constructor(Z){super(Z??"NOT_FOUND")}}class TQ extends Error{code="PARSE";status=400;constructor(){super("Bad Request")}}class y5 extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor(Z,$){super($??`"${Z}" has invalid cookie signature`);this.key=Z}}var G6=(Z)=>{if(!Z)return{summary:void 0};let{message:$,path:Y,value:X,type:W}=Z,J=Y.slice(1).replaceAll("/","."),z=Y==="";switch(W){case 42:return{...Z,summary:z?"Value should not be provided":`Property '${J}' should not be provided`};case 45:return{...Z,summary:z?"Value is missing":`Property '${J}' is missing`};case 50:let Q=$.indexOf("'"),U=$.slice(Q+1,$.indexOf("'",Q+1));return{...Z,summary:z?"Value should be an email":`Property '${J}' should be ${U}`};case 54:return{...Z,summary:`${$.slice(0,9)} property '${J}' to be ${$.slice(8)} but found: ${X}`};case 62:let G=Z.schema.anyOf.map((H)=>`'${H?.format??H.type}'`).join(", ");return{...Z,summary:z?`Value should be one of ${G}`:`Property '${J}' should be one of: ${G}`};default:return{summary:$,...Z}}};class w1 extends Error{type;validator;value;code="VALIDATION";status=422;constructor(Z,$,Y){if(Y&&typeof Y==="object"&&Y instanceof U6)Y=Y.response;let X=q9?void 0:("Errors"in $)?$.Errors(Y).First():X1.Errors($,Y).First(),W=X?.schema?.message||X?.schema?.error!==void 0?typeof X.schema.error==="function"?X.schema.error({type:Z,validator:$,value:Y,get errors(){return[...$.Errors(Y)].map(G6)}}):X.schema.error:void 0,J=X?.path||"root",z="";if(W!==void 0)z=typeof W==="object"?JSON.stringify(W):W+"";else if(q9)z=JSON.stringify({type:"validation",on:Z,summary:G6(X).summary,message:X?.message,found:Y});else{let Q=$?.schema??$,U="Errors"in $?[...$.Errors(Y)].map(G6):[...X1.Errors($,Y)].map(G6),G;try{G=X1.Create(Q)}catch(H){G={type:"Could not create expected value",message:H?.message,error:H}}z=JSON.stringify({type:"validation",on:Z,summary:G6(X).summary,property:J,message:X?.message,expected:G,found:Y,errors:U},null,2)}super(z);this.type=Z,this.validator=$,this.value=Y,Object.setPrototypeOf(this,w1.prototype)}get all(){return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(G6):[...X1.Errors(this.validator,this.value)].map(G6)}static simplifyModel(Z){let $="schema"in Z?Z.schema:Z;try{return X1.Create($)}catch{return $}}get model(){return w1.simplifyModel(this.validator)}toResponse(Z){return new Response(this.message,{status:400,headers:{...Z,"content-type":"application/json"}})}}var kQ=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,bQ=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,fQ=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,Mj=h5.date,wj=h5["date-time"];if(!x1.Has("date"))x1.Set("date",(Z)=>{let $=Z.replace(/"/g,"");if(kQ.test($)||bQ.test($)||fQ.test($)||Mj($)){let Y=new Date($);if(!Number.isNaN(Y.getTime()))return!0}return!1});if(!x1.Has("date-time"))x1.Set("date-time",(Z)=>{let $=Z.replace(/"/g,"");if(kQ.test($)||bQ.test($)||fQ.test($)||wj($)){let Y=new Date($);if(!Number.isNaN(Y.getTime()))return!0}return!1});Object.entries(h5).forEach((Z)=>{let[$,Y]=Z;if(!x1.Has($)){if(Y instanceof RegExp)x1.Set($,(X)=>Y.test(X));else if(typeof Y==="function")x1.Set($,Y)}});var v=Object.assign({},UZ),OQ=(Z)=>{if(typeof Z==="string")switch(Z.slice(-1)){case"k":return+Z.slice(0,Z.length-1)*1024;case"m":return+Z.slice(0,Z.length-1)*1048576;default:return+Z}return Z},FQ=(Z,$)=>{if(Z.startsWith($))return!0;return $.charCodeAt($.length-1)===42&&$.charCodeAt($.length-2)===47&&Z.startsWith($.slice(0,-1))},v5=(Z,$)=>{if(!($ instanceof Blob))return!1;if(Z.minSize&&$.size<OQ(Z.minSize))return!1;if(Z.maxSize&&$.size>OQ(Z.maxSize))return!1;if(Z.extension){if(typeof Z.extension==="string")return FQ($.type,Z.extension);for(let Y=0;Y<Z.extension.length;Y++)if(FQ($.type,Z.extension[Y]))return!0;return!1}return!0},Dj=gQ("File",v5),qj=gQ("Files",(Z,$)=>{if(!Array.isArray($))return v5(Z,$);if(Z.minItems&&$.length<Z.minItems)return!1;if(Z.maxItems&&$.length>Z.maxItems)return!1;for(let Y=0;Y<$.length;Y++)if(!v5(Z,$[Y]))return!1;return!0});if(!x1.Has("numeric"))x1.Set("numeric",(Z)=>!!Z&&!isNaN(+Z));if(!x1.Has("integer"))x1.Set("integer",(Z)=>!!Z&&Number.isInteger(+Z));if(!x1.Has("boolean"))x1.Set("boolean",(Z)=>Z==="true"||Z==="false");if(!x1.Has("ObjectString"))x1.Set("ObjectString",(Z)=>{let $=Z.charCodeAt(0);if($===9||$===10||$===32)$=Z.trimStart().charCodeAt(0);if($!==123&&$!==91)return!1;try{return JSON.parse(Z),!0}catch{return!1}});if(!x1.Has("ArrayString"))x1.Set("ArrayString",(Z)=>{let $=Z.charCodeAt(0);if($===9||$===10||$===32)$=Z.trimStart().charCodeAt(0);if($!==123&&$!==91)return!1;try{return JSON.parse(Z),!0}catch{return!1}});if(!U0.Has("UnionEnum"))U0.Set("UnionEnum",(Z,$)=>{return(typeof $==="number"||typeof $==="string"||$===null)&&Z.enum.includes($)});var y8={Numeric:(Z)=>{let $=UZ.Number(Z);return v.Transform(v.Union([v.String({format:"numeric",default:0}),v.Number(Z)],Z)).Decode((Y)=>{let X=+Y;if(isNaN(X))return Y;if(Z&&!X1.Check($,X))throw new w1("property",$,X);return X}).Encode((Y)=>Y)},Integer:(Z)=>{let $=UZ.Integer(Z);return v.Transform(v.Union([v.String({format:"integer",default:0}),UZ.Integer(Z)],Z)).Decode((Y)=>{let X=+Y;if(!X1.Check($,X))throw new w1("property",$,X);return X}).Encode((Y)=>Y)},Date:(Z)=>{let $=UZ.Date(Z),Y=Z?.default?new Date(Z.default):void 0;return v.Transform(v.Union([UZ.Date(Z),v.String({format:"date",default:Y?.toISOString()}),v.String({format:"date-time",default:Y?.toISOString()}),v.Number({default:Y?.getTime()})],Z)).Decode((X)=>{if(typeof X==="number"){let J=new Date(X);if(!X1.Check($,J))throw new w1("property",$,J);return J}if(X instanceof Date)return X;let W=new Date(X);if(!W||isNaN(W.getTime()))throw new w1("property",$,W);if(!X1.Check($,W))throw new w1("property",$,W);return W}).Encode((X)=>X.toISOString())},BooleanString:(Z)=>{let $=UZ.Boolean(Z);return v.Transform(v.Union([v.Boolean(Z),v.String({format:"boolean",default:!1})],Z)).Decode((Y)=>{if(typeof Y==="string")return Y==="true";if(Y!==void 0&&!X1.Check($,Y))throw new w1("property",$,Y);return Y}).Encode((Y)=>Y)},ObjectString:(Z,$)=>{let Y=v.Object(Z,$),X=JSON.stringify(X1.Create(Y)),W;try{W=MZ.Compile(Y)}catch{}return v.Transform(v.Union([v.String({format:"ObjectString",default:X}),Y])).Decode((J)=>{if(typeof J==="string"){if(J.charCodeAt(0)!==123)throw new w1("property",Y,J);try{J=JSON.parse(J)}catch{throw new w1("property",Y,J)}if(W){if(!W.Check(J))throw new w1("property",Y,J);return W.Decode(J)}if(!X1.Check(Y,J))throw new w1("property",Y,J);return X1.Decode(Y,J)}return J}).Encode((J)=>{if(typeof J==="string")try{J=JSON.parse(J)}catch{throw new w1("property",Y,J)}if(!X1.Check(Y,J))throw new w1("property",Y,J);return JSON.stringify(J)})},ArrayString:(Z=v.String(),$)=>{let Y=v.Array(Z,$),X;try{X=MZ.Compile(Y)}catch{}let W=(J,z=!1)=>{if(J.charCodeAt(0)===91){try{J=JSON.parse(J)}catch{throw new w1("property",Y,J)}if(X){if(!X.Check(J))throw new w1("property",Y,J);return X.Decode(J)}if(!X1.Check(Y,J))throw new w1("property",Y,J);return X1.Decode(Y,J)}if(J.indexOf(",")!==-1){let Q=J.split(",").map((U)=>U.trim());if(X){if(!X.Check(Q))throw new w1("property",Y,J);return X.Decode(Q)}if(!X1.Check(Y,Q))throw new w1("property",Y,Q);return X1.Decode(Y,Q)}if(z)return J;throw new w1("property",Y,J)};return v.Transform(v.Union([v.String({format:"ArrayString",default:$?.default}),Y])).Decode((J)=>{if(Array.isArray(J)){let z=[];for(let Q=0;Q<J.length;Q++){let U=J[Q];if(typeof U==="string"){let G=W(U,!0);if(Array.isArray(G))z=z.concat(G);else z.push(G);continue}z.push(U)}return z}if(typeof J==="string")return W(J);return J}).Encode((J)=>{if(typeof J==="string")try{J=JSON.parse(J)}catch{throw new w1("property",Y,J)}if(!X1.Check(Y,J))throw new w1("property",Y,J);return JSON.stringify(J)})},File:Dj,Files:(Z={})=>v.Transform(qj(Z)).Decode(($)=>{if(Array.isArray($))return $;return[$]}).Encode(($)=>$),Nullable:(Z,$)=>v.Union([Z,v.Null()],$),MaybeEmpty:(Z,$)=>v.Union([Z,v.Null(),v.Undefined()],$),Cookie:(Z,{domain:$,expires:Y,httpOnly:X,maxAge:W,path:J,priority:z,sameSite:Q,secure:U,secrets:G,sign:H,...M}={})=>{let q=v.Object(Z,M);return q.config={domain:$,expires:Y,httpOnly:X,maxAge:W,path:J,priority:z,sameSite:Q,secure:U,secrets:G,sign:H},q},UnionEnum:(Z,$={})=>{let Y=Z.every((X)=>typeof X==="string")?{type:"string"}:Z.every((X)=>typeof X==="number")?{type:"number"}:Z.every((X)=>X===null)?{type:"null"}:{};if(Z.some((X)=>typeof X==="object"&&X!==null))throw new Error("This type does not support objects or arrays");return{default:Z[0],...$,[_]:"UnionEnum",...Y,enum:Z}}};v.BooleanString=y8.BooleanString;v.ObjectString=y8.ObjectString;v.ArrayString=y8.ArrayString;v.Numeric=y8.Numeric;v.Integer=y8.Integer;v.File=(Z={})=>y8.File({default:"File",...Z,extension:Z?.type,type:"string",format:"binary"});v.Files=(Z={})=>y8.Files({...Z,elysiaMeta:"Files",default:"Files",extension:Z?.type,type:"array",items:{...Z,default:"Files",type:"string",format:"binary"}});v.Nullable=(Z)=>y8.Nullable(Z);v.MaybeEmpty=y8.MaybeEmpty;v.Cookie=y8.Cookie;v.Date=y8.Date;v.UnionEnum=y8.UnionEnum;function gQ(Z,$){if(!U0.Has(Z))U0.Set(Z,$);return(Y={})=>sY({...Y,[_]:Z})}var k4=(Z)=>{let $=typeof Z==="object"?Z.fn.toString():typeof Z==="string"?Z.toString():Z,Y=$.indexOf(")");if($.charCodeAt(Y+2)===61&&$.charCodeAt(Y+5)!==123)return!0;return $.includes("return")},Aj=(Z)=>{if(Z.startsWith("async"))Z=Z.slice(5);Z=Z.trimStart();let $=-1;if(Z.charCodeAt(0)===40){if($=Z.indexOf("=>",Z.indexOf(")")),$!==-1){let W=$;while(W>0)if(Z.charCodeAt(--W)===41)break;let J=Z.slice($+2);if(J.charCodeAt(0)===32)J=J.trimStart();return[Z.slice(1,W),J,{isArrowReturn:J.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test(Z)){if($=Z.indexOf("=>"),$!==-1){let W=Z.slice($+2);if(W.charCodeAt(0)===32)W=W.trimStart();return[Z.slice(0,$),W,{isArrowReturn:W.charCodeAt(0)!==123}]}}if(Z.startsWith("function")){$=Z.indexOf("(");let W=Z.indexOf(")");return[Z.slice($+1,W),Z.slice(W+2),{isArrowReturn:!1}]}let Y=Z.indexOf("(");if(Y!==-1){let W=Z.indexOf(`
`,2),J=Z.slice(0,W),z=J.lastIndexOf(")")+1,Q=Z.slice(W+1);return[J.slice(Y,z),"{"+Q,{isArrowReturn:!1}]}let X=Z.split(`
`,2);return[X[0],X[1],{isArrowReturn:!1}]},Oj=(Z)=>{let $=Z.indexOf("{");if($===-1)return[-1,0];let Y=$+1,X=1;for(;Y<Z.length;Y++){let W=Z.charCodeAt(Y);if(W===123)X++;else if(W===125)X--;if(X===0)break}if(X!==0)return[0,Z.length];return[$,Y+1]},Fj=(Z)=>{let $=Z.lastIndexOf("}");if($===-1)return[-1,0];let Y=$-1,X=1;for(;Y>=0;Y--){let W=Z.charCodeAt(Y);if(W===125)X++;else if(W===123)X--;if(X===0)break}if(X!==0)return[-1,0];return[Y,$+1]},yQ=(Z)=>{while(!0){let $=Z.indexOf(":");if($===-1)break;let Y=Z.indexOf(",",$);if(Y===-1)Y=Z.indexOf("}",$)-1;if(Y===-2)Y=Z.length;Z=Z.slice(0,$)+Z.slice(Y)}return Z},vQ=(Z)=>{let $=!1;if(Z.charCodeAt(0)===40)Z=Z.slice(1,-1);if(Z.charCodeAt(0)===123)$=!0,Z=Z.slice(1,-1);Z=Z.replace(/( |\t|\n)/g,"").trim();let Y=[];while(!0){let[W,J]=Oj(Z);if(W===-1)break;if(Y.push(Z.slice(0,W-1)),Z.charCodeAt(J)===44)J++;Z=Z.slice(J)}if(Z=yQ(Z),Z)Y=Y.concat(Z.split(","));let X=[];for(let W of Y){if(W.indexOf(",")===-1){X.push(W);continue}for(let J of W.split(","))X.push(J.trim())}return Y=X,{hasParenthesis:$,parameters:Y}},Sj=(Z,$)=>{let{parameters:Y,hasParenthesis:X}=vQ(Z);if(!$.query&&Y.includes("query"))$.query=!0;if(!$.headers&&Y.includes("headers"))$.headers=!0;if(!$.body&&Y.includes("body"))$.body=!0;if(!$.cookie&&Y.includes("cookie"))$.cookie=!0;if(!$.set&&Y.includes("set"))$.set=!0;if(!$.server&&Y.includes("server"))$.server=!0;if(!$.request&&Y.includes("request"))$.request=!0;if(!$.route&&Y.includes("route"))$.route=!0;if(X)return`{ ${Y.join(", ")} }`;return Y.join(", ")},SQ=(Z,$,Y)=>{let X=$.indexOf(Z+`
`,Y),W=$.indexOf(Z+"\t",Y),J=$.indexOf(Z+",",Y),z=$.indexOf(Z+";",Y),Q=$.indexOf(Z+" ",Y);return[X,W,J,z,Q].filter((U)=>U>0).sort((U,G)=>U-G)[0]||-1},hQ=(Z,$,Y=0)=>{if(Y>5)return[];let X=[],W=$;while(!0){let J=SQ(" = "+Z,W);if(J===-1)J=SQ("="+Z,W);if(J===-1){let G=W.indexOf(" = "+Z);if(G===-1)G=W.indexOf("="+Z);if(G+3+Z.length!==W.length)break;J=G}let z=W.slice(0,J),Q=z.lastIndexOf(" "),U=z.slice(Q!==-1?Q+1:-1);if(U==="}"){let[G,H]=Fj(z);X.push(yQ(W.slice(G,H))),W=W.slice(J+3+Z.length);continue}while(U.charCodeAt(0)===44)U=U.slice(1);while(U.charCodeAt(0)===9)U=U.slice(1);if(!U.includes("("))X.push(U);W=W.slice(J+3+Z.length)}for(let J of X){if(J.charCodeAt(0)===123)continue;let z=hQ(J,$);if(z.length>0)X.push(...z)}return X},Nj=(Z)=>{if(!Z)return;if(Z.charCodeAt(0)!==123)return Z;if(Z=Z.slice(2,-2),!Z.includes(",")){if(Z.includes("..."))return Z.slice(Z.indexOf("...")+3);return}let $=Z.indexOf("...");if($===-1)return;return Z.slice($+3).trimEnd()},Bj=(Z,$,Y)=>{let X=(W,J)=>Z.includes(J+"."+W)||Z.includes(J+'["'+W+'"]')||Z.includes(J+"['"+W+"']");for(let W of $){if(!W)continue;if(W.charCodeAt(0)===123){let J=vQ(W).parameters;if(!Y.query&&J.includes("query"))Y.query=!0;if(!Y.headers&&J.includes("headers"))Y.headers=!0;if(!Y.body&&J.includes("body"))Y.body=!0;if(!Y.cookie&&J.includes("cookie"))Y.cookie=!0;if(!Y.set&&J.includes("set"))Y.set=!0;if(!Y.query&&J.includes("server"))Y.server=!0;if(!Y.request&&J.includes("request"))Y.request=!0;if(!Y.route&&J.includes("route"))Y.route=!0;continue}if(!Y.query&&X("query",W))Y.query=!0;if(Z.includes("return "+W)||Z.includes("return "+W+".query"))Y.query=!0;if(!Y.headers&&X("headers",W))Y.headers=!0;if(!Y.body&&X("body",W))Y.body=!0;if(!Y.cookie&&X("cookie",W))Y.cookie=!0;if(!Y.set&&X("set",W))Y.set=!0;if(!Y.server&&X("server",W))Y.server=!0;if(Y.query&&Y.headers&&Y.body&&Y.cookie&&Y.set&&Y.server&&Y.server&&Y.route)break}return $},Lj=(Z,$,Y)=>{try{let X=new RegExp(`(?:\\w)\\((?:.*)?${Z}`,"gs");X.test($);let W=$.charCodeAt(X.lastIndex);if(W===41||W===44)return Y.query=!0,Y.headers=!0,Y.body=!0,Y.cookie=!0,Y.set=!0,Y.server=!0,Y.route=!0,Y.request=!0,!0;return!1}catch(X){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log($),console.log("--- context ---"),console.log(Z),!0}},dQ=(Z,$={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,request:!1,route:!1})=>{let Y=[];if(Z.handler&&typeof Z.handler==="function")Y.push(Z.handler);if(Z.request?.length)Y.push(...Z.request);if(Z.beforeHandle?.length)Y.push(...Z.beforeHandle);if(Z.parse?.length)Y.push(...Z.parse);if(Z.error?.length)Y.push(...Z.error);if(Z.transform?.length)Y.push(...Z.transform);if(Z.afterHandle?.length)Y.push(...Z.afterHandle);if(Z.mapResponse?.length)Y.push(...Z.mapResponse);if(Z.afterResponse?.length)Y.push(...Z.afterResponse);for(let X of Y){if(!X)continue;let W="fn"in X?X.fn:X;if(typeof W!=="function")continue;let[J,z,{isArrowReturn:Q}]=Aj(W.toString()),U=Sj(J,$),G=Nj(U);if(G){let H=hQ(G,z.slice(1,-1));H.splice(0,-1,G);let M=z;if(M.charCodeAt(0)===123&&M.charCodeAt(z.length-1)===125)M=M.slice(1,-1);if(!Lj(G,M,$))Bj(M,H,$);if(!$.query&&M.includes("return "+G+".query"))$.query=!0}if($.query&&$.headers&&$.body&&$.cookie&&$.set&&$.server&&$.request&&$.route)break}return $},iZ=[];for(let Z=48;Z<58;Z++)iZ[Z]=Z-48;for(let Z=0;Z<6;Z++)iZ[Z+65]=iZ[Z+97]=Z+10;var _j=(Z,$)=>{if(Z in iZ&&$ in iZ)return iZ[Z]<<4|iZ[$];return 255},pQ=[...new Array(128).fill(0),...new Array(16).fill(1),...new Array(16).fill(2),...new Array(32).fill(3),4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4],Kj=[0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0],NQ=pQ.map((Z)=>[127,63,63,63,0,31,15,15,15,7,7,7][Z]),qZ=(Z)=>{let $=Z.indexOf("%");if($===-1)return Z;let Y=Z.length-3;if($>Y)return null;let X="",W=0,J=0,z=$,Q=12,U;for(;;){if(U=_j(Z.charCodeAt($+1),Z.charCodeAt($+2)),Q=Kj[Q+pQ[U]],Q===0)return null;if(Q===12){if(X+=Z.substring(W,z),J=J<<6|U&NQ[U],J>65535)X+=String.fromCharCode(55232+(J>>10),56320+(J&1023));else X+=String.fromCharCode(J);if(W=$+3,$=Z.indexOf("%",W),$===-1)return X+Z.substring(W);if($>Y)return null;z=$,J=0}else{if($+=3,$>Y||Z.charCodeAt($)!==37)return null;J=J<<6|U&NQ[U]}}};class y${name;jar;initial;constructor(Z,$,Y={}){this.name=Z,this.jar=$,this.initial=Y}get cookie(){return this.jar[this.name]??this.initial}set cookie(Z){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=Z}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie(Z){this.cookie=Z}get value(){return this.cookie.value}set value(Z){this.setCookie.value=Z}get expires(){return this.cookie.expires}set expires(Z){this.setCookie.expires=Z}get maxAge(){return this.cookie.maxAge}set maxAge(Z){this.setCookie.maxAge=Z}get domain(){return this.cookie.domain}set domain(Z){this.setCookie.domain=Z}get path(){return this.cookie.path}set path(Z){this.setCookie.path=Z}get secure(){return this.cookie.secure}set secure(Z){this.setCookie.secure=Z}get httpOnly(){return this.cookie.httpOnly}set httpOnly(Z){this.setCookie.httpOnly=Z}get sameSite(){return this.cookie.sameSite}set sameSite(Z){this.setCookie.sameSite=Z}get priority(){return this.cookie.priority}set priority(Z){this.setCookie.priority=Z}get partitioned(){return this.cookie.partitioned}set partitioned(Z){this.setCookie.partitioned=Z}get secrets(){return this.cookie.secrets}set secrets(Z){this.setCookie.secrets=Z}update(Z){return this.setCookie=Object.assign(this.cookie,typeof Z==="function"?Z(this.cookie):Z),this}set(Z){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof Z==="function"?Z(this.cookie):Z),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var BQ=(Z,$,Y)=>{if(!Z.cookie)Z.cookie={};return new Proxy($,{get(X,W){if(W in $)return new y$(W,Z.cookie,Object.assign({},Y??{},$[W]));return new y$(W,Z.cookie,Object.assign({},Y))}})},mQ=async(Z,$,{secrets:Y,sign:X,...W}={})=>{if(!$)return BQ(Z,{},W);let J=typeof Y==="string";if(X&&X!==!0&&!Array.isArray(X))X=[X];let z={},Q=S9.parse($);for(let[U,G]of Object.entries(Q)){if(G===void 0)continue;let H=qZ(G);if(X===!0||X?.includes(U)){if(!Y)throw new Error("No secret is provided to cookie plugin");if(J){let M=await wQ(H,Y);if(M===!1)throw new y5(U);H=M}else{let M=!0;for(let q=0;q<Y.length;q++){let w=await wQ(H,Y[q]);if(w!==!1){M=!0,H=w;break}}if(!M)throw new y5(U)}}z[U]={value:H}}return BQ(Z,z,W)},cQ=(Z)=>{if(!Z||!g8(Z))return;let $=[];for(let[Y,X]of Object.entries(Z)){if(!Y||!X)continue;let W=X.value;if(W===void 0||W===null)continue;$.push(S9.serialize(Y,typeof W==="object"?JSON.stringify(W):W+"",X))}if($.length===0)return;if($.length===1)return $[0];return $},AZ=(Z,$)=>{let Y=Z.size;if(!$&&Y||Y&&$&&$.status!==206&&$.status!==304&&$.status!==412&&$.status!==416){if($){if($.headers instanceof Headers){let X={"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"};if(M9)X=$.headers.toJSON();else{X={};for(let[W,J]of $.headers.entries())if(W in $.headers)X[W]=J}return new Response(Z,{status:$.status,headers:X})}if(g8($.headers))return new Response(Z,{status:$.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"},$.headers)})}return new Response(Z,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"}})}return new Response(Z)},uQ=(Z,$)=>{if(!Z)return Z;Z.delete("set-cookie");for(let Y=0;Y<$.length;Y++){let X=$[Y].indexOf("=");Z.append("set-cookie",`${$[Y].slice(0,X)}=${$[Y].slice(X+1)||""}`)}return Z},lZ=(Z,$)=>{if($?.headers){if(Z){if(M9)Object.assign($.headers,Z.headers.toJSON());else for(let[Y,X]of Z.headers.entries())if(Y in $.headers)$.headers[Y]=X}if($.status===200)$.status=Z.status;if($.headers["content-encoding"])delete $.headers["content-encoding"];return $}if(!Z)return{headers:{},status:$?.status??200};if(M9){if($={headers:Z.headers.toJSON(),status:$?.status??200},$.headers["content-encoding"])delete $.headers["content-encoding"];return $}$={headers:{},status:$?.status??200};for(let[Y,X]of Z.headers.entries()){if(Y==="content-encoding")continue;if(Y in $.headers)$.headers[Y]=X}return $},f8=async(Z,$,Y)=>{let X=Z.next();if(X instanceof Promise)X=await X;if(X.done){if($)return W8(X.value,$,Y);return OZ(X.value,Y)}if($?.headers){if(!$.headers["transfer-encoding"])$.headers["transfer-encoding"]="chunked";if(!$.headers["content-type"])$.headers["content-type"]="text/event-stream; charset=utf-8"}else $={status:200,headers:{"content-type":"text/event-stream; charset=utf-8","transfer-encoding":"chunked"}};return new Response(new ReadableStream({async start(W){let J=!1;if(Y?.signal?.addEventListener("abort",()=>{J=!0;try{W.close()}catch{}}),X.value!==void 0&&X.value!==null)if(typeof X.value==="object")try{W.enqueue(Buffer.from(JSON.stringify(X.value)))}catch{W.enqueue(Buffer.from(X.value.toString()))}else W.enqueue(Buffer.from(X.value.toString()));for await(let z of Z){if(J)break;if(z===void 0||z===null)continue;if(typeof z==="object")try{W.enqueue(Buffer.from(JSON.stringify(z)))}catch{W.enqueue(Buffer.from(z.toString()))}else W.enqueue(Buffer.from(z.toString()));await new Promise((Q)=>setTimeout(()=>Q(),0))}try{W.close()}catch{}}}),$)};async function*nZ(Z){let $=Z.body;if(!$)return;let Y=$.getReader(),X=new TextDecoder;try{while(!0){let{done:W,value:J}=await Y.read();if(W)break;yield X.decode(J)}}finally{Y.releaseLock()}}var iQ=(Z)=>{if(typeof Z.status==="string")Z.status=O9[Z.status];if(Z.cookie&&g8(Z.cookie)){let $=cQ(Z.cookie);if($)Z.headers["set-cookie"]=$}if(Z.headers["set-cookie"]&&Array.isArray(Z.headers["set-cookie"]))Z.headers=uQ(new Headers(Z.headers),Z.headers["set-cookie"])},A9=(Z,$)=>{if(Z.status!==$.status&&$.status!==200&&(Z.status<=300||Z.status>400))Z=new Response(Z.body,{headers:Z.headers,status:$.status});let Y=!1;if($.headers instanceof Headers)for(let X of $.headers.keys())if(X==="set-cookie"){if(Y)continue;Y=!0;for(let W of $.headers.getSetCookie())Z.headers.append("set-cookie",W)}else Z.headers.append(X,$.headers?.get(X)??"");else for(let X in $.headers)Z.headers.append(X,$.headers[X]);return Z},W8=(Z,$,Y)=>{if(g8($.headers)||$.status!==200||$.cookie)switch(iQ($),Z?.constructor?.name){case"String":return new Response(Z,$);case"Array":case"Object":return Response.json(Z,$);case"ElysiaFile":return AZ(Z.value);case"Blob":return AZ(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,W8(Z.response,$,Y);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return new Response("",$);return Response.json(Z,$);case"Response":if(Z=A9(Z,$),!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z,$),Y);return Z;case"Error":return FZ(Z,$);case"Promise":return Z.then((X)=>W8(X,$,Y));case"Function":return W8(Z(),$,Y);case"Number":case"Boolean":return new Response(Z.toString(),$);case"Cookie":if(Z instanceof y$)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z,$);default:if(Z instanceof Response){if(Z=A9(Z,$),Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z,$),Y);return Z}if(Z instanceof Promise)return Z.then((X)=>W8(X,$));if(Z instanceof Error)return FZ(Z,$);if(Z instanceof U6)return $.status=Z.code,W8(Z.response,$,Y);if(typeof Z?.next==="function")return f8(Z,$,Y);if(typeof Z?.then==="function")return Z.then((X)=>W8(X,$));if(typeof Z?.toResponse==="function")return W8(Z.toResponse(),$);if("charCodeAt"in Z){let X=Z.charCodeAt(0);if(X===123||X===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}if(Z instanceof Response&&!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z,$),Y);if(typeof Z?.next==="function"||Z instanceof ReadableStream)return f8(Z,$,Y);return OZ(Z,Y)},Z8=(Z,$,Y)=>{if(Z===void 0||Z===null)return;if(g8($.headers)||$.status!==200||$.cookie)switch(iQ($),Z?.constructor?.name){case"String":return new Response(Z,$);case"Array":case"Object":return Response.json(Z,$);case"ElysiaFile":return AZ(Z.value);case"Blob":return AZ(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,Z8(Z.response,$,Y);case"ReadableStream":if(!$.headers["content-type"]?.startsWith("text/event-stream"))$.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,$);case void 0:if(!Z)return;return Response.json(Z,$);case"Response":if(Z=A9(Z,$),!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z,$),Y);return Z;case"Promise":return Z.then((X)=>Z8(X,$));case"Error":return FZ(Z,$);case"Function":return Z8(Z(),$);case"Number":case"Boolean":return new Response(Z.toString(),$);case"FormData":return new Response(Z);case"Cookie":if(Z instanceof y$)return new Response(Z.value,$);return new Response(Z?.toString(),$);default:if(Z instanceof Response){if(Z=A9(Z,$),Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z,$),Y);return Z}if(Z instanceof Promise)return Z.then((X)=>Z8(X,$));if(Z instanceof Error)return FZ(Z,$);if(Z instanceof U6)return $.status=Z.code,Z8(Z.response,$,Y);if(typeof Z?.next==="function")return f8(Z,$,Y);if(typeof Z?.then==="function")return Z.then((X)=>Z8(X,$));if(typeof Z?.toResponse==="function")return Z8(Z.toResponse(),$);if("charCodeAt"in Z){let X=Z.charCodeAt(0);if(X===123||X===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z,$)}else switch(Z?.constructor?.name){case"String":return new Response(Z);case"Array":case"Object":return Response.json(Z,$);case"ElysiaFile":return AZ(Z.value);case"Blob":return AZ(Z,$);case"ElysiaCustomStatusResponse":return $.status=Z.code,Z8(Z.response,$,Y);case"ReadableStream":return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(!Z.headers.has("content-length")&&Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z),Y);return Z;case"Promise":return Z.then((X)=>{let W=Z8(X,$);if(W!==void 0)return W});case"Error":return FZ(Z,$);case"Function":return OZ(Z(),Y);case"Number":case"Boolean":return new Response(Z.toString());case"Cookie":if(Z instanceof y$)return new Response(Z.value,$);return new Response(Z?.toString(),$);case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((X)=>Z8(X,$));if(Z instanceof Error)return FZ(Z,$);if(Z instanceof U6)return $.status=Z.code,Z8(Z.response,$,Y);if(typeof Z?.next==="function")return f8(Z,$,Y);if(typeof Z?.then==="function")return Z.then((X)=>Z8(X,$));if(typeof Z?.toResponse==="function")return Z8(Z.toResponse(),$);if("charCodeAt"in Z){let X=Z.charCodeAt(0);if(X===123||X===91){if(!$.headers["Content-Type"])$.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Z),$)}}return new Response(Z)}},OZ=(Z,$)=>{switch(Z?.constructor?.name){case"String":return new Response(Z);case"Object":case"Array":return Response.json(Z);case"ElysiaFile":return AZ(Z.value);case"Blob":return AZ(Z);case"ElysiaCustomStatusResponse":return W8(Z.response,{status:Z.code,headers:{}});case"ReadableStream":return $?.signal?.addEventListener("abort",{handleEvent(){if($?.signal&&!$?.signal?.aborted)Z.cancel()}},{once:!0}),new Response(Z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!Z)return new Response("");return new Response(JSON.stringify(Z),{headers:{"content-type":"application/json"}});case"Response":if(Z.headers.get("transfer-encoding")==="chunked")return f8(nZ(Z),lZ(Z),$);return Z;case"Error":return FZ(Z);case"Promise":return Z.then((Y)=>OZ(Y,$));case"Function":return OZ(Z(),$);case"Number":case"Boolean":return new Response(Z.toString());case"FormData":return new Response(Z);default:if(Z instanceof Response)return Z;if(Z instanceof Promise)return Z.then((Y)=>OZ(Y,$));if(Z instanceof Error)return FZ(Z);if(Z instanceof U6)return W8(Z.response,{status:Z.code,headers:{}});if(typeof Z?.next==="function")return f8(Z,void 0,$);if(typeof Z?.then==="function")return Z.then((Y)=>W8(Y,set));if(typeof Z?.toResponse==="function")return OZ(Z.toResponse());if("charCodeAt"in Z){let Y=Z.charCodeAt(0);if(Y===123||Y===91)return new Response(JSON.stringify(Z),{headers:{"Content-Type":"application/json"}})}return new Response(Z)}},FZ=(Z,$)=>new Response(JSON.stringify({name:Z?.name,message:Z?.message,cause:Z?.cause}),{status:$?.status!==200?$?.status??500:500,headers:$?.headers}),Rj=(Z,$,Y={})=>{if(typeof Z==="function")return;let X=W8(Z,{headers:Y});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length)return X.clone.bind(X)},U9={name:"web-standard",isWebStandard:!0,handler:{mapResponse:W8,mapEarlyResponse:Z8,mapCompactResponse:OZ,createStaticHandler:Rj},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`,parser:{json(Z){if(Z)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData(Z){let $=`
c.body={}
`;if(Z)$+="let form;try{form=await c.request.formData()}catch{}";else $+=`const form=await c.request.formData()
`;return $+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},composeGeneralHandler:{parameters:"r",createContext(Z){let $="",Y="",X=Z.setHeaders;for(let z of Object.keys(Z.singleton.decorator))$+=`,${z}: decorator['${z}']`;let W=Z.config.handler?.standardHostname??!0,J=!!Z.event.trace?.length;if(Y+=`const u=r.url,s=u.indexOf('/',${W?11:7}),qi=u.indexOf('?', s + 1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,J)Y+=`const id=randomId()
`;if(Y+="const c={request:r,store,qi,path:p,url:u,redirect,error,set:{headers:",Y+=Object.keys(X??{}).length?"Object.assign({}, app.setHeaders)":"{}",Y+=",status:200}",Z.inference.server)Y+=",get server(){return app.getServer()}";if(J)Y+=",[ELYSIA_REQUEST_ID]:id";return Y+=$,Y+=`}
`,Y},websocket(Z){let $="",Y=Z.router.static.ws,X=Z.router.http;if(X.build(),Object.keys(Y).length||X.root.ws||X.history.find((W)=>W["0"]==="ws")){$+="if(r.method==='GET'){switch(p){";for(let[W,J]of Object.entries(Y))$+=`case'${W}':`+(Z.config.strictPath!==!0?`case'${b$(W)}':`:"")+`if(r.headers.get('upgrade')==='websocket')return ht[${J}].composed(c)
`;$+=`default:if(r.headers.get('upgrade')==='websocket'){const route=router.find('ws',p)
if(route){c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)}}break}}`}return $},error404(Z,$){let Y="if(route===null)return ";if($)Y+=`app.handleError(c,notFound,false,${this.parameters})`;else Y+=Z?"new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"error404.clone()";return{declare:$?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:Y}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw new Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}},Vj=(Z,$,Y={})=>{if(typeof Z==="function"||Z instanceof Blob)return;if(typeof Z==="object"&&Z?.toString()==="[object HTMLBundle]")return()=>Z;let X=W8(Z,{headers:Y});if(!$.parse?.length&&!$.transform?.length&&!$.beforeHandle?.length&&!$.afterHandle?.length){if(!X.headers.has("content-type"))X.headers.append("content-type","text/plain;charset=utf-8");return X.clone.bind(X)}},LQ={open(Z){Z.data.open?.(Z)},message(Z,$){Z.data.message?.(Z,$)},drain(Z){Z.data.drain?.(Z)},close(Z,$,Y){Z.data.close?.(Z,$,Y)}};class x4{raw;data;body;validator;["~types"];get id(){return this.data.id}constructor(Z,$,Y=void 0){this.raw=Z,this.data=$,this.body=Y,this.validator=Z.data?.validator,this.sendText=Z.sendText.bind(Z),this.sendBinary=Z.sendBinary.bind(Z),this.close=Z.close.bind(Z),this.terminate=Z.terminate.bind(Z),this.publishText=Z.publishText.bind(Z),this.publishBinary=Z.publishBinary.bind(Z),this.subscribe=Z.subscribe.bind(Z),this.unsubscribe=Z.unsubscribe.bind(Z),this.isSubscribed=Z.isSubscribed.bind(Z),this.cork=Z.cork.bind(Z),this.remoteAddress=Z.remoteAddress,this.binaryType=Z.binaryType,this.data=Z.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send(Z,$){if(Buffer.isBuffer(Z))return this.raw.send(Z,$);if(this.validator?.Check(Z)===!1)return this.raw.send(new w1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.send(Z,$)}ping(Z){if(Buffer.isBuffer(Z))return this.raw.ping(Z);if(this.validator?.Check(Z)===!1)return this.raw.send(new w1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.ping(Z)}pong(Z){if(Buffer.isBuffer(Z))return this.raw.pong(Z);if(this.validator?.Check(Z)===!1)return this.raw.send(new w1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.pong(Z)}publish(Z,$,Y){if(Buffer.isBuffer($))return this.raw.publish(Z,$,Y);if(this.validator?.Check($)===!1)return this.raw.send(new w1("message",this.validator,$).message);if(typeof $==="object")$=JSON.stringify($);return this.raw.publish(Z,$,Y)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}}var Ej=(Z)=>{let $=typeof Z==="function"?[Z]:Z;return async function Y(X,W){if(typeof W==="string"){let J=W?.charCodeAt(0);if(J===34||J===47||J===91||J===123)try{W=JSON.parse(W)}catch{}else if(d5(W))W=+W;else if(W==="true")W=!0;else if(W==="false")W=!1;else if(W==="null")W=null}if($)for(let J=0;J<$.length;J++){let z=$[J](X,W);if(z instanceof Promise)z=await z;if(z!==void 0)return z}return W}},jj=(Z)=>{let $=(Y,X)=>{if(X instanceof Promise)return X.then((z)=>$(Y,z));if(Buffer.isBuffer(X))return Y.send(X.toString());if(X===void 0)return;let W=(z)=>{if(Z?.Check(z)===!1)return Y.send(new w1("message",Z,z).message);if(typeof z==="object")return Y.send(JSON.stringify(z));Y.send(z)};if(typeof X?.next!=="function")return void W(X);let J=X.next();if(J instanceof Promise)return(async()=>{let z=await J;if(Z?.Check(z)===!1)return Y.send(new w1("message",Z,z).message);if(W(z.value),!z.done)for await(let Q of X)W(Q)})();if(W(J.value),!J.done)for(let z of X)W(z)};return $},Cj={...U9,name:"bun",handler:{...U9.handler,createNativeStaticHandler:Vj},composeHandler:{...U9.composeHandler,headers:M9?`c.headers = c.request.headers.toJSON()
`:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`},listen(Z){return($,Y)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(Z.compile(),typeof $==="string"){if(!d5($))throw new Error("Port must be a numeric value");$=parseInt($)}let X=Z.fetch,W=typeof $==="object"?{development:!q9,reusePort:!0,...Z.config.serve||{},...$||{},static:{...Z.router.static.http.static,...Z.config.serve?.static},websocket:{...Z.config.websocket||{},...LQ||{}},fetch:X,error:Z.outerErrorHandler}:{development:!q9,reusePort:!0,...Z.config.serve||{},static:Z.router.static.http.static,websocket:{...Z.config.websocket||{},...LQ||{}},port:$,fetch:X,error:Z.outerErrorHandler};if(Z.server=Bun?.serve(W),Z.event.start)for(let J=0;J<Z.event.start.length;J++)Z.event.start[J].fn(Z);if(Y)Y(Z.server);process.on("beforeExit",()=>{if(Z.server){if(Z.server.stop?.(),Z.server=null,Z.event.stop)for(let J=0;J<Z.event.stop.length;J++)Z.event.stop[J].fn(Z)}}),Z.promisedModules.then(()=>{Bun?.gc(!1)})}},ws(Z,$,Y){let{parse:X,body:W,response:J,...z}=Y,Q=Y8(W,{modules:Z.definitions.typebox,models:Z.definitions.type,normalize:Z.config.normalize}),U=Y8(J,{modules:Z.definitions.typebox,models:Z.definitions.type,normalize:Z.config.normalize});Z.route("$INTERNALWS",$,async(G)=>{let H=Z.getServer(),{set:M,path:q,qi:w,headers:B,query:D,params:L}=G;if(G.validator=U,Y.upgrade){if(typeof Y.upgrade==="function"){let P=Y.upgrade(G);if(P instanceof Promise)await P}else if(Y.upgrade)Object.assign(M.headers,Y.upgrade)}if(M.cookie&&g8(M.cookie)){let P=cQ(M.cookie);if(P)M.headers["set-cookie"]=P}if(M.headers["set-cookie"]&&Array.isArray(M.headers["set-cookie"]))M.headers=uQ(new Headers(M.headers),M.headers["set-cookie"]);let b=jj(U),s=Ej(X),t,J1=[...Array.isArray(Y.error)?Y.error:[Y.error],...(Z.event.error??[]).map((P)=>typeof P==="function"?P:P.fn)],Y1=!J1.length?()=>{}:async(P,I)=>{for(let f of J1){let T=f(Object.assign(G,{error:I}));if(T instanceof Promise)T=await T;if(await b(P,T),T)break}};if(H?.upgrade(G.request,{headers:g8(M.headers)?M.headers:void 0,data:{...G,get id(){if(t)return t;return t=IQ()},validator:U,ping(P){Y.ping?.(P)},pong(P){Y.pong?.(P)},open(P){try{b(P,Y.open?.(new x4(P,G)))}catch(I){Y1(P,I)}},message:async(P,I)=>{let f=await s(P,I);if(Q?.Check(f)===!1)return void P.send(new w1("message",Q,f).message);try{b(P,Y.message?.(new x4(P,G,f),f))}catch(T){Y1(P,T)}},drain(P){try{b(P,Y.drain?.(new x4(P,G)))}catch(I){Y1(P,I)}},close(P,I,f){try{b(P,Y.close?.(new x4(P,G),I,f))}catch(T){Y1(P,T)}}}}))return;return M.status=400,"Expected a websocket connection"},{...z,websocket:Y})}},Ij=typeof Bun!=="undefined",_Q=Ij?Bun.env:typeof process!=="undefined"&&process?.env?process.env:{},f$=/\+/g;function Pj(Z){let $={};if(typeof Z!=="string")return $;let Y="",X="",W=-1,J=-1,z=0,Q=Z.length;for(let U=0;U<Q;U++)switch(Z.charCodeAt(U)){case 38:let G=J>W;if(!G)J=U;if(Y=Z.slice(W+1,J),G||Y.length>0){if(z&1)Y=Y.replace(f$," ");if(z&2)Y=qZ(Y)||Y;if(!$[Y]){if(G){if(X=Z.slice(J+1,U),z&4)X=X.replace(f$," ");if(z&8)X=qZ(X)||X}$[Y]=X}}Y="",X="",W=U,J=U,z=0;break;case 61:if(J<=W)J=U;else z|=8;break;case 43:if(J>W)z|=4;else z|=1;break;case 37:if(J>W)z|=8;else z|=2;break}if(W<Q){let U=J>W;if(Y=Z.slice(W+1,U?J:Q),U||Y.length>0){if(z&1)Y=Y.replace(f$," ");if(z&2)Y=qZ(Y)||Y;if(!$[Y]){if(U){if(X=Z.slice(J+1,Q),z&4)X=X.replace(f$," ");if(z&8)X=qZ(X)||X}$[Y]=X}}}return $}var H9=(Z)=>{let $={};if(typeof Z!=="string")return $;let Y=Z.length,X="",W="",J=-1,z=-1,Q=!1,U=!1,G=!1,H=!1,M=!1,q=0;for(let w=0;w<Y+1;w++){if(w!==Y)q=Z.charCodeAt(w);else q=38;switch(q){case 38:{if(M=z>J,!M)z=w;if(X=Z.slice(J+1,z),M||X.length>0){if(G)X=X.replace(f$," ");if(Q)X=qZ(X)||X;if(M){if(W=Z.slice(z+1,w),H)W=W.replace(f$," ");if(U)W=qZ(W)||W}let B=$[X];if(B===void 0)$[X]=W;else if(B.pop)B.push(W);else $[X]=[B,W]}W="",J=w,z=w,Q=!1,U=!1,G=!1,H=!1;break}case 61:if(z<=J)z=w;else U=!0;break;case 43:if(z>J)H=!0;else G=!0;break;case 37:if(z>J)U=!0;else Q=!0;break}}return $},m5=Symbol("ElysiaTrace"),i6=()=>{let{promise:Z,resolve:$}=Promise.withResolvers(),{promise:Y,resolve:X}=Promise.withResolvers(),{promise:W,resolve:J}=Promise.withResolvers(),z=[],Q=[];return[(U)=>{if(U)z.push(U);return Z},(U)=>{let G=[],H=[],M=null;for(let w=0;w<(U.total??0);w++){let{promise:B,resolve:D}=Promise.withResolvers(),{promise:L,resolve:b}=Promise.withResolvers(),{promise:s,resolve:t}=Promise.withResolvers(),J1=[],Y1=[];G.push((P)=>{if(P)J1.push(P);return B}),H.push((P)=>{let I={...P,end:L,error:s,index:w,onStop(f){if(f)Y1.push(f);return L}};D(I);for(let f=0;f<J1.length;f++)J1[f](I);return(f=null)=>{let T=performance.now();if(f)M=f;let G1={end:T,error:f,get elapsed(){return T-P.begin}};for(let H1=0;H1<Y1.length;H1++)Y1[H1](G1);b(T),t(f)}})}let q={...U,end:Y,error:W,onEvent(w){for(let B=0;B<G.length;B++)G[B](w)},onStop(w){if(w)Q.push(w);return Y}};$(q);for(let w=0;w<z.length;w++)z[w](q);return{resolveChild:H,resolve(w=null){let B=performance.now();if(!w&&M)w=M;let D={end:B,error:w,get elapsed(){return B-U.begin}};for(let L=0;L<Q.length;L++)Q[L](D);X(B),J(w)}}}]},xj=(Z)=>{return($)=>{let[Y,X]=i6(),[W,J]=i6(),[z,Q]=i6(),[U,G]=i6(),[H,M]=i6(),[q,w]=i6(),[B,D]=i6(),[L,b]=i6(),[s,t]=i6();return Z({id:$[F9],context:$,set:$.set,onRequest:Y,onParse:W,onTransform:z,onBeforeHandle:U,onHandle:H,onAfterHandle:q,onMapResponse:L,onAfterResponse:s,onError:B}),{request:X,parse:J,transform:Q,beforeHandle:G,handle:M,afterHandle:w,error:D,mapResponse:b,afterResponse:t}}},oZ={optional:Symbol.for("TypeBox.Optional"),kind:Symbol.for("TypeBox.Kind")},Q6=(Z)=>{if(!Z)return!1;let $=Z?.schema;if($?.[oZ.kind]==="Import")return Z.References().some(Q6);return!!$&&oZ.optional in $},V0=(Z,$)=>$?Z:"",Tj=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],b8=(Z)=>{if(!Z)return!1;let $=Z?.schema??Z;if($[oZ.kind]==="Import"&&Z.References())return Z.References().some(b8);if($.anyOf)return $.anyOf.some(b8);if($.someOf)return $.someOf.some(b8);if($.allOf)return $.allOf.some(b8);if($.not)return $.not.some(b8);if($.type==="object"){let Y=$.properties;if("additionalProperties"in $)return $.additionalProperties;if("patternProperties"in $)return!1;for(let X of Object.keys(Y)){let W=Y[X];if(W.type==="object"){if(b8(W))return!0}else if(W.anyOf){for(let J=0;J<W.anyOf.length;J++)if(b8(W.anyOf[J]))return!0}return W.additionalProperties}return!1}return!1},c5=({context:Z="c",trace:$=[],addFn:Y})=>{if(!$.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let X=0;X<$.length;X++)Y(`let report${X}, reportChild${X}, reportErr${X}, reportErrChild${X};let trace${X} = ${Z}[ELYSIA_TRACE]?.[${X}] ?? trace[${X}](${Z});
`);return(X,{name:W,total:J=0}={})=>{if(!W)W="anonymous";let z=X==="error"?"reportErr":"report";for(let Q=0;Q<$.length;Q++)Y(`${z}${Q} = trace${Q}.${X}({id,event:'${X}',name:'${W}',begin:performance.now(),total:${J}})
`);return{resolve(){for(let Q=0;Q<$.length;Q++)Y(`${z}${Q}.resolve()
`)},resolveChild(Q){for(let U=0;U<$.length;U++)Y(`${z}Child${U}=${z}${U}.resolveChild?.shift()?.({id,event:'${X}',name:'${Q}',begin:performance.now()})
`);return(U)=>{for(let G=0;G<$.length;G++)if(U)Y(`if(${U} instanceof Error){${z}Child${G}?.(${U}) }else{${z}Child${G}?.()}`);else Y(`${z}Child${G}?.()
`)}}}}},kj=({injectResponse:Z="",normalize:$=!1,validator:Y,encodeSchema:X=!1})=>({composeValidation:(W,J=`c.${W}`)=>`c.set.status=422;throw new ValidationError('${W}',validator.${W},${J})`,composeResponseValidation:(W="r")=>{let J=Z+`
`;J+=`if(${W} instanceof ElysiaCustomStatusResponse){c.set.status=${W}.code
${W}=${W}.response}const isResponse=${W} instanceof Response
switch(c.set.status){`;for(let[z,Q]of Object.entries(Y.response)){if(J+=`
case ${z}:if(!isResponse){`,$&&"Clean"in Q&&!b8(Q))J+=`${W}=validator.response['${z}'].Clean(${W})
`;if(X&&(Q.hasTransform||typeof Q.Decode==="function"))J+=`${W}=validator.response['${z}'].Encode(${W})
`;J+=`if(validator.response['${z}'].Check(${W})===false){c.set.status=422
throw new ValidationError('response',validator.response['${z}'],${W})}c.set.status = ${z}}
`,J+=`break
`}return J+"}"}}),ae=Symbol.for("TypeBox.Kind"),DZ=(Z,$)=>{if(!$)return;let Y=$.schema??$;if(Y[oZ.kind]==="Import")return $.References().some((X)=>DZ(Z,X));if(Y.type==="object"){let X=Y.properties;if(!X)return!1;for(let W of Object.keys(X)){let J=X[W];if(Z in J)return!0;if(J.type==="object"){if(DZ(Z,J))return!0}else if(J.anyOf){for(let z=0;z<J.anyOf.length;z++)if(DZ(Z,J.anyOf[z]))return!0}}return!1}return Z in Y},bj=Symbol.for("TypeBox.Transform"),N8=(Z)=>{if(!Z)return!1;if(Z.$ref&&Z.$defs&&Z.$ref in Z.$defs&&N8(Z.$defs[Z.$ref]))return!0;if(Z.oneOf){for(let $=0;$<Z.oneOf.length;$++)if(N8(Z.oneOf[$]))return!0}if(Z.anyOf){for(let $=0;$<Z.anyOf.length;$++)if(N8(Z.anyOf[$]))return!0}if(Z.allOf){for(let $=0;$<Z.allOf.length;$++)if(N8(Z.allOf[$]))return!0}if(Z.not&&N8(Z.not))return!0;if(Z.type==="object"&&Z.properties){let $=Z.properties;for(let Y of Object.keys($)){let X=$[Y];if(N8(X))return!0;if(X.type==="array"&&X.items&&N8(X.items))return!0}}if(Z.type==="array"&&Z.items&&N8(Z.items))return!0;return bj in Z},fj=/(?:return|=>) \S+\(/g,g$=(Z)=>{return(Z?.fn??Z).constructor.name==="AsyncFunction"},D0=(Z)=>{let $=Z?.fn??Z;if($.constructor.name==="AsyncFunction")return!0;let Y=$.toString();if(Y.includes("=> response.clone("))return!1;if(Y.includes("await"))return!0;if(Y.includes("async"))return!0;if(Y.includes("=>response.clone("))return!1;return!!Y.match(fj)},G9=(Z)=>{let $=Z?.fn??Z;return $.constructor.name==="AsyncGeneratorFunction"||$.constructor.name==="GeneratorFunction"},gj=({app:Z,path:$,method:Y,hooks:X,validator:W,handler:J,allowMeta:z=!1,inference:Q,asManifest:U=!1})=>{let G=Z["~adapter"].composeHandler,H=Z["~adapter"].handler,M=typeof J==="function";if(!M){if(J=H.mapResponse(J,{headers:Z.setHeaders??{}}),X.parse?.length&&X.transform?.length&&X.beforeHandle?.length&&X.afterHandle?.length){if(J instanceof Response)return Function("a","return function(){return a.clone()}")(J);return Function("a","return function(){return a}")(J)}}let q=M?"handler(c)":"handler",w=!!X.afterResponse?.length,B=!!X.trace?.length,D="";if(Q=dQ(Object.assign({},X,{handler:J}),Q),G.declare){let g=G.declare(Q);if(g)D+=g}if(Q.server)D+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;W.createBody?.(),W.createQuery?.(),W.createHeaders?.(),W.createParams?.(),W.createCookie?.(),W.createResponse?.();let L=W.body||W.headers||W.params||W.query||W.cookie||W.response,b=Q.query||!!W.query,s=X.parse?.length===1&&X.parse[0].fn==="none",t=Y!=="$INTERNALWS"&&Y!=="GET"&&Y!=="HEAD"&&(Q.body||!!W.body||!!X.parse?.length)&&!s;if(t)D+=`let isParsing=false
`;let J1=Z.setHeaders,Y1=J1&&!!Object.keys(J1).length,P=Q.headers||W.headers||G.preferWebstandardHeaders!==!0&&Q.body,I=Q.cookie||!!W.cookie,f=I?EQ({modules:Z.definitions.typebox,validator:W.cookie,defaultConfig:Z.config.cookie,dynamic:!!Z.config.aot,config:W.cookie?.config??{},models:Z.definitions.type}):void 0,T=f?.config,G1="";if(T?.sign){if(!T.secrets)throw new Error(`t.Cookie required secret which is not set in (${Y}) ${$}.`);let g=!T.secrets?void 0:typeof T.secrets==="string"?T.secrets:T.secrets[0];if(G1+=`const _setCookie = c.set.cookie
if(_setCookie){`,T.sign===!0)G1+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${g}')}`;else for(let C of T.sign)G1+=`if(_setCookie['${C}']?.value){c.set.cookie['${C}'].value=await signCookie(_setCookie['${C}'].value,'${g}')}`;G1+=`}
`}let H1=Z.config.normalize,z1=Z.config.experimental?.encodeSchema,{composeValidation:q1,composeResponseValidation:O0}=kj({normalize:H1,validator:W,encodeSchema:z1});if(P)D+=G.headers;if(B)D+=`const id=c[ELYSIA_REQUEST_ID]
`;let p1=c5({trace:X.trace,addFn:(g)=>{D+=g}});if(D+="try{",I){let g=(x,o)=>{let $1=T?.[x]??o;if(!$1)return typeof o==="string"?`${x}:"${o}",`:`${x}:${o},`;if(typeof $1==="string")return`${x}:'${$1}',`;if($1 instanceof Date)return`${x}: new Date(${$1.getTime()}),`;return`${x}:${$1},`},C=T?`{secrets:${T.secrets!==void 0?typeof T.secrets==="string"?`'${T.secrets}'`:"["+T.secrets.reduce((x,o)=>x+`'${o}',`,"")+"]":"undefined"},sign:${T.sign===!0?!0:T.sign!==void 0?"["+T.sign.reduce((x,o)=>x+`'${o}',`,"")+"]":"undefined"},`+g("domain")+g("expires")+g("httpOnly")+g("maxAge")+g("path","/")+g("priority")+g("sameSite")+g("secure")+"}":"undefined";if(P)D+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${C})
`;else D+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${C})
`}if(b){let g=[];if(W.query&&W.query.schema.type==="object"){let C=W.query.schema.properties;if(!b8(W.query))for(let[x,o]of Object.entries(C)){let $1=o,A=$1.type==="array"||!!$1.anyOf?.some((u)=>u.type==="string"&&u.format==="ArrayString");if($1&&oZ.optional in $1&&$1.type==="array"&&$1.items)$1=$1.items;let{type:k,anyOf:N}=$1;g.push({key:x,isArray:A,isNestedObjectArray:A&&$1.items?.type==="object"||!!$1.items?.anyOf?.some((u)=>u.type==="object"||u.type==="array"),isObject:k==="object"||N?.some((u)=>u.type==="string"&&u.format==="ArrayString"),anyOf:!!N})}}if(!g.length)D+="if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url.slice(c.qi + 1))}";else{D+=`if(c.qi!==-1){let url='&'+c.url.slice(c.qi + 1)
`;let C=0;for(let{key:x,isArray:o,isObject:$1,isNestedObjectArray:A,anyOf:k}of g){let N=(C===0?"let ":"")+`memory=url.indexOf('&${x}=')
let a${C}
`;if(o)if(D+=N,A)D+=`while(memory!==-1){const start=memory+${x.length+2}
memory=url.indexOf('&',start)
if(a${C}===undefined)
a${C}=''
else
a${C}+=','
let temp
if(memory===-1)temp=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else temp=decodeURIComponent(url.slice(start, memory).replace(/\\+/g,' '))
const charCode=temp.charCodeAt(0)
if(charCode!==91&&charCode !== 123)
temp='"'+temp+'"'
a${C}+=temp
if(memory===-1)break
memory=url.indexOf('&${x}=',memory)
if(memory===-1)break}try{if(a${C}.charCodeAt(0)===91)a${C} = JSON.parse(a${C})
else
a${C}=JSON.parse('['+a${C}+']')}catch{}
`;else D+=`while(memory!==-1){const start=memory+${x.length+2}
memory=url.indexOf('&',start)
if(a${C}===undefined)a${C}=[]
if(memory===-1){const temp=decodeURIComponent(url.slice(start)).replace(/\\+/g,' ')
if(temp.includes(',')){a${C}=a${C}.concat(temp.split(','))}else{a${C}.push(decodeURIComponent(url.slice(start)).replace(/\\+/g,' '))}
break}else{const temp=decodeURIComponent(url.slice(start, memory)).replace(/\\+/g,' ')
if(temp.includes(',')){a${C}=a${C}.concat(temp.split(','))}else{a${C}.push(temp)}
}memory=url.indexOf('&${x}=',memory)
if(memory===-1) break
}`;else if($1)D+=N+`if(memory!==-1){const start=memory+${x.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${C}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))else a${C}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))if(a${C}!==undefined)try{a${C}=JSON.parse(a${C})}catch{}}`;else{if(D+=N+`if(memory!==-1){const start=memory+${x.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${C}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else{a${C}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))`,k)D+=`
let deepMemory=url.indexOf('&${x}=',memory)
if(deepMemory!==-1){a${C}=[a${C}]
let first=true
while(true){const start=deepMemory+${x.length+2}
if(first)first=false
else deepMemory = url.indexOf('&', start)
let value
if(deepMemory===-1)value=url.slice(start).replace(/\\+/g,' ')
else value=url.slice(start, deepMemory).replace(/\\+/g,' ')
value=decodeURIComponent(value)
if(value===null){if(deepMemory===-1){break}else{continue}}
const vStart=value.charCodeAt(0)
const vEnd=value.charCodeAt(value.length - 1)
if((vStart===91&&vEnd===93)||(vStart===123&&vEnd===125))
try{a${C}.push(JSON.parse(value))}catch{a${C}.push(value)}if(deepMemory===-1)break}}`;D+="}}"}C++,D+=`
`}D+="c.query={"+g.map(({key:x},o)=>`'${x}':a${o}`).join(",")+"}",D+=`} else c.query = {}
`}}let A6=typeof J==="function"&&D0(J),g0=B||X.afterResponse?.length?"c.response= ":"",PZ=I||t||A6||!!X.parse?.length||!!X.afterHandle?.some(D0)||!!X.beforeHandle?.some(D0)||!!X.transform?.some(D0)||!!X.mapResponse?.some(D0),yX=(typeof J==="function"?G9(J):!1)||!!X.beforeHandle?.some(G9)||!!X.afterHandle?.some(G9)||!!X.transform?.some(G9),p8=Q.cookie||Q.set||P||B||W.response||M&&Y1||yX,P1=G.mapResponseContext?`,${G.mapResponseContext}`:"";if(B||Q.route)D+=`c.route=\`${$}\`
`;let H8=p1("parse",{total:X.parse?.length});if(t){let g=Q6(W.body),C=!!X.parse?.length||Q.body||W.body;if(G.parser.declare)D+=G.parser.declare;D+=`
isParsing=true
`;let x=typeof X.parse==="string"?X.parse:Array.isArray(X.parse)&&X.parse.length===1?typeof X.parse[0]==="string"?X.parse[0]:typeof X.parse[0].fn==="string"?X.parse[0].fn:void 0:void 0;if(x&&Tj.includes(x)){let o=p1("parse",{total:X.parse?.length});switch(x){case"json":case"application/json":D+=G.parser.json(g);break;case"text":case"text/plain":D+=G.parser.text(g);break;case"urlencoded":case"application/x-www-form-urlencoded":D+=G.parser.urlencoded(g);break;case"arrayBuffer":case"application/octet-stream":D+=G.parser.arrayBuffer(g);break;case"formdata":case"multipart/form-data":D+=G.parser.formData(g);break;default:if(x[0]in Z["~parser"])D+=P?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",D+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,D+=`let result=parser['${x}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}o.resolve()}else if(C){if(D+=`
`,D+=P?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",D+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,X.parse?.length)D+=`let used=false
`;let o=p1("parse",{total:X.parse?.length}),$1=!1;if(X.parse)for(let A=0;A<X.parse.length;A++){let k=`bo${A}`;if(A!==0)D+=`
if(!used){`;if(typeof X.parse[A].fn==="string"){let N=o.resolveChild(X.parse[A].fn);switch(X.parse[A].fn){case"json":case"application/json":$1=!0,D+=G.parser.json(g);break;case"text":case"text/plain":$1=!0,D+=G.parser.text(g);break;case"urlencoded":case"application/x-www-form-urlencoded":$1=!0,D+=G.parser.urlencoded(g);break;case"arrayBuffer":case"application/octet-stream":$1=!0,D+=G.parser.arrayBuffer(g);break;case"formdata":case"multipart/form-data":$1=!0,D+=G.parser.formData(g);break;default:D+=`${k}=parser['${X.parse[A].fn}'](c,contentType)
if(${k} instanceof Promise)${k}=await ${k}
if(${k}!==undefined){c.body=${k};used=true}
`}N()}else{let N=o.resolveChild(X.parse[A].fn.name);D+=`let ${k}=e.parse[${A}]
${k}=${k}(c,contentType)
if(${k} instanceof Promise)${k}=await ${k}
if(${k}!==undefined){c.body=${k};used=true}`,N()}if(A!==0)D+="}";if($1)break}if(o.resolve(),!$1){if(X.parse?.length)D+=`
if(!used){
if(!contentType) throw new ParseError()
`;D+="switch(contentType){",D+=`case 'application/json':
`+G.parser.json(g)+`break
case 'text/plain':`+G.parser.text(g)+`break
case 'application/x-www-form-urlencoded':`+G.parser.urlencoded(g)+`break
case 'application/octet-stream':`+G.parser.arrayBuffer(g)+`break
case 'multipart/form-data':`+G.parser.formData(g)+`break
`;for(let A of Object.keys(Z["~parser"]))D+=`case '${A}':let bo${A}=parser['${A}'](c,contentType)
if(bo${A} instanceof Promise)bo${A}=await bo${A}
if(bo${A} instanceof ElysiaCustomStatusResponse)throw result
if(bo${A}!==undefined)c.body=bo${A}
break
`;if(X.parse?.length)D+="}";D+="}"}}D+=`
delete c.contentType`,D+=`
isParsing=false
`}if(H8.resolve(),X?.transform){let g=p1("transform",{total:X.transform.length});if(X.transform.length)D+=`let transformed
`;for(let C=0;C<X.transform.length;C++){let x=X.transform[C],o=g.resolveChild(x.fn.name);if(D+=D0(x)?`transformed=await e.transform[${C}](c)
`:`transformed=e.transform[${C}](c)
`,x.subType==="mapDerive")D+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else D+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else Object.assign(c,transformed)
`;o()}g.resolve()}if(W){if(W.headers){if(H1&&"Clean"in W.headers&&!b8(W.headers))D+=`c.headers=validator.headers.Clean(c.headers);
`;if(DZ("default",W.headers))for(let[g,C]of Object.entries(X1.Default(W.headers.schema,{}))){let x=typeof C==="object"?JSON.stringify(C):typeof C==="string"?`'${C}'`:C;if(x!==void 0)D+=`c.headers['${g}']??=${x}
`}if(Q6(W.headers))D+="if(isNotEmpty(c.headers)){";if(D+="if(validator.headers.Check(c.headers) === false){"+q1("headers")+"}",N8(W.headers.schema))D+=`c.headers=validator.headers.Decode(c.headers)
`;if(Q6(W.headers))D+="}"}if(W.params){if(DZ("default",W.params))for(let[g,C]of Object.entries(X1.Default(W.params.schema,{}))){let x=typeof C==="object"?JSON.stringify(C):typeof C==="string"?`'${C}'`:C;if(x!==void 0)D+=`c.params['${g}']??=${x}
`}if(D+="if(validator.params.Check(c.params)===false){"+q1("params")+"}",N8(W.params.schema))D+=`c.params=validator.params.Decode(c.params)
`}if(W.query){if(H1&&"Clean"in W.query&&!b8(W.query))D+=`c.query=validator.query.Clean(c.query)
`;if(DZ("default",W.query))for(let[g,C]of Object.entries(X1.Default(W.query.schema,{}))){let x=typeof C==="object"?JSON.stringify(C):typeof C==="string"?`'${C}'`:C;if(x!==void 0)D+=`if(c.query['${g}']===undefined)c.query['${g}']=${x}
`}if(Q6(W.query))D+="if(isNotEmpty(c.query)){";if(D+="if(validator.query.Check(c.query)===false){"+q1("query")+"}",N8(W.query.schema))D+=`c.query=validator.query.Decode(Object.assign({},c.query))
`;if(Q6(W.query))D+="}"}if(W.body){if(H1&&"Clean"in W.body&&!b8(W.body))D+=`c.body=validator.body.Clean(c.body)
`;let g=N8(W.body.schema);if(g||Q6(W.body))D+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&isNotEmpty(c.body))
`;if(DZ("default",W.body)){let C=W.body.schema,x=X1.Default(C,C.type==="object"||C[oZ.kind]==="Import"&&C.$defs[C.$ref][oZ.kind]==="Object"?{}:void 0),o=typeof x==="object"?JSON.stringify(x):typeof x==="string"?`'${x}'`:x;if(D+="if(validator.body.Check(c.body)===false){",x!==void 0&&x!==null)D+=`if(typeof c.body==='object')c.body=Object.assign(${o},c.body)
else c.body=${o}
`;if(Q6(W.body))D+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+q1("body")+"}";else D+="if(validator.body.Check(c.body)===false){"+q1("body")+"}";D+="}"}else if(Q6(W.body))D+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+q1("body")+"}";else D+="if(validator.body.Check(c.body)===false){"+q1("body")+"}";if(g)D+=`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`}if(f&&g8(f?.schema?.properties??f?.schema?.schema??{})){if(D+=`const cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,DZ("default",f))for(let[g,C]of Object.entries(X1.Default(f.schema,{})))D+=`cookieValue['${g}'] = ${typeof C==="object"?JSON.stringify(C):C}
`;if(Q6(W.cookie))D+="if(isNotEmpty(c.cookie)){";if(D+="if(validator.cookie.Check(cookieValue)===false){"+q1("cookie","cookieValue")+"}",N8(W.cookie.schema))D+=`for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue)))c.cookie[key].value=value
`;if(Q6(W.cookie))D+="}"}}if(X?.beforeHandle){let g=p1("beforeHandle",{total:X.beforeHandle.length}),C=!1;for(let x=0;x<X.beforeHandle.length;x++){let o=X.beforeHandle[x],$1=g.resolveChild(o.fn.name),A=k4(o);if(o.subType==="resolve"||o.subType==="mapResolve"){if(!C)C=!0,D+=`
let resolved
`;if(D+=D0(o)?`resolved=await e.beforeHandle[${x}](c);
`:`resolved=e.beforeHandle[${x}](c);
`,o.subType==="mapResolve")D+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else{resolved.request = c.request
resolved.store = c.store
resolved.qi = c.qi
resolved.path = c.path
resolved.url = c.url
resolved.redirect = c.redirect
resolved.set = c.set
resolved.error = c.error
c = resolved}`;else D+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else Object.assign(c, resolved)
`}else if(!A)D+=D0(o)?`await e.beforeHandle[${x}](c)
`:`e.beforeHandle[${x}](c)
`,$1();else{if(D+=D0(o)?`be=await e.beforeHandle[${x}](c)
`:`be=e.beforeHandle[${x}](c)
`,$1("be"),D+="if(be!==undefined){",g.resolve(),X.afterHandle?.length){p1("handle",{name:M?J.name:void 0}).resolve();let N=p1("afterHandle",{total:X.afterHandle.length});for(let u=0;u<X.afterHandle.length;u++){let h=X.afterHandle[u],i=k4(h),f1=N.resolveChild(h.fn.name);if(D+=`c.response = be
`,!i)D+=D0(h.fn)?`await e.afterHandle[${u}](c, be)
`:`e.afterHandle[${u}](c, be)
`;else D+=D0(h.fn)?`af = await e.afterHandle[${u}](c)
`:`af = e.afterHandle[${u}](c)
`,D+=`if(af!==undefined) c.response=be=af
`;f1("af")}N.resolve()}if(W.response)D+=O0("be");let k=p1("mapResponse",{total:X.mapResponse?.length});if(X.mapResponse?.length){D+=`c.response=be
`;for(let N=0;N<X.mapResponse.length;N++){let u=X.mapResponse[N],h=k.resolveChild(u.fn.name);D+=`if(mr===undefined){mr=${g$(u)?"await ":""}e.mapResponse[${N}](c)
if(mr!==undefined)be=c.response=mr}`,h()}}k.resolve(),D+=G1,D+=`return mapEarlyResponse(${g0}be,c.set${P1})}
`}}g.resolve()}if(X.afterHandle?.length){let g=p1("handle",{name:M?J.name:void 0});if(X.afterHandle.length)D+=A6?`let r=c.response=await ${q}
`:`let r=c.response=${q}
`;else D+=A6?`let r=await ${q}
`:`let r=${q}
`;g.resolve();let C=p1("afterHandle",{total:X.afterHandle.length});for(let o=0;o<X.afterHandle.length;o++){let $1=X.afterHandle[o],A=k4($1),k=C.resolveChild($1.fn.name);if(!A)D+=D0($1.fn)?`await e.afterHandle[${o}](c)
`:`e.afterHandle[${o}](c)
`,k();else if(D+=D0($1.fn)?`af=await e.afterHandle[${o}](c)
`:`af=e.afterHandle[${o}](c)
`,k("af"),W.response)D+="if(af!==undefined){",C.resolve(),D+=O0("af"),D+="c.response=af}";else D+="if(af!==undefined){",C.resolve(),D+="c.response=af}"}if(C.resolve(),D+=`r=c.response
`,W.response)D+=O0();D+=G1;let x=p1("mapResponse",{total:X.mapResponse?.length});if(X.mapResponse?.length)for(let o=0;o<X.mapResponse.length;o++){let $1=X.mapResponse[o],A=x.resolveChild($1.fn.name);D+=`mr=${g$($1)?"await ":""}e.mapResponse[${o}](c)
if(mr!==undefined)r=c.response=mr
`,A()}if(x.resolve(),p8)D+=`return mapResponse(${g0}r,c.set${P1})
`;else D+=`return mapCompactResponse(${g0}r${P1})
`}else{let g=p1("handle",{name:M?J.name:void 0});if(W.response||X.mapResponse?.length){if(D+=A6?`let r=await ${q}
`:`let r=${q}
`,g.resolve(),W.response)D+=O0();p1("afterHandle").resolve();let C=p1("mapResponse",{total:X.mapResponse?.length});if(X.mapResponse?.length){D+=`
c.response=r
`;for(let x=0;x<X.mapResponse.length;x++){let o=X.mapResponse[x],$1=C.resolveChild(o.fn.name);D+=`
if(mr===undefined){mr=${g$(o)?"await ":""}e.mapResponse[${x}](c)
if(mr!==undefined)r=c.response=mr}
`,$1()}}if(C.resolve(),D+=G1,J instanceof Response)D+=Q.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${g0}${q}.clone(),c.set${P1})else return ${q}.clone()`:`return ${q}.clone()`,D+=`
`;else if(p8)D+=`return mapResponse(${g0}r,c.set${P1})
`;else D+=`return mapCompactResponse(${g0}r${P1})
`}else if(I||B){D+=A6?`let r=await ${q}
`:`let r=${q}
`,g.resolve(),p1("afterHandle").resolve();let C=p1("mapResponse",{total:X.mapResponse?.length});if(X.mapResponse?.length){D+=`c.response= r
`;for(let x=0;x<X.mapResponse.length;x++){let o=X.mapResponse[x],$1=C.resolveChild(o.fn.name);D+=`if(mr===undefined){mr=${g$(o)?"await ":""}e.mapResponse[${x}](c)
if(mr!==undefined)r=c.response=mr}`,$1()}}if(C.resolve(),D+=G1,p8)D+=`return mapResponse(${g0}r,c.set${P1})
`;else D+=`return mapCompactResponse(${g0}r${P1})
`}else{g.resolve();let C=A6?`await ${q}`:q;if(p1("afterHandle").resolve(),J instanceof Response)D+=Q.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${g0}${q}.clone(),c.set${P1})
else return ${q}.clone()
`:`return ${q}.clone()
`;else if(p8)D+=`return mapResponse(${g0}${C},c.set${P1})
`;else D+=`return mapCompactResponse(${g0}${C}${P1})
`}}if(D+=`
}catch(error){`,t)D+=`if(isParsing)error=new ParseError()
`;if(!PZ)D+="return(async()=>{";if(D+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,B&&X.trace)for(let g=0;g<X.trace.length;g++)D+=`report${g}?.resolve(error);reportChild${g}?.(error)
`;let a6=p1("error",{total:X.error?.length});if(X.error?.length){if(D+=`c.error=error
`,L)D+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else D+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;D+=`let er
`;for(let g=0;g<X.error.length;g++){let C=a6.resolveChild(X.error[g].fn.name);if(D0(X.error[g]))D+=`er=await e.error[${g}](c)
`;else D+=`er=e.error[${g}](c)
if(er instanceof Promise)er=await er
`;C();let x=p1("mapResponse",{total:X.mapResponse?.length});if(X.mapResponse?.length)for(let o=0;o<X.mapResponse.length;o++){let $1=X.mapResponse[o],A=x.resolveChild($1.fn.name);D+=`c.response=er
er=e.mapResponse[${o}](c)
if(er instanceof Promise)er=await er
`,A()}if(x.resolve(),D+=`er=mapEarlyResponse(er,set${P1})
`,D+="if(er){",B&&X.trace){for(let o=0;o<X.trace.length;o++)D+=`report${o}.resolve()
`;a6.resolve()}D+="return er}"}}if(a6.resolve(),D+="return handleError(c,error,true)",!PZ)D+="})()";if(D+="}",w||B){if(D+="finally{ ",!PZ)D+=";(async()=>{";let g=p1("afterResponse",{total:X.afterResponse?.length});if(w&&X.afterResponse)for(let C=0;C<X.afterResponse.length;C++){let x=g.resolveChild(X.afterResponse[C].fn.name);D+=`
await e.afterResponse[${C}](c)
`,x()}if(g.resolve(),!PZ)D+="})()";D+="}"}let e6=G.inject?Object.keys(G.inject).join(",")+",":"",m8="const {handler,handleError,hooks:e, "+V0("validator,",L)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+V0("parseQuery,",t)+V0("parseQueryFromURL,",b)+"},error:{"+V0("ValidationError,",L)+"InternalServerError,"+V0("ParseError",t)+"},schema,definitions,ERROR_CODE,"+V0("parseCookie,",I)+V0("signCookie,",I)+V0("decodeURIComponent,",b)+"ElysiaCustomStatusResponse,"+V0("ELYSIA_TRACE,",B)+V0("ELYSIA_REQUEST_ID,",B)+V0("parser,",X.parse?.length)+V0("getServer,",Q.server)+e6+V0("TypeBoxError",L)+`}=hooks
const trace=e.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
return ${PZ?"async ":""}function handle(c){`;if(X.beforeHandle?.length)m8+=`let be
`;if(X.afterHandle?.length)m8+=`let af
`;if(X.mapResponse?.length)m8+=`let mr
`;if(z)m8+=`c.schema = schema
c.defs = definitions
`;m8+=D+"}";try{if(U)return Function("hooks",m8);return Function("hooks",m8)({handler:J,hooks:DQ(X),validator:L?W:void 0,handleError:Z.handleError,mapResponse:H.mapResponse,mapCompactResponse:H.mapCompactResponse,mapEarlyResponse:H.mapEarlyResponse,isNotEmpty:g8,utils:{parseQuery:t?H9:void 0,parseQueryFromURL:b?Pj:void 0},error:{ValidationError:L?w1:void 0,InternalServerError:xQ,ParseError:t?TQ:void 0},schema:Z.router.history,definitions:Z.definitions.type,ERROR_CODE:D9,parseCookie:I?mQ:void 0,signCookie:I?w9:void 0,decodeURIComponent:b?qZ:void 0,ElysiaCustomStatusResponse:U6,ELYSIA_TRACE:B?m5:void 0,ELYSIA_REQUEST_ID:B?F9:void 0,getServer:()=>Z.getServer(),TypeBoxError:L?a:void 0,parser:Z["~parser"],...G.inject})}catch(g){let C=DQ(X);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof J==="function"?J.toString():J,instruction:m8,hooks:{...C,transform:C?.transform?.map?.((x)=>x.toString()),resolve:C?.resolve?.map?.((x)=>x.toString()),beforeHandle:C?.beforeHandle?.map?.((x)=>x.toString()),afterHandle:C?.afterHandle?.map?.((x)=>x.toString()),mapResponse:C?.mapResponse?.map?.((x)=>x.toString()),parse:C?.parse?.map?.((x)=>x.toString()),error:C?.error?.map?.((x)=>x.toString()),afterResponse:C?.afterResponse?.map?.((x)=>x.toString()),stop:C?.stop?.map?.((x)=>x.toString())},validator:W,definitions:Z.definitions.type,error:g,fnLiteral:D}),console.log("---"),process.exit(1)}},k5=(Z,{asManifest:$=!1}={})=>{let Y=Z["~adapter"].composeGeneralHandler;Z.router.http.build();let X=Y.error404(!!Z.event.request?.length,!!Z.event.error?.length),W=Z.event.trace?.length,J="",z=Z.router,Q="const route=router.find(r.method,p)";Q+=z.http.root.ALL?`??router.find("ALL",p)
`:`
`,Q+=X.code,Q+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)
`;let U="";for(let[w,B]of Object.entries(z.static.http.map)){if(U+=`case'${w}':`,Z.config.strictPath!==!0)U+=`case'${b$(w)}':`;let D=P4(w);if(w!==D)U+=`case'${D}':`;U+=`switch(r.method){${B.code}
`+(B.all??"default: break map")+"}"}let G=!!Z.event.request?.some(D0),H=Y.inject?Object.keys(Y.inject).join(",")+",":"";if(J+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,error,redirect,`+V0("ELYSIA_TRACE,",W)+V0("ELYSIA_REQUEST_ID,",W)+H+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,Z.event.request?.length)J+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(J+=X.declare,Z.event.trace?.length)J+="const "+Z.event.trace.map((w,B)=>`tr${B}=app.event.trace[${B}].fn`).join(",")+`
`;if(J+=`${G?"async ":""}function map(${Y.parameters}){`,Z.event.request?.length)J+=`let re
`;if(J+=Y.createContext(Z),Z.event.trace?.length)J+="c[ELYSIA_TRACE]=["+Z.event.trace.map((w,B)=>`tr${B}(c)`).join(",")+`]
`;let M=c5({trace:Z.event.trace,addFn(w){J+=w}})("request",{total:Z.event.request?.length});if(Z.event.request?.length){J+="try{";for(let w=0;w<Z.event.request.length;w++){let B=Z.event.request[w],D=k4(B),L=D0(B),b=M.resolveChild(Z.event.request[w].fn.name);if(D)J+=`re=mapEarlyResponse(${L?"await ":""}onRequest[${w}](c),c.set)
`,b("re"),J+=`if(re!==undefined)return re
`;else J+=`${L?"await ":""}onRequest[${w}](c)
`,b()}J+="}catch(error){return app.handleError(c,error,false)}"}if(M.resolve(),J+=Y.websocket(Z),J+=`
map:switch(p){
`+U+"default:break}"+Q+`}
`,Z.extender.higherOrderFunctions.length){let w="map";for(let B=0;B<Z.extender.higherOrderFunctions.length;B++)w=`hoc[${B}](${w},${Y.parameters})`;J+=`return function hocMap(${Y.parameters}){return ${w}(${Y.parameters})}`}else J+="return map";let q=lQ(Z);return Z.handleError=q,Function("data",J)({app:Z,mapEarlyResponse:Z["~adapter"].handler.mapEarlyResponse,NotFoundError:p5,randomId:IQ,handleError:q,error:PQ,redirect:CQ,ELYSIA_TRACE:W?m5:void 0,ELYSIA_REQUEST_ID:W?F9:void 0,...Y.inject})},lQ=(Z)=>{let $=Z.event,Y="",X=Z["~adapter"].composeError,W=X.inject?Object.keys(X.inject).join(",")+",":"",J=!!Z.event.trace?.length;if(Y+="const {app:{event:{error:onErrorContainer,afterResponse:resContainer,mapResponse:_onMapResponse,trace:_trace}},mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+V0("ELYSIA_TRACE,",J)+V0("ELYSIA_REQUEST_ID,",J)+W+`}=inject
`,Y+=`const trace=_trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const onMapResponse=[]
if(_onMapResponse)for(let i=0;i<_onMapResponse.length;i++)onMapResponse.push(_onMapResponse[i].fn??_onMapResponse[i])
delete _onMapResponse
const onError=onErrorContainer?.map(x=>x.fn)??[]
const res=resContainer?.map(x=>x.fn)??[]
return ${Z.event.error?.find(D0)||Z.event.mapResponse?.find(D0)?"async ":""}function(context,error,skipGlobal){`,Y+="",J)Y+=`const id=context[ELYSIA_REQUEST_ID]
`;let z=c5({context:"context",trace:$.trace,addFn:(G)=>{Y+=G}});if(Y+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,X.declare)Y+=X.declare;let Q=J||!!$.afterResponse?.length||!!$.afterResponse?.length?"context.response = ":"";if(Z.event.error)for(let G=0;G<Z.event.error.length;G++){let H=Z.event.error[G],M=`${D0(H)?"await ":""}onError[${G}](context)
`;if(Y+="if(skipGlobal!==true){",k4(H)){Y+=`_r=${M}
if(_r!==undefined){if(_r instanceof Response)return mapResponse(_r,set${X.mapResponseContext})
if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let q=z("mapResponse",{total:$.mapResponse?.length,name:"context"});if($.mapResponse?.length)for(let w=0;w<$.mapResponse.length;w++){let B=$.mapResponse[w],D=q.resolveChild(B.fn.name);Y+=`context.response=_r_r=${g$(B)?"await ":""}onMapResponse[${w}](context)
`,D()}q.resolve(),Y+=`return mapResponse(${Q}_r,set${X.mapResponseContext})}`}else Y+=M;Y+="}"}Y+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){if(error.error)error=error.error
set.status=error.status??422
`+X.validationError+"}",Y+="if(error instanceof Error){"+X.unknownError+"}";let U=z("mapResponse",{total:$.mapResponse?.length,name:"context"});if(Y+=`
if(!context.response)context.response=error.message??error
`,$.mapResponse?.length){Y+=`let mr
`;for(let G=0;G<$.mapResponse.length;G++){let H=$.mapResponse[G],M=U.resolveChild(H.fn.name);Y+=`if(mr===undefined){mr=${g$(H)?"await ":""}onMapResponse[${G}](context)
if(mr!==undefined)error=context.response=mr}`,M()}}return U.resolve(),Y+=`
return mapResponse(${Q}error,set${X.mapResponseContext})}`,Function("inject",Y)({app:Z,mapResponse:Z["~adapter"].handler.mapResponse,ERROR_CODE:D9,ElysiaCustomStatusResponse:U6,ELYSIA_TRACE:J?m5:void 0,ELYSIA_REQUEST_ID:J?F9:void 0,...X.inject})},b5=(Z,$)=>{for(let[Y,X]of Object.entries(Z.schema.properties))$[Y]??=X.default},KQ=(Z)=>{let{mapResponse:$,mapEarlyResponse:Y}=Z["~adapter"].handler;return async(X)=>{let W=X.url,J=W.indexOf("/",11),z=W.indexOf("?",J+1),Q=z===-1?W.substring(J):W.substring(J,z),U={cookie:{},status:200,headers:{}},G=Object.assign({},Z.singleton.decorator,{set:U,store:Z.singleton.store,request:X,path:Q,qi:z,error:PQ,redirect:CQ});try{if(Z.event.request)for(let I=0;I<Z.event.request.length;I++){let f=Z.event.request[I].fn,T=f(G);if(T instanceof Promise)T=await T;if(T=Y(T,U),T)return G.response=T}let H=Z.router.dynamic.find(X.method,Q)??Z.router.dynamic.find("ALL",Q);if(!H)throw new p5;let{handle:M,hooks:q,validator:w,content:B,route:D}=H.store,L;if(X.method!=="GET"&&X.method!=="HEAD")if(B)switch(B){case"application/json":L=await X.json();break;case"text/plain":L=await X.text();break;case"application/x-www-form-urlencoded":L=H9(await X.text());break;case"application/octet-stream":L=await X.arrayBuffer();break;case"multipart/form-data":L={};let I=await X.formData();for(let f of I.keys()){if(L[f])continue;let T=I.getAll(f);if(T.length===1)L[f]=T[0];else L[f]=T}break}else{let I=X.headers.get("content-type");if(I){let f=I.indexOf(";");if(f!==-1)I=I.slice(0,f);if(G.contentType=I,q.parse)for(let T=0;T<q.parse.length;T++){let G1=q.parse[T].fn,H1=G1(G,I);if(H1 instanceof Promise)H1=await H1;if(H1){L=H1;break}}if(delete G.contentType,L===void 0)switch(I){case"application/json":L=await X.json();break;case"text/plain":L=await X.text();break;case"application/x-www-form-urlencoded":L=H9(await X.text());break;case"application/octet-stream":L=await X.arrayBuffer();break;case"multipart/form-data":L={};let T=await X.formData();for(let G1 of T.keys()){if(L[G1])continue;let H1=T.getAll(G1);if(H1.length===1)L[G1]=H1[0];else L[G1]=H1}break}}}G.route=D,G.body=L,G.params=H?.params||void 0,G.query=z===-1?{}:H9(W.substring(z+1)),G.headers={};for(let[I,f]of X.headers.entries())G.headers[I]=f;let b=Object.assign({},Z.config?.cookie,w?.cookie?.config),s=X.headers.get("cookie");G.cookie=await mQ(G.set,s,b?{secrets:b.secrets!==void 0?typeof b.secrets==="string"?b.secrets:b.secrets.join(","):void 0,sign:b.sign===!0?!0:b.sign!==void 0?typeof b.sign==="string"?b.sign:b.sign.join(","):void 0}:void 0);let t=w?.createHeaders?.();if(t)b5(t,G.headers);let J1=w?.createParams?.();if(J1)b5(J1,G.params);let Y1=w?.createQuery?.();if(Y1)b5(Y1,G.query);if(q.transform)for(let I=0;I<q.transform.length;I++){let f=q.transform[I],T=f.fn(G);if(f.subType==="derive")if(T instanceof Promise)Object.assign(G,await T);else Object.assign(G,T);else if(T instanceof Promise)await T}if(w){if(t){let I=structuredClone(G.headers);for(let[f,T]of X.headers)I[f]=T;if(w.headers.Check(I)===!1)throw new w1("header",w.headers,I)}else if(w.headers?.Decode)G.headers=w.headers.Decode(G.headers);if(J1?.Check(G.params)===!1)throw new w1("params",w.params,G.params);else if(w.params?.Decode)G.params=w.params.Decode(G.params);if(Y1?.Check(G.query)===!1)throw new w1("query",w.query,G.query);else if(w.query?.Decode)G.query=w.query.Decode(G.query);if(w.createCookie?.()){let I={};for(let[f,T]of Object.entries(G.cookie))I[f]=T.value;if(w.cookie.Check(I)===!1)throw new w1("cookie",w.cookie,I);else if(w.cookie?.Decode)I=w.cookie.Decode(I)}if(w.createBody?.()?.Check(L)===!1)throw new w1("body",w.body,L);else if(w.body?.Decode)G.body=w.body.Decode(L)}if(q.beforeHandle)for(let I=0;I<q.beforeHandle.length;I++){let f=q.beforeHandle[I],T=f.fn(G);if(f.subType==="resolve"){if(T instanceof U6){let G1=Y(T,G.set);if(G1)return G.response=G1}if(T instanceof Promise)Object.assign(G,await T);else Object.assign(G,T);continue}else if(T instanceof Promise)T=await T;if(T!==void 0){if(G.response=T,q.afterHandle)for(let H1=0;H1<q.afterHandle.length;H1++){let z1=q.afterHandle[H1].fn(G);if(z1 instanceof Promise)z1=await z1;if(z1)T=z1}let G1=Y(T,G.set);if(G1)return G.response=G1}}let P=typeof M==="function"?M(G):M;if(P instanceof Promise)P=await P;if(q.afterHandle)if(!q.afterHandle.length){let I=P instanceof U6?P.code:U.status?typeof U.status==="string"?O9[U.status]:U.status:200,f=w?.createResponse?.()?.[I];if(f?.Check(P)===!1)throw new w1("response",f,P);else if(f?.Decode)P=f.Decode(P)}else{G.response=P;for(let I=0;I<q.afterHandle.length;I++){let f=q.afterHandle[I].fn(G);if(f instanceof Promise)f=await f;let T=Y(f,G.set);if(T!==void 0){let G1=w?.response?.[T.status];if(G1?.Check(T)===!1)throw new w1("response",G1,T);else if(G1?.Decode)P=G1.Decode(P);return G.response=T}}}if(G.set.cookie&&b?.sign){let I=!b.secrets?void 0:typeof b.secrets==="string"?b.secrets:b.secrets[0];if(b.sign===!0)for(let[f,T]of Object.entries(G.set.cookie))G.set.cookie[f].value=await w9(T.value,"${secret}");else{let f=w?.cookie?.schema?.properties;for(let T of b.sign){if(!(T in f))continue;if(G.set.cookie[T]?.value)G.set.cookie[T].value=await w9(G.set.cookie[T].value,I)}}}return $(G.response=P,G.set)}catch(H){let M=H instanceof rY&&H.error?H.error:H;return Z.handleError(G,M)}finally{if(Z.event.afterResponse)for(let H of Z.event.afterResponse)await H.fn(G)}}},yj=(Z)=>{let{mapResponse:$}=Z["~adapter"].handler;return async(Y,X)=>{let W=Object.assign(Y,{error:X,code:X.code});if(W.set=Y.set,Z.event.error)for(let J=0;J<Z.event.error.length;J++){let z=Z.event.error[J].fn(W);if(z instanceof Promise)z=await z;if(z!==void 0&&z!==null)return Y.response=$(z,Y.set)}return new Response(typeof X.cause==="string"?X.cause:X.message,{headers:Y.set.headers,status:X.status??500})}};class X8{config;server=null;dependencies={};_routes={};_types={Prefix:"",Singleton:{},Definitions:{},Metadata:{}};_ephemeral={};_volatile={};singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:v.Module({}),type:{},error:{}};extender={macros:[],higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){return C4(C4(this.global,this.scoped),this.local)}};event={};telemetry={stack:void 0};router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new xZ({lazy:!0});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new xZ;return this["~dynamic"]},static:{http:{static:{},map:{},all:""},ws:{}},history:[]};routeTree=new Map;get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,request:!1,route:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new jQ;return this._promisedModules}constructor(Z={}){if(Z.tags)if(!Z.detail)Z.detail={tags:Z.tags};else Z.detail.tags=Z.tags;if(Z.nativeStaticResponse===void 0)Z.nativeStaticResponse=!0;if(this.config={},this.applyConfig(Z??{}),this["~adapter"]=Z.adapter??(typeof Bun!=="undefined"?Cj:U9),Z?.analytic&&(Z?.name||Z?.seed!==void 0))this.telemetry.stack=new Error().stack}"~adapter";env(Z,$=_Q){if(Y8(Z,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0}).Check($)===!1){let Y=new w1("env",Z,$);throw new Error(Y.all.map((X)=>X.summary).join(`
`))}return this}wrap(Z){return this.extender.higherOrderFunctions.push({checksum:I4(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Z.toString()})),fn:Z}),this}applyMacro(Z){if(this.extender.macros.length){let $=Gj({globalHook:this.event,localHook:Z}),Y={events:{global:this.event,local:Z},get onParse(){return $("parse")},get onTransform(){return $("transform")},get onBeforeHandle(){return $("beforeHandle")},get onAfterHandle(){return $("afterHandle")},get mapResponse(){return $("mapResponse")},get onAfterResponse(){return $("afterResponse")},get onError(){return $("error")}};for(let X of this.extender.macros)Qj(X.fn(Y),Z,$)}}applyConfig(Z){return this.config={prefix:"",aot:_Q.ELYSIA_AOT!=="false",normalize:!0,...Z,cookie:{path:"/",...Z?.cookie},experimental:Z?.experimental??{},seed:Z?.seed===void 0?"":Z?.seed},this}get models(){let Z={};for(let $ of Object.keys(this.definitions.type))Z[$]=Y8(this.definitions.typebox.Import($));return Z.modules=this.definitions.typebox,Z}add(Z,$,Y,X,{allowMeta:W=!1,skipPrefix:J=!1}={allowMeta:!1,skipPrefix:!1}){if(X=T5(Hj(X)),$!==""&&$.charCodeAt(0)!==47)$="/"+$;if(this.config.prefix&&!J)$=this.config.prefix+$;if(X?.type)switch(X.type){case"text":X.type="text/plain";break;case"json":X.type="application/json";break;case"formdata":X.type="multipart/form-data";break;case"urlencoded":X.type="application/x-www-form-urlencoded";break;case"arrayBuffer":X.type="application/octet-stream";break;default:break}let z=this.definitions.type,Q=!this.config.aot,U={...this.validator.getCandidate()},G={body:X?.body??U?.body,headers:X?.headers??U?.headers,params:X?.params??U?.params,query:X?.query??U?.query,cookie:X?.cookie??U?.cookie,response:X?.response??U?.response},H=()=>G.cookie?EQ({modules:q,validator:G.cookie,defaultConfig:this.config.cookie,config:G.cookie?.config??{},dynamic:Q,models:z}):void 0,M=this.config.normalize,q=this.definitions.typebox,w=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.schema===!0?{body:Y8(G.body,{modules:q,dynamic:Q,models:z,normalize:M,additionalCoerce:QQ()}),headers:Y8(G.headers,{modules:q,dynamic:Q,models:z,additionalProperties:!this.config.normalize,coerce:!0,additionalCoerce:uZ()}),params:Y8(G.params,{modules:q,dynamic:Q,models:z,coerce:!0,additionalCoerce:uZ()}),query:Y8(G.query,{modules:q,dynamic:Q,models:z,normalize:M,coerce:!0,additionalCoerce:uZ()}),cookie:H(),response:zQ(G.response,{modules:q,dynamic:Q,models:z,normalize:M})}:{createBody(){if(this.body)return this.body;return this.body=Y8(G.body,{modules:q,dynamic:Q,models:z,normalize:M,additionalCoerce:QQ()})},createHeaders(){if(this.headers)return this.headers;return this.headers=Y8(G.headers,{modules:q,dynamic:Q,models:z,additionalProperties:!M,coerce:!0,additionalCoerce:uZ()})},createParams(){if(this.params)return this.params;return this.params=Y8(G.params,{modules:q,dynamic:Q,models:z,coerce:!0,additionalCoerce:uZ()})},createQuery(){if(this.query)return this.query;return this.query=Y8(G.query,{modules:q,dynamic:Q,models:z,coerce:!0,additionalCoerce:uZ()})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=H()},createResponse(){if(this.response)return this.response;return this.response=zQ(G.response,{modules:q,dynamic:Q,models:z,normalize:M})}};if(X=u6(X,T5(U)),X.tags)if(!X.detail)X.detail={tags:X.tags};else X.detail.tags=X.tags;if(g8(this.config.detail))X.detail=$8(Object.assign({},this.config.detail),X.detail);this.applyMacro(X);let B=T5(u6(this.event,X));if(this.config.aot===!1){this.router.dynamic.add(Z,$,{validator:w,hooks:B,content:X?.type,handle:Y,route:$});let z1=P4($,{dynamic:!0});if($!==z1)this.router.dynamic.add(Z,z1,{validator:w,hooks:B,content:X?.type,handle:Y,route:$});if(this.config.strictPath===!1){let q1=b$($);this.router.dynamic.add(Z,q1,{validator:w,hooks:B,content:X?.type,handle:Y,route:$});let O0=P4(q1);if(q1!==O0)this.router.dynamic.add(Z,q1,{validator:w,hooks:B,content:X?.type,handle:Y,route:$})}this.router.history.push({method:Z,path:$,composed:null,handler:Y,hooks:B});return}let D=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,L=x5(this.inference),b=this["~adapter"].handler,s=typeof Y!=="function"&&typeof b.createStaticHandler==="function"?b.createStaticHandler(Y,B,this.setHeaders):void 0,t=typeof Y!=="function"?b.createNativeStaticHandler?.(Y,B,this.setHeaders):void 0;if(this.config.nativeStaticResponse===!0&&t&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[$]=t();let J1=(z1=!1)=>gj({app:this,path:$,method:Z,hooks:B,validator:w,handler:typeof Y!=="function"&&typeof b.createStaticHandler!=="function"?()=>Y:Y,allowMeta:W,inference:L,asManifest:z1}),Y1;if(this.routeTree.has(Z+$))for(let z1=0;z1<this.router.history.length;z1++){let q1=this.router.history[z1];if(q1.path===$&&q1.method===Z){Y1=z1;break}}else this.routeTree.set(Z+$,this.router.history.length);let P=this.router.history,I=Y1??this.router.history.length,f=D?J1():(z1)=>{let q1=(P[I].composed=J1())(z1);return J1=void 0,q1};if(D)J1=void 0;let T=Z==="$INTERNALWS";if(Y1!==void 0)this.router.history[Y1]=Object.assign({method:Z,path:$,composed:f,handler:Y,hooks:B},X.webSocket?{websocket:X.websocket}:{});else this.router.history.push(Object.assign({method:Z,path:$,composed:f,handler:Y,hooks:B},X.webSocket?{websocket:X.websocket}:{}));let G1=this.router.static.http,H1={handler:D?f:void 0,compile(){return this.handler=J1()}};if(T){if(this.router.http.add("ws",$,H1),!this.config.strictPath)this.router.http.add("ws",b$($),H1);let z1=P4($,{dynamic:!0});if(z1!==$)this.router.http.add("ws",z1,H1);return}if($.indexOf(":")===-1&&$.indexOf("*")===-1){if(!G1.map[$])G1.map[$]={code:""};let z1=s?"":"c";if(Z==="ALL")G1.map[$].all=`default:return ht[${I}].composed(${z1})
`;else G1.map[$].code=`case '${Z}':return ht[${I}].composed(${z1})
${G1.map[$].code}`;if(!this.config.strictPath&&this.config.nativeStaticResponse===!0&&t&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[b$($)]=t()}else{if(this.router.http.add(Z,$,H1),!this.config.strictPath){let q1=b$($);if(this.config.nativeStaticResponse===!0&&s&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[q1]=s();this.router.http.add(Z,q1,H1)}let z1=P4($,{dynamic:!0});if($!==z1){if(this.router.http.add(Z,z1,H1),this.config.nativeStaticResponse===!0&&s&&(Z==="GET"||Z==="ALL"))this.router.static.http.static[z1]=s();this.router.http.add(Z,z1,H1)}}}setHeaders;headers(Z){if(!Z)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=$8(this.setHeaders,Z),this}onStart(Z){return this.on("start",Z),this}onRequest(Z){return this.on("request",Z),this}onParse(Z,$){if(!$){if(typeof Z==="string")return this.on("parse",this["~parser"][Z]);return this.on("parse",Z)}return this.on(Z,"parse",$)}parser(Z,$){return this["~parser"][Z]=$,this}onTransform(Z,$){if(!$)return this.on("transform",Z);return this.on(Z,"transform",$)}resolve(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"resolve",fn:$};return this.onBeforeHandle(Z,Y)}mapResolve(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"mapResolve",fn:$};return this.onBeforeHandle(Z,Y)}onBeforeHandle(Z,$){if(!$)return this.on("beforeHandle",Z);return this.on(Z,"beforeHandle",$)}onAfterHandle(Z,$){if(!$)return this.on("afterHandle",Z);return this.on(Z,"afterHandle",$)}mapResponse(Z,$){if(!$)return this.on("mapResponse",Z);return this.on(Z,"mapResponse",$)}onAfterResponse(Z,$){if(!$)return this.on("afterResponse",Z);return this.on(Z,"afterResponse",$)}trace(Z,$){if(!$)$=Z,Z={as:"local"};if(!Array.isArray($))$=[$];for(let Y of $)this.on(Z,"trace",xj(Y));return this}error(Z,$){switch(typeof Z){case"string":return $.prototype[D9]=Z,this.definitions.error[Z]=$,this;case"function":return this.definitions.error=Z(this.definitions.error),this}for(let[Y,X]of Object.entries(Z))X.prototype[D9]=Y,this.definitions.error[Y]=X;return this}onError(Z,$){if(!$)return this.on("error",Z);return this.on(Z,"error",$)}onStop(Z){return this.on("stop",Z),this}on(Z,$,Y){let X;switch(typeof Z){case"string":X=Z,Y=$;break;case"object":if(X=$,!Array.isArray($)&&typeof $==="object")Y=$;break}if(Array.isArray(Y))Y=B0(Y);else if(typeof Y==="function")Y=[{fn:Y}];else Y=[Y];let W=Y;for(let J of W)if(J.scope=typeof Z==="string"?"local":Z?.as??"local",X==="resolve"||X==="derive")J.subType=X;if(X!=="trace")dQ({[X]:W.map((J)=>J.fn)},this.inference);for(let J of W){let z=Jj(J,"global",{skipIfHasType:!0});switch(X){case"start":this.event.start??=[],this.event.start.push(z);break;case"request":this.event.request??=[],this.event.request.push(z);break;case"parse":this.event.parse??=[],this.event.parse.push(z);break;case"transform":this.event.transform??=[],this.event.transform.push(z);break;case"derive":this.event.transform??=[],this.event.transform.push(B0(z,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(z);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push(B0(z,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(z);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(z);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(z);break;case"trace":this.event.trace??=[],this.event.trace.push(z);break;case"error":this.event.error??=[],this.event.error.push(z);break;case"stop":this.event.stop??=[],this.event.stop.push(z);break}}return this}propagate(){return k0(this.event.parse),k0(this.event.transform),k0(this.event.beforeHandle),k0(this.event.afterHandle),k0(this.event.mapResponse),k0(this.event.afterResponse),k0(this.event.trace),k0(this.event.error),this}as(Z){let $={plugin:"scoped",scoped:"scoped",global:"global"}[Z];if(k0(this.event.parse,$),k0(this.event.transform,$),k0(this.event.beforeHandle,$),k0(this.event.afterHandle,$),k0(this.event.mapResponse,$),k0(this.event.afterResponse,$),k0(this.event.trace,$),k0(this.event.error,$),Z==="plugin")this.validator.scoped=C4(this.validator.scoped,this.validator.local),this.validator.local=null;else if(Z==="global")this.validator.global=C4(this.validator.global,C4(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null;return this}group(Z,$,Y){let X=new X8({...this.config,prefix:""});X.singleton={...this.singleton},X.definitions={...this.definitions},X.getServer=()=>this.getServer(),X.inference=x5(this.inference),X.extender={...this.extender};let W=typeof $==="object",J=(W?Y:$)(X);if(this.singleton=$8(this.singleton,X.singleton),this.definitions=$8(this.definitions,X.definitions),J.event.request?.length)this.event.request=[...this.event.request||[],...J.event.request||[]];if(J.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...J.event.mapResponse||[]];return this.model(J.definitions.type),Object.values(X.router.history).forEach(({method:z,path:Q,handler:U,hooks:G})=>{if(Q=(W?"":this.config.prefix)+Z+Q,W){let H=$,M=G;this.add(z,Q,U,u6(H,{...M||{},error:!M.error?J.event.error:Array.isArray(M.error)?[...M.error||{},...J.event.error||{}]:[M.error,...J.event.error||{}]}))}else this.add(z,Q,U,u6(G,{error:J.event.error}),{skipPrefix:!0})}),this}guard(Z,$){if(!$){if(typeof Z==="object"){this.applyMacro(Z);let W=Z.as??"local";if(this.validator[W]={body:Z.body??this.validator[W]?.body,headers:Z.headers??this.validator[W]?.headers,params:Z.params??this.validator[W]?.params,query:Z.query??this.validator[W]?.query,response:Z.response??this.validator[W]?.response,cookie:Z.cookie??this.validator[W]?.cookie},Z.parse)this.on({as:W},"parse",Z.parse);if(Z.transform)this.on({as:W},"transform",Z.transform);if(Z.derive)this.on({as:W},"derive",Z.derive);if(Z.beforeHandle)this.on({as:W},"beforeHandle",Z.beforeHandle);if(Z.resolve)this.on({as:W},"resolve",Z.resolve);if(Z.afterHandle)this.on({as:W},"afterHandle",Z.afterHandle);if(Z.mapResponse)this.on({as:W},"mapResponse",Z.mapResponse);if(Z.afterResponse)this.on({as:W},"afterResponse",Z.afterResponse);if(Z.error)this.on({as:W},"error",Z.error);if(Z.detail)if(this.config.detail)this.config.detail=$8(Object.assign({},this.config.detail),Z.detail);else this.config.detail=Z.detail;if(Z?.tags)if(!this.config.detail)this.config.detail={tags:Z.tags};else this.config.detail.tags=Z.tags;return this}return this.guard({},Z)}let Y=new X8({...this.config,prefix:""});Y.singleton={...this.singleton},Y.definitions={...this.definitions},Y.inference=x5(this.inference),Y.extender={...this.extender};let X=$(Y);if(this.singleton=$8(this.singleton,Y.singleton),this.definitions=$8(this.definitions,Y.definitions),X.getServer=()=>this.server,X.event.request?.length)this.event.request=[...this.event.request||[],...X.event.request||[]];if(X.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...X.event.mapResponse||[]];return this.model(X.definitions.type),Object.values(Y.router.history).forEach(({method:W,path:J,handler:z,hooks:Q})=>{this.add(W,J,z,u6(Z,{...Q||{},error:!Q.error?X.event.error:Array.isArray(Q.error)?[...Q.error||{},...X.event.error||[]]:[Q.error,...X.event.error||[]]}))}),this}use(Z,$){if(Array.isArray(Z)){let Y=this;for(let X of Z)Y=Y.use(X);return Y}if($?.scoped)return this.guard({},(Y)=>Y.use(Z));if(Array.isArray(Z)){let Y=this;for(let X of Z)Y=this.use(X);return Y}if(Z instanceof Promise)return this.promisedModules.add(Z.then((Y)=>{if(typeof Y==="function")return Y(this);if(Y instanceof X8)return this._use(Y).compile();if(Y.constructor.name==="Elysia")return this._use(Y).compile();if(typeof Y.default==="function")return Y.default(this);if(Y.default instanceof X8)return this._use(Y.default);if(Y.constructor.name==="Elysia")return this._use(Y.default);if(Y.constructor.name==="_Elysia")return this._use(Y.default);try{return this._use(Y.default)}catch(X){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),X}}).then((Y)=>{if(Y&&typeof Y.compile==="function")Y.compile();return Y})),this;return this._use(Z)}propagatePromiseModules(Z){if(Z.promisedModules.size<=0)return this;for(let $ of Z.promisedModules.promises)this.promisedModules.add($.then((Y)=>{if(!Y)return;let X=this._use(Y);if(X instanceof Promise)return X.then((W)=>{if(W)W.compile();else Y.compile()});return Y.compile()}));return this}_use(Z){if(typeof Z==="function"){let W=Z(this);if(W instanceof Promise)return this.promisedModules.add(W.then((J)=>{if(J instanceof X8){J.getServer=()=>this.getServer(),J.getGlobalRoutes=()=>this.getGlobalRoutes(),J.model(this.definitions.type),J.error(this.definitions.error);for(let{method:z,path:Q,handler:U,hooks:G}of Object.values(J.router.history))this.add(z,Q,U,u6(G,{error:J.event.error}));if(J.compile(),J===this)return;return this.propagatePromiseModules(J),J}if(typeof J==="function")return J(this);if(typeof J.default==="function")return J.default(this);return this._use(J)}).then((J)=>{if(J&&typeof J.compile==="function")J.compile();return J})),this;return W}this.propagatePromiseModules(Z);let{name:$,seed:Y}=Z.config;if(Z.getParent=()=>this,Z.getServer=()=>this.getServer(),Z.getGlobalRoutes=()=>this.getGlobalRoutes(),Z.model(this.definitions.type),Z.error(this.definitions.error),this["~parser"]={...Z["~parser"],...this["~parser"]},this.headers(Z.setHeaders),$){if(!($ in this.dependencies))this.dependencies[$]=[];let W=Y!==void 0?I4($+JSON.stringify(Y)):0;if(!this.dependencies[$].some(({checksum:J})=>W===J))this.extender.macros=this.extender.macros.concat(Z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Z.extender.higherOrderFunctions)}else this.extender.macros=this.extender.macros.concat(Z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Z.extender.higherOrderFunctions);qQ(this.extender.macros),qQ(this.extender.higherOrderFunctions);let X=[];for(let W=0;W<this.extender.higherOrderFunctions.length;W++){let J=this.extender.higherOrderFunctions[W];if(J.checksum){if(X.includes(J.checksum))this.extender.higherOrderFunctions.splice(W,1),W--;X.push(J.checksum)}}this.inference={body:this.inference.body||Z.inference.body,cookie:this.inference.cookie||Z.inference.cookie,headers:this.inference.headers||Z.inference.headers,query:this.inference.query||Z.inference.query,set:this.inference.set||Z.inference.set,server:this.inference.server||Z.inference.server,request:this.inference.request||Z.inference.request,route:this.inference.route||Z.inference.route},this.decorate(Z.singleton.decorator),this.state(Z.singleton.store),this.model(Z.definitions.type),this.error(Z.definitions.error),Z.extender.macros=this.extender.macros.concat(Z.extender.macros);for(let{method:W,path:J,handler:z,hooks:Q}of Object.values(Z.router.history))this.add(W,J,z,u6(Q,{error:Z.event.error}));if($){if(!($ in this.dependencies))this.dependencies[$]=[];let W=Y!==void 0?I4($+JSON.stringify(Y)):0;if(this.dependencies[$].some(({checksum:J})=>W===J))return this;this.dependencies[$].push(this.config?.analytic?{name:Z.config.name,seed:Z.config.seed,checksum:W,dependencies:Z.dependencies,stack:Z.telemetry.stack,routes:Z.router.history,decorators:Z.singleton,store:Z.singleton.store,error:Z.definitions.error,derive:Z.event.transform?.filter((J)=>J?.subType==="derive").map((J)=>({fn:J.toString(),stack:new Error().stack??""})),resolve:Z.event.transform?.filter((J)=>J?.subType==="resolve").map((J)=>({fn:J.toString(),stack:new Error().stack??""}))}:{name:Z.config.name,seed:Z.config.seed,checksum:W,dependencies:Z.dependencies}),this.event=GQ(this.event,UQ(Z.event),W)}else this.event=GQ(this.event,UQ(Z.event));return this.validator.global=u6(this.validator.global,{...Z.validator.global}),this.validator.local=u6(this.validator.local,{...Z.validator.scoped}),this}macro(Z){if(typeof Z==="function"){let $={checksum:I4(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Z.toString()})),fn:Z};this.extender.macros.push($)}else if(typeof Z==="object"){for(let Y of Object.keys(Z))if(typeof Z[Y]==="object"){let X={...Z[Y]};Z[Y]=(W)=>{if(W===!0)return X}}let $={checksum:I4(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Object.entries(Z).map(([Y,X])=>`${Y}+${X}`).join(",")})),fn:()=>Z};this.extender.macros.push($)}return this}mount(Z,$){if(Z instanceof X8||typeof Z==="function"||Z.length===0||Z==="/"){let W=typeof Z==="function"?Z:Z instanceof X8?Z.compile().fetch:$ instanceof X8?$.compile().fetch:$,J=({request:z,path:Q})=>W(new Request(JQ(z.url,Q),{method:z.method,headers:z.headers,signal:z.signal,credentials:z.credentials,referrerPolicy:z.referrerPolicy,duplex:z.duplex,redirect:z.redirect,mode:z.mode,keepalive:z.keepalive,integrity:z.integrity,body:z.body}));return this.all("/*",J,{parse:"none"}),this}if(!$)return this;let Y=Z.length-(Z.endsWith("*")?1:0);if($ instanceof X8)$=$.compile().fetch;let X=({request:W,path:J})=>$(new Request(JQ(W.url,J.slice(Y)||"/"),{method:W.method,headers:W.headers,signal:W.signal,credentials:W.credentials,referrerPolicy:W.referrerPolicy,duplex:W.duplex,redirect:W.redirect,mode:W.mode,keepalive:W.keepalive,integrity:W.integrity,body:W.body}));return this.all(Z,X,{parse:"none"}),this.all(Z+(Z.endsWith("/")?"*":"/*"),X,{parse:"none"}),this}get(Z,$,Y){return this.add("GET",Z,$,Y),this}post(Z,$,Y){return this.add("POST",Z,$,Y),this}put(Z,$,Y){return this.add("PUT",Z,$,Y),this}patch(Z,$,Y){return this.add("PATCH",Z,$,Y),this}delete(Z,$,Y){return this.add("DELETE",Z,$,Y),this}options(Z,$,Y){return this.add("OPTIONS",Z,$,Y),this}all(Z,$,Y){return this.add("ALL",Z,$,Y),this}head(Z,$,Y){return this.add("HEAD",Z,$,Y),this}connect(Z,$,Y){return this.add("CONNECT",Z,$,Y),this}route(Z,$,Y,X){return this.add(Z.toUpperCase(),$,Y,X,X?.config),this}ws(Z,$){if(this["~adapter"].ws)this["~adapter"].ws(this,Z,$);else console.warn("Current adapter doesn't support WebSocket");return this}state(Z,$,Y){if($===void 0)Y=Z,Z={as:"append"},$="";else if(Y===void 0){if(typeof Z==="string")Y=$,$=Z,Z={as:"append"};else if(typeof Z==="object")Y=$,$=""}let{as:X}=Z;if(typeof $!=="string")return this;switch(typeof Y){case"object":if($){if($ in this.singleton.store)this.singleton.store[$]=$8(this.singleton.store[$],Y,{override:X==="override"});else this.singleton.store[$]=Y;return this}if(Y===null)return this;return this.singleton.store=$8(this.singleton.store,Y,{override:X==="override"}),this;case"function":if($){if(X==="override"||!($ in this.singleton.store))this.singleton.store[$]=Y}else this.singleton.store=Y(this.singleton.store);return this;default:if(X==="override"||!($ in this.singleton.store))this.singleton.store[$]=Y;return this}}decorate(Z,$,Y){if($===void 0)Y=Z,Z={as:"append"},$="";else if(Y===void 0){if(typeof Z==="string")Y=$,$=Z,Z={as:"append"};else if(typeof Z==="object")Y=$,$=""}let{as:X}=Z;if(typeof $!=="string")return this;switch(typeof Y){case"object":if($){if($ in this.singleton.decorator)this.singleton.decorator[$]=$8(this.singleton.decorator[$],Y,{override:X==="override"});else this.singleton.decorator[$]=Y;return this}if(Y===null)return this;return this.singleton.decorator=$8(this.singleton.decorator,Y,{override:X==="override"}),this;case"function":if($){if(X==="override"||!($ in this.singleton.decorator))this.singleton.decorator[$]=Y}else this.singleton.decorator=Y(this.singleton.decorator);return this;default:if(X==="override"||!($ in this.singleton.decorator))this.singleton.decorator[$]=Y;return this}}derive(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"derive",fn:$};return this.onTransform(Z,Y)}model(Z,$){let Y=(X)=>g5(X,[{from:v.Number(),to:(W)=>v.Numeric(W),untilObjectFound:!0},{from:v.Boolean(),to:(W)=>v.BooleanString(W),untilObjectFound:!0}]);switch(typeof Z){case"object":let X={},W=Object.entries(Z);for(let[Q,U]of W){if(Q in this.definitions.type)continue;X[Q]=this.definitions.type[Q]=Y(U),X[Q].$id??=`#/components/schemas/${Q}`}return this.definitions.typebox=v.Module({...this.definitions.typebox.$defs,...X}),this;case"function":let J=Y(Z(this.definitions.type));return this.definitions.type=J,this.definitions.typebox=v.Module(J),this;case"string":if(!$)break;let z={...$,id:$.$id??`#/components/schemas/${Z}`};return this.definitions.type[Z]=$,this.definitions.typebox=v.Module({...this.definitions.typebox.$defs,...z}),this}return this.definitions.type[Z]=$,this.definitions.typebox=v.Module({...this.definitions.typebox.$defs,[Z]:$}),this}mapDerive(Z,$){if(!$)$=Z,Z={as:"local"};let Y={subType:"mapDerive",fn:$};return this.onTransform(Z,Y)}affix(Z,$,Y){if(Y==="")return this;let X=["_","-"," "],W=(U)=>U[0].toUpperCase()+U.slice(1),J=Z==="prefix"?(U,G)=>X.includes(U.at(-1)??"")?U+G:U+W(G):X.includes(Y.at(-1)??"")?(U,G)=>G+U:(U,G)=>G+W(U),z=(U)=>{let G={};switch(U){case"decorator":for(let H in this.singleton.decorator)G[J(Y,H)]=this.singleton.decorator[H];this.singleton.decorator=G;break;case"state":for(let H in this.singleton.store)G[J(Y,H)]=this.singleton.store[H];this.singleton.store=G;break;case"model":for(let H in this.definitions.type)G[J(Y,H)]=this.definitions.type[H];this.definitions.type=G;break;case"error":for(let H in this.definitions.error)G[J(Y,H)]=this.definitions.error[H];this.definitions.error=G;break}},Q=Array.isArray($)?$:[$];for(let U of Q.some((G)=>G==="all")?["decorator","state","model","error"]:Q)z(U);return this}prefix(Z,$){return this.affix("prefix",Z,$)}suffix(Z,$){return this.affix("suffix",Z,$)}compile(){if(this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?k5(this):KQ(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=k5(this),this}handle=async(Z)=>this.fetch(Z);fetch=(Z)=>{return(this.fetch=this.config.aot?k5(this):KQ(this))(Z)};handleError=async(Z,$)=>{return(this.handleError=this.config.aot?lQ(this):yj(this))(Z,$)};outerErrorHandler=(Z)=>new Response(Z.message||Z.name||"Error",{status:Z?.status??500});listen=(Z,$)=>{return this["~adapter"].listen(this)(Z,$),this};stop=async(Z)=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(Z),this.server=null,this.event.stop?.length)for(let $=0;$<this.event.stop.length;$++)this.event.stop[$].fn(this)}};get modules(){return this.promisedModules}}var vj=typeof new Headers()?.toJSON==="function",hj=(Z)=>{if(vj)return Object.keys(Z.toJSON()).join(", ");let $="";if(Z.forEach((Y,X)=>{$+=X+", "}),$)$=$.slice(0,-1);return $},nQ=(Z,$,Y)=>{if(Array.isArray(Z))return Z.some((X)=>nQ(X,$,Y));switch(typeof Z){case"string":if(Z.indexOf("://")===-1)return Y.includes(Z);return Z===Y;case"function":return Z($)===!0;case"object":if(Z instanceof RegExp)return Z.test(Y)}return!1},oQ=(Z)=>{let{aot:$=!0,origin:Y=!0,methods:X=!0,allowedHeaders:W=!0,exposeHeaders:J=!0,credentials:z=!0,maxAge:Q=5,preflight:U=!0}=Z??{};if(Array.isArray(W))W=W.join(", ");if(Array.isArray(J))J=J.join(", ");let G=typeof Y==="boolean"?void 0:Array.isArray(Y)?Y:[Y],H=new X8({name:"@elysiajs/cors",seed:Z,aot:$}),M=G?.some((L)=>L==="*"),q=(L,b)=>{if(Y===!0){L.headers.vary="*",L.headers["access-control-allow-origin"]=b.headers.get("Origin")||"*";return}if(M){L.headers.vary="*",L.headers["access-control-allow-origin"]="*";return}if(!G?.length)return;let s=[];if(G.length){let t=b.headers.get("Origin")??"";for(let J1=0;J1<G.length;J1++){let Y1=nQ(G[J1],b,t);if(Y1===!0){L.headers.vary=Y?"Origin":"*",L.headers["access-control-allow-origin"]=t||"*";return}if(Y1)s.push(Y1)}}if(L.headers.vary="Origin",s.length)L.headers["access-control-allow-origin"]=s.join(", ")},w=(L,b)=>{if(!b)return;if(X===!0)return L.headers["access-control-allow-methods"]=b??"*";if(X===!1||!X?.length)return;if(X==="*")return L.headers["access-control-allow-methods"]="*";if(!Array.isArray(X))return L.headers["access-control-allow-methods"]=X;L.headers["access-control-allow-methods"]=X.join(", ")},B={};if(typeof J==="string")B["access-control-expose-headers"]=J;if(typeof W==="string")B["access-control-allow-headers"]=W;if(z===!0)B["access-control-allow-credentials"]="true";H.headers(B);function D({set:L,request:b,headers:s}){if(q(L,b),w(L,b.headers.get("access-control-request-method")),W===!0||J===!0){if(W===!0)L.headers["access-control-allow-headers"]=s["access-control-request-headers"];if(J===!0)L.headers["access-control-expose-headers"]=Object.keys(s).join(",")}if(Q)L.headers["access-control-max-age"]=Q.toString();return new Response(null,{status:204})}if(U)H.options("/",D).options("/*",D);return H.onRequest(function L({set:b,request:s}){if(q(b,s),w(b,s.method),W===!0||J===!0){let t=hj(s.headers);if(W===!0)b.headers["access-control-allow-headers"]=t;if(J===!0)b.headers["access-control-expose-headers"]=t}})};var bq=hX(EM(),1);var n$={jwt:{EXPIRATION_TIME:3600,KEY_PREFIX:"jwt",REDIS_DB_KEY:0},avatar:{EXPIRATION_TIME:21600,KEY_PREFIX:"avatar",REDIS_DB_KEY:1},lessons:{EXPIRATION_TIME:3600,KEY_PREFIX:"lessons",REDIS_DB_KEY:2},periods:{EXPIRATION_TIME:3600,KEY_PREFIX:"periods",REDIS_DB_KEY:3},users:{EXPIRATION_TIME:86400,KEY_PREFIX:"users",REDIS_DB_KEY:9}};var Tq=hX(Pq(),1),kq=globalThis,uv=process.env.REDIS_URL||"",xq=2,e$=kq.redis||new Tq.default(uv,{retryStrategy:(Z,$)=>{if($?.code==="ENOTFOUND")return console.error("Redis DNS hatas\u0131, tekrar denenmeyecek:",$),null;if(Z>=xq)return console.error(`Redis ba\u011Flant\u0131s\u0131 ${xq} kez ba\u015Far\u0131s\u0131z oldu, duruyor...`),null;return Math.min(Z*1000,5000)}});kq.redis=e$;var Z4=async(Z,$,Y)=>{await e$.select($);try{let X=await e$.get(Z);if(!X)return null;return Y?JSON.parse(X):X}catch(X){return console.error("Redis get error:",X),null}},$4=async(Z,$,Y,X,W)=>{await e$.select(X);try{let J=W?JSON.stringify($):$;await e$.set(Z,J,"EX",Y)}catch(J){console.error("Redis set error:",J)}};var fq=process.env.JWT_SECRET_KEY,DW=n$.jwt;if(!fq)throw new Error("JWT_SECRET_KEY is not defined in environment variables.");async function iv(Z){try{let $=bq.default.verify(Z,fq),Y=Math.floor(Date.now()/1000);if(!$||!$.exp||$.exp<Y)return null;return await $4(Z,$,DW.EXPIRATION_TIME,DW.REDIS_DB_KEY,!0),$}catch($){return null}}async function gq(Z){let $=Z.split(" ");if($.length!==2||$[0]!=="Bearer")return null;let Y=$[1],X=Math.floor(Date.now()/1000),W=await Z4(Y,DW.REDIS_DB_KEY,!0);if(W?.exp&&W.exp>X)return W;return await iv(Y)}async function qW(Z,$){if(!Z.authorization)return{status:!1,message:"Access denied. No token provided."};let Y=await gq(Z.authorization);if(!Y)return{status:!1,message:"Access denied. User not found."};if(!Y.userId)return{status:!1,message:"Access denied. Invalid token."};if(!$.includes(Y.role))return{status:!1,message:"You do not have permission to access this resource."};return{status:!0,user:Y}}var{SQL:nW}=globalThis.Bun;var O=Symbol.for("drizzle:entityKind"),v81=Symbol.for("drizzle:hasOwnEntityKind");function j(Z,$){if(!Z||typeof Z!=="object")return!1;if(Z instanceof $)return!0;if(!Object.prototype.hasOwnProperty.call($,O))throw new Error(`Class "${$.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let Y=Object.getPrototypeOf(Z).constructor;if(Y)while(Y){if(O in Y&&Y[O]===$[O])return!0;Y=Object.getPrototypeOf(Y)}return!1}class yq{static[O]="ConsoleLogWriter";write(Z){console.log(Z)}}class AW{static[O]="DefaultLogger";writer;constructor(Z){this.writer=Z?.writer??new yq}logQuery(Z,$){let Y=$.map((W)=>{try{return JSON.stringify(W)}catch{return String(W)}}),X=Y.length?` -- params: [${Y.join(", ")}]`:"";this.writer.write(`Query: ${Z}${X}`)}}class OW{static[O]="NoopLogger";logQuery(){}}class u0{static[O]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(Z){return this.then(void 0,Z)}finally(Z){return this.then(($)=>{return Z?.(),$},($)=>{throw Z?.(),$})}then(Z,$){return this.execute().then(Z,$)}}class h1{constructor(Z,$){this.table=Z,this.config=$,this.name=$.name,this.keyAsName=$.keyAsName,this.notNull=$.notNull,this.default=$.default,this.defaultFn=$.defaultFn,this.onUpdateFn=$.onUpdateFn,this.hasDefault=$.hasDefault,this.primary=$.primaryKey,this.isUnique=$.isUnique,this.uniqueName=$.uniqueName,this.uniqueType=$.uniqueType,this.dataType=$.dataType,this.columnType=$.columnType,this.generated=$.generated,this.generatedIdentity=$.generatedIdentity}static[O]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(Z){return Z}mapToDriverValue(Z){return Z}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class FW{static[O]="ColumnBuilder";config;constructor(Z,$,Y){this.config={name:Z,keyAsName:Z==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:$,columnType:Y,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(Z){return this.config.default=Z,this.config.hasDefault=!0,this}$defaultFn(Z){return this.config.defaultFn=Z,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(Z){return this.config.onUpdateFn=Z,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(Z){if(this.config.name!=="")return;this.config.name=Z}}var D6=Symbol.for("drizzle:Name");class SW{static[O]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(Z,$){if(this.reference=()=>{let{name:Y,columns:X,foreignColumns:W}=Z();return{name:Y,columns:X,foreignTable:W[0].table,foreignColumns:W}},$)this._onUpdate=$.onUpdate,this._onDelete=$.onDelete}onUpdate(Z){return this._onUpdate=Z===void 0?"no action":Z,this}onDelete(Z){return this._onDelete=Z===void 0?"no action":Z,this}build(Z){return new vq(Z,this)}}class vq{constructor(Z,$){this.table=Z,this.reference=$.reference,this.onUpdate=$._onUpdate,this.onDelete=$._onDelete}static[O]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:Z,columns:$,foreignColumns:Y}=this.reference(),X=$.map((z)=>z.name),W=Y.map((z)=>z.name),J=[this.table[D6],...X,Y[0].table[D6],...W];return Z??`${J.join("_")}_fk`}}function qX(Z,...$){return Z(...$)}function hq(Z,$){return`${Z[D6]}_${$.join("_")}_unique`}function dq(Z,$,Y){for(let X=$;X<Z.length;X++){let W=Z[X];if(W==="\\"){X++;continue}if(W==='"')return[Z.slice($,X).replace(/\\/g,""),X+1];if(Y)continue;if(W===","||W==="}")return[Z.slice($,X).replace(/\\/g,""),X]}return[Z.slice($).replace(/\\/g,""),Z.length]}function pq(Z,$=0){let Y=[],X=$,W=!1;while(X<Z.length){let J=Z[X];if(J===","){if(W||X===$)Y.push("");W=!0,X++;continue}if(W=!1,J==="\\"){X+=2;continue}if(J==='"'){let[U,G]=dq(Z,X+1,!0);Y.push(U),X=G;continue}if(J==="}")return[Y,X+1];if(J==="{"){let[U,G]=pq(Z,X+1);Y.push(U),X=G;continue}let[z,Q]=dq(Z,X,!1);Y.push(z),X=Q}return[Y,X]}function mq(Z){let[$]=pq(Z,1);return $}function NW(Z){return`{${Z.map(($)=>{if(Array.isArray($))return NW($);if(typeof $==="string")return`"${$.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")}"`;return`${$}`}).join(",")}}`}class l extends FW{foreignKeyConfigs=[];static[O]="PgColumnBuilder";array(Z){return new uq(this.config.name,this,Z)}references(Z,$={}){return this.foreignKeyConfigs.push({ref:Z,actions:$}),this}unique(Z,$){return this.config.isUnique=!0,this.config.uniqueName=Z,this.config.uniqueType=$?.nulls,this}generatedAlwaysAs(Z){return this.config.generated={as:Z,type:"always",mode:"stored"},this}buildForeignKeys(Z,$){return this.foreignKeyConfigs.map(({ref:Y,actions:X})=>{return qX((W,J)=>{let z=new SW(()=>{let Q=W();return{columns:[Z],foreignColumns:[Q]}});if(J.onUpdate)z.onUpdate(J.onUpdate);if(J.onDelete)z.onDelete(J.onDelete);return z.build($)},Y,X)})}buildExtraConfigColumn(Z){return new cq(Z,this.config)}}class y extends h1{constructor(Z,$){if(!$.uniqueName)$.uniqueName=hq(Z,[$.name]);super(Z,$);this.table=Z}static[O]="PgColumn"}class cq extends y{static[O]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(Z){return this.indexConfig.opClass=Z,this}}class uq extends l{static[O]="PgArrayBuilder";constructor(Z,$,Y){super(Z,"array","PgArray");this.config.baseBuilder=$,this.config.size=Y}build(Z){let $=this.config.baseBuilder.build(Z);return new BW(Z,this.config,$)}}class BW extends y{constructor(Z,$,Y,X){super(Z,$);this.baseColumn=Y,this.range=X,this.size=$.size}size;static[O]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size==="number"?this.size:""}]`}mapFromDriverValue(Z){if(typeof Z==="string")Z=mq(Z);return Z.map(($)=>this.baseColumn.mapFromDriverValue($))}mapToDriverValue(Z,$=!1){let Y=Z.map((X)=>X===null?null:j(this.baseColumn,BW)?this.baseColumn.mapToDriverValue(X,!0):this.baseColumn.mapToDriverValue(X));if($)return Y;return NW(Y)}}var LW=Symbol.for("drizzle:isPgEnum");function iq(Z){return!!Z&&typeof Z==="function"&&LW in Z&&Z[LW]===!0}class lq extends l{static[O]="PgEnumColumnBuilder";constructor(Z,$){super(Z,"string","PgEnumColumn");this.config.enum=$}build(Z){return new nq(Z,this.config)}}class nq extends y{static[O]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(Z,$){super(Z,$);this.enum=$.enum}getSQLType(){return this.enum.enumName}}function Y4(Z,$){return lv(Z,$,void 0)}function lv(Z,$,Y){let X=Object.assign((W)=>new lq(W??"",X),{enumName:Z,enumValues:$,schema:Y,[LW]:!0});return X}class q0{static[O]="Subquery";constructor(Z,$,Y,X=!1){this._={brand:"Subquery",sql:Z,selectedFields:$,alias:Y,isWith:X}}}class JY extends q0{static[O]="WithSubquery"}var oq="0.41.0";var _W,KW,d1={startActiveSpan(Z,$){if(!_W)return $();if(!KW)KW=_W.trace.getTracer("drizzle-orm",oq);return qX((Y,X)=>X.startActiveSpan(Z,(W)=>{try{return $(W)}catch(J){throw W.setStatus({code:Y.SpanStatusCode.ERROR,message:J instanceof Error?J.message:"Unknown error"}),J}finally{W.end()}}),_W,KW)}};var i1=Symbol.for("drizzle:ViewBaseConfig");var AX=Symbol.for("drizzle:Schema"),OX=Symbol.for("drizzle:Columns"),tq=Symbol.for("drizzle:ExtraConfigColumns"),RW=Symbol.for("drizzle:OriginalName"),VW=Symbol.for("drizzle:BaseName"),zY=Symbol.for("drizzle:IsAlias"),sq=Symbol.for("drizzle:ExtraConfigBuilder"),nv=Symbol.for("drizzle:IsDrizzleTable");class p{static[O]="Table";static Symbol={Name:D6,Schema:AX,OriginalName:RW,Columns:OX,ExtraConfigColumns:tq,BaseName:VW,IsAlias:zY,ExtraConfigBuilder:sq};[D6];[RW];[AX];[OX];[tq];[VW];[zY]=!1;[nv]=!0;[sq]=void 0;constructor(Z,$,Y){this[D6]=this[RW]=Z,this[AX]=$,this[VW]=Y}}function z8(Z){return Z[D6]}function X$(Z){return`${Z[AX]??"public"}.${Z[D6]}`}function EW(Z){return Z!==null&&Z!==void 0&&typeof Z.getSQL==="function"}function ov(Z){let $={sql:"",params:[]};for(let Y of Z)if($.sql+=Y.sql,$.params.push(...Y.params),Y.typings?.length){if(!$.typings)$.typings=[];$.typings.push(...Y.typings)}return $}class A0{static[O]="StringChunk";value;constructor(Z){this.value=Array.isArray(Z)?Z:[Z]}getSQL(){return new n([this])}}class n{constructor(Z){this.queryChunks=Z}static[O]="SQL";decoder=aq;shouldInlineParams=!1;append(Z){return this.queryChunks.push(...Z.queryChunks),this}toQuery(Z){return d1.startActiveSpan("drizzle.buildSQL",($)=>{let Y=this.buildQueryFromSourceParams(this.queryChunks,Z);return $?.setAttributes({"drizzle.query.text":Y.sql,"drizzle.query.params":JSON.stringify(Y.params)}),Y})}buildQueryFromSourceParams(Z,$){let Y=Object.assign({},$,{inlineParams:$.inlineParams||this.shouldInlineParams,paramStartIndex:$.paramStartIndex||{value:0}}),{casing:X,escapeName:W,escapeParam:J,prepareTyping:z,inlineParams:Q,paramStartIndex:U}=Y;return ov(Z.map((G)=>{if(j(G,A0))return{sql:G.value.join(""),params:[]};if(j(G,FX))return{sql:W(G.value),params:[]};if(G===void 0)return{sql:"",params:[]};if(Array.isArray(G)){let H=[new A0("(")];for(let[M,q]of G.entries())if(H.push(q),M<G.length-1)H.push(new A0(", "));return H.push(new A0(")")),this.buildQueryFromSourceParams(H,Y)}if(j(G,n))return this.buildQueryFromSourceParams(G.queryChunks,{...Y,inlineParams:Q||G.shouldInlineParams});if(j(G,p)){let H=G[p.Symbol.Schema],M=G[p.Symbol.Name];return{sql:H===void 0||G[zY]?W(M):W(H)+"."+W(M),params:[]}}if(j(G,h1)){let H=X.getColumnCasing(G);if($.invokeSource==="indexes")return{sql:W(H),params:[]};let M=G.table[p.Symbol.Schema];return{sql:G.table[zY]||M===void 0?W(G.table[p.Symbol.Name])+"."+W(H):W(M)+"."+W(G.table[p.Symbol.Name])+"."+W(H),params:[]}}if(j(G,Q8)){let H=G[i1].schema,M=G[i1].name;return{sql:H===void 0||G[i1].isAlias?W(M):W(H)+"."+W(M),params:[]}}if(j(G,K8)){if(j(G.value,jZ))return{sql:J(U.value++,G),params:[G],typings:["none"]};let H=G.value===null?null:G.encoder.mapToDriverValue(G.value);if(j(H,n))return this.buildQueryFromSourceParams([H],Y);if(Q)return{sql:this.mapInlineParam(H,Y),params:[]};let M=["none"];if(z)M=[z(G.encoder)];return{sql:J(U.value++,H),params:[H],typings:M}}if(j(G,jZ))return{sql:J(U.value++,G),params:[G],typings:["none"]};if(j(G,n.Aliased)&&G.fieldAlias!==void 0)return{sql:W(G.fieldAlias),params:[]};if(j(G,q0)){if(G._.isWith)return{sql:W(G._.alias),params:[]};return this.buildQueryFromSourceParams([new A0("("),G._.sql,new A0(") "),new FX(G._.alias)],Y)}if(iq(G)){if(G.schema)return{sql:W(G.schema)+"."+W(G.enumName),params:[]};return{sql:W(G.enumName),params:[]}}if(EW(G)){if(G.shouldOmitSQLParens?.())return this.buildQueryFromSourceParams([G.getSQL()],Y);return this.buildQueryFromSourceParams([new A0("("),G.getSQL(),new A0(")")],Y)}if(Q)return{sql:this.mapInlineParam(G,Y),params:[]};return{sql:J(U.value++,G),params:[G],typings:["none"]}}))}mapInlineParam(Z,{escapeString:$}){if(Z===null)return"null";if(typeof Z==="number"||typeof Z==="boolean")return Z.toString();if(typeof Z==="string")return $(Z);if(typeof Z==="object"){let Y=Z.toString();if(Y==="[object Object]")return $(JSON.stringify(Z));return $(Y)}throw new Error("Unexpected param value: "+Z)}getSQL(){return this}as(Z){if(Z===void 0)return this;return new n.Aliased(this,Z)}mapWith(Z){return this.decoder=typeof Z==="function"?{mapFromDriverValue:Z}:Z,this}inlineParams(){return this.shouldInlineParams=!0,this}if(Z){return Z?this:void 0}}class FX{constructor(Z){this.value=Z}static[O]="Name";brand;getSQL(){return new n([this])}}function rq(Z){return typeof Z==="object"&&Z!==null&&"mapToDriverValue"in Z&&typeof Z.mapToDriverValue==="function"}var aq={mapFromDriverValue:(Z)=>Z},eq={mapToDriverValue:(Z)=>Z},P61={...aq,...eq};class K8{constructor(Z,$=eq){this.value=Z,this.encoder=$}static[O]="Param";brand;getSQL(){return new n([this])}}function F(Z,...$){let Y=[];if($.length>0||Z.length>0&&Z[0]!=="")Y.push(new A0(Z[0]));for(let[X,W]of $.entries())Y.push(W,new A0(Z[X+1]));return new n(Y)}((Z)=>{function $(){return new n([])}Z.empty=$;function Y(U){return new n(U)}Z.fromList=Y;function X(U){return new n([new A0(U)])}Z.raw=X;function W(U,G){let H=[];for(let[M,q]of U.entries()){if(M>0&&G!==void 0)H.push(G);H.push(q)}return new n(H)}Z.join=W;function J(U){return new FX(U)}Z.identifier=J;function z(U){return new jZ(U)}Z.placeholder=z;function Q(U,G){return new K8(U,G)}Z.param=Q})(F||(F={}));((Z)=>{class ${constructor(Y,X){this.sql=Y,this.fieldAlias=X}static[O]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new $(this.sql,this.fieldAlias)}}Z.Aliased=$})(n||(n={}));class jZ{constructor(Z){this.name=Z}static[O]="Placeholder";getSQL(){return new n([this])}}function jW(Z,$){return Z.map((Y)=>{if(j(Y,jZ)){if(!(Y.name in $))throw new Error(`No value for placeholder "${Y.name}" was provided`);return $[Y.name]}if(j(Y,K8)&&j(Y.value,jZ)){if(!(Y.value.name in $))throw new Error(`No value for placeholder "${Y.value.name}" was provided`);return Y.encoder.mapToDriverValue($[Y.value.name])}return Y})}var tv=Symbol.for("drizzle:IsDrizzleView");class Q8{static[O]="View";[i1];[tv]=!0;constructor({name:Z,schema:$,selectedFields:Y,query:X}){this[i1]={name:Z,originalName:Z,schema:$,selectedFields:Y,query:X,isExisting:!X,isAlias:!1}}getSQL(){return new n([this])}}h1.prototype.getSQL=function(){return new n([this])};p.prototype.getSQL=function(){return new n([this])};q0.prototype.getSQL=function(){return new n([this])};class X4{constructor(Z){this.table=Z}static[O]="ColumnAliasProxyHandler";get(Z,$){if($==="table")return this.table;return Z[$]}}class QY{constructor(Z,$){this.alias=Z,this.replaceOriginalName=$}static[O]="TableAliasProxyHandler";get(Z,$){if($===p.Symbol.IsAlias)return!0;if($===p.Symbol.Name)return this.alias;if(this.replaceOriginalName&&$===p.Symbol.OriginalName)return this.alias;if($===i1)return{...Z[i1],name:this.alias,isAlias:!0};if($===p.Symbol.Columns){let X=Z[p.Symbol.Columns];if(!X)return X;let W={};return Object.keys(X).map((J)=>{W[J]=new Proxy(X[J],new X4(new Proxy(Z,this)))}),W}let Y=Z[$];if(j(Y,h1))return new Proxy(Y,new X4(new Proxy(Z,this)));return Y}}function SX(Z,$){return new Proxy(Z,new QY($,!1))}function j6(Z,$){return new Proxy(Z,new X4(new Proxy(Z.table,new QY($,!1))))}function CW(Z,$){return new n.Aliased(GY(Z.sql,$),Z.fieldAlias)}function GY(Z,$){return F.join(Z.queryChunks.map((Y)=>{if(j(Y,h1))return j6(Y,$);if(j(Y,n))return GY(Y,$);if(j(Y,n.Aliased))return CW(Y,$);return Y}))}class J0{static[O]="SelectionProxyHandler";config;constructor(Z){this.config={...Z}}get(Z,$){if($==="_")return{...Z._,selectedFields:new Proxy(Z._.selectedFields,this)};if($===i1)return{...Z[i1],selectedFields:new Proxy(Z[i1].selectedFields,this)};if(typeof $==="symbol")return Z[$];let X=(j(Z,q0)?Z._.selectedFields:j(Z,Q8)?Z[i1].selectedFields:Z)[$];if(j(X,n.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!X.isSelectionField)return X.sql;let W=X.clone();return W.isSelectionField=!0,W}if(j(X,n)){if(this.config.sqlBehavior==="sql")return X;throw new Error(`You tried to reference "${$}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}if(j(X,h1)){if(this.config.alias)return new Proxy(X,new X4(new Proxy(X.table,new QY(this.config.alias,this.config.replaceOriginalName??!1))));return X}if(typeof X!=="object"||X===null)return X;return new Proxy(X,new J0(this.config))}}function ZA(Z,$,Y){let X={},W=Z.reduce((J,{path:z,field:Q},U)=>{let G;if(j(Q,h1))G=Q;else if(j(Q,n))G=Q.decoder;else G=Q.sql.decoder;let H=J;for(let[M,q]of z.entries())if(M<z.length-1){if(!(q in H))H[q]={};H=H[q]}else{let w=$[U],B=H[q]=w===null?null:G.mapFromDriverValue(w);if(Y&&j(Q,h1)&&z.length===2){let D=z[0];if(!(D in X))X[D]=B===null?z8(Q.table):!1;else if(typeof X[D]==="string"&&X[D]!==z8(Q.table))X[D]=!1}}return J},{});if(Y&&Object.keys(X).length>0){for(let[J,z]of Object.entries(X))if(typeof z==="string"&&!Y[z])W[J]=null}return W}function d8(Z,$){return Object.entries(Z).reduce((Y,[X,W])=>{if(typeof X!=="string")return Y;let J=$?[...$,X]:[X];if(j(W,h1)||j(W,n)||j(W,n.Aliased))Y.push({path:J,field:W});else if(j(W,p))Y.push(...d8(W[p.Symbol.Columns],J));else Y.push(...d8(W,J));return Y},[])}function UY(Z,$){let Y=Object.keys(Z),X=Object.keys($);if(Y.length!==X.length)return!1;for(let[W,J]of Y.entries())if(J!==X[W])return!1;return!0}function NX(Z,$){let Y=Object.entries($).filter(([,X])=>X!==void 0).map(([X,W])=>{if(j(W,n)||j(W,h1))return[X,W];else return[X,new K8(W,Z[p.Symbol.Columns][X])]});if(Y.length===0)throw new Error("No values to set");return Object.fromEntries(Y)}function $A(Z,$){for(let Y of $)for(let X of Object.getOwnPropertyNames(Y.prototype)){if(X==="constructor")continue;Object.defineProperty(Z.prototype,X,Object.getOwnPropertyDescriptor(Y.prototype,X)||Object.create(null))}}function YA(Z){return Z[p.Symbol.Columns]}function o6(Z){return j(Z,q0)?Z._.alias:j(Z,Q8)?Z[i1].name:j(Z,n)?void 0:Z[p.Symbol.IsAlias]?Z[p.Symbol.Name]:Z[p.Symbol.BaseName]}function N1(Z,$){return{name:typeof Z==="string"&&Z.length>0?Z:"",config:typeof Z==="object"?Z:$}}function XA(Z){if(typeof Z!=="object"||Z===null)return!1;if(Z.constructor.name!=="Object")return!1;if("logger"in Z){let $=typeof Z.logger;if($!=="boolean"&&($!=="object"||typeof Z.logger.logQuery!=="function")&&$!=="undefined")return!1;return!0}if("schema"in Z){let $=typeof Z.schema;if($!=="object"&&$!=="undefined")return!1;return!0}if("casing"in Z){let $=typeof Z.casing;if($!=="string"&&$!=="undefined")return!1;return!0}if("mode"in Z){if(Z.mode!=="default"||Z.mode!=="planetscale"||Z.mode!==void 0)return!1;return!0}if("connection"in Z){let $=typeof Z.connection;if($!=="string"&&$!=="object"&&$!=="undefined")return!1;return!0}if("client"in Z){let $=typeof Z.client;if($!=="object"&&$!=="function"&&$!=="undefined")return!1;return!0}if(Object.keys(Z).length===0)return!0;return!1}class BX extends u0{constructor(Z,$,Y,X){super();this.session=$,this.dialect=Y,this.config={table:Z,withList:X}}static[O]="PgDelete";config;where(Z){return this.config.where=Z,this}returning(Z=this.config.table[p.Symbol.Columns]){return this.config.returningFields=Z,this.config.returning=d8(Z),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:Z,...$}=this.dialect.sqlToQuery(this.getSQL());return $}_prepare(Z){return d1.startActiveSpan("drizzle.prepareQuery",()=>{return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,Z,!0)})}prepare(Z){return this._prepare(Z)}authToken;setToken(Z){return this.authToken=Z,this}execute=(Z)=>{return d1.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(Z,this.authToken)})};getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new J0({alias:z8(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}function sv(Z){return(Z.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map((Y)=>Y.toLowerCase()).join("_")}function rv(Z){return(Z.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((Y,X,W)=>{let J=W===0?X.toLowerCase():`${X[0].toUpperCase()}${X.slice(1)}`;return Y+J},"")}function av(Z){return Z}class IW{static[O]="CasingCache";cache={};cachedTables={};convert;constructor(Z){this.convert=Z==="snake_case"?sv:Z==="camelCase"?rv:av}getColumnCasing(Z){if(!Z.keyAsName)return Z.name;let $=Z.table[p.Symbol.Schema]??"public",Y=Z.table[p.Symbol.OriginalName],X=`${$}.${Y}.${Z.name}`;if(!this.cache[X])this.cacheTable(Z.table);return this.cache[X]}cacheTable(Z){let $=Z[p.Symbol.Schema]??"public",Y=Z[p.Symbol.OriginalName],X=`${$}.${Y}`;if(!this.cachedTables[X]){for(let W of Object.values(Z[p.Symbol.Columns])){let J=`${X}.${W.name}`;this.cache[J]=this.convert(W.name)}this.cachedTables[X]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class LX extends Error{static[O]="DrizzleError";constructor({message:Z,cause:$}){super(Z);this.name="DrizzleError",this.cause=$}}class PW extends LX{static[O]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}class CZ extends l{static[O]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(Z){if(Z){let{name:$,...Y}=Z;this.config.generatedIdentity={type:"always",sequenceName:$,sequenceOptions:Y}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(Z){if(Z){let{name:$,...Y}=Z;this.config.generatedIdentity={type:"byDefault",sequenceName:$,sequenceOptions:Y}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class WA extends CZ{static[O]="PgBigInt53Builder";constructor(Z){super(Z,"number","PgBigInt53")}build(Z){return new JA(Z,this.config)}}class JA extends y{static[O]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(Z){if(typeof Z==="number")return Z;return Number(Z)}}class zA extends CZ{static[O]="PgBigInt64Builder";constructor(Z){super(Z,"bigint","PgBigInt64")}build(Z){return new QA(Z,this.config)}}class QA extends y{static[O]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(Z){return BigInt(Z)}}function GA(Z,$){let{name:Y,config:X}=N1(Z,$);if(X.mode==="number")return new WA(Y);return new zA(Y)}class UA extends l{static[O]="PgBigSerial53Builder";constructor(Z){super(Z,"number","PgBigSerial53");this.config.hasDefault=!0,this.config.notNull=!0}build(Z){return new HA(Z,this.config)}}class HA extends y{static[O]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(Z){if(typeof Z==="number")return Z;return Number(Z)}}class MA extends l{static[O]="PgBigSerial64Builder";constructor(Z){super(Z,"bigint","PgBigSerial64");this.config.hasDefault=!0}build(Z){return new wA(Z,this.config)}}class wA extends y{static[O]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(Z){return BigInt(Z)}}function DA(Z,$){let{name:Y,config:X}=N1(Z,$);if(X.mode==="number")return new UA(Y);return new MA(Y)}class qA extends l{static[O]="PgBooleanBuilder";constructor(Z){super(Z,"boolean","PgBoolean")}build(Z){return new AA(Z,this.config)}}class AA extends y{static[O]="PgBoolean";getSQLType(){return"boolean"}}function t6(Z){return new qA(Z??"")}class OA extends l{static[O]="PgCharBuilder";constructor(Z,$){super(Z,"string","PgChar");this.config.length=$.length,this.config.enumValues=$.enum}build(Z){return new FA(Z,this.config)}}class FA extends y{static[O]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function SA(Z,$={}){let{name:Y,config:X}=N1(Z,$);return new OA(Y,X)}class NA extends l{static[O]="PgCidrBuilder";constructor(Z){super(Z,"string","PgCidr")}build(Z){return new BA(Z,this.config)}}class BA extends y{static[O]="PgCidr";getSQLType(){return"cidr"}}function LA(Z){return new NA(Z??"")}class _A extends l{static[O]="PgCustomColumnBuilder";constructor(Z,$,Y){super(Z,"custom","PgCustomColumn");this.config.fieldConfig=$,this.config.customTypeParams=Y}build(Z){return new KA(Z,this.config)}}class KA extends y{static[O]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(Z,$){super(Z,$);this.sqlName=$.customTypeParams.dataType($.fieldConfig),this.mapTo=$.customTypeParams.toDriver,this.mapFrom=$.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(Z){return typeof this.mapFrom==="function"?this.mapFrom(Z):Z}mapToDriverValue(Z){return typeof this.mapTo==="function"?this.mapTo(Z):Z}}function RA(Z){return($,Y)=>{let{name:X,config:W}=N1($,Y);return new _A(X,W,Z)}}class s6 extends l{static[O]="PgDateColumnBaseBuilder";defaultNow(){return this.default(F`now()`)}}class VA extends s6{static[O]="PgDateBuilder";constructor(Z){super(Z,"date","PgDate")}build(Z){return new _X(Z,this.config)}}class _X extends y{static[O]="PgDate";getSQLType(){return"date"}mapFromDriverValue(Z){return new Date(Z)}mapToDriverValue(Z){return Z.toISOString()}}class EA extends s6{static[O]="PgDateStringBuilder";constructor(Z){super(Z,"string","PgDateString")}build(Z){return new KX(Z,this.config)}}class KX extends y{static[O]="PgDateString";getSQLType(){return"date"}}function jA(Z,$){let{name:Y,config:X}=N1(Z,$);if(X?.mode==="date")return new VA(Y);return new EA(Y)}class CA extends l{static[O]="PgDoublePrecisionBuilder";constructor(Z){super(Z,"number","PgDoublePrecision")}build(Z){return new IA(Z,this.config)}}class IA extends y{static[O]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(Z){if(typeof Z==="string")return Number.parseFloat(Z);return Z}}function PA(Z){return new CA(Z??"")}class xA extends l{static[O]="PgInetBuilder";constructor(Z){super(Z,"string","PgInet")}build(Z){return new TA(Z,this.config)}}class TA extends y{static[O]="PgInet";getSQLType(){return"inet"}}function kA(Z){return new xA(Z??"")}class bA extends CZ{static[O]="PgIntegerBuilder";constructor(Z){super(Z,"number","PgInteger")}build(Z){return new fA(Z,this.config)}}class fA extends y{static[O]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(Z){if(typeof Z==="string")return Number.parseInt(Z);return Z}}function gA(Z){return new bA(Z??"")}class yA extends l{static[O]="PgIntervalBuilder";constructor(Z,$){super(Z,"string","PgInterval");this.config.intervalConfig=$}build(Z){return new vA(Z,this.config)}}class vA extends y{static[O]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let Z=this.fields?` ${this.fields}`:"",$=this.precision?`(${this.precision})`:"";return`interval${Z}${$}`}}function hA(Z,$={}){let{name:Y,config:X}=N1(Z,$);return new yA(Y,X)}class dA extends l{static[O]="PgJsonBuilder";constructor(Z){super(Z,"json","PgJson")}build(Z){return new RX(Z,this.config)}}class RX extends y{static[O]="PgJson";constructor(Z,$){super(Z,$)}getSQLType(){return"json"}mapToDriverValue(Z){return JSON.stringify(Z)}mapFromDriverValue(Z){if(typeof Z==="string")try{return JSON.parse(Z)}catch{return Z}return Z}}function pA(Z){return new dA(Z??"")}class mA extends l{static[O]="PgJsonbBuilder";constructor(Z){super(Z,"json","PgJsonb")}build(Z){return new VX(Z,this.config)}}class VX extends y{static[O]="PgJsonb";constructor(Z,$){super(Z,$)}getSQLType(){return"jsonb"}mapToDriverValue(Z){return JSON.stringify(Z)}mapFromDriverValue(Z){if(typeof Z==="string")try{return JSON.parse(Z)}catch{return Z}return Z}}function r6(Z){return new mA(Z??"")}class cA extends l{static[O]="PgLineBuilder";constructor(Z){super(Z,"array","PgLine")}build(Z){return new uA(Z,this.config)}}class uA extends y{static[O]="PgLine";getSQLType(){return"line"}mapFromDriverValue(Z){let[$,Y,X]=Z.slice(1,-1).split(",");return[Number.parseFloat($),Number.parseFloat(Y),Number.parseFloat(X)]}mapToDriverValue(Z){return`{${Z[0]},${Z[1]},${Z[2]}}`}}class iA extends l{static[O]="PgLineABCBuilder";constructor(Z){super(Z,"json","PgLineABC")}build(Z){return new lA(Z,this.config)}}class lA extends y{static[O]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(Z){let[$,Y,X]=Z.slice(1,-1).split(",");return{a:Number.parseFloat($),b:Number.parseFloat(Y),c:Number.parseFloat(X)}}mapToDriverValue(Z){return`{${Z.a},${Z.b},${Z.c}}`}}function nA(Z,$){let{name:Y,config:X}=N1(Z,$);if(!X?.mode||X.mode==="tuple")return new cA(Y);return new iA(Y)}class oA extends l{static[O]="PgMacaddrBuilder";constructor(Z){super(Z,"string","PgMacaddr")}build(Z){return new tA(Z,this.config)}}class tA extends y{static[O]="PgMacaddr";getSQLType(){return"macaddr"}}function sA(Z){return new oA(Z??"")}class rA extends l{static[O]="PgMacaddr8Builder";constructor(Z){super(Z,"string","PgMacaddr8")}build(Z){return new aA(Z,this.config)}}class aA extends y{static[O]="PgMacaddr8";getSQLType(){return"macaddr8"}}function eA(Z){return new rA(Z??"")}class ZO extends l{static[O]="PgNumericBuilder";constructor(Z,$,Y){super(Z,"string","PgNumeric");this.config.precision=$,this.config.scale=Y}build(Z){return new EX(Z,this.config)}}class EX extends y{static[O]="PgNumeric";precision;scale;constructor(Z,$){super(Z,$);this.precision=$.precision,this.scale=$.scale}mapFromDriverValue(Z){if(typeof Z==="string")return Z;return String(Z)}getSQLType(){if(this.precision!==void 0&&this.scale!==void 0)return`numeric(${this.precision}, ${this.scale})`;else if(this.precision===void 0)return"numeric";else return`numeric(${this.precision})`}}class $O extends l{static[O]="PgNumericNumberBuilder";constructor(Z,$,Y){super(Z,"number","PgNumericNumber");this.config.precision=$,this.config.scale=Y}build(Z){return new YO(Z,this.config)}}class YO extends y{static[O]="PgNumericNumber";precision;scale;constructor(Z,$){super(Z,$);this.precision=$.precision,this.scale=$.scale}mapFromDriverValue(Z){if(typeof Z==="number")return Z;return Number(Z)}mapToDriverValue=String;getSQLType(){if(this.precision!==void 0&&this.scale!==void 0)return`numeric(${this.precision}, ${this.scale})`;else if(this.precision===void 0)return"numeric";else return`numeric(${this.precision})`}}class XO extends l{static[O]="PgNumericBigIntBuilder";constructor(Z,$,Y){super(Z,"bigint","PgNumericBigInt");this.config.precision=$,this.config.scale=Y}build(Z){return new WO(Z,this.config)}}class WO extends y{static[O]="PgNumericBigInt";precision;scale;constructor(Z,$){super(Z,$);this.precision=$.precision,this.scale=$.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){if(this.precision!==void 0&&this.scale!==void 0)return`numeric(${this.precision}, ${this.scale})`;else if(this.precision===void 0)return"numeric";else return`numeric(${this.precision})`}}function JO(Z,$){let{name:Y,config:X}=N1(Z,$),W=X?.mode;return W==="number"?new $O(Y,X?.precision,X?.scale):W==="bigint"?new XO(Y,X?.precision,X?.scale):new ZO(Y,X?.precision,X?.scale)}class zO extends l{static[O]="PgPointTupleBuilder";constructor(Z){super(Z,"array","PgPointTuple")}build(Z){return new QO(Z,this.config)}}class QO extends y{static[O]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(Z){if(typeof Z==="string"){let[$,Y]=Z.slice(1,-1).split(",");return[Number.parseFloat($),Number.parseFloat(Y)]}return[Z.x,Z.y]}mapToDriverValue(Z){return`(${Z[0]},${Z[1]})`}}class GO extends l{static[O]="PgPointObjectBuilder";constructor(Z){super(Z,"json","PgPointObject")}build(Z){return new UO(Z,this.config)}}class UO extends y{static[O]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(Z){if(typeof Z==="string"){let[$,Y]=Z.slice(1,-1).split(",");return{x:Number.parseFloat($),y:Number.parseFloat(Y)}}return Z}mapToDriverValue(Z){return`(${Z.x},${Z.y})`}}function HO(Z,$){let{name:Y,config:X}=N1(Z,$);if(!X?.mode||X.mode==="tuple")return new zO(Y);return new GO(Y)}function ev(Z){let $=[];for(let Y=0;Y<Z.length;Y+=2)$.push(Number.parseInt(Z.slice(Y,Y+2),16));return new Uint8Array($)}function MO(Z,$){let Y=new ArrayBuffer(8),X=new DataView(Y);for(let W=0;W<8;W++)X.setUint8(W,Z[$+W]);return X.getFloat64(0,!0)}function xW(Z){let $=ev(Z),Y=0,X=$[Y];Y+=1;let W=new DataView($.buffer),J=W.getUint32(Y,X===1);Y+=4;let z;if(J&536870912)z=W.getUint32(Y,X===1),Y+=4;if((J&65535)===1){let Q=MO($,Y);Y+=8;let U=MO($,Y);return Y+=8,[Q,U]}throw new Error("Unsupported geometry type")}class wO extends l{static[O]="PgGeometryBuilder";constructor(Z){super(Z,"array","PgGeometry")}build(Z){return new DO(Z,this.config)}}class DO extends y{static[O]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(Z){return xW(Z)}mapToDriverValue(Z){return`point(${Z[0]} ${Z[1]})`}}class qO extends l{static[O]="PgGeometryObjectBuilder";constructor(Z){super(Z,"json","PgGeometryObject")}build(Z){return new AO(Z,this.config)}}class AO extends y{static[O]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(Z){let $=xW(Z);return{x:$[0],y:$[1]}}mapToDriverValue(Z){return`point(${Z.x} ${Z.y})`}}function OO(Z,$){let{name:Y,config:X}=N1(Z,$);if(!X?.mode||X.mode==="tuple")return new wO(Y);return new qO(Y)}class FO extends l{static[O]="PgRealBuilder";constructor(Z,$){super(Z,"number","PgReal");this.config.length=$}build(Z){return new SO(Z,this.config)}}class SO extends y{static[O]="PgReal";constructor(Z,$){super(Z,$)}getSQLType(){return"real"}mapFromDriverValue=(Z)=>{if(typeof Z==="string")return Number.parseFloat(Z);return Z}}function NO(Z){return new FO(Z??"")}class BO extends l{static[O]="PgSerialBuilder";constructor(Z){super(Z,"number","PgSerial");this.config.hasDefault=!0,this.config.notNull=!0}build(Z){return new LO(Z,this.config)}}class LO extends y{static[O]="PgSerial";getSQLType(){return"serial"}}function _O(Z){return new BO(Z??"")}class KO extends CZ{static[O]="PgSmallIntBuilder";constructor(Z){super(Z,"number","PgSmallInt")}build(Z){return new RO(Z,this.config)}}class RO extends y{static[O]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=(Z)=>{if(typeof Z==="string")return Number(Z);return Z}}function VO(Z){return new KO(Z??"")}class EO extends l{static[O]="PgSmallSerialBuilder";constructor(Z){super(Z,"number","PgSmallSerial");this.config.hasDefault=!0,this.config.notNull=!0}build(Z){return new jO(Z,this.config)}}class jO extends y{static[O]="PgSmallSerial";getSQLType(){return"smallserial"}}function CO(Z){return new EO(Z??"")}class IO extends l{static[O]="PgTextBuilder";constructor(Z,$){super(Z,"string","PgText");this.config.enumValues=$.enum}build(Z){return new PO(Z,this.config)}}class PO extends y{static[O]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function xO(Z,$={}){let{name:Y,config:X}=N1(Z,$);return new IO(Y,X)}class TO extends s6{constructor(Z,$,Y){super(Z,"string","PgTime");this.withTimezone=$,this.precision=Y,this.config.withTimezone=$,this.config.precision=Y}static[O]="PgTimeBuilder";build(Z){return new jX(Z,this.config)}}class jX extends y{static[O]="PgTime";withTimezone;precision;constructor(Z,$){super(Z,$);this.withTimezone=$.withTimezone,this.precision=$.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function kO(Z,$={}){let{name:Y,config:X}=N1(Z,$);return new TO(Y,X.withTimezone??!1,X.precision)}class bO extends s6{static[O]="PgTimestampBuilder";constructor(Z,$,Y){super(Z,"date","PgTimestamp");this.config.withTimezone=$,this.config.precision=Y}build(Z){return new CX(Z,this.config)}}class CX extends y{static[O]="PgTimestamp";withTimezone;precision;constructor(Z,$){super(Z,$);this.withTimezone=$.withTimezone,this.precision=$.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=(Z)=>{return new Date(this.withTimezone?Z:Z+"+0000")};mapToDriverValue=(Z)=>{return Z.toISOString()}}class fO extends s6{static[O]="PgTimestampStringBuilder";constructor(Z,$,Y){super(Z,"string","PgTimestampString");this.config.withTimezone=$,this.config.precision=Y}build(Z){return new IX(Z,this.config)}}class IX extends y{static[O]="PgTimestampString";withTimezone;precision;constructor(Z,$){super(Z,$);this.withTimezone=$.withTimezone,this.precision=$.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function gO(Z,$={}){let{name:Y,config:X}=N1(Z,$);if(X?.mode==="string")return new fO(Y,X.withTimezone??!1,X.precision);return new bO(Y,X?.withTimezone??!1,X?.precision)}class yO extends l{static[O]="PgUUIDBuilder";constructor(Z){super(Z,"string","PgUUID")}defaultRandom(){return this.default(F`gen_random_uuid()`)}build(Z){return new PX(Z,this.config)}}class PX extends y{static[O]="PgUUID";getSQLType(){return"uuid"}}function G8(Z){return new yO(Z??"")}class vO extends l{static[O]="PgVarcharBuilder";constructor(Z,$){super(Z,"string","PgVarchar");this.config.length=$.length,this.config.enumValues=$.enum}build(Z){return new hO(Z,this.config)}}class hO extends y{static[O]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function q6(Z,$={}){let{name:Y,config:X}=N1(Z,$);return new vO(Y,X)}class dO extends l{static[O]="PgBinaryVectorBuilder";constructor(Z,$){super(Z,"string","PgBinaryVector");this.config.dimensions=$.dimensions}build(Z){return new pO(Z,this.config)}}class pO extends y{static[O]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function mO(Z,$){let{name:Y,config:X}=N1(Z,$);return new dO(Y,X)}class cO extends l{static[O]="PgHalfVectorBuilder";constructor(Z,$){super(Z,"array","PgHalfVector");this.config.dimensions=$.dimensions}build(Z){return new uO(Z,this.config)}}class uO extends y{static[O]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(Z){return JSON.stringify(Z)}mapFromDriverValue(Z){return Z.slice(1,-1).split(",").map(($)=>Number.parseFloat($))}}function iO(Z,$){let{name:Y,config:X}=N1(Z,$);return new cO(Y,X)}class lO extends l{static[O]="PgSparseVectorBuilder";constructor(Z,$){super(Z,"string","PgSparseVector");this.config.dimensions=$.dimensions}build(Z){return new nO(Z,this.config)}}class nO extends y{static[O]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function oO(Z,$){let{name:Y,config:X}=N1(Z,$);return new lO(Y,X)}class tO extends l{static[O]="PgVectorBuilder";constructor(Z,$){super(Z,"array","PgVector");this.config.dimensions=$.dimensions}build(Z){return new sO(Z,this.config)}}class sO extends y{static[O]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(Z){return JSON.stringify(Z)}mapFromDriverValue(Z){return Z.slice(1,-1).split(",").map(($)=>Number.parseFloat($))}}function rO(Z,$){let{name:Y,config:X}=N1(Z,$);return new tO(Y,X)}function aO(){return{bigint:GA,bigserial:DA,boolean:t6,char:SA,cidr:LA,customType:RA,date:jA,doublePrecision:PA,inet:kA,integer:gA,interval:hA,json:pA,jsonb:r6,line:nA,macaddr:sA,macaddr8:eA,numeric:JO,point:HO,geometry:OO,real:NO,serial:_O,smallint:VO,smallserial:CO,text:xO,time:kO,timestamp:gO,uuid:G8,varchar:q6,bit:mO,halfvec:iO,sparsevec:oO,vector:rO}}var TW=Symbol.for("drizzle:PgInlineForeignKeys"),eO=Symbol.for("drizzle:EnableRLS");class j0 extends p{static[O]="PgTable";static Symbol=Object.assign({},p.Symbol,{InlineForeignKeys:TW,EnableRLS:eO});[TW]=[];[eO]=!1;[p.Symbol.ExtraConfigBuilder]=void 0;[p.Symbol.ExtraConfigColumns]={}}function Zh(Z,$,Y,X,W=Z){let J=new j0(Z,X,W),z=typeof $==="function"?$(aO()):$,Q=Object.fromEntries(Object.entries(z).map(([H,M])=>{let q=M;q.setName(H);let w=q.build(J);return J[TW].push(...q.buildForeignKeys(w,J)),[H,w]})),U=Object.fromEntries(Object.entries(z).map(([H,M])=>{let q=M;q.setName(H);let w=q.buildExtraConfigColumn(J);return[H,w]})),G=Object.assign(J,Q);if(G[p.Symbol.Columns]=Q,G[p.Symbol.ExtraConfigColumns]=U,Y)G[j0.Symbol.ExtraConfigBuilder]=Y;return Object.assign(G,{enableRLS:()=>{return G[j0.Symbol.EnableRLS]=!0,G}})}var W$=(Z,$,Y)=>{return Zh(Z,$,Y,void 0)};class kW{static[O]="PgPrimaryKeyBuilder";columns;name;constructor(Z,$){this.columns=Z,this.name=$}build(Z){return new ZF(Z,this.columns,this.name)}}class ZF{constructor(Z,$,Y){this.table=Z,this.columns=$,this.name=Y}static[O]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[j0.Symbol.Name]}_${this.columns.map((Z)=>Z.name).join("_")}_pk`}}function U8(Z,$){if(rq($)&&!EW(Z)&&!j(Z,K8)&&!j(Z,jZ)&&!j(Z,h1)&&!j(Z,p)&&!j(Z,Q8))return new K8(Z,$);return Z}var xX=(Z,$)=>{return F`${Z} = ${U8($,Z)}`},$F=(Z,$)=>{return F`${Z} <> ${U8($,Z)}`};function HY(...Z){let $=Z.filter((Y)=>Y!==void 0);if($.length===0)return;if($.length===1)return new n($);return new n([new A0("("),F.join($,new A0(" and ")),new A0(")")])}function YF(...Z){let $=Z.filter((Y)=>Y!==void 0);if($.length===0)return;if($.length===1)return new n($);return new n([new A0("("),F.join($,new A0(" or ")),new A0(")")])}function XF(Z){return F`not ${Z}`}var WF=(Z,$)=>{return F`${Z} > ${U8($,Z)}`},JF=(Z,$)=>{return F`${Z} >= ${U8($,Z)}`},zF=(Z,$)=>{return F`${Z} < ${U8($,Z)}`},QF=(Z,$)=>{return F`${Z} <= ${U8($,Z)}`};function GF(Z,$){if(Array.isArray($)){if($.length===0)return F`false`;return F`${Z} in ${$.map((Y)=>U8(Y,Z))}`}return F`${Z} in ${U8($,Z)}`}function UF(Z,$){if(Array.isArray($)){if($.length===0)return F`true`;return F`${Z} not in ${$.map((Y)=>U8(Y,Z))}`}return F`${Z} not in ${U8($,Z)}`}function HF(Z){return F`${Z} is null`}function MF(Z){return F`${Z} is not null`}function wF(Z){return F`exists ${Z}`}function DF(Z){return F`not exists ${Z}`}function qF(Z,$,Y){return F`${Z} between ${U8($,Z)} and ${U8(Y,Z)}`}function AF(Z,$,Y){return F`${Z} not between ${U8($,Z)} and ${U8(Y,Z)}`}function OF(Z,$){return F`${Z} like ${$}`}function FF(Z,$){return F`${Z} not like ${$}`}function SF(Z,$){return F`${Z} ilike ${$}`}function NF(Z,$){return F`${Z} not ilike ${$}`}function BF(Z){return F`${Z} asc`}function LF(Z){return F`${Z} desc`}class bW{constructor(Z,$,Y){this.sourceTable=Z,this.referencedTable=$,this.relationName=Y,this.referencedTableName=$[p.Symbol.Name]}static[O]="Relation";referencedTableName;fieldName}class fW{constructor(Z,$){this.table=Z,this.config=$}static[O]="Relations"}class IZ extends bW{constructor(Z,$,Y,X){super(Z,$,Y?.relationName);this.config=Y,this.isNullable=X}static[O]="One";withFieldName(Z){let $=new IZ(this.sourceTable,this.referencedTable,this.config,this.isNullable);return $.fieldName=Z,$}}class MY extends bW{constructor(Z,$,Y){super(Z,$,Y?.relationName);this.config=Y}static[O]="Many";withFieldName(Z){let $=new MY(this.sourceTable,this.referencedTable,this.config);return $.fieldName=Z,$}}function _F(){return{and:HY,between:qF,eq:xX,exists:wF,gt:WF,gte:JF,ilike:SF,inArray:GF,isNull:HF,isNotNull:MF,like:OF,lt:zF,lte:QF,ne:$F,not:XF,notBetween:AF,notExists:DF,notLike:FF,notIlike:NF,notInArray:UF,or:YF,sql:F}}function KF(){return{sql:F,asc:BF,desc:LF}}function RF(Z,$){if(Object.keys(Z).length===1&&"default"in Z&&!j(Z.default,p))Z=Z.default;let Y={},X={},W={};for(let[J,z]of Object.entries(Z))if(j(z,p)){let Q=X$(z),U=X[Q];Y[Q]=J,W[J]={tsName:J,dbName:z[p.Symbol.Name],schema:z[p.Symbol.Schema],columns:z[p.Symbol.Columns],relations:U?.relations??{},primaryKey:U?.primaryKey??[]};for(let H of Object.values(z[p.Symbol.Columns]))if(H.primary)W[J].primaryKey.push(H);let G=z[p.Symbol.ExtraConfigBuilder]?.(z[p.Symbol.ExtraConfigColumns]);if(G){for(let H of Object.values(G))if(j(H,kW))W[J].primaryKey.push(...H.columns)}}else if(j(z,fW)){let Q=X$(z.table),U=Y[Q],G=z.config($(z.table)),H;for(let[M,q]of Object.entries(G))if(U){let w=W[U];if(w.relations[M]=q,H)w.primaryKey.push(...H)}else{if(!(Q in X))X[Q]={relations:{},primaryKey:H};X[Q].relations[M]=q}}return{tables:W,tableNamesMap:Y}}function J$(Z,$){return new fW(Z,(Y)=>Object.fromEntries(Object.entries($(Y)).map(([X,W])=>[X,W.withFieldName(X)])))}function $h(Z){return function $(Y,X){return new IZ(Z,Y,X,X?.fields.reduce((W,J)=>W&&J.notNull,!0)??!1)}}function Yh(Z){return function $(Y,X){return new MY(Z,Y,X)}}function VF(Z,$,Y){if(j(Y,IZ)&&Y.config)return{fields:Y.config.fields,references:Y.config.references};let X=$[X$(Y.referencedTable)];if(!X)throw new Error(`Table "${Y.referencedTable[p.Symbol.Name]}" not found in schema`);let W=Z[X];if(!W)throw new Error(`Table "${X}" not found in schema`);let J=Y.sourceTable,z=$[X$(J)];if(!z)throw new Error(`Table "${J[p.Symbol.Name]}" not found in schema`);let Q=[];for(let U of Object.values(W.relations))if(Y.relationName&&Y!==U&&U.relationName===Y.relationName||!Y.relationName&&U.referencedTable===Y.sourceTable)Q.push(U);if(Q.length>1)throw Y.relationName?new Error(`There are multiple relations with name "${Y.relationName}" in table "${X}"`):new Error(`There are multiple relations between "${X}" and "${Y.sourceTable[p.Symbol.Name]}". Please specify relation name`);if(Q[0]&&j(Q[0],IZ)&&Q[0].config)return{fields:Q[0].config.references,references:Q[0].config.fields};throw new Error(`There is not enough information to infer relation "${z}.${Y.fieldName}"`)}function EF(Z){return{one:$h(Z),many:Yh(Z)}}function TX(Z,$,Y,X,W=(J)=>J){let J={};for(let[z,Q]of X.entries())if(Q.isJson){let U=$.relations[Q.tsKey],G=Y[z],H=typeof G==="string"?JSON.parse(G):G;J[Q.tsKey]=j(U,IZ)?H&&TX(Z,Z[Q.relationTableTsKey],H,Q.selection,W):H.map((M)=>TX(Z,Z[Q.relationTableTsKey],M,Q.selection,W))}else{let U=W(Y[z]),G=Q.field,H;if(j(G,h1))H=G;else if(j(G,n))H=G.decoder;else H=G.sql.decoder;J[Q.tsKey]=U===null?null:H.mapFromDriverValue(U)}return J}class wY extends Q8{static[O]="PgViewBase"}class z${static[O]="PgDialect";casing;constructor(Z){this.casing=new IW(Z?.casing)}async migrate(Z,$,Y){let X=typeof Y==="string"?"__drizzle_migrations":Y.migrationsTable??"__drizzle_migrations",W=typeof Y==="string"?"drizzle":Y.migrationsSchema??"drizzle",J=F`
			CREATE TABLE IF NOT EXISTS ${F.identifier(W)}.${F.identifier(X)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await $.execute(F`CREATE SCHEMA IF NOT EXISTS ${F.identifier(W)}`),await $.execute(J);let Q=(await $.all(F`select id, hash, created_at from ${F.identifier(W)}.${F.identifier(X)} order by created_at desc limit 1`))[0];await $.transaction(async(U)=>{for await(let G of Z)if(!Q||Number(Q.created_at)<G.folderMillis){for(let H of G.sql)await U.execute(F.raw(H));await U.execute(F`insert into ${F.identifier(W)}.${F.identifier(X)} ("hash", "created_at") values(${G.hash}, ${G.folderMillis})`)}})}escapeName(Z){return`"${Z}"`}escapeParam(Z){return`$${Z+1}`}escapeString(Z){return`'${Z.replace(/'/g,"''")}'`}buildWithCTE(Z){if(!Z?.length)return;let $=[F`with `];for(let[Y,X]of Z.entries())if($.push(F`${F.identifier(X._.alias)} as (${X._.sql})`),Y<Z.length-1)$.push(F`, `);return $.push(F` `),F.join($)}buildDeleteQuery({table:Z,where:$,returning:Y,withList:X}){let W=this.buildWithCTE(X),J=Y?F` returning ${this.buildSelection(Y,{isSingleTable:!0})}`:void 0,z=$?F` where ${$}`:void 0;return F`${W}delete from ${Z}${z}${J}`}buildUpdateSet(Z,$){let Y=Z[p.Symbol.Columns],X=Object.keys(Y).filter((J)=>$[J]!==void 0||Y[J]?.onUpdateFn!==void 0),W=X.length;return F.join(X.flatMap((J,z)=>{let Q=Y[J],U=$[J]??F.param(Q.onUpdateFn(),Q),G=F`${F.identifier(this.casing.getColumnCasing(Q))} = ${U}`;if(z<W-1)return[G,F.raw(", ")];return[G]}))}buildUpdateQuery({table:Z,set:$,where:Y,returning:X,withList:W,from:J,joins:z}){let Q=this.buildWithCTE(W),U=Z[j0.Symbol.Name],G=Z[j0.Symbol.Schema],H=Z[j0.Symbol.OriginalName],M=U===H?void 0:U,q=F`${G?F`${F.identifier(G)}.`:void 0}${F.identifier(H)}${M&&F` ${F.identifier(M)}`}`,w=this.buildUpdateSet(Z,$),B=J&&F.join([F.raw(" from "),this.buildFromTable(J)]),D=this.buildJoins(z),L=X?F` returning ${this.buildSelection(X,{isSingleTable:!J})}`:void 0,b=Y?F` where ${Y}`:void 0;return F`${Q}update ${q} set ${w}${B}${D}${b}${L}`}buildSelection(Z,{isSingleTable:$=!1}={}){let Y=Z.length,X=Z.flatMap(({field:W},J)=>{let z=[];if(j(W,n.Aliased)&&W.isSelectionField)z.push(F.identifier(W.fieldAlias));else if(j(W,n.Aliased)||j(W,n)){let Q=j(W,n.Aliased)?W.sql:W;if($)z.push(new n(Q.queryChunks.map((U)=>{if(j(U,y))return F.identifier(this.casing.getColumnCasing(U));return U})));else z.push(Q);if(j(W,n.Aliased))z.push(F` as ${F.identifier(W.fieldAlias)}`)}else if(j(W,h1))if($)z.push(F.identifier(this.casing.getColumnCasing(W)));else z.push(W);if(J<Y-1)z.push(F`, `);return z});return F.join(X)}buildJoins(Z){if(!Z||Z.length===0)return;let $=[];for(let[Y,X]of Z.entries()){if(Y===0)$.push(F` `);let W=X.table,J=X.lateral?F` lateral`:void 0;if(j(W,j0)){let z=W[j0.Symbol.Name],Q=W[j0.Symbol.Schema],U=W[j0.Symbol.OriginalName],G=z===U?void 0:X.alias;$.push(F`${F.raw(X.joinType)} join${J} ${Q?F`${F.identifier(Q)}.`:void 0}${F.identifier(U)}${G&&F` ${F.identifier(G)}`} on ${X.on}`)}else if(j(W,Q8)){let z=W[i1].name,Q=W[i1].schema,U=W[i1].originalName,G=z===U?void 0:X.alias;$.push(F`${F.raw(X.joinType)} join${J} ${Q?F`${F.identifier(Q)}.`:void 0}${F.identifier(U)}${G&&F` ${F.identifier(G)}`} on ${X.on}`)}else $.push(F`${F.raw(X.joinType)} join${J} ${W} on ${X.on}`);if(Y<Z.length-1)$.push(F` `)}return F.join($)}buildFromTable(Z){if(j(Z,p)&&Z[p.Symbol.IsAlias]){let $=F`${F.identifier(Z[p.Symbol.OriginalName])}`;if(Z[p.Symbol.Schema])$=F`${F.identifier(Z[p.Symbol.Schema])}.${$}`;return F`${$} ${F.identifier(Z[p.Symbol.Name])}`}return Z}buildSelectQuery({withList:Z,fields:$,fieldsFlat:Y,where:X,having:W,table:J,joins:z,orderBy:Q,groupBy:U,limit:G,offset:H,lockingClause:M,distinct:q,setOperators:w}){let B=Y??d8($);for(let q1 of B)if(j(q1.field,h1)&&z8(q1.field.table)!==(j(J,q0)?J._.alias:j(J,wY)?J[i1].name:j(J,n)?void 0:z8(J))&&!((O0)=>z?.some(({alias:p1})=>p1===(O0[p.Symbol.IsAlias]?z8(O0):O0[p.Symbol.BaseName])))(q1.field.table)){let O0=z8(q1.field.table);throw new Error(`Your "${q1.path.join("->")}" field references a column "${O0}"."${q1.field.name}", but the table "${O0}" is not part of the query! Did you forget to join it?`)}let D=!z||z.length===0,L=this.buildWithCTE(Z),b;if(q)b=q===!0?F` distinct`:F` distinct on (${F.join(q.on,F`, `)})`;let s=this.buildSelection(B,{isSingleTable:D}),t=this.buildFromTable(J),J1=this.buildJoins(z),Y1=X?F` where ${X}`:void 0,P=W?F` having ${W}`:void 0,I;if(Q&&Q.length>0)I=F` order by ${F.join(Q,F`, `)}`;let f;if(U&&U.length>0)f=F` group by ${F.join(U,F`, `)}`;let T=typeof G==="object"||typeof G==="number"&&G>=0?F` limit ${G}`:void 0,G1=H?F` offset ${H}`:void 0,H1=F.empty();if(M){let q1=F` for ${F.raw(M.strength)}`;if(M.config.of)q1.append(F` of ${F.join(Array.isArray(M.config.of)?M.config.of:[M.config.of],F`, `)}`);if(M.config.noWait)q1.append(F` no wait`);else if(M.config.skipLocked)q1.append(F` skip locked`);H1.append(q1)}let z1=F`${L}select${b} ${s} from ${t}${J1}${Y1}${f}${P}${I}${T}${G1}${H1}`;if(w.length>0)return this.buildSetOperations(z1,w);return z1}buildSetOperations(Z,$){let[Y,...X]=$;if(!Y)throw new Error("Cannot pass undefined values to any set operator");if(X.length===0)return this.buildSetOperationQuery({leftSelect:Z,setOperator:Y});return this.buildSetOperations(this.buildSetOperationQuery({leftSelect:Z,setOperator:Y}),X)}buildSetOperationQuery({leftSelect:Z,setOperator:{type:$,isAll:Y,rightSelect:X,limit:W,orderBy:J,offset:z}}){let Q=F`(${Z.getSQL()}) `,U=F`(${X.getSQL()})`,G;if(J&&J.length>0){let w=[];for(let B of J)if(j(B,y))w.push(F.identifier(B.name));else if(j(B,n)){for(let D=0;D<B.queryChunks.length;D++){let L=B.queryChunks[D];if(j(L,y))B.queryChunks[D]=F.identifier(L.name)}w.push(F`${B}`)}else w.push(F`${B}`);G=F` order by ${F.join(w,F`, `)} `}let H=typeof W==="object"||typeof W==="number"&&W>=0?F` limit ${W}`:void 0,M=F.raw(`${$} ${Y?"all ":""}`),q=z?F` offset ${z}`:void 0;return F`${Q}${M}${U}${G}${H}${q}`}buildInsertQuery({table:Z,values:$,onConflict:Y,returning:X,withList:W,select:J,overridingSystemValue_:z}){let Q=[],U=Z[p.Symbol.Columns],G=Object.entries(U).filter(([L,b])=>!b.shouldDisableInsert()),H=G.map(([,L])=>F.identifier(this.casing.getColumnCasing(L)));if(J){let L=$;if(j(L,n))Q.push(L);else Q.push(L.getSQL())}else{let L=$;Q.push(F.raw("values "));for(let[b,s]of L.entries()){let t=[];for(let[J1,Y1]of G){let P=s[J1];if(P===void 0||j(P,K8)&&P.value===void 0)if(Y1.defaultFn!==void 0){let I=Y1.defaultFn(),f=j(I,n)?I:F.param(I,Y1);t.push(f)}else if(!Y1.default&&Y1.onUpdateFn!==void 0){let I=Y1.onUpdateFn(),f=j(I,n)?I:F.param(I,Y1);t.push(f)}else t.push(F`default`);else t.push(P)}if(Q.push(t),b<L.length-1)Q.push(F`, `)}}let M=this.buildWithCTE(W),q=F.join(Q),w=X?F` returning ${this.buildSelection(X,{isSingleTable:!0})}`:void 0,B=Y?F` on conflict ${Y}`:void 0,D=z===!0?F`overriding system value `:void 0;return F`${M}insert into ${Z} ${H} ${D}${q}${B}${w}`}buildRefreshMaterializedViewQuery({view:Z,concurrently:$,withNoData:Y}){let X=$?F` concurrently`:void 0,W=Y?F` with no data`:void 0;return F`refresh materialized view${X} ${Z}${W}`}prepareTyping(Z){if(j(Z,VX)||j(Z,RX))return"json";else if(j(Z,EX))return"decimal";else if(j(Z,jX))return"time";else if(j(Z,CX)||j(Z,IX))return"timestamp";else if(j(Z,_X)||j(Z,KX))return"date";else if(j(Z,PX))return"uuid";else return"none"}sqlToQuery(Z,$){return Z.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:$})}buildRelationalQueryWithoutPK({fullSchema:Z,schema:$,tableNamesMap:Y,table:X,tableConfig:W,queryConfig:J,tableAlias:z,nestedQueryRelation:Q,joinOn:U}){let G=[],H,M,q=[],w,B=[];if(J===!0)G=Object.entries(W.columns).map(([b,s])=>({dbKey:s.name,tsKey:b,field:j6(s,z),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let L=Object.fromEntries(Object.entries(W.columns).map(([P,I])=>[P,j6(I,z)]));if(J.where){let P=typeof J.where==="function"?J.where(L,_F()):J.where;w=P&&GY(P,z)}let b=[],s=[];if(J.columns){let P=!1;for(let[I,f]of Object.entries(J.columns)){if(f===void 0)continue;if(I in W.columns){if(!P&&f===!0)P=!0;s.push(I)}}if(s.length>0)s=P?s.filter((I)=>J.columns?.[I]===!0):Object.keys(W.columns).filter((I)=>!s.includes(I))}else s=Object.keys(W.columns);for(let P of s){let I=W.columns[P];b.push({tsKey:P,value:I})}let t=[];if(J.with)t=Object.entries(J.with).filter((P)=>!!P[1]).map(([P,I])=>({tsKey:P,queryConfig:I,relation:W.relations[P]}));let J1;if(J.extras){J1=typeof J.extras==="function"?J.extras(L,{sql:F}):J.extras;for(let[P,I]of Object.entries(J1))b.push({tsKey:P,value:CW(I,z)})}for(let{tsKey:P,value:I}of b)G.push({dbKey:j(I,n.Aliased)?I.fieldAlias:W.columns[P].name,tsKey:P,field:j(I,h1)?j6(I,z):I,relationTableTsKey:void 0,isJson:!1,selection:[]});let Y1=typeof J.orderBy==="function"?J.orderBy(L,KF()):J.orderBy??[];if(!Array.isArray(Y1))Y1=[Y1];q=Y1.map((P)=>{if(j(P,h1))return j6(P,z);return GY(P,z)}),H=J.limit,M=J.offset;for(let{tsKey:P,queryConfig:I,relation:f}of t){let T=VF($,Y,f),G1=X$(f.referencedTable),H1=Y[G1],z1=`${z}_${P}`,q1=HY(...T.fields.map((A6,g0)=>xX(j6(T.references[g0],z1),j6(A6,z)))),O0=this.buildRelationalQueryWithoutPK({fullSchema:Z,schema:$,tableNamesMap:Y,table:Z[H1],tableConfig:$[H1],queryConfig:j(f,IZ)?I===!0?{limit:1}:{...I,limit:1}:I,tableAlias:z1,joinOn:q1,nestedQueryRelation:f}),p1=F`${F.identifier(z1)}.${F.identifier("data")}`.as(P);B.push({on:F`true`,table:new q0(O0.sql,{},z1),alias:z1,joinType:"left",lateral:!0}),G.push({dbKey:P,tsKey:P,field:p1,relationTableTsKey:H1,isJson:!0,selection:O0.selection})}}if(G.length===0)throw new LX({message:`No fields selected for table "${W.tsName}" ("${z}")`});let D;if(w=HY(U,w),Q){let L=F`json_build_array(${F.join(G.map(({field:t,tsKey:J1,isJson:Y1})=>Y1?F`${F.identifier(`${z}_${J1}`)}.${F.identifier("data")}`:j(t,n.Aliased)?t.sql:t),F`, `)})`;if(j(Q,MY))L=F`coalesce(json_agg(${L}${q.length>0?F` order by ${F.join(q,F`, `)}`:void 0}), '[]'::json)`;let b=[{dbKey:"data",tsKey:"data",field:L.as("data"),isJson:!0,relationTableTsKey:W.tsName,selection:G}];if(H!==void 0||M!==void 0||q.length>0)D=this.buildSelectQuery({table:SX(X,z),fields:{},fieldsFlat:[{path:[],field:F.raw("*")}],where:w,limit:H,offset:M,orderBy:q,setOperators:[]}),w=void 0,H=void 0,M=void 0,q=[];else D=SX(X,z);D=this.buildSelectQuery({table:j(D,j0)?D:new q0(D,{},z),fields:{},fieldsFlat:b.map(({field:t})=>({path:[],field:j(t,h1)?j6(t,z):t})),joins:B,where:w,limit:H,offset:M,orderBy:q,setOperators:[]})}else D=this.buildSelectQuery({table:SX(X,z),fields:{},fieldsFlat:G.map(({field:L})=>({path:[],field:j(L,h1)?j6(L,z):L})),joins:B,where:w,limit:H,offset:M,orderBy:q,setOperators:[]});return{tableTsKey:W.tsName,sql:D,selection:G}}}class gW{static[O]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class i0{static[O]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(Z){if(this.fields=Z.fields,this.session=Z.session,this.dialect=Z.dialect,Z.withList)this.withList=Z.withList;this.distinct=Z.distinct}authToken;setToken(Z){return this.authToken=Z,this}from(Z){let $=!!this.fields,Y=Z,X;if(this.fields)X=this.fields;else if(j(Y,q0))X=Object.fromEntries(Object.keys(Y._.selectedFields).map((W)=>[W,Y[W]]));else if(j(Y,wY))X=Y[i1].selectedFields;else if(j(Y,n))X={};else X=YA(Y);return new yW({table:Y,fields:X,isPartialSelect:$,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class jF extends gW{static[O]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:Z,fields:$,isPartialSelect:Y,session:X,dialect:W,withList:J,distinct:z}){super();this.config={withList:J,table:Z,fields:{...$},distinct:z,setOperators:[]},this.isPartialSelect=Y,this.session=X,this.dialect=W,this._={selectedFields:$},this.tableName=o6(Z),this.joinsNotNullableMap=typeof this.tableName==="string"?{[this.tableName]:!0}:{}}createJoin(Z){return($,Y)=>{let X=this.tableName,W=o6($);if(typeof W==="string"&&this.config.joins?.some((J)=>J.alias===W))throw new Error(`Alias "${W}" is already used in this query`);if(!this.isPartialSelect){if(Object.keys(this.joinsNotNullableMap).length===1&&typeof X==="string")this.config.fields={[X]:this.config.fields};if(typeof W==="string"&&!j($,n)){let J=j($,q0)?$._.selectedFields:j($,Q8)?$[i1].selectedFields:$[p.Symbol.Columns];this.config.fields[W]=J}}if(typeof Y==="function")Y=Y(new Proxy(this.config.fields,new J0({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})));if(!this.config.joins)this.config.joins=[];if(this.config.joins.push({on:Y,table:$,joinType:Z,alias:W}),typeof W==="string")switch(Z){case"left":{this.joinsNotNullableMap[W]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([J])=>[J,!1])),this.joinsNotNullableMap[W]=!0;break}case"inner":{this.joinsNotNullableMap[W]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([J])=>[J,!1])),this.joinsNotNullableMap[W]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(Z,$){return(Y)=>{let X=typeof Y==="function"?Y(Xh()):Y;if(!UY(this.getSelectedFields(),X.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:Z,isAll:$,rightSelect:X}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(Z){return this.config.setOperators.push(...Z),this}where(Z){if(typeof Z==="function")Z=Z(new Proxy(this.config.fields,new J0({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})));return this.config.where=Z,this}having(Z){if(typeof Z==="function")Z=Z(new Proxy(this.config.fields,new J0({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})));return this.config.having=Z,this}groupBy(...Z){if(typeof Z[0]==="function"){let $=Z[0](new Proxy(this.config.fields,new J0({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray($)?$:[$]}else this.config.groupBy=Z;return this}orderBy(...Z){if(typeof Z[0]==="function"){let $=Z[0](new Proxy(this.config.fields,new J0({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),Y=Array.isArray($)?$:[$];if(this.config.setOperators.length>0)this.config.setOperators.at(-1).orderBy=Y;else this.config.orderBy=Y}else{let $=Z;if(this.config.setOperators.length>0)this.config.setOperators.at(-1).orderBy=$;else this.config.orderBy=$}return this}limit(Z){if(this.config.setOperators.length>0)this.config.setOperators.at(-1).limit=Z;else this.config.limit=Z;return this}offset(Z){if(this.config.setOperators.length>0)this.config.setOperators.at(-1).offset=Z;else this.config.offset=Z;return this}for(Z,$={}){return this.config.lockingClause={strength:Z,config:$},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:Z,...$}=this.dialect.sqlToQuery(this.getSQL());return $}as(Z){return new Proxy(new q0(this.getSQL(),this.config.fields,Z),new J0({alias:Z,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new J0({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class yW extends jF{static[O]="PgSelect";_prepare(Z){let{session:$,config:Y,dialect:X,joinsNotNullableMap:W,authToken:J}=this;if(!$)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return d1.startActiveSpan("drizzle.prepareQuery",()=>{let z=d8(Y.fields),Q=$.prepareQuery(X.sqlToQuery(this.getSQL()),z,Z,!0);return Q.joinsNotNullableMap=W,Q.setToken(J)})}prepare(Z){return this._prepare(Z)}authToken;setToken(Z){return this.authToken=Z,this}execute=(Z)=>{return d1.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(Z,this.authToken)})}}$A(yW,[u0]);function W4(Z,$){return(Y,X,...W)=>{let J=[X,...W].map((z)=>({type:Z,isAll:$,rightSelect:z}));for(let z of J)if(!UY(Y.getSelectedFields(),z.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return Y.addSetOperators(J)}}var Xh=()=>({union:Wh,unionAll:Jh,intersect:zh,intersectAll:Qh,except:Gh,exceptAll:Uh}),Wh=W4("union",!1),Jh=W4("union",!0),zh=W4("intersect",!1),Qh=W4("intersect",!0),Gh=W4("except",!1),Uh=W4("except",!0);class DY{static[O]="PgQueryBuilder";dialect;dialectConfig;constructor(Z){this.dialect=j(Z,z$)?Z:void 0,this.dialectConfig=j(Z,z$)?void 0:Z}$with=(Z,$)=>{let Y=this;return{as:(W)=>{if(typeof W==="function")W=W(Y);return new Proxy(new JY(W.getSQL(),$??("getSelectedFields"in W?W.getSelectedFields()??{}:{}),Z,!0),new J0({alias:Z,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}};with(...Z){let $=this;function Y(J){return new i0({fields:J??void 0,session:void 0,dialect:$.getDialect(),withList:Z})}function X(J){return new i0({fields:J??void 0,session:void 0,dialect:$.getDialect(),distinct:!0})}function W(J,z){return new i0({fields:z??void 0,session:void 0,dialect:$.getDialect(),distinct:{on:J}})}return{select:Y,selectDistinct:X,selectDistinctOn:W}}select(Z){return new i0({fields:Z??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(Z){return new i0({fields:Z??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(Z,$){return new i0({fields:$??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:Z}})}getDialect(){if(!this.dialect)this.dialect=new z$(this.dialectConfig);return this.dialect}}class kX{constructor(Z,$,Y,X,W){this.table=Z,this.session=$,this.dialect=Y,this.withList=X,this.overridingSystemValue_=W}static[O]="PgInsertBuilder";authToken;setToken(Z){return this.authToken=Z,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(Z){if(Z=Array.isArray(Z)?Z:[Z],Z.length===0)throw new Error("values() must be called with at least one value");let $=Z.map((Y)=>{let X={},W=this.table[p.Symbol.Columns];for(let J of Object.keys(Y)){let z=Y[J];X[J]=j(z,n)?z:new K8(z,W[J])}return X});return new vW(this.table,$,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(Z){let $=typeof Z==="function"?Z(new DY):Z;if(!j($,n)&&!UY(this.table[OX],$._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new vW(this.table,$,this.session,this.dialect,this.withList,!0)}}class vW extends u0{constructor(Z,$,Y,X,W,J,z){super();this.session=Y,this.dialect=X,this.config={table:Z,values:$,withList:W,select:J,overridingSystemValue_:z}}static[O]="PgInsert";config;returning(Z=this.config.table[p.Symbol.Columns]){return this.config.returningFields=Z,this.config.returning=d8(Z),this}onConflictDoNothing(Z={}){if(Z.target===void 0)this.config.onConflict=F`do nothing`;else{let $="";$=Array.isArray(Z.target)?Z.target.map((X)=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(X))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(Z.target));let Y=Z.where?F` where ${Z.where}`:void 0;this.config.onConflict=F`(${F.raw($)})${Y} do nothing`}return this}onConflictDoUpdate(Z){if(Z.where&&(Z.targetWhere||Z.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let $=Z.where?F` where ${Z.where}`:void 0,Y=Z.targetWhere?F` where ${Z.targetWhere}`:void 0,X=Z.setWhere?F` where ${Z.setWhere}`:void 0,W=this.dialect.buildUpdateSet(this.config.table,NX(this.config.table,Z.set)),J="";return J=Array.isArray(Z.target)?Z.target.map((z)=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(z))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(Z.target)),this.config.onConflict=F`(${F.raw(J)})${Y} do update set ${W}${$}${X}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:Z,...$}=this.dialect.sqlToQuery(this.getSQL());return $}_prepare(Z){return d1.startActiveSpan("drizzle.prepareQuery",()=>{return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,Z,!0)})}prepare(Z){return this._prepare(Z)}authToken;setToken(Z){return this.authToken=Z,this}execute=(Z)=>{return d1.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(Z,this.authToken)})};getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new J0({alias:z8(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class hW extends u0{constructor(Z,$,Y){super();this.session=$,this.dialect=Y,this.config={view:Z}}static[O]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:Z,...$}=this.dialect.sqlToQuery(this.getSQL());return $}_prepare(Z){return d1.startActiveSpan("drizzle.prepareQuery",()=>{return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,Z,!0)})}prepare(Z){return this._prepare(Z)}authToken;setToken(Z){return this.authToken=Z,this}execute=(Z)=>{return d1.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(Z,this.authToken)})}}class bX{constructor(Z,$,Y,X){this.table=Z,this.session=$,this.dialect=Y,this.withList=X}static[O]="PgUpdateBuilder";authToken;setToken(Z){return this.authToken=Z,this}set(Z){return new CF(this.table,NX(this.table,Z),this.session,this.dialect,this.withList).setToken(this.authToken)}}class CF extends u0{constructor(Z,$,Y,X,W){super();this.session=Y,this.dialect=X,this.config={set:$,table:Z,withList:W,joins:[]},this.tableName=o6(Z),this.joinsNotNullableMap=typeof this.tableName==="string"?{[this.tableName]:!0}:{}}static[O]="PgUpdate";config;tableName;joinsNotNullableMap;from(Z){let $=Z,Y=o6($);if(typeof Y==="string")this.joinsNotNullableMap[Y]=!0;return this.config.from=$,this}getTableLikeFields(Z){if(j(Z,j0))return Z[p.Symbol.Columns];else if(j(Z,q0))return Z._.selectedFields;return Z[i1].selectedFields}createJoin(Z){return($,Y)=>{let X=o6($);if(typeof X==="string"&&this.config.joins.some((W)=>W.alias===X))throw new Error(`Alias "${X}" is already used in this query`);if(typeof Y==="function"){let W=this.config.from&&!j(this.config.from,n)?this.getTableLikeFields(this.config.from):void 0;Y=Y(new Proxy(this.config.table[p.Symbol.Columns],new J0({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),W&&new Proxy(W,new J0({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:Y,table:$,joinType:Z,alias:X}),typeof X==="string")switch(Z){case"left":{this.joinsNotNullableMap[X]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([W])=>[W,!1])),this.joinsNotNullableMap[X]=!0;break}case"inner":{this.joinsNotNullableMap[X]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([W])=>[W,!1])),this.joinsNotNullableMap[X]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(Z){return this.config.where=Z,this}returning(Z){if(!Z){if(Z=Object.assign({},this.config.table[p.Symbol.Columns]),this.config.from){let $=o6(this.config.from);if(typeof $==="string"&&this.config.from&&!j(this.config.from,n)){let Y=this.getTableLikeFields(this.config.from);Z[$]=Y}for(let Y of this.config.joins){let X=o6(Y.table);if(typeof X==="string"&&!j(Y.table,n)){let W=this.getTableLikeFields(Y.table);Z[X]=W}}}}return this.config.returningFields=Z,this.config.returning=d8(Z),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:Z,...$}=this.dialect.sqlToQuery(this.getSQL());return $}_prepare(Z){let $=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,Z,!0);return $.joinsNotNullableMap=this.joinsNotNullableMap,$}prepare(Z){return this._prepare(Z)}authToken;setToken(Z){return this.authToken=Z,this}execute=(Z)=>{return this._prepare().execute(Z,this.authToken)};getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new J0({alias:z8(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class qY extends n{constructor(Z){super(qY.buildEmbeddedCount(Z.source,Z.filters).queryChunks);this.params=Z,this.mapWith(Number),this.session=Z.session,this.sql=qY.buildCount(Z.source,Z.filters)}sql;token;static[O]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(Z,$){return F`(select count(*) from ${Z}${F.raw(" where ").if($)}${$})`}static buildCount(Z,$){return F`select count(*) as count from ${Z}${F.raw(" where ").if($)}${$};`}setToken(Z){return this.token=Z,this}then(Z,$){return Promise.resolve(this.session.count(this.sql,this.token)).then(Z,$)}catch(Z){return this.then(void 0,Z)}finally(Z){return this.then(($)=>{return Z?.(),$},($)=>{throw Z?.(),$})}}class pW{constructor(Z,$,Y,X,W,J,z){this.fullSchema=Z,this.schema=$,this.tableNamesMap=Y,this.table=X,this.tableConfig=W,this.dialect=J,this.session=z}static[O]="PgRelationalQueryBuilder";findMany(Z){return new dW(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,Z?Z:{},"many")}findFirst(Z){return new dW(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,Z?{...Z,limit:1}:{limit:1},"first")}}class dW extends u0{constructor(Z,$,Y,X,W,J,z,Q,U){super();this.fullSchema=Z,this.schema=$,this.tableNamesMap=Y,this.table=X,this.tableConfig=W,this.dialect=J,this.session=z,this.config=Q,this.mode=U}static[O]="PgRelationalQuery";_prepare(Z){return d1.startActiveSpan("drizzle.prepareQuery",()=>{let{query:$,builtQuery:Y}=this._toSQL();return this.session.prepareQuery(Y,void 0,Z,!0,(X,W)=>{let J=X.map((z)=>TX(this.schema,this.tableConfig,z,$.selection,W));if(this.mode==="first")return J[0];return J})})}prepare(Z){return this._prepare(Z)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let Z=this._getQuery(),$=this.dialect.sqlToQuery(Z.sql);return{query:Z,builtQuery:$}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(Z){return this.authToken=Z,this}execute(){return d1.startActiveSpan("drizzle.operation",()=>{return this._prepare().execute(void 0,this.authToken)})}}class mW extends u0{constructor(Z,$,Y,X){super();this.execute=Z,this.sql=$,this.query=Y,this.mapBatchResult=X}static[O]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(Z,$){return $?this.mapBatchResult(Z):Z}_prepare(){return this}isResponseInArrayMode(){return!1}}class AY{constructor(Z,$,Y){if(this.dialect=Z,this.session=$,this._=Y?{schema:Y.schema,fullSchema:Y.fullSchema,tableNamesMap:Y.tableNamesMap,session:$}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:$},this.query={},this._.schema)for(let[X,W]of Object.entries(this._.schema))this.query[X]=new pW(Y.fullSchema,this._.schema,this._.tableNamesMap,Y.fullSchema[X],W,Z,$)}static[O]="PgDatabase";query;$with=(Z,$)=>{let Y=this;return{as:(W)=>{if(typeof W==="function")W=W(new DY(Y.dialect));return new Proxy(new JY(W.getSQL(),$??("getSelectedFields"in W?W.getSelectedFields()??{}:{}),Z,!0),new J0({alias:Z,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}};$count(Z,$){return new qY({source:Z,filters:$,session:this.session})}with(...Z){let $=this;function Y(U){return new i0({fields:U??void 0,session:$.session,dialect:$.dialect,withList:Z})}function X(U){return new i0({fields:U??void 0,session:$.session,dialect:$.dialect,withList:Z,distinct:!0})}function W(U,G){return new i0({fields:G??void 0,session:$.session,dialect:$.dialect,withList:Z,distinct:{on:U}})}function J(U){return new bX(U,$.session,$.dialect,Z)}function z(U){return new kX(U,$.session,$.dialect,Z)}function Q(U){return new BX(U,$.session,$.dialect,Z)}return{select:Y,selectDistinct:X,selectDistinctOn:W,update:J,insert:z,delete:Q}}select(Z){return new i0({fields:Z??void 0,session:this.session,dialect:this.dialect})}selectDistinct(Z){return new i0({fields:Z??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(Z,$){return new i0({fields:$??void 0,session:this.session,dialect:this.dialect,distinct:{on:Z}})}update(Z){return new bX(Z,this.session,this.dialect)}insert(Z){return new kX(Z,this.session,this.dialect)}delete(Z){return new BX(Z,this.session,this.dialect)}refreshMaterializedView(Z){return new hW(Z,this.session,this.dialect)}authToken;execute(Z){let $=typeof Z==="string"?F.raw(Z):Z.getSQL(),Y=this.dialect.sqlToQuery($),X=this.session.prepareQuery(Y,void 0,void 0,!1);return new mW(()=>X.execute(void 0,this.authToken),$,Y,(W)=>X.mapResult(W,!0))}transaction(Z,$){return this.session.transaction(Z,$)}}class cW{constructor(Z){this.query=Z}authToken;getQuery(){return this.query}mapResult(Z,$){return Z}setToken(Z){return this.authToken=Z,this}static[O]="PgPreparedQuery";joinsNotNullableMap}class uW{constructor(Z){this.dialect=Z}static[O]="PgSession";execute(Z,$){return d1.startActiveSpan("drizzle.operation",()=>{return d1.startActiveSpan("drizzle.prepareQuery",()=>{return this.prepareQuery(this.dialect.sqlToQuery(Z),void 0,void 0,!1)}).setToken($).execute(void 0,$)})}all(Z){return this.prepareQuery(this.dialect.sqlToQuery(Z),void 0,void 0,!1).all()}async count(Z,$){let Y=await this.execute(Z,$);return Number(Y[0].count)}}class iW extends AY{constructor(Z,$,Y,X=0){super(Z,$,Y);this.schema=Y,this.nestedIndex=X}static[O]="PgTransaction";rollback(){throw new PW}getTransactionConfigSQL(Z){let $=[];if(Z.isolationLevel)$.push(`isolation level ${Z.isolationLevel}`);if(Z.accessMode)$.push(Z.accessMode);if(typeof Z.deferrable==="boolean")$.push(Z.deferrable?"deferrable":"not deferrable");return F.raw($.join(" "))}setTransaction(Z){return this.session.execute(F`set transaction ${this.getTransactionConfigSQL(Z)}`)}}class IF extends cW{constructor(Z,$,Y,X,W,J,z){super({sql:$,params:Y});this.client=Z,this.queryString=$,this.params=Y,this.logger=X,this.fields=W,this._isResponseInArrayMode=J,this.customResultMapper=z}static[O]="BunSQLPreparedQuery";async execute(Z={}){return d1.startActiveSpan("drizzle.execute",async($)=>{let Y=jW(this.params,Z);$?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(Y)}),this.logger.logQuery(this.queryString,Y);let{fields:X,queryString:W,client:J,joinsNotNullableMap:z,customResultMapper:Q}=this;if(!X&&!Q)return d1.startActiveSpan("drizzle.driver.execute",()=>{return J.unsafe(W,Y)});let U=await d1.startActiveSpan("drizzle.driver.execute",()=>{return $?.setAttributes({"drizzle.query.text":W,"drizzle.query.params":JSON.stringify(Y)}),J.unsafe(W,Y).values()});return d1.startActiveSpan("drizzle.mapResponse",()=>{return Q?Q(U):U.map((G)=>ZA(X,G,z))})})}all(Z={}){return d1.startActiveSpan("drizzle.execute",async($)=>{let Y=jW(this.params,Z);return $?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(Y)}),this.logger.logQuery(this.queryString,Y),d1.startActiveSpan("drizzle.driver.execute",()=>{return $?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(Y)}),this.client.unsafe(this.queryString,Y)})})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class OY extends uW{constructor(Z,$,Y,X={}){super($);this.client=Z,this.schema=Y,this.options=X,this.logger=X.logger??new OW}static[O]="BunSQLSession";logger;prepareQuery(Z,$,Y,X,W){return new IF(this.client,Z.sql,Z.params,this.logger,$,X,W)}query(Z,$){return this.logger.logQuery(Z,$),this.client.unsafe(Z,$).values()}queryObjects(Z,$){return this.client.unsafe(Z,$)}transaction(Z,$){return this.client.begin(async(Y)=>{let X=new OY(Y,this.dialect,this.schema,this.options),W=new lW(this.dialect,X,this.schema);if($)await W.setTransaction($);return Z(W)})}}class lW extends iW{constructor(Z,$,Y,X=0){super(Z,$,Y,X);this.session=$}static[O]="BunSQLTransaction";transaction(Z){return this.session.client.savepoint(($)=>{let Y=new OY($,this.dialect,this.schema,this.session.options),X=new lW(this.dialect,Y,this.schema);return Z(X)})}}class PF extends AY{static[O]="BunSQLDatabase"}function J4(Z,$={}){let Y=new z$({casing:$.casing}),X;if($.logger===!0)X=new AW;else if($.logger!==!1)X=$.logger;let W;if($.schema){let Q=RF($.schema,EF);W={fullSchema:$.schema,schema:Q.tables,tableNamesMap:Q.tableNamesMap}}let J=new OY(Z,Y,W,{logger:X}),z=new PF(Y,J,W);return z.$client=Z,z}function fX(...Z){if(typeof Z[0]==="string"){let $=new nW(Z[0]);return J4($,Z[1])}if(XA(Z[0])){let{connection:$,client:Y,...X}=Z[0];if(Y)return J4(Y,X);if(typeof $==="object"&&$.url!==void 0){let{url:J,...z}=$,Q=new nW({url:J,...z});return J4(Q,X)}let W=new nW($);return J4(W,X)}return J4(Z[0],Z[1])}((Z)=>{function $(Y){return J4({options:{parsers:{},serializers:{}}},Y)}Z.mock=$})(fX||(fX={}));var{SQL:Fh}=globalThis.Bun;var tW={};ZZ(tW,{unitRelations:()=>wh,unit:()=>SY,periodRelations:()=>Oh,period:()=>NY,noteRelations:()=>Ah,note:()=>z4,lessonRelations:()=>qh,lesson:()=>Q$,instructorRelations:()=>Mh,instructor:()=>FY,departmentRelations:()=>Dh,department:()=>gX,Semester:()=>oW,LessonType:()=>Hh,DepartmentLanguage:()=>xF,Degree:()=>TF,AcademicRank:()=>kF});var xF=Y4("DepartmentLanguage",["TR","EN","TR_EN"]),oW=Y4("Semester",["SPRING","FALL"]),Hh=Y4("LessonType",["ELECTIVE","COMPULSORY"]),TF=Y4("Degree",["0","1","2","3","4","5","6","7","8","9","PREP"]),kF=Y4("AcademicRank",["DR","ASSISTANT_PROFESSOR","ASSOCIATE_PROFESSOR","PROFESSOR","LECTURER","RESEARCHER","OTHER"]),FY=W$("instructor",{id:G8().primaryKey().defaultRandom().notNull().unique(),email:q6().notNull(),avatar:q6().notNull(),name:q6().notNull(),surname:q6().notNull(),tag:kF().notNull()}),SY=W$("unit",{id:G8().primaryKey().defaultRandom().notNull().unique(),unitName:q6("unit_name").notNull(),isFaculty:t6("is_faculty").notNull(),isDepartment:t6("is_department").default(!1),isActive:t6("is_active").default(!0)}),gX=W$("department",{id:G8().primaryKey().defaultRandom().notNull().unique(),unitId:G8("unit_id").notNull().references(()=>SY.id),departmentName:q6("department_name").notNull(),language:xF().default("TR"),isActive:t6("is_active").default(!0)}),NY=W$("period",{id:G8().primaryKey().defaultRandom().notNull().unique(),period:r6("period").default({S:!1,YS:null,YE:null}).notNull(),semester:oW().notNull()}),Q$=W$("lesson",{id:G8().primaryKey().defaultRandom().notNull().unique(),instructorId:G8("instructor_id").notNull().references(()=>FY.id),lessonCode:q6("lesson_code").notNull(),lessonName:q6("lesson_name").notNull(),letterRange:r6("letter_range").default({AA:{end:100,start:90},BA:{end:90,start:80},BB:{end:80,start:75},CB:{end:75,start:65},CC:{end:65,start:60},DC:{end:60,start:55},DD:{end:55,start:50},FF:{end:50,start:0}}).notNull(),semester:oW().notNull(),type:r6("type").default({online:!1,rector:!1,optional:!1,compulsory:!1}).notNull(),creditSystem:r6("credit_system").default({ects:6,credit:3}).notNull(),gradeWeight:r6("grade_weight").default({visa:40,final:60}).notNull(),degree:TF().notNull()}),z4=W$("note",{id:G8().primaryKey().defaultRandom().notNull().unique(),userId:G8("user_id").notNull(),lessonId:G8("lesson_id").notNull().references(()=>Q$.id),periodId:G8("period_id").notNull().references(()=>NY.id),note:r6().default({visa:[{M:!1,O:null,P:!1,S:!1,U:null,MP:!1,PD:null,MPD:null}],final:[{M:!1,O:null,P:!1,S:!1,U:null,MP:!1,PD:null,MPD:null}],result:[{N:null,LG:null}],remedial:[{P:!1,S:null,PD:null}]}).notNull(),exempted:t6().default(!1),isConcluded:t6("is_concluded").default(!1)}),Mh=J$(FY,({many:Z})=>({lesson:Z(Q$)})),wh=J$(SY,({many:Z})=>({department:Z(gX)})),Dh=J$(gX,({one:Z})=>({unit:Z(SY,{fields:[gX.unitId],references:[SY.id]})})),qh=J$(Q$,({one:Z,many:$})=>({note:$(z4),instructor:Z(FY,{fields:[Q$.instructorId],references:[FY.id]})})),Ah=J$(z4,({one:Z})=>({lesson:Z(Q$,{fields:[z4.lessonId],references:[Q$.id]}),period:Z(NY,{fields:[z4.periodId],references:[NY.id]})})),Oh=J$(NY,({many:Z})=>({note:Z(z4)}));var Sh=new Fh(process.env.DATABASE_URL),bF=fX({client:Sh,schema:tW});var fF=async({userId:Z})=>{if(!Z)return null;try{let $=n$.lessons,Y=await Z4(Z,$.REDIS_DB_KEY,!0);if(Y)return Y;let X=await bF.query.note.findMany({where:(W,{eq:J})=>J(W.userId,String(Z)),with:{lesson:{with:{instructor:!0}},period:!0}});return await $4(Z,X,$.EXPIRATION_TIME,$.REDIS_DB_KEY,!0),X}catch($){throw console.error("Error fetching lessons:",$),new Error("Failed to fetch lessons from the database")}};var gF=["http://192.168.1.37:3000","https://misy-dev.vercel.app","https://misy.online"];var{S3Client:Nh}=globalThis.Bun;var yF=new Nh({accessKeyId:process.env.MINIO_ACCESS_KEY,secretAccessKey:process.env.MINIO_SECRET_KEY,endpoint:process.env.MINIO_END_POINT});var vF=async({userId:Z,bucketId:$})=>{if(!Z)return null;try{if(!Z||!$)return null;let Y=n$.avatar,X=await Z4(Z,Y.REDIS_DB_KEY,!1);if(X)return X;let W=yF.presign(`${$}/avatar/${Z}.png`,{expiresIn:21600,acl:"private"});if(!W)return null;return await $4(Z,W,Y.EXPIRATION_TIME,Y.REDIS_DB_KEY,!1),W}catch(Y){throw console.error("Error fetching avatar:",Y),new Error("Failed to fetch avatar from the S3 server")}};var BY=new X8;BY.use(oQ({origin:gF,allowedHeaders:"Content-Type,Authorization,Expires,Cache-Control,Pragma",methods:"GET,POST,PUT,DELETE,OPTIONS"}));BY.get("/api/lessons",async({headers:Z})=>{let $=await qW(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Y=await fF({userId:$.user?.userId});return Y.length===0?{status:"success",message:"No lessons found."}:{status:"success",userId:$.user?.userId,data:Y}});BY.get("/api/avatar",async({headers:Z})=>{let $=await qW(Z,["STUDENT","INSTRUCTOR"]);if(!$.status)return{status:"error",message:$.message};let Y=await vF({userId:$.user?.userId,bucketId:$.user?.bucketId});return Y.length===0?{status:"success",message:"No avatar found."}:{status:"success",userId:$.user?.userId,data:Y}});BY.get("/",()=>{return"hi"});BY.listen(process.env.PORT||3001);console.log("Elysia is running.");
