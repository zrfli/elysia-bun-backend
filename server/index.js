// @bun
import{a as t$,b as C,c as J4,d as U1,e as pR,f as ZI}from"./index-54dcs62y.js";var z$=C((v5,Gz)=>{/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var kY=U1("buffer"),t6=kY.Buffer;function qz($,Z){for(var Y in $)Z[Y]=$[Y]}if(t6.from&&t6.alloc&&t6.allocUnsafe&&t6.allocUnsafeSlow)Gz.exports=kY;else qz(kY,v5),v5.Buffer=P4;function P4($,Z,Y){return t6($,Z,Y)}P4.prototype=Object.create(t6.prototype);qz(t6,P4);P4.from=function($,Z,Y){if(typeof $==="number")throw new TypeError("Argument must not be a number");return t6($,Z,Y)};P4.alloc=function($,Z,Y){if(typeof $!=="number")throw new TypeError("Argument must be a number");var Q=t6($);if(Z!==void 0)if(typeof Y==="string")Q.fill(Z,Y);else Q.fill(Z);else Q.fill(0);return Q};P4.allocUnsafe=function($){if(typeof $!=="number")throw new TypeError("Argument must be a number");return t6($)};P4.allocUnsafeSlow=function($){if(typeof $!=="number")throw new TypeError("Argument must be a number");return kY.SlowBuffer($)}});var d5=C((Uo,Mz)=>{var gY=z$().Buffer,rK=U1("stream"),aK=U1("util");function fY($){if(this.buffer=null,this.writable=!0,this.readable=!0,!$)return this.buffer=gY.alloc(0),this;if(typeof $.pipe==="function")return this.buffer=gY.alloc(0),$.pipe(this),this;if($.length||typeof $==="object")return this.buffer=$,this.writable=!1,process.nextTick(function(){this.emit("end",$),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof $+")")}aK.inherits(fY,rK);fY.prototype.write=function $(Z){this.buffer=gY.concat([this.buffer,gY.from(Z)]),this.emit("data",Z)};fY.prototype.end=function $(Z){if(Z)this.write(Z);this.emit("end",Z),this.emit("close"),this.writable=!1,this.readable=!1};Mz.exports=fY});var wz=C((So,Bz)=>{var e$=U1("buffer").Buffer,h5=U1("buffer").SlowBuffer;Bz.exports=yY;function yY($,Z){if(!e$.isBuffer($)||!e$.isBuffer(Z))return!1;if($.length!==Z.length)return!1;var Y=0;for(var Q=0;Q<$.length;Q++)Y|=$[Q]^Z[Q];return Y===0}yY.install=function(){e$.prototype.equal=h5.prototype.equal=function $(Z){return yY(this,Z)}};var eK=e$.prototype.equal,$R=h5.prototype.equal;yY.restore=function(){e$.prototype.equal=eK,h5.prototype.equal=$R}});var Dz=C((qo,Hz)=>{function m5($){var Z=($/8|0)+($%8===0?0:1);return Z}var ZR={ES256:m5(256),ES384:m5(384),ES512:m5(521)};function YR($){var Z=ZR[$];if(Z)return Z;throw new Error('Unknown algorithm "'+$+'"')}Hz.exports=YR});var Kz=C((Go,Pz)=>{var vY=z$().Buffer,Nz=Dz(),dY=128,Lz=0,QR=32,WR=16,XR=2,Oz=WR|QR|Lz<<6,hY=XR|Lz<<6;function JR($){return $.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Fz($){if(vY.isBuffer($))return $;else if(typeof $==="string")return vY.from($,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function zR($,Z){$=Fz($);var Y=Nz(Z),Q=Y+1,W=$.length,X=0;if($[X++]!==Oz)throw new Error('Could not find expected "seq"');var J=$[X++];if(J===(dY|1))J=$[X++];if(W-X<J)throw new Error('"seq" specified length of "'+J+'", only "'+(W-X)+'" remaining');if($[X++]!==hY)throw new Error('Could not find expected "int" for "r"');var z=$[X++];if(W-X-2<z)throw new Error('"r" specified length of "'+z+'", only "'+(W-X-2)+'" available');if(Q<z)throw new Error('"r" specified length of "'+z+'", max of "'+Q+'" is acceptable');var U=X;if(X+=z,$[X++]!==hY)throw new Error('Could not find expected "int" for "s"');var S=$[X++];if(W-X!==S)throw new Error('"s" specified length of "'+S+'", expected "'+(W-X)+'"');if(Q<S)throw new Error('"s" specified length of "'+S+'", max of "'+Q+'" is acceptable');var q=X;if(X+=S,X!==W)throw new Error('Expected to consume entire buffer, but "'+(W-X)+'" bytes remain');var M=Y-z,H=Y-S,w=vY.allocUnsafe(M+z+H+S);for(X=0;X<M;++X)w[X]=0;$.copy(w,X,U+Math.max(-M,0),U+z),X=Y;for(var G=X;X<G+H;++X)w[X]=0;return $.copy(w,X,q+Math.max(-H,0),q+S),w=w.toString("base64"),w=JR(w),w}function Az($,Z,Y){var Q=0;while(Z+Q<Y&&$[Z+Q]===0)++Q;var W=$[Z+Q]>=dY;if(W)--Q;return Q}function UR($,Z){$=Fz($);var Y=Nz(Z),Q=$.length;if(Q!==Y*2)throw new TypeError('"'+Z+'" signatures must be "'+Y*2+'" bytes, saw "'+Q+'"');var W=Az($,0,Y),X=Az($,Y,$.length),J=Y-W,z=Y-X,U=2+J+1+1+z,S=U<dY,q=vY.allocUnsafe((S?2:3)+U),M=0;if(q[M++]=Oz,S)q[M++]=U;else q[M++]=dY|1,q[M++]=U&255;if(q[M++]=hY,q[M++]=J,W<0)q[M++]=0,M+=$.copy(q,M,0,Y);else M+=$.copy(q,M,W,Y);if(q[M++]=hY,q[M++]=z,X<0)q[M++]=0,$.copy(q,M,Y);else $.copy(q,M,Y+X);return q}Pz.exports={derToJose:zR,joseToDer:UR}});var p5=C((Mo,bz)=>{var SR=wz(),S$=z$().Buffer,s6=U1("crypto"),jz=Kz(),Rz=U1("util"),qR=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,$Z="secret must be a string or buffer",U$="key must be a string or a buffer",GR="key must be a string, a buffer or an object",u5=typeof s6.createPublicKey==="function";if(u5)U$+=" or a KeyObject",$Z+="or a KeyObject";function Cz($){if(S$.isBuffer($))return;if(typeof $==="string")return;if(!u5)throw f6(U$);if(typeof $!=="object")throw f6(U$);if(typeof $.type!=="string")throw f6(U$);if(typeof $.asymmetricKeyType!=="string")throw f6(U$);if(typeof $.export!=="function")throw f6(U$)}function _z($){if(S$.isBuffer($))return;if(typeof $==="string")return;if(typeof $==="object")return;throw f6(GR)}function MR($){if(S$.isBuffer($))return;if(typeof $==="string")return $;if(!u5)throw f6($Z);if(typeof $!=="object")throw f6($Z);if($.type!=="secret")throw f6($Z);if(typeof $.export!=="function")throw f6($Z)}function c5($){return $.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Vz($){$=$.toString();var Z=4-$.length%4;if(Z!==4)for(var Y=0;Y<Z;++Y)$+="=";return $.replace(/\-/g,"+").replace(/_/g,"/")}function f6($){var Z=[].slice.call(arguments,1),Y=Rz.format.bind(Rz,$).apply(null,Z);return new TypeError(Y)}function BR($){return S$.isBuffer($)||typeof $==="string"}function ZZ($){if(!BR($))$=JSON.stringify($);return $}function Ez($){return function Z(Y,Q){MR(Q),Y=ZZ(Y);var W=s6.createHmac("sha"+$,Q),X=(W.update(Y),W.digest("base64"));return c5(X)}}function wR($){return function Z(Y,Q,W){var X=Ez($)(Y,W);return SR(S$.from(Q),S$.from(X))}}function Iz($){return function Z(Y,Q){_z(Q),Y=ZZ(Y);var W=s6.createSign("RSA-SHA"+$),X=(W.update(Y),W.sign(Q,"base64"));return c5(X)}}function Tz($){return function Z(Y,Q,W){Cz(W),Y=ZZ(Y),Q=Vz(Q);var X=s6.createVerify("RSA-SHA"+$);return X.update(Y),X.verify(W,Q,"base64")}}function HR($){return function Z(Y,Q){_z(Q),Y=ZZ(Y);var W=s6.createSign("RSA-SHA"+$),X=(W.update(Y),W.sign({key:Q,padding:s6.constants.RSA_PKCS1_PSS_PADDING,saltLength:s6.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return c5(X)}}function DR($){return function Z(Y,Q,W){Cz(W),Y=ZZ(Y),Q=Vz(Q);var X=s6.createVerify("RSA-SHA"+$);return X.update(Y),X.verify({key:W,padding:s6.constants.RSA_PKCS1_PSS_PADDING,saltLength:s6.constants.RSA_PSS_SALTLEN_DIGEST},Q,"base64")}}function AR($){var Z=Iz($);return function Y(){var Q=Z.apply(null,arguments);return Q=jz.derToJose(Q,"ES"+$),Q}}function NR($){var Z=Tz($);return function Y(Q,W,X){W=jz.joseToDer(W,"ES"+$).toString("base64");var J=Z(Q,W,X);return J}}function LR(){return function $(){return""}}function OR(){return function $(Z,Y){return Y===""}}bz.exports=function $(Z){var Y={hs:Ez,rs:Iz,ps:HR,es:AR,none:LR},Q={hs:wR,rs:Tz,ps:DR,es:NR,none:OR},W=Z.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!W)throw f6(qR,Z);var X=(W[1]||W[3]).toLowerCase(),J=W[2];return{sign:Y[X](J),verify:Q[X](J)}}});var i5=C((Bo,xz)=>{var FR=U1("buffer").Buffer;xz.exports=function $(Z){if(typeof Z==="string")return Z;if(typeof Z==="number"||FR.isBuffer(Z))return Z.toString();return JSON.stringify(Z)}});var dz=C((wo,vz)=>{var PR=z$().Buffer,kz=d5(),KR=p5(),RR=U1("stream"),gz=i5(),l5=U1("util");function fz($,Z){return PR.from($,Z).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jR($,Z,Y){Y=Y||"utf8";var Q=fz(gz($),"binary"),W=fz(gz(Z),Y);return l5.format("%s.%s",Q,W)}function yz($){var{header:Z,payload:Y}=$,Q=$.secret||$.privateKey,W=$.encoding,X=KR(Z.alg),J=jR(Z,Y,W),z=X.sign(J,Q);return l5.format("%s.%s",J,z)}function mY($){var Z=$.secret||$.privateKey||$.key,Y=new kz(Z);this.readable=!0,this.header=$.header,this.encoding=$.encoding,this.secret=this.privateKey=this.key=Y,this.payload=new kz($.payload),this.secret.once("close",function(){if(!this.payload.writable&&this.readable)this.sign()}.bind(this)),this.payload.once("close",function(){if(!this.secret.writable&&this.readable)this.sign()}.bind(this))}l5.inherits(mY,RR);mY.prototype.sign=function $(){try{var Z=yz({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",Z),this.emit("data",Z),this.emit("end"),this.readable=!1,Z}catch(Y){this.readable=!1,this.emit("error",Y),this.emit("close")}};mY.sign=yz;vz.exports=mY});var tz=C((Ho,oz)=>{var mz=z$().Buffer,hz=d5(),CR=p5(),_R=U1("stream"),uz=i5(),VR=U1("util"),ER=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function IR($){return Object.prototype.toString.call($)==="[object Object]"}function TR($){if(IR($))return $;try{return JSON.parse($)}catch(Z){return}}function cz($){var Z=$.split(".",1)[0];return TR(mz.from(Z,"base64").toString("binary"))}function bR($){return $.split(".",2).join(".")}function pz($){return $.split(".")[2]}function xR($,Z){Z=Z||"utf8";var Y=$.split(".")[1];return mz.from(Y,"base64").toString(Z)}function iz($){return ER.test($)&&!!cz($)}function lz($,Z,Y){if(!Z){var Q=new Error("Missing algorithm parameter for jws.verify");throw Q.code="MISSING_ALGORITHM",Q}$=uz($);var W=pz($),X=bR($),J=CR(Z);return J.verify(X,W,Y)}function nz($,Z){if(Z=Z||{},$=uz($),!iz($))return null;var Y=cz($);if(!Y)return null;var Q=xR($);if(Y.typ==="JWT"||Z.json)Q=JSON.parse(Q,Z.encoding);return{header:Y,payload:Q,signature:pz($)}}function q$($){$=$||{};var Z=$.secret||$.publicKey||$.key,Y=new hz(Z);this.readable=!0,this.algorithm=$.algorithm,this.encoding=$.encoding,this.secret=this.publicKey=this.key=Y,this.signature=new hz($.signature),this.secret.once("close",function(){if(!this.signature.writable&&this.readable)this.verify()}.bind(this)),this.signature.once("close",function(){if(!this.secret.writable&&this.readable)this.verify()}.bind(this))}VR.inherits(q$,_R);q$.prototype.verify=function $(){try{var Z=lz(this.signature.buffer,this.algorithm,this.key.buffer),Y=nz(this.signature.buffer,this.encoding);return this.emit("done",Z,Y),this.emit("data",Z),this.emit("end"),this.readable=!1,Z}catch(Q){this.readable=!1,this.emit("error",Q),this.emit("close")}};q$.decode=nz;q$.isValid=iz;q$.verify=lz;oz.exports=q$});var cY=C((gR)=>{var sz=dz(),uY=tz(),kR=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];gR.ALGORITHMS=kR;gR.sign=sz.sign;gR.verify=uY.verify;gR.decode=uY.decode;gR.isValid=uY.isValid;gR.createSign=function $(Z){return new sz(Z)};gR.createVerify=function $(Z){return new uY(Z)}});var n5=C((Ao,rz)=>{var cR=cY();rz.exports=function($,Z){Z=Z||{};var Y=cR.decode($,Z);if(!Y)return null;var Q=Y.payload;if(typeof Q==="string")try{var W=JSON.parse(Q);if(W!==null&&typeof W==="object")Q=W}catch(X){}if(Z.complete===!0)return{header:Y.header,payload:Q,signature:Y.signature};return Q}});var YZ=C((No,az)=>{var pY=function($,Z){if(Error.call(this,$),Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);if(this.name="JsonWebTokenError",this.message=$,Z)this.inner=Z};pY.prototype=Object.create(Error.prototype);pY.prototype.constructor=pY;az.exports=pY});var o5=C((Lo,$2)=>{var ez=YZ(),iY=function($,Z){ez.call(this,$),this.name="NotBeforeError",this.date=Z};iY.prototype=Object.create(ez.prototype);iY.prototype.constructor=iY;$2.exports=iY});var t5=C((Oo,Y2)=>{var Z2=YZ(),lY=function($,Z){Z2.call(this,$),this.name="TokenExpiredError",this.expiredAt=Z};lY.prototype=Object.create(Z2.prototype);lY.prototype.constructor=lY;Y2.exports=lY});var s5=C((Fo,Q2)=>{var iR=pR();Q2.exports=function($,Z){var Y=Z||Math.floor(Date.now()/1000);if(typeof $==="string"){var Q=iR($);if(typeof Q==="undefined")return;return Math.floor(Y+Q/1000)}else if(typeof $==="number")return Y+$;else return}});var QZ=C((Po,W2)=>{var lR=Number.MAX_SAFE_INTEGER||9007199254740991,nR=["major","premajor","minor","preminor","patch","prepatch","prerelease"];W2.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:lR,RELEASE_TYPES:nR,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var WZ=C((Ko,X2)=>{var oR=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...$)=>console.error("SEMVER",...$):()=>{};X2.exports=oR});var G$=C((r6,J2)=>{var{MAX_SAFE_COMPONENT_LENGTH:r5,MAX_SAFE_BUILD_LENGTH:tR,MAX_LENGTH:sR}=QZ(),rR=WZ();r6=J2.exports={};var aR=r6.re=[],eR=r6.safeRe=[],d=r6.src=[],$j=r6.safeSrc=[],h=r6.t={},Zj=0,a5="[a-zA-Z0-9-]",Yj=[["\\s",1],["\\d",sR],[a5,tR]],Qj=($)=>{for(let[Z,Y]of Yj)$=$.split(`${Z}*`).join(`${Z}{0,${Y}}`).split(`${Z}+`).join(`${Z}{1,${Y}}`);return $},s=($,Z,Y)=>{let Q=Qj(Z),W=Zj++;rR($,W,Z),h[$]=W,d[W]=Z,$j[W]=Q,aR[W]=new RegExp(Z,Y?"g":void 0),eR[W]=new RegExp(Q,Y?"g":void 0)};s("NUMERICIDENTIFIER","0|[1-9]\\d*");s("NUMERICIDENTIFIERLOOSE","\\d+");s("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${a5}*`);s("MAINVERSION",`(${d[h.NUMERICIDENTIFIER]})\\.(${d[h.NUMERICIDENTIFIER]})\\.(${d[h.NUMERICIDENTIFIER]})`);s("MAINVERSIONLOOSE",`(${d[h.NUMERICIDENTIFIERLOOSE]})\\.(${d[h.NUMERICIDENTIFIERLOOSE]})\\.(${d[h.NUMERICIDENTIFIERLOOSE]})`);s("PRERELEASEIDENTIFIER",`(?:${d[h.NUMERICIDENTIFIER]}|${d[h.NONNUMERICIDENTIFIER]})`);s("PRERELEASEIDENTIFIERLOOSE",`(?:${d[h.NUMERICIDENTIFIERLOOSE]}|${d[h.NONNUMERICIDENTIFIER]})`);s("PRERELEASE",`(?:-(${d[h.PRERELEASEIDENTIFIER]}(?:\\.${d[h.PRERELEASEIDENTIFIER]})*))`);s("PRERELEASELOOSE",`(?:-?(${d[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[h.PRERELEASEIDENTIFIERLOOSE]})*))`);s("BUILDIDENTIFIER",`${a5}+`);s("BUILD",`(?:\\+(${d[h.BUILDIDENTIFIER]}(?:\\.${d[h.BUILDIDENTIFIER]})*))`);s("FULLPLAIN",`v?${d[h.MAINVERSION]}${d[h.PRERELEASE]}?${d[h.BUILD]}?`);s("FULL",`^${d[h.FULLPLAIN]}$`);s("LOOSEPLAIN",`[v=\\s]*${d[h.MAINVERSIONLOOSE]}${d[h.PRERELEASELOOSE]}?${d[h.BUILD]}?`);s("LOOSE",`^${d[h.LOOSEPLAIN]}$`);s("GTLT","((?:<|>)?=?)");s("XRANGEIDENTIFIERLOOSE",`${d[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);s("XRANGEIDENTIFIER",`${d[h.NUMERICIDENTIFIER]}|x|X|\\*`);s("XRANGEPLAIN",`[v=\\s]*(${d[h.XRANGEIDENTIFIER]})(?:\\.(${d[h.XRANGEIDENTIFIER]})(?:\\.(${d[h.XRANGEIDENTIFIER]})(?:${d[h.PRERELEASE]})?${d[h.BUILD]}?)?)?`);s("XRANGEPLAINLOOSE",`[v=\\s]*(${d[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[h.XRANGEIDENTIFIERLOOSE]})(?:${d[h.PRERELEASELOOSE]})?${d[h.BUILD]}?)?)?`);s("XRANGE",`^${d[h.GTLT]}\\s*${d[h.XRANGEPLAIN]}$`);s("XRANGELOOSE",`^${d[h.GTLT]}\\s*${d[h.XRANGEPLAINLOOSE]}$`);s("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r5}})(?:\\.(\\d{1,${r5}}))?(?:\\.(\\d{1,${r5}}))?`);s("COERCE",`${d[h.COERCEPLAIN]}(?:$|[^\\d])`);s("COERCEFULL",d[h.COERCEPLAIN]+`(?:${d[h.PRERELEASE]})?(?:${d[h.BUILD]})?(?:$|[^\\d])`);s("COERCERTL",d[h.COERCE],!0);s("COERCERTLFULL",d[h.COERCEFULL],!0);s("LONETILDE","(?:~>?)");s("TILDETRIM",`(\\s*)${d[h.LONETILDE]}\\s+`,!0);r6.tildeTrimReplace="$1~";s("TILDE",`^${d[h.LONETILDE]}${d[h.XRANGEPLAIN]}$`);s("TILDELOOSE",`^${d[h.LONETILDE]}${d[h.XRANGEPLAINLOOSE]}$`);s("LONECARET","(?:\\^)");s("CARETTRIM",`(\\s*)${d[h.LONECARET]}\\s+`,!0);r6.caretTrimReplace="$1^";s("CARET",`^${d[h.LONECARET]}${d[h.XRANGEPLAIN]}$`);s("CARETLOOSE",`^${d[h.LONECARET]}${d[h.XRANGEPLAINLOOSE]}$`);s("COMPARATORLOOSE",`^${d[h.GTLT]}\\s*(${d[h.LOOSEPLAIN]})$|^$`);s("COMPARATOR",`^${d[h.GTLT]}\\s*(${d[h.FULLPLAIN]})$|^$`);s("COMPARATORTRIM",`(\\s*)${d[h.GTLT]}\\s*(${d[h.LOOSEPLAIN]}|${d[h.XRANGEPLAIN]})`,!0);r6.comparatorTrimReplace="$1$2$3";s("HYPHENRANGE",`^\\s*(${d[h.XRANGEPLAIN]})\\s+-\\s+(${d[h.XRANGEPLAIN]})\\s*$`);s("HYPHENRANGELOOSE",`^\\s*(${d[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[h.XRANGEPLAINLOOSE]})\\s*$`);s("STAR","(<|>)?=?\\s*\\*");s("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");s("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var nY=C((Ro,z2)=>{var Wj=Object.freeze({loose:!0}),Xj=Object.freeze({}),Jj=($)=>{if(!$)return Xj;if(typeof $!=="object")return Wj;return $};z2.exports=Jj});var e5=C((jo,q2)=>{var U2=/^[0-9]+$/,S2=($,Z)=>{let Y=U2.test($),Q=U2.test(Z);if(Y&&Q)$=+$,Z=+Z;return $===Z?0:Y&&!Q?-1:Q&&!Y?1:$<Z?-1:1},zj=($,Z)=>S2(Z,$);q2.exports={compareIdentifiers:S2,rcompareIdentifiers:zj}});var F0=C((Co,w2)=>{var oY=WZ(),{MAX_LENGTH:G2,MAX_SAFE_INTEGER:tY}=QZ(),{safeRe:M2,safeSrc:B2,t:sY}=G$(),Uj=nY(),{compareIdentifiers:M$}=e5();class y6{constructor($,Z){if(Z=Uj(Z),$ instanceof y6)if($.loose===!!Z.loose&&$.includePrerelease===!!Z.includePrerelease)return $;else $=$.version;else if(typeof $!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof $}".`);if($.length>G2)throw new TypeError(`version is longer than ${G2} characters`);oY("SemVer",$,Z),this.options=Z,this.loose=!!Z.loose,this.includePrerelease=!!Z.includePrerelease;let Y=$.trim().match(Z.loose?M2[sY.LOOSE]:M2[sY.FULL]);if(!Y)throw new TypeError(`Invalid Version: ${$}`);if(this.raw=$,this.major=+Y[1],this.minor=+Y[2],this.patch=+Y[3],this.major>tY||this.major<0)throw new TypeError("Invalid major version");if(this.minor>tY||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>tY||this.patch<0)throw new TypeError("Invalid patch version");if(!Y[4])this.prerelease=[];else this.prerelease=Y[4].split(".").map((Q)=>{if(/^[0-9]+$/.test(Q)){let W=+Q;if(W>=0&&W<tY)return W}return Q});this.build=Y[5]?Y[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare($){if(oY("SemVer.compare",this.version,this.options,$),!($ instanceof y6)){if(typeof $==="string"&&$===this.version)return 0;$=new y6($,this.options)}if($.version===this.version)return 0;return this.compareMain($)||this.comparePre($)}compareMain($){if(!($ instanceof y6))$=new y6($,this.options);return M$(this.major,$.major)||M$(this.minor,$.minor)||M$(this.patch,$.patch)}comparePre($){if(!($ instanceof y6))$=new y6($,this.options);if(this.prerelease.length&&!$.prerelease.length)return-1;else if(!this.prerelease.length&&$.prerelease.length)return 1;else if(!this.prerelease.length&&!$.prerelease.length)return 0;let Z=0;do{let Y=this.prerelease[Z],Q=$.prerelease[Z];if(oY("prerelease compare",Z,Y,Q),Y===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(Y===void 0)return-1;else if(Y===Q)continue;else return M$(Y,Q)}while(++Z)}compareBuild($){if(!($ instanceof y6))$=new y6($,this.options);let Z=0;do{let Y=this.build[Z],Q=$.build[Z];if(oY("build compare",Z,Y,Q),Y===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(Y===void 0)return-1;else if(Y===Q)continue;else return M$(Y,Q)}while(++Z)}inc($,Z,Y){if($.startsWith("pre")){if(!Z&&Y===!1)throw new Error("invalid increment argument: identifier is empty");if(Z){let Q=new RegExp(`^${this.options.loose?B2[sY.PRERELEASELOOSE]:B2[sY.PRERELEASE]}$`),W=`-${Z}`.match(Q);if(!W||W[1]!==Z)throw new Error(`invalid identifier: ${Z}`)}}switch($){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",Z,Y);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",Z,Y);break;case"prepatch":this.prerelease.length=0,this.inc("patch",Z,Y),this.inc("pre",Z,Y);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",Z,Y);this.inc("pre",Z,Y);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let Q=Number(Y)?1:0;if(this.prerelease.length===0)this.prerelease=[Q];else{let W=this.prerelease.length;while(--W>=0)if(typeof this.prerelease[W]==="number")this.prerelease[W]++,W=-2;if(W===-1){if(Z===this.prerelease.join(".")&&Y===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Q)}}if(Z){let W=[Z,Q];if(Y===!1)W=[Z];if(M$(this.prerelease[0],Z)===0){if(isNaN(this.prerelease[1]))this.prerelease=W}else this.prerelease=W}break}default:throw new Error(`invalid increment argument: ${$}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}w2.exports=y6});var K4=C((_o,D2)=>{var H2=F0(),Sj=($,Z,Y=!1)=>{if($ instanceof H2)return $;try{return new H2($,Z)}catch(Q){if(!Y)return null;throw Q}};D2.exports=Sj});var N2=C((Vo,A2)=>{var qj=K4(),Gj=($,Z)=>{let Y=qj($,Z);return Y?Y.version:null};A2.exports=Gj});var O2=C((Eo,L2)=>{var Mj=K4(),Bj=($,Z)=>{let Y=Mj($.trim().replace(/^[=v]+/,""),Z);return Y?Y.version:null};L2.exports=Bj});var K2=C((Io,P2)=>{var F2=F0(),wj=($,Z,Y,Q,W)=>{if(typeof Y==="string")W=Q,Q=Y,Y=void 0;try{return new F2($ instanceof F2?$.version:$,Y).inc(Z,Q,W).version}catch(X){return null}};P2.exports=wj});var C2=C((To,j2)=>{var R2=K4(),Hj=($,Z)=>{let Y=R2($,null,!0),Q=R2(Z,null,!0),W=Y.compare(Q);if(W===0)return null;let X=W>0,J=X?Y:Q,z=X?Q:Y,U=!!J.prerelease.length;if(!!z.prerelease.length&&!U){if(!z.patch&&!z.minor)return"major";if(z.compareMain(J)===0){if(z.minor&&!z.patch)return"minor";return"patch"}}let q=U?"pre":"";if(Y.major!==Q.major)return q+"major";if(Y.minor!==Q.minor)return q+"minor";if(Y.patch!==Q.patch)return q+"patch";return"prerelease"};j2.exports=Hj});var V2=C((bo,_2)=>{var Dj=F0(),Aj=($,Z)=>new Dj($,Z).major;_2.exports=Aj});var I2=C((xo,E2)=>{var Nj=F0(),Lj=($,Z)=>new Nj($,Z).minor;E2.exports=Lj});var b2=C((ko,T2)=>{var Oj=F0(),Fj=($,Z)=>new Oj($,Z).patch;T2.exports=Fj});var k2=C((go,x2)=>{var Pj=K4(),Kj=($,Z)=>{let Y=Pj($,Z);return Y&&Y.prerelease.length?Y.prerelease:null};x2.exports=Kj});var H6=C((fo,f2)=>{var g2=F0(),Rj=($,Z,Y)=>new g2($,Y).compare(new g2(Z,Y));f2.exports=Rj});var v2=C((yo,y2)=>{var jj=H6(),Cj=($,Z,Y)=>jj(Z,$,Y);y2.exports=Cj});var h2=C((vo,d2)=>{var _j=H6(),Vj=($,Z)=>_j($,Z,!0);d2.exports=Vj});var rY=C((ho,u2)=>{var m2=F0(),Ej=($,Z,Y)=>{let Q=new m2($,Y),W=new m2(Z,Y);return Q.compare(W)||Q.compareBuild(W)};u2.exports=Ej});var p2=C((mo,c2)=>{var Ij=rY(),Tj=($,Z)=>$.sort((Y,Q)=>Ij(Y,Q,Z));c2.exports=Tj});var l2=C((uo,i2)=>{var bj=rY(),xj=($,Z)=>$.sort((Y,Q)=>bj(Q,Y,Z));i2.exports=xj});var XZ=C((co,n2)=>{var kj=H6(),gj=($,Z,Y)=>kj($,Z,Y)>0;n2.exports=gj});var aY=C((po,o2)=>{var fj=H6(),yj=($,Z,Y)=>fj($,Z,Y)<0;o2.exports=yj});var $Q=C((io,t2)=>{var vj=H6(),dj=($,Z,Y)=>vj($,Z,Y)===0;t2.exports=dj});var ZQ=C((lo,s2)=>{var hj=H6(),mj=($,Z,Y)=>hj($,Z,Y)!==0;s2.exports=mj});var eY=C((no,r2)=>{var uj=H6(),cj=($,Z,Y)=>uj($,Z,Y)>=0;r2.exports=cj});var $9=C((oo,a2)=>{var pj=H6(),ij=($,Z,Y)=>pj($,Z,Y)<=0;a2.exports=ij});var YQ=C((to,e2)=>{var lj=$Q(),nj=ZQ(),oj=XZ(),tj=eY(),sj=aY(),rj=$9(),aj=($,Z,Y,Q)=>{switch(Z){case"===":if(typeof $==="object")$=$.version;if(typeof Y==="object")Y=Y.version;return $===Y;case"!==":if(typeof $==="object")$=$.version;if(typeof Y==="object")Y=Y.version;return $!==Y;case"":case"=":case"==":return lj($,Y,Q);case"!=":return nj($,Y,Q);case">":return oj($,Y,Q);case">=":return tj($,Y,Q);case"<":return sj($,Y,Q);case"<=":return rj($,Y,Q);default:throw new TypeError(`Invalid operator: ${Z}`)}};e2.exports=aj});var ZU=C((so,$U)=>{var ej=F0(),$C=K4(),{safeRe:Z9,t:Y9}=G$(),ZC=($,Z)=>{if($ instanceof ej)return $;if(typeof $==="number")$=String($);if(typeof $!=="string")return null;Z=Z||{};let Y=null;if(!Z.rtl)Y=$.match(Z.includePrerelease?Z9[Y9.COERCEFULL]:Z9[Y9.COERCE]);else{let U=Z.includePrerelease?Z9[Y9.COERCERTLFULL]:Z9[Y9.COERCERTL],S;while((S=U.exec($))&&(!Y||Y.index+Y[0].length!==$.length)){if(!Y||S.index+S[0].length!==Y.index+Y[0].length)Y=S;U.lastIndex=S.index+S[1].length+S[2].length}U.lastIndex=-1}if(Y===null)return null;let Q=Y[2],W=Y[3]||"0",X=Y[4]||"0",J=Z.includePrerelease&&Y[5]?`-${Y[5]}`:"",z=Z.includePrerelease&&Y[6]?`+${Y[6]}`:"";return $C(`${Q}.${W}.${X}${J}${z}`,Z)};$U.exports=ZC});var WU=C((ro,QU)=>{class YU{constructor(){this.max=1000,this.map=new Map}get($){let Z=this.map.get($);if(Z===void 0)return;else return this.map.delete($),this.map.set($,Z),Z}delete($){return this.map.delete($)}set($,Z){if(!this.delete($)&&Z!==void 0){if(this.map.size>=this.max){let Q=this.map.keys().next().value;this.delete(Q)}this.map.set($,Z)}return this}}QU.exports=YU});var D6=C((ao,UU)=>{var YC=/\s+/g;class JZ{constructor($,Z){if(Z=WC(Z),$ instanceof JZ)if($.loose===!!Z.loose&&$.includePrerelease===!!Z.includePrerelease)return $;else return new JZ($.raw,Z);if($ instanceof QQ)return this.raw=$.value,this.set=[[$]],this.formatted=void 0,this;if(this.options=Z,this.loose=!!Z.loose,this.includePrerelease=!!Z.includePrerelease,this.raw=$.trim().replace(YC," "),this.set=this.raw.split("||").map((Y)=>this.parseRange(Y.trim())).filter((Y)=>Y.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let Y=this.set[0];if(this.set=this.set.filter((Q)=>!JU(Q[0])),this.set.length===0)this.set=[Y];else if(this.set.length>1){for(let Q of this.set)if(Q.length===1&&GC(Q[0])){this.set=[Q];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let $=0;$<this.set.length;$++){if($>0)this.formatted+="||";let Z=this.set[$];for(let Y=0;Y<Z.length;Y++){if(Y>0)this.formatted+=" ";this.formatted+=Z[Y].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange($){let Y=((this.options.includePrerelease&&SC)|(this.options.loose&&qC))+":"+$,Q=XU.get(Y);if(Q)return Q;let W=this.options.loose,X=W?l0[E0.HYPHENRANGELOOSE]:l0[E0.HYPHENRANGE];$=$.replace(X,FC(this.options.includePrerelease)),v1("hyphen replace",$),$=$.replace(l0[E0.COMPARATORTRIM],JC),v1("comparator trim",$),$=$.replace(l0[E0.TILDETRIM],zC),v1("tilde trim",$),$=$.replace(l0[E0.CARETTRIM],UC),v1("caret trim",$);let J=$.split(" ").map((q)=>MC(q,this.options)).join(" ").split(/\s+/).map((q)=>OC(q,this.options));if(W)J=J.filter((q)=>{return v1("loose invalid filter",q,this.options),!!q.match(l0[E0.COMPARATORLOOSE])});v1("range list",J);let z=new Map,U=J.map((q)=>new QQ(q,this.options));for(let q of U){if(JU(q))return[q];z.set(q.value,q)}if(z.size>1&&z.has(""))z.delete("");let S=[...z.values()];return XU.set(Y,S),S}intersects($,Z){if(!($ instanceof JZ))throw new TypeError("a Range is required");return this.set.some((Y)=>{return zU(Y,Z)&&$.set.some((Q)=>{return zU(Q,Z)&&Y.every((W)=>{return Q.every((X)=>{return W.intersects(X,Z)})})})})}test($){if(!$)return!1;if(typeof $==="string")try{$=new XC($,this.options)}catch(Z){return!1}for(let Z=0;Z<this.set.length;Z++)if(PC(this.set[Z],$,this.options))return!0;return!1}}UU.exports=JZ;var QC=WU(),XU=new QC,WC=nY(),QQ=zZ(),v1=WZ(),XC=F0(),{safeRe:l0,t:E0,comparatorTrimReplace:JC,tildeTrimReplace:zC,caretTrimReplace:UC}=G$(),{FLAG_INCLUDE_PRERELEASE:SC,FLAG_LOOSE:qC}=QZ(),JU=($)=>$.value==="<0.0.0-0",GC=($)=>$.value==="",zU=($,Z)=>{let Y=!0,Q=$.slice(),W=Q.pop();while(Y&&Q.length)Y=Q.every((X)=>{return W.intersects(X,Z)}),W=Q.pop();return Y},MC=($,Z)=>{return v1("comp",$,Z),$=HC($,Z),v1("caret",$),$=BC($,Z),v1("tildes",$),$=AC($,Z),v1("xrange",$),$=LC($,Z),v1("stars",$),$},I0=($)=>!$||$.toLowerCase()==="x"||$==="*",BC=($,Z)=>{return $.trim().split(/\s+/).map((Y)=>wC(Y,Z)).join(" ")},wC=($,Z)=>{let Y=Z.loose?l0[E0.TILDELOOSE]:l0[E0.TILDE];return $.replace(Y,(Q,W,X,J,z)=>{v1("tilde",$,Q,W,X,J,z);let U;if(I0(W))U="";else if(I0(X))U=`>=${W}.0.0 <${+W+1}.0.0-0`;else if(I0(J))U=`>=${W}.${X}.0 <${W}.${+X+1}.0-0`;else if(z)v1("replaceTilde pr",z),U=`>=${W}.${X}.${J}-${z} <${W}.${+X+1}.0-0`;else U=`>=${W}.${X}.${J} <${W}.${+X+1}.0-0`;return v1("tilde return",U),U})},HC=($,Z)=>{return $.trim().split(/\s+/).map((Y)=>DC(Y,Z)).join(" ")},DC=($,Z)=>{v1("caret",$,Z);let Y=Z.loose?l0[E0.CARETLOOSE]:l0[E0.CARET],Q=Z.includePrerelease?"-0":"";return $.replace(Y,(W,X,J,z,U)=>{v1("caret",$,W,X,J,z,U);let S;if(I0(X))S="";else if(I0(J))S=`>=${X}.0.0${Q} <${+X+1}.0.0-0`;else if(I0(z))if(X==="0")S=`>=${X}.${J}.0${Q} <${X}.${+J+1}.0-0`;else S=`>=${X}.${J}.0${Q} <${+X+1}.0.0-0`;else if(U)if(v1("replaceCaret pr",U),X==="0")if(J==="0")S=`>=${X}.${J}.${z}-${U} <${X}.${J}.${+z+1}-0`;else S=`>=${X}.${J}.${z}-${U} <${X}.${+J+1}.0-0`;else S=`>=${X}.${J}.${z}-${U} <${+X+1}.0.0-0`;else if(v1("no pr"),X==="0")if(J==="0")S=`>=${X}.${J}.${z}${Q} <${X}.${J}.${+z+1}-0`;else S=`>=${X}.${J}.${z}${Q} <${X}.${+J+1}.0-0`;else S=`>=${X}.${J}.${z} <${+X+1}.0.0-0`;return v1("caret return",S),S})},AC=($,Z)=>{return v1("replaceXRanges",$,Z),$.split(/\s+/).map((Y)=>NC(Y,Z)).join(" ")},NC=($,Z)=>{$=$.trim();let Y=Z.loose?l0[E0.XRANGELOOSE]:l0[E0.XRANGE];return $.replace(Y,(Q,W,X,J,z,U)=>{v1("xRange",$,Q,W,X,J,z,U);let S=I0(X),q=S||I0(J),M=q||I0(z),H=M;if(W==="="&&H)W="";if(U=Z.includePrerelease?"-0":"",S)if(W===">"||W==="<")Q="<0.0.0-0";else Q="*";else if(W&&H){if(q)J=0;if(z=0,W===">")if(W=">=",q)X=+X+1,J=0,z=0;else J=+J+1,z=0;else if(W==="<=")if(W="<",q)X=+X+1;else J=+J+1;if(W==="<")U="-0";Q=`${W+X}.${J}.${z}${U}`}else if(q)Q=`>=${X}.0.0${U} <${+X+1}.0.0-0`;else if(M)Q=`>=${X}.${J}.0${U} <${X}.${+J+1}.0-0`;return v1("xRange return",Q),Q})},LC=($,Z)=>{return v1("replaceStars",$,Z),$.trim().replace(l0[E0.STAR],"")},OC=($,Z)=>{return v1("replaceGTE0",$,Z),$.trim().replace(l0[Z.includePrerelease?E0.GTE0PRE:E0.GTE0],"")},FC=($)=>(Z,Y,Q,W,X,J,z,U,S,q,M,H)=>{if(I0(Q))Y="";else if(I0(W))Y=`>=${Q}.0.0${$?"-0":""}`;else if(I0(X))Y=`>=${Q}.${W}.0${$?"-0":""}`;else if(J)Y=`>=${Y}`;else Y=`>=${Y}${$?"-0":""}`;if(I0(S))U="";else if(I0(q))U=`<${+S+1}.0.0-0`;else if(I0(M))U=`<${S}.${+q+1}.0-0`;else if(H)U=`<=${S}.${q}.${M}-${H}`;else if($)U=`<${S}.${q}.${+M+1}-0`;else U=`<=${U}`;return`${Y} ${U}`.trim()},PC=($,Z,Y)=>{for(let Q=0;Q<$.length;Q++)if(!$[Q].test(Z))return!1;if(Z.prerelease.length&&!Y.includePrerelease){for(let Q=0;Q<$.length;Q++){if(v1($[Q].semver),$[Q].semver===QQ.ANY)continue;if($[Q].semver.prerelease.length>0){let W=$[Q].semver;if(W.major===Z.major&&W.minor===Z.minor&&W.patch===Z.patch)return!0}}return!1}return!0}});var zZ=C((eo,wU)=>{var UZ=Symbol("SemVer ANY");class Q9{static get ANY(){return UZ}constructor($,Z){if(Z=SU(Z),$ instanceof Q9)if($.loose===!!Z.loose)return $;else $=$.value;if($=$.trim().split(/\s+/).join(" "),XQ("comparator",$,Z),this.options=Z,this.loose=!!Z.loose,this.parse($),this.semver===UZ)this.value="";else this.value=this.operator+this.semver.version;XQ("comp",this)}parse($){let Z=this.options.loose?qU[GU.COMPARATORLOOSE]:qU[GU.COMPARATOR],Y=$.match(Z);if(!Y)throw new TypeError(`Invalid comparator: ${$}`);if(this.operator=Y[1]!==void 0?Y[1]:"",this.operator==="=")this.operator="";if(!Y[2])this.semver=UZ;else this.semver=new MU(Y[2],this.options.loose)}toString(){return this.value}test($){if(XQ("Comparator.test",$,this.options.loose),this.semver===UZ||$===UZ)return!0;if(typeof $==="string")try{$=new MU($,this.options)}catch(Z){return!1}return WQ($,this.operator,this.semver,this.options)}intersects($,Z){if(!($ instanceof Q9))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new BU($.value,Z).test(this.value)}else if($.operator===""){if($.value==="")return!0;return new BU(this.value,Z).test($.semver)}if(Z=SU(Z),Z.includePrerelease&&(this.value==="<0.0.0-0"||$.value==="<0.0.0-0"))return!1;if(!Z.includePrerelease&&(this.value.startsWith("<0.0.0")||$.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&$.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&$.operator.startsWith("<"))return!0;if(this.semver.version===$.semver.version&&this.operator.includes("=")&&$.operator.includes("="))return!0;if(WQ(this.semver,"<",$.semver,Z)&&this.operator.startsWith(">")&&$.operator.startsWith("<"))return!0;if(WQ(this.semver,">",$.semver,Z)&&this.operator.startsWith("<")&&$.operator.startsWith(">"))return!0;return!1}}wU.exports=Q9;var SU=nY(),{safeRe:qU,t:GU}=G$(),WQ=YQ(),XQ=WZ(),MU=F0(),BU=D6()});var SZ=C(($t,HU)=>{var KC=D6(),RC=($,Z,Y)=>{try{Z=new KC(Z,Y)}catch(Q){return!1}return Z.test($)};HU.exports=RC});var AU=C((Zt,DU)=>{var jC=D6(),CC=($,Z)=>new jC($,Z).set.map((Y)=>Y.map((Q)=>Q.value).join(" ").trim().split(" "));DU.exports=CC});var LU=C((Yt,NU)=>{var _C=F0(),VC=D6(),EC=($,Z,Y)=>{let Q=null,W=null,X=null;try{X=new VC(Z,Y)}catch(J){return null}return $.forEach((J)=>{if(X.test(J)){if(!Q||W.compare(J)===-1)Q=J,W=new _C(Q,Y)}}),Q};NU.exports=EC});var FU=C((Qt,OU)=>{var IC=F0(),TC=D6(),bC=($,Z,Y)=>{let Q=null,W=null,X=null;try{X=new TC(Z,Y)}catch(J){return null}return $.forEach((J)=>{if(X.test(J)){if(!Q||W.compare(J)===1)Q=J,W=new IC(Q,Y)}}),Q};OU.exports=bC});var RU=C((Wt,KU)=>{var JQ=F0(),xC=D6(),PU=XZ(),kC=($,Z)=>{$=new xC($,Z);let Y=new JQ("0.0.0");if($.test(Y))return Y;if(Y=new JQ("0.0.0-0"),$.test(Y))return Y;Y=null;for(let Q=0;Q<$.set.length;++Q){let W=$.set[Q],X=null;if(W.forEach((J)=>{let z=new JQ(J.semver.version);switch(J.operator){case">":if(z.prerelease.length===0)z.patch++;else z.prerelease.push(0);z.raw=z.format();case"":case">=":if(!X||PU(z,X))X=z;break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${J.operator}`)}}),X&&(!Y||PU(Y,X)))Y=X}if(Y&&$.test(Y))return Y;return null};KU.exports=kC});var CU=C((Xt,jU)=>{var gC=D6(),fC=($,Z)=>{try{return new gC($,Z).range||"*"}catch(Y){return null}};jU.exports=fC});var W9=C((Jt,IU)=>{var yC=F0(),EU=zZ(),{ANY:vC}=EU,dC=D6(),hC=SZ(),_U=XZ(),VU=aY(),mC=$9(),uC=eY(),cC=($,Z,Y,Q)=>{$=new yC($,Q),Z=new dC(Z,Q);let W,X,J,z,U;switch(Y){case">":W=_U,X=mC,J=VU,z=">",U=">=";break;case"<":W=VU,X=uC,J=_U,z="<",U="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(hC($,Z,Q))return!1;for(let S=0;S<Z.set.length;++S){let q=Z.set[S],M=null,H=null;if(q.forEach((w)=>{if(w.semver===vC)w=new EU(">=0.0.0");if(M=M||w,H=H||w,W(w.semver,M.semver,Q))M=w;else if(J(w.semver,H.semver,Q))H=w}),M.operator===z||M.operator===U)return!1;if((!H.operator||H.operator===z)&&X($,H.semver))return!1;else if(H.operator===U&&J($,H.semver))return!1}return!0};IU.exports=cC});var bU=C((zt,TU)=>{var pC=W9(),iC=($,Z,Y)=>pC($,Z,">",Y);TU.exports=iC});var kU=C((Ut,xU)=>{var lC=W9(),nC=($,Z,Y)=>lC($,Z,"<",Y);xU.exports=nC});var yU=C((St,fU)=>{var gU=D6(),oC=($,Z,Y)=>{return $=new gU($,Y),Z=new gU(Z,Y),$.intersects(Z,Y)};fU.exports=oC});var dU=C((qt,vU)=>{var tC=SZ(),sC=H6();vU.exports=($,Z,Y)=>{let Q=[],W=null,X=null,J=$.sort((q,M)=>sC(q,M,Y));for(let q of J)if(tC(q,Z,Y)){if(X=q,!W)W=q}else{if(X)Q.push([W,X]);X=null,W=null}if(W)Q.push([W,null]);let z=[];for(let[q,M]of Q)if(q===M)z.push(q);else if(!M&&q===J[0])z.push("*");else if(!M)z.push(`>=${q}`);else if(q===J[0])z.push(`<=${M}`);else z.push(`${q} - ${M}`);let U=z.join(" || "),S=typeof Z.raw==="string"?Z.raw:String(Z);return U.length<S.length?U:Z}});var iU=C((Gt,pU)=>{var hU=D6(),UQ=zZ(),{ANY:zQ}=UQ,qZ=SZ(),SQ=H6(),rC=($,Z,Y={})=>{if($===Z)return!0;$=new hU($,Y),Z=new hU(Z,Y);let Q=!1;$:for(let W of $.set){for(let X of Z.set){let J=eC(W,X,Y);if(Q=Q||J!==null,J)continue $}if(Q)return!1}return!0},aC=[new UQ(">=0.0.0-0")],mU=[new UQ(">=0.0.0")],eC=($,Z,Y)=>{if($===Z)return!0;if($.length===1&&$[0].semver===zQ)if(Z.length===1&&Z[0].semver===zQ)return!0;else if(Y.includePrerelease)$=aC;else $=mU;if(Z.length===1&&Z[0].semver===zQ)if(Y.includePrerelease)return!0;else Z=mU;let Q=new Set,W,X;for(let w of $)if(w.operator===">"||w.operator===">=")W=uU(W,w,Y);else if(w.operator==="<"||w.operator==="<=")X=cU(X,w,Y);else Q.add(w.semver);if(Q.size>1)return null;let J;if(W&&X){if(J=SQ(W.semver,X.semver,Y),J>0)return null;else if(J===0&&(W.operator!==">="||X.operator!=="<="))return null}for(let w of Q){if(W&&!qZ(w,String(W),Y))return null;if(X&&!qZ(w,String(X),Y))return null;for(let G of Z)if(!qZ(w,String(G),Y))return!1;return!0}let z,U,S,q,M=X&&!Y.includePrerelease&&X.semver.prerelease.length?X.semver:!1,H=W&&!Y.includePrerelease&&W.semver.prerelease.length?W.semver:!1;if(M&&M.prerelease.length===1&&X.operator==="<"&&M.prerelease[0]===0)M=!1;for(let w of Z){if(q=q||w.operator===">"||w.operator===">=",S=S||w.operator==="<"||w.operator==="<=",W){if(H){if(w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===H.major&&w.semver.minor===H.minor&&w.semver.patch===H.patch)H=!1}if(w.operator===">"||w.operator===">="){if(z=uU(W,w,Y),z===w&&z!==W)return!1}else if(W.operator===">="&&!qZ(W.semver,String(w),Y))return!1}if(X){if(M){if(w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===M.major&&w.semver.minor===M.minor&&w.semver.patch===M.patch)M=!1}if(w.operator==="<"||w.operator==="<="){if(U=cU(X,w,Y),U===w&&U!==X)return!1}else if(X.operator==="<="&&!qZ(X.semver,String(w),Y))return!1}if(!w.operator&&(X||W)&&J!==0)return!1}if(W&&S&&!X&&J!==0)return!1;if(X&&q&&!W&&J!==0)return!1;if(H||M)return!1;return!0},uU=($,Z,Y)=>{if(!$)return Z;let Q=SQ($.semver,Z.semver,Y);return Q>0?$:Q<0?Z:Z.operator===">"&&$.operator===">="?Z:$},cU=($,Z,Y)=>{if(!$)return Z;let Q=SQ($.semver,Z.semver,Y);return Q<0?$:Q>0?Z:Z.operator==="<"&&$.operator==="<="?Z:$};pU.exports=rC});var X9=C((Mt,oU)=>{var qQ=G$(),lU=QZ(),$_=F0(),nU=e5(),Z_=K4(),Y_=N2(),Q_=O2(),W_=K2(),X_=C2(),J_=V2(),z_=I2(),U_=b2(),S_=k2(),q_=H6(),G_=v2(),M_=h2(),B_=rY(),w_=p2(),H_=l2(),D_=XZ(),A_=aY(),N_=$Q(),L_=ZQ(),O_=eY(),F_=$9(),P_=YQ(),K_=ZU(),R_=zZ(),j_=D6(),C_=SZ(),__=AU(),V_=LU(),E_=FU(),I_=RU(),T_=CU(),b_=W9(),x_=bU(),k_=kU(),g_=yU(),f_=dU(),y_=iU();oU.exports={parse:Z_,valid:Y_,clean:Q_,inc:W_,diff:X_,major:J_,minor:z_,patch:U_,prerelease:S_,compare:q_,rcompare:G_,compareLoose:M_,compareBuild:B_,sort:w_,rsort:H_,gt:D_,lt:A_,eq:N_,neq:L_,gte:O_,lte:F_,cmp:P_,coerce:K_,Comparator:R_,Range:j_,satisfies:C_,toComparators:__,maxSatisfying:V_,minSatisfying:E_,minVersion:I_,validRange:T_,outside:b_,gtr:x_,ltr:k_,intersects:g_,simplifyRange:f_,subset:y_,SemVer:$_,re:qQ.re,src:qQ.src,tokens:qQ.t,SEMVER_SPEC_VERSION:lU.SEMVER_SPEC_VERSION,RELEASE_TYPES:lU.RELEASE_TYPES,compareIdentifiers:nU.compareIdentifiers,rcompareIdentifiers:nU.rcompareIdentifiers}});var sU=C((Bt,tU)=>{var v_=X9();tU.exports=v_.satisfies(process.version,">=15.7.0")});var aU=C((wt,rU)=>{var d_=X9();rU.exports=d_.satisfies(process.version,">=16.9.0")});var GQ=C((Ht,eU)=>{var h_=sU(),m_=aU(),u_={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},c_={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};eU.exports=function($,Z){if(!$||!Z)return;let Y=Z.asymmetricKeyType;if(!Y)return;let Q=u_[Y];if(!Q)throw new Error(`Unknown key type "${Y}".`);if(!Q.includes($))throw new Error(`"alg" parameter for "${Y}" key type must be one of: ${Q.join(", ")}.`);if(h_)switch(Y){case"ec":let W=Z.asymmetricKeyDetails.namedCurve,X=c_[$];if(W!==X)throw new Error(`"alg" parameter "${$}" requires curve "${X}".`);break;case"rsa-pss":if(m_){let J=parseInt($.slice(-3),10),{hashAlgorithm:z,mgf1HashAlgorithm:U,saltLength:S}=Z.asymmetricKeyDetails;if(z!==`sha${J}`||U!==z)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${$}.`);if(S!==void 0&&S>J>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${$}.`)}break}}});var MQ=C((Dt,$S)=>{var p_=X9();$S.exports=p_.satisfies(process.version,"^6.12.0 || >=8.0.0")});var QS=C((At,YS)=>{var b1=YZ(),i_=o5(),ZS=t5(),l_=n5(),n_=s5(),o_=GQ(),t_=MQ(),s_=cY(),{KeyObject:r_,createSecretKey:a_,createPublicKey:e_}=U1("crypto"),BQ=["RS256","RS384","RS512"],$V=["ES256","ES384","ES512"],wQ=["RS256","RS384","RS512"],ZV=["HS256","HS384","HS512"];if(t_)BQ.splice(BQ.length,0,"PS256","PS384","PS512"),wQ.splice(wQ.length,0,"PS256","PS384","PS512");YS.exports=function($,Z,Y,Q){if(typeof Y==="function"&&!Q)Q=Y,Y={};if(!Y)Y={};Y=Object.assign({},Y);let W;if(Q)W=Q;else W=function(q,M){if(q)throw q;return M};if(Y.clockTimestamp&&typeof Y.clockTimestamp!=="number")return W(new b1("clockTimestamp must be a number"));if(Y.nonce!==void 0&&(typeof Y.nonce!=="string"||Y.nonce.trim()===""))return W(new b1("nonce must be a non-empty string"));if(Y.allowInvalidAsymmetricKeyTypes!==void 0&&typeof Y.allowInvalidAsymmetricKeyTypes!=="boolean")return W(new b1("allowInvalidAsymmetricKeyTypes must be a boolean"));let X=Y.clockTimestamp||Math.floor(Date.now()/1000);if(!$)return W(new b1("jwt must be provided"));if(typeof $!=="string")return W(new b1("jwt must be a string"));let J=$.split(".");if(J.length!==3)return W(new b1("jwt malformed"));let z;try{z=l_($,{complete:!0})}catch(q){return W(q)}if(!z)return W(new b1("invalid token"));let U=z.header,S;if(typeof Z==="function"){if(!Q)return W(new b1("verify must be called asynchronous if secret or public key is provided as a callback"));S=Z}else S=function(q,M){return M(null,Z)};return S(U,function(q,M){if(q)return W(new b1("error in secret or public key callback: "+q.message));let H=J[2].trim()!=="";if(!H&&M)return W(new b1("jwt signature is required"));if(H&&!M)return W(new b1("secret or public key must be provided"));if(!H&&!Y.algorithms)return W(new b1('please specify "none" in "algorithms" to verify unsigned tokens'));if(M!=null&&!(M instanceof r_))try{M=e_(M)}catch(N){try{M=a_(typeof M==="string"?Buffer.from(M):M)}catch(O){return W(new b1("secretOrPublicKey is not valid key material"))}}if(!Y.algorithms)if(M.type==="secret")Y.algorithms=ZV;else if(["rsa","rsa-pss"].includes(M.asymmetricKeyType))Y.algorithms=wQ;else if(M.asymmetricKeyType==="ec")Y.algorithms=$V;else Y.algorithms=BQ;if(Y.algorithms.indexOf(z.header.alg)===-1)return W(new b1("invalid algorithm"));if(U.alg.startsWith("HS")&&M.type!=="secret")return W(new b1(`secretOrPublicKey must be a symmetric key when using ${U.alg}`));else if(/^(?:RS|PS|ES)/.test(U.alg)&&M.type!=="public")return W(new b1(`secretOrPublicKey must be an asymmetric key when using ${U.alg}`));if(!Y.allowInvalidAsymmetricKeyTypes)try{o_(U.alg,M)}catch(N){return W(N)}let w;try{w=s_.verify($,z.header.alg,M)}catch(N){return W(N)}if(!w)return W(new b1("invalid signature"));let G=z.payload;if(typeof G.nbf!=="undefined"&&!Y.ignoreNotBefore){if(typeof G.nbf!=="number")return W(new b1("invalid nbf value"));if(G.nbf>X+(Y.clockTolerance||0))return W(new i_("jwt not active",new Date(G.nbf*1000)))}if(typeof G.exp!=="undefined"&&!Y.ignoreExpiration){if(typeof G.exp!=="number")return W(new b1("invalid exp value"));if(X>=G.exp+(Y.clockTolerance||0))return W(new ZS("jwt expired",new Date(G.exp*1000)))}if(Y.audience){let N=Array.isArray(Y.audience)?Y.audience:[Y.audience];if(!(Array.isArray(G.aud)?G.aud:[G.aud]).some(function(P){return N.some(function(b){return b instanceof RegExp?b.test(P):b===P})}))return W(new b1("jwt audience invalid. expected: "+N.join(" or ")))}if(Y.issuer){if(typeof Y.issuer==="string"&&G.iss!==Y.issuer||Array.isArray(Y.issuer)&&Y.issuer.indexOf(G.iss)===-1)return W(new b1("jwt issuer invalid. expected: "+Y.issuer))}if(Y.subject){if(G.sub!==Y.subject)return W(new b1("jwt subject invalid. expected: "+Y.subject))}if(Y.jwtid){if(G.jti!==Y.jwtid)return W(new b1("jwt jwtid invalid. expected: "+Y.jwtid))}if(Y.nonce){if(G.nonce!==Y.nonce)return W(new b1("jwt nonce invalid. expected: "+Y.nonce))}if(Y.maxAge){if(typeof G.iat!=="number")return W(new b1("iat required when maxAge is specified"));let N=n_(Y.maxAge,G.iat);if(typeof N==="undefined")return W(new b1('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(X>=N+(Y.clockTolerance||0))return W(new ZS("maxAge exceeded",new Date(N*1000)))}if(Y.complete===!0){let N=z.signature;return W(null,{header:U,payload:G,signature:N})}return W(null,G)})}});var SS=C((Nt,US)=>{var WS=1/0,JS=9007199254740991,YV=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,XS=NaN,QV="[object Arguments]",WV="[object Function]",XV="[object GeneratorFunction]",JV="[object String]",zV="[object Symbol]",UV=/^\s+|\s+$/g,SV=/^[-+]0x[0-9a-f]+$/i,qV=/^0b[01]+$/i,GV=/^0o[0-7]+$/i,MV=/^(?:0|[1-9]\d*)$/,BV=parseInt;function wV($,Z){var Y=-1,Q=$?$.length:0,W=Array(Q);while(++Y<Q)W[Y]=Z($[Y],Y,$);return W}function HV($,Z,Y,Q){var W=$.length,X=Y+(Q?1:-1);while(Q?X--:++X<W)if(Z($[X],X,$))return X;return-1}function DV($,Z,Y){if(Z!==Z)return HV($,AV,Y);var Q=Y-1,W=$.length;while(++Q<W)if($[Q]===Z)return Q;return-1}function AV($){return $!==$}function NV($,Z){var Y=-1,Q=Array($);while(++Y<$)Q[Y]=Z(Y);return Q}function LV($,Z){return wV(Z,function(Y){return $[Y]})}function OV($,Z){return function(Y){return $(Z(Y))}}var J9=Object.prototype,DQ=J9.hasOwnProperty,z9=J9.toString,FV=J9.propertyIsEnumerable,PV=OV(Object.keys,Object),KV=Math.max;function RV($,Z){var Y=zS($)||EV($)?NV($.length,String):[],Q=Y.length,W=!!Q;for(var X in $)if((Z||DQ.call($,X))&&!(W&&(X=="length"||CV(X,Q))))Y.push(X);return Y}function jV($){if(!_V($))return PV($);var Z=[];for(var Y in Object($))if(DQ.call($,Y)&&Y!="constructor")Z.push(Y);return Z}function CV($,Z){return Z=Z==null?JS:Z,!!Z&&(typeof $=="number"||MV.test($))&&($>-1&&$%1==0&&$<Z)}function _V($){var Z=$&&$.constructor,Y=typeof Z=="function"&&Z.prototype||J9;return $===Y}function VV($,Z,Y,Q){$=AQ($)?$:dV($),Y=Y&&!Q?fV(Y):0;var W=$.length;if(Y<0)Y=KV(W+Y,0);return xV($)?Y<=W&&$.indexOf(Z,Y)>-1:!!W&&DV($,Z,Y)>-1}function EV($){return IV($)&&DQ.call($,"callee")&&(!FV.call($,"callee")||z9.call($)==QV)}var zS=Array.isArray;function AQ($){return $!=null&&bV($.length)&&!TV($)}function IV($){return NQ($)&&AQ($)}function TV($){var Z=HQ($)?z9.call($):"";return Z==WV||Z==XV}function bV($){return typeof $=="number"&&$>-1&&$%1==0&&$<=JS}function HQ($){var Z=typeof $;return!!$&&(Z=="object"||Z=="function")}function NQ($){return!!$&&typeof $=="object"}function xV($){return typeof $=="string"||!zS($)&&NQ($)&&z9.call($)==JV}function kV($){return typeof $=="symbol"||NQ($)&&z9.call($)==zV}function gV($){if(!$)return $===0?$:0;if($=yV($),$===WS||$===-WS){var Z=$<0?-1:1;return Z*YV}return $===$?$:0}function fV($){var Z=gV($),Y=Z%1;return Z===Z?Y?Z-Y:Z:0}function yV($){if(typeof $=="number")return $;if(kV($))return XS;if(HQ($)){var Z=typeof $.valueOf=="function"?$.valueOf():$;$=HQ(Z)?Z+"":Z}if(typeof $!="string")return $===0?$:+$;$=$.replace(UV,"");var Y=qV.test($);return Y||GV.test($)?BV($.slice(2),Y?2:8):SV.test($)?XS:+$}function vV($){return AQ($)?RV($):jV($)}function dV($){return $?LV($,vV($)):[]}US.exports=VV});var GS=C((Lt,qS)=>{var hV="[object Boolean]",mV=Object.prototype,uV=mV.toString;function cV($){return $===!0||$===!1||pV($)&&uV.call($)==hV}function pV($){return!!$&&typeof $=="object"}qS.exports=cV});var DS=C((Ot,HS)=>{var MS=1/0,iV=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,BS=NaN,lV="[object Symbol]",nV=/^\s+|\s+$/g,oV=/^[-+]0x[0-9a-f]+$/i,tV=/^0b[01]+$/i,sV=/^0o[0-7]+$/i,rV=parseInt,aV=Object.prototype,eV=aV.toString;function $E($){return typeof $=="number"&&$==WE($)}function wS($){var Z=typeof $;return!!$&&(Z=="object"||Z=="function")}function ZE($){return!!$&&typeof $=="object"}function YE($){return typeof $=="symbol"||ZE($)&&eV.call($)==lV}function QE($){if(!$)return $===0?$:0;if($=XE($),$===MS||$===-MS){var Z=$<0?-1:1;return Z*iV}return $===$?$:0}function WE($){var Z=QE($),Y=Z%1;return Z===Z?Y?Z-Y:Z:0}function XE($){if(typeof $=="number")return $;if(YE($))return BS;if(wS($)){var Z=typeof $.valueOf=="function"?$.valueOf():$;$=wS(Z)?Z+"":Z}if(typeof $!="string")return $===0?$:+$;$=$.replace(nV,"");var Y=tV.test($);return Y||sV.test($)?rV($.slice(2),Y?2:8):oV.test($)?BS:+$}HS.exports=$E});var NS=C((Ft,AS)=>{var JE="[object Number]",zE=Object.prototype,UE=zE.toString;function SE($){return!!$&&typeof $=="object"}function qE($){return typeof $=="number"||SE($)&&UE.call($)==JE}AS.exports=qE});var PS=C((Pt,FS)=>{var GE="[object Object]";function ME($){var Z=!1;if($!=null&&typeof $.toString!="function")try{Z=!!($+"")}catch(Y){}return Z}function BE($,Z){return function(Y){return $(Z(Y))}}var wE=Function.prototype,LS=Object.prototype,OS=wE.toString,HE=LS.hasOwnProperty,DE=OS.call(Object),AE=LS.toString,NE=BE(Object.getPrototypeOf,Object);function LE($){return!!$&&typeof $=="object"}function OE($){if(!LE($)||AE.call($)!=GE||ME($))return!1;var Z=NE($);if(Z===null)return!0;var Y=HE.call(Z,"constructor")&&Z.constructor;return typeof Y=="function"&&Y instanceof Y&&OS.call(Y)==DE}FS.exports=OE});var RS=C((Kt,KS)=>{var FE="[object String]",PE=Object.prototype,KE=PE.toString,RE=Array.isArray;function jE($){return!!$&&typeof $=="object"}function CE($){return typeof $=="string"||!RE($)&&jE($)&&KE.call($)==FE}KS.exports=CE});var ES=C((Rt,VS)=>{var _E="Expected a function",jS=1/0,VE=179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,CS=NaN,EE="[object Symbol]",IE=/^\s+|\s+$/g,TE=/^[-+]0x[0-9a-f]+$/i,bE=/^0b[01]+$/i,xE=/^0o[0-7]+$/i,kE=parseInt,gE=Object.prototype,fE=gE.toString;function yE($,Z){var Y;if(typeof Z!="function")throw new TypeError(_E);return $=uE($),function(){if(--$>0)Y=Z.apply(this,arguments);if($<=1)Z=void 0;return Y}}function vE($){return yE(2,$)}function _S($){var Z=typeof $;return!!$&&(Z=="object"||Z=="function")}function dE($){return!!$&&typeof $=="object"}function hE($){return typeof $=="symbol"||dE($)&&fE.call($)==EE}function mE($){if(!$)return $===0?$:0;if($=cE($),$===jS||$===-jS){var Z=$<0?-1:1;return Z*VE}return $===$?$:0}function uE($){var Z=mE($),Y=Z%1;return Z===Z?Y?Z-Y:Z:0}function cE($){if(typeof $=="number")return $;if(hE($))return CS;if(_S($)){var Z=typeof $.valueOf=="function"?$.valueOf():$;$=_S(Z)?Z+"":Z}if(typeof $!="string")return $===0?$:+$;$=$.replace(IE,"");var Y=bE.test($);return Y||xE.test($)?kE($.slice(2),Y?2:8):TE.test($)?CS:+$}VS.exports=vE});var vS=C((jt,yS)=>{var IS=s5(),pE=MQ(),iE=GQ(),TS=cY(),lE=SS(),U9=GS(),bS=DS(),LQ=NS(),kS=PS(),o8=RS(),nE=ES(),{KeyObject:oE,createSecretKey:tE,createPrivateKey:sE}=U1("crypto"),gS=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];if(pE)gS.splice(3,0,"PS256","PS384","PS512");var rE={expiresIn:{isValid:function($){return bS($)||o8($)&&$},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function($){return bS($)||o8($)&&$},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function($){return o8($)||Array.isArray($)},message:'"audience" must be a string or array'},algorithm:{isValid:lE.bind(null,gS),message:'"algorithm" must be a valid string enum value'},header:{isValid:kS,message:'"header" must be an object'},encoding:{isValid:o8,message:'"encoding" must be a string'},issuer:{isValid:o8,message:'"issuer" must be a string'},subject:{isValid:o8,message:'"subject" must be a string'},jwtid:{isValid:o8,message:'"jwtid" must be a string'},noTimestamp:{isValid:U9,message:'"noTimestamp" must be a boolean'},keyid:{isValid:o8,message:'"keyid" must be a string'},mutatePayload:{isValid:U9,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:U9,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:U9,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},aE={iat:{isValid:LQ,message:'"iat" should be a number of seconds'},exp:{isValid:LQ,message:'"exp" should be a number of seconds'},nbf:{isValid:LQ,message:'"nbf" should be a number of seconds'}};function fS($,Z,Y,Q){if(!kS(Y))throw new Error('Expected "'+Q+'" to be a plain object.');Object.keys(Y).forEach(function(W){let X=$[W];if(!X){if(!Z)throw new Error('"'+W+'" is not allowed in "'+Q+'"');return}if(!X.isValid(Y[W]))throw new Error(X.message)})}function eE($){return fS(rE,!1,$,"options")}function $3($){return fS(aE,!0,$,"payload")}var xS={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},Z3=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];yS.exports=function($,Z,Y,Q){if(typeof Y==="function")Q=Y,Y={};else Y=Y||{};let W=typeof $==="object"&&!Buffer.isBuffer($),X=Object.assign({alg:Y.algorithm||"HS256",typ:W?"JWT":void 0,kid:Y.keyid},Y.header);function J(S){if(Q)return Q(S);throw S}if(!Z&&Y.algorithm!=="none")return J(new Error("secretOrPrivateKey must have a value"));if(Z!=null&&!(Z instanceof oE))try{Z=sE(Z)}catch(S){try{Z=tE(typeof Z==="string"?Buffer.from(Z):Z)}catch(q){return J(new Error("secretOrPrivateKey is not valid key material"))}}if(X.alg.startsWith("HS")&&Z.type!=="secret")return J(new Error(`secretOrPrivateKey must be a symmetric key when using ${X.alg}`));else if(/^(?:RS|PS|ES)/.test(X.alg)){if(Z.type!=="private")return J(new Error(`secretOrPrivateKey must be an asymmetric key when using ${X.alg}`));if(!Y.allowInsecureKeySizes&&!X.alg.startsWith("ES")&&Z.asymmetricKeyDetails!==void 0&&Z.asymmetricKeyDetails.modulusLength<2048)return J(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${X.alg}`))}if(typeof $==="undefined")return J(new Error("payload is required"));else if(W){try{$3($)}catch(S){return J(S)}if(!Y.mutatePayload)$=Object.assign({},$)}else{let S=Z3.filter(function(q){return typeof Y[q]!=="undefined"});if(S.length>0)return J(new Error("invalid "+S.join(",")+" option for "+typeof $+" payload"))}if(typeof $.exp!=="undefined"&&typeof Y.expiresIn!=="undefined")return J(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof $.nbf!=="undefined"&&typeof Y.notBefore!=="undefined")return J(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{eE(Y)}catch(S){return J(S)}if(!Y.allowInvalidAsymmetricKeyTypes)try{iE(X.alg,Z)}catch(S){return J(S)}let z=$.iat||Math.floor(Date.now()/1000);if(Y.noTimestamp)delete $.iat;else if(W)$.iat=z;if(typeof Y.notBefore!=="undefined"){try{$.nbf=IS(Y.notBefore,z)}catch(S){return J(S)}if(typeof $.nbf==="undefined")return J(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof Y.expiresIn!=="undefined"&&typeof $==="object"){try{$.exp=IS(Y.expiresIn,z)}catch(S){return J(S)}if(typeof $.exp==="undefined")return J(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(xS).forEach(function(S){let q=xS[S];if(typeof Y[S]!=="undefined"){if(typeof $[q]!=="undefined")return J(new Error('Bad "options.'+S+'" option. The payload already has an "'+q+'" property.'));$[q]=Y[S]}});let U=Y.encoding||"utf8";if(typeof Q==="function")Q=Q&&nE(Q),TS.createSign({header:X,privateKey:Z,payload:$,encoding:U}).once("error",Q).once("done",function(S){if(!Y.allowInsecureKeySizes&&/^(?:RS|PS)/.test(X.alg)&&S.length<256)return Q(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${X.alg}`));Q(null,S)});else{let S=TS.sign({header:X,payload:$,secret:Z,encoding:U});if(!Y.allowInsecureKeySizes&&/^(?:RS|PS)/.test(X.alg)&&S.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${X.alg}`);return S}}});var hS=C((Ct,dS)=>{dS.exports={decode:n5(),verify:QS(),sign:vS(),JsonWebTokenError:YZ(),NotBeforeError:o5(),TokenExpiredError:t5()}});var mS=C((Vt,Y3)=>{Y3.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var B$=C((Y6)=>{var Q3=Y6&&Y6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(Y6,"__esModule",{value:!0});Y6.getKeyIndexes=Y6.hasFlag=Y6.exists=Y6.list=void 0;var S9=Q3(mS());Y6.list=Object.keys(S9.default);var OQ={};Y6.list.forEach(($)=>{OQ[$]=S9.default[$].flags.reduce(function(Z,Y){return Z[Y]=!0,Z},{})});function W3($){return Boolean(S9.default[$])}Y6.exists=W3;function X3($,Z){if(!OQ[$])throw new Error("Unknown command "+$);return Boolean(OQ[$][Z])}Y6.hasFlag=X3;function J3($,Z,Y){let Q=S9.default[$];if(!Q)throw new Error("Unknown command "+$);if(!Array.isArray(Z))throw new Error("Expect args to be an array");let W=[],X=Boolean(Y&&Y.parseExternalKey),J=(U,S)=>{let q=[],M=Number(U[S]);for(let H=0;H<M;H++)q.push(H+S+1);return q},z=(U,S,q)=>{for(let M=S;M<U.length-1;M+=1)if(String(U[M]).toLowerCase()===q.toLowerCase())return M+1;return null};switch($){case"zunionstore":case"zinterstore":case"zdiffstore":W.push(0,...J(Z,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":W.push(...J(Z,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{W.push(...J(Z,0));break}case"georadius":{W.push(0);let U=z(Z,5,"STORE");if(U)W.push(U);let S=z(Z,5,"STOREDIST");if(S)W.push(S);break}case"georadiusbymember":{W.push(0);let U=z(Z,4,"STORE");if(U)W.push(U);let S=z(Z,4,"STOREDIST");if(S)W.push(S);break}case"sort":case"sort_ro":W.push(0);for(let U=1;U<Z.length-1;U++){let S=Z[U];if(typeof S!=="string")continue;let q=S.toUpperCase();if(q==="GET"){if(U+=1,S=Z[U],S!=="#")if(X)W.push([U,uS(S)]);else W.push(U)}else if(q==="BY")if(U+=1,X)W.push([U,uS(Z[U])]);else W.push(U);else if(q==="STORE")U+=1,W.push(U)}break;case"migrate":if(Z[2]==="")for(let U=5;U<Z.length-1;U++){let S=Z[U];if(typeof S==="string"&&S.toUpperCase()==="KEYS"){for(let q=U+1;q<Z.length;q++)W.push(q);break}}else W.push(2);break;case"xreadgroup":case"xread":for(let U=$==="xread"?0:3;U<Z.length-1;U++)if(String(Z[U]).toUpperCase()==="STREAMS"){for(let S=U+1;S<=U+(Z.length-1-U)/2;S++)W.push(S);break}break;default:if(Q.step>0){let U=Q.keyStart-1,S=Q.keyStop>0?Q.keyStop:Z.length+Q.keyStop+1;for(let q=U;q<S;q+=Q.step)W.push(q)}break}return W}Y6.getKeyIndexes=J3;function uS($){if(typeof $!=="string")$=String($);let Z=$.indexOf("->");return Z===-1?$.length:Z}});var iS=C((cS)=>{Object.defineProperty(cS,"__esModule",{value:!0});cS.tryCatch=cS.errorObj=void 0;cS.errorObj={e:{}};var FQ;function z3($,Z){try{let Y=FQ;return FQ=null,Y.apply(this,arguments)}catch(Y){return cS.errorObj.e=Y,cS.errorObj}}function U3($){return FQ=$,z3}cS.tryCatch=U3});var s8=C((nS)=>{Object.defineProperty(nS,"__esModule",{value:!0});var w$=iS();function lS($){setTimeout(function(){throw $},0)}function S3($,Z,Y){if(typeof Z==="function")$.then((Q)=>{let W;if(Y!==void 0&&Object(Y).spread&&Array.isArray(Q))W=w$.tryCatch(Z).apply(void 0,[null].concat(Q));else W=Q===void 0?w$.tryCatch(Z)(null):w$.tryCatch(Z)(null,Q);if(W===w$.errorObj)lS(W.e)},(Q)=>{if(!Q){let X=new Error(Q+"");Object.assign(X,{cause:Q}),Q=X}let W=w$.tryCatch(Z)(Q);if(W===w$.errorObj)lS(W.e)});return $}nS.default=S3});var sS=C((bt,tS)=>{var oS=U1("assert"),GZ=U1("util");function H$($){Object.defineProperty(this,"message",{value:$||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}GZ.inherits(H$,Error);Object.defineProperty(H$.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function KQ($,Z,Y){oS(Z),oS.strictEqual(typeof Y,"number"),Object.defineProperty(this,"message",{value:$||"",configurable:!0,writable:!0});let Q=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=Q,this.offset=Y,this.buffer=Z}GZ.inherits(KQ,H$);Object.defineProperty(KQ.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function RQ($){Object.defineProperty(this,"message",{value:$||"",configurable:!0,writable:!0});let Z=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=Z}GZ.inherits(RQ,H$);Object.defineProperty(RQ.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function q9($){Object.defineProperty(this,"message",{value:$||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}GZ.inherits(q9,H$);Object.defineProperty(q9.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function jQ($){Object.defineProperty(this,"message",{value:$||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}GZ.inherits(jQ,q9);Object.defineProperty(jQ.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});tS.exports={RedisError:H$,ParserError:KQ,ReplyError:RQ,AbortError:q9,InterruptError:jQ}});var Yq=C((xt,Zq)=>{var rS=U1("assert");class MZ extends Error{get name(){return this.constructor.name}}class aS extends MZ{constructor($,Z,Y){rS(Z),rS.strictEqual(typeof Y,"number");let Q=Error.stackTraceLimit;Error.stackTraceLimit=2;super($);Error.stackTraceLimit=Q,this.offset=Y,this.buffer=Z}get name(){return this.constructor.name}}class eS extends MZ{constructor($){let Z=Error.stackTraceLimit;Error.stackTraceLimit=2;super($);Error.stackTraceLimit=Z}get name(){return this.constructor.name}}class CQ extends MZ{get name(){return this.constructor.name}}class $q extends CQ{get name(){return this.constructor.name}}Zq.exports={RedisError:MZ,ParserError:aS,ReplyError:eS,AbortError:CQ,InterruptError:$q}});var R4=C((kt,Qq)=>{var G3=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?sS():Yq();Qq.exports=G3});var BZ=C((gt,_Q)=>{var Wq=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],M3=function $(Z){var Y,Q=0,W=0,X=[],J=Z.length;for(;Q<J;Q++)if(Y=Z.charCodeAt(Q),Y<128)X[W++]=Y;else if(Y<2048)X[W++]=Y>>6|192,X[W++]=Y&63|128;else if((Y&64512)===55296&&Q+1<Z.length&&(Z.charCodeAt(Q+1)&64512)===56320)Y=65536+((Y&1023)<<10)+(Z.charCodeAt(++Q)&1023),X[W++]=Y>>18|240,X[W++]=Y>>12&63|128,X[W++]=Y>>6&63|128,X[W++]=Y&63|128;else X[W++]=Y>>12|224,X[W++]=Y>>6&63|128,X[W++]=Y&63|128;return X},Xq=_Q.exports=function $(Z){var Y,Q=0,W=-1,X=0,J=0,z=typeof Z==="string"?M3(Z):Z,U=z.length;while(Q<U){if(Y=z[Q++],W===-1){if(Y===123)W=Q}else if(Y!==125)J=Wq[(Y^J>>8)&255]^J<<8;else if(Q-1!==W)return J&16383;X=Wq[(Y^X>>8)&255]^X<<8}return X&16383};_Q.exports.generateMulti=function $(Z){var Y=1,Q=Z.length,W=Xq(Z[0]);while(Y<Q)if(Xq(Z[Y++])!==W)return-1;return W}});var Bq=C((ft,Mq)=>{var zq=9007199254740991,B3="[object Arguments]",w3="[object Function]",H3="[object GeneratorFunction]",D3=/^(?:0|[1-9]\d*)$/;function Uq($,Z,Y){switch(Y.length){case 0:return $.call(Z);case 1:return $.call(Z,Y[0]);case 2:return $.call(Z,Y[0],Y[1]);case 3:return $.call(Z,Y[0],Y[1],Y[2])}return $.apply(Z,Y)}function A3($,Z){var Y=-1,Q=Array($);while(++Y<$)Q[Y]=Z(Y);return Q}var wZ=Object.prototype,HZ=wZ.hasOwnProperty,Sq=wZ.toString,N3=wZ.propertyIsEnumerable,Jq=Math.max;function L3($,Z){var Y=E3($)||V3($)?A3($.length,String):[],Q=Y.length,W=!!Q;for(var X in $)if((Z||HZ.call($,X))&&!(W&&(X=="length"||Gq(X,Q))))Y.push(X);return Y}function O3($,Z,Y,Q){if($===void 0||VQ($,wZ[Y])&&!HZ.call(Q,Y))return Z;return $}function F3($,Z,Y){var Q=$[Z];if(!(HZ.call($,Z)&&VQ(Q,Y))||Y===void 0&&!(Z in $))$[Z]=Y}function P3($){if(!IQ($))return _3($);var Z=C3($),Y=[];for(var Q in $)if(!(Q=="constructor"&&(Z||!HZ.call($,Q))))Y.push(Q);return Y}function qq($,Z){return Z=Jq(Z===void 0?$.length-1:Z,0),function(){var Y=arguments,Q=-1,W=Jq(Y.length-Z,0),X=Array(W);while(++Q<W)X[Q]=Y[Z+Q];Q=-1;var J=Array(Z+1);while(++Q<Z)J[Q]=Y[Q];return J[Z]=X,Uq($,this,J)}}function K3($,Z,Y,Q){Y||(Y={});var W=-1,X=Z.length;while(++W<X){var J=Z[W],z=Q?Q(Y[J],$[J],J,Y,$):void 0;F3(Y,J,z===void 0?$[J]:z)}return Y}function R3($){return qq(function(Z,Y){var Q=-1,W=Y.length,X=W>1?Y[W-1]:void 0,J=W>2?Y[2]:void 0;if(X=$.length>3&&typeof X=="function"?(W--,X):void 0,J&&j3(Y[0],Y[1],J))X=W<3?void 0:X,W=1;Z=Object(Z);while(++Q<W){var z=Y[Q];if(z)$(Z,z,Q,X)}return Z})}function Gq($,Z){return Z=Z==null?zq:Z,!!Z&&(typeof $=="number"||D3.test($))&&($>-1&&$%1==0&&$<Z)}function j3($,Z,Y){if(!IQ(Y))return!1;var Q=typeof Z;if(Q=="number"?EQ(Y)&&Gq(Z,Y.length):Q=="string"&&(Z in Y))return VQ(Y[Z],$);return!1}function C3($){var Z=$&&$.constructor,Y=typeof Z=="function"&&Z.prototype||wZ;return $===Y}function _3($){var Z=[];if($!=null)for(var Y in Object($))Z.push(Y);return Z}function VQ($,Z){return $===Z||$!==$&&Z!==Z}function V3($){return I3($)&&HZ.call($,"callee")&&(!N3.call($,"callee")||Sq.call($)==B3)}var E3=Array.isArray;function EQ($){return $!=null&&b3($.length)&&!T3($)}function I3($){return x3($)&&EQ($)}function T3($){var Z=IQ($)?Sq.call($):"";return Z==w3||Z==H3}function b3($){return typeof $=="number"&&$>-1&&$%1==0&&$<=zq}function IQ($){var Z=typeof $;return!!$&&(Z=="object"||Z=="function")}function x3($){return!!$&&typeof $=="object"}var k3=R3(function($,Z,Y,Q){K3(Z,f3(Z),$,Q)}),g3=qq(function($){return $.push(void 0,O3),Uq(k3,void 0,$)});function f3($){return EQ($)?L3($,!0):P3($)}Mq.exports=g3});var Dq=C((yt,Hq)=>{var y3=9007199254740991,v3="[object Arguments]",d3="[object Function]",h3="[object GeneratorFunction]",TQ=Object.prototype,m3=TQ.hasOwnProperty,wq=TQ.toString,u3=TQ.propertyIsEnumerable;function c3($){return i3($)&&m3.call($,"callee")&&(!u3.call($,"callee")||wq.call($)==v3)}function p3($){return $!=null&&n3($.length)&&!l3($)}function i3($){return t3($)&&p3($)}function l3($){var Z=o3($)?wq.call($):"";return Z==d3||Z==h3}function n3($){return typeof $=="number"&&$>-1&&$%1==0&&$<=y3}function o3($){var Z=typeof $;return!!$&&(Z=="object"||Z=="function")}function t3($){return!!$&&typeof $=="object"}Hq.exports=c3});var G9=C((Aq)=>{Object.defineProperty(Aq,"__esModule",{value:!0});Aq.isArguments=Aq.defaults=Aq.noop=void 0;var s3=Bq();Aq.defaults=s3;var r3=Dq();Aq.isArguments=r3;function a3(){}Aq.noop=a3});var Kq=C((Fq)=>{Object.defineProperty(Fq,"__esModule",{value:!0});Fq.genRedactedString=Fq.getStringValue=Fq.MAX_ARGUMENT_LENGTH=void 0;var YI=ZI(),bQ=200;Fq.MAX_ARGUMENT_LENGTH=bQ;var QI="ioredis";function Lq($){if($===null)return;switch(typeof $){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer($))return $.toString("hex");if(Array.isArray($))return $.join(",");try{return JSON.stringify($)}catch(Z){return}case"string":return $}}Fq.getStringValue=Lq;function Oq($,Z){let{length:Y}=$;return Y<=Z?$:$.slice(0,Z)+' ... <REDACTED full-length="'+Y+'">'}Fq.genRedactedString=Oq;function WI($){let Z=YI.default(`${QI}:${$}`);function Y(...Q){if(!Z.enabled)return;for(let W=1;W<Q.length;W++){let X=Lq(Q[W]);if(typeof X==="string"&&X.length>bQ)Q[W]=Oq(X,bQ)}return Z.apply(null,Q)}return Object.defineProperties(Y,{namespace:{get(){return Z.namespace}},enabled:{get(){return Z.enabled}},destroy:{get(){return Z.destroy}},log:{get(){return Z.log},set(Q){Z.log=Q}}}),Y}Fq.default=WI});var Cq=C((jq)=>{Object.defineProperty(jq,"__esModule",{value:!0});var Rq=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,UI={RedisCloudFixed:{ca:Rq},RedisCloudFlexible:{ca:Rq}};jq.default=UI});var B0=C((M9)=>{Object.defineProperty(M9,"__esModule",{value:!0});M9.noop=M9.defaults=M9.Debug=M9.zipMap=M9.CONNECTION_CLOSED_ERROR_MSG=M9.shuffle=M9.sample=M9.resolveTLSProfile=M9.parseURL=M9.optimizeErrorStack=M9.toArg=M9.convertMapToArray=M9.convertObjectToArray=M9.timeout=M9.packObject=M9.isInt=M9.wrapMultiResult=M9.convertBufferToString=void 0;var _q=U1("url"),xQ=G9();Object.defineProperty(M9,"defaults",{enumerable:!0,get:function(){return xQ.defaults}});Object.defineProperty(M9,"noop",{enumerable:!0,get:function(){return xQ.noop}});var qI=Kq();M9.Debug=qI.default;var GI=Cq();function Vq($,Z){if($ instanceof Buffer)return $.toString(Z);if(Array.isArray($)){let Y=$.length,Q=Array(Y);for(let W=0;W<Y;++W)Q[W]=$[W]instanceof Buffer&&Z==="utf8"?$[W].toString():Vq($[W],Z);return Q}return $}M9.convertBufferToString=Vq;function MI($){if(!$)return null;let Z=[],Y=$.length;for(let Q=0;Q<Y;++Q){let W=$[Q];if(W instanceof Error)Z.push([W]);else Z.push([null,W])}return Z}M9.wrapMultiResult=MI;function Eq($){let Z=parseFloat($);return!isNaN($)&&(Z|0)===Z}M9.isInt=Eq;function BI($){let Z={},Y=$.length;for(let Q=1;Q<Y;Q+=2)Z[$[Q-1]]=$[Q];return Z}M9.packObject=BI;function wI($,Z){let Y=null,Q=function(){if(Y)clearTimeout(Y),Y=null,$.apply(this,arguments)};return Y=setTimeout(Q,Z,new Error("timeout")),Q}M9.timeout=wI;function HI($){let Z=[],Y=Object.keys($);for(let Q=0,W=Y.length;Q<W;Q++)Z.push(Y[Q],$[Y[Q]]);return Z}M9.convertObjectToArray=HI;function DI($){let Z=[],Y=0;return $.forEach(function(Q,W){Z[Y]=W,Z[Y+1]=Q,Y+=2}),Z}M9.convertMapToArray=DI;function AI($){if($===null||typeof $==="undefined")return"";return String($)}M9.toArg=AI;function NI($,Z,Y){let Q=Z.split(`
`),W="",X;for(X=1;X<Q.length;++X)if(Q[X].indexOf(Y)===-1)break;for(let J=X;J<Q.length;++J)W+=`
`+Q[J];if($.stack){let J=$.stack.indexOf(`
`);$.stack=$.stack.slice(0,J)+W}return $}M9.optimizeErrorStack=NI;function LI($){if(Eq($))return{port:$};let Z=_q.parse($,!0,!0);if(!Z.slashes&&$[0]!=="/")$="//"+$,Z=_q.parse($,!0,!0);let Y=Z.query||{},Q={};if(Z.auth){let W=Z.auth.indexOf(":");Q.username=W===-1?Z.auth:Z.auth.slice(0,W),Q.password=W===-1?"":Z.auth.slice(W+1)}if(Z.pathname)if(Z.protocol==="redis:"||Z.protocol==="rediss:"){if(Z.pathname.length>1)Q.db=Z.pathname.slice(1)}else Q.path=Z.pathname;if(Z.host)Q.host=Z.hostname;if(Z.port)Q.port=Z.port;if(typeof Y.family==="string"){let W=Number.parseInt(Y.family,10);if(!Number.isNaN(W))Q.family=W}return xQ.defaults(Q,Y),Q}M9.parseURL=LI;function OI($){let Z=$===null||$===void 0?void 0:$.tls;if(typeof Z==="string")Z={profile:Z};let Y=GI.default[Z===null||Z===void 0?void 0:Z.profile];if(Y)Z=Object.assign({},Y,Z),delete Z.profile,$=Object.assign({},$,{tls:Z});return $}M9.resolveTLSProfile=OI;function FI($,Z=0){let Y=$.length;if(Z>=Y)return null;return $[Z+Math.floor(Math.random()*(Y-Z))]}M9.sample=FI;function PI($){let Z=$.length;while(Z>0){let Y=Math.floor(Math.random()*Z);Z--,[$[Z],$[Y]]=[$[Y],$[Z]]}return $}M9.shuffle=PI;M9.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function KI($,Z){let Y=new Map;return $.forEach((Q,W)=>{Y.set(Q,Z[W])}),Y}M9.zipMap=KI});var R8=C((kq)=>{var __dirname="C:\\Users\\Eray\\Desktop\\misy\\Server\\[Elysia - Bun] Lessons\\node_modules\\ioredis\\built";Object.defineProperty(kq,"__esModule",{value:!0});var Iq=B$(),mI=BZ(),uI=s8(),j4=B0();class Q6{constructor($,Z=[],Y={},Q){if(this.name=$,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=Y.replyEncoding,this.errorStack=Y.errorStack,this.args=Z.flat(),this.callback=Q,this.initPromise(),Y.keyPrefix){let W=Y.keyPrefix instanceof Buffer,X=W?Y.keyPrefix:null;this._iterateKeys((J)=>{if(J instanceof Buffer){if(X===null)X=Buffer.from(Y.keyPrefix);return Buffer.concat([X,J])}else if(W)return Buffer.concat([Y.keyPrefix,Buffer.from(String(J))]);return Y.keyPrefix+J})}if(Y.readOnly)this.isReadOnly=!0}static checkFlag($,Z){return!!this.getFlagMap()[$][Z]}static setArgumentTransformer($,Z){this._transformer.argument[$]=Z}static setReplyTransformer($,Z){this._transformer.reply[$]=Z}static getFlagMap(){if(!this.flagMap)this.flagMap=Object.keys(Q6.FLAGS).reduce(($,Z)=>{return $[Z]={},Q6.FLAGS[Z].forEach((Y)=>{$[Z][Y]=!0}),$},{});return this.flagMap}getSlot(){if(typeof this.slot==="undefined"){let $=this.getKeys()[0];this.slot=$==null?null:mI($)}return this.slot}getKeys(){return this._iterateKeys()}toWritable($){let Z,Y="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let Q=new xq;Q.push(Y);for(let W=0;W<this.args.length;++W){let X=this.args[W];if(X instanceof Buffer)if(X.length===0)Q.push(`$0\r
\r
`);else Q.push("$"+X.length+`\r
`),Q.push(X),Q.push(`\r
`);else Q.push("$"+Buffer.byteLength(X)+`\r
`+X+`\r
`)}Z=Q.toBuffer()}else{Z=Y;for(let Q=0;Q<this.args.length;++Q){let W=this.args[Q];Z+="$"+Buffer.byteLength(W)+`\r
`+W+`\r
`}}return Z}stringifyArguments(){for(let $=0;$<this.args.length;++$){let Z=this.args[$];if(typeof Z==="string");else if(Z instanceof Buffer)this.bufferMode=!0;else this.args[$]=j4.toArg(Z)}}transformReply($){if(this.replyEncoding)$=j4.convertBufferToString($,this.replyEncoding);let Z=Q6._transformer.reply[this.name];if(Z)$=Z($);return $}setTimeout($){if(!this._commandTimeoutTimer)this._commandTimeoutTimer=setTimeout(()=>{if(!this.isResolved)this.reject(new Error("Command timed out"))},$)}initPromise(){let $=new Promise((Z,Y)=>{if(!this.transformed){this.transformed=!0;let Q=Q6._transformer.argument[this.name];if(Q)this.args=Q(this.args);this.stringifyArguments()}if(this.resolve=this._convertValue(Z),this.errorStack)this.reject=(Q)=>{Y(j4.optimizeErrorStack(Q,this.errorStack.stack,__dirname))};else this.reject=Y});this.promise=uI.default($,this.callback)}_iterateKeys($=(Z)=>Z){if(typeof this.keys==="undefined"){if(this.keys=[],Iq.exists(this.name)){let Z=Iq.getKeyIndexes(this.name,this.args);for(let Y of Z)this.args[Y]=$(this.args[Y]),this.keys.push(this.args[Y])}}return this.keys}_convertValue($){return(Z)=>{try{let Y=this._commandTimeoutTimer;if(Y)clearTimeout(Y),delete this._commandTimeoutTimer;$(this.transformReply(Z)),this.isResolved=!0}catch(Y){this.reject(Y)}return this.promise}}}kq.default=Q6;Q6.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]};Q6._transformer={argument:{},reply:{}};var Tq=function($){if($.length===1){if($[0]instanceof Map)return j4.convertMapToArray($[0]);if(typeof $[0]==="object"&&$[0]!==null)return j4.convertObjectToArray($[0])}return $},bq=function($){if($.length===2){if($[1]instanceof Map)return[$[0]].concat(j4.convertMapToArray($[1]));if(typeof $[1]==="object"&&$[1]!==null)return[$[0]].concat(j4.convertObjectToArray($[1]))}return $};Q6.setArgumentTransformer("mset",Tq);Q6.setArgumentTransformer("msetnx",Tq);Q6.setArgumentTransformer("hset",bq);Q6.setArgumentTransformer("hmset",bq);Q6.setReplyTransformer("hgetall",function($){if(Array.isArray($)){let Z={};for(let Y=0;Y<$.length;Y+=2){let Q=$[Y],W=$[Y+1];if(Q in Z)Object.defineProperty(Z,Q,{value:W,configurable:!0,enumerable:!0,writable:!0});else Z[Q]=W}return Z}return $});class xq{constructor(){this.length=0,this.items=[]}push($){this.length+=Buffer.byteLength($),this.items.push($)}toBuffer(){let $=Buffer.allocUnsafe(this.length),Z=0;for(let Y of this.items){let Q=Buffer.byteLength(Y);Buffer.isBuffer(Y)?Y.copy($,Z):$.write(Y,Z,Q),Z+=Q}return $}}});var fq=C((gq)=>{Object.defineProperty(gq,"__esModule",{value:!0});var pI=R4();class kQ extends pI.RedisError{constructor($,Z){super($);this.lastNodeError=Z,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}gq.default=kQ;kQ.defaultMessage="Failed to refresh slots cache."});var B9=C((vq)=>{Object.defineProperty(vq,"__esModule",{value:!0});var lI=U1("stream");class yq extends lI.Readable{constructor($){super($);this.opt=$,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let $=[this._redisCursor];if(this.opt.key)$.unshift(this.opt.key);if(this.opt.match)$.push("MATCH",this.opt.match);if(this.opt.type)$.push("TYPE",this.opt.type);if(this.opt.count)$.push("COUNT",String(this.opt.count));if(this.opt.noValues)$.push("NOVALUES");this.opt.redis[this.opt.command]($,(Z,Y)=>{if(Z){this.emit("error",Z);return}if(this._redisCursor=Y[0]instanceof Buffer?Y[0].toString():Y[0],this._redisCursor==="0")this._redisDrained=!0;this.push(Y[1])})}close(){this._redisDrained=!0}}vq.default=yq});var nq=C((pq)=>{Object.defineProperty(pq,"__esModule",{value:!0});pq.executeWithAutoPipelining=pq.getFirstValueInFlattenedArray=pq.shouldUseAutoPipelining=pq.notAllowedAutoPipelineCommands=pq.kCallbacks=pq.kExec=void 0;var hq=G9(),oI=BZ(),dq=s8();pq.kExec=Symbol("exec");pq.kCallbacks=Symbol("callbacks");pq.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"];function mq($,Z){if($._runningAutoPipelines.has(Z))return;if(!$._autoPipelines.has(Z))return;$._runningAutoPipelines.add(Z);let Y=$._autoPipelines.get(Z);$._autoPipelines.delete(Z);let Q=Y[pq.kCallbacks];Y[pq.kCallbacks]=null,Y.exec(function(W,X){if($._runningAutoPipelines.delete(Z),W)for(let J=0;J<Q.length;J++)process.nextTick(Q[J],W);else for(let J=0;J<Q.length;J++)process.nextTick(Q[J],...X[J]);if($._autoPipelines.has(Z))mq($,Z)})}function tI($,Z,Y){return Z&&$.options.enableAutoPipelining&&!$.isPipeline&&!pq.notAllowedAutoPipelineCommands.includes(Y)&&!$.options.autoPipeliningIgnoredCommands.includes(Y)}pq.shouldUseAutoPipelining=tI;function uq($){for(let Z=0;Z<$.length;Z++){let Y=$[Z];if(typeof Y==="string")return Y;else if(Array.isArray(Y)||hq.isArguments(Y)){if(Y.length===0)continue;return Y[0]}let Q=[Y].flat();if(Q.length>0)return Q[0]}return}pq.getFirstValueInFlattenedArray=uq;function cq($,Z,Y,Q,W){if($.isCluster&&!$.slots.length){if($.status==="wait")$.connect().catch(hq.noop);return dq.default(new Promise(function(S,q){$.delayUntilReady((M)=>{if(M){q(M);return}cq($,Z,Y,Q,null).then(S,q)})}),W)}let X=$.options.keyPrefix||"",J=$.isCluster?$.slots[oI(`${X}${uq(Q)}`)].join(","):"main";if(!$._autoPipelines.has(J)){let S=$.pipeline();S[pq.kExec]=!1,S[pq.kCallbacks]=[],$._autoPipelines.set(J,S)}let z=$._autoPipelines.get(J);if(!z[pq.kExec])z[pq.kExec]=!0,setImmediate(mq,$,J);let U=new Promise(function(S,q){if(z[pq.kCallbacks].push(function(M,H){if(M){q(M);return}S(H)}),Z==="call")Q.unshift(Y);z[Z](...Q)});return dq.default(U,W)}pq.executeWithAutoPipelining=cq});var sq=C((tq)=>{Object.defineProperty(tq,"__esModule",{value:!0});var aI=U1("crypto"),eI=R8(),$T=s8();class oq{constructor($,Z=null,Y="",Q=!1){this.lua=$,this.numberOfKeys=Z,this.keyPrefix=Y,this.readOnly=Q,this.sha=aI.createHash("sha1").update($).digest("hex");let W=this.sha,X=new WeakSet;this.Command=class J extends eI.default{toWritable(z){let U=this.reject;if(this.reject=(S)=>{if(S.message.indexOf("NOSCRIPT")!==-1)X.delete(z);U.call(this,S)},!X.has(z))X.add(z),this.name="eval",this.args[0]=$;else if(this.name==="eval")this.name="evalsha",this.args[0]=W;return super.toWritable(z)}}}execute($,Z,Y,Q){if(typeof this.numberOfKeys==="number")Z.unshift(this.numberOfKeys);if(this.keyPrefix)Y.keyPrefix=this.keyPrefix;if(this.readOnly)Y.readOnly=!0;let W=new this.Command("evalsha",[this.sha,...Z],Y);return W.promise=W.promise.catch((X)=>{if(X.message.indexOf("NOSCRIPT")===-1)throw X;let J=new this.Command("evalsha",[this.sha,...Z],Y);return($.isPipeline?$.redis:$).sendCommand(J)}),$T.default(W.promise,Q),$.sendCommand(W)}}tq.default=oq});var D9=C((aq)=>{Object.defineProperty(aq,"__esModule",{value:!0});var YT=B$(),H9=nq(),QT=R8(),WT=sq();class a8{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return gQ.slice(0)}createBuiltinCommand($){return{string:r8(null,$,"utf8"),buffer:r8(null,$,null)}}addBuiltinCommand($){this.addedBuiltinSet.add($),this[$]=r8($,$,"utf8"),this[$+"Buffer"]=r8($+"Buffer",$,null)}defineCommand($,Z){let Y=new WT.default(Z.lua,Z.numberOfKeys,this.options.keyPrefix,Z.readOnly);this.scriptsSet[$]=Y,this[$]=rq($,$,Y,"utf8"),this[$+"Buffer"]=rq($+"Buffer",$,Y,null)}sendCommand($,Z,Y){throw new Error('"sendCommand" is not implemented')}}var gQ=YT.list.filter(($)=>$!=="monitor");gQ.push("sentinel");gQ.forEach(function($){a8.prototype[$]=r8($,$,"utf8"),a8.prototype[$+"Buffer"]=r8($+"Buffer",$,null)});a8.prototype.call=r8("call","utf8");a8.prototype.callBuffer=r8("callBuffer",null);a8.prototype.send_command=a8.prototype.call;function r8($,Z,Y){if(typeof Y==="undefined")Y=Z,Z=null;return function(...Q){let W=Z||Q.shift(),X=Q[Q.length-1];if(typeof X==="function")Q.pop();else X=void 0;let J={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:Y};if(!H9.shouldUseAutoPipelining(this,$,W))return this.sendCommand(new QT.default(W,Q,J,X));return H9.executeWithAutoPipelining(this,$,W,Q,X)}}function rq($,Z,Y,Q){return function(...W){let X=typeof W[W.length-1]==="function"?W.pop():void 0,J={replyEncoding:Q};if(this.options.showFriendlyErrorStack)J.errorStack=new Error;if(!H9.shouldUseAutoPipelining(this,$,Z))return Y.execute(this,W,J,X);return H9.executeWithAutoPipelining(this,$,Z,W,X)}}aq.default=a8});var yQ=C((YG)=>{Object.defineProperty(YG,"__esModule",{value:!0});var fQ=BZ(),eq=B$(),$G=s8(),JT=U1("util"),zT=R8(),UT=B0(),ST=D9();function qT($,Z){let Y=fQ(Z[0]),Q=$._groupsBySlot[Y];for(let W=1;W<Z.length;W++)if($._groupsBySlot[fQ(Z[W])]!==Q)return-1;return Y}class C4 extends ST.default{constructor($){super();this.redis=$,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=$.options,Object.keys($.scriptsSet).forEach((Y)=>{let Q=$.scriptsSet[Y];this._shaToScript[Q.sha]=Q,this[Y]=$[Y],this[Y+"Buffer"]=$[Y+"Buffer"]}),$.addedBuiltinSet.forEach((Y)=>{this[Y]=$[Y],this[Y+"Buffer"]=$[Y+"Buffer"]}),this.promise=new Promise((Y,Q)=>{this.resolve=Y,this.reject=Q});let Z=this;Object.defineProperty(this,"length",{get:function(){return Z._queue.length}})}fillResult($,Z){if(this._queue[Z].name==="exec"&&Array.isArray($[1])){let Q=$[1].length;for(let W=0;W<Q;W++){if($[1][W]instanceof Error)continue;let X=this._queue[Z-(Q-W)];try{$[1][W]=X.transformReply($[1][W])}catch(J){$[1][W]=J}}}if(this._result[Z]=$,--this.replyPending)return;if(this.isCluster){let Q=!0,W;for(let X=0;X<this._result.length;++X){let J=this._result[X][0],z=this._queue[X];if(J){if(z.name==="exec"&&J.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!W)W={name:J.name,message:J.message};else if(W.name!==J.name||W.message!==J.message){Q=!1;break}}else if(!z.inTransaction){if(!(eq.exists(z.name)&&eq.hasFlag(z.name,"readonly"))){Q=!1;break}}}if(W&&Q){let X=this,J=W.message.split(" "),z=this._queue,U=!1;this._queue=[];for(let H=0;H<z.length;++H){if(J[0]==="ASK"&&!U&&z[H].name!=="asking"&&(!z[H-1]||z[H-1].name!=="asking")){let w=new zT.default("asking");w.ignore=!0,this.sendCommand(w)}z[H].initPromise(),this.sendCommand(z[H]),U=z[H].inTransaction}let S=!0;if(typeof this.leftRedirections==="undefined")this.leftRedirections={};let q=function(){X.exec()},M=this.redis;if(M.handleError(W,this.leftRedirections,{moved:function(H,w){X.preferKey=w,M.slots[J[1]]=[w],M._groupsBySlot[J[1]]=M._groupsIds[M.slots[J[1]].join(";")],M.refreshSlotsCache(),X.exec()},ask:function(H,w){X.preferKey=w,X.exec()},tryagain:q,clusterDown:q,connectionClosed:q,maxRedirections:()=>{S=!1},defaults:()=>{S=!1}}),S)return}}let Y=0;for(let Q=0;Q<this._queue.length-Y;++Q){if(this._queue[Q+Y].ignore)Y+=1;this._result[Q]=this._result[Q+Y]}this.resolve(this._result.slice(0,this._result.length-Y))}sendCommand($){if(this._transactions>0)$.inTransaction=!0;let Z=this._queue.length;return $.pipelineIndex=Z,$.promise.then((Y)=>{this.fillResult([null,Y],Z)}).catch((Y)=>{this.fillResult([Y],Z)}),this._queue.push($),this}addBatch($){let Z,Y,Q;for(let W=0;W<$.length;++W)Z=$[W],Y=Z[0],Q=Z.slice(1),this[Y].apply(this,Q);return this}}YG.default=C4;var GT=C4.prototype.multi;C4.prototype.multi=function(){return this._transactions+=1,GT.apply(this,arguments)};var ZG=C4.prototype.execBuffer;C4.prototype.execBuffer=JT.deprecate(function(){if(this._transactions>0)this._transactions-=1;return ZG.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");C4.prototype.exec=function($){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(UT.noop);if($&&!this.nodeifiedPromise)this.nodeifiedPromise=!0,$G.default(this.promise,$);return this.redis.delayUntilReady((W)=>{if(W){this.reject(W);return}this.exec($)}),this.promise}if(this._transactions>0)return this._transactions-=1,ZG.apply(this,arguments);if(!this.nodeifiedPromise)this.nodeifiedPromise=!0,$G.default(this.promise,$);if(!this._queue.length)this.resolve([]);let Z;if(this.isCluster){let W=[];for(let X=0;X<this._queue.length;X++){let J=this._queue[X].getKeys();if(J.length)W.push(J[0]);if(J.length&&fQ.generateMulti(J)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(W.length){if(Z=qT(this.redis,W),Z<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else Z=Math.random()*16384|0}let Y=this;return Q(),this.promise;function Q(){let W=Y.replyPending=Y._queue.length,X;if(Y.isCluster)X={slot:Z,redis:Y.redis.connectionPool.nodes.all[Y.preferKey]};let J="",z,U={isPipeline:!0,destination:Y.isCluster?X:{redis:Y.redis},write(S){if(typeof S!=="string"){if(!z)z=[];if(J)z.push(Buffer.from(J,"utf8")),J="";z.push(S)}else J+=S;if(!--W){if(z){if(J)z.push(Buffer.from(J,"utf8"));U.destination.redis.stream.write(Buffer.concat(z))}else U.destination.redis.stream.write(J);W=Y._queue.length,J="",z=void 0}}};for(let S=0;S<Y._queue.length;++S)Y.redis.sendCommand(Y._queue[S],U,X);return Y.promise}}});var hQ=C((WG)=>{Object.defineProperty(WG,"__esModule",{value:!0});WG.addTransactionSupport=void 0;var vQ=B0(),dQ=s8(),QG=yQ();function BT($){$.pipeline=function(Q){let W=new QG.default(this);if(Array.isArray(Q))W.addBatch(Q);return W};let{multi:Z}=$;$.multi=function(Q,W){if(typeof W==="undefined"&&!Array.isArray(Q))W=Q,Q=null;if(W&&W.pipeline===!1)return Z.call(this);let X=new QG.default(this);if(X.multi(),Array.isArray(Q))X.addBatch(Q);let J=X.exec;X.exec=function(U){if(this.isCluster&&!this.redis.slots.length){if(this.redis.status==="wait")this.redis.connect().catch(vQ.noop);return dQ.default(new Promise((q,M)=>{this.redis.delayUntilReady((H)=>{if(H){M(H);return}this.exec(X).then(q,M)})}),U)}if(this._transactions>0)J.call(X);if(this.nodeifiedPromise)return J.call(X);let S=J.call(X);return dQ.default(S.then(function(q){let M=q[q.length-1];if(typeof M==="undefined")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(M[0]){M[0].previousErrors=[];for(let H=0;H<q.length-1;++H)if(q[H][0])M[0].previousErrors.push(q[H][0]);throw M[0]}return vQ.wrapMultiResult(M[1])}),U)};let{execBuffer:z}=X;return X.execBuffer=function(U){if(this._transactions>0)z.call(X);return X.exec(U)},X};let{exec:Y}=$;$.exec=function(Q){return dQ.default(Y.call(this).then(function(W){if(Array.isArray(W))W=vQ.wrapMultiResult(W);return W}),Q)}}WG.addTransactionSupport=BT});var mQ=C((JG)=>{Object.defineProperty(JG,"__esModule",{value:!0});function wT($,Z){Object.getOwnPropertyNames(Z.prototype).forEach((Y)=>{Object.defineProperty($.prototype,Y,Object.getOwnPropertyDescriptor(Z.prototype,Y))})}JG.default=wT});var qG=C((UG)=>{Object.defineProperty(UG,"__esModule",{value:!0});UG.DEFAULT_CLUSTER_OPTIONS=void 0;var zG=U1("dns");UG.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:($)=>Math.min(100+$*2,2000),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1000,useSRVRecords:!1,resolveSrv:zG.resolveSrv,dnsLookup:zG.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}});var AZ=C((MG)=>{Object.defineProperty(MG,"__esModule",{value:!0});MG.getConnectionName=MG.weightSrvRecords=MG.groupSrvRecords=MG.getUniqueHostnamesFromOptions=MG.normalizeNodeOptions=MG.nodeKeyToRedisOptions=MG.getNodeKey=void 0;var GG=B0(),DT=U1("net");function AT($){return $.port=$.port||6379,$.host=$.host||"127.0.0.1",$.host+":"+$.port}MG.getNodeKey=AT;function NT($){let Z=$.lastIndexOf(":");if(Z===-1)throw new Error(`Invalid node key ${$}`);return{host:$.slice(0,Z),port:Number($.slice(Z+1))}}MG.nodeKeyToRedisOptions=NT;function LT($){return $.map((Z)=>{let Y={};if(typeof Z==="object")Object.assign(Y,Z);else if(typeof Z==="string")Object.assign(Y,GG.parseURL(Z));else if(typeof Z==="number")Y.port=Z;else throw new Error("Invalid argument "+Z);if(typeof Y.port==="string")Y.port=parseInt(Y.port,10);if(delete Y.db,!Y.port)Y.port=6379;if(!Y.host)Y.host="127.0.0.1";return GG.resolveTLSProfile(Y)})}MG.normalizeNodeOptions=LT;function OT($){let Z={};return $.forEach((Y)=>{Z[Y.host]=!0}),Object.keys(Z).filter((Y)=>!DT.isIP(Y))}MG.getUniqueHostnamesFromOptions=OT;function FT($){let Z={};for(let Y of $)if(!Z.hasOwnProperty(Y.priority))Z[Y.priority]={totalWeight:Y.weight,records:[Y]};else Z[Y.priority].totalWeight+=Y.weight,Z[Y.priority].records.push(Y);return Z}MG.groupSrvRecords=FT;function PT($){if($.records.length===1)return $.totalWeight=0,$.records.shift();let Z=Math.floor(Math.random()*($.totalWeight+$.records.length)),Y=0;for(let[Q,W]of $.records.entries())if(Y+=1+W.weight,Y>Z)return $.totalWeight-=W.weight,$.records.splice(Q,1),W}MG.weightSrvRecords=PT;function KT($,Z){let Y=`ioredis-cluster(${$})`;return Z?`${Y}:${Z}`:Y}MG.getConnectionName=KT});var cQ=C((DG)=>{Object.defineProperty(DG,"__esModule",{value:!0});var wG=AZ(),uQ=B0(),IT=e8(),j8=uQ.Debug("cluster:subscriber");class HG{constructor($,Z,Y=!1){this.connectionPool=$,this.emitter=Z,this.isSharded=Y,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){j8("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}j8("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(Q,W)=>{if(!this.started||!this.subscriber)return;if(wG.getNodeKey(this.subscriber.options)===W)j8("subscriber has left, selecting a new one..."),this.selectSubscriber()}),this.connectionPool.on("+node",()=>{if(!this.started||this.subscriber)return;j8("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber()})}getInstance(){return this.subscriber}associateSlotRange($){if(this.isSharded)this.slotRange=$;return this.slotRange}start(){this.started=!0,this.selectSubscriber(),j8("started")}stop(){if(this.started=!1,this.subscriber)this.subscriber.disconnect(),this.subscriber=null}isStarted(){return this.started}selectSubscriber(){let $=this.lastActiveSubscriber;if($)$.off("end",this.onSubscriberEnd),$.disconnect();if(this.subscriber)this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect();let Z=uQ.sample(this.connectionPool.getNodes());if(!Z){j8("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:Y}=Z;j8("selected a subscriber %s:%s",Y.host,Y.port);let Q="subscriber";if(this.isSharded)Q="ssubscriber";this.subscriber=new IT.default({port:Y.port,host:Y.host,username:Y.username,password:Y.password,enableReadyCheck:!0,connectionName:wG.getConnectionName(Q,Y.connectionName),lazyConnect:!0,tls:Y.tls,retryStrategy:null}),this.subscriber.on("error",uQ.noop),this.subscriber.once("end",this.onSubscriberEnd);let W={subscribe:[],psubscribe:[],ssubscribe:[]};if($){let X=$.condition||$.prevCondition;if(X&&X.subscriber)W.subscribe=X.subscriber.channels("subscribe"),W.psubscribe=X.subscriber.channels("psubscribe"),W.ssubscribe=X.subscriber.channels("ssubscribe")}if(W.subscribe.length||W.psubscribe.length||W.ssubscribe.length){let X=0;for(let J of["subscribe","psubscribe","ssubscribe"]){let z=W[J];if(z.length)X+=1,j8("%s %d channels",J,z.length),this.subscriber[J](z).then(()=>{if(!--X)this.lastActiveSubscriber=this.subscriber}).catch(()=>{j8("failed to %s %d channels",J,z.length)})}}else this.lastActiveSubscriber=this.subscriber;for(let X of["message","messageBuffer"])this.subscriber.on(X,(J,z)=>{this.emitter.emit(X,J,z)});for(let X of["pmessage","pmessageBuffer"])this.subscriber.on(X,(J,z,U)=>{this.emitter.emit(X,J,z,U)});if(this.isSharded==!0)for(let X of["smessage","smessageBuffer"])this.subscriber.on(X,(J,z)=>{this.emitter.emit(X,J,z)})}}DG.default=HG});var iQ=C((NG)=>{Object.defineProperty(NG,"__esModule",{value:!0});var bT=U1("events"),A9=B0(),pQ=AZ(),xT=e8(),NZ=A9.Debug("cluster:connectionPool");class AG extends bT.EventEmitter{constructor($){super();this.redisOptions=$,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes($="all"){let Z=this.nodes[$];return Object.keys(Z).map((Y)=>Z[Y])}getInstanceByKey($){return this.nodes.all[$]}getSampleInstance($){let Z=Object.keys(this.nodes[$]),Y=A9.sample(Z);return this.nodes[$][Y]}addMasterNode($){let Z=pQ.getNodeKey($.options),Y=this.createRedisFromOptions($,$.options.readOnly);if(!$.options.readOnly)return this.nodes.all[Z]=Y,this.nodes.master[Z]=Y,!0;return!1}createRedisFromOptions($,Z){return new xT.default(A9.defaults({retryStrategy:null,enableOfflineQueue:!0,readOnly:Z},$,this.redisOptions,{lazyConnect:!0}))}findOrCreate($,Z=!1){let Y=pQ.getNodeKey($);if(Z=Boolean(Z),this.specifiedOptions[Y])Object.assign($,this.specifiedOptions[Y]);else this.specifiedOptions[Y]=$;let Q;if(this.nodes.all[Y]){if(Q=this.nodes.all[Y],Q.options.readOnly!==Z)if(Q.options.readOnly=Z,NZ("Change role of %s to %s",Y,Z?"slave":"master"),Q[Z?"readonly":"readwrite"]().catch(A9.noop),Z)delete this.nodes.master[Y],this.nodes.slave[Y]=Q;else delete this.nodes.slave[Y],this.nodes.master[Y]=Q}else NZ("Connecting to %s as %s",Y,Z?"slave":"master"),Q=this.createRedisFromOptions($,Z),this.nodes.all[Y]=Q,this.nodes[Z?"slave":"master"][Y]=Q,Q.once("end",()=>{if(this.removeNode(Y),this.emit("-node",Q,Y),!Object.keys(this.nodes.all).length)this.emit("drain")}),this.emit("+node",Q,Y),Q.on("error",function(W){this.emit("nodeError",W,Y)});return Q}reset($){NZ("Reset with %O",$);let Z={};$.forEach((Y)=>{let Q=pQ.getNodeKey(Y);if(!(Y.readOnly&&Z[Q]))Z[Q]=Y}),Object.keys(this.nodes.all).forEach((Y)=>{if(!Z[Y])NZ("Disconnect %s because the node does not hold any slot",Y),this.nodes.all[Y].disconnect(),this.removeNode(Y)}),Object.keys(Z).forEach((Y)=>{let Q=Z[Y];this.findOrCreate(Q,Q.readOnly)})}removeNode($){let{nodes:Z}=this;if(Z.all[$])NZ("Remove %s from the pool",$),delete Z.all[$];delete Z.master[$],delete Z.slave[$]}}NG.default=AG});var N9=C((Ys,LG)=>{function p1($,Y){var Y=Y||{};if(this._capacity=Y.capacity,this._head=0,this._tail=0,Array.isArray($))this._fromArray($);else this._capacityMask=3,this._list=new Array(4)}p1.prototype.peekAt=function $(Z){var Y=Z;if(Y!==(Y|0))return;var Q=this.size();if(Y>=Q||Y<-Q)return;if(Y<0)Y+=Q;return Y=this._head+Y&this._capacityMask,this._list[Y]};p1.prototype.get=function $(Z){return this.peekAt(Z)};p1.prototype.peek=function $(){if(this._head===this._tail)return;return this._list[this._head]};p1.prototype.peekFront=function $(){return this.peek()};p1.prototype.peekBack=function $(){return this.peekAt(-1)};Object.defineProperty(p1.prototype,"length",{get:function $(){return this.size()}});p1.prototype.size=function $(){if(this._head===this._tail)return 0;if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};p1.prototype.unshift=function $(Z){if(arguments.length===0)return this.size();var Y=this._list.length;if(this._head=this._head-1+Y&this._capacityMask,this._list[this._head]=Z,this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.pop();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};p1.prototype.shift=function $(){var Z=this._head;if(Z===this._tail)return;var Y=this._list[Z];if(this._list[Z]=void 0,this._head=Z+1&this._capacityMask,Z<2&&this._tail>1e4&&this._tail<=this._list.length>>>2)this._shrinkArray();return Y};p1.prototype.push=function $(Z){if(arguments.length===0)return this.size();var Y=this._tail;if(this._list[Y]=Z,this._tail=Y+1&this._capacityMask,this._tail===this._head)this._growArray();if(this._capacity&&this.size()>this._capacity)this.shift();if(this._head<this._tail)return this._tail-this._head;else return this._capacityMask+1-(this._head-this._tail)};p1.prototype.pop=function $(){var Z=this._tail;if(Z===this._head)return;var Y=this._list.length;this._tail=Z-1+Y&this._capacityMask;var Q=this._list[this._tail];if(this._list[this._tail]=void 0,this._head<2&&Z>1e4&&Z<=Y>>>2)this._shrinkArray();return Q};p1.prototype.removeOne=function $(Z){var Y=Z;if(Y!==(Y|0))return;if(this._head===this._tail)return;var Q=this.size(),W=this._list.length;if(Y>=Q||Y<-Q)return;if(Y<0)Y+=Q;Y=this._head+Y&this._capacityMask;var X=this._list[Y],J;if(Z<Q/2){for(J=Z;J>0;J--)this._list[Y]=this._list[Y=Y-1+W&this._capacityMask];this._list[Y]=void 0,this._head=this._head+1+W&this._capacityMask}else{for(J=Q-1-Z;J>0;J--)this._list[Y]=this._list[Y=Y+1+W&this._capacityMask];this._list[Y]=void 0,this._tail=this._tail-1+W&this._capacityMask}return X};p1.prototype.remove=function $(Z,Y){var Q=Z,W,X=Y;if(Q!==(Q|0))return;if(this._head===this._tail)return;var J=this.size(),z=this._list.length;if(Q>=J||Q<-J||Y<1)return;if(Q<0)Q+=J;if(Y===1||!Y)return W=new Array(1),W[0]=this.removeOne(Q),W;if(Q===0&&Q+Y>=J)return W=this.toArray(),this.clear(),W;if(Q+Y>J)Y=J-Q;var U;W=new Array(Y);for(U=0;U<Y;U++)W[U]=this._list[this._head+Q+U&this._capacityMask];if(Q=this._head+Q&this._capacityMask,Z+Y===J){this._tail=this._tail-Y+z&this._capacityMask;for(U=Y;U>0;U--)this._list[Q=Q+1+z&this._capacityMask]=void 0;return W}if(Z===0){this._head=this._head+Y+z&this._capacityMask;for(U=Y-1;U>0;U--)this._list[Q=Q+1+z&this._capacityMask]=void 0;return W}if(Q<J/2){this._head=this._head+Z+Y+z&this._capacityMask;for(U=Z;U>0;U--)this.unshift(this._list[Q=Q-1+z&this._capacityMask]);Q=this._head-1+z&this._capacityMask;while(X>0)this._list[Q=Q-1+z&this._capacityMask]=void 0,X--;if(Z<0)this._tail=Q}else{this._tail=Q,Q=Q+Y+z&this._capacityMask;for(U=J-(Y+Z);U>0;U--)this.push(this._list[Q++]);Q=this._tail;while(X>0)this._list[Q=Q+1+z&this._capacityMask]=void 0,X--}if(this._head<2&&this._tail>1e4&&this._tail<=z>>>2)this._shrinkArray();return W};p1.prototype.splice=function $(Z,Y){var Q=Z;if(Q!==(Q|0))return;var W=this.size();if(Q<0)Q+=W;if(Q>W)return;if(arguments.length>2){var X,J,z,U=arguments.length,S=this._list.length,q=2;if(!W||Q<W/2){J=new Array(Q);for(X=0;X<Q;X++)J[X]=this._list[this._head+X&this._capacityMask];if(Y===0){if(z=[],Q>0)this._head=this._head+Q+S&this._capacityMask}else z=this.remove(Q,Y),this._head=this._head+Q+S&this._capacityMask;while(U>q)this.unshift(arguments[--U]);for(X=Q;X>0;X--)this.unshift(J[X-1])}else{J=new Array(W-(Q+Y));var M=J.length;for(X=0;X<M;X++)J[X]=this._list[this._head+Q+Y+X&this._capacityMask];if(Y===0){if(z=[],Q!=W)this._tail=this._head+Q+S&this._capacityMask}else z=this.remove(Q,Y),this._tail=this._tail-M+S&this._capacityMask;while(q<U)this.push(arguments[q++]);for(X=0;X<M;X++)this.push(J[X])}return z}else return this.remove(Q,Y)};p1.prototype.clear=function $(){this._list=new Array(this._list.length),this._head=0,this._tail=0};p1.prototype.isEmpty=function $(){return this._head===this._tail};p1.prototype.toArray=function $(){return this._copyArray(!1)};p1.prototype._fromArray=function $(Z){var Y=Z.length,Q=this._nextPowerOf2(Y);this._list=new Array(Q),this._capacityMask=Q-1,this._tail=Y;for(var W=0;W<Y;W++)this._list[W]=Z[W]};p1.prototype._copyArray=function $(Z,Y){var Q=this._list,W=Q.length,X=this.length;if(Y=Y|X,Y==X&&this._head<this._tail)return this._list.slice(this._head,this._tail);var J=new Array(Y),z=0,U;if(Z||this._head>this._tail){for(U=this._head;U<W;U++)J[z++]=Q[U];for(U=0;U<this._tail;U++)J[z++]=Q[U]}else for(U=this._head;U<this._tail;U++)J[z++]=Q[U];return J};p1.prototype._growArray=function $(){if(this._head!=0){var Z=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=Z}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};p1.prototype._shrinkArray=function $(){this._list.length>>>=1,this._capacityMask>>>=1};p1.prototype._nextPowerOf2=function $(Z){var Y=Math.log(Z)/Math.log(2),Q=1<<Y+1;return Math.max(Q,4)};LG.exports=p1});var PG=C((FG)=>{Object.defineProperty(FG,"__esModule",{value:!0});var gT=B0(),fT=N9(),yT=gT.Debug("delayqueue");class OG{constructor(){this.queues={},this.timeouts={}}push($,Z,Y){let Q=Y.callback||process.nextTick;if(!this.queues[$])this.queues[$]=new fT;if(this.queues[$].push(Z),!this.timeouts[$])this.timeouts[$]=setTimeout(()=>{Q(()=>{this.timeouts[$]=null,this.execute($)})},Y.timeout)}execute($){let Z=this.queues[$];if(!Z)return;let{length:Y}=Z;if(!Y)return;yT("send %d commands in %s queue",Y,$),this.queues[$]=null;while(Z.length>0)Z.shift()()}}FG.default=OG});var _G=C((CG)=>{Object.defineProperty(CG,"__esModule",{value:!0});var dT=B0(),hT=cQ(),mT=iQ(),KG=AZ(),L9=BZ(),RG=dT.Debug("cluster:subscriberGroup");class jG{constructor($){this.cluster=$,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,$.on("+node",(Z)=>{this._addSubscriber(Z)}),$.on("-node",(Z)=>{this._removeSubscriber(Z)}),$.on("refresh",()=>{this._refreshSlots($)})}getResponsibleSubscriber($){let Z=this.clusterSlots[$][0];return this.shardedSubscribers.get(Z)}addChannels($){let Z=L9($[0]);$.forEach((Q)=>{if(L9(Q)!=Z)return-1});let Y=this.channels.get(Z);if(!Y)this.channels.set(Z,$);else this.channels.set(Z,Y.concat($));return[...this.channels.values()].flatMap((Q)=>Q).length}removeChannels($){let Z=L9($[0]);$.forEach((Q)=>{if(L9(Q)!=Z)return-1});let Y=this.channels.get(Z);if(Y){let Q=Y.filter((W)=>!$.includes(W));this.channels.set(Z,Q)}return[...this.channels.values()].flatMap((Q)=>Q).length}stop(){for(let $ of this.shardedSubscribers.values())$.stop()}start(){for(let $ of this.shardedSubscribers.values())if(!$.isStarted())$.start()}_addSubscriber($){let Z=new mT.default($.options);if(Z.addMasterNode($)){let Y=new hT.default(Z,this.cluster,!0),Q=KG.getNodeKey($.options);return this.shardedSubscribers.set(Q,Y),Y.start(),this._resubscribe(),this.cluster.emit("+subscriber"),Y}return null}_removeSubscriber($){let Z=KG.getNodeKey($.options),Y=this.shardedSubscribers.get(Z);if(Y)Y.stop(),this.shardedSubscribers.delete(Z),this._resubscribe(),this.cluster.emit("-subscriber");return this.shardedSubscribers}_refreshSlots($){if(this._slotsAreEqual($.slots))RG("Nothing to refresh because the new cluster map is equal to the previous one.");else{RG("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let Z=0;Z<$.slots.length;Z++){let Y=$.slots[Z][0];if(!this.subscriberToSlotsIndex.has(Y))this.subscriberToSlotsIndex.set(Y,[]);this.subscriberToSlotsIndex.get(Y).push(Number(Z))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify($.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){if(this.shardedSubscribers)this.shardedSubscribers.forEach(($,Z)=>{let Y=this.subscriberToSlotsIndex.get(Z);if(Y)$.associateSlotRange(Y),Y.forEach((Q)=>{let W=$.getInstance(),X=this.channels.get(Q);if(X&&X.length>0){if(W)W.ssubscribe(X),W.on("ready",()=>{W.ssubscribe(X)})}})})}_slotsAreEqual($){if(this.clusterSlots===void 0)return!1;else return JSON.stringify(this.clusterSlots)===JSON.stringify($)}}CG.default=jG});var nQ=C((kG)=>{Object.defineProperty(kG,"__esModule",{value:!0});var VG=B$(),xG=U1("events"),LZ=R4(),EG=s8(),IG=R8(),lQ=fq(),cT=e8(),pT=B9(),iT=hQ(),W6=B0(),lT=mQ(),nT=D9(),oT=qG(),tT=cQ(),sT=iQ(),rT=PG(),D$=AZ(),TG=N9(),aT=_G(),i1=W6.Debug("cluster"),bG=new WeakSet;class OZ extends nT.default{constructor($,Z={}){super();if(this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new rT.default,this.offlineQueue=new TG,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,xG.EventEmitter.call(this),this.startupNodes=$,this.options=W6.defaults({},Z,oT.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers==!0)this.shardedSubscribers=new aT.default(this);if(this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix)this.options.keyPrefix=this.options.redisOptions.keyPrefix;if(typeof this.options.scaleReads!=="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');if(this.connectionPool=new sT.default(this.options.redisOptions),this.connectionPool.on("-node",(Y,Q)=>{this.emit("-node",Y)}),this.connectionPool.on("+node",(Y)=>{this.emit("+node",Y)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(Y,Q)=>{this.emit("node error",Y,Q)}),this.subscriber=new tT.default(this.connectionPool,this),this.options.scripts)Object.entries(this.options.scripts).forEach(([Y,Q])=>{this.defineCommand(Y,Q)});if(this.options.lazyConnect)this.setStatus("wait");else this.connect().catch((Y)=>{i1("connecting failed: %s",Y)})}connect(){return new Promise(($,Z)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){Z(new Error("Redis is already connecting/connected"));return}let Y=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then((Q)=>{if(this.connectionEpoch!==Y){i1("discard connecting after resolving startup nodes because epoch not match: %d != %d",Y,this.connectionEpoch),Z(new LZ.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){i1("discard connecting after resolving startup nodes because the status changed to %s",this.status),Z(new LZ.RedisError("Connection is aborted"));return}this.connectionPool.reset(Q);let W=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),$()},X=void 0,J=()=>{if(this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",X),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck)this.readyCheck((z,U)=>{if(z||U){if(i1("Ready check failed (%s). Reconnecting...",z||U),this.status==="connect")this.disconnect(!0)}else W()});else W()};if(X=()=>{let z=new Error("None of startup nodes is available");this.removeListener("refresh",J),this.invokeReadyDelayedCallbacks(z),Z(z)},this.once("refresh",J),this.once("close",X),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache((z)=>{if(z&&z.message===lQ.default.defaultMessage)cT.default.prototype.silentEmit.call(this,"error",z),this.connectionPool.reset([])}),this.subscriber.start(),this.options.shardedSubscribers)this.shardedSubscribers.start()}).catch((Q)=>{this.setStatus("close"),this.handleCloseEvent(Q),this.invokeReadyDelayedCallbacks(Q),Z(Q)})})}disconnect($=!1){let Z=this.status;if(this.setStatus("disconnecting"),!$)this.manuallyClosing=!0;if(this.reconnectTimeout&&!$)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,i1("Canceled reconnecting attempts");if(this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers)this.shardedSubscribers.stop();if(Z==="wait")this.setStatus("close"),this.handleCloseEvent();else this.connectionPool.reset([])}quit($){let Z=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null;if(this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers)this.shardedSubscribers.stop();if(Z==="wait"){let Y=EG.default(Promise.resolve("OK"),$);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),Y}return EG.default(Promise.all(this.nodes().map((Y)=>Y.quit().catch((Q)=>{if(Q.message===W6.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw Q}))).then(()=>"OK"),$)}duplicate($=[],Z={}){let Y=$.length>0?$:this.startupNodes.slice(0),Q=Object.assign({},this.options,Z);return new OZ(Y,Q)}nodes($="all"){if($!=="all"&&$!=="master"&&$!=="slave")throw new Error('Invalid role "'+$+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes($)}delayUntilReady($){this._readyDelayedCallbacks.push($)}get autoPipelineQueueSize(){let $=0;for(let Z of this._autoPipelines.values())$+=Z.length;return $}refreshSlotsCache($){if($)this._refreshSlotsCacheCallbacks.push($);if(this.isRefreshing)return;this.isRefreshing=!0;let Z=this,Y=(J)=>{this.isRefreshing=!1;for(let z of this._refreshSlotsCacheCallbacks)z(J);this._refreshSlotsCacheCallbacks=[]},Q=W6.shuffle(this.connectionPool.getNodes()),W=null;function X(J){if(J===Q.length){let S=new lQ.default(lQ.default.defaultMessage,W);return Y(S)}let z=Q[J],U=`${z.options.host}:${z.options.port}`;i1("getting slot cache from %s",U),Z.getInfoFromNode(z,function(S){switch(Z.status){case"close":case"end":return Y(new Error("Cluster is disconnected."));case"disconnecting":return Y(new Error("Cluster is disconnecting."))}if(S)Z.emit("node error",S,U),W=S,X(J+1);else Z.emit("refresh"),Y()})}X(0)}sendCommand($,Z,Y){if(this.status==="wait")this.connect().catch(W6.noop);if(this.status==="end")return $.reject(new Error(W6.CONNECTION_CLOSED_ERROR_MSG)),$.promise;let Q=this.options.scaleReads;if(Q!=="master"){if(!($.isReadOnly||VG.exists($.name)&&VG.hasFlag($.name,"readonly")))Q="master"}let W=Y?Y.slot:$.getSlot(),X={},J=this;if(!Y&&!bG.has($)){bG.add($);let U=$.reject;$.reject=function(S){let q=z.bind(null,!0);J.handleError(S,X,{moved:function(M,H){if(i1("command %s is moved to %s",$.name,H),W=Number(M),J.slots[M])J.slots[M][0]=H;else J.slots[M]=[H];J._groupsBySlot[M]=J._groupsIds[J.slots[M].join(";")],J.connectionPool.findOrCreate(J.natMapper(H)),z(),i1("refreshing slot caches... (triggered by MOVED error)"),J.refreshSlotsCache()},ask:function(M,H){i1("command %s is required to ask %s:%s",$.name,H);let w=J.natMapper(H);J.connectionPool.findOrCreate(w),z(!1,`${w.host}:${w.port}`)},tryagain:q,clusterDown:q,connectionClosed:q,maxRedirections:function(M){U.call($,M)},defaults:function(){U.call($,S)}})}}z();function z(U,S){if(J.status==="end"){$.reject(new LZ.AbortError("Cluster is ended."));return}let q;if(J.status==="ready"||$.name==="cluster"){if(Y&&Y.redis)q=Y.redis;else if(IG.default.checkFlag("ENTER_SUBSCRIBER_MODE",$.name)||IG.default.checkFlag("EXIT_SUBSCRIBER_MODE",$.name)){if(J.options.shardedSubscribers==!0&&($.name=="ssubscribe"||$.name=="sunsubscribe")){let M=J.shardedSubscribers.getResponsibleSubscriber(W),H=-1;if($.name=="ssubscribe")H=J.shardedSubscribers.addChannels($.getKeys());if($.name=="sunsubscribe")H=J.shardedSubscribers.removeChannels($.getKeys());if(H!==-1)q=M.getInstance();else $.reject(new LZ.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else q=J.subscriber.getInstance();if(!q){$.reject(new LZ.AbortError("No subscriber for the cluster"));return}}else{if(!U){if(typeof W==="number"&&J.slots[W]){let M=J.slots[W];if(typeof Q==="function"){let H=M.map(function(w){return J.connectionPool.getInstanceByKey(w)});if(q=Q(H,$),Array.isArray(q))q=W6.sample(q);if(!q)q=H[0]}else{let H;if(Q==="all")H=W6.sample(M);else if(Q==="slave"&&M.length>1)H=W6.sample(M,1);else H=M[0];q=J.connectionPool.getInstanceByKey(H)}}if(S)q=J.connectionPool.getInstanceByKey(S),q.asking()}if(!q)q=(typeof Q==="function"?null:J.connectionPool.getSampleInstance(Q))||J.connectionPool.getSampleInstance("all")}if(Y&&!Y.redis)Y.redis=q}if(q)q.sendCommand($,Z);else if(J.options.enableOfflineQueue)J.offlineQueue.push({command:$,stream:Z,node:Y});else $.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return $.promise}sscanStream($,Z){return this.createScanStream("sscan",{key:$,options:Z})}sscanBufferStream($,Z){return this.createScanStream("sscanBuffer",{key:$,options:Z})}hscanStream($,Z){return this.createScanStream("hscan",{key:$,options:Z})}hscanBufferStream($,Z){return this.createScanStream("hscanBuffer",{key:$,options:Z})}zscanStream($,Z){return this.createScanStream("zscan",{key:$,options:Z})}zscanBufferStream($,Z){return this.createScanStream("zscanBuffer",{key:$,options:Z})}handleError($,Z,Y){if(typeof Z.value==="undefined")Z.value=this.options.maxRedirections;else Z.value-=1;if(Z.value<=0){Y.maxRedirections(new Error("Too many Cluster redirections. Last error: "+$));return}let Q=$.message.split(" ");if(Q[0]==="MOVED"){let W=this.options.retryDelayOnMoved;if(W&&typeof W==="number")this.delayQueue.push("moved",Y.moved.bind(null,Q[1],Q[2]),{timeout:W});else Y.moved(Q[1],Q[2])}else if(Q[0]==="ASK")Y.ask(Q[1],Q[2]);else if(Q[0]==="TRYAGAIN")this.delayQueue.push("tryagain",Y.tryagain,{timeout:this.options.retryDelayOnTryAgain});else if(Q[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0)this.delayQueue.push("clusterdown",Y.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)});else if($.message===W6.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready")this.delayQueue.push("failover",Y.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)});else Y.defaults()}resetOfflineQueue(){this.offlineQueue=new TG}clearNodesRefreshInterval(){if(this.slotsTimer)clearTimeout(this.slotsTimer),this.slotsTimer=null}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let $=()=>{this.slotsTimer=setTimeout(()=>{i1('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{$()})},this.options.slotsRefreshInterval)};$()}setStatus($){i1("status: %s -> %s",this.status||"[empty]",$),this.status=$,process.nextTick(()=>{this.emit($)})}handleCloseEvent($){if($)i1("closed because %s",$);let Z;if(!this.manuallyClosing&&typeof this.options.clusterRetryStrategy==="function")Z=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,$);if(typeof Z==="number")this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,i1("Cluster is disconnected. Retrying after %dms",Z),this.connect().catch(function(Y){i1("Got error %s when reconnecting. Ignoring...",Y)})},Z);else this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available"))}flushQueue($){let Z;while(Z=this.offlineQueue.shift())Z.command.reject($)}executeOfflineCommands(){if(this.offlineQueue.length){i1("send %d commands in offline queue",this.offlineQueue.length);let $=this.offlineQueue;this.resetOfflineQueue();let Z;while(Z=$.shift())this.sendCommand(Z.command,Z.stream,Z.node)}}natMapper($){let Z=typeof $==="string"?$:`${$.host}:${$.port}`,Y=null;if(this.options.natMap&&typeof this.options.natMap==="function")Y=this.options.natMap(Z);else if(this.options.natMap&&typeof this.options.natMap==="object")Y=this.options.natMap[Z];if(Y)return i1("NAT mapping %s -> %O",Z,Y),Object.assign({},Y);return typeof $==="string"?D$.nodeKeyToRedisOptions($):$}getInfoFromNode($,Z){if(!$)return Z(new Error("Node is disconnected"));let Y=$.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:D$.getConnectionName("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});Y.on("error",W6.noop),Y.cluster("SLOTS",W6.timeout((Q,W)=>{if(Y.disconnect(),Q)return i1("error encountered running CLUSTER.SLOTS: %s",Q),Z(Q);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){i1("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",W.length,this.status),Z();return}let X=[];i1("cluster slots result count: %d",W.length);for(let z=0;z<W.length;++z){let U=W[z],S=U[0],q=U[1],M=[];for(let H=2;H<U.length;H++){if(!U[H][0])continue;let w=this.natMapper({host:U[H][0],port:U[H][1]});w.readOnly=H!==2,X.push(w),M.push(w.host+":"+w.port)}i1("cluster slots result [%d]: slots %d~%d served by %s",z,S,q,M);for(let H=S;H<=q;H++)this.slots[H]=M}this._groupsIds=Object.create(null);let J=0;for(let z=0;z<16384;z++){let U=(this.slots[z]||[]).join(";");if(!U.length){this._groupsBySlot[z]=void 0;continue}if(!this._groupsIds[U])this._groupsIds[U]=++J;this._groupsBySlot[z]=this._groupsIds[U]}this.connectionPool.reset(X),Z()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks($){for(let Z of this._readyDelayedCallbacks)process.nextTick(Z,$);this._readyDelayedCallbacks=[]}readyCheck($){this.cluster("INFO",(Z,Y)=>{if(Z)return $(Z);if(typeof Y!=="string")return $();let Q,W=Y.split(`\r
`);for(let X=0;X<W.length;++X){let J=W[X].split(":");if(J[0]==="cluster_state"){Q=J[1];break}}if(Q==="fail")i1("cluster state not ok (%s)",Q),$(null,Q);else $()})}resolveSrv($){return new Promise((Z,Y)=>{this.options.resolveSrv($,(Q,W)=>{if(Q)return Y(Q);let X=this,J=D$.groupSrvRecords(W),z=Object.keys(J).sort((S,q)=>parseInt(S)-parseInt(q));function U(S){if(!z.length)return Y(S);let q=z[0],M=J[q],H=D$.weightSrvRecords(M);if(!M.records.length)z.shift();X.dnsLookup(H.name).then((w)=>Z({host:w,port:H.port}),U)}U()})})}dnsLookup($){return new Promise((Z,Y)=>{this.options.dnsLookup($,(Q,W)=>{if(Q)i1("failed to resolve hostname %s to IP: %s",$,Q.message),Y(Q);else i1("resolved hostname %s to IP %s",$,W),Z(W)})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let $=D$.normalizeNodeOptions(this.startupNodes),Z=D$.getUniqueHostnamesFromOptions($);if(Z.length===0)return $;let Y=await Promise.all(Z.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),Q=W6.zipMap(Z,Y);return $.map((W)=>{let X=Q.get(W.host);if(!X)return W;if(this.options.useSRVRecords)return Object.assign({},W,X);return Object.assign({},W,{host:X})})}createScanStream($,{key:Z,options:Y={}}){return new pT.default({objectMode:!0,key:Z,redis:this,command:$,...Y})}}lT.default(OZ,xG.EventEmitter);iT.addTransactionSupport(OZ.prototype);kG.default=OZ});var O9=C((fG)=>{Object.defineProperty(fG,"__esModule",{value:!0});var $b=B0(),Zb=$b.Debug("AbstractConnector");class gG{constructor($){this.connecting=!1,this.disconnectTimeout=$}check($){return!0}disconnect(){if(this.connecting=!1,this.stream){let $=this.stream,Z=setTimeout(()=>{Zb("stream %s:%s still open, destroying it",$.remoteAddress,$.remotePort),$.destroy()},this.disconnectTimeout);$.on("close",()=>clearTimeout(Z)),$.end()}}}fG.default=gG});var dG=C((vG)=>{Object.defineProperty(vG,"__esModule",{value:!0});var Qb=U1("net"),Wb=U1("tls"),Xb=B0(),Jb=O9();class yG extends Jb.default{constructor($){super($.disconnectTimeout);this.options=$}connect($){let{options:Z}=this;this.connecting=!0;let Y;if("path"in Z&&Z.path)Y={path:Z.path};else{if(Y={},"port"in Z&&Z.port!=null)Y.port=Z.port;if("host"in Z&&Z.host!=null)Y.host=Z.host;if("family"in Z&&Z.family!=null)Y.family=Z.family}if(Z.tls)Object.assign(Y,Z.tls);return new Promise((Q,W)=>{process.nextTick(()=>{if(!this.connecting){W(new Error(Xb.CONNECTION_CLOSED_ERROR_MSG));return}try{if(Z.tls)this.stream=Wb.connect(Y);else this.stream=Qb.createConnection(Y)}catch(X){W(X);return}this.stream.once("error",(X)=>{this.firstError=X}),Q(this.stream)})})}}vG.default=yG});var uG=C((mG)=>{Object.defineProperty(mG,"__esModule",{value:!0});function Ub($,Z){return($.host||"127.0.0.1")===(Z.host||"127.0.0.1")&&($.port||26379)===(Z.port||26379)}class hG{constructor($){this.cursor=0,this.sentinels=$.slice(0)}next(){let $=this.cursor>=this.sentinels.length;return{done:$,value:$?void 0:this.sentinels[this.cursor++]}}reset($){if($&&this.sentinels.length>1&&this.cursor!==1)this.sentinels.unshift(...this.sentinels.splice(this.cursor-1));this.cursor=0}add($){for(let Z=0;Z<this.sentinels.length;Z++)if(Ub($,this.sentinels[Z]))return!1;return this.sentinels.push($),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}mG.default=hG});var nG=C((iG)=>{Object.defineProperty(iG,"__esModule",{value:!0});iG.FailoverDetector=void 0;var qb=B0(),oQ=qb.Debug("FailoverDetector"),cG="+switch-master";class pG{constructor($,Z){this.isDisconnected=!1,this.connector=$,this.sentinels=Z}cleanup(){this.isDisconnected=!0;for(let $ of this.sentinels)$.client.disconnect()}async subscribe(){oQ("Starting FailoverDetector");let $=[];for(let Z of this.sentinels){let Y=Z.client.subscribe(cG).catch((Q)=>{oQ("Failed to subscribe to failover messages on sentinel %s:%s (%s)",Z.address.host||"127.0.0.1",Z.address.port||26739,Q.message)});$.push(Y),Z.client.on("message",(Q)=>{if(!this.isDisconnected&&Q===cG)this.disconnect()})}await Promise.all($)}disconnect(){this.isDisconnected=!0,oQ("Failover detected, disconnecting"),this.connector.disconnect()}}iG.FailoverDetector=pG});var F9=C((rG)=>{Object.defineProperty(rG,"__esModule",{value:!0});rG.SentinelIterator=void 0;var Gb=U1("net"),FZ=B0(),Mb=U1("tls"),oG=uG();rG.SentinelIterator=oG.default;var Bb=O9(),wb=e8(),Hb=nG(),A$=FZ.Debug("SentinelConnector");class tG extends Bb.default{constructor($){super($.disconnectTimeout);if(this.options=$,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new oG.default(this.options.sentinels)}check($){let Z=!$.role||this.options.role===$.role;if(!Z)A$("role invalid, expected %s, but got %s",this.options.role,$.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0);return Z}disconnect(){if(super.disconnect(),this.failoverDetector)this.failoverDetector.cleanup()}connect($){this.connecting=!0,this.retryAttempts=0;let Z,Y=async()=>{let Q=this.sentinelIterator.next();if(Q.done){this.sentinelIterator.reset(!1);let z=typeof this.options.sentinelRetryStrategy==="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,U=typeof z!=="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${z}ms.`;if(Z)U+=` Last error: ${Z.message}`;A$(U);let S=new Error(U);if(typeof z==="number")return $("error",S),await new Promise((q)=>setTimeout(q,z)),Y();else throw S}let W=null,X=null;try{W=await this.resolve(Q.value)}catch(z){X=z}if(!this.connecting)throw new Error(FZ.CONNECTION_CLOSED_ERROR_MSG);let J=Q.value.host+":"+Q.value.port;if(W){if(A$("resolved: %s:%s from sentinel %s",W.host,W.port,J),this.options.enableTLSForSentinelMode&&this.options.tls)Object.assign(W,this.options.tls),this.stream=Mb.connect(W),this.stream.once("secureConnect",this.initFailoverDetector.bind(this));else this.stream=Gb.createConnection(W),this.stream.once("connect",this.initFailoverDetector.bind(this));return this.stream.once("error",(z)=>{this.firstError=z}),this.stream}else{let z=X?"failed to connect to sentinel "+J+" because "+X.message:"connected to sentinel "+J+" successfully, but got an invalid reply: "+W;if(A$(z),$("sentinelError",new Error(z)),X)Z=X;return Y()}};return Y()}async updateSentinels($){if(!this.options.updateSentinels)return;let Z=await $.sentinel("sentinels",this.options.name);if(!Array.isArray(Z))return;Z.map(FZ.packObject).forEach((Y)=>{if((Y.flags?Y.flags.split(","):[]).indexOf("disconnected")===-1&&Y.ip&&Y.port){let W=this.sentinelNatResolve(sG(Y));if(this.sentinelIterator.add(W))A$("adding sentinel %s:%s",W.host,W.port)}}),A$("Updated internal sentinels: %s",this.sentinelIterator)}async resolveMaster($){let Z=await $.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels($),this.sentinelNatResolve(Array.isArray(Z)?{host:Z[0],port:Number(Z[1])}:null)}async resolveSlave($){let Z=await $.sentinel("slaves",this.options.name);if(!Array.isArray(Z))return null;let Y=Z.map(FZ.packObject).filter((Q)=>Q.flags&&!Q.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(Db(Y,this.options.preferredSlaves))}sentinelNatResolve($){if(!$||!this.options.natMap)return $;let Z=`${$.host}:${$.port}`,Y=$;if(typeof this.options.natMap==="function")Y=this.options.natMap(Z)||$;else if(typeof this.options.natMap==="object")Y=this.options.natMap[Z]||$;return Y}connectToSentinel($,Z){return new wb.default({port:$.port||26379,host:$.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:$.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...Z})}async resolve($){let Z=this.connectToSentinel($);Z.on("error",Ab);try{if(this.options.role==="slave")return await this.resolveSlave(Z);else return await this.resolveMaster(Z)}finally{Z.disconnect()}}async initFailoverDetector(){var $;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let Z=[];while(Z.length<this.options.sentinelMaxConnections){let{done:Y,value:Q}=this.sentinelIterator.next();if(Y)break;let W=this.connectToSentinel(Q,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});W.on("reconnecting",()=>{var X;(X=this.emitter)===null||X===void 0||X.emit("sentinelReconnecting")}),Z.push({address:Q,client:W})}if(this.sentinelIterator.reset(!1),this.failoverDetector)this.failoverDetector.cleanup();this.failoverDetector=new Hb.FailoverDetector(this,Z),await this.failoverDetector.subscribe(),($=this.emitter)===null||$===void 0||$.emit("failoverSubscribed")}}rG.default=tG;function Db($,Z){if($.length===0)return null;let Y;if(typeof Z==="function")Y=Z($);else if(Z!==null&&typeof Z==="object"){let Q=Array.isArray(Z)?Z:[Z];Q.sort((W,X)=>{if(!W.prio)W.prio=1;if(!X.prio)X.prio=1;if(W.prio<X.prio)return-1;if(W.prio>X.prio)return 1;return 0});for(let W=0;W<Q.length;W++){for(let X=0;X<$.length;X++){let J=$[X];if(J.ip===Q[W].ip){if(J.port===Q[W].port){Y=J;break}}}if(Y)break}}if(!Y)Y=FZ.sample($);return sG(Y)}function sG($){return{host:$.ip,port:Number($.port)}}function Ab(){}});var ZM=C((eG)=>{Object.defineProperty(eG,"__esModule",{value:!0});eG.SentinelConnector=eG.StandaloneConnector=void 0;var Lb=dG();eG.StandaloneConnector=Lb.default;var Ob=F9();eG.SentinelConnector=Ob.default});var WM=C((QM)=>{Object.defineProperty(QM,"__esModule",{value:!0});var Pb=R4();class YM extends Pb.AbortError{constructor($){let Z=`Reached the max retries per request limit (which is ${$}). Refer to "maxRetriesPerRequest" option for details.`;super(Z);Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}QM.default=YM});var zM=C((XM)=>{Object.defineProperty(XM,"__esModule",{value:!0});XM.MaxRetriesPerRequestError=void 0;var Rb=WM();XM.MaxRetriesPerRequestError=Rb.default});var HM=C((ws,wM)=>{var eQ=U1("buffer").Buffer,jb=U1("string_decoder").StringDecoder,tQ=new jb,UM=R4(),Cb=UM.ReplyError,_b=UM.ParserError,v6=eQ.allocUnsafe(32768),T0=0,P9=null,PZ=0,sQ=0;function Vb($){let Z=$.buffer.length-1;var Y=$.offset,Q=0,W=1;if($.buffer[Y]===45)W=-1,Y++;while(Y<Z){let X=$.buffer[Y++];if(X===13)return $.offset=Y+1,W*Q;Q=Q*10+(X-48)}}function Eb($){let Z=$.buffer.length-1;var Y=$.offset,Q=0,W="";if($.buffer[Y]===45)W+="-",Y++;while(Y<Z){var X=$.buffer[Y++];if(X===13){if($.offset=Y+1,Q!==0)W+=Q;return W}else if(Q>429496728)W+=Q*10+(X-48),Q=0;else if(X===48&&Q===0)W+=0;else Q=Q*10+(X-48)}}function SM($){let{offset:Z,buffer:Y}=$,Q=Y.length-1;var W=Z;while(W<Q)if(Y[W++]===13){if($.offset=W+1,$.optionReturnBuffers===!0)return $.buffer.slice(Z,W-1);return $.buffer.toString("utf8",Z,W-1)}}function qM($){let Z=$.buffer.length-1;var Y=$.offset,Q=0;while(Y<Z){let W=$.buffer[Y++];if(W===13)return $.offset=Y+1,Q;Q=Q*10+(W-48)}}function Ib($){if($.optionStringNumbers===!0)return Eb($);return Vb($)}function Tb($){let Z=qM($);if(Z===void 0)return;if(Z<0)return null;let Y=$.offset+Z;if(Y+2>$.buffer.length){$.bigStrSize=Y+2,$.totalChunkSize=$.buffer.length,$.bufferCache.push($.buffer);return}let Q=$.offset;if($.offset=Y+2,$.optionReturnBuffers===!0)return $.buffer.slice(Q,Y);return $.buffer.toString("utf8",Q,Y)}function bb($){var Z=SM($);if(Z!==void 0){if($.optionReturnBuffers===!0)Z=Z.toString();return new Cb(Z)}}function xb($,Z){let Y=new _b("Protocol error, got "+JSON.stringify(String.fromCharCode(Z))+" as reply type byte",JSON.stringify($.buffer),$.offset);$.buffer=null,$.returnFatalError(Y)}function kb($){let Z=qM($);if(Z===void 0)return;if(Z<0)return null;let Y=new Array(Z);return GM($,Y,0)}function rQ($,Z,Y){$.arrayCache.push(Z),$.arrayPos.push(Y)}function aQ($){let Z=$.arrayCache.pop();var Y=$.arrayPos.pop();if($.arrayCache.length){let Q=aQ($);if(Q===void 0){rQ($,Z,Y);return}Z[Y++]=Q}return GM($,Z,Y)}function GM($,Z,Y){let Q=$.buffer.length;while(Y<Z.length){let W=$.offset;if($.offset>=Q){rQ($,Z,Y);return}let X=MM($,$.buffer[$.offset++]);if(X===void 0){if(!($.arrayCache.length||$.bufferCache.length))$.offset=W;rQ($,Z,Y);return}Z[Y]=X,Y++}return Z}function MM($,Z){switch(Z){case 36:return Tb($);case 43:return SM($);case 42:return kb($);case 58:return Ib($);case 45:return bb($);default:return xb($,Z)}}function gb(){if(v6.length>51200)if(PZ===1||sQ>PZ*2){let $=Math.floor(v6.length/10),Z=$<T0?T0:$;T0=0,v6=v6.slice(Z,v6.length)}else sQ++,PZ--;else clearInterval(P9),PZ=0,sQ=0,P9=null}function fb($){if(v6.length<$+T0){let Z=$>78643200?2:3;if(T0>116391936)T0=52428800;if(v6=eQ.allocUnsafe($*Z+T0),T0=0,PZ++,P9===null)P9=setInterval(gb,50)}}function yb($){let{bufferCache:Z,offset:Y}=$;var Q=Z.length,W=$.bigStrSize-$.totalChunkSize;if($.offset=W,W<=2){if(Q===2)return Z[0].toString("utf8",Y,Z[0].length+W-2);Q--,W=Z[Z.length-2].length+W}var X=tQ.write(Z[0].slice(Y));for(var J=1;J<Q-1;J++)X+=tQ.write(Z[J]);return X+=tQ.end(Z[J].slice(0,W-2)),X}function vb($){let{bufferCache:Z,offset:Y}=$,Q=$.bigStrSize-Y-2;var W=Z.length,X=$.bigStrSize-$.totalChunkSize;if($.offset=X,X<=2){if(W===2)return Z[0].slice(Y,Z[0].length+X-2);W--,X=Z[Z.length-2].length+X}fb(Q);let J=T0;Z[0].copy(v6,J,Y,Z[0].length),T0+=Z[0].length-Y;for(var z=1;z<W-1;z++)Z[z].copy(v6,T0),T0+=Z[z].length;return Z[z].copy(v6,T0,0,X-2),T0+=X-2,v6.slice(J,T0)}class BM{constructor($){if(!$)throw new TypeError("Options are mandatory.");if(typeof $.returnError!=="function"||typeof $.returnReply!=="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!$.returnBuffers),this.setStringNumbers(!!$.stringNumbers),this.returnError=$.returnError,this.returnFatalError=$.returnFatalError||$.returnError,this.returnReply=$.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers($){if(typeof $!=="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=$}setStringNumbers($){if(typeof $!=="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=$}execute($){if(this.buffer===null)this.buffer=$,this.offset=0;else if(this.bigStrSize===0){let Y=this.buffer.length,Q=Y-this.offset,W=eQ.allocUnsafe(Q+$.length);if(this.buffer.copy(W,0,this.offset,Y),$.copy(W,Q,0,$.length),this.buffer=W,this.offset=0,this.arrayCache.length){let X=aQ(this);if(X===void 0)return;this.returnReply(X)}}else if(this.totalChunkSize+$.length>=this.bigStrSize){this.bufferCache.push($);var Z=this.optionReturnBuffers?vb(this):yb(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=$,this.arrayCache.length){if(this.arrayCache[0][this.arrayPos[0]++]=Z,Z=aQ(this),Z===void 0)return}this.returnReply(Z)}else{this.bufferCache.push($),this.totalChunkSize+=$.length;return}while(this.offset<this.buffer.length){let Y=this.offset,Q=this.buffer[this.offset++],W=MM(this,Q);if(W===void 0){if(!(this.arrayCache.length||this.bufferCache.length))this.offset=Y;return}if(Q===45)this.returnError(W);else this.returnReply(W)}this.buffer=null}}wM.exports=BM});var NM=C((AM)=>{Object.defineProperty(AM,"__esModule",{value:!0});class DM{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add($,Z){this.set[$W($)][Z]=!0}del($,Z){delete this.set[$W($)][Z]}channels($){return Object.keys(this.set[$W($)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}}AM.default=DM;function $W($){if($==="unsubscribe")return"subscribe";if($==="punsubscribe")return"psubscribe";if($==="sunsubscribe")return"ssubscribe";return $}});var RM=C((KM)=>{Object.defineProperty(KM,"__esModule",{value:!0});var LM=R8(),hb=B0(),mb=HM(),ub=NM(),cb=hb.Debug("dataHandler");class PM{constructor($,Z){this.redis=$;let Y=new mb({stringNumbers:Z.stringNumbers,returnBuffers:!0,returnError:(Q)=>{this.returnError(Q)},returnFatalError:(Q)=>{this.returnFatalError(Q)},returnReply:(Q)=>{this.returnReply(Q)}});$.stream.prependListener("data",(Q)=>{Y.execute(Q)}),$.stream.resume()}returnFatalError($){$.message+=". Please report this.",this.redis.recoverFromFatalError($,$,{offlineQueue:!1})}returnError($){let Z=this.shiftCommand($);if(!Z)return;$.command={name:Z.command.name,args:Z.command.args},this.redis.handleReconnection($,Z)}returnReply($){if(this.handleMonitorReply($))return;if(this.handleSubscriberReply($))return;let Z=this.shiftCommand($);if(!Z)return;if(LM.default.checkFlag("ENTER_SUBSCRIBER_MODE",Z.command.name)){if(this.redis.condition.subscriber=new ub.default,this.redis.condition.subscriber.add(Z.command.name,$[1].toString()),!OM(Z.command,$[2]))this.redis.commandQueue.unshift(Z)}else if(LM.default.checkFlag("EXIT_SUBSCRIBER_MODE",Z.command.name)){if(!FM(Z.command,$[2]))this.redis.commandQueue.unshift(Z)}else Z.command.resolve($)}handleSubscriberReply($){if(!this.redis.condition.subscriber)return!1;let Z=Array.isArray($)?$[0].toString():null;switch(cb('receive reply "%s" in subscriber mode',Z),Z){case"message":if(this.redis.listeners("message").length>0)this.redis.emit("message",$[1].toString(),$[2]?$[2].toString():"");this.redis.emit("messageBuffer",$[1],$[2]);break;case"pmessage":{let Y=$[1].toString();if(this.redis.listeners("pmessage").length>0)this.redis.emit("pmessage",Y,$[2].toString(),$[3].toString());this.redis.emit("pmessageBuffer",Y,$[2],$[3]);break}case"smessage":{if(this.redis.listeners("smessage").length>0)this.redis.emit("smessage",$[1].toString(),$[2]?$[2].toString():"");this.redis.emit("smessageBuffer",$[1],$[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let Y=$[1].toString();this.redis.condition.subscriber.add(Z,Y);let Q=this.shiftCommand($);if(!Q)return;if(!OM(Q.command,$[2]))this.redis.commandQueue.unshift(Q);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let Y=$[1]?$[1].toString():null;if(Y)this.redis.condition.subscriber.del(Z,Y);let Q=$[2];if(Number(Q)===0)this.redis.condition.subscriber=!1;let W=this.shiftCommand($);if(!W)return;if(!FM(W.command,Q))this.redis.commandQueue.unshift(W);break}default:{let Y=this.shiftCommand($);if(!Y)return;Y.command.resolve($)}}return!0}handleMonitorReply($){if(this.redis.status!=="monitoring")return!1;let Z=$.toString();if(Z==="OK")return!1;let Y=Z.indexOf(" "),Q=Z.slice(0,Y),W=Z.indexOf('"'),X=Z.slice(W+1,-1).split('" "').map((z)=>z.replace(/\\"/g,'"')),J=Z.slice(Y+2,W-2).split(" ");return this.redis.emit("monitor",Q,X,J[1],J[0]),!0}shiftCommand($){let Z=this.redis.commandQueue.shift();if(!Z){let Q=new Error("Command queue state error. If you can reproduce this, please report it."+($ instanceof Error?` Last error: ${$.message}`:` Last reply: ${$.toString()}`));return this.redis.emit("error",Q),null}return Z}}KM.default=PM;var $4=new WeakMap;function OM($,Z){let Y=$4.has($)?$4.get($):$.args.length;if(Y-=1,Y<=0)return $.resolve(Z),$4.delete($),!0;return $4.set($,Y),!1}function FM($,Z){let Y=$4.has($)?$4.get($):$.args.length;if(Y===0){if(Number(Z)===0)return $4.delete($),$.resolve(Z),!0;return!1}if(Y-=1,Y<=0)return $.resolve(Z),!0;return $4.set($,Y),!1}});var CM=C((jM)=>{Object.defineProperty(jM,"__esModule",{value:!0});jM.readyHandler=jM.errorHandler=jM.closeHandler=jM.connectHandler=void 0;var ib=R4(),lb=R8(),nb=zM(),KZ=B0(),ob=RM(),P0=KZ.Debug("connection");function tb($){return function(){$.setStatus("connect"),$.resetCommandQueue();let Z=!1,{connectionEpoch:Y}=$;if($.condition.auth)$.auth($.condition.auth,function(Q){if(Y!==$.connectionEpoch)return;if(Q)if(Q.message.indexOf("no password is set")!==-1)console.warn("[WARN] Redis server does not require a password, but a password was supplied.");else if(Q.message.indexOf("without any password configured for the default user")!==-1)console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied");else if(Q.message.indexOf("wrong number of arguments for 'auth' command")!==-1)console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`);else Z=!0,$.recoverFromFatalError(Q,Q)});if($.condition.select)$.select($.condition.select).catch((Q)=>{$.silentEmit("error",Q)});if(!$.options.enableReadyCheck)jM.readyHandler($)();if(new ob.default($,{stringNumbers:$.options.stringNumbers}),$.options.enableReadyCheck)$._readyCheck(function(Q,W){if(Y!==$.connectionEpoch)return;if(Q){if(!Z)$.recoverFromFatalError(new Error("Ready check failed: "+Q.message),Q)}else if($.connector.check(W))jM.readyHandler($)();else $.disconnect(!0)})}}jM.connectHandler=tb;function ZW($){let Z=new ib.AbortError("Command aborted due to connection close");return Z.command={name:$.name,args:$.args},Z}function sb($){var Z;let Y=0;for(let Q=0;Q<$.length;){let W=(Z=$.peekAt(Q))===null||Z===void 0?void 0:Z.command,X=W.pipelineIndex;if(X===void 0||X===0)Y=0;if(X!==void 0&&X!==Y++){$.remove(Q,1),W.reject(ZW(W));continue}Q++}}function rb($){var Z;for(let Y=0;Y<$.length;){let Q=(Z=$.peekAt(Y))===null||Z===void 0?void 0:Z.command;if(Q.name==="multi")break;if(Q.name==="exec"){$.remove(Y,1),Q.reject(ZW(Q));break}if(Q.inTransaction)$.remove(Y,1),Q.reject(ZW(Q));else Y++}}function ab($){return function(){let Y=$.status;if($.setStatus("close"),$.commandQueue.length)sb($.commandQueue);if($.offlineQueue.length)rb($.offlineQueue);if(Y==="ready"){if(!$.prevCondition)$.prevCondition=$.condition;if($.commandQueue.length)$.prevCommandQueue=$.commandQueue}if($.manuallyClosing)return $.manuallyClosing=!1,P0("skip reconnecting since the connection is manually closed."),Z();if(typeof $.options.retryStrategy!=="function")return P0("skip reconnecting because `retryStrategy` is not a function"),Z();let Q=$.options.retryStrategy(++$.retryAttempts);if(typeof Q!=="number")return P0("skip reconnecting because `retryStrategy` doesn't return a number"),Z();P0("reconnect in %sms",Q),$.setStatus("reconnecting",Q),$.reconnectTimeout=setTimeout(function(){$.reconnectTimeout=null,$.connect().catch(KZ.noop)},Q);let{maxRetriesPerRequest:W}=$.options;if(typeof W==="number"){if(W<0)P0("maxRetriesPerRequest is negative, ignoring...");else if($.retryAttempts%(W+1)===0)P0("reach maxRetriesPerRequest limitation, flushing command queue..."),$.flushQueue(new nb.MaxRetriesPerRequestError(W))}};function Z(){$.setStatus("end"),$.flushQueue(new Error(KZ.CONNECTION_CLOSED_ERROR_MSG))}}jM.closeHandler=ab;function eb($){return function(Z){P0("error: %s",Z),$.silentEmit("error",Z)}}jM.errorHandler=eb;function $x($){return function(){if($.setStatus("ready"),$.retryAttempts=0,$.options.monitor){$.call("monitor").then(()=>$.setStatus("monitoring"),(Q)=>$.emit("error",Q));let{sendCommand:Y}=$;$.sendCommand=function(Q){if(lb.default.checkFlag("VALID_IN_MONITOR_MODE",Q.name))return Y.call($,Q);return Q.reject(new Error("Connection is in monitoring mode, can't process commands.")),Q.promise},$.once("close",function(){delete $.sendCommand});return}let Z=$.prevCondition?$.prevCondition.select:$.condition.select;if($.options.connectionName)P0("set the connection name [%s]",$.options.connectionName),$.client("setname",$.options.connectionName).catch(KZ.noop);if($.options.readOnly)P0("set the connection to readonly mode"),$.readonly().catch(KZ.noop);if($.prevCondition){let Y=$.prevCondition;if($.prevCondition=null,Y.subscriber&&$.options.autoResubscribe){if($.condition.select!==Z)P0("connect to db [%d]",Z),$.select(Z);let Q=Y.subscriber.channels("subscribe");if(Q.length)P0("subscribe %d channels",Q.length),$.subscribe(Q);let W=Y.subscriber.channels("psubscribe");if(W.length)P0("psubscribe %d channels",W.length),$.psubscribe(W);let X=Y.subscriber.channels("ssubscribe");if(X.length)P0("ssubscribe %d channels",X.length),$.ssubscribe(X)}}if($.prevCommandQueue)if($.options.autoResendUnfulfilledCommands){P0("resend %d unfulfilled commands",$.prevCommandQueue.length);while($.prevCommandQueue.length>0){let Y=$.prevCommandQueue.shift();if(Y.select!==$.condition.select&&Y.command.name!=="select")$.select(Y.select);$.sendCommand(Y.command,Y.stream)}}else $.prevCommandQueue=null;if($.offlineQueue.length){P0("send %d commands in offline queue",$.offlineQueue.length);let Y=$.offlineQueue;$.resetOfflineQueue();while(Y.length>0){let Q=Y.shift();if(Q.select!==$.condition.select&&Q.command.name!=="select")$.select(Q.select);$.sendCommand(Q.command,Q.stream)}}if($.condition.select!==Z)P0("connect to db [%d]",Z),$.select(Z)}}jM.readyHandler=$x});var EM=C((_M)=>{Object.defineProperty(_M,"__esModule",{value:!0});_M.DEFAULT_REDIS_OPTIONS=void 0;_M.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2000,retryStrategy:function($){return Math.min($*50,2000)},keepAlive:0,noDelay:!0,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function($){return Math.min($*10,1000)},sentinelReconnectStrategy:function(){return 60000},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var e8=C((xM)=>{Object.defineProperty(xM,"__esModule",{value:!0});var IM=B$(),bM=U1("events"),YW=s8(),Wx=nQ(),QW=R8(),Xx=ZM(),Jx=F9(),Z4=CM(),zx=EM(),Ux=B9(),Sx=hQ(),_4=B0(),qx=mQ(),Gx=D9(),Y4=G9(),TM=N9(),Q4=_4.Debug("redis");class a6 extends Gx.default{constructor($,Z,Y){super();if(this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions($,Z,Y),bM.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let Q=new Jx.default(this.options);Q.emitter=this,this.connector=Q}else this.connector=new Xx.StandaloneConnector(this.options);if(this.options.scripts)Object.entries(this.options.scripts).forEach(([Q,W])=>{this.defineCommand(Q,W)});if(this.options.lazyConnect)this.setStatus("wait");else this.connect().catch(Y4.noop)}static createClient(...$){return new a6(...$)}get autoPipelineQueueSize(){let $=0;for(let Z of this._autoPipelines.values())$+=Z.length;return $}connect($){let Z=new Promise((Y,Q)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){Q(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:W}=this;this.condition={select:W.db,auth:W.username?[W.username,W.password]:W.password,subscriber:!1};let X=this;YW.default(this.connector.connect(function(J,z){X.silentEmit(J,z)}),function(J,z){if(J){X.flushQueue(J),X.silentEmit("error",J),Q(J),X.setStatus("end");return}let U=W.tls?"secureConnect":"connect";if("sentinels"in W&&W.sentinels&&!W.enableTLSForSentinelMode)U="connect";if(X.stream=z,W.noDelay)z.setNoDelay(!0);if(typeof W.keepAlive==="number")if(z.connecting)z.once(U,()=>{z.setKeepAlive(!0,W.keepAlive)});else z.setKeepAlive(!0,W.keepAlive);if(z.connecting){if(z.once(U,Z4.connectHandler(X)),W.connectTimeout){let M=!1;z.setTimeout(W.connectTimeout,function(){if(M)return;z.setTimeout(0),z.destroy();let H=new Error("connect ETIMEDOUT");H.errorno="ETIMEDOUT",H.code="ETIMEDOUT",H.syscall="connect",Z4.errorHandler(X)(H)}),z.once(U,function(){M=!0,z.setTimeout(0)})}}else if(z.destroyed){let M=X.connector.firstError;if(M)process.nextTick(()=>{Z4.errorHandler(X)(M)});process.nextTick(Z4.closeHandler(X))}else process.nextTick(Z4.connectHandler(X));if(!z.destroyed)z.once("error",Z4.errorHandler(X)),z.once("close",Z4.closeHandler(X));let S=function(){X.removeListener("close",q),Y()};var q=function(){X.removeListener("ready",S),Q(new Error(_4.CONNECTION_CLOSED_ERROR_MSG))};X.once("ready",S),X.once("close",q)})});return YW.default(Z,$)}disconnect($=!1){if(!$)this.manuallyClosing=!0;if(this.reconnectTimeout&&!$)clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null;if(this.status==="wait")Z4.closeHandler(this)();else this.connector.disconnect()}end(){this.disconnect()}duplicate($){return new a6({...this.options,...$})}get mode(){var $;return this.options.monitor?"monitor":(($=this.condition)===null||$===void 0?void 0:$.subscriber)?"subscriber":"normal"}monitor($){let Z=this.duplicate({monitor:!0,lazyConnect:!1});return YW.default(new Promise(function(Y,Q){Z.once("error",Q),Z.once("monitoring",function(){Y(Z)})}),$)}sendCommand($,Z){var Y,Q;if(this.status==="wait")this.connect().catch(Y4.noop);if(this.status==="end")return $.reject(new Error(_4.CONNECTION_CLOSED_ERROR_MSG)),$.promise;if(((Y=this.condition)===null||Y===void 0?void 0:Y.subscriber)&&!QW.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",$.name))return $.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),$.promise;if(typeof this.options.commandTimeout==="number")$.setTimeout(this.options.commandTimeout);let W=this.status==="ready"||!Z&&this.status==="connect"&&IM.exists($.name)&&IM.hasFlag($.name,"loading");if(!this.stream)W=!1;else if(!this.stream.writable)W=!1;else if(this.stream._writableState&&this.stream._writableState.ended)W=!1;if(!W){if(!this.options.enableOfflineQueue)return $.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),$.promise;if($.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),$.resolve(Buffer.from("OK")),$.promise;if(Q4.enabled)Q4("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,$.name,$.args);this.offlineQueue.push({command:$,stream:Z,select:this.condition.select})}else{if(Q4.enabled)Q4("write command[%s]: %d -> %s(%o)",this._getDescription(),(Q=this.condition)===null||Q===void 0?void 0:Q.select,$.name,$.args);if(Z)if("isPipeline"in Z&&Z.isPipeline)Z.write($.toWritable(Z.destination.redis.stream));else Z.write($.toWritable(Z));else this.stream.write($.toWritable(this.stream));if(this.commandQueue.push({command:$,stream:Z,select:this.condition.select}),QW.default.checkFlag("WILL_DISCONNECT",$.name))this.manuallyClosing=!0;if(this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0)this.setSocketTimeout()}if($.name==="select"&&_4.isInt($.args[0])){let X=parseInt($.args[0],10);if(this.condition.select!==X)this.condition.select=X,this.emit("select",X),Q4("switch to db [%d]",this.condition.select)}return $.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{if(clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length===0)return;this.setSocketTimeout()})}scanStream($){return this.createScanStream("scan",{options:$})}scanBufferStream($){return this.createScanStream("scanBuffer",{options:$})}sscanStream($,Z){return this.createScanStream("sscan",{key:$,options:Z})}sscanBufferStream($,Z){return this.createScanStream("sscanBuffer",{key:$,options:Z})}hscanStream($,Z){return this.createScanStream("hscan",{key:$,options:Z})}hscanBufferStream($,Z){return this.createScanStream("hscanBuffer",{key:$,options:Z})}zscanStream($,Z){return this.createScanStream("zscan",{key:$,options:Z})}zscanBufferStream($,Z){return this.createScanStream("zscanBuffer",{key:$,options:Z})}silentEmit($,Z){let Y;if($==="error"){if(Y=Z,this.status==="end")return;if(this.manuallyClosing){if(Y instanceof Error&&(Y.message===_4.CONNECTION_CLOSED_ERROR_MSG||Y.syscall==="connect"||Y.syscall==="read"))return}}if(this.listeners($).length>0)return this.emit.apply(this,arguments);if(Y&&Y instanceof Error)console.error("[ioredis] Unhandled error event:",Y.stack);return!1}recoverFromFatalError($,Z,Y){this.flushQueue(Z,Y),this.silentEmit("error",Z),this.disconnect(!0)}handleReconnection($,Z){var Y;let Q=!1;if(this.options.reconnectOnError)Q=this.options.reconnectOnError($);switch(Q){case 1:case!0:if(this.status!=="reconnecting")this.disconnect(!0);Z.command.reject($);break;case 2:if(this.status!=="reconnecting")this.disconnect(!0);if(((Y=this.condition)===null||Y===void 0?void 0:Y.select)!==Z.select&&Z.command.name!=="select")this.select(Z.select);this.sendCommand(Z.command);break;default:Z.command.reject($)}}_getDescription(){let $;if("path"in this.options&&this.options.path)$=this.options.path;else if(this.stream&&this.stream.remoteAddress&&this.stream.remotePort)$=this.stream.remoteAddress+":"+this.stream.remotePort;else if("host"in this.options&&this.options.host)$=this.options.host+":"+this.options.port;else $="";if(this.options.connectionName)$+=` (${this.options.connectionName})`;return $}resetCommandQueue(){this.commandQueue=new TM}resetOfflineQueue(){this.offlineQueue=new TM}parseOptions(...$){let Z={},Y=!1;for(let Q=0;Q<$.length;++Q){let W=$[Q];if(W===null||typeof W==="undefined")continue;if(typeof W==="object")Y4.defaults(Z,W);else if(typeof W==="string"){if(Y4.defaults(Z,_4.parseURL(W)),W.startsWith("rediss://"))Y=!0}else if(typeof W==="number")Z.port=W;else throw new Error("Invalid argument "+W)}if(Y)Y4.defaults(Z,{tls:!0});if(Y4.defaults(Z,a6.defaultOptions),typeof Z.port==="string")Z.port=parseInt(Z.port,10);if(typeof Z.db==="string")Z.db=parseInt(Z.db,10);this.options=_4.resolveTLSProfile(Z)}setStatus($,Z){if(Q4.enabled)Q4("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",$);this.status=$,process.nextTick(this.emit.bind(this,$,Z))}createScanStream($,{key:Z,options:Y={}}){return new Ux.default({objectMode:!0,key:Z,redis:this,command:$,...Y})}flushQueue($,Z){Z=Y4.defaults({},Z,{offlineQueue:!0,commandQueue:!0});let Y;if(Z.offlineQueue)while(Y=this.offlineQueue.shift())Y.command.reject($);if(Z.commandQueue){if(this.commandQueue.length>0){if(this.stream)this.stream.removeAllListeners("data");while(Y=this.commandQueue.shift())Y.command.reject($)}}}_readyCheck($){let Z=this;this.info(function(Y,Q){if(Y){if(Y.message&&Y.message.includes("NOPERM"))return console.warn(`Skipping the ready check because INFO command fails: "${Y.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),$(null,{});return $(Y)}if(typeof Q!=="string")return $(null,Q);let W={},X=Q.split(`\r
`);for(let J=0;J<X.length;++J){let[z,...U]=X[J].split(":"),S=U.join(":");if(S)W[z]=S}if(!W.loading||W.loading==="0")$(null,W);else{let J=(W.loading_eta_seconds||1)*1000,z=Z.options.maxLoadingRetryTime&&Z.options.maxLoadingRetryTime<J?Z.options.maxLoadingRetryTime:J;Q4("Redis server still loading, trying again in "+z+"ms"),setTimeout(function(){Z._readyCheck($)},z)}}).catch(Y4.noop)}}a6.Cluster=Wx.default;a6.Command=QW.default;a6.defaultOptions=zx.DEFAULT_REDIS_OPTIONS;qx.default(a6,bM.EventEmitter);Sx.addTransactionSupport(a6.prototype);xM.default=a6});var fM=C((b0,gM)=>{Object.defineProperty(b0,"__esModule",{value:!0});b0.print=b0.ReplyError=b0.SentinelIterator=b0.SentinelConnector=b0.AbstractConnector=b0.Pipeline=b0.ScanStream=b0.Command=b0.Cluster=b0.Redis=b0.default=void 0;b0=gM.exports=e8().default;var Bx=e8();Object.defineProperty(b0,"default",{enumerable:!0,get:function(){return Bx.default}});var wx=e8();Object.defineProperty(b0,"Redis",{enumerable:!0,get:function(){return wx.default}});var Hx=nQ();Object.defineProperty(b0,"Cluster",{enumerable:!0,get:function(){return Hx.default}});var Dx=R8();Object.defineProperty(b0,"Command",{enumerable:!0,get:function(){return Dx.default}});var Ax=B9();Object.defineProperty(b0,"ScanStream",{enumerable:!0,get:function(){return Ax.default}});var Nx=yQ();Object.defineProperty(b0,"Pipeline",{enumerable:!0,get:function(){return Nx.default}});var Lx=O9();Object.defineProperty(b0,"AbstractConnector",{enumerable:!0,get:function(){return Lx.default}});var kM=F9();Object.defineProperty(b0,"SentinelConnector",{enumerable:!0,get:function(){return kM.default}});Object.defineProperty(b0,"SentinelIterator",{enumerable:!0,get:function(){return kM.SentinelIterator}});b0.ReplyError=R4().ReplyError;Object.defineProperty(b0,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set($){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function Ox($,Z){if($)console.log("Error: "+$);else console.log("Reply: "+Z)}b0.print=Ox});var D0={};J4(D0,{IsUndefined:()=>t1,IsUint8Array:()=>Y8,IsSymbol:()=>I9,IsString:()=>_1,IsRegExp:()=>O$,IsObject:()=>F1,IsNumber:()=>o0,IsNull:()=>E9,IsIterator:()=>V9,IsFunction:()=>_9,IsDate:()=>z4,IsBoolean:()=>Z8,IsBigInt:()=>L$,IsAsyncIterator:()=>C9,IsArray:()=>o1,HasPropertyKey:()=>CZ});function CZ($,Z){return Z in $}function C9($){return F1($)&&!o1($)&&!Y8($)&&Symbol.asyncIterator in $}function o1($){return Array.isArray($)}function L$($){return typeof $==="bigint"}function Z8($){return typeof $==="boolean"}function z4($){return $ instanceof globalThis.Date}function _9($){return typeof $==="function"}function V9($){return F1($)&&!o1($)&&!Y8($)&&Symbol.iterator in $}function E9($){return $===null}function o0($){return typeof $==="number"}function F1($){return typeof $==="object"&&$!==null}function O$($){return $ instanceof globalThis.RegExp}function _1($){return typeof $==="string"}function I9($){return typeof $==="symbol"}function Y8($){return $ instanceof globalThis.Uint8Array}function t1($){return $===void 0}function rM($){return $.map((Z)=>_Z(Z))}function aM($){return new Date($.getTime())}function eM($){return new Uint8Array($)}function $B($){return new RegExp($.source,$.flags)}function ZB($){let Z={};for(let Y of Object.getOwnPropertyNames($))Z[Y]=_Z($[Y]);for(let Y of Object.getOwnPropertySymbols($))Z[Y]=_Z($[Y]);return Z}function _Z($){return o1($)?rM($):z4($)?aM($):Y8($)?eM($):O$($)?$B($):F1($)?ZB($):$}function x1($){return _Z($)}function I4($,Z){return Z===void 0?x1($):x1({...Z,...$})}function VZ($){return a($)&&globalThis.Symbol.asyncIterator in $}function EZ($){return a($)&&globalThis.Symbol.iterator in $}function T9($){return a($)&&(globalThis.Object.getPrototypeOf($)===Object.prototype||globalThis.Object.getPrototypeOf($)===null)}function IZ($){return $ instanceof globalThis.Promise}function K0($){return $ instanceof Date&&globalThis.Number.isFinite($.getTime())}function XW($){return $ instanceof globalThis.Map}function JW($){return $ instanceof globalThis.Set}function X6($){return globalThis.ArrayBuffer.isView($)}function T4($){return $ instanceof globalThis.Uint8Array}function n($,Z){return Z in $}function a($){return $!==null&&typeof $==="object"}function o($){return globalThis.Array.isArray($)&&!globalThis.ArrayBuffer.isView($)}function k1($){return $===void 0}function Q8($){return $===null}function h6($){return typeof $==="boolean"}function c($){return typeof $==="number"}function TZ($){return globalThis.Number.isInteger($)}function q0($){return typeof $==="bigint"}function J1($){return typeof $==="string"}function I8($){return typeof $==="function"}function W8($){return typeof $==="symbol"}function t0($){return q0($)||h6($)||Q8($)||c($)||J1($)||W8($)||k1($)}var E1;(function($){$.InstanceMode="default",$.ExactOptionalPropertyTypes=!1,$.AllowArrayObject=!1,$.AllowNaN=!1,$.AllowNullVoid=!1;function Z(J,z){return $.ExactOptionalPropertyTypes?z in J:J[z]!==void 0}$.IsExactOptionalProperty=Z;function Y(J){let z=a(J);return $.AllowArrayObject?z:z&&!o(J)}$.IsObjectLike=Y;function Q(J){return Y(J)&&!(J instanceof Date)&&!(J instanceof Uint8Array)}$.IsRecordLike=Q;function W(J){return $.AllowNaN?c(J):Number.isFinite(J)}$.IsNumberLike=W;function X(J){let z=k1(J);return $.AllowNullVoid?z||J===null:z}$.IsVoidLike=X})(E1||(E1={}));function YB($){return globalThis.Object.freeze($).map((Z)=>F$(Z))}function QB($){return $}function WB($){return $}function XB($){return $}function JB($){let Z={};for(let Y of Object.getOwnPropertyNames($))Z[Y]=F$($[Y]);for(let Y of Object.getOwnPropertySymbols($))Z[Y]=F$($[Y]);return globalThis.Object.freeze(Z)}function F$($){return o1($)?YB($):z4($)?QB($):Y8($)?WB($):O$($)?XB($):F1($)?JB($):$}function R($,Z){let Y=Z!==void 0?{...Z,...$}:$;switch(E1.InstanceMode){case"freeze":return F$(Y);case"clone":return x1(Y);default:return Y}}class i extends Error{constructor($){super($)}}var R1=Symbol.for("TypeBox.Transform"),N6=Symbol.for("TypeBox.Readonly"),s1=Symbol.for("TypeBox.Optional"),J6=Symbol.for("TypeBox.Hint"),L=Symbol.for("TypeBox.Kind");function b4($){return F1($)&&$[N6]==="Readonly"}function x0($){return F1($)&&$[s1]==="Optional"}function b9($){return W1($,"Any")}function x9($){return W1($,"Argument")}function L6($){return W1($,"Array")}function U4($){return W1($,"AsyncIterator")}function S4($){return W1($,"BigInt")}function X8($){return W1($,"Boolean")}function O6($){return W1($,"Computed")}function F6($){return W1($,"Constructor")}function zB($){return W1($,"Date")}function P6($){return W1($,"Function")}function K6($){return W1($,"Integer")}function m1($){return W1($,"Intersect")}function q4($){return W1($,"Iterator")}function W1($,Z){return F1($)&&L in $&&$[L]===Z}function bZ($){return Z8($)||o0($)||_1($)}function s0($){return W1($,"Literal")}function r0($){return W1($,"MappedKey")}function g1($){return W1($,"MappedResult")}function T8($){return W1($,"Never")}function UB($){return W1($,"Not")}function P$($){return W1($,"Null")}function R6($){return W1($,"Number")}function r1($){return W1($,"Object")}function G4($){return W1($,"Promise")}function M4($){return W1($,"Record")}function l1($){return W1($,"Ref")}function k9($){return W1($,"RegExp")}function J8($){return W1($,"String")}function K$($){return W1($,"Symbol")}function a0($){return W1($,"TemplateLiteral")}function SB($){return W1($,"This")}function H1($){return F1($)&&R1 in $}function e0($){return W1($,"Tuple")}function z8($){return W1($,"Undefined")}function z1($){return W1($,"Union")}function qB($){return W1($,"Uint8Array")}function GB($){return W1($,"Unknown")}function MB($){return W1($,"Unsafe")}function BB($){return W1($,"Void")}function b8($){return F1($)&&L in $&&_1($[L])}function d1($){return b9($)||x9($)||L6($)||X8($)||S4($)||U4($)||O6($)||F6($)||zB($)||P6($)||K6($)||m1($)||q4($)||s0($)||r0($)||g1($)||T8($)||UB($)||P$($)||R6($)||r1($)||G4($)||M4($)||l1($)||k9($)||J8($)||K$($)||a0($)||SB($)||e0($)||z8($)||z1($)||qB($)||GB($)||MB($)||BB($)||b8($)}var A={};J4(A,{TypeGuardUnknownTypeError:()=>zW,IsVoid:()=>oW,IsUnsafe:()=>nW,IsUnknown:()=>lW,IsUnionLiteral:()=>PB,IsUnion:()=>y9,IsUndefined:()=>pW,IsUint8Array:()=>iW,IsTuple:()=>cW,IsTransform:()=>uW,IsThis:()=>mW,IsTemplateLiteral:()=>hW,IsSymbol:()=>dW,IsString:()=>vW,IsSchema:()=>f1,IsRegExp:()=>yW,IsRef:()=>fW,IsRecursive:()=>FB,IsRecord:()=>gW,IsReadonly:()=>AB,IsProperties:()=>xZ,IsPromise:()=>kW,IsOptional:()=>NB,IsObject:()=>xW,IsNumber:()=>bW,IsNull:()=>TW,IsNot:()=>IW,IsNever:()=>EW,IsMappedResult:()=>VW,IsMappedKey:()=>_W,IsLiteralValue:()=>CW,IsLiteralString:()=>RW,IsLiteralNumber:()=>jW,IsLiteralBoolean:()=>OB,IsLiteral:()=>j$,IsKindOf:()=>Z1,IsKind:()=>tW,IsIterator:()=>KW,IsIntersect:()=>PW,IsInteger:()=>FW,IsImport:()=>LB,IsFunction:()=>OW,IsDate:()=>LW,IsConstructor:()=>NW,IsComputed:()=>AW,IsBoolean:()=>DW,IsBigInt:()=>HW,IsAsyncIterator:()=>wW,IsArray:()=>BW,IsArgument:()=>MW,IsAny:()=>GW});class zW extends i{}var wB=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function UW($){try{return new RegExp($),!0}catch{return!1}}function g9($){if(!_1($))return!1;for(let Z=0;Z<$.length;Z++){let Y=$.charCodeAt(Z);if(Y>=7&&Y<=13||Y===27||Y===127)return!1}return!0}function SW($){return f9($)||f1($)}function R$($){return t1($)||L$($)}function V1($){return t1($)||o0($)}function f9($){return t1($)||Z8($)}function P1($){return t1($)||_1($)}function HB($){return t1($)||_1($)&&g9($)&&UW($)}function DB($){return t1($)||_1($)&&g9($)}function qW($){return t1($)||f1($)}function AB($){return F1($)&&$[N6]==="Readonly"}function NB($){return F1($)&&$[s1]==="Optional"}function GW($){return Z1($,"Any")&&P1($.$id)}function MW($){return Z1($,"Argument")&&o0($.index)}function BW($){return Z1($,"Array")&&$.type==="array"&&P1($.$id)&&f1($.items)&&V1($.minItems)&&V1($.maxItems)&&f9($.uniqueItems)&&qW($.contains)&&V1($.minContains)&&V1($.maxContains)}function wW($){return Z1($,"AsyncIterator")&&$.type==="AsyncIterator"&&P1($.$id)&&f1($.items)}function HW($){return Z1($,"BigInt")&&$.type==="bigint"&&P1($.$id)&&R$($.exclusiveMaximum)&&R$($.exclusiveMinimum)&&R$($.maximum)&&R$($.minimum)&&R$($.multipleOf)}function DW($){return Z1($,"Boolean")&&$.type==="boolean"&&P1($.$id)}function AW($){return Z1($,"Computed")&&_1($.target)&&o1($.parameters)&&$.parameters.every((Z)=>f1(Z))}function NW($){return Z1($,"Constructor")&&$.type==="Constructor"&&P1($.$id)&&o1($.parameters)&&$.parameters.every((Z)=>f1(Z))&&f1($.returns)}function LW($){return Z1($,"Date")&&$.type==="Date"&&P1($.$id)&&V1($.exclusiveMaximumTimestamp)&&V1($.exclusiveMinimumTimestamp)&&V1($.maximumTimestamp)&&V1($.minimumTimestamp)&&V1($.multipleOfTimestamp)}function OW($){return Z1($,"Function")&&$.type==="Function"&&P1($.$id)&&o1($.parameters)&&$.parameters.every((Z)=>f1(Z))&&f1($.returns)}function LB($){return Z1($,"Import")&&CZ($,"$defs")&&F1($.$defs)&&xZ($.$defs)&&CZ($,"$ref")&&_1($.$ref)&&$.$ref in $.$defs}function FW($){return Z1($,"Integer")&&$.type==="integer"&&P1($.$id)&&V1($.exclusiveMaximum)&&V1($.exclusiveMinimum)&&V1($.maximum)&&V1($.minimum)&&V1($.multipleOf)}function xZ($){return F1($)&&Object.entries($).every(([Z,Y])=>g9(Z)&&f1(Y))}function PW($){return Z1($,"Intersect")&&(_1($.type)&&$.type!=="object"?!1:!0)&&o1($.allOf)&&$.allOf.every((Z)=>f1(Z)&&!uW(Z))&&P1($.type)&&(f9($.unevaluatedProperties)||qW($.unevaluatedProperties))&&P1($.$id)}function KW($){return Z1($,"Iterator")&&$.type==="Iterator"&&P1($.$id)&&f1($.items)}function Z1($,Z){return F1($)&&L in $&&$[L]===Z}function RW($){return j$($)&&_1($.const)}function jW($){return j$($)&&o0($.const)}function OB($){return j$($)&&Z8($.const)}function j$($){return Z1($,"Literal")&&P1($.$id)&&CW($.const)}function CW($){return Z8($)||o0($)||_1($)}function _W($){return Z1($,"MappedKey")&&o1($.keys)&&$.keys.every((Z)=>o0(Z)||_1(Z))}function VW($){return Z1($,"MappedResult")&&xZ($.properties)}function EW($){return Z1($,"Never")&&F1($.not)&&Object.getOwnPropertyNames($.not).length===0}function IW($){return Z1($,"Not")&&f1($.not)}function TW($){return Z1($,"Null")&&$.type==="null"&&P1($.$id)}function bW($){return Z1($,"Number")&&$.type==="number"&&P1($.$id)&&V1($.exclusiveMaximum)&&V1($.exclusiveMinimum)&&V1($.maximum)&&V1($.minimum)&&V1($.multipleOf)}function xW($){return Z1($,"Object")&&$.type==="object"&&P1($.$id)&&xZ($.properties)&&SW($.additionalProperties)&&V1($.minProperties)&&V1($.maxProperties)}function kW($){return Z1($,"Promise")&&$.type==="Promise"&&P1($.$id)&&f1($.item)}function gW($){return Z1($,"Record")&&$.type==="object"&&P1($.$id)&&SW($.additionalProperties)&&F1($.patternProperties)&&((Z)=>{let Y=Object.getOwnPropertyNames(Z.patternProperties);return Y.length===1&&UW(Y[0])&&F1(Z.patternProperties)&&f1(Z.patternProperties[Y[0]])})($)}function FB($){return F1($)&&J6 in $&&$[J6]==="Recursive"}function fW($){return Z1($,"Ref")&&P1($.$id)&&_1($.$ref)}function yW($){return Z1($,"RegExp")&&P1($.$id)&&_1($.source)&&_1($.flags)&&V1($.maxLength)&&V1($.minLength)}function vW($){return Z1($,"String")&&$.type==="string"&&P1($.$id)&&V1($.minLength)&&V1($.maxLength)&&HB($.pattern)&&DB($.format)}function dW($){return Z1($,"Symbol")&&$.type==="symbol"&&P1($.$id)}function hW($){return Z1($,"TemplateLiteral")&&$.type==="string"&&_1($.pattern)&&$.pattern[0]==="^"&&$.pattern[$.pattern.length-1]==="$"}function mW($){return Z1($,"This")&&P1($.$id)&&_1($.$ref)}function uW($){return F1($)&&R1 in $}function cW($){return Z1($,"Tuple")&&$.type==="array"&&P1($.$id)&&o0($.minItems)&&o0($.maxItems)&&$.minItems===$.maxItems&&(t1($.items)&&t1($.additionalItems)&&$.minItems===0||o1($.items)&&$.items.every((Z)=>f1(Z)))}function pW($){return Z1($,"Undefined")&&$.type==="undefined"&&P1($.$id)}function PB($){return y9($)&&$.anyOf.every((Z)=>RW(Z)||jW(Z))}function y9($){return Z1($,"Union")&&P1($.$id)&&F1($)&&o1($.anyOf)&&$.anyOf.every((Z)=>f1(Z))}function iW($){return Z1($,"Uint8Array")&&$.type==="Uint8Array"&&P1($.$id)&&V1($.minByteLength)&&V1($.maxByteLength)}function lW($){return Z1($,"Unknown")&&P1($.$id)}function nW($){return Z1($,"Unsafe")}function oW($){return Z1($,"Void")&&$.type==="void"&&P1($.$id)}function tW($){return F1($)&&L in $&&_1($[L])&&!wB.includes($[L])}function f1($){return F1($)&&(GW($)||MW($)||BW($)||DW($)||HW($)||wW($)||AW($)||NW($)||LW($)||OW($)||FW($)||PW($)||KW($)||j$($)||_W($)||VW($)||EW($)||IW($)||TW($)||bW($)||xW($)||kW($)||gW($)||fW($)||yW($)||vW($)||dW($)||hW($)||mW($)||cW($)||pW($)||y9($)||iW($)||lW($)||nW($)||oW($)||tW($))}var sW="(true|false)",kZ="(0|[1-9][0-9]*)",rW="(.*)";var m6="^(0|[1-9][0-9]*)$",u6="^(.*)$",aW="^(?!.*)$";var O1={};J4(O1,{Set:()=>_B,Has:()=>CB,Get:()=>VB,Entries:()=>KB,Delete:()=>jB,Clear:()=>RB});var x4=new Map;function KB(){return new Map(x4)}function RB(){return x4.clear()}function jB($){return x4.delete($)}function CB($){return x4.has($)}function _B($,Z){x4.set($,Z)}function VB($){return x4.get($)}var Y0={};J4(Y0,{Set:()=>xB,Has:()=>bB,Get:()=>kB,Entries:()=>EB,Delete:()=>TB,Clear:()=>IB});var k4=new Map;function EB(){return new Map(k4)}function IB(){return k4.clear()}function TB($){return k4.delete($)}function bB($){return k4.has($)}function xB($,Z){k4.set($,Z)}function kB($){return k4.get($)}function eW($,Z){return $.includes(Z)}function $7($){return[...new Set($)]}function gB($,Z){return $.filter((Y)=>Z.includes(Y))}function fB($,Z){return $.reduce((Y,Q)=>{return gB(Y,Q)},Z)}function Z7($){return $.length===1?$[0]:$.length>1?fB($.slice(1),$[0]):[]}function Y7($){let Z=[];for(let Y of $)Z.push(...Y);return Z}function x8($){return R({[L]:"Any"},$)}function g4($,Z){return R({[L]:"Array",type:"array",items:$},Z)}function Q7($){return R({[L]:"Argument",index:$})}function f4($,Z){return R({[L]:"AsyncIterator",type:"AsyncIterator",items:$},Z)}function I1($,Z,Y){return R({[L]:"Computed",target:$,parameters:Z},Y)}function yB($,Z){let{[Z]:Y,...Q}=$;return Q}function u1($,Z){return Z.reduce((Y,Q)=>yB(Y,Q),$)}function r($){return R({[L]:"Never",not:{}},$)}function G1($){return R({[L]:"MappedResult",properties:$})}function y4($,Z,Y){return R({[L]:"Constructor",type:"Constructor",parameters:$,returns:Z},Y)}function c6($,Z,Y){return R({[L]:"Function",type:"Function",parameters:$,returns:Z},Y)}function C$($,Z){return R({[L]:"Union",anyOf:$},Z)}function vB($){return $.some((Z)=>x0(Z))}function W7($){return $.map((Z)=>x0(Z)?dB(Z):Z)}function dB($){return u1($,[s1])}function hB($,Z){return vB($)?A0(C$(W7($),Z)):C$(W7($),Z)}function p6($,Z){return $.length===1?R($[0],Z):$.length===0?r(Z):hB($,Z)}function D1($,Z){return $.length===0?r(Z):$.length===1?R($[0],Z):C$($,Z)}class v9 extends i{}function mB($){return $.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function d9($,Z,Y){return $[Z]===Y&&$.charCodeAt(Z-1)!==92}function S8($,Z){return d9($,Z,"(")}function _$($,Z){return d9($,Z,")")}function X7($,Z){return d9($,Z,"|")}function uB($){if(!(S8($,0)&&_$($,$.length-1)))return!1;let Z=0;for(let Y=0;Y<$.length;Y++){if(S8($,Y))Z+=1;if(_$($,Y))Z-=1;if(Z===0&&Y!==$.length-1)return!1}return!0}function cB($){return $.slice(1,$.length-1)}function pB($){let Z=0;for(let Y=0;Y<$.length;Y++){if(S8($,Y))Z+=1;if(_$($,Y))Z-=1;if(X7($,Y)&&Z===0)return!0}return!1}function iB($){for(let Z=0;Z<$.length;Z++)if(S8($,Z))return!0;return!1}function lB($){let[Z,Y]=[0,0],Q=[];for(let X=0;X<$.length;X++){if(S8($,X))Z+=1;if(_$($,X))Z-=1;if(X7($,X)&&Z===0){let J=$.slice(Y,X);if(J.length>0)Q.push(v4(J));Y=X+1}}let W=$.slice(Y);if(W.length>0)Q.push(v4(W));if(Q.length===0)return{type:"const",const:""};if(Q.length===1)return Q[0];return{type:"or",expr:Q}}function nB($){function Z(W,X){if(!S8(W,X))throw new v9("TemplateLiteralParser: Index must point to open parens");let J=0;for(let z=X;z<W.length;z++){if(S8(W,z))J+=1;if(_$(W,z))J-=1;if(J===0)return[X,z]}throw new v9("TemplateLiteralParser: Unclosed group parens in expression")}function Y(W,X){for(let J=X;J<W.length;J++)if(S8(W,J))return[X,J];return[X,W.length]}let Q=[];for(let W=0;W<$.length;W++)if(S8($,W)){let[X,J]=Z($,W),z=$.slice(X,J+1);Q.push(v4(z)),W=J}else{let[X,J]=Y($,W),z=$.slice(X,J);if(z.length>0)Q.push(v4(z));W=J-1}return Q.length===0?{type:"const",const:""}:Q.length===1?Q[0]:{type:"and",expr:Q}}function v4($){return uB($)?v4(cB($)):pB($)?lB($):iB($)?nB($):{type:"const",const:mB($)}}function d4($){return v4($.slice(1,$.length-1))}class J7 extends i{}function oB($){return $.type==="or"&&$.expr.length===2&&$.expr[0].type==="const"&&$.expr[0].const==="0"&&$.expr[1].type==="const"&&$.expr[1].const==="[1-9][0-9]*"}function tB($){return $.type==="or"&&$.expr.length===2&&$.expr[0].type==="const"&&$.expr[0].const==="true"&&$.expr[1].type==="const"&&$.expr[1].const==="false"}function sB($){return $.type==="const"&&$.const===".*"}function B4($){return oB($)||sB($)?!1:tB($)?!0:$.type==="and"?$.expr.every((Z)=>B4(Z)):$.type==="or"?$.expr.every((Z)=>B4(Z)):$.type==="const"?!0:(()=>{throw new J7("Unknown expression type")})()}function gZ($){let Z=d4($.pattern);return B4(Z)}class z7 extends i{}function*U7($){if($.length===1)return yield*$[0];for(let Z of $[0])for(let Y of U7($.slice(1)))yield`${Z}${Y}`}function*rB($){return yield*U7($.expr.map((Z)=>[...V$(Z)]))}function*aB($){for(let Z of $.expr)yield*V$(Z)}function*eB($){return yield $.const}function*V$($){return $.type==="and"?yield*rB($):$.type==="or"?yield*aB($):$.type==="const"?yield*eB($):(()=>{throw new z7("Unknown expression")})()}function h4($){let Z=d4($.pattern);return B4(Z)?[...V$(Z)]:[]}function X1($,Z){return R({[L]:"Literal",const:$,type:typeof $},Z)}function fZ($){return R({[L]:"Boolean",type:"boolean"},$)}function m4($){return R({[L]:"BigInt",type:"bigint"},$)}function z6($){return R({[L]:"Number",type:"number"},$)}function R0($){return R({[L]:"String",type:"string"},$)}function*$w($){let Z=$.trim().replace(/"|'/g,"");return Z==="boolean"?yield fZ():Z==="number"?yield z6():Z==="bigint"?yield m4():Z==="string"?yield R0():yield(()=>{let Y=Z.split("|").map((Q)=>X1(Q.trim()));return Y.length===0?r():Y.length===1?Y[0]:p6(Y)})()}function*Zw($){if($[1]!=="{"){let Z=X1("$"),Y=h9($.slice(1));return yield*[Z,...Y]}for(let Z=2;Z<$.length;Z++)if($[Z]==="}"){let Y=$w($.slice(2,Z)),Q=h9($.slice(Z+1));return yield*[...Y,...Q]}yield X1($)}function*h9($){for(let Z=0;Z<$.length;Z++)if($[Z]==="$"){let Y=X1($.slice(0,Z)),Q=Zw($.slice(Z));return yield*[Y,...Q]}yield X1($)}function S7($){return[...h9($)]}class q7 extends i{}function Yw($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function G7($,Z){return a0($)?$.pattern.slice(1,$.pattern.length-1):z1($)?`(${$.anyOf.map((Y)=>G7(Y,Z)).join("|")})`:R6($)?`${Z}${kZ}`:K6($)?`${Z}${kZ}`:S4($)?`${Z}${kZ}`:J8($)?`${Z}${rW}`:s0($)?`${Z}${Yw($.const.toString())}`:X8($)?`${Z}${sW}`:(()=>{throw new q7(`Unexpected Kind '${$[L]}'`)})()}function m9($){return`^${$.map((Z)=>G7(Z,"")).join("")}$`}function w4($){let Y=h4($).map((Q)=>X1(Q));return p6(Y)}function yZ($,Z){let Y=_1($)?m9(S7($)):m9($);return R({[L]:"TemplateLiteral",type:"string",pattern:Y},Z)}function Qw($){return h4($).map((Y)=>Y.toString())}function Ww($){let Z=[];for(let Y of $)Z.push(...k0(Y));return Z}function Xw($){return[$.toString()]}function k0($){return[...new Set(a0($)?Qw($):z1($)?Ww($.anyOf):s0($)?Xw($.const):R6($)?["[number]"]:K6($)?["[number]"]:[])]}function Jw($,Z,Y){let Q={};for(let W of Object.getOwnPropertyNames(Z))Q[W]=k8($,k0(Z[W]),Y);return Q}function zw($,Z,Y){return Jw($,Z.properties,Y)}function M7($,Z,Y){let Q=zw($,Z,Y);return G1(Q)}function w7($,Z){return $.map((Y)=>H7(Y,Z))}function Uw($){return $.filter((Z)=>!T8(Z))}function Sw($,Z){return vZ(Uw(w7($,Z)))}function qw($){return $.some((Z)=>T8(Z))?[]:$}function Gw($,Z){return p6(qw(w7($,Z)))}function Mw($,Z){return Z in $?$[Z]:Z==="[number]"?p6($):r()}function Bw($,Z){return Z==="[number]"?$:r()}function ww($,Z){return Z in $?$[Z]:r()}function H7($,Z){return m1($)?Sw($.allOf,Z):z1($)?Gw($.anyOf,Z):e0($)?Mw($.items??[],Z):L6($)?Bw($.items,Z):r1($)?ww($.properties,Z):r()}function E$($,Z){return Z.map((Y)=>H7($,Y))}function B7($,Z){return p6(E$($,Z))}function k8($,Z,Y){if(l1($)||l1(Z)){if(!d1($)||!d1(Z))throw new i("Index types using Ref parameters require both Type and Key to be of TSchema");return I1("Index",[$,Z])}if(g1(Z))return M7($,Z,Y);if(r0(Z))return D7($,Z,Y);return R(d1(Z)?B7($,k0(Z)):B7($,Z),Y)}function Hw($,Z,Y){return{[Z]:k8($,[Z],x1(Y))}}function Dw($,Z,Y){return Z.reduce((Q,W)=>{return{...Q,...Hw($,W,Y)}},{})}function Aw($,Z,Y){return Dw($,Z.keys,Y)}function D7($,Z,Y){let Q=Aw($,Z,Y);return G1(Q)}function u4($,Z){return R({[L]:"Iterator",type:"Iterator",items:$},Z)}function Nw($){let Z=[];for(let Y in $)if(!x0($[Y]))Z.push(Y);return Z}function Lw($,Z){let Y=Nw($),Q=Y.length>0?{[L]:"Object",type:"object",properties:$,required:Y}:{[L]:"Object",type:"object",properties:$};return R(Q,Z)}var A1=Lw;function dZ($,Z){return R({[L]:"Promise",type:"Promise",item:$},Z)}function Ow($){return R(u1($,[N6]))}function Fw($){return R({...$,[N6]:"Readonly"})}function Pw($,Z){return Z===!1?Ow($):Fw($)}function g0($,Z){let Y=Z??!0;return g1($)?A7($,Y):Pw($,Y)}function Kw($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=g0($[Q],Z);return Y}function Rw($,Z){return Kw($.properties,Z)}function A7($,Z){let Y=Rw($,Z);return G1(Y)}function U6($,Z){return R($.length>0?{[L]:"Tuple",type:"array",items:$,additionalItems:!1,minItems:$.length,maxItems:$.length}:{[L]:"Tuple",type:"array",minItems:$.length,maxItems:$.length},Z)}function N7($,Z){return $ in Z?S6($,Z[$]):G1(Z)}function jw($){return{[$]:X1($)}}function Cw($){let Z={};for(let Y of $)Z[Y]=X1(Y);return Z}function _w($,Z){return eW(Z,$)?jw($):Cw(Z)}function Vw($,Z){let Y=_w($,Z);return N7($,Y)}function I$($,Z){return Z.map((Y)=>S6($,Y))}function Ew($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames(Z))Y[Q]=S6($,Z[Q]);return Y}function S6($,Z){let Y={...Z};return x0(Z)?A0(S6($,u1(Z,[s1]))):b4(Z)?g0(S6($,u1(Z,[N6]))):g1(Z)?N7($,Z.properties):r0(Z)?Vw($,Z.keys):F6(Z)?y4(I$($,Z.parameters),S6($,Z.returns),Y):P6(Z)?c6(I$($,Z.parameters),S6($,Z.returns),Y):U4(Z)?f4(S6($,Z.items),Y):q4(Z)?u4(S6($,Z.items),Y):m1(Z)?N0(I$($,Z.allOf),Y):z1(Z)?D1(I$($,Z.anyOf),Y):e0(Z)?U6(I$($,Z.items??[]),Y):r1(Z)?A1(Ew($,Z.properties),Y):L6(Z)?g4(S6($,Z.items),Y):G4(Z)?dZ(S6($,Z.item),Y):Z}function Iw($,Z){let Y={};for(let Q of $)Y[Q]=S6(Q,Z);return Y}function L7($,Z,Y){let Q=d1($)?k0($):$,W=Z({[L]:"MappedKey",keys:Q}),X=Iw(Q,W);return A1(X,Y)}function Tw($){return R(u1($,[s1]))}function bw($){return R({...$,[s1]:"Optional"})}function xw($,Z){return Z===!1?Tw($):bw($)}function A0($,Z){let Y=Z??!0;return g1($)?O7($,Y):xw($,Y)}function kw($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=A0($[Q],Z);return Y}function gw($,Z){return kw($.properties,Z)}function O7($,Z){let Y=gw($,Z);return G1(Y)}function T$($,Z={}){let Y=$.every((W)=>r1(W)),Q=d1(Z.unevaluatedProperties)?{unevaluatedProperties:Z.unevaluatedProperties}:{};return R(Z.unevaluatedProperties===!1||d1(Z.unevaluatedProperties)||Y?{...Q,[L]:"Intersect",type:"object",allOf:$}:{...Q,[L]:"Intersect",allOf:$},Z)}function fw($){return $.every((Z)=>x0(Z))}function yw($){return u1($,[s1])}function F7($){return $.map((Z)=>x0(Z)?yw(Z):Z)}function vw($,Z){return fw($)?A0(T$(F7($),Z)):T$(F7($),Z)}function vZ($,Z={}){if($.length===1)return R($[0],Z);if($.length===0)return r(Z);if($.some((Y)=>H1(Y)))throw new Error("Cannot intersect transform types");return vw($,Z)}function N0($,Z){if($.length===1)return R($[0],Z);if($.length===0)return r(Z);if($.some((Y)=>H1(Y)))throw new Error("Cannot intersect transform types");return T$($,Z)}function q6(...$){let[Z,Y]=typeof $[0]==="string"?[$[0],$[1]]:[$[0].$id,$[1]];if(typeof Z!=="string")throw new i("Ref: $ref must be a string");return R({[L]:"Ref",$ref:Z},Y)}function dw($,Z){return I1("Awaited",[I1($,Z)])}function hw($){return I1("Awaited",[q6($)])}function mw($){return N0(P7($))}function uw($){return D1(P7($))}function cw($){return c4($)}function P7($){return $.map((Z)=>c4(Z))}function c4($,Z){return R(O6($)?dw($.target,$.parameters):m1($)?mw($.allOf):z1($)?uw($.anyOf):G4($)?cw($.item):l1($)?hw($.$ref):$,Z)}function K7($){let Z=[];for(let Y of $)Z.push(f0(Y));return Z}function pw($){let Z=K7($);return Y7(Z)}function iw($){let Z=K7($);return Z7(Z)}function lw($){return $.map((Z,Y)=>Y.toString())}function nw($){return["[number]"]}function ow($){return globalThis.Object.getOwnPropertyNames($)}function tw($){if(!u9)return[];return globalThis.Object.getOwnPropertyNames($).map((Y)=>{return Y[0]==="^"&&Y[Y.length-1]==="$"?Y.slice(1,Y.length-1):Y})}function f0($){return m1($)?pw($.allOf):z1($)?iw($.anyOf):e0($)?lw($.items??[]):L6($)?nw($.items):r1($)?ow($.properties):M4($)?tw($.patternProperties):[]}var u9=!1;function q8($){u9=!0;let Z=f0($);return u9=!1,`^(${Z.map((Q)=>`(${Q})`).join("|")})$`}function sw($,Z){return I1("KeyOf",[I1($,Z)])}function rw($){return I1("KeyOf",[q6($)])}function aw($,Z){let Y=f0($),Q=ew(Y),W=p6(Q);return R(W,Z)}function ew($){return $.map((Z)=>Z==="[number]"?z6():X1(Z))}function p4($,Z){return O6($)?sw($.target,$.parameters):l1($)?rw($.$ref):g1($)?R7($,Z):aw($,Z)}function $H($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=p4($[Q],x1(Z));return Y}function ZH($,Z){return $H($.properties,Z)}function R7($,Z){let Y=ZH($,Z);return G1(Y)}function hZ($){let Z=f0($),Y=E$($,Z);return Z.map((Q,W)=>[Z[W],Y[W]])}function YH($){let Z=[];for(let Y of $)Z.push(...f0(Y));return $7(Z)}function QH($){return $.filter((Z)=>!T8(Z))}function WH($,Z){let Y=[];for(let Q of $)Y.push(...E$(Q,[Z]));return QH(Y)}function XH($,Z){let Y={};for(let Q of Z)Y[Q]=vZ(WH($,Q));return Y}function j7($,Z){let Y=YH($),Q=XH($,Y);return A1(Q,Z)}function mZ($){return R({[L]:"Date",type:"Date"},$)}function uZ($){return R({[L]:"Null",type:"null"},$)}function cZ($){return R({[L]:"Symbol",type:"symbol"},$)}function pZ($){return R({[L]:"Undefined",type:"undefined"},$)}function iZ($){return R({[L]:"Uint8Array",type:"Uint8Array"},$)}function j6($){return R({[L]:"Unknown"},$)}function JH($){return $.map((Z)=>c9(Z,!1))}function zH($){let Z={};for(let Y of globalThis.Object.getOwnPropertyNames($))Z[Y]=g0(c9($[Y],!1));return Z}function lZ($,Z){return Z===!0?$:g0($)}function c9($,Z){return C9($)?lZ(x8(),Z):V9($)?lZ(x8(),Z):o1($)?g0(U6(JH($))):Y8($)?iZ():z4($)?mZ():F1($)?lZ(A1(zH($)),Z):_9($)?lZ(c6([],j6()),Z):t1($)?pZ():E9($)?uZ():I9($)?cZ():L$($)?m4():o0($)?X1($):Z8($)?X1($):_1($)?X1($):A1({})}function C7($,Z){return R(c9($,!0),Z)}function _7($,Z){return F6($)?U6($.parameters,Z):r(Z)}function V7($,Z){if(t1($))throw new Error("Enum undefined or empty");let Y=globalThis.Object.getOwnPropertyNames($).filter((X)=>isNaN(X)).map((X)=>$[X]),W=[...new Set(Y)].map((X)=>X1(X));return D1(W,{...Z,[J6]:"Enum"})}class x7 extends i{}var j;(function($){$[$.Union=0]="Union",$[$.True=1]="True",$[$.False=2]="False"})(j||(j={}));function G6($){return $===j.False?$:j.True}function i4($){throw new x7($)}function e1($){return A.IsNever($)||A.IsIntersect($)||A.IsUnion($)||A.IsUnknown($)||A.IsAny($)}function $0($,Z){return A.IsNever(Z)?f7($,Z):A.IsIntersect(Z)?nZ($,Z):A.IsUnion(Z)?o9($,Z):A.IsUnknown(Z)?h7($,Z):A.IsAny(Z)?n9($,Z):i4("StructuralRight")}function n9($,Z){return j.True}function UH($,Z){return A.IsIntersect(Z)?nZ($,Z):A.IsUnion(Z)&&Z.anyOf.some((Y)=>A.IsAny(Y)||A.IsUnknown(Y))?j.True:A.IsUnion(Z)?j.Union:A.IsUnknown(Z)?j.True:A.IsAny(Z)?j.True:j.Union}function SH($,Z){return A.IsUnknown($)?j.False:A.IsAny($)?j.Union:A.IsNever($)?j.True:j.False}function qH($,Z){return A.IsObject(Z)&&oZ(Z)?j.True:e1(Z)?$0($,Z):!A.IsArray(Z)?j.False:G6(K1($.items,Z.items))}function GH($,Z){return e1(Z)?$0($,Z):!A.IsAsyncIterator(Z)?j.False:G6(K1($.items,Z.items))}function MH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsBigInt(Z)?j.True:j.False}function k7($,Z){return A.IsLiteralBoolean($)?j.True:A.IsBoolean($)?j.True:j.False}function BH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsBoolean(Z)?j.True:j.False}function wH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):!A.IsConstructor(Z)?j.False:$.parameters.length>Z.parameters.length?j.False:!$.parameters.every((Y,Q)=>G6(K1(Z.parameters[Q],Y))===j.True)?j.False:G6(K1($.returns,Z.returns))}function HH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsDate(Z)?j.True:j.False}function DH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):!A.IsFunction(Z)?j.False:$.parameters.length>Z.parameters.length?j.False:!$.parameters.every((Y,Q)=>G6(K1(Z.parameters[Q],Y))===j.True)?j.False:G6(K1($.returns,Z.returns))}function g7($,Z){return A.IsLiteral($)&&D0.IsNumber($.const)?j.True:A.IsNumber($)||A.IsInteger($)?j.True:j.False}function AH($,Z){return A.IsInteger(Z)||A.IsNumber(Z)?j.True:e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):j.False}function nZ($,Z){return Z.allOf.every((Y)=>K1($,Y)===j.True)?j.True:j.False}function NH($,Z){return $.allOf.some((Y)=>K1(Y,Z)===j.True)?j.True:j.False}function LH($,Z){return e1(Z)?$0($,Z):!A.IsIterator(Z)?j.False:G6(K1($.items,Z.items))}function OH($,Z){return A.IsLiteral(Z)&&Z.const===$.const?j.True:e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsString(Z)?d7($,Z):A.IsNumber(Z)?y7($,Z):A.IsInteger(Z)?g7($,Z):A.IsBoolean(Z)?k7($,Z):j.False}function f7($,Z){return j.False}function FH($,Z){return j.True}function E7($){let[Z,Y]=[$,0];while(!0){if(!A.IsNot(Z))break;Z=Z.not,Y+=1}return Y%2===0?Z:j6()}function PH($,Z){return A.IsNot($)?K1(E7($),Z):A.IsNot(Z)?K1($,E7(Z)):i4("Invalid fallthrough for Not")}function KH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsNull(Z)?j.True:j.False}function y7($,Z){return A.IsLiteralNumber($)?j.True:A.IsNumber($)||A.IsInteger($)?j.True:j.False}function RH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsInteger(Z)||A.IsNumber(Z)?j.True:j.False}function y0($,Z){return Object.getOwnPropertyNames($.properties).length===Z}function I7($){return oZ($)}function T7($){return y0($,0)||y0($,1)&&"description"in $.properties&&A.IsUnion($.properties.description)&&$.properties.description.anyOf.length===2&&(A.IsString($.properties.description.anyOf[0])&&A.IsUndefined($.properties.description.anyOf[1])||A.IsString($.properties.description.anyOf[1])&&A.IsUndefined($.properties.description.anyOf[0]))}function p9($){return y0($,0)}function b7($){return y0($,0)}function jH($){return y0($,0)}function CH($){return y0($,0)}function _H($){return oZ($)}function VH($){let Z=z6();return y0($,0)||y0($,1)&&"length"in $.properties&&G6(K1($.properties.length,Z))===j.True}function EH($){return y0($,0)}function oZ($){let Z=z6();return y0($,0)||y0($,1)&&"length"in $.properties&&G6(K1($.properties.length,Z))===j.True}function IH($){let Z=c6([x8()],x8());return y0($,0)||y0($,1)&&"then"in $.properties&&G6(K1($.properties.then,Z))===j.True}function v7($,Z){return K1($,Z)===j.False?j.False:A.IsOptional($)&&!A.IsOptional(Z)?j.False:j.True}function L0($,Z){return A.IsUnknown($)?j.False:A.IsAny($)?j.Union:A.IsNever($)||A.IsLiteralString($)&&I7(Z)||A.IsLiteralNumber($)&&p9(Z)||A.IsLiteralBoolean($)&&b7(Z)||A.IsSymbol($)&&T7(Z)||A.IsBigInt($)&&jH(Z)||A.IsString($)&&I7(Z)||A.IsSymbol($)&&T7(Z)||A.IsNumber($)&&p9(Z)||A.IsInteger($)&&p9(Z)||A.IsBoolean($)&&b7(Z)||A.IsUint8Array($)&&_H(Z)||A.IsDate($)&&CH(Z)||A.IsConstructor($)&&EH(Z)||A.IsFunction($)&&VH(Z)?j.True:A.IsRecord($)&&A.IsString(i9($))?(()=>{return Z[J6]==="Record"?j.True:j.False})():A.IsRecord($)&&A.IsNumber(i9($))?(()=>{return y0(Z,0)?j.True:j.False})():j.False}function TH($,Z){return e1(Z)?$0($,Z):A.IsRecord(Z)?M6($,Z):!A.IsObject(Z)?j.False:(()=>{for(let Y of Object.getOwnPropertyNames(Z.properties)){if(!(Y in $.properties)&&!A.IsOptional(Z.properties[Y]))return j.False;if(A.IsOptional(Z.properties[Y]))return j.True;if(v7($.properties[Y],Z.properties[Y])===j.False)return j.False}return j.True})()}function bH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)&&IH(Z)?j.True:!A.IsPromise(Z)?j.False:G6(K1($.item,Z.item))}function i9($){return m6 in $.patternProperties?z6():(u6 in $.patternProperties)?R0():i4("Unknown record key pattern")}function l9($){return m6 in $.patternProperties?$.patternProperties[m6]:(u6 in $.patternProperties)?$.patternProperties[u6]:i4("Unable to get record value schema")}function M6($,Z){let[Y,Q]=[i9(Z),l9(Z)];return A.IsLiteralString($)&&A.IsNumber(Y)&&G6(K1($,Q))===j.True?j.True:A.IsUint8Array($)&&A.IsNumber(Y)?K1($,Q):A.IsString($)&&A.IsNumber(Y)?K1($,Q):A.IsArray($)&&A.IsNumber(Y)?K1($,Q):A.IsObject($)?(()=>{for(let W of Object.getOwnPropertyNames($.properties))if(v7(Q,$.properties[W])===j.False)return j.False;return j.True})():j.False}function xH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):!A.IsRecord(Z)?j.False:K1(l9($),l9(Z))}function kH($,Z){let Y=A.IsRegExp($)?R0():$,Q=A.IsRegExp(Z)?R0():Z;return K1(Y,Q)}function d7($,Z){return A.IsLiteral($)&&D0.IsString($.const)?j.True:A.IsString($)?j.True:j.False}function gH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsString(Z)?j.True:j.False}function fH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsSymbol(Z)?j.True:j.False}function yH($,Z){return A.IsTemplateLiteral($)?K1(w4($),Z):A.IsTemplateLiteral(Z)?K1($,w4(Z)):i4("Invalid fallthrough for TemplateLiteral")}function vH($,Z){return A.IsArray(Z)&&$.items!==void 0&&$.items.every((Y)=>K1(Y,Z.items)===j.True)}function dH($,Z){return A.IsNever($)?j.True:A.IsUnknown($)?j.False:A.IsAny($)?j.Union:j.False}function hH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)&&oZ(Z)?j.True:A.IsArray(Z)&&vH($,Z)?j.True:!A.IsTuple(Z)?j.False:D0.IsUndefined($.items)&&!D0.IsUndefined(Z.items)||!D0.IsUndefined($.items)&&D0.IsUndefined(Z.items)?j.False:D0.IsUndefined($.items)&&!D0.IsUndefined(Z.items)?j.True:$.items.every((Y,Q)=>K1(Y,Z.items[Q])===j.True)?j.True:j.False}function mH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsUint8Array(Z)?j.True:j.False}function uH($,Z){return e1(Z)?$0($,Z):A.IsObject(Z)?L0($,Z):A.IsRecord(Z)?M6($,Z):A.IsVoid(Z)?iH($,Z):A.IsUndefined(Z)?j.True:j.False}function o9($,Z){return Z.anyOf.some((Y)=>K1($,Y)===j.True)?j.True:j.False}function cH($,Z){return $.anyOf.every((Y)=>K1(Y,Z)===j.True)?j.True:j.False}function h7($,Z){return j.True}function pH($,Z){return A.IsNever(Z)?f7($,Z):A.IsIntersect(Z)?nZ($,Z):A.IsUnion(Z)?o9($,Z):A.IsAny(Z)?n9($,Z):A.IsString(Z)?d7($,Z):A.IsNumber(Z)?y7($,Z):A.IsInteger(Z)?g7($,Z):A.IsBoolean(Z)?k7($,Z):A.IsArray(Z)?SH($,Z):A.IsTuple(Z)?dH($,Z):A.IsObject(Z)?L0($,Z):A.IsUnknown(Z)?j.True:j.False}function iH($,Z){return A.IsUndefined($)?j.True:A.IsUndefined($)?j.True:j.False}function lH($,Z){return A.IsIntersect(Z)?nZ($,Z):A.IsUnion(Z)?o9($,Z):A.IsUnknown(Z)?h7($,Z):A.IsAny(Z)?n9($,Z):A.IsObject(Z)?L0($,Z):A.IsVoid(Z)?j.True:j.False}function K1($,Z){return A.IsTemplateLiteral($)||A.IsTemplateLiteral(Z)?yH($,Z):A.IsRegExp($)||A.IsRegExp(Z)?kH($,Z):A.IsNot($)||A.IsNot(Z)?PH($,Z):A.IsAny($)?UH($,Z):A.IsArray($)?qH($,Z):A.IsBigInt($)?MH($,Z):A.IsBoolean($)?BH($,Z):A.IsAsyncIterator($)?GH($,Z):A.IsConstructor($)?wH($,Z):A.IsDate($)?HH($,Z):A.IsFunction($)?DH($,Z):A.IsInteger($)?AH($,Z):A.IsIntersect($)?NH($,Z):A.IsIterator($)?LH($,Z):A.IsLiteral($)?OH($,Z):A.IsNever($)?FH($,Z):A.IsNull($)?KH($,Z):A.IsNumber($)?RH($,Z):A.IsObject($)?TH($,Z):A.IsRecord($)?xH($,Z):A.IsString($)?gH($,Z):A.IsSymbol($)?fH($,Z):A.IsTuple($)?hH($,Z):A.IsPromise($)?bH($,Z):A.IsUint8Array($)?mH($,Z):A.IsUndefined($)?uH($,Z):A.IsUnion($)?cH($,Z):A.IsUnknown($)?pH($,Z):A.IsVoid($)?lH($,Z):i4(`Unknown left type operand '${$[L]}'`)}function g8($,Z){return K1($,Z)}function nH($,Z,Y,Q,W){let X={};for(let J of globalThis.Object.getOwnPropertyNames($))X[J]=l4($[J],Z,Y,Q,x1(W));return X}function oH($,Z,Y,Q,W){return nH($.properties,Z,Y,Q,W)}function m7($,Z,Y,Q,W){let X=oH($,Z,Y,Q,W);return G1(X)}function tH($,Z,Y,Q){let W=g8($,Z);return W===j.Union?D1([Y,Q]):W===j.True?Y:Q}function l4($,Z,Y,Q,W){return g1($)?m7($,Z,Y,Q,W):r0($)?R(u7($,Z,Y,Q,W)):R(tH($,Z,Y,Q),W)}function sH($,Z,Y,Q,W){return{[$]:l4(X1($),Z,Y,Q,x1(W))}}function rH($,Z,Y,Q,W){return $.reduce((X,J)=>{return{...X,...sH(J,Z,Y,Q,W)}},{})}function aH($,Z,Y,Q,W){return rH($.keys,Z,Y,Q,W)}function u7($,Z,Y,Q,W){let X=aH($,Z,Y,Q,W);return G1(X)}function eH($){return $.allOf.every((Z)=>G8(Z))}function $D($){return $.anyOf.some((Z)=>G8(Z))}function ZD($){return!G8($.not)}function G8($){return $[L]==="Intersect"?eH($):$[L]==="Union"?$D($):$[L]==="Not"?ZD($):$[L]==="Undefined"?!0:!1}function c7($,Z){return n4(w4($),Z)}function YD($,Z){let Y=$.filter((Q)=>g8(Q,Z)===j.False);return Y.length===1?Y[0]:D1(Y)}function n4($,Z,Y={}){if(a0($))return R(c7($,Z),Y);if(g1($))return R(p7($,Z),Y);return R(z1($)?YD($.anyOf,Z):g8($,Z)!==j.False?r():$,Y)}function QD($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=n4($[Q],Z);return Y}function WD($,Z){return QD($.properties,Z)}function p7($,Z){let Y=WD($,Z);return G1(Y)}function i7($,Z){return o4(w4($),Z)}function XD($,Z){let Y=$.filter((Q)=>g8(Q,Z)!==j.False);return Y.length===1?Y[0]:D1(Y)}function o4($,Z,Y){if(a0($))return R(i7($,Z),Y);if(g1($))return R(l7($,Z),Y);return R(z1($)?XD($.anyOf,Z):g8($,Z)!==j.False?$:r(),Y)}function JD($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=o4($[Q],Z);return Y}function zD($,Z){return JD($.properties,Z)}function l7($,Z){let Y=zD($,Z);return G1(Y)}function n7($,Z){return F6($)?R($.returns,Z):r(Z)}function tZ($){return g0(A0($))}function H4($,Z,Y){return R({[L]:"Record",type:"object",patternProperties:{[$]:Z}},Y)}function t9($,Z,Y){let Q={};for(let W of $)Q[W]=Z;return A1(Q,{...Y,[J6]:"Record"})}function UD($,Z,Y){return gZ($)?t9(k0($),Z,Y):H4($.pattern,Z,Y)}function SD($,Z,Y){return t9(k0(D1($)),Z,Y)}function qD($,Z,Y){return t9([$.toString()],Z,Y)}function GD($,Z,Y){return H4($.source,Z,Y)}function MD($,Z,Y){let Q=t1($.pattern)?u6:$.pattern;return H4(Q,Z,Y)}function BD($,Z,Y){return H4(u6,Z,Y)}function wD($,Z,Y){return H4(aW,Z,Y)}function HD($,Z,Y){return A1({true:Z,false:Z},Y)}function DD($,Z,Y){return H4(m6,Z,Y)}function AD($,Z,Y){return H4(m6,Z,Y)}function sZ($,Z,Y={}){return z1($)?SD($.anyOf,Z,Y):a0($)?UD($,Z,Y):s0($)?qD($.const,Z,Y):X8($)?HD($,Z,Y):K6($)?DD($,Z,Y):R6($)?AD($,Z,Y):k9($)?GD($,Z,Y):J8($)?MD($,Z,Y):b9($)?BD($,Z,Y):T8($)?wD($,Z,Y):r(Y)}function rZ($){return globalThis.Object.getOwnPropertyNames($.patternProperties)[0]}function o7($){let Z=rZ($);return Z===u6?R0():Z===m6?z6():R0({pattern:Z})}function aZ($){return $.patternProperties[rZ($)]}function ND($,Z){return Z.parameters=b$($,Z.parameters),Z.returns=C6($,Z.returns),Z}function LD($,Z){return Z.parameters=b$($,Z.parameters),Z.returns=C6($,Z.returns),Z}function OD($,Z){return Z.allOf=b$($,Z.allOf),Z}function FD($,Z){return Z.anyOf=b$($,Z.anyOf),Z}function PD($,Z){if(t1(Z.items))return Z;return Z.items=b$($,Z.items),Z}function KD($,Z){return Z.items=C6($,Z.items),Z}function RD($,Z){return Z.items=C6($,Z.items),Z}function jD($,Z){return Z.items=C6($,Z.items),Z}function CD($,Z){return Z.item=C6($,Z.item),Z}function _D($,Z){let Y=TD($,Z.properties);return{...Z,...A1(Y)}}function VD($,Z){let Y=C6($,o7(Z)),Q=C6($,aZ(Z)),W=sZ(Y,Q);return{...Z,...W}}function ED($,Z){return Z.index in $?$[Z.index]:j6()}function ID($,Z){let Y=b4(Z),Q=x0(Z),W=C6($,Z);return Y&&Q?tZ(W):Y&&!Q?g0(W):!Y&&Q?A0(W):W}function TD($,Z){return globalThis.Object.getOwnPropertyNames(Z).reduce((Y,Q)=>{return{...Y,[Q]:ID($,Z[Q])}},{})}function b$($,Z){return Z.map((Y)=>C6($,Y))}function C6($,Z){return F6(Z)?ND($,Z):P6(Z)?LD($,Z):m1(Z)?OD($,Z):z1(Z)?FD($,Z):e0(Z)?PD($,Z):L6(Z)?KD($,Z):U4(Z)?RD($,Z):q4(Z)?jD($,Z):G4(Z)?CD($,Z):r1(Z)?_D($,Z):M4(Z)?VD($,Z):x9(Z)?ED($,Z):Z}function t7($,Z){return C6(Z,I4($))}function s7($){return R({[L]:"Integer",type:"integer"},$)}function bD($,Z,Y){return{[$]:_6(X1($),Z,x1(Y))}}function xD($,Z,Y){return $.reduce((W,X)=>{return{...W,...bD(X,Z,Y)}},{})}function kD($,Z,Y){return xD($.keys,Z,Y)}function r7($,Z,Y){let Q=kD($,Z,Y);return G1(Q)}function gD($){let[Z,Y]=[$.slice(0,1),$.slice(1)];return[Z.toLowerCase(),Y].join("")}function fD($){let[Z,Y]=[$.slice(0,1),$.slice(1)];return[Z.toUpperCase(),Y].join("")}function yD($){return $.toUpperCase()}function vD($){return $.toLowerCase()}function dD($,Z,Y){let Q=d4($.pattern);if(!B4(Q))return{...$,pattern:a7($.pattern,Z)};let J=[...V$(Q)].map((S)=>X1(S)),z=e7(J,Z),U=D1(z);return yZ([U],Y)}function a7($,Z){return typeof $==="string"?Z==="Uncapitalize"?gD($):Z==="Capitalize"?fD($):Z==="Uppercase"?yD($):Z==="Lowercase"?vD($):$:$.toString()}function e7($,Z){return $.map((Y)=>_6(Y,Z))}function _6($,Z,Y={}){return r0($)?r7($,Z,Y):a0($)?dD($,Z,Y):z1($)?D1(e7($.anyOf,Z),Y):s0($)?X1(a7($.const,Z),Y):R($,Y)}function $X($,Z={}){return _6($,"Capitalize",Z)}function ZX($,Z={}){return _6($,"Lowercase",Z)}function YX($,Z={}){return _6($,"Uncapitalize",Z)}function QX($,Z={}){return _6($,"Uppercase",Z)}function hD($,Z,Y){let Q={};for(let W of globalThis.Object.getOwnPropertyNames($))Q[W]=f8($[W],Z,x1(Y));return Q}function mD($,Z,Y){return hD($.properties,Z,Y)}function WX($,Z,Y){let Q=mD($,Z,Y);return G1(Q)}function uD($,Z){return $.map((Y)=>s9(Y,Z))}function cD($,Z){return $.map((Y)=>s9(Y,Z))}function pD($,Z){let{[Z]:Y,...Q}=$;return Q}function iD($,Z){return Z.reduce((Y,Q)=>pD(Y,Q),$)}function lD($,Z){let Y=u1($,[R1,"$id","required","properties"]),Q=iD($.properties,Z);return A1(Q,Y)}function nD($){let Z=$.reduce((Y,Q)=>bZ(Q)?[...Y,X1(Q)]:Y,[]);return D1(Z)}function s9($,Z){return m1($)?N0(uD($.allOf,Z)):z1($)?D1(cD($.anyOf,Z)):r1($)?lD($,Z):A1({})}function f8($,Z,Y){let Q=o1(Z)?nD(Z):Z,W=d1(Z)?k0(Z):Z,X=l1($),J=l1(Z);return g1($)?WX($,W,Y):r0(Z)?XX($,Z,Y):X&&J?I1("Omit",[$,Q],Y):!X&&J?I1("Omit",[$,Q],Y):X&&!J?I1("Omit",[$,Q],Y):R({...s9($,W),...Y})}function oD($,Z,Y){return{[Z]:f8($,[Z],x1(Y))}}function tD($,Z,Y){return Z.reduce((Q,W)=>{return{...Q,...oD($,W,Y)}},{})}function sD($,Z,Y){return tD($,Z.keys,Y)}function XX($,Z,Y){let Q=sD($,Z,Y);return G1(Q)}function rD($,Z,Y){let Q={};for(let W of globalThis.Object.getOwnPropertyNames($))Q[W]=y8($[W],Z,x1(Y));return Q}function aD($,Z,Y){return rD($.properties,Z,Y)}function JX($,Z,Y){let Q=aD($,Z,Y);return G1(Q)}function eD($,Z){return $.map((Y)=>r9(Y,Z))}function $A($,Z){return $.map((Y)=>r9(Y,Z))}function ZA($,Z){let Y={};for(let Q of Z)if(Q in $)Y[Q]=$[Q];return Y}function YA($,Z){let Y=u1($,[R1,"$id","required","properties"]),Q=ZA($.properties,Z);return A1(Q,Y)}function QA($){let Z=$.reduce((Y,Q)=>bZ(Q)?[...Y,X1(Q)]:Y,[]);return D1(Z)}function r9($,Z){return m1($)?N0(eD($.allOf,Z)):z1($)?D1($A($.anyOf,Z)):r1($)?YA($,Z):A1({})}function y8($,Z,Y){let Q=o1(Z)?QA(Z):Z,W=d1(Z)?k0(Z):Z,X=l1($),J=l1(Z);return g1($)?JX($,W,Y):r0(Z)?zX($,Z,Y):X&&J?I1("Pick",[$,Q],Y):!X&&J?I1("Pick",[$,Q],Y):X&&!J?I1("Pick",[$,Q],Y):R({...r9($,W),...Y})}function WA($,Z,Y){return{[Z]:y8($,[Z],x1(Y))}}function XA($,Z,Y){return Z.reduce((Q,W)=>{return{...Q,...WA($,W,Y)}},{})}function JA($,Z,Y){return XA($,Z.keys,Y)}function zX($,Z,Y){let Q=JA($,Z,Y);return G1(Q)}function zA($,Z){return I1("Partial",[I1($,Z)])}function UA($){return I1("Partial",[q6($)])}function SA($){let Z={};for(let Y of globalThis.Object.getOwnPropertyNames($))Z[Y]=A0($[Y]);return Z}function qA($){let Z=u1($,[R1,"$id","required","properties"]),Y=SA($.properties);return A1(Y,Z)}function UX($){return $.map((Z)=>SX(Z))}function SX($){return O6($)?zA($.target,$.parameters):l1($)?UA($.$ref):m1($)?N0(UX($.allOf)):z1($)?D1(UX($.anyOf)):r1($)?qA($):S4($)?$:X8($)?$:K6($)?$:s0($)?$:P$($)?$:R6($)?$:J8($)?$:K$($)?$:z8($)?$:A1({})}function t4($,Z){if(g1($))return qX($,Z);else return R({...SX($),...Z})}function GA($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=t4($[Q],x1(Z));return Y}function MA($,Z){return GA($.properties,Z)}function qX($,Z){let Y=MA($,Z);return G1(Y)}function BA($,Z){return I1("Required",[I1($,Z)])}function wA($){return I1("Required",[q6($)])}function HA($){let Z={};for(let Y of globalThis.Object.getOwnPropertyNames($))Z[Y]=u1($[Y],[s1]);return Z}function DA($){let Z=u1($,[R1,"$id","required","properties"]),Y=HA($.properties);return A1(Y,Z)}function GX($){return $.map((Z)=>MX(Z))}function MX($){return O6($)?BA($.target,$.parameters):l1($)?wA($.$ref):m1($)?N0(GX($.allOf)):z1($)?D1(GX($.anyOf)):r1($)?DA($):S4($)?$:X8($)?$:K6($)?$:s0($)?$:P$($)?$:R6($)?$:J8($)?$:K$($)?$:z8($)?$:A1({})}function s4($,Z){if(g1($))return BX($,Z);else return R({...MX($),...Z})}function AA($,Z){let Y={};for(let Q of globalThis.Object.getOwnPropertyNames($))Y[Q]=s4($[Q],Z);return Y}function NA($,Z){return AA($.properties,Z)}function BX($,Z){let Y=NA($,Z);return G1(Y)}function LA($,Z){return Z.map((Y)=>{return l1(Y)?a9($,Y.$ref):$6($,Y)})}function a9($,Z){return Z in $?l1($[Z])?a9($,$[Z].$ref):$6($,$[Z]):r()}function OA($){return c4($[0])}function FA($){return k8($[0],$[1])}function PA($){return p4($[0])}function KA($){return t4($[0])}function RA($){return f8($[0],$[1])}function jA($){return y8($[0],$[1])}function CA($){return s4($[0])}function _A($,Z,Y){let Q=LA($,Y);return Z==="Awaited"?OA(Q):Z==="Index"?FA(Q):Z==="KeyOf"?PA(Q):Z==="Partial"?KA(Q):Z==="Omit"?RA(Q):Z==="Pick"?jA(Q):Z==="Required"?CA(Q):r()}function VA($,Z){return g4($6($,Z))}function EA($,Z){return f4($6($,Z))}function IA($,Z,Y){return y4(x$($,Z),$6($,Y))}function TA($,Z,Y){return c6(x$($,Z),$6($,Y))}function bA($,Z){return N0(x$($,Z))}function xA($,Z){return u4($6($,Z))}function kA($,Z){return A1(globalThis.Object.keys(Z).reduce((Y,Q)=>{return{...Y,[Q]:$6($,Z[Q])}},{}))}function gA($,Z){let[Y,Q]=[$6($,aZ(Z)),rZ(Z)],W=I4(Z);return W.patternProperties[Q]=Y,W}function fA($,Z){return l1(Z)?{...a9($,Z.$ref),[R1]:Z[R1]}:Z}function yA($,Z){return U6(x$($,Z))}function vA($,Z){return D1(x$($,Z))}function x$($,Z){return Z.map((Y)=>$6($,Y))}function $6($,Z){return x0(Z)?R($6($,u1(Z,[s1])),Z):b4(Z)?R($6($,u1(Z,[N6])),Z):H1(Z)?R(fA($,Z),Z):L6(Z)?R(VA($,Z.items),Z):U4(Z)?R(EA($,Z.items),Z):O6(Z)?R(_A($,Z.target,Z.parameters)):F6(Z)?R(IA($,Z.parameters,Z.returns),Z):P6(Z)?R(TA($,Z.parameters,Z.returns),Z):m1(Z)?R(bA($,Z.allOf),Z):q4(Z)?R(xA($,Z.items),Z):r1(Z)?R(kA($,Z.properties),Z):M4(Z)?R(gA($,Z)):e0(Z)?R(yA($,Z.items||[]),Z):z1(Z)?R(vA($,Z.anyOf),Z):Z}function dA($,Z){return Z in $?$6($,$[Z]):r()}function wX($){return globalThis.Object.getOwnPropertyNames($).reduce((Z,Y)=>{return{...Z,[Y]:dA($,Y)}},{})}class HX{constructor($){let Z=wX($),Y=this.WithIdentifiers(Z);this.$defs=Y}Import($,Z){let Y={...this.$defs,[$]:R(this.$defs[$],Z)};return R({[L]:"Import",$defs:Y,$ref:$})}WithIdentifiers($){return globalThis.Object.getOwnPropertyNames($).reduce((Z,Y)=>{return{...Z,[Y]:{...$[Y],$id:Y}}},{})}}function DX($){return new HX($)}function AX($,Z){return R({[L]:"Not",not:$},Z)}function NX($,Z){return P6($)?U6($.parameters,Z):r()}var hA=0;function LX($,Z={}){if(t1(Z.$id))Z.$id=`T${hA++}`;let Y=I4($({[L]:"This",$ref:`${Z.$id}`}));return Y.$id=Z.$id,R({[J6]:"Recursive",...Y},Z)}function OX($,Z){let Y=_1($)?new globalThis.RegExp($):$;return R({[L]:"RegExp",type:"RegExp",source:Y.source,flags:Y.flags},Z)}function mA($){return m1($)?$.allOf:z1($)?$.anyOf:e0($)?$.items??[]:[]}function FX($){return mA($)}function PX($,Z){return P6($)?R($.returns,Z):r(Z)}class KX{constructor($){this.schema=$}Decode($){return new RX(this.schema,$)}}class RX{constructor($,Z){this.schema=$,this.decode=Z}EncodeTransform($,Z){let W={Encode:(X)=>Z[R1].Encode($(X)),Decode:(X)=>this.decode(Z[R1].Decode(X))};return{...Z,[R1]:W}}EncodeSchema($,Z){let Y={Decode:this.decode,Encode:$};return{...Z,[R1]:Y}}Encode($){return H1(this.schema)?this.EncodeTransform($,this.schema):this.EncodeSchema($,this.schema)}}function jX($){return new KX($)}function eZ($={}){return R({[L]:$[L]??"Unsafe"},$)}function CX($){return R({[L]:"Void",type:"void"},$)}var e9={};J4(e9,{Void:()=>CX,Uppercase:()=>QX,Unsafe:()=>eZ,Unknown:()=>j6,Union:()=>D1,Undefined:()=>pZ,Uncapitalize:()=>YX,Uint8Array:()=>iZ,Tuple:()=>U6,Transform:()=>jX,TemplateLiteral:()=>yZ,Symbol:()=>cZ,String:()=>R0,ReturnType:()=>PX,Rest:()=>FX,Required:()=>s4,RegExp:()=>OX,Ref:()=>q6,Recursive:()=>LX,Record:()=>sZ,ReadonlyOptional:()=>tZ,Readonly:()=>g0,Promise:()=>dZ,Pick:()=>y8,Partial:()=>t4,Parameters:()=>NX,Optional:()=>A0,Omit:()=>f8,Object:()=>A1,Number:()=>z6,Null:()=>uZ,Not:()=>AX,Never:()=>r,Module:()=>DX,Mapped:()=>L7,Lowercase:()=>ZX,Literal:()=>X1,KeyOf:()=>p4,Iterator:()=>u4,Intersect:()=>N0,Integer:()=>s7,Instantiate:()=>t7,InstanceType:()=>n7,Index:()=>k8,Function:()=>c6,Extract:()=>o4,Extends:()=>l4,Exclude:()=>n4,Enum:()=>V7,Date:()=>mZ,ConstructorParameters:()=>_7,Constructor:()=>y4,Const:()=>C7,Composite:()=>j7,Capitalize:()=>$X,Boolean:()=>fZ,BigInt:()=>m4,Awaited:()=>c4,AsyncIterator:()=>f4,Array:()=>g4,Argument:()=>Q7,Any:()=>x8});var M8=e9;function uA($){switch($.errorType){case K.ArrayContains:return"Expected array to contain at least one matching value";case K.ArrayMaxContains:return`Expected array to contain no more than ${$.schema.maxContains} matching values`;case K.ArrayMinContains:return`Expected array to contain at least ${$.schema.minContains} matching values`;case K.ArrayMaxItems:return`Expected array length to be less or equal to ${$.schema.maxItems}`;case K.ArrayMinItems:return`Expected array length to be greater or equal to ${$.schema.minItems}`;case K.ArrayUniqueItems:return"Expected array elements to be unique";case K.Array:return"Expected array";case K.AsyncIterator:return"Expected AsyncIterator";case K.BigIntExclusiveMaximum:return`Expected bigint to be less than ${$.schema.exclusiveMaximum}`;case K.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${$.schema.exclusiveMinimum}`;case K.BigIntMaximum:return`Expected bigint to be less or equal to ${$.schema.maximum}`;case K.BigIntMinimum:return`Expected bigint to be greater or equal to ${$.schema.minimum}`;case K.BigIntMultipleOf:return`Expected bigint to be a multiple of ${$.schema.multipleOf}`;case K.BigInt:return"Expected bigint";case K.Boolean:return"Expected boolean";case K.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${$.schema.exclusiveMinimumTimestamp}`;case K.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${$.schema.exclusiveMaximumTimestamp}`;case K.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${$.schema.minimumTimestamp}`;case K.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${$.schema.maximumTimestamp}`;case K.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${$.schema.multipleOfTimestamp}`;case K.Date:return"Expected Date";case K.Function:return"Expected function";case K.IntegerExclusiveMaximum:return`Expected integer to be less than ${$.schema.exclusiveMaximum}`;case K.IntegerExclusiveMinimum:return`Expected integer to be greater than ${$.schema.exclusiveMinimum}`;case K.IntegerMaximum:return`Expected integer to be less or equal to ${$.schema.maximum}`;case K.IntegerMinimum:return`Expected integer to be greater or equal to ${$.schema.minimum}`;case K.IntegerMultipleOf:return`Expected integer to be a multiple of ${$.schema.multipleOf}`;case K.Integer:return"Expected integer";case K.IntersectUnevaluatedProperties:return"Unexpected property";case K.Intersect:return"Expected all values to match";case K.Iterator:return"Expected Iterator";case K.Literal:return`Expected ${typeof $.schema.const==="string"?`'${$.schema.const}'`:$.schema.const}`;case K.Never:return"Never";case K.Not:return"Value should not match";case K.Null:return"Expected null";case K.NumberExclusiveMaximum:return`Expected number to be less than ${$.schema.exclusiveMaximum}`;case K.NumberExclusiveMinimum:return`Expected number to be greater than ${$.schema.exclusiveMinimum}`;case K.NumberMaximum:return`Expected number to be less or equal to ${$.schema.maximum}`;case K.NumberMinimum:return`Expected number to be greater or equal to ${$.schema.minimum}`;case K.NumberMultipleOf:return`Expected number to be a multiple of ${$.schema.multipleOf}`;case K.Number:return"Expected number";case K.Object:return"Expected object";case K.ObjectAdditionalProperties:return"Unexpected property";case K.ObjectMaxProperties:return`Expected object to have no more than ${$.schema.maxProperties} properties`;case K.ObjectMinProperties:return`Expected object to have at least ${$.schema.minProperties} properties`;case K.ObjectRequiredProperty:return"Expected required property";case K.Promise:return"Expected Promise";case K.RegExp:return"Expected string to match regular expression";case K.StringFormatUnknown:return`Unknown format '${$.schema.format}'`;case K.StringFormat:return`Expected string to match '${$.schema.format}' format`;case K.StringMaxLength:return`Expected string length less or equal to ${$.schema.maxLength}`;case K.StringMinLength:return`Expected string length greater or equal to ${$.schema.minLength}`;case K.StringPattern:return`Expected string to match '${$.schema.pattern}'`;case K.String:return"Expected string";case K.Symbol:return"Expected symbol";case K.TupleLength:return`Expected tuple to have ${$.schema.maxItems||0} elements`;case K.Tuple:return"Expected tuple";case K.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${$.schema.maxByteLength}`;case K.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${$.schema.minByteLength}`;case K.Uint8Array:return"Expected Uint8Array";case K.Undefined:return"Expected undefined";case K.Union:return"Expected union value";case K.Void:return"Expected void";case K.Kind:return`Expected kind '${$.schema[L]}'`;default:return"Unknown error type"}}var cA=uA;function _X(){return cA}class VX extends i{constructor($){super(`Unable to dereference schema with $id '${$.$ref}'`);this.schema=$}}function pA($,Z){let Y=Z.find((Q)=>Q.$id===$.$ref);if(Y===void 0)throw new VX($);return M1(Y,Z)}function X0($,Z){if(!J1($.$id)||Z.some((Y)=>Y.$id===$.$id))return Z;return Z.push($),Z}function M1($,Z){return $[L]==="This"||$[L]==="Ref"?pA($,Z):$}class EX extends i{constructor($){super("Unable to hash value");this.value=$}}var Z6;(function($){$[$.Undefined=0]="Undefined",$[$.Null=1]="Null",$[$.Boolean=2]="Boolean",$[$.Number=3]="Number",$[$.String=4]="String",$[$.Object=5]="Object",$[$.Array=6]="Array",$[$.Date=7]="Date",$[$.Uint8Array=8]="Uint8Array",$[$.Symbol=9]="Symbol",$[$.BigInt=10]="BigInt"})(Z6||(Z6={}));var r4=BigInt("14695981039346656037"),[iA,lA]=[BigInt("1099511628211"),BigInt("18446744073709551616")],nA=Array.from({length:256}).map(($,Z)=>BigInt(Z)),IX=new Float64Array(1),TX=new DataView(IX.buffer),bX=new Uint8Array(IX.buffer);function*oA($){let Z=$===0?1:Math.ceil(Math.floor(Math.log2($)+1)/8);for(let Y=0;Y<Z;Y++)yield $>>8*(Z-1-Y)&255}function tA($){O0(Z6.Array);for(let Z of $)a4(Z)}function sA($){O0(Z6.Boolean),O0($?1:0)}function rA($){O0(Z6.BigInt),TX.setBigInt64(0,$);for(let Z of bX)O0(Z)}function aA($){O0(Z6.Date),a4($.getTime())}function eA($){O0(Z6.Null)}function $N($){O0(Z6.Number),TX.setFloat64(0,$);for(let Z of bX)O0(Z)}function ZN($){O0(Z6.Object);for(let Z of globalThis.Object.getOwnPropertyNames($).sort())a4(Z),a4($[Z])}function YN($){O0(Z6.String);for(let Z=0;Z<$.length;Z++)for(let Y of oA($.charCodeAt(Z)))O0(Y)}function QN($){O0(Z6.Symbol),a4($.description)}function WN($){O0(Z6.Uint8Array);for(let Z=0;Z<$.length;Z++)O0($[Z])}function XN($){return O0(Z6.Undefined)}function a4($){if(o($))return tA($);if(h6($))return sA($);if(q0($))return rA($);if(K0($))return aA($);if(Q8($))return eA($);if(c($))return $N($);if(a($))return ZN($);if(J1($))return YN($);if(W8($))return QN($);if(T4($))return WN($);if(k1($))return XN($);throw new EX($)}function O0($){r4=r4^nA[$],r4=r4*iA%lA}function v8($){return r4=BigInt("14695981039346656037"),a4($),r4}class xX extends i{constructor($){super("Unknown type");this.schema=$}}function JN($){return $[L]==="Any"||$[L]==="Unknown"}function Y1($){return $!==void 0}function zN($,Z,Y){return!0}function UN($,Z,Y){return!0}function SN($,Z,Y){if(!o(Y))return!1;if(Y1($.minItems)&&!(Y.length>=$.minItems))return!1;if(Y1($.maxItems)&&!(Y.length<=$.maxItems))return!1;if(!Y.every((X)=>J0($.items,Z,X)))return!1;if($.uniqueItems===!0&&!function(){let X=new Set;for(let J of Y){let z=v8(J);if(X.has(z))return!1;else X.add(z)}return!0}())return!1;if(!(Y1($.contains)||c($.minContains)||c($.maxContains)))return!0;let Q=Y1($.contains)?$.contains:r(),W=Y.reduce((X,J)=>J0(Q,Z,J)?X+1:X,0);if(W===0)return!1;if(c($.minContains)&&W<$.minContains)return!1;if(c($.maxContains)&&W>$.maxContains)return!1;return!0}function qN($,Z,Y){return VZ(Y)}function GN($,Z,Y){if(!q0(Y))return!1;if(Y1($.exclusiveMaximum)&&!(Y<$.exclusiveMaximum))return!1;if(Y1($.exclusiveMinimum)&&!(Y>$.exclusiveMinimum))return!1;if(Y1($.maximum)&&!(Y<=$.maximum))return!1;if(Y1($.minimum)&&!(Y>=$.minimum))return!1;if(Y1($.multipleOf)&&Y%$.multipleOf!==BigInt(0))return!1;return!0}function MN($,Z,Y){return h6(Y)}function BN($,Z,Y){return J0($.returns,Z,Y.prototype)}function wN($,Z,Y){if(!K0(Y))return!1;if(Y1($.exclusiveMaximumTimestamp)&&!(Y.getTime()<$.exclusiveMaximumTimestamp))return!1;if(Y1($.exclusiveMinimumTimestamp)&&!(Y.getTime()>$.exclusiveMinimumTimestamp))return!1;if(Y1($.maximumTimestamp)&&!(Y.getTime()<=$.maximumTimestamp))return!1;if(Y1($.minimumTimestamp)&&!(Y.getTime()>=$.minimumTimestamp))return!1;if(Y1($.multipleOfTimestamp)&&Y.getTime()%$.multipleOfTimestamp!==0)return!1;return!0}function HN($,Z,Y){return I8(Y)}function DN($,Z,Y){let Q=globalThis.Object.values($.$defs),W=$.$defs[$.$ref];return J0(W,[...Z,...Q],Y)}function AN($,Z,Y){if(!TZ(Y))return!1;if(Y1($.exclusiveMaximum)&&!(Y<$.exclusiveMaximum))return!1;if(Y1($.exclusiveMinimum)&&!(Y>$.exclusiveMinimum))return!1;if(Y1($.maximum)&&!(Y<=$.maximum))return!1;if(Y1($.minimum)&&!(Y>=$.minimum))return!1;if(Y1($.multipleOf)&&Y%$.multipleOf!==0)return!1;return!0}function NN($,Z,Y){let Q=$.allOf.every((W)=>J0(W,Z,Y));if($.unevaluatedProperties===!1){let W=new RegExp(q8($)),X=Object.getOwnPropertyNames(Y).every((J)=>W.test(J));return Q&&X}else if(d1($.unevaluatedProperties)){let W=new RegExp(q8($)),X=Object.getOwnPropertyNames(Y).every((J)=>W.test(J)||J0($.unevaluatedProperties,Z,Y[J]));return Q&&X}else return Q}function LN($,Z,Y){return EZ(Y)}function ON($,Z,Y){return Y===$.const}function FN($,Z,Y){return!1}function PN($,Z,Y){return!J0($.not,Z,Y)}function KN($,Z,Y){return Q8(Y)}function RN($,Z,Y){if(!E1.IsNumberLike(Y))return!1;if(Y1($.exclusiveMaximum)&&!(Y<$.exclusiveMaximum))return!1;if(Y1($.exclusiveMinimum)&&!(Y>$.exclusiveMinimum))return!1;if(Y1($.minimum)&&!(Y>=$.minimum))return!1;if(Y1($.maximum)&&!(Y<=$.maximum))return!1;if(Y1($.multipleOf)&&Y%$.multipleOf!==0)return!1;return!0}function jN($,Z,Y){if(!E1.IsObjectLike(Y))return!1;if(Y1($.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=$.minProperties))return!1;if(Y1($.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=$.maxProperties))return!1;let Q=Object.getOwnPropertyNames($.properties);for(let W of Q){let X=$.properties[W];if($.required&&$.required.includes(W)){if(!J0(X,Z,Y[W]))return!1;if((G8(X)||JN(X))&&!(W in Y))return!1}else if(E1.IsExactOptionalProperty(Y,W)&&!J0(X,Z,Y[W]))return!1}if($.additionalProperties===!1){let W=Object.getOwnPropertyNames(Y);if($.required&&$.required.length===Q.length&&W.length===Q.length)return!0;else return W.every((X)=>Q.includes(X))}else if(typeof $.additionalProperties==="object")return Object.getOwnPropertyNames(Y).every((X)=>Q.includes(X)||J0($.additionalProperties,Z,Y[X]));else return!0}function CN($,Z,Y){return IZ(Y)}function _N($,Z,Y){if(!E1.IsRecordLike(Y))return!1;if(Y1($.minProperties)&&!(Object.getOwnPropertyNames(Y).length>=$.minProperties))return!1;if(Y1($.maxProperties)&&!(Object.getOwnPropertyNames(Y).length<=$.maxProperties))return!1;let[Q,W]=Object.entries($.patternProperties)[0],X=new RegExp(Q),J=Object.entries(Y).every(([S,q])=>{return X.test(S)?J0(W,Z,q):!0}),z=typeof $.additionalProperties==="object"?Object.entries(Y).every(([S,q])=>{return!X.test(S)?J0($.additionalProperties,Z,q):!0}):!0,U=$.additionalProperties===!1?Object.getOwnPropertyNames(Y).every((S)=>{return X.test(S)}):!0;return J&&z&&U}function VN($,Z,Y){return J0(M1($,Z),Z,Y)}function EN($,Z,Y){let Q=new RegExp($.source,$.flags);if(Y1($.minLength)){if(!(Y.length>=$.minLength))return!1}if(Y1($.maxLength)){if(!(Y.length<=$.maxLength))return!1}return Q.test(Y)}function IN($,Z,Y){if(!J1(Y))return!1;if(Y1($.minLength)){if(!(Y.length>=$.minLength))return!1}if(Y1($.maxLength)){if(!(Y.length<=$.maxLength))return!1}if(Y1($.pattern)){if(!new RegExp($.pattern).test(Y))return!1}if(Y1($.format)){if(!O1.Has($.format))return!1;return O1.Get($.format)(Y)}return!0}function TN($,Z,Y){return W8(Y)}function bN($,Z,Y){return J1(Y)&&new RegExp($.pattern).test(Y)}function xN($,Z,Y){return J0(M1($,Z),Z,Y)}function kN($,Z,Y){if(!o(Y))return!1;if($.items===void 0&&Y.length!==0)return!1;if(Y.length!==$.maxItems)return!1;if(!$.items)return!0;for(let Q=0;Q<$.items.length;Q++)if(!J0($.items[Q],Z,Y[Q]))return!1;return!0}function gN($,Z,Y){return k1(Y)}function fN($,Z,Y){return $.anyOf.some((Q)=>J0(Q,Z,Y))}function yN($,Z,Y){if(!T4(Y))return!1;if(Y1($.maxByteLength)&&!(Y.length<=$.maxByteLength))return!1;if(Y1($.minByteLength)&&!(Y.length>=$.minByteLength))return!1;return!0}function vN($,Z,Y){return!0}function dN($,Z,Y){return E1.IsVoidLike(Y)}function hN($,Z,Y){if(!Y0.Has($[L]))return!1;return Y0.Get($[L])($,Y)}function J0($,Z,Y){let Q=Y1($.$id)?X0($,Z):Z,W=$;switch(W[L]){case"Any":return zN(W,Q,Y);case"Argument":return UN(W,Q,Y);case"Array":return SN(W,Q,Y);case"AsyncIterator":return qN(W,Q,Y);case"BigInt":return GN(W,Q,Y);case"Boolean":return MN(W,Q,Y);case"Constructor":return BN(W,Q,Y);case"Date":return wN(W,Q,Y);case"Function":return HN(W,Q,Y);case"Import":return DN(W,Q,Y);case"Integer":return AN(W,Q,Y);case"Intersect":return NN(W,Q,Y);case"Iterator":return LN(W,Q,Y);case"Literal":return ON(W,Q,Y);case"Never":return FN(W,Q,Y);case"Not":return PN(W,Q,Y);case"Null":return KN(W,Q,Y);case"Number":return RN(W,Q,Y);case"Object":return jN(W,Q,Y);case"Promise":return CN(W,Q,Y);case"Record":return _N(W,Q,Y);case"Ref":return VN(W,Q,Y);case"RegExp":return EN(W,Q,Y);case"String":return IN(W,Q,Y);case"Symbol":return TN(W,Q,Y);case"TemplateLiteral":return bN(W,Q,Y);case"This":return xN(W,Q,Y);case"Tuple":return kN(W,Q,Y);case"Undefined":return gN(W,Q,Y);case"Union":return fN(W,Q,Y);case"Uint8Array":return yN(W,Q,Y);case"Unknown":return vN(W,Q,Y);case"Void":return dN(W,Q,Y);default:if(!Y0.Has(W[L]))throw new xX(W);return hN(W,Q,Y)}}function e(...$){return $.length===3?J0($[0],$[1],$[2]):J0($[0],[],$[1])}var K;(function($){$[$.ArrayContains=0]="ArrayContains",$[$.ArrayMaxContains=1]="ArrayMaxContains",$[$.ArrayMaxItems=2]="ArrayMaxItems",$[$.ArrayMinContains=3]="ArrayMinContains",$[$.ArrayMinItems=4]="ArrayMinItems",$[$.ArrayUniqueItems=5]="ArrayUniqueItems",$[$.Array=6]="Array",$[$.AsyncIterator=7]="AsyncIterator",$[$.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",$[$.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",$[$.BigIntMaximum=10]="BigIntMaximum",$[$.BigIntMinimum=11]="BigIntMinimum",$[$.BigIntMultipleOf=12]="BigIntMultipleOf",$[$.BigInt=13]="BigInt",$[$.Boolean=14]="Boolean",$[$.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",$[$.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",$[$.DateMaximumTimestamp=17]="DateMaximumTimestamp",$[$.DateMinimumTimestamp=18]="DateMinimumTimestamp",$[$.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",$[$.Date=20]="Date",$[$.Function=21]="Function",$[$.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",$[$.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",$[$.IntegerMaximum=24]="IntegerMaximum",$[$.IntegerMinimum=25]="IntegerMinimum",$[$.IntegerMultipleOf=26]="IntegerMultipleOf",$[$.Integer=27]="Integer",$[$.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",$[$.Intersect=29]="Intersect",$[$.Iterator=30]="Iterator",$[$.Kind=31]="Kind",$[$.Literal=32]="Literal",$[$.Never=33]="Never",$[$.Not=34]="Not",$[$.Null=35]="Null",$[$.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",$[$.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",$[$.NumberMaximum=38]="NumberMaximum",$[$.NumberMinimum=39]="NumberMinimum",$[$.NumberMultipleOf=40]="NumberMultipleOf",$[$.Number=41]="Number",$[$.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",$[$.ObjectMaxProperties=43]="ObjectMaxProperties",$[$.ObjectMinProperties=44]="ObjectMinProperties",$[$.ObjectRequiredProperty=45]="ObjectRequiredProperty",$[$.Object=46]="Object",$[$.Promise=47]="Promise",$[$.RegExp=48]="RegExp",$[$.StringFormatUnknown=49]="StringFormatUnknown",$[$.StringFormat=50]="StringFormat",$[$.StringMaxLength=51]="StringMaxLength",$[$.StringMinLength=52]="StringMinLength",$[$.StringPattern=53]="StringPattern",$[$.String=54]="String",$[$.Symbol=55]="Symbol",$[$.TupleLength=56]="TupleLength",$[$.Tuple=57]="Tuple",$[$.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",$[$.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",$[$.Uint8Array=60]="Uint8Array",$[$.Undefined=61]="Undefined",$[$.Union=62]="Union",$[$.Void=63]="Void"})(K||(K={}));class kX extends i{constructor($){super("Unknown type");this.schema=$}}function B8($){return $.replace(/~/g,"~0").replace(/\//g,"~1")}function Q1($){return $!==void 0}class D4{constructor($){this.iterator=$}[Symbol.iterator](){return this.iterator}First(){let $=this.iterator.next();return $.done?void 0:$.value}}function y($,Z,Y,Q,W=[]){return{type:$,schema:Z,path:Y,value:Q,message:_X()({errorType:$,path:Y,schema:Z,value:Q,errors:W}),errors:W}}function*mN($,Z,Y,Q){}function*uN($,Z,Y,Q){}function*cN($,Z,Y,Q){if(!o(Q))return yield y(K.Array,$,Y,Q);if(Q1($.minItems)&&!(Q.length>=$.minItems))yield y(K.ArrayMinItems,$,Y,Q);if(Q1($.maxItems)&&!(Q.length<=$.maxItems))yield y(K.ArrayMaxItems,$,Y,Q);for(let J=0;J<Q.length;J++)yield*z0($.items,Z,`${Y}/${J}`,Q[J]);if($.uniqueItems===!0&&!function(){let J=new Set;for(let z of Q){let U=v8(z);if(J.has(U))return!1;else J.add(U)}return!0}())yield y(K.ArrayUniqueItems,$,Y,Q);if(!(Q1($.contains)||Q1($.minContains)||Q1($.maxContains)))return;let W=Q1($.contains)?$.contains:r(),X=Q.reduce((J,z,U)=>z0(W,Z,`${Y}${U}`,z).next().done===!0?J+1:J,0);if(X===0)yield y(K.ArrayContains,$,Y,Q);if(c($.minContains)&&X<$.minContains)yield y(K.ArrayMinContains,$,Y,Q);if(c($.maxContains)&&X>$.maxContains)yield y(K.ArrayMaxContains,$,Y,Q)}function*pN($,Z,Y,Q){if(!VZ(Q))yield y(K.AsyncIterator,$,Y,Q)}function*iN($,Z,Y,Q){if(!q0(Q))return yield y(K.BigInt,$,Y,Q);if(Q1($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield y(K.BigIntExclusiveMaximum,$,Y,Q);if(Q1($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield y(K.BigIntExclusiveMinimum,$,Y,Q);if(Q1($.maximum)&&!(Q<=$.maximum))yield y(K.BigIntMaximum,$,Y,Q);if(Q1($.minimum)&&!(Q>=$.minimum))yield y(K.BigIntMinimum,$,Y,Q);if(Q1($.multipleOf)&&Q%$.multipleOf!==BigInt(0))yield y(K.BigIntMultipleOf,$,Y,Q)}function*lN($,Z,Y,Q){if(!h6(Q))yield y(K.Boolean,$,Y,Q)}function*nN($,Z,Y,Q){yield*z0($.returns,Z,Y,Q.prototype)}function*oN($,Z,Y,Q){if(!K0(Q))return yield y(K.Date,$,Y,Q);if(Q1($.exclusiveMaximumTimestamp)&&!(Q.getTime()<$.exclusiveMaximumTimestamp))yield y(K.DateExclusiveMaximumTimestamp,$,Y,Q);if(Q1($.exclusiveMinimumTimestamp)&&!(Q.getTime()>$.exclusiveMinimumTimestamp))yield y(K.DateExclusiveMinimumTimestamp,$,Y,Q);if(Q1($.maximumTimestamp)&&!(Q.getTime()<=$.maximumTimestamp))yield y(K.DateMaximumTimestamp,$,Y,Q);if(Q1($.minimumTimestamp)&&!(Q.getTime()>=$.minimumTimestamp))yield y(K.DateMinimumTimestamp,$,Y,Q);if(Q1($.multipleOfTimestamp)&&Q.getTime()%$.multipleOfTimestamp!==0)yield y(K.DateMultipleOfTimestamp,$,Y,Q)}function*tN($,Z,Y,Q){if(!I8(Q))yield y(K.Function,$,Y,Q)}function*sN($,Z,Y,Q){let W=globalThis.Object.values($.$defs),X=$.$defs[$.$ref];yield*z0(X,[...Z,...W],Y,Q)}function*rN($,Z,Y,Q){if(!TZ(Q))return yield y(K.Integer,$,Y,Q);if(Q1($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield y(K.IntegerExclusiveMaximum,$,Y,Q);if(Q1($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield y(K.IntegerExclusiveMinimum,$,Y,Q);if(Q1($.maximum)&&!(Q<=$.maximum))yield y(K.IntegerMaximum,$,Y,Q);if(Q1($.minimum)&&!(Q>=$.minimum))yield y(K.IntegerMinimum,$,Y,Q);if(Q1($.multipleOf)&&Q%$.multipleOf!==0)yield y(K.IntegerMultipleOf,$,Y,Q)}function*aN($,Z,Y,Q){let W=!1;for(let X of $.allOf)for(let J of z0(X,Z,Y,Q))W=!0,yield J;if(W)return yield y(K.Intersect,$,Y,Q);if($.unevaluatedProperties===!1){let X=new RegExp(q8($));for(let J of Object.getOwnPropertyNames(Q))if(!X.test(J))yield y(K.IntersectUnevaluatedProperties,$,`${Y}/${J}`,Q)}if(typeof $.unevaluatedProperties==="object"){let X=new RegExp(q8($));for(let J of Object.getOwnPropertyNames(Q))if(!X.test(J)){let z=z0($.unevaluatedProperties,Z,`${Y}/${J}`,Q[J]).next();if(!z.done)yield z.value}}}function*eN($,Z,Y,Q){if(!EZ(Q))yield y(K.Iterator,$,Y,Q)}function*$L($,Z,Y,Q){if(Q!==$.const)yield y(K.Literal,$,Y,Q)}function*ZL($,Z,Y,Q){yield y(K.Never,$,Y,Q)}function*YL($,Z,Y,Q){if(z0($.not,Z,Y,Q).next().done===!0)yield y(K.Not,$,Y,Q)}function*QL($,Z,Y,Q){if(!Q8(Q))yield y(K.Null,$,Y,Q)}function*WL($,Z,Y,Q){if(!E1.IsNumberLike(Q))return yield y(K.Number,$,Y,Q);if(Q1($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield y(K.NumberExclusiveMaximum,$,Y,Q);if(Q1($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield y(K.NumberExclusiveMinimum,$,Y,Q);if(Q1($.maximum)&&!(Q<=$.maximum))yield y(K.NumberMaximum,$,Y,Q);if(Q1($.minimum)&&!(Q>=$.minimum))yield y(K.NumberMinimum,$,Y,Q);if(Q1($.multipleOf)&&Q%$.multipleOf!==0)yield y(K.NumberMultipleOf,$,Y,Q)}function*XL($,Z,Y,Q){if(!E1.IsObjectLike(Q))return yield y(K.Object,$,Y,Q);if(Q1($.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=$.minProperties))yield y(K.ObjectMinProperties,$,Y,Q);if(Q1($.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=$.maxProperties))yield y(K.ObjectMaxProperties,$,Y,Q);let W=Array.isArray($.required)?$.required:[],X=Object.getOwnPropertyNames($.properties),J=Object.getOwnPropertyNames(Q);for(let z of W){if(J.includes(z))continue;yield y(K.ObjectRequiredProperty,$.properties[z],`${Y}/${B8(z)}`,void 0)}if($.additionalProperties===!1){for(let z of J)if(!X.includes(z))yield y(K.ObjectAdditionalProperties,$,`${Y}/${B8(z)}`,Q[z])}if(typeof $.additionalProperties==="object")for(let z of J){if(X.includes(z))continue;yield*z0($.additionalProperties,Z,`${Y}/${B8(z)}`,Q[z])}for(let z of X){let U=$.properties[z];if($.required&&$.required.includes(z)){if(yield*z0(U,Z,`${Y}/${B8(z)}`,Q[z]),G8($)&&!(z in Q))yield y(K.ObjectRequiredProperty,U,`${Y}/${B8(z)}`,void 0)}else if(E1.IsExactOptionalProperty(Q,z))yield*z0(U,Z,`${Y}/${B8(z)}`,Q[z])}}function*JL($,Z,Y,Q){if(!IZ(Q))yield y(K.Promise,$,Y,Q)}function*zL($,Z,Y,Q){if(!E1.IsRecordLike(Q))return yield y(K.Object,$,Y,Q);if(Q1($.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=$.minProperties))yield y(K.ObjectMinProperties,$,Y,Q);if(Q1($.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=$.maxProperties))yield y(K.ObjectMaxProperties,$,Y,Q);let[W,X]=Object.entries($.patternProperties)[0],J=new RegExp(W);for(let[z,U]of Object.entries(Q))if(J.test(z))yield*z0(X,Z,`${Y}/${B8(z)}`,U);if(typeof $.additionalProperties==="object"){for(let[z,U]of Object.entries(Q))if(!J.test(z))yield*z0($.additionalProperties,Z,`${Y}/${B8(z)}`,U)}if($.additionalProperties===!1)for(let[z,U]of Object.entries(Q)){if(J.test(z))continue;return yield y(K.ObjectAdditionalProperties,$,`${Y}/${B8(z)}`,U)}}function*UL($,Z,Y,Q){yield*z0(M1($,Z),Z,Y,Q)}function*SL($,Z,Y,Q){if(!J1(Q))return yield y(K.String,$,Y,Q);if(Q1($.minLength)&&!(Q.length>=$.minLength))yield y(K.StringMinLength,$,Y,Q);if(Q1($.maxLength)&&!(Q.length<=$.maxLength))yield y(K.StringMaxLength,$,Y,Q);if(!new RegExp($.source,$.flags).test(Q))return yield y(K.RegExp,$,Y,Q)}function*qL($,Z,Y,Q){if(!J1(Q))return yield y(K.String,$,Y,Q);if(Q1($.minLength)&&!(Q.length>=$.minLength))yield y(K.StringMinLength,$,Y,Q);if(Q1($.maxLength)&&!(Q.length<=$.maxLength))yield y(K.StringMaxLength,$,Y,Q);if(J1($.pattern)){if(!new RegExp($.pattern).test(Q))yield y(K.StringPattern,$,Y,Q)}if(J1($.format)){if(!O1.Has($.format))yield y(K.StringFormatUnknown,$,Y,Q);else if(!O1.Get($.format)(Q))yield y(K.StringFormat,$,Y,Q)}}function*GL($,Z,Y,Q){if(!W8(Q))yield y(K.Symbol,$,Y,Q)}function*ML($,Z,Y,Q){if(!J1(Q))return yield y(K.String,$,Y,Q);if(!new RegExp($.pattern).test(Q))yield y(K.StringPattern,$,Y,Q)}function*BL($,Z,Y,Q){yield*z0(M1($,Z),Z,Y,Q)}function*wL($,Z,Y,Q){if(!o(Q))return yield y(K.Tuple,$,Y,Q);if($.items===void 0&&Q.length!==0)return yield y(K.TupleLength,$,Y,Q);if(Q.length!==$.maxItems)return yield y(K.TupleLength,$,Y,Q);if(!$.items)return;for(let W=0;W<$.items.length;W++)yield*z0($.items[W],Z,`${Y}/${W}`,Q[W])}function*HL($,Z,Y,Q){if(!k1(Q))yield y(K.Undefined,$,Y,Q)}function*DL($,Z,Y,Q){if(e($,Z,Q))return;let W=$.anyOf.map((X)=>new D4(z0(X,Z,Y,Q)));yield y(K.Union,$,Y,Q,W)}function*AL($,Z,Y,Q){if(!T4(Q))return yield y(K.Uint8Array,$,Y,Q);if(Q1($.maxByteLength)&&!(Q.length<=$.maxByteLength))yield y(K.Uint8ArrayMaxByteLength,$,Y,Q);if(Q1($.minByteLength)&&!(Q.length>=$.minByteLength))yield y(K.Uint8ArrayMinByteLength,$,Y,Q)}function*NL($,Z,Y,Q){}function*LL($,Z,Y,Q){if(!E1.IsVoidLike(Q))yield y(K.Void,$,Y,Q)}function*OL($,Z,Y,Q){if(!Y0.Get($[L])($,Q))yield y(K.Kind,$,Y,Q)}function*z0($,Z,Y,Q){let W=Q1($.$id)?[...Z,$]:Z,X=$;switch(X[L]){case"Any":return yield*mN(X,W,Y,Q);case"Argument":return yield*uN(X,W,Y,Q);case"Array":return yield*cN(X,W,Y,Q);case"AsyncIterator":return yield*pN(X,W,Y,Q);case"BigInt":return yield*iN(X,W,Y,Q);case"Boolean":return yield*lN(X,W,Y,Q);case"Constructor":return yield*nN(X,W,Y,Q);case"Date":return yield*oN(X,W,Y,Q);case"Function":return yield*tN(X,W,Y,Q);case"Import":return yield*sN(X,W,Y,Q);case"Integer":return yield*rN(X,W,Y,Q);case"Intersect":return yield*aN(X,W,Y,Q);case"Iterator":return yield*eN(X,W,Y,Q);case"Literal":return yield*$L(X,W,Y,Q);case"Never":return yield*ZL(X,W,Y,Q);case"Not":return yield*YL(X,W,Y,Q);case"Null":return yield*QL(X,W,Y,Q);case"Number":return yield*WL(X,W,Y,Q);case"Object":return yield*XL(X,W,Y,Q);case"Promise":return yield*JL(X,W,Y,Q);case"Record":return yield*zL(X,W,Y,Q);case"Ref":return yield*UL(X,W,Y,Q);case"RegExp":return yield*SL(X,W,Y,Q);case"String":return yield*qL(X,W,Y,Q);case"Symbol":return yield*GL(X,W,Y,Q);case"TemplateLiteral":return yield*ML(X,W,Y,Q);case"This":return yield*BL(X,W,Y,Q);case"Tuple":return yield*wL(X,W,Y,Q);case"Undefined":return yield*HL(X,W,Y,Q);case"Union":return yield*DL(X,W,Y,Q);case"Uint8Array":return yield*AL(X,W,Y,Q);case"Unknown":return yield*NL(X,W,Y,Q);case"Void":return yield*LL(X,W,Y,Q);default:if(!Y0.Has(X[L]))throw new kX($);return yield*OL(X,W,Y,Q)}}function i6(...$){let Z=$.length===3?z0($[0],$[1],"",$[2]):z0($[0],[],"",$[1]);return new D4(Z)}var FL=function($,Z,Y,Q,W){if(Q==="m")throw new TypeError("Private method is not writable");if(Q==="a"&&!W)throw new TypeError("Private accessor was defined without a setter");if(typeof Z==="function"?$!==Z||!W:!Z.has($))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?W.call($,Y):W?W.value=Y:Z.set($,Y),Y},fX=function($,Z,Y,Q){if(Y==="a"&&!Q)throw new TypeError("Private accessor was defined without a getter");if(typeof Z==="function"?$!==Z||!Q:!Z.has($))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Y==="m"?Q:Y==="a"?Q.call($):Q?Q.value:Z.get($)},$5,$Y,yX;class vX extends i{constructor($){let Z=$.First();super(Z===void 0?"Invalid Value":Z.message);$5.add(this),$Y.set(this,void 0),FL(this,$Y,$,"f"),this.error=Z}Errors(){return new D4(fX(this,$5,"m",yX).call(this))}}$Y=new WeakMap,$5=new WeakSet,yX=function*$(){if(this.error)yield this.error;yield*fX(this,$Y,"f")};function gX($,Z,Y){if(e($,Z,Y))return;throw new vX(i6($,Z,Y))}function ZY(...$){return $.length===3?gX($[0],$[1],$[2]):gX($[0],[],$[1])}function PL($){let Z={};for(let Y of Object.getOwnPropertyNames($))Z[Y]=B1($[Y]);for(let Y of Object.getOwnPropertySymbols($))Z[Y]=B1($[Y]);return Z}function KL($){return $.map((Z)=>B1(Z))}function RL($){return $.slice()}function jL($){return new Map(B1([...$.entries()]))}function CL($){return new Set(B1([...$.entries()]))}function _L($){return new Date($.toISOString())}function VL($){return $}function B1($){if(o($))return KL($);if(K0($))return _L($);if(X6($))return RL($);if(XW($))return jL($);if(JW($))return CL($);if(a($))return PL($);if(t0($))return VL($);throw new Error("ValueClone: Unable to clone value")}class B6 extends i{constructor($,Z){super(Z);this.schema=$}}function w1($){return I8($)?$():B1($)}function EL($,Z){if(n($,"default"))return w1($.default);else return{}}function IL($,Z){return{}}function TL($,Z){if($.uniqueItems===!0&&!n($,"default"))throw new B6($,"Array with the uniqueItems constraint requires a default value");else if("contains"in $&&!n($,"default"))throw new B6($,"Array with the contains constraint requires a default value");else if("default"in $)return w1($.default);else if($.minItems!==void 0)return Array.from({length:$.minItems}).map((Y)=>{return v0($.items,Z)});else return[]}function bL($,Z){if(n($,"default"))return w1($.default);else return async function*(){}()}function xL($,Z){if(n($,"default"))return w1($.default);else return BigInt(0)}function kL($,Z){if(n($,"default"))return w1($.default);else return!1}function gL($,Z){if(n($,"default"))return w1($.default);else{let Y=v0($.returns,Z);if(typeof Y==="object"&&!Array.isArray(Y))return class{constructor(){for(let[Q,W]of Object.entries(Y)){let X=this;X[Q]=W}}};else return class{}}}function fL($,Z){if(n($,"default"))return w1($.default);else if($.minimumTimestamp!==void 0)return new Date($.minimumTimestamp);else return new Date}function yL($,Z){if(n($,"default"))return w1($.default);else return()=>v0($.returns,Z)}function vL($,Z){let Y=globalThis.Object.values($.$defs),Q=$.$defs[$.$ref];return v0(Q,[...Z,...Y])}function dL($,Z){if(n($,"default"))return w1($.default);else if($.minimum!==void 0)return $.minimum;else return 0}function hL($,Z){if(n($,"default"))return w1($.default);else{let Y=$.allOf.reduce((Q,W)=>{let X=v0(W,Z);return typeof X==="object"?{...Q,...X}:X},{});if(!e($,Z,Y))throw new B6($,"Intersect produced invalid value. Consider using a default value.");return Y}}function mL($,Z){if(n($,"default"))return w1($.default);else return function*(){}()}function uL($,Z){if(n($,"default"))return w1($.default);else return $.const}function cL($,Z){if(n($,"default"))return w1($.default);else throw new B6($,"Never types cannot be created. Consider using a default value.")}function pL($,Z){if(n($,"default"))return w1($.default);else throw new B6($,"Not types must have a default value")}function iL($,Z){if(n($,"default"))return w1($.default);else return null}function lL($,Z){if(n($,"default"))return w1($.default);else if($.minimum!==void 0)return $.minimum;else return 0}function nL($,Z){if(n($,"default"))return w1($.default);else{let Y=new Set($.required),Q={};for(let[W,X]of Object.entries($.properties)){if(!Y.has(W))continue;Q[W]=v0(X,Z)}return Q}}function oL($,Z){if(n($,"default"))return w1($.default);else return Promise.resolve(v0($.item,Z))}function tL($,Z){let[Y,Q]=Object.entries($.patternProperties)[0];if(n($,"default"))return w1($.default);else if(!(Y===u6||Y===m6)){let W=Y.slice(1,Y.length-1).split("|"),X={};for(let J of W)X[J]=v0(Q,Z);return X}else return{}}function sL($,Z){if(n($,"default"))return w1($.default);else return v0(M1($,Z),Z)}function rL($,Z){if(n($,"default"))return w1($.default);else throw new B6($,"RegExp types cannot be created. Consider using a default value.")}function aL($,Z){if($.pattern!==void 0)if(!n($,"default"))throw new B6($,"String types with patterns must specify a default value");else return w1($.default);else if($.format!==void 0)if(!n($,"default"))throw new B6($,"String types with formats must specify a default value");else return w1($.default);else if(n($,"default"))return w1($.default);else if($.minLength!==void 0)return Array.from({length:$.minLength}).map(()=>" ").join("");else return""}function eL($,Z){if(n($,"default"))return w1($.default);else if("value"in $)return Symbol.for($.value);else return Symbol()}function $O($,Z){if(n($,"default"))return w1($.default);if(!gZ($))throw new B6($,"Can only create template literals that produce a finite variants. Consider using a default value.");return h4($)[0]}function ZO($,Z){if(dX++>SO)throw new B6($,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(n($,"default"))return w1($.default);else return v0(M1($,Z),Z)}function YO($,Z){if(n($,"default"))return w1($.default);if($.items===void 0)return[];else return Array.from({length:$.minItems}).map((Y,Q)=>v0($.items[Q],Z))}function QO($,Z){if(n($,"default"))return w1($.default);else return}function WO($,Z){if(n($,"default"))return w1($.default);else if($.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return v0($.anyOf[0],Z)}function XO($,Z){if(n($,"default"))return w1($.default);else if($.minByteLength!==void 0)return new Uint8Array($.minByteLength);else return new Uint8Array(0)}function JO($,Z){if(n($,"default"))return w1($.default);else return{}}function zO($,Z){if(n($,"default"))return w1($.default);else return}function UO($,Z){if(n($,"default"))return w1($.default);else throw new Error("User defined types must specify a default value")}function v0($,Z){let Y=X0($,Z),Q=$;switch(Q[L]){case"Any":return EL(Q,Y);case"Argument":return IL(Q,Y);case"Array":return TL(Q,Y);case"AsyncIterator":return bL(Q,Y);case"BigInt":return xL(Q,Y);case"Boolean":return kL(Q,Y);case"Constructor":return gL(Q,Y);case"Date":return fL(Q,Y);case"Function":return yL(Q,Y);case"Import":return vL(Q,Y);case"Integer":return dL(Q,Y);case"Intersect":return hL(Q,Y);case"Iterator":return mL(Q,Y);case"Literal":return uL(Q,Y);case"Never":return cL(Q,Y);case"Not":return pL(Q,Y);case"Null":return iL(Q,Y);case"Number":return lL(Q,Y);case"Object":return nL(Q,Y);case"Promise":return oL(Q,Y);case"Record":return tL(Q,Y);case"Ref":return sL(Q,Y);case"RegExp":return rL(Q,Y);case"String":return aL(Q,Y);case"Symbol":return eL(Q,Y);case"TemplateLiteral":return $O(Q,Y);case"This":return ZO(Q,Y);case"Tuple":return YO(Q,Y);case"Undefined":return QO(Q,Y);case"Union":return WO(Q,Y);case"Uint8Array":return XO(Q,Y);case"Unknown":return JO(Q,Y);case"Void":return zO(Q,Y);default:if(!Y0.Has(Q[L]))throw new B6(Q,"Unknown type");return UO(Q,Y)}}var SO=512,dX=0;function w6(...$){return dX=0,$.length===2?v0($[0],$[1]):v0($[0],[])}class Z5 extends i{constructor($,Z){super(Z);this.schema=$}}function qO($,Z,Y){if($[L]==="Object"&&typeof Y==="object"&&!Q8(Y)){let Q=$,W=Object.getOwnPropertyNames(Y),X=Object.entries(Q.properties),[J,z]=[1/X.length,X.length];return X.reduce((U,[S,q])=>{let M=q[L]==="Literal"&&q.const===Y[S]?z:0,H=e(q,Z,Y[S])?J:0,w=W.includes(S)?J:0;return U+(M+H+w)},0)}else return e($,Z,Y)?1:0}function GO($,Z,Y){let Q=$.anyOf.map((J)=>M1(J,Z)),[W,X]=[Q[0],0];for(let J of Q){let z=qO(J,Z,Y);if(z>X)W=J,X=z}return W}function MO($,Z,Y){if("default"in $)return typeof Y==="function"?$.default:B1($.default);else{let Q=GO($,Z,Y);return k$(Q,Z,Y)}}function BO($,Z,Y){return e($,Z,Y)?B1(Y):w6($,Z)}function wO($,Z,Y){return e($,Z,Y)?Y:w6($,Z)}function HO($,Z,Y){if(e($,Z,Y))return B1(Y);let Q=o(Y)?B1(Y):w6($,Z),W=c($.minItems)&&Q.length<$.minItems?[...Q,...Array.from({length:$.minItems-Q.length},()=>null)]:Q,J=(c($.maxItems)&&W.length>$.maxItems?W.slice(0,$.maxItems):W).map((U)=>V6($.items,Z,U));if($.uniqueItems!==!0)return J;let z=[...new Set(J)];if(!e($,Z,z))throw new Z5($,"Array cast produced invalid data due to uniqueItems constraint");return z}function DO($,Z,Y){if(e($,Z,Y))return w6($,Z);let Q=new Set($.returns.required||[]),W=function(){};for(let[X,J]of Object.entries($.returns.properties)){if(!Q.has(X)&&Y.prototype[X]===void 0)continue;W.prototype[X]=V6(J,Z,Y.prototype[X])}return W}function AO($,Z,Y){let Q=globalThis.Object.values($.$defs),W=$.$defs[$.$ref];return V6(W,[...Z,...Q],Y)}function NO($,Z,Y){let Q=w6($,Z),W=a(Q)&&a(Y)?{...Q,...Y}:Y;return e($,Z,W)?W:w6($,Z)}function LO($,Z,Y){throw new Z5($,"Never types cannot be cast")}function OO($,Z,Y){if(e($,Z,Y))return Y;if(Y===null||typeof Y!=="object")return w6($,Z);let Q=new Set($.required||[]),W={};for(let[X,J]of Object.entries($.properties)){if(!Q.has(X)&&Y[X]===void 0)continue;W[X]=V6(J,Z,Y[X])}if(typeof $.additionalProperties==="object"){let X=Object.getOwnPropertyNames($.properties);for(let J of Object.getOwnPropertyNames(Y)){if(X.includes(J))continue;W[J]=V6($.additionalProperties,Z,Y[J])}}return W}function FO($,Z,Y){if(e($,Z,Y))return B1(Y);if(Y===null||typeof Y!=="object"||Array.isArray(Y)||Y instanceof Date)return w6($,Z);let Q=Object.getOwnPropertyNames($.patternProperties)[0],W=$.patternProperties[Q],X={};for(let[J,z]of Object.entries(Y))X[J]=V6(W,Z,z);return X}function PO($,Z,Y){return V6(M1($,Z),Z,Y)}function KO($,Z,Y){return V6(M1($,Z),Z,Y)}function RO($,Z,Y){if(e($,Z,Y))return B1(Y);if(!o(Y))return w6($,Z);if($.items===void 0)return[];return $.items.map((Q,W)=>V6(Q,Z,Y[W]))}function jO($,Z,Y){return e($,Z,Y)?B1(Y):MO($,Z,Y)}function V6($,Z,Y){let Q=J1($.$id)?X0($,Z):Z,W=$;switch($[L]){case"Array":return HO(W,Q,Y);case"Constructor":return DO(W,Q,Y);case"Import":return AO(W,Q,Y);case"Intersect":return NO(W,Q,Y);case"Never":return LO(W,Q,Y);case"Object":return OO(W,Q,Y);case"Record":return FO(W,Q,Y);case"Ref":return PO(W,Q,Y);case"This":return KO(W,Q,Y);case"Tuple":return RO(W,Q,Y);case"Union":return jO(W,Q,Y);case"Date":case"Symbol":case"Uint8Array":return BO($,Z,Y);default:return wO(W,Q,Y)}}function k$(...$){return $.length===3?V6($[0],$[1],$[2]):V6($[0],[],$[1])}function CO($){return b8($)&&$[L]!=="Unsafe"}function _O($,Z,Y){if(!o(Y))return Y;return Y.map((Q)=>d0($.items,Z,Q))}function VO($,Z,Y){let Q=globalThis.Object.values($.$defs),W=$.$defs[$.$ref];return d0(W,[...Z,...Q],Y)}function EO($,Z,Y){let Q=$.unevaluatedProperties,X=$.allOf.map((z)=>d0(z,Z,B1(Y))).reduce((z,U)=>a(U)?{...z,...U}:U,{});if(!a(Y)||!a(X)||!b8(Q))return X;let J=f0($);for(let z of Object.getOwnPropertyNames(Y)){if(J.includes(z))continue;if(e(Q,Z,Y[z]))X[z]=d0(Q,Z,Y[z])}return X}function IO($,Z,Y){if(!a(Y)||o(Y))return Y;let Q=$.additionalProperties;for(let W of Object.getOwnPropertyNames(Y)){if(n($.properties,W)){Y[W]=d0($.properties[W],Z,Y[W]);continue}if(b8(Q)&&e(Q,Z,Y[W])){Y[W]=d0(Q,Z,Y[W]);continue}delete Y[W]}return Y}function TO($,Z,Y){if(!a(Y))return Y;let Q=$.additionalProperties,W=Object.getOwnPropertyNames(Y),[X,J]=Object.entries($.patternProperties)[0],z=new RegExp(X);for(let U of W){if(z.test(U)){Y[U]=d0(J,Z,Y[U]);continue}if(b8(Q)&&e(Q,Z,Y[U])){Y[U]=d0(Q,Z,Y[U]);continue}delete Y[U]}return Y}function bO($,Z,Y){return d0(M1($,Z),Z,Y)}function xO($,Z,Y){return d0(M1($,Z),Z,Y)}function kO($,Z,Y){if(!o(Y))return Y;if(k1($.items))return[];let Q=Math.min(Y.length,$.items.length);for(let W=0;W<Q;W++)Y[W]=d0($.items[W],Z,Y[W]);return Y.length>Q?Y.slice(0,Q):Y}function gO($,Z,Y){for(let Q of $.anyOf)if(CO(Q)&&e(Q,Z,Y))return d0(Q,Z,Y);return Y}function d0($,Z,Y){let Q=J1($.$id)?X0($,Z):Z,W=$;switch(W[L]){case"Array":return _O(W,Q,Y);case"Import":return VO(W,Q,Y);case"Intersect":return EO(W,Q,Y);case"Object":return IO(W,Q,Y);case"Record":return TO(W,Q,Y);case"Ref":return bO(W,Q,Y);case"This":return xO(W,Q,Y);case"Tuple":return kO(W,Q,Y);case"Union":return gO(W,Q,Y);default:return Y}}function YY(...$){return $.length===3?d0($[0],$[1],$[2]):d0($[0],[],$[1])}function QY($){return J1($)&&!isNaN($)&&!isNaN(parseFloat($))}function fO($){return q0($)||h6($)||c($)}function g$($){return $===!0||c($)&&$===1||q0($)&&$===BigInt("1")||J1($)&&($.toLowerCase()==="true"||$==="1")}function f$($){return $===!1||c($)&&($===0||Object.is($,-0))||q0($)&&$===BigInt("0")||J1($)&&($.toLowerCase()==="false"||$==="0"||$==="-0")}function yO($){return J1($)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test($)}function vO($){return J1($)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test($)}function dO($){return J1($)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test($)}function hO($){return J1($)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test($)}function mO($){return J1($)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test($)}function uO($,Z){let Y=mX($);return Y===Z?Y:$}function cO($,Z){let Y=uX($);return Y===Z?Y:$}function pO($,Z){let Y=hX($);return Y===Z?Y:$}function iO($,Z){return J1($.const)?uO(Z,$.const):c($.const)?cO(Z,$.const):h6($.const)?pO(Z,$.const):Z}function hX($){return g$($)?!0:f$($)?!1:$}function lO($){let Z=(Y)=>Y.split(".")[0];return QY($)?BigInt(Z($)):c($)?BigInt(Math.trunc($)):f$($)?BigInt(0):g$($)?BigInt(1):$}function mX($){return W8($)&&$.description!==void 0?$.description.toString():fO($)?$.toString():$}function uX($){return QY($)?parseFloat($):g$($)?1:f$($)?0:$}function nO($){return QY($)?parseInt($):c($)?Math.trunc($):g$($)?1:f$($)?0:$}function oO($){return J1($)&&$.toLowerCase()==="null"?null:$}function tO($){return J1($)&&$==="undefined"?void 0:$}function sO($){return K0($)?$:c($)?new Date($):g$($)?new Date(1):f$($)?new Date(0):QY($)?new Date(parseInt($)):vO($)?new Date(`1970-01-01T${$}.000Z`):yO($)?new Date(`1970-01-01T${$}`):hO($)?new Date(`${$}.000Z`):dO($)?new Date($):mO($)?new Date(`${$}T00:00:00.000Z`):$}function rO($){return $}function aO($,Z,Y){return(o(Y)?Y:[Y]).map((W)=>E6($.items,Z,W))}function eO($,Z,Y){return lO(Y)}function $F($,Z,Y){return hX(Y)}function ZF($,Z,Y){return sO(Y)}function YF($,Z,Y){let Q=globalThis.Object.values($.$defs),W=$.$defs[$.$ref];return E6(W,[...Z,...Q],Y)}function QF($,Z,Y){return nO(Y)}function WF($,Z,Y){return $.allOf.reduce((Q,W)=>E6(W,Z,Q),Y)}function XF($,Z,Y){return iO($,Y)}function JF($,Z,Y){return oO(Y)}function zF($,Z,Y){return uX(Y)}function UF($,Z,Y){if(!a(Y))return Y;for(let Q of Object.getOwnPropertyNames($.properties)){if(!n(Y,Q))continue;Y[Q]=E6($.properties[Q],Z,Y[Q])}return Y}function SF($,Z,Y){if(!a(Y))return Y;let W=Object.getOwnPropertyNames($.patternProperties)[0],X=$.patternProperties[W];for(let[J,z]of Object.entries(Y))Y[J]=E6(X,Z,z);return Y}function qF($,Z,Y){return E6(M1($,Z),Z,Y)}function GF($,Z,Y){return mX(Y)}function MF($,Z,Y){return J1(Y)||c(Y)?Symbol(Y):Y}function BF($,Z,Y){return E6(M1($,Z),Z,Y)}function wF($,Z,Y){if(!(o(Y)&&!k1($.items)))return Y;return Y.map((W,X)=>{return X<$.items.length?E6($.items[X],Z,W):W})}function HF($,Z,Y){return tO(Y)}function DF($,Z,Y){for(let Q of $.anyOf){let W=E6(Q,Z,B1(Y));if(!e(Q,Z,W))continue;return W}return Y}function E6($,Z,Y){let Q=X0($,Z),W=$;switch($[L]){case"Array":return aO(W,Q,Y);case"BigInt":return eO(W,Q,Y);case"Boolean":return $F(W,Q,Y);case"Date":return ZF(W,Q,Y);case"Import":return YF(W,Q,Y);case"Integer":return QF(W,Q,Y);case"Intersect":return WF(W,Q,Y);case"Literal":return XF(W,Q,Y);case"Null":return JF(W,Q,Y);case"Number":return zF(W,Q,Y);case"Object":return UF(W,Q,Y);case"Record":return SF(W,Q,Y);case"Ref":return qF(W,Q,Y);case"String":return GF(W,Q,Y);case"Symbol":return MF(W,Q,Y);case"This":return BF(W,Q,Y);case"Tuple":return wF(W,Q,Y);case"Undefined":return HF(W,Q,Y);case"Union":return DF(W,Q,Y);default:return rO(Y)}}function WY(...$){return $.length===3?E6($[0],$[1],$[2]):E6($[0],[],$[1])}class y$ extends i{constructor($,Z,Y){super("Unable to decode value as it does not match the expected schema");this.schema=$,this.value=Z,this.error=Y}}class XY extends i{constructor($,Z,Y,Q){super(Q instanceof Error?Q.message:"Unknown error");this.schema=$,this.path=Z,this.value=Y,this.error=Q}}function h1($,Z,Y){try{return H1($)?$[R1].Decode(Y):Y}catch(Q){throw new XY($,Z,Y,Q)}}function AF($,Z,Y,Q){return o(Q)?h1($,Y,Q.map((W,X)=>I6($.items,Z,`${Y}/${X}`,W))):h1($,Y,Q)}function NF($,Z,Y,Q){if(!a(Q)||t0(Q))return h1($,Y,Q);let W=hZ($),X=W.map((q)=>q[0]),J={...Q};for(let[q,M]of W)if(q in J)J[q]=I6(M,Z,`${Y}/${q}`,J[q]);if(!H1($.unevaluatedProperties))return h1($,Y,J);let z=Object.getOwnPropertyNames(J),U=$.unevaluatedProperties,S={...J};for(let q of z)if(!X.includes(q))S[q]=h1(U,`${Y}/${q}`,S[q]);return h1($,Y,S)}function LF($,Z,Y,Q){let W=globalThis.Object.values($.$defs),X=$.$defs[$.$ref],J=I6(X,[...Z,...W],Y,Q);return h1($,Y,J)}function OF($,Z,Y,Q){return h1($,Y,I6($.not,Z,Y,Q))}function FF($,Z,Y,Q){if(!a(Q))return h1($,Y,Q);let W=f0($),X={...Q};for(let S of W){if(!n(X,S))continue;if(k1(X[S])&&(!z8($.properties[S])||E1.IsExactOptionalProperty(X,S)))continue;X[S]=I6($.properties[S],Z,`${Y}/${S}`,X[S])}if(!d1($.additionalProperties))return h1($,Y,X);let J=Object.getOwnPropertyNames(X),z=$.additionalProperties,U={...X};for(let S of J)if(!W.includes(S))U[S]=h1(z,`${Y}/${S}`,U[S]);return h1($,Y,U)}function PF($,Z,Y,Q){if(!a(Q))return h1($,Y,Q);let W=Object.getOwnPropertyNames($.patternProperties)[0],X=new RegExp(W),J={...Q};for(let q of Object.getOwnPropertyNames(Q))if(X.test(q))J[q]=I6($.patternProperties[W],Z,`${Y}/${q}`,J[q]);if(!d1($.additionalProperties))return h1($,Y,J);let z=Object.getOwnPropertyNames(J),U=$.additionalProperties,S={...J};for(let q of z)if(!X.test(q))S[q]=h1(U,`${Y}/${q}`,S[q]);return h1($,Y,S)}function KF($,Z,Y,Q){let W=M1($,Z);return h1($,Y,I6(W,Z,Y,Q))}function RF($,Z,Y,Q){let W=M1($,Z);return h1($,Y,I6(W,Z,Y,Q))}function jF($,Z,Y,Q){return o(Q)&&o($.items)?h1($,Y,$.items.map((W,X)=>I6(W,Z,`${Y}/${X}`,Q[X]))):h1($,Y,Q)}function CF($,Z,Y,Q){for(let W of $.anyOf){if(!e(W,Z,Q))continue;let X=I6(W,Z,Y,Q);return h1($,Y,X)}return h1($,Y,Q)}function I6($,Z,Y,Q){let W=X0($,Z),X=$;switch($[L]){case"Array":return AF(X,W,Y,Q);case"Import":return LF(X,W,Y,Q);case"Intersect":return NF(X,W,Y,Q);case"Not":return OF(X,W,Y,Q);case"Object":return FF(X,W,Y,Q);case"Record":return PF(X,W,Y,Q);case"Ref":return KF(X,W,Y,Q);case"Symbol":return h1(X,Y,Q);case"This":return RF(X,W,Y,Q);case"Tuple":return jF(X,W,Y,Q);case"Union":return CF(X,W,Y,Q);default:return h1(X,Y,Q)}}function e4($,Z,Y){return I6($,Z,"",Y)}class v$ extends i{constructor($,Z,Y){super("The encoded value does not match the expected schema");this.schema=$,this.value=Z,this.error=Y}}class cX extends i{constructor($,Z,Y,Q){super(`${Q instanceof Error?Q.message:"Unknown error"}`);this.schema=$,this.path=Z,this.value=Y,this.error=Q}}function G0($,Z,Y){try{return H1($)?$[R1].Encode(Y):Y}catch(Q){throw new cX($,Z,Y,Q)}}function _F($,Z,Y,Q){let W=G0($,Y,Q);return o(W)?W.map((X,J)=>T6($.items,Z,`${Y}/${J}`,X)):W}function VF($,Z,Y,Q){let W=globalThis.Object.values($.$defs),X=$.$defs[$.$ref],J=G0($,Y,Q);return T6(X,[...Z,...W],Y,J)}function EF($,Z,Y,Q){let W=G0($,Y,Q);if(!a(Q)||t0(Q))return W;let X=hZ($),J=X.map((M)=>M[0]),z={...W};for(let[M,H]of X)if(M in z)z[M]=T6(H,Z,`${Y}/${M}`,z[M]);if(!H1($.unevaluatedProperties))return z;let U=Object.getOwnPropertyNames(z),S=$.unevaluatedProperties,q={...z};for(let M of U)if(!J.includes(M))q[M]=G0(S,`${Y}/${M}`,q[M]);return q}function IF($,Z,Y,Q){return G0($.not,Y,G0($,Y,Q))}function TF($,Z,Y,Q){let W=G0($,Y,Q);if(!a(W))return W;let X=f0($),J={...W};for(let q of X){if(!n(J,q))continue;if(k1(J[q])&&(!z8($.properties[q])||E1.IsExactOptionalProperty(J,q)))continue;J[q]=T6($.properties[q],Z,`${Y}/${q}`,J[q])}if(!d1($.additionalProperties))return J;let z=Object.getOwnPropertyNames(J),U=$.additionalProperties,S={...J};for(let q of z)if(!X.includes(q))S[q]=G0(U,`${Y}/${q}`,S[q]);return S}function bF($,Z,Y,Q){let W=G0($,Y,Q);if(!a(Q))return W;let X=Object.getOwnPropertyNames($.patternProperties)[0],J=new RegExp(X),z={...W};for(let M of Object.getOwnPropertyNames(Q))if(J.test(M))z[M]=T6($.patternProperties[X],Z,`${Y}/${M}`,z[M]);if(!d1($.additionalProperties))return z;let U=Object.getOwnPropertyNames(z),S=$.additionalProperties,q={...z};for(let M of U)if(!J.test(M))q[M]=G0(S,`${Y}/${M}`,q[M]);return q}function xF($,Z,Y,Q){let W=M1($,Z),X=T6(W,Z,Y,Q);return G0($,Y,X)}function kF($,Z,Y,Q){let W=M1($,Z),X=T6(W,Z,Y,Q);return G0($,Y,X)}function gF($,Z,Y,Q){let W=G0($,Y,Q);return o($.items)?$.items.map((X,J)=>T6(X,Z,`${Y}/${J}`,W[J])):[]}function fF($,Z,Y,Q){for(let W of $.anyOf){if(!e(W,Z,Q))continue;let X=T6(W,Z,Y,Q);return G0($,Y,X)}for(let W of $.anyOf){let X=T6(W,Z,Y,Q);if(!e($,Z,X))continue;return G0($,Y,X)}return G0($,Y,Q)}function T6($,Z,Y,Q){let W=X0($,Z),X=$;switch($[L]){case"Array":return _F(X,W,Y,Q);case"Import":return VF(X,W,Y,Q);case"Intersect":return EF(X,W,Y,Q);case"Not":return IF(X,W,Y,Q);case"Object":return TF(X,W,Y,Q);case"Record":return bF(X,W,Y,Q);case"Ref":return xF(X,W,Y,Q);case"This":return kF(X,W,Y,Q);case"Tuple":return gF(X,W,Y,Q);case"Union":return fF(X,W,Y,Q);default:return G0(X,Y,Q)}}function $$($,Z,Y){return T6($,Z,"",Y)}function yF($,Z){return H1($)||Q0($.items,Z)}function vF($,Z){return H1($)||Q0($.items,Z)}function dF($,Z){return H1($)||Q0($.returns,Z)||$.parameters.some((Y)=>Q0(Y,Z))}function hF($,Z){return H1($)||Q0($.returns,Z)||$.parameters.some((Y)=>Q0(Y,Z))}function mF($,Z){return H1($)||H1($.unevaluatedProperties)||$.allOf.some((Y)=>Q0(Y,Z))}function uF($,Z){let Y=globalThis.Object.getOwnPropertyNames($.$defs).reduce((W,X)=>[...W,$.$defs[X]],[]),Q=$.$defs[$.$ref];return H1($)||Q0(Q,[...Y,...Z])}function cF($,Z){return H1($)||Q0($.items,Z)}function pF($,Z){return H1($)||Q0($.not,Z)}function iF($,Z){return H1($)||Object.values($.properties).some((Y)=>Q0(Y,Z))||d1($.additionalProperties)&&Q0($.additionalProperties,Z)}function lF($,Z){return H1($)||Q0($.item,Z)}function nF($,Z){let Y=Object.getOwnPropertyNames($.patternProperties)[0],Q=$.patternProperties[Y];return H1($)||Q0(Q,Z)||d1($.additionalProperties)&&H1($.additionalProperties)}function oF($,Z){if(H1($))return!0;return Q0(M1($,Z),Z)}function tF($,Z){if(H1($))return!0;return Q0(M1($,Z),Z)}function sF($,Z){return H1($)||!k1($.items)&&$.items.some((Y)=>Q0(Y,Z))}function rF($,Z){return H1($)||$.anyOf.some((Y)=>Q0(Y,Z))}function Q0($,Z){let Y=X0($,Z),Q=$;if($.$id&&Y5.has($.$id))return!1;if($.$id)Y5.add($.$id);switch($[L]){case"Array":return yF(Q,Y);case"AsyncIterator":return vF(Q,Y);case"Constructor":return dF(Q,Y);case"Function":return hF(Q,Y);case"Import":return uF(Q,Y);case"Intersect":return mF(Q,Y);case"Iterator":return cF(Q,Y);case"Not":return pF(Q,Y);case"Object":return iF(Q,Y);case"Promise":return lF(Q,Y);case"Record":return nF(Q,Y);case"Ref":return oF(Q,Y);case"This":return tF(Q,Y);case"Tuple":return sF(Q,Y);case"Union":return rF(Q,Y);default:return H1($)}}var Y5=new Set;function w8($,Z){return Y5.clear(),Q0($,Z)}function pX(...$){let[Z,Y,Q]=$.length===3?[$[0],$[1],$[2]]:[$[0],[],$[1]];if(!e(Z,Y,Q))throw new y$(Z,Q,i6(Z,Y,Q).First());return w8(Z,Y)?e4(Z,Y,Q):Q}function H8($,Z){let Y=n($,"default")?$.default:void 0,Q=I8(Y)?Y():B1(Y);return k1(Z)?Q:a(Z)&&a(Q)?Object.assign(Q,Z):Z}function Q5($){return b8($)&&"default"in $}function aF($,Z,Y){if(o(Y)){for(let W=0;W<Y.length;W++)Y[W]=j0($.items,Z,Y[W]);return Y}let Q=H8($,Y);if(!o(Q))return Q;for(let W=0;W<Q.length;W++)Q[W]=j0($.items,Z,Q[W]);return Q}function eF($,Z,Y){return K0(Y)?Y:H8($,Y)}function $P($,Z,Y){let Q=globalThis.Object.values($.$defs),W=$.$defs[$.$ref];return j0(W,[...Z,...Q],Y)}function ZP($,Z,Y){let Q=H8($,Y);return $.allOf.reduce((W,X)=>{let J=j0(X,Z,Q);return a(J)?{...W,...J}:J},{})}function YP($,Z,Y){let Q=H8($,Y);if(!a(Q))return Q;let W=Object.getOwnPropertyNames($.properties);for(let X of W){let J=j0($.properties[X],Z,Q[X]);if(k1(J))continue;Q[X]=j0($.properties[X],Z,Q[X])}if(!Q5($.additionalProperties))return Q;for(let X of Object.getOwnPropertyNames(Q)){if(W.includes(X))continue;Q[X]=j0($.additionalProperties,Z,Q[X])}return Q}function QP($,Z,Y){let Q=H8($,Y);if(!a(Q))return Q;let W=$.additionalProperties,[X,J]=Object.entries($.patternProperties)[0],z=new RegExp(X);for(let U of Object.getOwnPropertyNames(Q)){if(!(z.test(U)&&Q5(J)))continue;Q[U]=j0(J,Z,Q[U])}if(!Q5(W))return Q;for(let U of Object.getOwnPropertyNames(Q)){if(z.test(U))continue;Q[U]=j0(W,Z,Q[U])}return Q}function WP($,Z,Y){return j0(M1($,Z),Z,H8($,Y))}function XP($,Z,Y){return j0(M1($,Z),Z,Y)}function JP($,Z,Y){let Q=H8($,Y);if(!o(Q)||k1($.items))return Q;let[W,X]=[$.items,Math.max($.items.length,Q.length)];for(let J=0;J<X;J++)if(J<W.length)Q[J]=j0(W[J],Z,Q[J]);return Q}function zP($,Z,Y){let Q=H8($,Y);for(let W of $.anyOf){let X=j0(W,Z,B1(Q));if(e(W,Z,X))return X}return Q}function j0($,Z,Y){let Q=X0($,Z),W=$;switch(W[L]){case"Array":return aF(W,Q,Y);case"Date":return eF(W,Q,Y);case"Import":return $P(W,Q,Y);case"Intersect":return ZP(W,Q,Y);case"Object":return YP(W,Q,Y);case"Record":return QP(W,Q,Y);case"Ref":return WP(W,Q,Y);case"This":return XP(W,Q,Y);case"Tuple":return JP(W,Q,Y);case"Union":return zP(W,Q,Y);default:return H8(W,Y)}}function JY(...$){return $.length===3?j0($[0],$[1],$[2]):j0($[0],[],$[1])}var b6={};J4(b6,{ValuePointerRootSetError:()=>W5,ValuePointerRootDeleteError:()=>X5,Set:()=>UP,Has:()=>qP,Get:()=>GP,Format:()=>d$,Delete:()=>SP});class W5 extends i{constructor($,Z,Y){super("Cannot set root value");this.value=$,this.path=Z,this.update=Y}}class X5 extends i{constructor($,Z){super("Cannot delete root value");this.value=$,this.path=Z}}function iX($){return $.indexOf("~")===-1?$:$.replace(/~1/g,"/").replace(/~0/g,"~")}function*d$($){if($==="")return;let[Z,Y]=[0,0];for(let Q=0;Q<$.length;Q++)if($.charAt(Q)==="/")if(Q===0)Z=Q+1;else Y=Q,yield iX($.slice(Z,Y)),Z=Q+1;else Y=Q;yield iX($.slice(Z))}function UP($,Z,Y){if(Z==="")throw new W5($,Z,Y);let[Q,W,X]=[null,$,""];for(let J of d$(Z)){if(W[J]===void 0)W[J]={};Q=W,W=W[J],X=J}Q[X]=Y}function SP($,Z){if(Z==="")throw new X5($,Z);let[Y,Q,W]=[null,$,""];for(let X of d$(Z)){if(Q[X]===void 0||Q[X]===null)return;Y=Q,Q=Q[X],W=X}if(Array.isArray(Y)){let X=parseInt(W);Y.splice(X,1)}else delete Y[W]}function qP($,Z){if(Z==="")return!0;let[Y,Q,W]=[null,$,""];for(let X of d$(Z)){if(Q[X]===void 0)return!1;Y=Q,Q=Q[X],W=X}return Object.getOwnPropertyNames(Y).includes(W)}function GP($,Z){if(Z==="")return $;let Y=$;for(let Q of d$(Z)){if(Y[Q]===void 0)return;Y=Y[Q]}return Y}function MP($,Z){if(!a(Z))return!1;let Y=[...Object.keys($),...Object.getOwnPropertySymbols($)],Q=[...Object.keys(Z),...Object.getOwnPropertySymbols(Z)];if(Y.length!==Q.length)return!1;return Y.every((W)=>A4($[W],Z[W]))}function BP($,Z){return K0(Z)&&$.getTime()===Z.getTime()}function wP($,Z){if(!o(Z)||$.length!==Z.length)return!1;return $.every((Y,Q)=>A4(Y,Z[Q]))}function HP($,Z){if(!X6(Z)||$.length!==Z.length||Object.getPrototypeOf($).constructor.name!==Object.getPrototypeOf(Z).constructor.name)return!1;return $.every((Y,Q)=>A4(Y,Z[Q]))}function DP($,Z){return $===Z}function A4($,Z){if(K0($))return BP($,Z);if(X6($))return HP($,Z);if(o($))return wP($,Z);if(a($))return MP($,Z);if(t0($))return DP($,Z);throw new Error("ValueEquals: Unable to compare value")}var AP=A1({type:X1("insert"),path:R0(),value:j6()}),NP=A1({type:X1("update"),path:R0(),value:j6()}),LP=A1({type:X1("delete"),path:R0()}),nX=D1([AP,NP,LP]);class J5 extends i{constructor($,Z){super(Z);this.value=$}}function zY($,Z){return{type:"update",path:$,value:Z}}function oX($,Z){return{type:"insert",path:$,value:Z}}function tX($){return{type:"delete",path:$}}function lX($){if(globalThis.Object.getOwnPropertySymbols($).length>0)throw new J5($,"Cannot diff objects with symbols")}function*OP($,Z,Y){if(lX(Z),lX(Y),!T9(Y))return yield zY($,Y);let Q=globalThis.Object.getOwnPropertyNames(Z),W=globalThis.Object.getOwnPropertyNames(Y);for(let X of W){if(n(Z,X))continue;yield oX(`${$}/${X}`,Y[X])}for(let X of Q){if(!n(Y,X))continue;if(A4(Z,Y))continue;yield*UY(`${$}/${X}`,Z[X],Y[X])}for(let X of Q){if(n(Y,X))continue;yield tX(`${$}/${X}`)}}function*FP($,Z,Y){if(!o(Y))return yield zY($,Y);for(let Q=0;Q<Math.min(Z.length,Y.length);Q++)yield*UY(`${$}/${Q}`,Z[Q],Y[Q]);for(let Q=0;Q<Y.length;Q++){if(Q<Z.length)continue;yield oX(`${$}/${Q}`,Y[Q])}for(let Q=Z.length-1;Q>=0;Q--){if(Q<Y.length)continue;yield tX(`${$}/${Q}`)}}function*PP($,Z,Y){if(!X6(Y)||Z.length!==Y.length||globalThis.Object.getPrototypeOf(Z).constructor.name!==globalThis.Object.getPrototypeOf(Y).constructor.name)return yield zY($,Y);for(let Q=0;Q<Math.min(Z.length,Y.length);Q++)yield*UY(`${$}/${Q}`,Z[Q],Y[Q])}function*KP($,Z,Y){if(Z===Y)return;yield zY($,Y)}function*UY($,Z,Y){if(T9(Z))return yield*OP($,Z,Y);if(o(Z))return yield*FP($,Z,Y);if(X6(Z))return yield*PP($,Z,Y);if(t0(Z))return yield*KP($,Z,Y);throw new J5(Z,"Unable to diff value")}function sX($,Z){return[...UY("",$,Z)]}function RP($){return $.length>0&&$[0].path===""&&$[0].type==="update"}function jP($){return $.length===0}function rX($,Z){if(RP(Z))return B1(Z[0].value);if(jP(Z))return B1($);let Y=B1($);for(let Q of Z)switch(Q.type){case"insert":{b6.Set(Y,Q.path,Q.value);break}case"update":{b6.Set(Y,Q.path,Q.value);break}case"delete":{b6.Delete(Y,Q.path);break}}return Y}function aX(...$){let[Z,Y,Q]=$.length===3?[$[0],$[1],$[2]]:[$[0],[],$[1]],W=w8(Z,Y)?$$(Z,Y,Q):Q;if(!e(Z,Y,W))throw new v$(Z,W,i6(Z,Y,W).First());return W}function SY($){return a($)&&!o($)}class z5 extends i{constructor($){super($)}}function CP($,Z,Y,Q){if(!SY(Y))b6.Set($,Z,B1(Q));else{let W=Object.getOwnPropertyNames(Y),X=Object.getOwnPropertyNames(Q);for(let J of W)if(!X.includes(J))delete Y[J];for(let J of X)if(!W.includes(J))Y[J]=null;for(let J of X)U5($,`${Z}/${J}`,Y[J],Q[J])}}function _P($,Z,Y,Q){if(!o(Y))b6.Set($,Z,B1(Q));else{for(let W=0;W<Q.length;W++)U5($,`${Z}/${W}`,Y[W],Q[W]);Y.splice(Q.length)}}function VP($,Z,Y,Q){if(X6(Y)&&Y.length===Q.length)for(let W=0;W<Y.length;W++)Y[W]=Q[W];else b6.Set($,Z,B1(Q))}function EP($,Z,Y,Q){if(Y===Q)return;b6.Set($,Z,Q)}function U5($,Z,Y,Q){if(o(Q))return _P($,Z,Y,Q);if(X6(Q))return VP($,Z,Y,Q);if(SY(Q))return CP($,Z,Y,Q);if(t0(Q))return EP($,Z,Y,Q)}function eX($){return X6($)||t0($)}function IP($,Z){return SY($)&&o(Z)||o($)&&SY(Z)}function $J($,Z){if(eX($)||eX(Z))throw new z5("Only object and array types can be mutated at the root level");if(IP($,Z))throw new z5("Cannot assign due type mismatch of assignable values");U5($,"",$,Z)}class q5 extends i{constructor($){super($)}}var S5;(function($){let Z=new Map([["Assert",(X,J,z)=>{return ZY(X,J,z),z}],["Cast",(X,J,z)=>k$(X,J,z)],["Clean",(X,J,z)=>YY(X,J,z)],["Clone",(X,J,z)=>B1(z)],["Convert",(X,J,z)=>WY(X,J,z)],["Decode",(X,J,z)=>w8(X,J)?e4(X,J,z):z],["Default",(X,J,z)=>JY(X,J,z)],["Encode",(X,J,z)=>w8(X,J)?$$(X,J,z):z]]);function Y(X){Z.delete(X)}$.Delete=Y;function Q(X,J){Z.set(X,J)}$.Set=Q;function W(X){return Z.get(X)}$.Get=W})(S5||(S5={}));var ZJ=["Clone","Clean","Default","Convert","Assert","Decode"];function TP($,Z,Y,Q){return $.reduce((W,X)=>{let J=S5.Get(X);if(k1(J))throw new q5(`Unable to find Parse operation '${X}'`);return J(Z,Y,W)},Q)}function YJ(...$){let[Z,Y,Q,W]=$.length===4?[$[0],$[1],$[2],$[3]]:$.length===3?o($[0])?[$[0],$[1],[],$[2]]:[ZJ,$[0],$[1],$[2]]:$.length===2?[ZJ,$[0],[],$[1]]:(()=>{throw new q5("Invalid Arguments")})();return TP(Z,Y,Q,W)}var N1={};J4(N1,{ValueErrorIterator:()=>D4,Patch:()=>rX,Parse:()=>YJ,Mutate:()=>$J,Hash:()=>v8,Errors:()=>i6,Equal:()=>A4,Encode:()=>aX,Edit:()=>nX,Diff:()=>sX,Default:()=>JY,Decode:()=>pX,Create:()=>w6,Convert:()=>WY,Clone:()=>B1,Clean:()=>YY,Check:()=>e,Cast:()=>k$,Assert:()=>ZY});class QJ{constructor($,Z,Y,Q){this.schema=$,this.references=Z,this.checkFunc=Y,this.code=Q,this.hasTransform=w8($,Z)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors($){return i6(this.schema,this.references,$)}Check($){return this.checkFunc($)}Decode($){if(!this.checkFunc($))throw new y$(this.schema,$,this.Errors($).First());return this.hasTransform?e4(this.schema,this.references,$):$}Encode($){let Z=this.hasTransform?$$(this.schema,this.references,$):$;if(!this.checkFunc(Z))throw new v$(this.schema,$,this.Errors($).First());return Z}}var D8;(function($){function Z(X){return X===36}$.DollarSign=Z;function Y(X){return X===95}$.IsUnderscore=Y;function Q(X){return X>=65&&X<=90||X>=97&&X<=122}$.IsAlpha=Q;function W(X){return X>=48&&X<=57}$.IsNumeric=W})(D8||(D8={}));var qY;(function($){function Z(X){if(X.length===0)return!1;return D8.IsNumeric(X.charCodeAt(0))}function Y(X){if(Z(X))return!1;for(let J=0;J<X.length;J++){let z=X.charCodeAt(J);if(!(D8.IsAlpha(z)||D8.IsNumeric(z)||D8.DollarSign(z)||D8.IsUnderscore(z)))return!1}return!0}function Q(X){return X.replace(/'/g,"\\'")}function W(X,J){return Y(J)?`${X}.${J}`:`${X}['${Q(J)}']`}$.Encode=W})(qY||(qY={}));var G5;(function($){function Z(Y){let Q=[];for(let W=0;W<Y.length;W++){let X=Y.charCodeAt(W);if(D8.IsNumeric(X)||D8.IsAlpha(X))Q.push(Y.charAt(W));else Q.push(`_${X}_`)}return Q.join("").replace(/__/g,"_")}$.Encode=Z})(G5||(G5={}));var M5;(function($){function Z(Y){return Y.replace(/'/g,"\\'")}$.Escape=Z})(M5||(M5={}));class WJ extends i{constructor($){super("Unknown type");this.schema=$}}class B5 extends i{constructor($){super("Preflight validation check failed to guard for the given schema");this.schema=$}}var N4;(function($){function Z(J,z,U){return E1.ExactOptionalPropertyTypes?`('${z}' in ${J} ? ${U} : true)`:`(${qY.Encode(J,z)} !== undefined ? ${U} : true)`}$.IsExactOptionalProperty=Z;function Y(J){return!E1.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}))`:`(typeof ${J} === 'object' && ${J} !== null)`}$.IsObjectLike=Y;function Q(J){return!E1.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}) && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`:`(typeof ${J} === 'object' && ${J} !== null && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`}$.IsRecordLike=Q;function W(J){return E1.AllowNaN?`typeof ${J} === 'number'`:`Number.isFinite(${J})`}$.IsNumberLike=W;function X(J){return E1.AllowNullVoid?`(${J} === undefined || ${J} === null)`:`${J} === undefined`}$.IsVoidLike=X})(N4||(N4={}));var l6;(function($){function Z(B){return B[L]==="Any"||B[L]==="Unknown"}function*Y(B,F,D){yield"true"}function*Q(B,F,D){yield"true"}function*W(B,F,D){yield`Array.isArray(${D})`;let[I,E]=[V8("value","any"),V8("acc","number")];if(c(B.maxItems))yield`${D}.length <= ${B.maxItems}`;if(c(B.minItems))yield`${D}.length >= ${B.minItems}`;let T=w0(B.items,F,"value");if(yield`${D}.every((${I}) => ${T})`,f1(B.contains)||c(B.minContains)||c(B.maxContains)){let u=f1(B.contains)?B.contains:r(),C1=w0(u,F,"value"),H0=c(B.minContains)?[`(count >= ${B.minContains})`]:[],S0=c(B.maxContains)?[`(count <= ${B.maxContains})`]:[],n0=`const count = value.reduce((${E}, ${I}) => ${C1} ? acc + 1 : acc, 0)`,$8=["(count > 0)",...H0,...S0].join(" && ");yield`((${I}) => { ${n0}; return ${$8}})(${D})`}if(B.uniqueItems===!0)yield`((${I}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${D})`}function*X(B,F,D){yield`(typeof value === 'object' && Symbol.asyncIterator in ${D})`}function*J(B,F,D){if(yield`(typeof ${D} === 'bigint')`,q0(B.exclusiveMaximum))yield`${D} < BigInt(${B.exclusiveMaximum})`;if(q0(B.exclusiveMinimum))yield`${D} > BigInt(${B.exclusiveMinimum})`;if(q0(B.maximum))yield`${D} <= BigInt(${B.maximum})`;if(q0(B.minimum))yield`${D} >= BigInt(${B.minimum})`;if(q0(B.multipleOf))yield`(${D} % BigInt(${B.multipleOf})) === 0`}function*z(B,F,D){yield`(typeof ${D} === 'boolean')`}function*U(B,F,D){yield*C8(B.returns,F,`${D}.prototype`)}function*S(B,F,D){if(yield`(${D} instanceof Date) && Number.isFinite(${D}.getTime())`,c(B.exclusiveMaximumTimestamp))yield`${D}.getTime() < ${B.exclusiveMaximumTimestamp}`;if(c(B.exclusiveMinimumTimestamp))yield`${D}.getTime() > ${B.exclusiveMinimumTimestamp}`;if(c(B.maximumTimestamp))yield`${D}.getTime() <= ${B.maximumTimestamp}`;if(c(B.minimumTimestamp))yield`${D}.getTime() >= ${B.minimumTimestamp}`;if(c(B.multipleOfTimestamp))yield`(${D}.getTime() % ${B.multipleOfTimestamp}) === 0`}function*q(B,F,D){yield`(typeof ${D} === 'function')`}function*M(B,F,D){let I=globalThis.Object.getOwnPropertyNames(B.$defs).reduce((E,T)=>{return[...E,B.$defs[T]]},[]);yield*C8(q6(B.$ref),[...F,...I],D)}function*H(B,F,D){if(yield`Number.isInteger(${D})`,c(B.exclusiveMaximum))yield`${D} < ${B.exclusiveMaximum}`;if(c(B.exclusiveMinimum))yield`${D} > ${B.exclusiveMinimum}`;if(c(B.maximum))yield`${D} <= ${B.maximum}`;if(c(B.minimum))yield`${D} >= ${B.minimum}`;if(c(B.multipleOf))yield`(${D} % ${B.multipleOf}) === 0`}function*w(B,F,D){let I=B.allOf.map((E)=>w0(E,F,D)).join(" && ");if(B.unevaluatedProperties===!1){let E=_8(`${new RegExp(q8(B))};`),T=`Object.getOwnPropertyNames(${D}).every(key => ${E}.test(key))`;yield`(${I} && ${T})`}else if(f1(B.unevaluatedProperties)){let E=_8(`${new RegExp(q8(B))};`),T=`Object.getOwnPropertyNames(${D}).every(key => ${E}.test(key) || ${w0(B.unevaluatedProperties,F,`${D}[key]`)})`;yield`(${I} && ${T})`}else yield`(${I})`}function*G(B,F,D){yield`(typeof value === 'object' && Symbol.iterator in ${D})`}function*N(B,F,D){if(typeof B.const==="number"||typeof B.const==="boolean")yield`(${D} === ${B.const})`;else yield`(${D} === '${M5.Escape(B.const)}')`}function*O(B,F,D){yield"false"}function*m(B,F,D){yield`(!${w0(B.not,F,D)})`}function*P(B,F,D){yield`(${D} === null)`}function*b(B,F,D){if(yield N4.IsNumberLike(D),c(B.exclusiveMaximum))yield`${D} < ${B.exclusiveMaximum}`;if(c(B.exclusiveMinimum))yield`${D} > ${B.exclusiveMinimum}`;if(c(B.maximum))yield`${D} <= ${B.maximum}`;if(c(B.minimum))yield`${D} >= ${B.minimum}`;if(c(B.multipleOf))yield`(${D} % ${B.multipleOf}) === 0`}function*l(B,F,D){if(yield N4.IsObjectLike(D),c(B.minProperties))yield`Object.getOwnPropertyNames(${D}).length >= ${B.minProperties}`;if(c(B.maxProperties))yield`Object.getOwnPropertyNames(${D}).length <= ${B.maxProperties}`;let I=Object.getOwnPropertyNames(B.properties);for(let E of I){let T=qY.Encode(D,E),u=B.properties[E];if(B.required&&B.required.includes(E)){if(yield*C8(u,F,T),G8(u)||Z(u))yield`('${E}' in ${D})`}else{let C1=w0(u,F,T);yield N4.IsExactOptionalProperty(D,E,C1)}}if(B.additionalProperties===!1)if(B.required&&B.required.length===I.length)yield`Object.getOwnPropertyNames(${D}).length === ${I.length}`;else{let E=`[${I.map((T)=>`'${T}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${D}).every(key => ${E}.includes(key))`}if(typeof B.additionalProperties==="object"){let E=w0(B.additionalProperties,F,`${D}[key]`),T=`[${I.map((u)=>`'${u}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${D}).every(key => ${T}.includes(key) || ${E}))`}}function*t(B,F,D){yield`${D} instanceof Promise`}function*k(B,F,D){if(yield N4.IsRecordLike(D),c(B.minProperties))yield`Object.getOwnPropertyNames(${D}).length >= ${B.minProperties}`;if(c(B.maxProperties))yield`Object.getOwnPropertyNames(${D}).length <= ${B.maxProperties}`;let[I,E]=Object.entries(B.patternProperties)[0],T=_8(`${new RegExp(I)}`),u=w0(E,F,"value"),C1=f1(B.additionalProperties)?w0(B.additionalProperties,F,D):B.additionalProperties===!1?"false":"true",H0=`(${T}.test(key) ? ${u} : ${C1})`;yield`(Object.entries(${D}).every(([key, value]) => ${H0}))`}function*x(B,F,D){let I=M1(B,F);if(a1.functions.has(B.$ref))return yield`${d6(B.$ref)}(${D})`;yield*C8(I,F,D)}function*v(B,F,D){let I=_8(`${new RegExp(B.source,B.flags)};`);if(yield`(typeof ${D} === 'string')`,c(B.maxLength))yield`${D}.length <= ${B.maxLength}`;if(c(B.minLength))yield`${D}.length >= ${B.minLength}`;yield`${I}.test(${D})`}function*_(B,F,D){if(yield`(typeof ${D} === 'string')`,c(B.maxLength))yield`${D}.length <= ${B.maxLength}`;if(c(B.minLength))yield`${D}.length >= ${B.minLength}`;if(B.pattern!==void 0)yield`${_8(`${new RegExp(B.pattern)};`)}.test(${D})`;if(B.format!==void 0)yield`format('${B.format}', ${D})`}function*p(B,F,D){yield`(typeof ${D} === 'symbol')`}function*$1(B,F,D){yield`(typeof ${D} === 'string')`,yield`${_8(`${new RegExp(B.pattern)};`)}.test(${D})`}function*S1(B,F,D){yield`${d6(B.$ref)}(${D})`}function*q1(B,F,D){if(yield`Array.isArray(${D})`,B.items===void 0)return yield`${D}.length === 0`;yield`(${D}.length === ${B.maxItems})`;for(let I=0;I<B.items.length;I++)yield`${w0(B.items[I],F,`${D}[${I}]`)}`}function*A6(B,F,D){yield`${D} === undefined`}function*L1(B,F,D){yield`(${B.anyOf.map((E)=>w0(E,F,D)).join(" || ")})`}function*X4(B,F,D){if(yield`${D} instanceof Uint8Array`,c(B.maxByteLength))yield`(${D}.length <= ${B.maxByteLength})`;if(c(B.minByteLength))yield`(${D}.length >= ${B.minByteLength})`}function*RZ(B,F,D){yield"true"}function*E4(B,F,D){yield N4.IsVoidLike(D)}function*j9(B,F,D){let I=a1.instances.size;a1.instances.set(I,B),yield`kind('${B[L]}', ${I}, ${D})`}function*C8(B,F,D,I=!0){let E=J1(B.$id)?[...F,B]:F,T=B;if(I&&J1(B.$id)){let u=d6(B.$id);if(a1.functions.has(u))return yield`${u}(${D})`;else{a1.functions.set(u,"<deferred>");let C1=e6(u,B,F,"value",!1);return a1.functions.set(u,C1),yield`${u}(${D})`}}switch(T[L]){case"Any":return yield*Y(T,E,D);case"Argument":return yield*Q(T,E,D);case"Array":return yield*W(T,E,D);case"AsyncIterator":return yield*X(T,E,D);case"BigInt":return yield*J(T,E,D);case"Boolean":return yield*z(T,E,D);case"Constructor":return yield*U(T,E,D);case"Date":return yield*S(T,E,D);case"Function":return yield*q(T,E,D);case"Import":return yield*M(T,E,D);case"Integer":return yield*H(T,E,D);case"Intersect":return yield*w(T,E,D);case"Iterator":return yield*G(T,E,D);case"Literal":return yield*N(T,E,D);case"Never":return yield*O(T,E,D);case"Not":return yield*m(T,E,D);case"Null":return yield*P(T,E,D);case"Number":return yield*b(T,E,D);case"Object":return yield*l(T,E,D);case"Promise":return yield*t(T,E,D);case"Record":return yield*k(T,E,D);case"Ref":return yield*x(T,E,D);case"RegExp":return yield*v(T,E,D);case"String":return yield*_(T,E,D);case"Symbol":return yield*p(T,E,D);case"TemplateLiteral":return yield*$1(T,E,D);case"This":return yield*S1(T,E,D);case"Tuple":return yield*q1(T,E,D);case"Undefined":return yield*A6(T,E,D);case"Union":return yield*L1(T,E,D);case"Uint8Array":return yield*X4(T,E,D);case"Unknown":return yield*RZ(T,E,D);case"Void":return yield*E4(T,E,D);default:if(!Y0.Has(T[L]))throw new WJ(B);return yield*j9(T,E,D)}}let a1={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function w0(B,F,D,I=!0){return`(${[...C8(B,F,D,I)].join(" && ")})`}function d6(B){return`check_${G5.Encode(B)}`}function _8(B){let F=`local_${a1.variables.size}`;return a1.variables.set(F,`const ${F} = ${B}`),F}function e6(B,F,D,I,E=!0){let[T,u]=[`
`,(n0)=>"".padStart(n0," ")],C1=V8("value","any"),H0=jZ("boolean"),S0=[...C8(F,D,I,E)].map((n0)=>`${u(4)}${n0}`).join(` &&${T}`);return`function ${B}(${C1})${H0} {${T}${u(2)}return (${T}${S0}${T}${u(2)})
}`}function V8(B,F){let D=a1.language==="typescript"?`: ${F}`:"";return`${B}${D}`}function jZ(B){return a1.language==="typescript"?`: ${B}`:""}function E8(B,F,D){let I=e6("check",B,F,"value"),E=V8("value","any"),T=jZ("boolean"),u=[...a1.functions.values()],C1=[...a1.variables.values()],H0=J1(B.$id)?`return function check(${E})${T} {
  return ${d6(B.$id)}(value)
}`:`return ${I}`;return[...C1,...u,H0].join(`
`)}function f(...B){let F={language:"javascript"},[D,I,E]=B.length===2&&o(B[1])?[B[0],B[1],F]:B.length===2&&!o(B[1])?[B[0],[],B[1]]:B.length===3?[B[0],B[1],B[2]]:B.length===1?[B[0],[],F]:[null,[],F];if(a1.language=E.language,a1.variables.clear(),a1.functions.clear(),a1.instances.clear(),!f1(D))throw new B5(D);for(let T of I)if(!f1(T))throw new B5(T);return E8(D,I,E)}$.Code=f;function V(B,F=[]){let D=f(B,F,{language:"javascript"}),I=globalThis.Function("kind","format","hash",D),E=new Map(a1.instances);function T(S0,n0,$8){if(!Y0.Has(S0)||!E.has(n0))return!1;let tM=Y0.Get(S0),sM=E.get(n0);return tM(sM,$8)}function u(S0,n0){if(!O1.Has(S0))return!1;return O1.Get(S0)(n0)}function C1(S0){return v8(S0)}let H0=I(T,u,C1);return new QJ(B,F,H0,D)}$.Compile=V})(l6||(l6={}));var bP=Object.create,{getPrototypeOf:xP,defineProperty:XJ,getOwnPropertyNames:kP}=Object,gP=Object.prototype.hasOwnProperty,VY=($,Z,Y)=>{Y=$!=null?bP(xP($)):{};let Q=Z||!$||!$.__esModule?XJ(Y,"default",{value:$,enumerable:!0}):Y;for(let W of kP($))if(!gP.call(Q,W))XJ(Q,W,{get:()=>$[W],enumerable:!0});return Q},gJ=($,Z)=>()=>(Z||$((Z={exports:{}}).exports,Z),Z.exports);var fP=gJ(($)=>{Object.defineProperty($,"__esModule",{value:!0}),$.parse=z,$.serialize=q;var Z=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Y=/^[\u0021-\u003A\u003C-\u007E]*$/,Q=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,W=/^[\u0020-\u003A\u003D-\u007E]*$/,X=Object.prototype.toString,J=(()=>{let w=function(){};return w.prototype=Object.create(null),w})();function z(w,G){let N=new J,O=w.length;if(O<2)return N;let m=G?.decode||M,P=0;do{let b=w.indexOf("=",P);if(b===-1)break;let l=w.indexOf(";",P),t=l===-1?O:l;if(b>t){P=w.lastIndexOf(";",b-1)+1;continue}let k=U(w,P,b),x=S(w,b,k),v=w.slice(k,x);if(N[v]===void 0){let _=U(w,b+1,t),p=S(w,t,_),$1=m(w.slice(_,p));N[v]=$1}P=t+1}while(P<O);return N}function U(w,G,N){do{let O=w.charCodeAt(G);if(O!==32&&O!==9)return G}while(++G<N);return N}function S(w,G,N){while(G>N){let O=w.charCodeAt(--G);if(O!==32&&O!==9)return G+1}return N}function q(w,G,N){let O=N?.encode||encodeURIComponent;if(!Z.test(w))throw new TypeError(`argument name is invalid: ${w}`);let m=O(G);if(!Y.test(m))throw new TypeError(`argument val is invalid: ${G}`);let P=w+"="+m;if(!N)return P;if(N.maxAge!==void 0){if(!Number.isInteger(N.maxAge))throw new TypeError(`option maxAge is invalid: ${N.maxAge}`);P+="; Max-Age="+N.maxAge}if(N.domain){if(!Q.test(N.domain))throw new TypeError(`option domain is invalid: ${N.domain}`);P+="; Domain="+N.domain}if(N.path){if(!W.test(N.path))throw new TypeError(`option path is invalid: ${N.path}`);P+="; Path="+N.path}if(N.expires){if(!H(N.expires)||!Number.isFinite(N.expires.valueOf()))throw new TypeError(`option expires is invalid: ${N.expires}`);P+="; Expires="+N.expires.toUTCString()}if(N.httpOnly)P+="; HttpOnly";if(N.secure)P+="; Secure";if(N.partitioned)P+="; Partitioned";if(N.priority)switch(typeof N.priority==="string"?N.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${N.priority}`)}if(N.sameSite)switch(typeof N.sameSite==="string"?N.sameSite.toLowerCase():N.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${N.sameSite}`)}return P}function M(w){if(w.indexOf("%")===-1)return w;try{return decodeURIComponent(w)}catch(G){return w}}function H(w){return X.call(w)==="[object Date]"}}),I5=gJ(($,Z)=>{var Y=12,Q=0,W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7];function X(U){var S=U.indexOf("%");if(S===-1)return U;var q=U.length,M="",H=0,w=0,G=S,N=Y;while(S>-1&&S<q){var O=z(U[S+1],4),m=z(U[S+2],0),P=O|m,b=W[P];if(N=W[256+N+b],w=w<<6|P&W[364+b],N===Y)M+=U.slice(H,G),M+=w<=65535?String.fromCharCode(w):String.fromCharCode(55232+(w>>10),56320+(w&1023)),w=0,H=S+3,S=G=U.indexOf("%",H);else if(N===Q)return null;else{if(S+=3,S<q&&U.charCodeAt(S)===37)continue;return null}}return M+U.slice(H)}var J={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};function z(U,S){var q=J[U];return q===void 0?255:q<<S}Z.exports=X}),Z$=($,Z)=>{let Y=Z?.length?{}:null;if(Y)for(let Q of Z)Y[Q.part.charCodeAt(0)]=Q;return{part:$,store:null,inert:Y,params:null,wildcardStore:null}},JJ=($,Z)=>({...$,part:Z}),zJ=($)=>({name:$,store:null,inert:null});class X${config;root={};history=[];deferred=[];constructor($={}){if(this.config=$,$.lazy)this.find=this.lazyFind}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/:.+?\?(?=\/|$)/g};lazyFind=($,Z)=>{if(!this.config.lazy)return this.find;return this.build(),this.find($,Z)};build(){if(!this.config.lazy)return;for(let[$,Z,Y]of this.deferred)this.add($,Z,Y,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=($,Z)=>{let Y=this.root[$];if(!Y)return null;return DY(Z,Z.length,Y,0)}}add($,Z,Y,{ignoreError:Q=!1,ignoreHistory:W=!1,lazy:X=this.config.lazy}={}){if(X)return this.find=this.lazyFind,this.deferred.push([$,Z,Y]),Y;if(typeof Z!=="string")throw new TypeError("Route path must be a string");if(Z==="")Z="/";else if(Z[0]!=="/")Z=`/${Z}`;let J=Z[Z.length-1]==="*",z=Z.match(X$.regex.optionalParams);if(z){let H=Z.replaceAll("?","");this.add($,H,Y,{ignoreError:Q,ignoreHistory:W,lazy:X});for(let w=0;w<z.length;w++){let G=Z.replace("/"+z[w],"");this.add($,G,Y,{ignoreError:!0,ignoreHistory:W,lazy:X})}return Y}if(z)Z=Z.replaceAll("?","");if(this.history.find(([H,w,G])=>H===$&&w===Z))return Y;if(J||z&&Z.charCodeAt(Z.length-1)===63)Z=Z.slice(0,-1);if(!W)this.history.push([$,Z,Y]);let U=Z.split(X$.regex.static),S=Z.match(X$.regex.params)||[];if(U[U.length-1]==="")U.pop();let q;if(!this.root[$])q=this.root[$]=Z$("/");else q=this.root[$];let M=0;for(let H=0;H<U.length;++H){let w=U[H];if(H>0){let G=S[M++].slice(1);if(q.params===null)q.params=zJ(G);else if(q.params.name!==G)if(Q)return Y;else throw new Error(`Cannot create route "${Z}" with parameter "${G}" because a route already exists with a different parameter name ("${q.params.name}") in the same location`);let N=q.params;if(N.inert===null){q=N.inert=Z$(w);continue}q=N.inert}for(let G=0;;){if(G===w.length){if(G<q.part.length){let N=JJ(q,q.part.slice(G));Object.assign(q,Z$(w,[N]))}break}if(G===q.part.length){if(q.inert===null)q.inert={};let N=q.inert[w.charCodeAt(G)];if(N){q=N,w=w.slice(G),G=0;continue}let O=Z$(w.slice(G));q.inert[w.charCodeAt(G)]=O,q=O;break}if(w[G]!==q.part[G]){let N=JJ(q,q.part.slice(G)),O=Z$(w.slice(G));Object.assign(q,Z$(q.part.slice(0,G),[N,O])),q=O;break}++G}}if(M<S.length){let H=S[M].slice(1);if(q.params===null)q.params=zJ(H);else if(q.params.name!==H)if(Q)return Y;else throw new Error(`Cannot create route "${Z}" with parameter "${H}" because a route already exists with a different parameter name ("${q.params.name}") in the same location`);if(q.params.store===null)q.params.store=Y;return q.params.store}if(J){if(q.wildcardStore===null)q.wildcardStore=Y;return q.wildcardStore}if(q.store===null)q.store=Y;return q.store}find($,Z){let Y=this.root[$];if(!Y)return null;return DY(Z,Z.length,Y,0)}}var DY=($,Z,Y,Q)=>{let W=Y.part,X=W.length,J=Q+X;if(X>1){if(J>Z)return null;if(X<15){for(let z=1,U=Q+1;z<X;++z,++U)if(W.charCodeAt(z)!==$.charCodeAt(U))return null}else if($.slice(Q,J)!==W)return null}if(J===Z){if(Y.store!==null)return{store:Y.store,params:{}};if(Y.wildcardStore!==null)return{store:Y.wildcardStore,params:{"*":""}};return null}if(Y.inert!==null){let z=Y.inert[$.charCodeAt(J)];if(z!==void 0){let U=DY($,Z,z,J);if(U!==null)return U}}if(Y.params!==null){let{store:z,name:U,inert:S}=Y.params,q=$.indexOf("/",J);if(q!==J){if(q===-1||q>=Z){if(z!==null){let M={};return M[U]=$.substring(J,Z),{store:z,params:M}}}else if(S!==null){let M=DY($,Z,S,q);if(M!==null)return M.params[U]=$.substring(J,q),M}}}if(Y.wildcardStore!==null)return{store:Y.wildcardStore,params:{"*":$.substring(J,Z)}};return null},T5={date:fJ,time:K5(!0),"date-time":UJ(!0),"iso-time":K5(!1),"iso-date-time":UJ(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:pP,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:rP,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:iP,int32:{type:"number",validate:oP},int64:{type:"number",validate:tP},float:{type:"number",validate:qJ},double:{type:"number",validate:qJ},password:!0,binary:!0};function yP($){return $%4===0&&($%100!==0||$%400===0)}var vP=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,dP=[0,31,28,31,30,31,30,31,31,30,31,30,31];function fJ($){let Z=vP.exec($);if(!Z)return!1;let Y=+Z[1],Q=+Z[2],W=+Z[3];return Q>=1&&Q<=12&&W>=1&&W<=(Q===2&&yP(Y)?29:dP[Q])}var hP=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function K5($){return function Z(Y){let Q=hP.exec(Y);if(!Q)return!1;let W=+Q[1],X=+Q[2],J=+Q[3],z=Q[4],U=Q[5]==="-"?-1:1,S=+(Q[6]||0),q=+(Q[7]||0);if(S>23||q>59||$&&!z)return!1;if(W<=23&&X<=59&&J<60)return!0;let M=X-q*U,H=W-S*U-(M<0?1:0);return(H===23||H===-1)&&(M===59||M===-1)&&J<61}}var yJ=($)=>{if($.charCodeAt($.length-6)===32)return $.slice(0,-6)+"+"+$.slice(-5);return $},mP=/t|\s/i;function UJ($){let Z=K5($);return function Y(Q){let W=Q.split(mP);return W.length===2&&fJ(W[0])&&Z(W[1])}}var uP=/\/|:/,cP=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function pP($){return uP.test($)&&cP.test($)}var SJ=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function iP($){return SJ.lastIndex=0,SJ.test($)}var lP=-2147483648,nP=2147483647;function oP($){return Number.isInteger($)&&$<=nP&&$>=lP}function tP($){return Number.isInteger($)}function qJ(){return!0}var sP=/[^\\]\\Z/;function rP($){if(sP.test($))return!1;try{return new RegExp($),!0}catch(Z){return!1}}var vJ=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,dJ=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,hJ=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,aP=T5.date,eP=T5["date-time"];if(!O1.Has("date"))O1.Set("date",($)=>{let Z=yJ($).replace(/"/g,"");if(vJ.test(Z)||dJ.test(Z)||hJ.test(Z)||aP(Z)){let Y=new Date(Z);if(!Number.isNaN(Y.getTime()))return!0}return!1});if(!O1.Has("date-time"))O1.Set("date-time",($)=>{let Z=$.replace(/"/g,"");if(vJ.test(Z)||dJ.test(Z)||hJ.test(Z)||eP(Z)){let Y=new Date(Z);if(!Number.isNaN(Y.getTime()))return!0}return!1});Object.entries(T5).forEach(($)=>{let[Z,Y]=$;if(!O1.Has(Z)){if(Y instanceof RegExp)O1.Set(Z,(Q)=>Y.test(Q));else if(typeof Y==="function")O1.Set(Z,Y)}});if(!O1.Has("numeric"))O1.Set("numeric",($)=>!!$&&!isNaN(+$));if(!O1.Has("integer"))O1.Set("integer",($)=>!!$&&Number.isInteger(+$));if(!O1.Has("boolean"))O1.Set("boolean",($)=>$==="true"||$==="false");if(!O1.Has("ObjectString"))O1.Set("ObjectString",($)=>{let Z=$.charCodeAt(0);if(Z===9||Z===10||Z===32)Z=$.trimStart().charCodeAt(0);if(Z!==123&&Z!==91)return!1;try{return JSON.parse($),!0}catch{return!1}});if(!O1.Has("ArrayString"))O1.Set("ArrayString",($)=>{let Z=$.charCodeAt(0);if(Z===9||Z===10||Z===32)Z=$.trimStart().charCodeAt(0);if(Z!==123&&Z!==91)return!1;try{return JSON.parse($),!0}catch{return!1}});var J$=typeof Bun!=="undefined",$K={aac:"audio/aac",abw:"application/x-abiword",ai:"application/postscript",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",dll:"application/octet-stream",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi",midi:"audio/midi",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpa:"video/mpeg",mpe:"video/mpeg",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/x-wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",xlsx_OLD:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3gp_DOES_NOT_CONTAIN_VIDEO":"audio/3gpp","3gp2":"video/3gpp2","3gp2_DOES_NOT_CONTAIN_VIDEO":"audio/3gpp2","7z":"application/x-7z-compressed"},ZK=($)=>{let Z=$.lastIndexOf(".");if(Z===-1)return"";return $.slice(Z+1)};var w5,H5;class AY{path;value;stats;constructor($){if(this.path=$,J$)this.value=Bun.file($);else if(typeof window!=="undefined")console.warn("Browser environment does not support file");else if(!w5||!H5)try{this.value=import("fs").then((Z)=>{return w5=Z.createReadStream,Z.createReadStream($)}),this.stats=import("fs/promises").then((Z)=>{return H5=Z.stat,Z.stat($)})}catch{}else this.value=w5($),this.stats=H5($)}get type(){return $K[ZK(this.path)]||"application/octet-stream"}get length(){if(J$)return this.value.size;return this.stats?.then(($)=>$.size)??0}}var NY="toJSON"in new Headers,GJ=($,Z)=>{let Y=new URL($);return Y.pathname=Z,Y.toString()},YK=($)=>typeof $==="function"&&/^\s*class\s+/.test($.toString())||$.toString&&$.toString().startsWith("[object ")&&$.toString()!=="[object Object]"||T1(Object.getPrototypeOf($)),D5=($)=>$&&typeof $==="object"&&!Array.isArray($),m0=($,Z,Y)=>{let Q=Y?.skipKeys,W=Y?.override??!0;if(!D5($)||!D5(Z))return $;for(let[X,J]of Object.entries(Z)){if(Q?.includes(X))continue;if(!D5(J)||!(X in $)||YK(J)){if(W||!(X in $))$[X]=J;continue}$[X]=m0($[X],J,{skipKeys:Q,override:W})}return $},mJ=($,Z)=>{let Y=m0(Object.assign({},$),Z,{skipKeys:["properties"]});if(Y.properties)delete Y.properties;return Y},c1=($,Z)=>{if(!Z)return $;let Y=[],Q=[];if($){if(!Array.isArray($))$=[$];for(let W of $)if(Y.push(W),W.checksum)Q.push(W.checksum)}if(Z){if(!Array.isArray(Z))Z=[Z];for(let W of Z)if(!Q.includes(W.checksum))Y.push(W)}return Y},QK=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],WK=QK.reduce(($,Z)=>($[Z]=!0,$),{}),uJ=($,Z)=>{let Y=(Q)=>typeof Q==="object"&&Object.keys(Q).every(b5);if(Y($)&&Y(Z))return Object.assign($,Z);else if($&&!Y($)&&Y(Z))return Object.assign({200:$},Z);return Z??$},h$=($,Z)=>{return{body:Z?.body??$?.body,headers:Z?.headers??$?.headers,params:Z?.params??$?.params,query:Z?.query??$?.query,cookie:Z?.cookie??$?.cookie,response:uJ($?.response,Z?.response)}},A8=($,Z)=>{if(!Object.values(Z).find((Q)=>Q!==void 0&&Q!==null))return{...$};let Y={...$,...Z,body:Z?.body??$?.body,headers:Z?.headers??$?.headers,params:Z?.params??$?.params,query:Z?.query??$?.query,cookie:Z?.cookie??$?.cookie,response:uJ($?.response,Z?.response),type:$?.type||Z?.type,detail:m0(Z?.detail??{},$?.detail??{}),parse:c1($?.parse,Z?.parse),transform:c1($?.transform,Z?.transform),beforeHandle:c1(c1(W0($?.resolve,"resolve"),$?.beforeHandle),c1(W0(Z.resolve,"resolve"),Z?.beforeHandle)),afterHandle:c1($?.afterHandle,Z?.afterHandle),mapResponse:c1($?.mapResponse,Z?.mapResponse),afterResponse:c1($?.afterResponse,Z?.afterResponse),trace:c1($?.trace,Z?.trace),error:c1($?.error,Z?.error)};if(Y.resolve)delete Y.resolve;return Y},XK=($)=>{if($.parse&&!Array.isArray($.parse))$.parse=[$.parse];if($.transform&&!Array.isArray($.transform))$.transform=[$.transform];if($.afterHandle&&!Array.isArray($.afterHandle))$.afterHandle=[$.afterHandle];if($.mapResponse&&!Array.isArray($.mapResponse))$.mapResponse=[$.mapResponse];if($.afterResponse&&!Array.isArray($.afterResponse))$.afterResponse=[$.afterResponse];if($.trace&&!Array.isArray($.trace))$.trace=[$.trace];if($.error&&!Array.isArray($.error))$.error=[$.error];let Z=[];if($.resolve)Z=W0(Array.isArray($.resolve)?$.resolve:[$.resolve],"resolve"),delete $.resolve;if($.beforeHandle)if(Z.length)Z=Z.concat(Array.isArray($.beforeHandle)?$.beforeHandle:[$.beforeHandle]);else Z=Array.isArray($.beforeHandle)?$.beforeHandle:[$.beforeHandle];if(Z.length)$.beforeHandle=Z;return $},JK=typeof Bun!=="undefined",sn=JK&&typeof Bun.hash==="function",Q$=($)=>{let Z=9;for(let Y=0;Y<$.length;)Z=Math.imul(Z^$.charCodeAt(Y++),387420489);return Z=Z^Z>>>9},x6=($,Z)=>{if(!Z)return;if(!Array.isArray(Z)){let Q=Z;if($&&!Q.checksum)Q.checksum=$;if(Q.scope==="scoped")Q.scope="local";return Q}let Y=[...Z];for(let Q of Y){if($&&!Q.checksum)Q.checksum=$;if(Q.scope==="scoped")Q.scope="local"}return Y},MJ=($,Z,Y)=>{return{start:c1($.start,x6(Y,Z?.start)),request:c1($.request,x6(Y,Z?.request)),parse:c1($.parse,x6(Y,Z?.parse)),transform:c1($.transform,x6(Y,Z?.transform)),beforeHandle:c1(c1(W0($.resolve,"resolve"),$.beforeHandle),x6(Y,c1(W0(Z?.resolve,"resolve"),Z?.beforeHandle))),afterHandle:c1($.afterHandle,x6(Y,Z?.afterHandle)),mapResponse:c1($.mapResponse,x6(Y,Z?.mapResponse)),afterResponse:c1($.afterResponse,x6(Y,Z?.afterResponse)),trace:c1($.trace,x6(Y,Z?.trace)),error:c1($.error,x6(Y,Z?.error)),stop:c1($.stop,x6(Y,Z?.stop))}},zK=($,Z,{skipIfHasType:Y=!1})=>{if(!$)return $;if(!Array.isArray($)){if(Y)$.scope??=Z;else $.scope=Z;return $}for(let Q of $)if(Y)Q.scope??=Z;else Q.scope=Z;return $},d8=($)=>{if(!$)return $;if(!Array.isArray($))switch($.scope){case"global":case"scoped":return{...$};default:return{fn:$}}let Z=[];for(let Y of $)switch(Y.scope){case"global":case"scoped":Z.push({...Y});break}return Z},BJ=($)=>{return{...$,type:$?.type,detail:$?.detail,parse:d8($?.parse),transform:d8($?.transform),beforeHandle:d8($?.beforeHandle),afterHandle:d8($?.afterHandle),mapResponse:d8($?.mapResponse),afterResponse:d8($?.afterResponse),error:d8($?.error),trace:d8($?.trace)}},EY={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},wJ=Object.fromEntries(Object.entries(EY).map(([$,Z])=>[Z,$]));function UK($){let Z=$;while(Z.endsWith("="))Z=Z.slice(0,-1);return Z}var HJ=new TextEncoder,LY=async($,Z)=>{if(typeof $!=="string")throw new TypeError("Cookie value must be provided as a string.");if(Z===null)throw new TypeError("Secret key must be provided.");let Y=await crypto.subtle.importKey("raw",HJ.encode(Z),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Q=await crypto.subtle.sign("HMAC",Y,HJ.encode($));return $+"."+UK(Buffer.from(Q).toString("base64"))},DJ=async($,Z)=>{if(typeof $!=="string")throw new TypeError("Signed cookie string must be provided.");if(Z===null)throw new TypeError("Secret key must be provided.");let Y=$.slice(0,$.lastIndexOf("."));return await LY(Y,Z)===$?Y:!1},SK=($,Z,Y)=>{if(!$||typeof $!=="object"||!Z)return;for(let[Q,W]of Object.entries(Z)){if(WK[Q]||!(Q in $))continue;let X=$[Q];if(typeof X==="function"){let J=X(W);if(typeof J==="object")for(let[z,U]of Object.entries(J))Y(z)({fn:U})}delete Z[Q]}},qK=({globalHook:$,localHook:Z})=>(Y)=>(Q,W)=>{if(typeof Q==="function")Q={fn:Q};if(Y==="resolve")Q={...Q,subType:"resolve"};if(!Z[Y])Z[Y]=[];if(typeof Z[Y]==="function")Z[Y]=[Z[Y]];if(!Array.isArray(Z[Y]))Z[Y]=[Z[Y]];if("fn"in Q||Array.isArray(Q)){if(Array.isArray(Q))Z[Y]=Z[Y].concat(Q);else Z[Y].push(Q);return}let{insert:X="after",stack:J="local"}=Q;if(typeof W==="function")W={fn:W};if(J==="global")if(!Array.isArray(W))if(X==="before")$[Y].unshift(W);else $[Y].push(W);else if(X==="before")$[Y]=W.concat($[Y]);else $[Y]=$[Y].concat(W);else if(!Array.isArray(W))if(X==="before")Z[Y].unshift(W);else Z[Y].push(W);else if(X==="before")Z[Y]=W.concat(Z[Y]);else Z[Y]=Z[Y].concat(W)},GK=($)=>{if(typeof $==="number")return $;if($.length<16){if($.trim().length===0)return null;let Z=Number($);if(Number.isNaN(Z))return null;return Z}if($.length===16){if($.trim().length===0)return null;let Z=Number($);if(Number.isNaN(Z)||Z.toString()!==$)return null;return Z}return null},b5=($)=>GK($)!==null;class cJ{onError;onFinally;root=null;promises=[];constructor($=console.error,Z=()=>{}){this.onError=$,this.onFinally=Z}get size(){return this.promises.length}add($){if(this.promises.push($),this.root||=this.drain(),this.promises.length===1)this.then(this.onFinally);return $}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch($){this.onError($)}this.promises.shift()}this.root=null}then($,Z){return(this.root??Promise.resolve()).then($,Z)}}var W0=($,Z)=>{if(!$)return $;if(!Array.isArray($)){if(typeof $==="function"||typeof $==="string")return Z?{fn:$,subType:Z}:{fn:$};else if("fn"in $)return $}let Y=[];for(let Q of $)if(typeof Q==="function"||typeof Q==="string")Y.push(Z?{fn:Q,subType:Z}:{fn:Q});else if("fn"in Q)Y.push(Q);return Y},AJ=($)=>{if($.start)$.start=W0($.start);if($.request)$.request=W0($.request);if($.parse)$.parse=W0($.parse);if($.transform)$.transform=W0($.transform);if($.beforeHandle)$.beforeHandle=W0($.beforeHandle);if($.afterHandle)$.afterHandle=W0($.afterHandle);if($.mapResponse)$.mapResponse=W0($.mapResponse);if($.afterResponse)$.afterResponse=W0($.afterResponse);if($.trace)$.trace=W0($.trace);if($.error)$.error=W0($.error);if($.stop)$.stop=W0($.stop);return $},NJ=($)=>{if($.start?.map)$.start=$.start.map((Z)=>Z.fn);if($.request?.map)$.request=$.request.map((Z)=>Z.fn);if($.parse?.map)$.parse=$.parse.map((Z)=>Z.fn);if($.transform?.map)$.transform=$.transform.map((Z)=>Z.fn);if($.beforeHandle?.map)$.beforeHandle=$.beforeHandle.map((Z)=>Z.fn);if($.afterHandle?.map)$.afterHandle=$.afterHandle.map((Z)=>Z.fn);if($.mapResponse?.map)$.mapResponse=$.mapResponse.map((Z)=>Z.fn);if($.afterResponse?.map)$.afterResponse=$.afterResponse.map((Z)=>Z.fn);if($.trace?.map)$.trace=$.trace.map((Z)=>Z.fn);else $.trace=[];if($.error?.map)$.error=$.error.map((Z)=>Z.fn);if($.stop?.map)$.stop=$.stop.map((Z)=>Z.fn);return $},LJ=($)=>({body:$.body,cookie:$.cookie,headers:$.headers,query:$.query,set:$.set,server:$.server,path:$.path,route:$.route,url:$.url}),x5=($,Z=302)=>Response.redirect($,Z),F4=Symbol("ElysiaFormData"),a$=Symbol("ElysiaRequestId"),MK=($)=>{let Z=new FormData;if(Z[F4]={},$)for(let[Y,Q]of Object.entries($)){if(Array.isArray(Q)){Z[F4][Y]=[];for(let W of Q){if(Q instanceof File)Z.append(Y,Q,Q.name);else if(Q instanceof AY)Z.append(Y,Q.value,Q.value?.name);else Z.append(Y,Q);Z[F4][Y].push(Q)}continue}if(Q instanceof File)Z.append(Y,Q,Q.name);else if(Q instanceof AY)Z.append(Y,Q.value,Q.value?.name);else Z.append(Y,Q);Z[F4][Y]=Q}return Z},IY=()=>{let $=crypto.randomUUID();return $.slice(0,8)+$.slice(24,32)},OJ=($)=>{let Z=[];for(let Y=0;Y<$.length;Y++){let Q=$[Y];if(Q.checksum){if(Z.includes(Q.checksum))$.splice(Y,1),Y--;Z.push(Q.checksum)}}return $},h8=($,Z="scoped")=>{if(!$)return;if(Z==="scoped"){for(let Y of $)if("scope"in Y&&Y.scope==="local")Y.scope="scoped";return}for(let Y of $)if("scope"in Y)Y.scope="global"},u$=($)=>{if($.charCodeAt($.length-1)===47)return $.slice(0,$.length-1);return $+"/"},T1=($)=>{if(!$)return!1;for(let Z in $)return!0;return!1},c$=($,{dynamic:Z=!1}={})=>{let Y=encodeURIComponent($).replace(/%2F/g,"/");if(Z)Y=Y.replace(/%3A/g,":").replace(/%3F/g,"?");return Y},pJ=(()=>{if(typeof Bun==="undefined")return!0;let $=Bun.version.split(".");if(+$[0]<1||+$[1]<2||+$[2]<14)return!1;return!0})(),FJ=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,OY=Symbol("ElysiaErrorCode"),s$=(FJ?.NODE_ENV??FJ?.ENV)==="production";class V0{code;response;constructor($,Z){let Y=Z??($ in wJ?wJ[$]:$);this.code=EY[$]??$,this.response=Y}}var FY=($,Z)=>new V0($,Z);class k5 extends Error{code="NOT_FOUND";status=404;constructor($){super($??"NOT_FOUND")}}class iJ extends Error{code="PARSE";status=400;constructor($){super("Bad Request",{cause:$})}}class R5 extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor($,Z){super(Z??`"${$}" has invalid cookie signature`);this.key=$}}var g6=($)=>{if(!$)return{summary:void 0};let{message:Z,path:Y,value:Q,type:W}=$,X=Y.slice(1).replaceAll("/","."),J=Y==="";switch(W){case 42:return{...$,summary:J?"Value should not be provided":`Property '${X}' should not be provided`};case 45:return{...$,summary:J?"Value is missing":`Property '${X}' is missing`};case 50:let z=Z.indexOf("'"),U=Z.slice(z+1,Z.indexOf("'",z+1));return{...$,summary:J?"Value should be an email":`Property '${X}' should be ${U}`};case 54:return{...$,summary:`${Z.slice(0,9).trim()} property '${X}' to be ${Z.slice(8).trim()} but found: ${Q}`};case 62:let S=$.schema.anyOf.map((q)=>`'${q?.format??q.type}'`).join(", ");return{...$,summary:J?`Value should be one of ${S}`:`Property '${X}' should be one of: ${S}`};default:return{summary:Z,...$}}};class l$ extends Error{property;expected;message;code="INVALID_FILE_TYPE";status=422;constructor($,Z,Y=`"${$}" has invalid file type`){super(Y);this.property=$,this.expected=Z,this.message=Y,Object.setPrototypeOf(this,l$.prototype)}toResponse($){if(s$)return new Response(JSON.stringify({type:"validation",on:"body"}),{status:422,headers:{...$,"content-type":"application/json"}});return new Response(JSON.stringify({type:"validation",on:"body",summary:"Invalid file type",message:this.message,property:this.property,expected:this.expected}),{status:422,headers:{...$,"content-type":"application/json"}})}}class j1 extends Error{type;validator;value;code="VALIDATION";status=422;constructor($,Z,Y,Q){if(Y&&typeof Y==="object"&&Y instanceof V0)Y=Y.response;let W=Q?.First()||(s$?void 0:("Errors"in Z)?Z.Errors(Y).First():N1.Errors(Z,Y).First()),X=W?.schema?.message||W?.schema?.error!==void 0?typeof W.schema.error==="function"?W.schema.error({type:$,validator:Z,value:Y,get errors(){return[...Z.Errors(Y)].map(g6)}}):W.schema.error:void 0,J=W?.path||"root",z="";if(X!==void 0)z=typeof X==="object"?JSON.stringify(X):X+"";else if(s$)z=JSON.stringify({type:"validation",on:$,summary:g6(W).summary,message:W?.message,found:Y});else{let U=Z?.schema??Z,S="Errors"in Z?[...Z.Errors(Y)].map(g6):[...N1.Errors(Z,Y)].map(g6),q;try{q=N1.Create(U)}catch(M){q={type:"Could not create expected value",message:M?.message,error:M}}z=JSON.stringify({type:"validation",on:$,summary:g6(W).summary,property:J,message:W?.message,expected:q,found:Y,errors:S},null,2)}super(z);this.type=$,this.validator=Z,this.value=Y,Object.setPrototypeOf(this,j1.prototype)}get all(){return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(g6):[...N1.Errors(this.validator,this.value)].map(g6)}static simplifyModel($){let Z="schema"in $?$.schema:$;try{return N1.Create(Z)}catch{return Z}}get model(){return j1.simplifyModel(this.validator)}toResponse($){return new Response(this.message,{status:400,headers:{...$,"content-type":"application/json"}})}}var GY=($,Z)=>{try{return JSON.parse($)}catch{throw new j1("property",Z,$)}};function TY($,Z){if(!Y0.Has($))Y0.Set($,Z);return(Y={})=>eZ({...Y,[L]:$})}var L4=($)=>{try{let Z=l6.Compile($);return Z.Create=()=>N1.Create($),Z.Error=(Y)=>new j1("property",$,Y,Z.Errors(Y)),Z}catch{return{Check:(Z)=>N1.Check($,Z),CheckThrow:(Z)=>{if(!N1.Check($,Z))throw new j1("property",$,Z,N1.Errors($,Z))},Decode:(Z)=>N1.Decode($,Z),Create:()=>N1.Create($),Error:(Z)=>new j1("property",$,Z,N1.Errors($,Z))}}},PJ=($)=>{if(typeof $==="string")switch($.slice(-1)){case"k":return+$.slice(0,$.length-1)*1024;case"m":return+$.slice(0,$.length-1)*1048576;default:return+$}return $},PY=($,Z)=>{if($.startsWith(Z))return!0;return Z.charCodeAt(Z.length-1)===42&&Z.charCodeAt(Z.length-2)===47&&$.startsWith(Z.slice(0,-1))},KJ=!1,BK=()=>{if(!KJ)console.warn("[Elysia] Attempt to validate file type without 'file-type'. This may lead to security risks. We recommend installing 'file-type' to properly validate file extension."),KJ=!0},g5=async()=>import("./index-1zqm8mks.js").then(($)=>{return KY=$.fileTypeFromBlob,KY}).catch(BK),KY,wK=($)=>{if(KY)return KY($);return g5().then((Z)=>{if(Z)return Z($)})},HK=async($,Z,Y=$?.name??"")=>{if(!$)return;let Q=await wK($);if(!Q)throw new l$(Y,Z);if(typeof Z==="string"){if(!PY(Q.mime,Z))throw new l$(Y,Z)}for(let W=0;W<Z.length;W++)if(PY(Q.mime,Z[W]))return!0;throw new l$(Y,Z)},j5=($,Z)=>{if(Z instanceof AY)return!0;if(!(Z instanceof Blob))return!1;if($.minSize&&Z.size<PJ($.minSize))return!1;if($.maxSize&&Z.size>PJ($.maxSize))return!1;if($.extension){if(typeof $.extension==="string")return PY(Z.type,$.extension);for(let Y=0;Y<$.extension.length;Y++)if(PY(Z.type,$.extension[Y]))return!0;return!1}return!0},g=Object.assign({},M8);TY("UnionEnum",($,Z)=>(typeof Z==="number"||typeof Z==="string"||Z===null)&&$.enum.includes(Z));var DK=TY("Files",($,Z)=>{if(!Array.isArray(Z))return j5($,Z);if($.minItems&&Z.length<$.minItems)return!1;if($.maxItems&&Z.length>$.maxItems)return!1;for(let Y=0;Y<Z.length;Y++)if(!j5($,Z[Y]))return!1;return!0}),AK=TY("ElysiaForm",({compiler:$,...Z},Y)=>{if(!(Y instanceof FormData))return!1;if($){if(!(F4 in Y))throw new j1("property",Z,Y);if(!$.Check(Y[F4]))throw $.Error(Y[F4])}return!0}),i0={String:($)=>M8.String($),Numeric:($)=>{let Z=M8.Number($),Y=L4(Z);return g.Transform(g.Union([g.String({format:"numeric",default:0}),g.Number($)],$)).Decode((Q)=>{let W=+Q;if(isNaN(W))return Q;if($&&!Y.Check(W))throw Y.Error(Q);return W}).Encode((Q)=>Q)},Integer:($)=>{let Z=M8.Integer($),Y=L4(Z);return g.Transform(g.Union([g.String({format:"integer",default:0}),M8.Integer($)],$)).Decode((Q)=>{let W=+Q;if(!Y.Check(W))throw Y.Error(W);return W}).Encode((Q)=>Q)},Date:($)=>{let Z=M8.Date($),Y=L4(Z),Q=$?.default?new Date($.default):void 0;return g.Transform(g.Union([M8.Date($),g.String({format:"date-time",default:Q?.toISOString()}),g.String({format:"date",default:Q?.toISOString()}),g.Number({default:Q?.getTime()})],$)).Decode((W)=>{if(typeof W==="number"){let J=new Date(W);if(!Y.Check(J))throw Y.Error(J);return J}if(W instanceof Date)return W;let X=new Date(yJ(W));if(!X||isNaN(X.getTime()))throw new j1("property",Z,X);if(!Y.Check(X))throw Y.Error(X);return X}).Encode((W)=>W.toISOString())},BooleanString:($)=>{let Z=M8.Boolean($),Y=L4(Z);return g.Transform(g.Union([g.Boolean($),g.String({format:"boolean",default:!1})],$)).Decode((Q)=>{if(typeof Q==="string")return Q==="true";if(Q!==void 0&&!Y.Check(Q))throw Y.Error(Q);return Q}).Encode((Q)=>Q)},ObjectString:($,Z)=>{let Y=g.Object($,Z),Q=L4(Y),W=JSON.stringify(Q.Create());return g.Transform(g.Union([g.String({format:"ObjectString",default:W}),Y])).Decode((X)=>{if(typeof X==="string"){if(X.charCodeAt(0)!==123)throw new j1("property",Y,X);if(!Q.Check(X=GY(X,Y)))throw Q.Error(X);return Q.Decode(X)}return X}).Encode((X)=>{let J;if(typeof X==="string")X=GY(J=X,Y);if(!Q.Check(X))throw Q.Error(X);return J??JSON.stringify(X)})},ArrayString:($=g.String(),Z)=>{let Y=g.Array($,Z),Q=L4(Y),W=(X,J=!1)=>{if(X.charCodeAt(0)===91){if(!Q.Check(X=GY(X,Y)))throw Q.Error(X);return Q.Decode(X)}if(X.indexOf(",")!==-1){if(!Q.Check(X))throw Q.Error(X);return Q.Decode(X)}if(J)return X;throw new j1("property",Y,X)};return g.Transform(g.Union([g.String({format:"ArrayString",default:Z?.default}),Y])).Decode((X)=>{if(Array.isArray(X)){let J=[];for(let z=0;z<X.length;z++){let U=X[z];if(typeof U==="string"){let S=W(U,!0);if(Array.isArray(S))J=J.concat(S);else J.push(S);continue}J.push(U)}return J}if(typeof X==="string")return W(X);return X}).Encode((X)=>{let J;if(typeof X==="string")X=GY(J=X,Y);if(!Q.Check(X))throw new j1("property",Y,X);return J??JSON.stringify(X)})},File:TY("File",j5),Files:($={})=>g.Transform(DK($)).Decode((Z)=>{if(Array.isArray(Z))return Z;return[Z]}).Encode((Z)=>Z),Nullable:($,Z)=>g.Union([$,g.Null()],Z),MaybeEmpty:($,Z)=>g.Union([$,g.Null(),g.Undefined()],Z),Cookie:($,{domain:Z,expires:Y,httpOnly:Q,maxAge:W,path:X,priority:J,sameSite:z,secure:U,secrets:S,sign:q,...M}={})=>{let H=g.Object($,M);return H.config={domain:Z,expires:Y,httpOnly:Q,maxAge:W,path:X,priority:J,sameSite:z,secure:U,secrets:S,sign:q},H},UnionEnum:($,Z={})=>{let Y=$.every((Q)=>typeof Q==="string")?{type:"string"}:$.every((Q)=>typeof Q==="number")?{type:"number"}:$.every((Q)=>Q===null)?{type:"null"}:{};if($.some((Q)=>typeof Q==="object"&&Q!==null))throw new Error("This type does not support objects or arrays");return{default:$[0],...Z,[L]:"UnionEnum",...Y,enum:$}},NoValidate:($,Z=!0)=>{return $.noValidate=Z,$},Form:($,Z={})=>{let Y=g.Object($,{default:MK({}),...Z}),Q=L4(Y);return g.Union([Y,AK({compiler:Q})])}};g.BooleanString=i0.BooleanString;g.ObjectString=i0.ObjectString;g.ArrayString=i0.ArrayString;g.Numeric=i0.Numeric;g.Integer=i0.Integer;g.File=($)=>{if($?.type)g5();return i0.File({default:"File",...$,extension:$?.type,type:"string",format:"binary"})};g.Files=($)=>{if($?.type)g5();return i0.Files({...$,elysiaMeta:"Files",default:"Files",extension:$?.type,type:"array",items:{...$,default:"Files",type:"string",format:"binary"}})};g.Nullable=($)=>i0.Nullable($);g.MaybeEmpty=i0.MaybeEmpty;g.Cookie=i0.Cookie;g.Date=i0.Date;g.UnionEnum=i0.UnionEnum;g.NoValidate=i0.NoValidate;g.Form=i0.Form;var NK=($)=>{if($.startsWith("async"))$=$.slice(5);$=$.trimStart();let Z=-1;if($.charCodeAt(0)===40){if(Z=$.indexOf("=>",$.indexOf(")")),Z!==-1){let W=Z;while(W>0)if($.charCodeAt(--W)===41)break;let X=$.slice(Z+2);if(X.charCodeAt(0)===32)X=X.trimStart();return[$.slice(1,W),X,{isArrowReturn:X.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test($)){if(Z=$.indexOf("=>"),Z!==-1){let W=$.slice(Z+2);if(W.charCodeAt(0)===32)W=W.trimStart();return[$.slice(0,Z),W,{isArrowReturn:W.charCodeAt(0)!==123}]}}if($.startsWith("function")){Z=$.indexOf("(");let W=$.indexOf(")");return[$.slice(Z+1,W),$.slice(W+2),{isArrowReturn:!1}]}let Y=$.indexOf("(");if(Y!==-1){let W=$.indexOf(`
`,2),X=$.slice(0,W),J=X.lastIndexOf(")")+1,z=$.slice(W+1);return[X.slice(Y,J),"{"+z,{isArrowReturn:!1}]}let Q=$.split(`
`,2);return[Q[0],Q[1],{isArrowReturn:!1}]},LK=($)=>{let Z=$.indexOf("{");if(Z===-1)return[-1,0];let Y=Z+1,Q=1;for(;Y<$.length;Y++){let W=$.charCodeAt(Y);if(W===123)Q++;else if(W===125)Q--;if(Q===0)break}if(Q!==0)return[0,$.length];return[Z,Y+1]},OK=($)=>{let Z=$.lastIndexOf("}");if(Z===-1)return[-1,0];let Y=Z-1,Q=1;for(;Y>=0;Y--){let W=$.charCodeAt(Y);if(W===125)Q++;else if(W===123)Q--;if(Q===0)break}if(Q!==0)return[-1,0];return[Y,Z+1]},lJ=($)=>{while(!0){let Z=$.indexOf(":");if(Z===-1)break;let Y=$.indexOf(",",Z);if(Y===-1)Y=$.indexOf("}",Z)-1;if(Y===-2)Y=$.length;$=$.slice(0,Z)+$.slice(Y)}return $},nJ=($)=>{let Z=!1;if($.charCodeAt(0)===40)$=$.slice(1,-1);if($.charCodeAt(0)===123)Z=!0,$=$.slice(1,-1);$=$.replace(/( |\t|\n)/g,"").trim();let Y=[];while(!0){let[W,X]=LK($);if(W===-1)break;if(Y.push($.slice(0,W-1)),$.charCodeAt(X)===44)X++;$=$.slice(X)}if($=lJ($),$)Y=Y.concat($.split(","));let Q=Object.create(null);for(let W of Y){if(W.indexOf(",")===-1){Q[W]=!0;continue}for(let X of W.split(","))Q[X.trim()]=!0}return{hasParenthesis:Z,parameters:Q}},FK=($,Z)=>{let{parameters:Y,hasParenthesis:Q}=nJ($);if(Y.query)Z.query=!0;if(Y.headers)Z.headers=!0;if(Y.body)Z.body=!0;if(Y.cookie)Z.cookie=!0;if(Y.set)Z.set=!0;if(Y.server)Z.server=!0;if(Y.route)Z.route=!0;if(Y.url)Z.url=!0;if(Y.path)Z.path=!0;if(Q)return`{ ${Object.keys(Y).join(", ")} }`;return Object.keys(Y).join(", ")},RJ=($,Z,Y)=>{let Q=new RegExp(`${$.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}[\\n\\t,; ]`);if(Y!==void 0)Q.lastIndex=Y;let W=Q.exec(Z);return W?W.index:-1},oJ=($,Z,Y=0)=>{if(Y>5)return[];let Q=[],W=Z;while(!0){let X=RJ(" = "+$,W);if(X===-1)X=RJ("="+$,W);if(X===-1){let S=W.indexOf(" = "+$);if(S===-1)S=W.indexOf("="+$);if(S+3+$.length!==W.length)break;X=S}let J=W.slice(0,X),z=J.lastIndexOf(" "),U=J.slice(z!==-1?z+1:-1);if(U==="}"){let[S,q]=OK(J);Q.push(lJ(W.slice(S,q))),W=W.slice(X+3+$.length);continue}while(U.charCodeAt(0)===44)U=U.slice(1);while(U.charCodeAt(0)===9)U=U.slice(1);if(!U.includes("("))Q.push(U);W=W.slice(X+3+$.length)}for(let X of Q){if(X.charCodeAt(0)===123)continue;let J=oJ(X,Z);if(J.length>0)Q.push(...J)}return Q},PK=($)=>{if(!$)return;if($.charCodeAt(0)!==123)return $;if($=$.slice(2,-2),!$.includes(",")){if($.indexOf("...")!==-1)return $.slice($.indexOf("...")+3);return}let Z=$.indexOf("...");if(Z===-1)return;return $.slice(Z+3).trimEnd()},KK=($,Z,Y)=>{let Q=(W,X)=>new RegExp(`${X}\\.(${W})|${X}\\["${W}"\\]|${X}\\['${W}'\\]`).test($);for(let W of Z){if(!W)continue;if(W.charCodeAt(0)===123){let X=nJ(W).parameters;if(X.query)Y.query=!0;if(X.headers)Y.headers=!0;if(X.body)Y.body=!0;if(X.cookie)Y.cookie=!0;if(X.set)Y.set=!0;if(X.server)Y.server=!0;if(X.url)Y.url=!0;if(X.route)Y.route=!0;if(X.path)Y.path=!0;continue}if(!Y.query&&(Q("query",W)||$.includes("return "+W)||$.includes("return "+W+".query")))Y.query=!0;if(!Y.headers&&Q("headers",W))Y.headers=!0;if(!Y.body&&Q("body",W))Y.body=!0;if(!Y.cookie&&Q("cookie",W))Y.cookie=!0;if(!Y.set&&Q("set",W))Y.set=!0;if(!Y.server&&Q("server",W))Y.server=!0;if(!Y.route&&Q("route",W))Y.route=!0;if(!Y.url&&Q("url",W))Y.url=!0;if(!Y.path&&Q("path",W))Y.path=!0;if(Y.query&&Y.headers&&Y.body&&Y.cookie&&Y.set&&Y.server&&Y.route&&Y.url&&Y.path)break}return Z},RK=($,Z,Y)=>{try{let Q=new RegExp(`\\w\\((.*?)?${$}`,"gs");Q.test(Z);let W=Z.charCodeAt(Q.lastIndex);if(W===41||W===44)return Y.query=!0,Y.headers=!0,Y.body=!0,Y.cookie=!0,Y.set=!0,Y.server=!0,Y.url=!0,Y.route=!0,Y.path=!0,!0;return!1}catch(Q){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log(Z),console.log("--- context ---"),console.log($),!0}},MY,wY={},jJ=($=0)=>{if(MY)clearTimeout(MY);MY=setTimeout(()=>{if(wY={},MY=void 0,J$)Bun.gc(!1)},$)},C5=($,Z)=>{return{body:$.body||Z.body,cookie:$.cookie||Z.cookie,headers:$.headers||Z.headers,query:$.query||Z.query,set:$.set||Z.set,server:$.server||Z.server,url:$.url||Z.url,route:$.route||Z.route,path:$.path||Z.path}},r$=($,Z={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,url:!1,route:!1,path:!1})=>{let Y=[];if($.request?.length)Y.push(...$.request);if($.beforeHandle?.length)Y.push(...$.beforeHandle);if($.parse?.length)Y.push(...$.parse);if($.error?.length)Y.push(...$.error);if($.transform?.length)Y.push(...$.transform);if($.afterHandle?.length)Y.push(...$.afterHandle);if($.mapResponse?.length)Y.push(...$.mapResponse);if($.afterResponse?.length)Y.push(...$.afterResponse);if($.handler&&typeof $.handler==="function")Y.push($.handler);for(let Q=0;Q<Y.length;Q++){let W=Y[Q];if(!W)continue;let X=typeof W==="object"?W.fn:W;if(typeof X!=="function")continue;let J=X.toString(),z=Q$(J),U=wY[z];if(U){Z=C5(Z,U);continue}let S={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,url:!1,route:!1,path:!1},[q,M]=NK(J),H=FK(q,S),w=PK(H);if(w){let G=oJ(w,M.slice(1,-1));G.splice(0,-1,w);let N=M;if(N.charCodeAt(0)===123&&N.charCodeAt(M.length-1)===125)N=N.slice(1,-1);if(!RK(w,N,S))KK(N,G,S);if(!S.query&&N.includes("return "+w+".query"))S.query=!0}if(!wY[z])wY[z]=S;if(Z=C5(Z,S),Z.query&&Z.headers&&Z.body&&Z.cookie&&Z.set&&Z.server&&Z.url&&Z.route&&Z.path)break}return Z},tJ=VY(fP(),1),jK=VY(I5(),1);class K8{name;jar;initial;constructor($,Z,Y={}){this.name=$,this.jar=Z,this.initial=Y}get cookie(){return this.jar[this.name]??this.initial}set cookie($){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=$}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie($){this.cookie=$}get value(){return this.cookie.value}set value($){this.setCookie.value=$}get expires(){return this.cookie.expires}set expires($){this.setCookie.expires=$}get maxAge(){return this.cookie.maxAge}set maxAge($){this.setCookie.maxAge=$}get domain(){return this.cookie.domain}set domain($){this.setCookie.domain=$}get path(){return this.cookie.path}set path($){this.setCookie.path=$}get secure(){return this.cookie.secure}set secure($){this.setCookie.secure=$}get httpOnly(){return this.cookie.httpOnly}set httpOnly($){this.setCookie.httpOnly=$}get sameSite(){return this.cookie.sameSite}set sameSite($){this.setCookie.sameSite=$}get priority(){return this.cookie.priority}set priority($){this.setCookie.priority=$}get partitioned(){return this.cookie.partitioned}set partitioned($){this.setCookie.partitioned=$}get secrets(){return this.cookie.secrets}set secrets($){this.setCookie.secrets=$}update($){return this.setCookie=Object.assign(this.cookie,typeof $==="function"?$(this.cookie):$),this}set($){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof $==="function"?$(this.cookie):$),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var CJ=($,Z,Y)=>{if(!$.cookie)$.cookie={};return new Proxy(Z,{get(Q,W){if(W in Z)return new K8(W,$.cookie,Object.assign({},Y??{},Z[W]));return new K8(W,$.cookie,Object.assign({},Y))}})},sJ=async($,Z,{secrets:Y,sign:Q,...W}={})=>{if(!Z)return CJ($,{},W);let X=typeof Y==="string";if(Q&&Q!==!0&&!Array.isArray(Q))Q=[Q];let J={},z=tJ.parse(Z);for(let[U,S]of Object.entries(z)){if(S===void 0)continue;let q=jK.default(S);if(Q===!0||Q?.includes(U)){if(!Y)throw new Error("No secret is provided to cookie plugin");if(X){let M=await DJ(q,Y);if(M===!1)throw new R5(U);q=M}else{let M=!0;for(let H=0;H<Y.length;H++){let w=await DJ(q,Y[H]);if(w!==!1){M=!0,q=w;break}}if(!M)throw new R5(U)}}J[U]={value:q}}return CJ($,J,W)},rJ=($)=>{if(!$||!T1($))return;let Z=[];for(let[Y,Q]of Object.entries($)){if(!Y||!Q)continue;let W=Q.value;if(W===void 0||W===null)continue;Z.push(tJ.serialize(Y,typeof W==="object"?JSON.stringify(W):W+"",Q))}if(Z.length===0)return;if(Z.length===1)return Z[0];return Z},y1=($,Z)=>{if(!J$&&$ instanceof Promise)return $.then((Q)=>y1(Q,Z));let Y=$.size;if(!Z&&Y||Y&&Z&&Z.status!==206&&Z.status!==304&&Z.status!==412&&Z.status!==416){if(Z){if(Z.headers instanceof Headers){let Q={"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"};if(NY)Q=Z.headers.toJSON();else{Q={};for(let[W,X]of Z.headers.entries())if(W in Z.headers)Q[W]=X}return new Response($,{status:Z.status,headers:Q})}if(T1(Z.headers))return new Response($,{status:Z.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"},Z.headers)})}return new Response($,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${Y-1}/${Y}`,"transfer-encoding":"chunked"}})}return new Response($)},aJ=($,Z)=>{if(!$)return $;$.delete("set-cookie");for(let Y=0;Y<Z.length;Y++){let Q=Z[Y].indexOf("=");$.append("set-cookie",`${Z[Y].slice(0,Q)}=${Z[Y].slice(Q+1)||""}`)}return $},l8=($,Z)=>{if(Z?.headers){if($){if(NY)Object.assign(Z.headers,$.headers.toJSON());else for(let[Y,Q]of $.headers.entries())if(Y in Z.headers)Z.headers[Y]=Q}if(Z.status===200)Z.status=$.status;if(Z.headers["content-encoding"])delete Z.headers["content-encoding"];return Z}if(!$)return{headers:{},status:Z?.status??200};if(NY){if(Z={headers:$.headers.toJSON(),status:Z?.status??200},Z.headers["content-encoding"])delete Z.headers["content-encoding"];return Z}Z={headers:{},status:Z?.status??200};for(let[Y,Q]of $.headers.entries()){if(Y==="content-encoding")continue;if(Y in Z.headers)Z.headers[Y]=Q}return Z},f5=({mapResponse:$,mapCompactResponse:Z})=>async(Y,Q,W)=>{let X=Y.next();if(X instanceof Promise)X=await X;if(X.done){if(Q)return $(X.value,Q,W);return Z(X.value,W)}if(Q?.headers){if(!Q.headers["transfer-encoding"])Q.headers["transfer-encoding"]="chunked";if(!Q.headers["content-type"])Q.headers["content-type"]="text/event-stream; charset=utf-8"}else Q={status:200,headers:{"content-type":"text/event-stream; charset=utf-8","transfer-encoding":"chunked"}};return new Response(new ReadableStream({async start(J){let z=!1;if(W?.signal?.addEventListener("abort",()=>{z=!0;try{J.close()}catch{}}),X.value!==void 0&&X.value!==null)if(typeof X.value==="object")try{J.enqueue(Buffer.from(JSON.stringify(X.value)))}catch{J.enqueue(Buffer.from(X.value.toString()))}else J.enqueue(Buffer.from(X.value.toString()));for await(let U of Y){if(z)break;if(U===void 0||U===null)continue;if(typeof U==="object")try{J.enqueue(Buffer.from(JSON.stringify(U)))}catch{J.enqueue(Buffer.from(U.toString()))}else J.enqueue(Buffer.from(U.toString()));await new Promise((S)=>setTimeout(()=>S(),0))}try{J.close()}catch{}}}),Q)};async function*n8($){let Z=$.body;if(!Z)return;let Y=Z.getReader(),Q=new TextDecoder;try{while(!0){let{done:W,value:X}=await Y.read();if(W)break;yield Q.decode(X)}}finally{Y.releaseLock()}}var bY=($)=>{if(typeof $.status==="string")$.status=EY[$.status];if($.cookie&&T1($.cookie)){let Z=rJ($.cookie);if(Z)$.headers["set-cookie"]=Z}if($.headers["set-cookie"]&&Array.isArray($.headers["set-cookie"]))$.headers=aJ(new Headers($.headers),$.headers["set-cookie"])},eJ=($)=>{let Z=f5($);return(Y,Q,W)=>{let X=!1;if(Q.headers instanceof Headers)for(let z of Q.headers.keys())if(z==="set-cookie"){if(X)continue;X=!0;for(let U of Q.headers.getSetCookie())Y.headers.append("set-cookie",U)}else Y.headers.append(z,Q.headers?.get(z)??"");else for(let z in Q.headers)Y.headers.append(z,Q.headers[z]);let J=Q.status??200;if(Y.status!==J&&J!==200&&(Y.status<=300||Y.status>400))return Y.text().then((z)=>{let U=new Response(z,{headers:Y.headers,status:Q.status});if(!U.headers.has("content-length")&&U.headers.get("transfer-encoding")==="chunked")return Z(n8(U),l8(U,Q),W);return U});if(!Y.headers.has("content-length")&&Y.headers.get("transfer-encoding")==="chunked")return Z(n8(Y),l8(Y,Q),W);return Y}},c0=($,Z,Y)=>{if(T1(Z.headers)||Z.status!==200||Z.cookie)switch(bY(Z),$?.constructor?.name){case"String":return Z.headers["content-type"]="text/plain",new Response($,Z);case"Array":case"Object":return Z.headers["content-type"]="application/json",new Response(JSON.stringify($),Z);case"ElysiaFile":return y1($.value);case"File":return y1($,Z);case"Blob":return y1($,Z);case"ElysiaCustomStatusResponse":return Z.status=$.code,c0($.response,Z,Y);case"ReadableStream":if(!Z.headers["content-type"]?.startsWith("text/event-stream"))Z.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,Z);case void 0:if(!$)return new Response("",Z);return new Response(JSON.stringify($),Z);case"Response":return RY($,Z,Y);case"Error":return u8($,Z);case"Promise":return $.then((Q)=>c0(Q,Z,Y));case"Function":return c0($(),Z,Y);case"Number":case"Boolean":return new Response($.toString(),Z);case"Cookie":if($ instanceof K8)return new Response($.value,Z);return new Response($?.toString(),Z);case"FormData":return new Response($,Z);default:if($ instanceof Response)return RY($,Z,Y);if($ instanceof Promise)return $.then((Q)=>c0(Q,Z));if($ instanceof Error)return u8($,Z);if($ instanceof V0)return Z.status=$.code,c0($.response,Z,Y);if(typeof $?.next==="function")return p8($,Z,Y);if(typeof $?.then==="function")return $.then((Q)=>c0(Q,Z));if(typeof $?.toResponse==="function")return c0($.toResponse(),Z);if("charCodeAt"in $){let Q=$.charCodeAt(0);if(Q===123||Q===91){if(!Z.headers["Content-Type"])Z.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),Z)}}return new Response($,Z)}if($ instanceof Response&&!$.headers.has("content-length")&&$.headers.get("transfer-encoding")==="chunked")return p8(n8($),l8($,Z),Y);if(typeof $?.next==="function"||$ instanceof ReadableStream)return p8($,Z,Y);return F8($,Y)},h0=($,Z,Y)=>{if($===void 0||$===null)return;if(T1(Z.headers)||Z.status!==200||Z.cookie)switch(bY(Z),$?.constructor?.name){case"String":return Z.headers["content-type"]="text/plain",new Response($,Z);case"Array":case"Object":return Z.headers["content-type"]="application/json",new Response(JSON.stringify($),Z);case"ElysiaFile":return y1($.value);case"File":return y1($,Z);case"Blob":return y1($,Z);case"ElysiaCustomStatusResponse":return Z.status=$.code,h0($.response,Z,Y);case"ReadableStream":if(!Z.headers["content-type"]?.startsWith("text/event-stream"))Z.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,Z);case void 0:if(!$)return;return new Response(JSON.stringify($),Z);case"Response":return RY($,Z,Y);case"Promise":return $.then((Q)=>h0(Q,Z));case"Error":return u8($,Z);case"Function":return h0($(),Z);case"Number":case"Boolean":return new Response($.toString(),Z);case"FormData":return new Response($);case"Cookie":if($ instanceof K8)return new Response($.value,Z);return new Response($?.toString(),Z);default:if($ instanceof Response)return RY($,Z,Y);if($ instanceof Promise)return $.then((Q)=>h0(Q,Z));if($ instanceof Error)return u8($,Z);if($ instanceof V0)return Z.status=$.code,h0($.response,Z,Y);if(typeof $?.next==="function")return p8($,Z,Y);if(typeof $?.then==="function")return $.then((Q)=>h0(Q,Z));if(typeof $?.toResponse==="function")return h0($.toResponse(),Z);if("charCodeAt"in $){let Q=$.charCodeAt(0);if(Q===123||Q===91){if(!Z.headers["Content-Type"])Z.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),Z)}}return new Response($,Z)}else switch($?.constructor?.name){case"String":return Z.headers["content-type"]="text/plain",new Response($);case"Array":case"Object":return Z.headers["content-type"]="application/json",new Response(JSON.stringify($),Z);case"ElysiaFile":return y1($.value);case"File":return y1($,Z);case"Blob":return y1($,Z);case"ElysiaCustomStatusResponse":return Z.status=$.code,h0($.response,Z,Y);case"ReadableStream":return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":if(!$.headers.has("content-length")&&$.headers.get("transfer-encoding")==="chunked")return p8(n8($),l8($),Y);return $;case"Promise":return $.then((Q)=>{let W=h0(Q,Z);if(W!==void 0)return W});case"Error":return u8($,Z);case"Function":return F8($(),Y);case"Number":case"Boolean":return new Response($.toString());case"Cookie":if($ instanceof K8)return new Response($.value,Z);return new Response($?.toString(),Z);case"FormData":return new Response($);default:if($ instanceof Response)return $;if($ instanceof Promise)return $.then((Q)=>h0(Q,Z));if($ instanceof Error)return u8($,Z);if($ instanceof V0)return Z.status=$.code,h0($.response,Z,Y);if(typeof $?.next==="function")return p8($,Z,Y);if(typeof $?.then==="function")return $.then((Q)=>h0(Q,Z));if(typeof $?.toResponse==="function")return h0($.toResponse(),Z);if("charCodeAt"in $){let Q=$.charCodeAt(0);if(Q===123||Q===91){if(!Z.headers["Content-Type"])Z.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),Z)}}return new Response($)}},F8=($,Z)=>{switch($?.constructor?.name){case"String":return new Response($,{headers:{"Content-Type":"text/plain"}});case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"Content-Type":"application/json"}});case"ElysiaFile":return y1($.value);case"File":return y1($);case"Blob":return y1($);case"ElysiaCustomStatusResponse":return c0($.response,{status:$.code,headers:{}});case"ReadableStream":return Z?.signal?.addEventListener("abort",{handleEvent(){if(Z?.signal&&!Z?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":if($.headers.get("transfer-encoding")==="chunked")return p8(n8($),l8($),Z);return $;case"Error":return u8($);case"Promise":return $.then((Y)=>F8(Y,Z));case"Function":return F8($(),Z);case"Number":case"Boolean":return new Response($.toString());case"FormData":return new Response($);default:if($ instanceof Response)return $;if($ instanceof Promise)return $.then((Y)=>F8(Y,Z));if($ instanceof Error)return u8($);if($ instanceof V0)return c0($.response,{status:$.code,headers:{}});if(typeof $?.next==="function")return p8($,void 0,Z);if(typeof $?.then==="function")return $.then((Y)=>c0(Y,set));if(typeof $?.toResponse==="function")return F8($.toResponse());if("charCodeAt"in $){let Y=$.charCodeAt(0);if(Y===123||Y===91)return new Response(JSON.stringify($),{headers:{"Content-Type":"application/json"}})}return new Response($)}},u8=($,Z)=>new Response(JSON.stringify({name:$?.name,message:$?.message,cause:$?.cause}),{status:Z?.status!==200?Z?.status??500:500,headers:Z?.headers}),CK=($,Z,Y={})=>{if(typeof $==="function")return;let Q=c0($,{headers:Y});if(!Z.parse?.length&&!Z.transform?.length&&!Z.beforeHandle?.length&&!Z.afterHandle?.length)return Q.clone.bind(Q)},RY=eJ({mapResponse:c0,mapCompactResponse:F8}),p8=f5({mapResponse:c0,mapCompactResponse:F8}),_5={name:"web-standard",isWebStandard:!0,handler:{mapResponse:c0,mapEarlyResponse:h0,mapCompactResponse:F8,createStaticHandler:CK},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers={}
for(const [k,v] of c.request.headers.entries())c.headers[k]=v
`,parser:{json($){if($)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData($){let Z=`
c.body={}
`;if($)Z+="let form;try{form=await c.request.formData()}catch{}";else Z+=`const form=await c.request.formData()
`;return Z+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},composeGeneralHandler:{parameters:"r",createContext($){let Z="",Y="",Q=$.setHeaders;for(let J of Object.keys($.decorator))Z+=`,'${J}':decorator['${J}']`;let W=$.config.handler?.standardHostname??!0,X=!!$.event.trace?.length;if(Y+=`const u=r.url,s=u.indexOf('/',${W?11:7}),qi=u.indexOf('?',s+1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,X)Y+=`const id=randomId()
`;if(Y+="const c={request:r,store,qi,path:p,url:u,redirect,error:status,status,set:{headers:",Y+=Object.keys(Q??{}).length?"Object.assign({},app.setHeaders)":"Object.create(null)",Y+=",status:200}",$.inference.server)Y+=",get server(){return app.getServer()}";if(X)Y+=",[ELYSIA_REQUEST_ID]:id";return Y+=Z,Y+=`}
`,Y},error404($,Z){let Y="if(route===null)return ";if(Z)Y+=`app.handleError(c,notFound,false,${this.parameters})`;else Y+=$?"new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"error404.clone()";return{declare:Z?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:Y}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw new Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}},_K=VY(I5(),1),jY=VY(I5(),1);function VK($,Z=0){let Y=Object.create(null),Q=1,W=2,X=4,J=8,z=0,U=Z-1,S=U,q=$.length;for(let H=Z;H<q;H++)switch($.charCodeAt(H)){case 38:M(H),U=H,S=H,z=0;break;case 61:if(S<=U)S=H;else z|=8;break;case 43:if(S>U)z|=4;else z|=1;break;case 37:if(S>U)z|=8;else z|=2;break}return M(q),Y;function M(H){let w=S>U,G=w?S:H;if(G<=U+1)return;let N=$.slice(U+1,G);if(z&1)N=N.replace(/\+/g," ");if(z&2)N=jY.default(N)||N;if(Y[N]!==void 0)return;let O="";if(w){if(O=$.slice(S+1,H),z&4)O=O.replace(/\+/g," ");if(z&8)O=jY.default(O)||O}Y[N]=O}}function HY($){let Z=Object.create(null),Y=0,Q=1,W=2,X=4,J=8,z=$.length,U=-1,S=-1;for(let M=0;M<z;M++)switch($.charCodeAt(M)){case 38:q($,M),U=M,S=M,Y=0;break;case 61:if(S<=U)S=M;else Y|=J;break;case 43:if(S>U)Y|=X;else Y|=Q;break;case 37:if(S>U)Y|=J;else Y|=W;break}if(U<z)q($,z);return Z;function q(M,H){let w=S>U,G=w?S:H,N=M.slice(U+1,G);if(!w&&N.length===0)return;let O=N;if(Y&Q)O=O.replace(/\+/g," ");if(Y&W)O=jY.default(O)||O;let m="";if(w){let b=M.slice(S+1,H);if(Y&X)b=b.replace(/\+/g," ");if(Y&J)b=jY.default(b)||b;m=b}let P=Z[O];if(P===void 0)Z[O]=m;else if(Array.isArray(P))P.push(m);else Z[O]=[P,m]}}var xY=Symbol("ElysiaTrace"),N8=()=>{let{promise:$,resolve:Z}=Promise.withResolvers(),{promise:Y,resolve:Q}=Promise.withResolvers(),{promise:W,resolve:X}=Promise.withResolvers(),J=[],z=[];return[(U)=>{if(U)J.push(U);return $},(U)=>{let S=[],q=[],M=null;for(let w=0;w<(U.total??0);w++){let{promise:G,resolve:N}=Promise.withResolvers(),{promise:O,resolve:m}=Promise.withResolvers(),{promise:P,resolve:b}=Promise.withResolvers(),l=[],t=[];S.push((k)=>{if(k)l.push(k);return G}),q.push((k)=>{let x={...k,end:O,error:P,index:w,onStop(v){if(v)t.push(v);return O}};N(x);for(let v=0;v<l.length;v++)l[v](x);return(v=null)=>{let _=performance.now();if(v)M=v;let p={end:_,error:v,get elapsed(){return _-k.begin}};for(let $1=0;$1<t.length;$1++)t[$1](p);m(_),b(v)}})}let H={...U,end:Y,error:W,onEvent(w){for(let G=0;G<S.length;G++)S[G](w)},onStop(w){if(w)z.push(w);return Y}};Z(H);for(let w=0;w<J.length;w++)J[w](H);return{resolveChild:q,resolve(w=null){let G=performance.now();if(!w&&M)w=M;let N={end:G,error:w,get elapsed(){return G-U.begin}};for(let O=0;O<z.length;O++)z[O](N);Q(G),X(w)}}}]},EK=($)=>{return(Z)=>{let[Y,Q]=N8(),[W,X]=N8(),[J,z]=N8(),[U,S]=N8(),[q,M]=N8(),[H,w]=N8(),[G,N]=N8(),[O,m]=N8(),[P,b]=N8();return $({id:Z[a$],context:Z,set:Z.set,onRequest:Y,onParse:W,onTransform:J,onBeforeHandle:U,onHandle:q,onAfterHandle:H,onMapResponse:O,onAfterResponse:P,onError:G,time:Date.now(),store:Z.store}),{request:Q,parse:X,transform:z,beforeHandle:S,handle:M,afterHandle:w,error:N,mapResponse:m,afterResponse:b}}},p0=Symbol.for("TypeBox.Kind"),IK=Symbol.for("TypeBox.Hint"),$z=($)=>/(\ |-|\t|\n)/.test($),Zz=($,Z,Y=!1)=>{if(typeof Z==="number")return`${$}[${Z}]`;if($z(Z))return`${$}${Y?"?.":""}["${Z}"]`;return`${$}${Y?"?":""}.${Z}`},TK=($)=>$z($)?`"${$}"`:$,_J=($,Z=0,Y)=>{if(Y.type!=="string"||Y.const||Y.trusted)return $;let Q="";for(let W=Z-1;W>=0;W--)Q+=`d.h${W}(`;return Q+$+")".repeat(Z)},Yz=($)=>{if(!$.allOf||p0 in $&&($[p0]!=="Intersect"||$.type!=="object"))return $;let{allOf:Z,...Y}=$;if(Y.properties={},p0 in Y)Y[p0]="Object";for(let Q of Z){if(Q.type!=="object")continue;let{properties:W,required:X,type:J,[p0]:z,...U}=Q;if(X)Y.required=Y.required?Y.required.concat(X):X;Object.assign(Y,U);for(let S in Q.properties)Y.properties[S]=Yz(Q.properties[S])}return Y},bK=($,Z,Y)=>{let Q=$.patternProperties["^(.*)$"]??$.patternProperties[Object.keys($.patternProperties)[0]];if(!Q)return Z;let W=Y.array;return Y.array++,`(()=>{const ar${W}s=Object.keys(${Z}),ar${W}v={};for(let i=0;i<ar${W}s.length;i++){const ar${W}p=${Z}[ar${W}s[i]];ar${W}v[ar${W}s[i]]=${L8(Q,`ar${W}p`,Y)}}return ar${W}v})()`},xK=($,Z,Y)=>{let Q=Y.array;Y.array++;let W=Z==="v"&&!Y.unions.length,X="";if(!W)X="(()=>{";X+=`const ar${Q}v=[`;for(let J=0;J<$.length;J++){if(J!==0)X+=",";X+=L8($[J],Zz(Z,J,Y.parentIsOptional),Y)}if(X+="];",!W)X+=`return ar${Q}v})()`;return X};function CY($,Z=new WeakMap){if($===null||typeof $!=="object"||typeof $==="function")return $;if(Z.has($))return Z.get($);if(Array.isArray($)){let Y=new Array($.length);Z.set($,Y);for(let Q=0;Q<$.length;Q++)Y[Q]=CY($[Q],Z);return Y}if(typeof $==="object"){let Y=Object.keys($).concat(Object.getOwnPropertySymbols($)),Q={};for(let W of Y)Q[W]=CY($[W],Z);return Q}return $}var kK=($,Z,Y)=>{if(Y.TypeCompiler===void 0){if(!Y.typeCompilerWanred)console.warn(new Error("[exact-mirror] TypeBox's TypeCompiler is required to use Union")),Y.typeCompilerWanred=!0;return Z}Y.unionKeys[Z]=1;let Q=Y.unions.length,W=Y.unions[Q]=[],X=`(()=>{
`,J=(z)=>{if(!(p0 in z)||!z.$ref)return z;if(z[p0]==="This")return CY(Y.definitions[z.$ref]);else if(z[p0]==="Ref")if(!Y.modules)console.warn(new Error("[exact-mirror] modules is required when using nested cyclic reference"));else return Y.modules.Import(z.$ref);return z};for(let z=0;z<$.length;z++){let U=J($[z]);if(Array.isArray(U.anyOf))for(let S=0;S<U.anyOf.length;S++)U.anyOf[S]=J(U.anyOf[S]);else if(U.items)if(Array.isArray(U.items))for(let S=0;S<U.items.length;S++)U.items[S]=J(U.items[S]);else U.items=J(U.items);W.push(l6.Compile(U)),X+=`if(d.unions[${Q}][${z}].Check(${Z})){return ${L8(U,Z,{...Y,recursion:Y.recursion+1,parentIsOptional:!0})}}
`}return X+=`return ${Y.removeUnknownUnionType?"undefined":Z}})()`,X},L8=($,Z,Y)=>{if(!$)return"";let Q=Z==="v"&&!Y.unions.length;if(p0 in $&&$[p0]==="Import"&&$.$ref in $.$defs)return L8($.$defs[$.$ref],Z,{...Y,definitions:Object.assign(Y.definitions,$.$defs)});if(Q&&$.type!=="object"&&$.type!=="array"&&!$.anyOf)return`return ${_J("v",Y.sanitize?.length,$)}`;if(Y.recursion>=Y.recursionLimit)return Z;let W="";if($.$id&&IK in $)Y.definitions[$.$id]=$;switch($.type){case"object":if($[p0]==="Record"){W=bK($,Z,Y);break}if($=Yz($),W+="{",$.additionalProperties)W+=`...${Z}`;let X=Object.keys($.properties);for(let S=0;S<X.length;S++){let q=X[S],M=$.required&&!$.required.includes(q)||Array.isArray($.properties[q].anyOf),H=Zz(Z,q,Y.parentIsOptional);if(M){let G=Y.array;if(Z.startsWith("ar")){let N=H.slice(H.indexOf(".")+1),O=Y.optionalsInArray;if(O[G])O[G].push(N);else O[G]=[N]}else Y.optionals.push(H)}let w=$.properties[q];if($.additionalProperties&&w.type!=="object")continue;if(S!==0)W+=",";W+=`${TK(q)}:${M?`${H}===undefined?undefined:`:""}${L8(w,H,{...Y,recursion:Y.recursion+1,parentIsOptional:M})}`}W+="}";break;case"array":if($.items.type!=="object"&&$.items.type!=="array")if(Array.isArray($.items)){W=xK($.items,Z,Y);break}else if(Q)return"return v";else if(p0 in $.items&&$.items.$ref&&($.items[p0]==="Ref"||$.items[p0]==="This"))W=L8(CY(Y.definitions[$.items.$ref]),Z,{...Y,parentIsOptional:!0,recursion:Y.recursion+1});else{W=Z;break}let J=Y.array;Y.array++;let z=Z;if(Q)W=`const ar${J}v=new Array(${Z}.length);`;else z=`ar${J}s`,W=`((${z})=>{const ar${J}v=new Array(${z}.length);`;W+=`for(let i=0;i<${z}.length;i++){const ar${J}p=${z}[i];ar${J}v[i]=${L8($.items,`ar${J}p`,Y)}`;let U=Y.optionalsInArray[J+1];if(U)for(let S=0;S<U.length;S++){let q=`ar${J}v[i].${U[S]}`;W+=`;if(${q}===undefined)delete ${q}`}if(W+="}",!Q)W+=`return ar${J}v})(${Z})`;break;default:if($.$ref&&$.$ref in Y.definitions)return L8(Y.definitions[$.$ref],Z,Y);if(Array.isArray($.anyOf)){W=kK($.anyOf,Z,Y);break}W=_J(Z,Y.sanitize?.length,$);break}if(!Q)return W;if($.type==="array")return`${W}return ar0v`;W=`const x=${W}
`;for(let X=0;X<Y.optionals.length;X++){let J=Y.optionals[X],z=J.slice(1);if(W+=`if(${J}===undefined`,Y.unionKeys[J])W+=`||x${z}===undefined`;W+=`)delete x${z.charCodeAt(0)!==63?"?":""}${z}
`}return`${W}return x`},VJ=($,{TypeCompiler:Z,modules:Y,definitions:Q,sanitize:W,recursionLimit:X=8,removeUnknownUnionType:J=!1}={})=>{let z=[];if(typeof W==="function")W=[W];let U=L8($,"v",{optionals:[],optionalsInArray:[],array:0,parentIsOptional:!1,unions:z,unionKeys:{},TypeCompiler:Z,modules:Y,definitions:Q??Y?.$defs??{},sanitize:W,recursion:0,recursionLimit:X,removeUnknownUnionType:J});if(!z.length&&!W?.length)return Function("v",U);let S;if(W?.length){S={};for(let q=0;q<W.length;q++)S[`h${q}`]=W[q]}return Function("d",`return function mirror(v){${U}}`)({unions:z,...S})},V5=($)=>{if(!$)return!1;if($?.[L]==="Import"&&$.References)return $.References().some(V5);if($.schema)$=$.schema;return!!$&&s1 in $},n6=($)=>{if(!$)return!1;let Z=$?.schema??$;if(Z[L]==="Import"&&$.References)return $.References().some(n6);if(Z.anyOf)return Z.anyOf.some(n6);if(Z.someOf)return Z.someOf.some(n6);if(Z.allOf)return Z.allOf.some(n6);if(Z.not)return Z.not.some(n6);if(Z.type==="object"){let Y=Z.properties;if("additionalProperties"in Z)return Z.additionalProperties;if("patternProperties"in Z)return!1;for(let Q of Object.keys(Y)){let W=Y[Q];if(W.type==="object"){if(n6(W))return!0}else if(W.anyOf){for(let X=0;X<W.anyOf.length;X++)if(n6(W.anyOf[X]))return!0}return W.additionalProperties}return!1}if(Z.type==="array"&&Z.items&&!Array.isArray(Z.items))return n6(Z.items);return!1},m8=($,Z)=>{if(!Z)return!1;if(L in Z&&Z[L]===$)return!0;if(Z.type==="object"){let Y=Z.properties;if(!Y)return!1;for(let Q of Object.keys(Y)){let W=Y[Q];if(W.type==="object"){if(m8($,W))return!0}else if(W.anyOf){for(let X=0;X<W.anyOf.length;X++)if(m8($,W.anyOf[X]))return!0}if(L in W&&W[L]===$)return!0}return!1}return!!Z.properties&&L in Z.properties&&Z.properties[L]===$},n$=($,Z)=>{if(!Z)return;let Y=Z.schema??Z;if(Y[L]==="Import"&&Z.References)return Z.References().some((Q)=>n$($,Q));if(Y.type==="object"){let Q=Y.properties;if(!Q)return!1;for(let W of Object.keys(Q)){let X=Q[W];if($ in X)return!0;if(X.type==="object"){if(n$($,X))return!0}else if(X.anyOf){for(let J=0;J<X.anyOf.length;J++)if(n$($,X.anyOf[J]))return!0}}return!1}return $ in Y},o6=($)=>{if(!$)return!1;if($.oneOf){for(let Z=0;Z<$.oneOf.length;Z++)if(o6($.oneOf[Z]))return!0}if($.anyOf){for(let Z=0;Z<$.anyOf.length;Z++)if(o6($.anyOf[Z]))return!0}if($.oneOf){for(let Z=0;Z<$.oneOf.length;Z++)if(o6($.oneOf[Z]))return!0}if($.allOf){for(let Z=0;Z<$.allOf.length;Z++)if(o6($.allOf[Z]))return!0}if($.not&&o6($.not))return!0;if($.type==="object"&&$.properties){let Z=$.properties;for(let Y of Object.keys(Z)){let Q=Z[Y];if(o6(Q))return!0;if(Q.type==="array"&&Q.items&&o6(Q.items))return!0}}if($.type==="array"&&$.items&&o6($.items))return!0;return $[L]==="Ref"&&"$ref"in $},k6=($)=>{if(!$)return!1;if($.$ref&&$.$defs&&$.$ref in $.$defs&&k6($.$defs[$.$ref]))return!0;if($.oneOf){for(let Z=0;Z<$.oneOf.length;Z++)if(k6($.oneOf[Z]))return!0}if($.anyOf){for(let Z=0;Z<$.anyOf.length;Z++)if(k6($.anyOf[Z]))return!0}if($.allOf){for(let Z=0;Z<$.allOf.length;Z++)if(k6($.allOf[Z]))return!0}if($.not&&k6($.not))return!0;if($.type==="object"&&$.properties){let Z=$.properties;for(let Y of Object.keys(Z)){let Q=Z[Y];if(k6(Q))return!0;if(Q.type==="array"&&Q.items&&k6(Q.items))return!0}}if($.type==="array"&&$.items&&k6($.items))return!0;return R1 in $},EJ=($,Z,Y={})=>{let Q=Y;if(Q.root=!0,!Array.isArray(Z))return Z.original=$,M0($,Z,Q);for(let W of Z)W.original=$,$=M0($,W,Q);return $},M0=($,Z,Y)=>{if(!$)return $;let Q=Y.root;if(Z.untilObjectFound&&!Q&&$.type==="object")return $;let W=Z.from[L];if($.oneOf){for(let z=0;z<$.oneOf.length;z++)$.oneOf[z]=M0($.oneOf[z],Z,Y);return $}if($.anyOf){for(let z=0;z<$.anyOf.length;z++)$.anyOf[z]=M0($.anyOf[z],Z,Y);return $}if($.allOf){for(let z=0;z<$.allOf.length;z++)$.allOf[z]=M0($.allOf[z],Z,Y);return $}if($.not)return M0($.not,Z,Y);let X=Q&&!!Z.excludeRoot;if($[L]===W){let{anyOf:z,oneOf:U,allOf:S,not:q,properties:M,items:H,...w}=$,G=Z.to(w);if(!G)return $;let N,O=(P)=>{let b=m(P);if(b.$id)delete b.$id;return b},m=(P)=>{if(M&&P.type==="object"){let l={};for(let[t,k]of Object.entries(M))l[t]=M0(k,Z,{...Y,root:!1});return{...w,...P,properties:l}}if(H&&P.type==="array")return{...w,...P,items:M0(H,Z,{...Y,root:!1})};let b={...w,...P};if(delete b.required,M&&P.type==="string"&&P.format==="ObjectString"&&P.default==="{}")N=g.ObjectString(M,w),b.default=JSON.stringify(N1.Create(g.Object(M))),b.properties=M;if(H&&P.type==="string"&&P.format==="ArrayString"&&P.default==="[]")N=g.ArrayString(H,w),b.default=JSON.stringify(N1.Create(g.Array(H))),b.items=H;return b};if(X){if(M){let P={};for(let[b,l]of Object.entries(M))P[b]=M0(l,Z,{...Y,root:!1});return{...w,properties:P}}else if(H?.map)return{...w,items:H.map((P)=>M0(P,Z,{...Y,root:!1}))};return w}if(G.anyOf)for(let P=0;P<G.anyOf.length;P++)G.anyOf[P]=O(G.anyOf[P]);else if(G.oneOf)for(let P=0;P<G.oneOf.length;P++)G.oneOf[P]=O(G.oneOf[P]);else if(G.allOf)for(let P=0;P<G.allOf.length;P++)G.allOf[P]=O(G.allOf[P]);else if(G.not)G.not=O(G.not);if(N)G[R1]=N[R1];if(G.anyOf||G.oneOf||G.allOf||G.not)return G;if(M){let P={};for(let[b,l]of Object.entries(M))P[b]=M0(l,Z,{...Y,root:!1});return{...w,...G,properties:P}}else if(H?.map)return{...w,...G,items:H.map((P)=>M0(P,Z,{...Y,root:!1}))};return{...w,...G}}let J=$?.properties;if(J&&Q&&Z.rootOnly!==!0)for(let[z,U]of Object.entries(J))switch(U[L]){case W:let{anyOf:S,oneOf:q,allOf:M,not:H,type:w,...G}=U,N=Z.to(G);if(!N)return $;if(N.anyOf)for(let O=0;O<N.anyOf.length;O++)N.anyOf[O]={...G,...N.anyOf[O]};else if(N.oneOf)for(let O=0;O<N.oneOf.length;O++)N.oneOf[O]={...G,...N.oneOf[O]};else if(N.allOf)for(let O=0;O<N.allOf.length;O++)N.allOf[O]={...G,...N.allOf[O]};else if(N.not)N.not={...G,...N.not};J[z]={...G,...M0(G,Z,{...Y,root:!1})};break;case"Object":case"Union":J[z]=M0(U,Z,{...Y,root:!1});break;default:if(Array.isArray(U.items))for(let O=0;O<U.items.length;O++)U.items[O]=M0(U.items[O],Z,{...Y,root:!1});else if(U.anyOf||U.oneOf||U.allOf||U.not)J[z]=M0(U,Z,{...Y,root:!1});else if(U.type==="array")U.items=M0(U.items,Z,{...Y,root:!1});break}return $},m$=($)=>(Z)=>{if(typeof Z==="object")try{return N1.Clean($,Z)}catch{try{return N1.Clean($,Z)}catch{return Z}}return Z},U0=($,{models:Z={},dynamic:Y=!1,modules:Q,normalize:W=!1,additionalProperties:X=!1,coerce:J=!1,additionalCoerce:z=[],validators:U,sanitize:S}={})=>{if(U=U?.filter((N)=>N),!$){if(!U?.length)return;$=U[0],U=U.slice(1)}let q=void 0,M=(N)=>{if(J)return EJ(N,[{from:g.Number(),to:(O)=>g.Numeric(O),untilObjectFound:!0},{from:g.Boolean(),to:(O)=>g.BooleanString(O),untilObjectFound:!0},...Array.isArray(z)?z:[z]]);return EJ(N,z)},H=(N)=>{let O;if(!N)return;if(typeof N!=="string")O=N;else{let P=N.endsWith("[]"),b=P?N.substring(0,N.length-2):N;if(O=Q?.Import(b)??Z[b],P)O=g.Array(O)}if(!O)return;let m;if(O[L]!=="Import"&&(m=o6(O))){let P=IY();if(q===void 0)q=m;O=g.Module({...Q?.$defs,[P]:O}).Import(P)}if(O[L]==="Import"){let P={};for(let[l,t]of Object.entries(O.$defs))P[l]=M(t);let b=O.$ref;O=g.Module(P).Import(b)}else if(J||z)O=M(O);return O},w=H($);if(U?.length){let N=!1,{schema:O,notObjects:m}=fK([w,...U.map(H)]);if(m){if(w=g.Intersect([...O?[O]:[],...m.map((P)=>{let b=H(P);if(b.type==="object"&&"additionalProperties"in b){if(!N&&b.additionalProperties===!1)N=!0;delete b.additionalProperties}return b})]),w.type==="object"&&N)w.additionalProperties=!1}}else if(w.type==="object"&&"additionalProperties"in w===!1)w.additionalProperties=X;if(Y){let N={schema:w,references:"",checkFunc:()=>{},code:"",Check:(O)=>N1.Check(w,O),Errors:(O)=>N1.Errors(w,O),Code:()=>"",Clean:m$(w),Decode:(O)=>N1.Decode(w,O),Encode:(O)=>N1.Encode(w,O),get hasAdditionalProperties(){if("~hasAdditionalProperties"in this)return this["~hasAdditionalProperties"];return this["~hasAdditionalProperties"]=n6(w)},get hasDefault(){if("~hasDefault"in this)return this["~hasDefault"];return this["~hasDefault"]=n$("default",w)},get isOptional(){if("~isOptional"in this)return this["~isOptional"];return this["~isOptional"]=V5(w)},get hasTransform(){if("~hasTransform"in this)return this["~hasTransform"];return this["~hasTransform"]=k6(w)},"~hasRef":q,get hasRef(){if("~hasRef"in this)return this["~hasRef"];return this["~hasRef"]=k6(w)}};if(w.config){if(N.config=w.config,N?.schema?.config)delete N.schema.config}if(W&&w.additionalProperties===!1)if(W===!0||W==="exactMirror")try{N.Clean=VJ(w,{TypeCompiler:l6,sanitize:S?.(),modules:Q})}catch{console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.warn(w),N.Clean=m$(w)}else N.Clean=m$(w);return N.parse=(O)=>{try{return N.Decode(O)}catch(m){throw[...N.Errors(O)].map(g6)}},N.safeParse=(O)=>{try{return{success:!0,data:N.Decode(O),error:null}}catch(m){let P=[...G.Errors(O)].map(g6);return{success:!1,data:null,error:P[0]?.summary,errors:P}}},N}let G=l6.Compile(w,Object.values(Z));if(w.config){if(G.config=w.config,G?.schema?.config)delete G.schema.config}if(W===!0||W==="exactMirror")try{G.Clean=VJ(w,{TypeCompiler:l6,sanitize:S?.(),modules:Q})}catch(N){console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.warn(w),G.Clean=m$(w)}else G.Clean=m$(w);return G.parse=(N)=>{try{return G.Decode(N)}catch(O){throw[...G.Errors(N)].map(g6)}},G.safeParse=(N)=>{try{return{success:!0,data:G.Decode(N),error:null}}catch(O){let m=[...G.Errors(N)].map(g6);return{success:!1,data:null,error:m[0]?.summary,errors:m}}},Object.assign(G,{get hasAdditionalProperties(){if("~hasAdditionalProperties"in this)return this["~hasAdditionalProperties"];return this["~hasAdditionalProperties"]=n6(G)},get hasDefault(){if("~hasDefault"in this)return this["~hasDefault"];return this["~hasDefault"]=n$("default",G)},get isOptional(){if("~isOptional"in this)return this["~isOptional"];return this["~isOptional"]=V5(G)},get hasTransform(){if("~hasTransform"in this)return this["~hasTransform"];return this["~hasTransform"]=k6(w)},get hasRef(){if("~hasRef"in this)return this["~hasRef"];return this["~hasRef"]=o6(w)},"~hasRef":q}),G},gK=($)=>$[L]==="Union"||!$.schema&&!!$.anyOf,fK=($)=>{if($.length===0)return{schema:void 0,notObjects:[]};if($.length===1)return $[0].type==="object"?{schema:$[0],notObjects:[]}:{schema:void 0,notObjects:$};let Z,Y=[],Q=!1,W=!1;for(let X of $){if(X.type!=="object"){Y.push(X);continue}if("additionalProperties"in X){if(X.additionalProperties===!0)Q=!0;else if(X.additionalProperties===!1)W=!0}if(!Z){Z=X;continue}Z={...Z,...X,properties:{...Z.properties,...X.properties},required:[...Z?.required??[],...X.required]}}if(Z){if(Z.required)Z.required=[...new Set(Z.required)];if(W)Z.additionalProperties=!1;else if(Q)Z.additionalProperties=!0}return{schema:Z,notObjects:Y}},IJ=($,{models:Z={},modules:Y,dynamic:Q=!1,normalize:W=!1,additionalProperties:X=!1,validators:J=[],sanitize:z})=>{if(J=J.filter((q)=>q),!$){if(!J?.length)return;$=J[0],J=J.slice(1)}let U;if(typeof $!=="string")U=$;else{let q=$.endsWith("[]"),M=q?$.substring(0,$.length-2):$;if(U=Y.Import(M)??Z[M],q)U=g.Array(U)}if(!U)return;if(L in U)return{200:U0(U,{modules:Y,models:Z,additionalProperties:X,dynamic:Q,normalize:W,coerce:!1,additionalCoerce:[],validators:J.map((q)=>q[200]),sanitize:z})};let S={};return Object.keys(U).forEach((q)=>{if(isNaN(+q))return;let M=U[+q];if(typeof M==="string"){if(M in Z){let H=Z[M];S[+q]=L in H?U0(H,{modules:Y,models:Z,additionalProperties:X,dynamic:Q,normalize:W,coerce:!1,additionalCoerce:[],validators:J.map((w)=>w[+q]),sanitize:z}):H}return}S[+q]=L in M?U0(M,{modules:Y,models:Z,additionalProperties:X,dynamic:Q,normalize:W,coerce:!1,additionalCoerce:[],validators:J.map((H)=>H[+q]),sanitize:z}):M}),S},A5,O4=()=>{if(!A5)A5=[{from:g.Object({}),to:()=>g.ObjectString({}),excludeRoot:!0},{from:g.Array(g.Any()),to:()=>g.ArrayString(g.Any())}];return A5},N5,E5=()=>{if(!N5)N5=[{from:g.Number(),to:($)=>g.Numeric($),rootOnly:!0},{from:g.Boolean(),to:($)=>g.BooleanString($),rootOnly:!0}];return N5},Qz=({validator:$,modules:Z,defaultConfig:Y={},config:Q,dynamic:W,models:X,validators:J,sanitize:z})=>{let U=U0($,{modules:Z,dynamic:W,models:X,additionalProperties:!0,coerce:!0,additionalCoerce:O4(),validators:J,sanitize:z});if(U)U.config=mJ(U.config,Q);else U=U0(g.Cookie(g.Any()),{modules:Z,dynamic:W,models:X,additionalProperties:!0,validators:J,sanitize:z}),U.config=Y;return U},n1=($,Z)=>Z?$:"",yK=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],y5=({context:$="c",trace:Z=[],addFn:Y})=>{if(!Z.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let Q=0;Q<Z.length;Q++)Y(`let report${Q},reportChild${Q},reportErr${Q},reportErrChild${Q};let trace${Q}=${$}[ELYSIA_TRACE]?.[${Q}]??trace[${Q}](${$});
`);return(Q,{name:W,total:X=0}={})=>{if(!W)W="anonymous";let J=Q==="error"?"reportErr":"report";for(let z=0;z<Z.length;z++)Y(`${J}${z} = trace${z}.${Q}({id,event:'${Q}',name:'${W}',begin:performance.now(),total:${X}})
`);return{resolve(){for(let z=0;z<Z.length;z++)Y(`${J}${z}.resolve()
`)},resolveChild(z){for(let U=0;U<Z.length;U++)Y(`${J}Child${U}=${J}${U}.resolveChild?.shift()?.({id,event:'${Q}',name:'${z}',begin:performance.now()})
`);return(U)=>{for(let S=0;S<Z.length;S++)if(U)Y(`if(${U} instanceof Error){${J}Child${S}?.(${U}) }else{${J}Child${S}?.()}`);else Y(`${J}Child${S}?.()
`)}}}}},p$=({schema:$,name:Z,type:Y,typeAlias:Q=Y,normalize:W,ignoreTryCatch:X=!1})=>{if(!W||!$.Clean||$.hasAdditionalProperties)return"";if(W===!0||W==="exactMirror"){if(X)return`${Z}=validator.${Q}.Clean(${Z})
`;return`try{${Z}=validator.${Q}.Clean(${Z})
}catch{}`}if(W==="typebox")return`${Z}=validator.${Q}.Clean(${Z})
`;return""},vK=({injectResponse:$="",normalize:Z=!1,validator:Y,encodeSchema:Q=!1,isStaticResponse:W=!1,hasSanitize:X=!1})=>({validate:(J,z=`c.${J}`)=>`c.set.status=422;throw new ValidationError('${J}',validator.${J},${z})`,response:(J="r")=>{if(W)return"";let z=$+`
`;z+=`if(${J} instanceof ElysiaCustomStatusResponse){c.set.status=${J}.code
${J}=${J}.response}switch(c.set.status){`;for(let[U,S]of Object.entries(Y.response)){z+=`
case ${U}:if(${J} instanceof Response)break
`;let q=S.schema?.noValidate===!0,M=q||X,H=({ignoreTryCatch:G=!1}={})=>p$({name:J,schema:S,type:"response",typeAlias:`response[${U}]`,normalize:Z,ignoreTryCatch:G});if(M)z+=H();let w=!M&&Z&&!q;if(Q&&S.hasTransform)z+=`try{${J}=validator.response[${U}].Encode(${J})
c.set.status=${U}}catch{`+(w?`try{
`+H({ignoreTryCatch:!0})+`${J}=validator.response[${U}].Encode(${J})
}catch{throw new ValidationError('response',validator.response[${U}],${J})}`:`throw new ValidationError('response',validator.response[${U}],${J})`)+"}";else{if(!M)z+=H();if(!q)z+=`if(validator.response[${U}].Check(${J})===false)throw new ValidationError('response',validator.response[${U}],${J})
c.set.status=${U}
`}z+=`break
`}return z+"}"}}),W$=($)=>{return($?.fn??$).constructor.name==="AsyncFunction"},dK=/=>\s?response\.clone\(/,hK=/(?:return|=>)\s?\S+\(|a(?:sync|wait)/,Z0=($)=>{let Z=typeof $==="object";if(Z&&$.isAsync!==void 0)return $.isAsync;let Y=Z?$.fn:$;if(Y.constructor.name==="AsyncFunction")return!0;let Q=Y.toString();if(dK.test(Q)){if(Z)$.isAsync=!1;return!1}let W=hK.test(Q);if(Z)$.isAsync=W;return W},o$=($)=>{let Z=typeof $==="object";if(Z&&$.hasReturn!==void 0)return $.hasReturn;let Y=Z?$.fn.toString():typeof $==="string"?$.toString():$,Q=Y.indexOf(")");if(Y.charCodeAt(Q+2)===61&&Y.charCodeAt(Q+5)!==123){if(Z)$.hasReturn=!0;return!0}let W=Y.includes("return");if(Z)$.hasReturn=W;return W},BY=($)=>{let Z=$?.fn??$;return Z.constructor.name==="AsyncGeneratorFunction"||Z.constructor.name==="GeneratorFunction"},mK=({app:$,path:Z,method:Y,hooks:Q,validator:W,handler:X,allowMeta:J=!1,inference:z})=>{let U=$["~adapter"].composeHandler,S=$["~adapter"].handler,q=typeof X==="function";if(!q){if(X=S.mapResponse(X,{headers:$.setHeaders??{}}),Q.parse?.length&&Q.transform?.length&&Q.beforeHandle?.length&&Q.afterHandle?.length){if(X instanceof Response)return Function("a",`"use strict";
return function(){return a.clone()}`)(X);return Function("a",`"use strict";
return function(){return a}`)(X)}}let M=q?"handler(c)":"handler",H=!!Q.afterResponse?.length,w=!!Q.trace?.length,G="";if(z=r$(Q,z),z=r$({handler:X},z),U.declare){let f=U.declare(z);if(f)G+=f}if(z.server)G+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;W.createBody?.(),W.createQuery?.(),W.createHeaders?.(),W.createParams?.(),W.createCookie?.(),W.createResponse?.();let N=!!W.body||!!W.headers||!!W.params||!!W.query||!!W.cookie||!!W.response,O=z.query||!!W.query,m=Q.parse?.length===1&&Q.parse[0].fn==="none",P=Y!==""&&Y!=="GET"&&Y!=="HEAD"&&(z.body||!!W.body||!!Q.parse?.length)&&!m,b=$.setHeaders,l=b&&!!Object.keys(b).length,t=z.headers||!!W.headers||U.preferWebstandardHeaders!==!0&&z.body,k=z.cookie||!!W.cookie,x=W.cookie?.config?mJ(W?.cookie?.config,$.config.cookie):$.config.cookie,v="",_=()=>{if(v)return v;if(x?.sign){if(!x.secrets)throw new Error(`t.Cookie required secret which is not set in (${Y}) ${Z}.`);let f=!x.secrets?void 0:typeof x.secrets==="string"?x.secrets:x.secrets[0];if(v+=`const _setCookie = c.set.cookie
if(_setCookie){`,x.sign===!0)v+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${f}')}`;else for(let V of x.sign)v+=`if(_setCookie['${V}']?.value)c.set.cookie['${V}'].value=await signCookie(_setCookie['${V}'].value,'${f}')
`;v+=`}
`}return v},p=$.config.normalize,$1=$.config.encodeSchema,S1=vK({normalize:p,validator:W,encodeSchema:$1,isStaticResponse:X instanceof Response,hasSanitize:!!$.config.sanitize});if(t)G+=U.headers;if(w)G+=`const id=c[ELYSIA_REQUEST_ID]
`;let q1=y5({trace:Q.trace,addFn:(f)=>{G+=f}});if(G+="try{",k){let f=(B,F)=>{let D=x?.[B]??F;if(!D)return typeof F==="string"?`${B}:"${F}",`:`${B}:${F},`;if(typeof D==="string")return`${B}:'${D}',`;if(D instanceof Date)return`${B}: new Date(${D.getTime()}),`;return`${B}:${D},`},V=x?`{secrets:${x.secrets!==void 0?typeof x.secrets==="string"?`'${x.secrets}'`:"["+x.secrets.reduce((B,F)=>B+`'${F}',`,"")+"]":"undefined"},sign:${x.sign===!0?!0:x.sign!==void 0?"["+x.sign.reduce((B,F)=>B+`'${F}',`,"")+"]":"undefined"},`+f("domain")+f("expires")+f("httpOnly")+f("maxAge")+f("path","/")+f("priority")+f("sameSite")+f("secure")+"}":"undefined";if(t)G+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${V})
`;else G+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${V})
`}if(O){let f=[];if(W.query&&W.query.schema.type==="object"){let V=W.query.schema.properties;if(!W.query.hasAdditionalProperties)for(let[B,F]of Object.entries(V)){let D=F,I=D.type==="array"||!!D.anyOf?.some((u)=>u.type==="string"&&u.format==="ArrayString");if(D&&s1 in D&&D.type==="array"&&D.items)D=D.items;let{type:E,anyOf:T}=D;f.push({key:B,isArray:I,isNestedObjectArray:I&&D.items?.type==="object"||!!D.items?.anyOf?.some((u)=>u.type==="object"||u.type==="array"),isObject:E==="object"||T?.some((u)=>u.type==="string"&&u.format==="ArrayString"),anyOf:!!T})}}if(!f.length)G+="if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url,c.qi+1)}";else{G+=`if(c.qi!==-1){let url='&'+c.url.slice(c.qi+1)
`;let V=0;for(let{key:B,isArray:F,isObject:D,isNestedObjectArray:I,anyOf:E}of f){let T=(V===0?"let ":"")+`memory=url.indexOf('&${B}=')
let a${V}
`;if(F)if(G+=T,I)G+=`while(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(a${V}===undefined)
a${V}=''
else
a${V}+=','
let temp
if(memory===-1)temp=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else temp=decodeURIComponent(url.slice(start, memory).replace(/\\+/g,' '))
const charCode=temp.charCodeAt(0)
if(charCode!==91&&charCode !== 123)
temp='"'+temp+'"'
a${V}+=temp
if(memory===-1)break
memory=url.indexOf('&${B}=',memory)
if(memory===-1)break}try{if(a${V}.charCodeAt(0)===91)a${V} = JSON.parse(a${V})
else
a${V}=JSON.parse('['+a${V}+']')}catch{}
`;else G+=`while(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(a${V}===undefined)a${V}=[]
if(memory===-1){const temp=decodeURIComponent(url.slice(start)).replace(/\\+/g,' ')
if(temp.includes(',')){a${V}=a${V}.concat(temp.split(','))}else{a${V}.push(decodeURIComponent(url.slice(start)).replace(/\\+/g,' '))}
break}else{const temp=decodeURIComponent(url.slice(start, memory)).replace(/\\+/g,' ')
if(temp.includes(',')){a${V}=a${V}.concat(temp.split(','))}else{a${V}.push(temp)}
}memory=url.indexOf('&${B}=',memory)
if(memory===-1) break
}`;else if(D)G+=T+`if(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${V}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))else a${V}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))if(a${V}!==undefined)try{a${V}=JSON.parse(a${V})}catch{}}`;else{if(G+=T+`if(memory!==-1){const start=memory+${B.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${V}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else{a${V}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))`,E)G+=`
let deepMemory=url.indexOf('&${B}=',memory)
if(deepMemory!==-1){a${V}=[a${V}]
let first=true
while(true){const start=deepMemory+${B.length+2}
if(first)first=false
else deepMemory = url.indexOf('&', start)
let value
if(deepMemory===-1)value=url.slice(start).replace(/\\+/g,' ')
else value=url.slice(start, deepMemory).replace(/\\+/g,' ')
value=decodeURIComponent(value)
if(value===null){if(deepMemory===-1){break}else{continue}}
const vStart=value.charCodeAt(0)
const vEnd=value.charCodeAt(value.length - 1)
if((vStart===91&&vEnd===93)||(vStart===123&&vEnd===125))
try{a${V}.push(JSON.parse(value))}catch{a${V}.push(value)}if(deepMemory===-1)break}}`;G+="}}"}V++,G+=`
`}G+="c.query={"+f.map(({key:B},F)=>`'${B}':a${F}`).join(",")+"}",G+=`} else c.query = {}
`}}let A6=typeof X==="function"&&Z0(X),L1=w||Q.afterResponse?.length?"c.response= ":"",X4=k||P||A6||!!Q.parse?.length||!!Q.afterHandle?.some(Z0)||!!Q.beforeHandle?.some(Z0)||!!Q.transform?.some(Z0)||!!Q.mapResponse?.some(Z0),RZ=(typeof X==="function"?BY(X):!1)||!!Q.beforeHandle?.some(BY)||!!Q.afterHandle?.some(BY)||!!Q.transform?.some(BY),E4=Object.keys(W.response??{}),j9=E4.length>1,C8=E4.length===0||E4.length===1&&E4[0]==="200",a1=z.cookie||z.set||t||w||j9||!C8||q&&l||RZ,w0=(f="r")=>`return ${a1?"mapResponse":"mapCompactResponse"}(${L1}${f}${a1?",c.set":""}${d6})
`,d6=RZ||U.mapResponseContext?`,${U.mapResponseContext}`:"";if(w||z.route)G+=`c.route=\`${Z}\`
`;let _8=q1("parse",{total:Q.parse?.length});if(P){let f=!!Q.parse?.length||z.body||W.body;if(U.parser.declare)G+=U.parser.declare;G+=`
try{`;let V=typeof Q.parse==="string"?Q.parse:Array.isArray(Q.parse)&&Q.parse.length===1?typeof Q.parse[0]==="string"?Q.parse[0]:typeof Q.parse[0].fn==="string"?Q.parse[0].fn:void 0:void 0;if(!V&&W.body&&!Q.parse?.length){let B=W.body.schema;if(B&&B.anyOf&&B[L]==="Union"&&B.anyOf?.length===2&&B.anyOf?.find((F)=>F[L]==="ElysiaForm"))V="formdata"}if(V&&yK.includes(V)){let B=q1("parse",{total:Q.parse?.length}),F=!!W.body?.isOptional;switch(V){case"json":case"application/json":G+=U.parser.json(F);break;case"text":case"text/plain":G+=U.parser.text(F);break;case"urlencoded":case"application/x-www-form-urlencoded":G+=U.parser.urlencoded(F);break;case"arrayBuffer":case"application/octet-stream":G+=U.parser.arrayBuffer(F);break;case"formdata":case"multipart/form-data":G+=U.parser.formData(F);break;default:if(V[0]in $["~parser"])G+=t?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",G+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0,index)}
else{contentType=''}c.contentType=contentType
let result=parser['${V}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}B.resolve()}else if(f){G+=`
`;let B=Q.parse?.length?"let":"const";G+=t?`${B} contentType=c.headers['content-type']
`:`${B} contentType=c.request.headers.get('content-type')
`;let F=!1;if(Q.parse?.length)G+=`if(contentType){
const index=contentType.indexOf(';')

if(index!==-1)contentType=contentType.substring(0,index)}else{contentType=''}let used=false
c.contentType=contentType
`;else{F=!0;let I=!!W.body?.isOptional;G+=`if(contentType)switch(contentType.charCodeAt(12)){
case 106:`+U.parser.json(I)+`break
case 120:`+U.parser.urlencoded(I)+`break
case 111:`+U.parser.arrayBuffer(I)+`break
case 114:`+U.parser.formData(I)+`break
default:if(contentType.charCodeAt(0)===116){`+U.parser.text(I)+`}break
}`}let D=q1("parse",{total:Q.parse?.length});if(Q.parse)for(let I=0;I<Q.parse.length;I++){let E=`bo${I}`;if(I!==0)G+=`
if(!used){`;if(typeof Q.parse[I].fn==="string"){let T=D.resolveChild(Q.parse[I].fn),u=!!W.body?.isOptional;switch(Q.parse[I].fn){case"json":case"application/json":F=!0,G+=U.parser.json(u);break;case"text":case"text/plain":F=!0,G+=U.parser.text(u);break;case"urlencoded":case"application/x-www-form-urlencoded":F=!0,G+=U.parser.urlencoded(u);break;case"arrayBuffer":case"application/octet-stream":F=!0,G+=U.parser.arrayBuffer(u);break;case"formdata":case"multipart/form-data":F=!0,G+=U.parser.formData(u);break;default:G+=`let ${E}=parser['${Q.parse[I].fn}'](c,contentType)
if(${E} instanceof Promise)${E}=await ${E}
if(${E}!==undefined){c.body=${E};used=true;}
`}T()}else{let T=D.resolveChild(Q.parse[I].fn.name);G+=`let ${E}=e.parse[${I}]
${E}=${E}(c,contentType)
if(${E} instanceof Promise)${E}=await ${E}
if(${E}!==undefined){c.body=${E};used=true}`,T()}if(I!==0)G+="}";if(F)break}if(D.resolve(),!F){let I=!!W.body?.isOptional;if(Q.parse?.length)G+=`
if(!used){
if(!contentType) throw new ParseError()
`;G+="switch(contentType){",G+=`case 'application/json':
`+U.parser.json(I)+`break
case 'text/plain':`+U.parser.text(I)+`break
case 'application/x-www-form-urlencoded':`+U.parser.urlencoded(I)+`break
case 'application/octet-stream':`+U.parser.arrayBuffer(I)+`break
case 'multipart/form-data':`+U.parser.formData(I)+`break
`;for(let E of Object.keys($["~parser"]))G+=`case '${E}':let bo${E}=parser['${E}'](c,contentType)
if(bo${E} instanceof Promise)bo${E}=await bo${E}
if(bo${E} instanceof ElysiaCustomStatusResponse)throw result
if(bo${E}!==undefined)c.body=bo${E}
break
`;if(Q.parse?.length)G+="}";G+="}"}if(Q.parse?.length)G+=`
delete c.contentType`}G+="}catch(error){throw new ParseError(error)}"}if(_8.resolve(),Q?.transform){let f=q1("transform",{total:Q.transform.length});if(Q.transform.length)G+=`let transformed
`;for(let V=0;V<Q.transform.length;V++){let B=Q.transform[V],F=f.resolveChild(B.fn.name);if(G+=Z0(B)?`transformed=await e.transform[${V}](c)
`:`transformed=e.transform[${V}](c)
`,B.subType==="mapDerive")G+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else G+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else Object.assign(c,transformed)
`;F()}f.resolve()}let e6=[];if(W){if(W.headers){if(W.headers.hasDefault)for(let[f,V]of Object.entries(N1.Default(W.headers.schema,{}))){let B=typeof V==="object"?JSON.stringify(V):typeof V==="string"?`'${V}'`:V;if(B!==void 0)G+=`c.headers['${f}']??=${B}
`}if(G+=p$({name:"c.headers",schema:W.headers,type:"headers",normalize:p}),W.headers.isOptional)G+="if(isNotEmpty(c.headers)){";if(W.body?.schema?.noValidate!==!0)G+="if(validator.headers.Check(c.headers) === false){"+S1.validate("headers")+"}";if(W.headers.hasTransform)G+=`c.headers=validator.headers.Decode(c.headers)
`;if(W.headers.isOptional)G+="}"}if(W.params){if(W.params.hasDefault)for(let[f,V]of Object.entries(N1.Default(W.params.schema,{}))){let B=typeof V==="object"?JSON.stringify(V):typeof V==="string"?`'${V}'`:V;if(B!==void 0)G+=`c.params['${f}']??=${B}
`}if(W.params?.schema?.noValidate!==!0)G+="if(validator.params.Check(c.params)===false){"+S1.validate("params")+"}";if(W.params.hasTransform)G+=`c.params=validator.params.Decode(c.params)
`}if(W.query){if(W.query.hasDefault)for(let[f,V]of Object.entries(N1.Default(W.query.schema,{}))){let B=typeof V==="object"?JSON.stringify(V):typeof V==="string"?`'${V}'`:V;if(B!==void 0)G+=`if(c.query['${f}']===undefined)c.query['${f}']=${B}
`;G+=p$({name:"c.query",schema:W.query,type:"query",normalize:p})}if(W.query.isOptional)G+="if(isNotEmpty(c.query)){";if(W.query?.schema?.noValidate!==!0)G+="if(validator.query.Check(c.query)===false){"+S1.validate("query")+"}";if(W.query.hasTransform)G+=`c.query=validator.query.Decode(Object.assign({},c.query))
`;if(W.query.isOptional)G+="}"}if(P&&W.body){if(W.body.hasTransform||W.body.isOptional)G+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&isNotEmpty(c.body))
`;let f=gK(W.body.schema),V=!1;if(W.body.hasDefault){let B=N1.Default(W.body.schema,W.body.schema.type==="object"||W.body.schema[L]==="Import"&&W.body.schema.$defs[W.body.schema.$ref][L]==="Object"?{}:void 0);if(!f&&B&&typeof B==="object"&&(m8("File",W.body.schema)||m8("Files",W.body.schema))){V=!0;for(let[D,I]of Object.entries(B))if(I==="File"||I==="Files")delete B[D];if(!T1(B))B=void 0}let F=typeof B==="object"?JSON.stringify(B):typeof B==="string"?`'${B}'`:B;if(B!==void 0&&B!==null)if(Array.isArray(B))G+=`if(!c.body)c.body=${F}
`;else if(typeof B==="object")G+=`c.body=Object.assign(${F},c.body)
`;else G+=`c.body=${F}
`;if(G+=p$({name:"c.body",schema:W.body,type:"body",normalize:p}),W.body?.schema?.noValidate!==!0)if(W.body.isOptional)G+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+S1.validate("body")+"}";else G+="if(validator.body.Check(c.body)===false){"+S1.validate("body")+"}"}else if(G+=p$({name:"c.body",schema:W.body,type:"body",normalize:p}),W.body?.schema?.noValidate!==!0)if(W.body.isOptional)G+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+S1.validate("body")+"}";else G+="if(validator.body.Check(c.body)===false){"+S1.validate("body")+"}";if(W.body.hasTransform)G+=`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`;if(f&&W.body.schema.anyOf?.length){let B=Object.values(W.body.schema.anyOf);for(let F=0;F<B.length;F++){let D=B[F];if(m8("File",D)||m8("Files",D)){let I=U0(D,{modules:$.definitions.typebox,dynamic:!$.config.aot,models:$.definitions.type,normalize:$.config.normalize,additionalCoerce:E5(),sanitize:()=>$.config.sanitize});if(I){let E=e6.length===0,T=Object.entries(D.properties),u=E?`
`:" else ";u+=`if(fileUnions[${e6.length}].Check(c.body)){`;let C1="",H0=0;for(let S0=0;S0<T.length;S0++){let[n0,$8]=T[S0];if(!$8.extension||$8[L]!=="File"&&$8[L]!=="Files")continue;if(H0)C1+=",";C1+=`validateFileExtension(c.body.${n0},${JSON.stringify($8.extension)},'body.${n0}')`,H0++}if(C1){if(H0===1)u+=`await ${C1}
`;else if(H0>1)u+=`await Promise.all([${C1}])
`;u+="}",G+=u,e6.push(I)}}}}}else if(V||!f&&(m8("File",W.body.schema)||m8("Files",W.body.schema))){let B="",F=0;for(let[D,I]of Object.entries(W.body.schema.properties)){if(!I.extension||I[L]!=="File"&&I[L]!=="Files")continue;if(F)B+=",";B+=`validateFileExtension(c.body.${D},${JSON.stringify(I.extension)},'body.${D}')`,F++}if(F)G+=`
`;if(F===1)G+=`await ${B}
`;else if(F>1)G+=`await Promise.all([${B}])
`}}if(W.cookie){let f=Qz({modules:$.definitions.typebox,validator:W.cookie,defaultConfig:$.config.cookie,dynamic:!!$.config.aot,config:W.cookie?.config??{},models:$.definitions.type});if(G+=`const cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,f.hasDefault)for(let[V,B]of Object.entries(N1.Default(f.schema,{})))G+=`cookieValue['${V}'] = ${typeof B==="object"?JSON.stringify(B):B}
`;if(f.isOptional)G+="if(isNotEmpty(c.cookie)){";if(W.body?.schema?.noValidate!==!0)G+="if(validator.cookie.Check(cookieValue)===false){"+S1.validate("cookie","cookieValue")+"}";if(f.hasTransform)G+=`for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue)))c.cookie[key].value=value
`;if(f.isOptional)G+="}"}}if(Q?.beforeHandle){let f=q1("beforeHandle",{total:Q.beforeHandle.length}),V=!1;for(let B=0;B<Q.beforeHandle.length;B++){let F=Q.beforeHandle[B],D=f.resolveChild(F.fn.name),I=o$(F);if(F.subType==="resolve"||F.subType==="mapResolve"){if(!V)V=!0,G+=`
let resolved
`;if(G+=Z0(F)?`resolved=await e.beforeHandle[${B}](c);
`:`resolved=e.beforeHandle[${B}](c);
`,F.subType==="mapResolve")G+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else{resolved.request=c.request
resolved.store=c.store
resolved.qi=c.qi
resolved.path=c.path
resolved.url=c.url
resolved.redirect=c.redirect
resolved.set=c.set
resolved.error=c.error
c=resolved}`;else G+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else Object.assign(c, resolved)
`}else if(!I)G+=Z0(F)?`await e.beforeHandle[${B}](c)
`:`e.beforeHandle[${B}](c)
`,D();else{if(G+=Z0(F)?`be=await e.beforeHandle[${B}](c)
`:`be=e.beforeHandle[${B}](c)
`,D("be"),G+="if(be!==undefined){",f.resolve(),Q.afterHandle?.length){q1("handle",{name:q?X.name:void 0}).resolve();let T=q1("afterHandle",{total:Q.afterHandle.length});for(let u=0;u<Q.afterHandle.length;u++){let C1=Q.afterHandle[u],H0=o$(C1),S0=T.resolveChild(C1.fn.name);if(G+=`c.response = be
`,!H0)G+=Z0(C1.fn)?`await e.afterHandle[${u}](c, be)
`:`e.afterHandle[${u}](c, be)
`;else G+=Z0(C1.fn)?`af=await e.afterHandle[${u}](c)
`:`af=e.afterHandle[${u}](c)
`,G+=`if(af!==undefined) c.response=be=af
`;S0("af")}T.resolve()}if(W.response)G+=S1.response("be");let E=q1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){G+=`c.response=be
`;for(let T=0;T<Q.mapResponse.length;T++){let u=Q.mapResponse[T],C1=E.resolveChild(u.fn.name);G+=`if(mr===undefined){mr=${W$(u)?"await ":""}e.mapResponse[${T}](c)
if(mr!==undefined)be=c.response=mr}`,C1()}}E.resolve(),G+=_(),G+=`return mapEarlyResponse(${L1}be,c.set${d6})}
`}}f.resolve()}if(Q.afterHandle?.length){let f=q1("handle",{name:q?X.name:void 0});if(Q.afterHandle.length)G+=A6?`let r=c.response=await ${M}
`:`let r=c.response=${M}
`;else G+=A6?`let r=await ${M}
`:`let r=${M}
`;f.resolve();let V=q1("afterHandle",{total:Q.afterHandle.length});for(let F=0;F<Q.afterHandle.length;F++){let D=Q.afterHandle[F],I=o$(D),E=V.resolveChild(D.fn.name);if(!I)G+=Z0(D.fn)?`await e.afterHandle[${F}](c)
`:`e.afterHandle[${F}](c)
`,E();else if(G+=Z0(D.fn)?`af=await e.afterHandle[${F}](c)
`:`af=e.afterHandle[${F}](c)
`,E("af"),W.response)G+="if(af!==undefined){",V.resolve(),G+=S1.response("af"),G+="c.response=af}";else G+="if(af!==undefined){",V.resolve(),G+="c.response=af}"}if(V.resolve(),G+=`r=c.response
`,W.response)G+=S1.response();G+=_();let B=q1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length)for(let F=0;F<Q.mapResponse.length;F++){let D=Q.mapResponse[F],I=B.resolveChild(D.fn.name);G+=`mr=${W$(D)?"await ":""}e.mapResponse[${F}](c)
if(mr!==undefined)r=c.response=mr
`,I()}B.resolve(),G+=w0()}else{let f=q1("handle",{name:q?X.name:void 0});if(W.response||Q.mapResponse?.length){if(G+=A6?`let r=await ${M}
`:`let r=${M}
`,f.resolve(),W.response)G+=S1.response();q1("afterHandle").resolve();let V=q1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){G+=`
c.response=r
`;for(let B=0;B<Q.mapResponse.length;B++){let F=Q.mapResponse[B],D=V.resolveChild(F.fn.name);G+=`
if(mr===undefined){mr=${W$(F)?"await ":""}e.mapResponse[${B}](c)
if(mr!==undefined)r=c.response=mr}
`,D()}}if(V.resolve(),G+=_(),X instanceof Response)G+=z.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${L1}${M}.clone(),c.set${d6})else return ${M}.clone()`:`return ${M}.clone()`,G+=`
`;else G+=w0()}else if(k||w){G+=A6?`let r=await ${M}
`:`let r=${M}
`,f.resolve(),q1("afterHandle").resolve();let V=q1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){G+=`c.response= r
`;for(let B=0;B<Q.mapResponse.length;B++){let F=Q.mapResponse[B],D=V.resolveChild(F.fn.name);G+=`if(mr===undefined){mr=${W$(F)?"await ":""}e.mapResponse[${B}](c)
if(mr!==undefined)r=c.response=mr}`,D()}}V.resolve(),G+=_()+w0()}else{f.resolve();let V=A6?`await ${M}`:M;if(q1("afterHandle").resolve(),X instanceof Response)G+=z.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${L1}${M}.clone(),c.set${d6})
else return ${M}.clone()
`:`return ${M}.clone()
`;else G+=w0(V)}}if(G+=`
}catch(error){`,!X4&&Q.error?.length)G+="return(async()=>{";if(G+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,k)G+=_();if(w&&Q.trace)for(let f=0;f<Q.trace.length;f++)G+=`report${f}?.resolve(error);reportChild${f}?.(error)
`;let V8=q1("error",{total:Q.error?.length});if(Q.error?.length){if(G+=`c.error=error
`,N)G+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else G+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;G+=`let er
`;for(let f=0;f<Q.error.length;f++){let V=V8.resolveChild(Q.error[f].fn.name);if(Z0(Q.error[f]))G+=`er=await e.error[${f}](c)
`;else G+=`er=e.error[${f}](c)
if(er instanceof Promise)er=await er
`;V();let B=q1("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length)for(let F=0;F<Q.mapResponse.length;F++){let D=Q.mapResponse[F],I=B.resolveChild(D.fn.name);G+=`c.response=er
er=e.mapResponse[${F}](c)
if(er instanceof Promise)er=await er
`,I()}if(B.resolve(),G+=`er=mapEarlyResponse(er,set${d6})
`,G+="if(er){",w&&Q.trace){for(let F=0;F<Q.trace.length;F++)G+=`report${F}.resolve()
`;V8.resolve()}G+="return er}"}}if(V8.resolve(),G+="return handleError(c,error,true)",!X4&&Q.error?.length)G+="})()";if(G+="}",H||w){if(G+="finally{ ",!X4)G+=";(async()=>{";let f=q1("afterResponse",{total:Q.afterResponse?.length});if(H&&Q.afterResponse)for(let V=0;V<Q.afterResponse.length;V++){let B=f.resolveChild(Q.afterResponse[V].fn.name);G+=`
await e.afterResponse[${V}](c)
`,B()}if(f.resolve(),!X4)G+="})()";G+="}"}let jZ=U.inject?Object.keys(U.inject).join(",")+",":"",E8="const {handler,handleError,hooks:e, "+n1("validator,",N)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+n1("parseQuery,",P)+n1("parseQueryFromURL,",O)+"},error:{"+n1("ValidationError,",N)+n1("ParseError",P)+"},validateFileExtension,schema,definitions,ERROR_CODE,"+n1("parseCookie,",k)+n1("signCookie,",k)+n1("decodeURIComponent,",O)+"ElysiaCustomStatusResponse,"+n1("ELYSIA_TRACE,",w)+n1("ELYSIA_REQUEST_ID,",w)+n1("parser,",Q.parse?.length)+n1("getServer,",z.server)+n1("fileUnions,",e6.length)+jZ+n1("TypeBoxError",N)+`}=hooks
const trace=e.trace
return ${X4?"async ":""}function handle(c){`;if(Q.beforeHandle?.length)E8+=`let be
`;if(Q.afterHandle?.length)E8+=`let af
`;if(Q.mapResponse?.length)E8+=`let mr
`;if(J)E8+=`c.schema=schema
c.defs=definitions
`;G=E8+G+"}",E8="";try{return Function("hooks",`"use strict";
`+G)({handler:X,hooks:NJ({...Q}),validator:N?W:void 0,handleError:$.handleError,mapResponse:S.mapResponse,mapCompactResponse:S.mapCompactResponse,mapEarlyResponse:S.mapEarlyResponse,isNotEmpty:T1,utils:{parseQuery:P?HY:void 0,parseQueryFromURL:O?VK:void 0},error:{ValidationError:N?j1:void 0,ParseError:P?iJ:void 0},validateFileExtension:HK,schema:$.router.history,definitions:$.definitions.type,ERROR_CODE:OY,parseCookie:k?sJ:void 0,signCookie:k?LY:void 0,decodeURIComponent:O?_K.default:void 0,ElysiaCustomStatusResponse:V0,ELYSIA_TRACE:w?xY:void 0,ELYSIA_REQUEST_ID:w?a$:void 0,getServer:()=>$.getServer(),fileUnions:e6.length?e6:void 0,TypeBoxError:N?i:void 0,parser:$["~parser"],...U.inject})}catch(f){let V=NJ(Q);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof X==="function"?X.toString():X,instruction:G,hooks:{...V,transform:V?.transform?.map?.((B)=>B.toString()),resolve:V?.resolve?.map?.((B)=>B.toString()),beforeHandle:V?.beforeHandle?.map?.((B)=>B.toString()),afterHandle:V?.afterHandle?.map?.((B)=>B.toString()),mapResponse:V?.mapResponse?.map?.((B)=>B.toString()),parse:V?.parse?.map?.((B)=>B.toString()),error:V?.error?.map?.((B)=>B.toString()),afterResponse:V?.afterResponse?.map?.((B)=>B.toString()),stop:V?.stop?.map?.((B)=>B.toString())},validator:W,definitions:$.definitions.type,error:f}),console.log("---"),process.exit(1)}},Wz=($,Z)=>{let Y="",Q=y5({trace:$.event.trace,addFn:Z??((W)=>{Y+=W})})("request",{total:$.event.request?.length});if($.event.request?.length){Y+="try{";for(let W=0;W<$.event.request.length;W++){let X=$.event.request[W],J=o$(X),z=Z0(X),U=Q.resolveChild($.event.request[W].fn.name);if(J)Y+=`re=mapEarlyResponse(${z?"await ":""}onRequest[${W}](c),c.set)
`,U("re"),Y+=`if(re!==undefined)return re
`;else Y+=`${z?"await ":""}onRequest[${W}](c)
`,U()}Y+="}catch(error){return app.handleError(c,error,false)}"}return Q.resolve(),Y},Xz=($,Z="map")=>{let Y=$.extender.higherOrderFunctions;if(!Y.length)return"return "+Z;let Q=$["~adapter"].composeGeneralHandler,W=Z;for(let X=0;X<Y.length;X++)W=`hoc[${X}](${W},${Q.parameters})`;return`return function hocMap(${Q.parameters}){return ${W}(${Q.parameters})}`},L5=($)=>{let Z=$["~adapter"].composeGeneralHandler;$.router.http.build();let Y=Z.error404(!!$.event.request?.length,!!$.event.error?.length),Q=$.event.trace?.length,W="",X=$.router,J=X.http.root.WS?`const route=router.find(r.method === "GET" && r.headers.get('upgrade')==='websocket'?'WS':r.method,p)`:"const route=router.find(r.method,p)";J+=X.http.root.ALL?`??router.find("ALL",p)
`:`
`,J+=Y.code,J+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return route.store.compile()(c)
`;let z="";for(let[M,H]of Object.entries(X.static)){if(z+=`case'${M}':`,$.config.strictPath!==!0)z+=`case'${u$(M)}':`;let w=c$(M);if(M!==w)z+=`case'${w}':`;if(z+="switch(r.method){","GET"in H||"WS"in H){if(z+="case 'GET':","WS"in H)z+=`if(r.headers.get('upgrade')==='websocket')return ht[${H.WS}].composed(c)
`;if("GET"in H)z+=`return ht[${H.GET}].composed(c)
`}for(let[G,N]of Object.entries(H)){if(G==="ALL"||G==="GET"||G==="WS")continue;z+=`case '${G}':return ht[${N}].composed(c)
`}if("ALL"in H)z+=`default:return ht[${H.ALL}].composed(c)
`;else z+=`default:break map
`;z+="}"}let U=!!$.event.request?.some(Z0),S=Z.inject?Object.keys(Z.inject).join(",")+",":"";if(W+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,status,redirect,`+n1("ELYSIA_TRACE,",Q)+n1("ELYSIA_REQUEST_ID,",Q)+S+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,$.event.request?.length)W+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(W+=Y.declare,$.event.trace?.length)W+="const "+$.event.trace.map((M,H)=>`tr${H}=app.event.trace[${H}].fn`).join(",")+`
`;if(W+=`${U?"async ":""}function map(${Z.parameters}){`,$.event.request?.length)W+=`let re
`;if(W+=Z.createContext($),$.event.trace?.length)W+="c[ELYSIA_TRACE]=["+$.event.trace.map((M,H)=>`tr${H}(c)`).join(",")+`]
`;if(W+=Wz($),z)W+=`
map: switch(p){
`+z+"}";W+=J+`}
`+Xz($),$.handleError=Jz($);let q=Function("data",`"use strict";
`+W)({app:$,mapEarlyResponse:$["~adapter"].handler.mapEarlyResponse,NotFoundError:k5,randomId:IY,handleError:$.handleError,status:FY,redirect:x5,ELYSIA_TRACE:Q?xY:void 0,ELYSIA_REQUEST_ID:Q?a$:void 0,...Z.inject});if(J$)Bun.gc(!1);return q},Jz=($)=>{let Z=$.event,Y="",Q=$["~adapter"].composeError,W=Q.inject?Object.keys(Q.inject).join(",")+",":"",X=!!$.event.trace?.length;if(Y+="const {mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+n1("onError,",$.event.error)+n1("afterResponse,",$.event.afterResponse)+n1("trace,",$.event.trace)+n1("onMapResponse,",$.event.mapResponse)+n1("ELYSIA_TRACE,",X)+n1("ELYSIA_REQUEST_ID,",X)+W+`}=inject
`,Y+=`return ${$.event.error?.find(Z0)||$.event.mapResponse?.find(Z0)?"async ":""}function(context,error,skipGlobal){`,Y+="",X)Y+=`const id=context[ELYSIA_REQUEST_ID]
`;let J=y5({context:"context",trace:Z.trace,addFn:(q)=>{Y+=q}});if(Y+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,Q.declare)Y+=Q.declare;let z=X||!!Z.afterResponse?.length||!!Z.afterResponse?.length?"context.response = ":"";if($.event.error)for(let q=0;q<$.event.error.length;q++){let M=$.event.error[q],H=`${Z0(M)?"await ":""}onError[${q}](context)
`;if(Y+="if(skipGlobal!==true){",o$(M)){Y+=`_r=${H}
if(_r!==undefined){if(_r instanceof Response)return mapResponse(_r,set${Q.mapResponseContext})
if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let w=J("mapResponse",{total:Z.mapResponse?.length,name:"context"});if(Z.mapResponse?.length)for(let G=0;G<Z.mapResponse.length;G++){let N=Z.mapResponse[G],O=w.resolveChild(N.fn.name);Y+=`context.response=_r_r=${W$(N)?"await ":""}onMapResponse[${G}](context)
`,O()}w.resolve(),Y+=`return mapResponse(${z}_r,set${Q.mapResponseContext})}`}else Y+=H;Y+="}"}Y+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){
if(error.error)error=error.error
set.status=error.status??422
`+Q.validationError+`
}
`,Y+=`if(error instanceof Error){
if(typeof error.toResponse==='function')return context.response=error.toResponse()
`+Q.unknownError+`
}`;let U=J("mapResponse",{total:Z.mapResponse?.length,name:"context"});if(Y+=`
if(!context.response)context.response=error.message??error
`,Z.mapResponse?.length){Y+=`let mr
`;for(let q=0;q<Z.mapResponse.length;q++){let M=Z.mapResponse[q],H=U.resolveChild(M.fn.name);Y+=`if(mr===undefined){mr=${W$(M)?"await ":""}onMapResponse[${q}](context)
if(mr!==undefined)error=context.response=mr}`,H()}}U.resolve(),Y+=`
return mapResponse(${z}error,set${Q.mapResponseContext})}`;let S=(q)=>typeof q==="function"?q:q.fn;return Function("inject",`"use strict";
`+Y)({mapResponse:$["~adapter"].handler.mapResponse,ERROR_CODE:OY,ElysiaCustomStatusResponse:V0,onError:$.event.error?.map(S),afterResponse:$.event.afterResponse?.map(S),trace:$.event.trace?.map(S),onMapResponse:$.event.mapResponse?.map(S),ELYSIA_TRACE:X?xY:void 0,ELYSIA_REQUEST_ID:X?a$:void 0,...Q.inject})},_0=($,Z,Y)=>{if(T1(Z.headers)||Z.status!==200||Z.cookie)switch(bY(Z),$?.constructor?.name){case"String":return new Response($,Z);case"Array":case"Object":return Z.headers["content-type"]="application/json",new Response(JSON.stringify($),Z);case"ElysiaFile":return y1($.value);case"File":return y1($,Z);case"Blob":return y1($,Z);case"ElysiaCustomStatusResponse":return Z.status=$.code,_0($.response,Z,Y);case"ReadableStream":if(!Z.headers["content-type"]?.startsWith("text/event-stream"))Z.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,Z);case void 0:if(!$)return new Response("",Z);return new Response(JSON.stringify($),Z);case"Response":return _Y($,Z,Y);case"Error":return c8($,Z);case"Promise":return $.then((Q)=>_0(Q,Z,Y));case"Function":return _0($(),Z,Y);case"Number":case"Boolean":return new Response($.toString(),Z);case"Cookie":if($ instanceof K8)return new Response($.value,Z);return new Response($?.toString(),Z);case"FormData":return new Response($,Z);default:if($ instanceof Response)return _Y($,Z,Y);if($ instanceof Promise)return $.then((Q)=>_0(Q,Z));if($ instanceof Error)return c8($,Z);if($ instanceof V0)return Z.status=$.code,_0($.response,Z,Y);if(typeof $?.next==="function")return i8($,Z,Y);if(typeof $?.then==="function")return $.then((Q)=>_0(Q,Z));if(typeof $?.toResponse==="function")return _0($.toResponse(),Z);if("charCodeAt"in $){let Q=$.charCodeAt(0);if(Q===123||Q===91){if(!Z.headers["Content-Type"])Z.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),Z)}}return new Response($,Z)}if($ instanceof Response&&!$.headers.has("content-length")&&$.headers.get("transfer-encoding")==="chunked")return i8(n8($),l8($,Z),Y);if(typeof $?.next==="function"||$ instanceof ReadableStream)return i8($,Z,Y);return P8($,Y)},C0=($,Z,Y)=>{if($===void 0||$===null)return;if(T1(Z.headers)||Z.status!==200||Z.cookie)switch(bY(Z),$?.constructor?.name){case"String":return new Response($,Z);case"Array":case"Object":return Z.headers["content-type"]="application/json",new Response(JSON.stringify($),Z);case"ElysiaFile":return y1($.value);case"File":return y1($,Z);case"Blob":return y1($,Z);case"ElysiaCustomStatusResponse":return Z.status=$.code,C0($.response,Z,Y);case"ReadableStream":if(!Z.headers["content-type"]?.startsWith("text/event-stream"))Z.headers["content-type"]="text/event-stream; charset=utf-8";return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,Z);case void 0:if(!$)return;return new Response(JSON.stringify($),Z);case"Response":return _Y($,Z,Y);case"Promise":return $.then((Q)=>C0(Q,Z));case"Error":return c8($,Z);case"Function":return C0($(),Z);case"Number":case"Boolean":return new Response($.toString(),Z);case"FormData":return new Response($);case"Cookie":if($ instanceof K8)return new Response($.value,Z);return new Response($?.toString(),Z);default:if($ instanceof Response)return _Y($,Z,Y);if($ instanceof Promise)return $.then((Q)=>C0(Q,Z));if($ instanceof Error)return c8($,Z);if($ instanceof V0)return Z.status=$.code,C0($.response,Z,Y);if(typeof $?.next==="function")return i8($,Z,Y);if(typeof $?.then==="function")return $.then((Q)=>C0(Q,Z));if(typeof $?.toResponse==="function")return C0($.toResponse(),Z);if("charCodeAt"in $){let Q=$.charCodeAt(0);if(Q===123||Q===91){if(!Z.headers["Content-Type"])Z.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),Z)}}return new Response($,Z)}else switch($?.constructor?.name){case"String":return new Response($);case"Array":case"Object":return Z.headers["content-type"]="application/json",new Response(JSON.stringify($),Z);case"ElysiaFile":return y1($.value);case"File":return y1($,Z);case"Blob":return y1($,Z);case"ElysiaCustomStatusResponse":return Z.status=$.code,C0($.response,Z,Y);case"ReadableStream":return Y?.signal?.addEventListener("abort",{handleEvent(){if(Y?.signal&&!Y?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":if(!$.headers.has("content-length")&&$.headers.get("transfer-encoding")==="chunked")return i8(n8($),l8($),Y);return $;case"Promise":return $.then((Q)=>{let W=C0(Q,Z);if(W!==void 0)return W});case"Error":return c8($,Z);case"Function":return P8($(),Y);case"Number":case"Boolean":return new Response($.toString());case"Cookie":if($ instanceof K8)return new Response($.value,Z);return new Response($?.toString(),Z);case"FormData":return new Response($);default:if($ instanceof Response)return $;if($ instanceof Promise)return $.then((Q)=>C0(Q,Z));if($ instanceof Error)return c8($,Z);if($ instanceof V0)return Z.status=$.code,C0($.response,Z,Y);if(typeof $?.next==="function")return i8($,Z,Y);if(typeof $?.then==="function")return $.then((Q)=>C0(Q,Z));if(typeof $?.toResponse==="function")return C0($.toResponse(),Z);if("charCodeAt"in $){let Q=$.charCodeAt(0);if(Q===123||Q===91){if(!Z.headers["Content-Type"])Z.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),Z)}}return new Response($)}},P8=($,Z)=>{switch($?.constructor?.name){case"String":return new Response($);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"Content-Type":"application/json"}});case"ElysiaFile":return y1($.value);case"File":return y1($);case"Blob":return y1($);case"ElysiaCustomStatusResponse":return _0($.response,{status:$.code,headers:{}});case"ReadableStream":return Z?.signal?.addEventListener("abort",{handleEvent(){if(Z?.signal&&!Z?.signal?.aborted)$.cancel()}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":if($.headers.get("transfer-encoding")==="chunked")return i8(n8($),l8($),Z);return $;case"Error":return c8($);case"Promise":return $.then((Y)=>P8(Y,Z));case"Function":return P8($(),Z);case"Number":case"Boolean":return new Response($.toString());case"FormData":return new Response($);default:if($ instanceof Response)return $;if($ instanceof Promise)return $.then((Y)=>P8(Y,Z));if($ instanceof Error)return c8($);if($ instanceof V0)return _0($.response,{status:$.code,headers:{}});if(typeof $?.next==="function")return i8($,void 0,Z);if(typeof $?.then==="function")return $.then((Y)=>_0(Y,set));if(typeof $?.toResponse==="function")return P8($.toResponse());if("charCodeAt"in $){let Y=$.charCodeAt(0);if(Y===123||Y===91)return new Response(JSON.stringify($),{headers:{"Content-Type":"application/json"}})}return new Response($)}},c8=($,Z)=>new Response(JSON.stringify({name:$?.name,message:$?.message,cause:$?.cause}),{status:Z?.status!==200?Z?.status??500:500,headers:Z?.headers}),uK=($,Z,Y={})=>{if(typeof $==="function")return;let Q=_0($,{headers:Y});if(!Z.parse?.length&&!Z.transform?.length&&!Z.beforeHandle?.length&&!Z.afterHandle?.length)return Q.clone.bind(Q)},_Y=eJ({mapResponse:_0,mapCompactResponse:P8}),i8=f5({mapResponse:_0,mapCompactResponse:P8}),O8=($,Z)=>Z?$:"",TJ=($,Z,Y,Q=!1)=>{let W="",X=$.setHeaders,J=!!$.event.trace?.length;if(J)W+=`const id=randomId()
`;let z=/[:*]/.test(Z.path),U=`const u=request.url,s=u.indexOf('/',${$.config.handler?.standardHostname??!0?11:7}),qi=u.indexOf('?', s + 1)
`;if(Y.query)W+=U;let S=!Y.path?"":!z?`path:'${Z.path}',`:"get path(){"+(Y.query?"":U)+`if(qi===-1)return u.substring(s)
return u.substring(s,qi)
},`;if(W+=O8("const c=",!Q)+"{request,store,"+O8("qi,",Y.query)+O8("params:request.params,",z)+S+O8("url:request.url,",J||Y.url||Y.query)+"redirect,error:status,status,set:{headers:"+(T1(X)?"Object.assign({},app.setHeaders)":"Object.create(null)")+",status:200}",Y.server)W+=",get server(){return app.getServer()}";if(J)W+=",[ELYSIA_REQUEST_ID]:id";{let q="";for(let M of Object.keys($.singleton.decorator))q+=`,'${M}':decorator['${M}']`;W+=q}return W+=`}
`,W},O5=($,Z)=>{let Y=!!$.event.trace?.length,Q=!!$.extender.higherOrderFunctions.length,W=r$(Z.hooks,$.inference);W=r$({handler:Z.handler},W);let X="const handler=data.handler,app=data.app,store=data.store,decorator=data.decorator,redirect=data.redirect,route=data.route,mapEarlyResponse=data.mapEarlyResponse,"+O8("randomId=data.randomId,",Y)+O8("ELYSIA_REQUEST_ID=data.ELYSIA_REQUEST_ID,",Y)+O8("ELYSIA_TRACE=data.ELYSIA_TRACE,",Y)+O8("trace=data.trace,",Y)+O8("hoc=data.hoc,",Q)+`status=data.status
`;if($.event.request?.length)X+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(X+=`${$.event.request?.find(Z0)?"async":""} function map(request){`,Y||W.query||$.event.request?.length)X+=TJ($,Z,W),X+=Wz($),X+="return handler(c)}";else X+=`return handler(${TJ($,Z,W,!0)})}`;return X+=Xz($),Function("data",X)({app:$,handler:Z.compile?.()??Z.composed,redirect:x5,status:FY,hoc:$.extender.higherOrderFunctions.map((J)=>J.fn),store:$.store,decorator:$.decorator,route:Z.path,randomId:Y?IY:void 0,ELYSIA_TRACE:Y?xY:void 0,ELYSIA_REQUEST_ID:Y?a$:void 0,trace:Y?$.event.trace?.map((J)=>J?.fn??J):void 0,mapEarlyResponse:C0})},cK=($,Z,Y={})=>{if(typeof $==="function"||$ instanceof Blob)return;if(typeof $==="object"&&$?.toString()==="[object HTMLBundle]")return()=>$;let Q=_0($,{headers:Y});if(!Z.parse?.length&&!Z.transform?.length&&!Z.beforeHandle?.length&&!Z.afterHandle?.length){if(Q instanceof Promise)return Q.then((W)=>{if(!W)return;if(!W.headers.has("content-type"))W.headers.append("content-type","text/plain");return W.clone()});if(!Q.headers.has("content-type"))Q.headers.append("content-type","text/plain");return Q.clone.bind(Q)}},bJ={open($){$.data.open?.($)},message($,Z){$.data.message?.($,Z)},drain($){$.data.drain?.($)},close($,Z,Y){$.data.close?.($,Z,Y)}};class i${raw;data;body;validator;["~types"];get id(){return this.data.id}constructor($,Z,Y=void 0){this.raw=$,this.data=Z,this.body=Y,this.validator=$.data?.validator,this.sendText=$.sendText.bind($),this.sendBinary=$.sendBinary.bind($),this.close=$.close.bind($),this.terminate=$.terminate.bind($),this.publishText=$.publishText.bind($),this.publishBinary=$.publishBinary.bind($),this.subscribe=$.subscribe.bind($),this.unsubscribe=$.unsubscribe.bind($),this.isSubscribed=$.isSubscribed.bind($),this.cork=$.cork.bind($),this.remoteAddress=$.remoteAddress,this.binaryType=$.binaryType,this.data=$.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send($,Z){if(Buffer.isBuffer($))return this.raw.send($,Z);if(this.validator?.Check($)===!1)return this.raw.send(new j1("message",this.validator,$).message);if(typeof $==="object")$=JSON.stringify($);return this.raw.send($,Z)}ping($){if(Buffer.isBuffer($))return this.raw.ping($);if(this.validator?.Check($)===!1)return this.raw.send(new j1("message",this.validator,$).message);if(typeof $==="object")$=JSON.stringify($);return this.raw.ping($)}pong($){if(Buffer.isBuffer($))return this.raw.pong($);if(this.validator?.Check($)===!1)return this.raw.send(new j1("message",this.validator,$).message);if(typeof $==="object")$=JSON.stringify($);return this.raw.pong($)}publish($,Z,Y){if(Buffer.isBuffer(Z))return this.raw.publish($,Z,Y);if(this.validator?.Check(Z)===!1)return this.raw.send(new j1("message",this.validator,Z).message);if(typeof Z==="object")Z=JSON.stringify(Z);return this.raw.publish($,Z,Y)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}}var pK=($)=>{let Z=typeof $==="function"?[$]:$;return async function Y(Q,W){if(typeof W==="string"){let X=W?.charCodeAt(0);if(X===34||X===47||X===91||X===123)try{W=JSON.parse(W)}catch{}else if(b5(W))W=+W;else if(W==="true")W=!0;else if(W==="false")W=!1;else if(W==="null")W=null}if(Z)for(let X=0;X<Z.length;X++){let J=Z[X](Q,W);if(J instanceof Promise)J=await J;if(J!==void 0)return J}return W}},iK=($)=>{let Z=(Y,Q)=>{if(Q instanceof Promise)return Q.then((J)=>Z(Y,J));if(Buffer.isBuffer(Q))return Y.send(Q.toString());if(Q===void 0)return;let W=(J)=>{if($?.Check(J)===!1)return Y.send(new j1("message",$,J).message);if(typeof J==="object")return Y.send(JSON.stringify(J));Y.send(J)};if(typeof Q?.next!=="function")return void W(Q);let X=Q.next();if(X instanceof Promise)return(async()=>{let J=await X;if($?.Check(J)===!1)return Y.send(new j1("message",$,J).message);if(W(J.value),!J.done)for await(let z of Q)W(z)})();if(W(X.value),!X.done)for(let J of Q)W(J)};return Z},lK=/:.+?\?(?=\/|$)/,zz=($)=>{let Z=lK.exec($);if(!Z)return[$];let Y=[],Q=$.slice(0,Z.index),W=Z[0].slice(0,-1),X=$.slice(Z.index+Z[0].length);Y.push(Q.slice(0,-1)),Y.push(Q+W);for(let J of zz(X)){if(!J)continue;if(!J.startsWith("/:"))Y.push(Q.slice(0,-1)+J);Y.push(Q+W+J)}return Y},Uz={GET:!0,HEAD:!0,OPTIONS:!0,DELETE:!0,PATCH:!0,POST:!0,PUT:!0},F5=($)=>{if(!$.config.aot||!$.config.systemRouter)return;let Z={},Y=(W,X)=>{if(Z[W.path]){if(!Z[W.path][W.method])Z[W.path][W.method]=X}else Z[W.path]={[W.method]:X}},Q=$.routeTree;for(let W of $.router.history){if(typeof W.handler!=="function")continue;let X=W.method;if(X==="GET"&&`WS_${W.path}`in Q||X==="WS"||W.path.charCodeAt(W.path.length-1)===42||!(X in Uz))continue;if(X==="ALL"){if(!(`WS_${W.path}`in Q))Z[W.path]=W.hooks?.config?.mount?W.hooks.trace||$.event.trace||$.extender.higherOrderFunctions?O5($,W):W.hooks.mount||W.handler:W.handler;continue}let J,z=$.config.precompile?O5($,W):(U)=>{if(J)return J(U);return(J=O5($,W))(U)};for(let U of zz(W.path))Y({method:X,path:U},z)}return Z},Y$=($,Z)=>{if(!Z)return $;for(let Y of Object.keys(Z)){if($[Y]===Z[Y])continue;if(!$[Y]){$[Y]=Z[Y];continue}if($[Y]&&Z[Y]){if(typeof $[Y]==="function"||$[Y]instanceof Response){$[Y]=Z[Y];continue}$[Y]={...$[Y],...Z[Y]}}}return $},nK={..._5,name:"bun",handler:{mapResponse:_0,mapEarlyResponse:C0,mapCompactResponse:P8,createStaticHandler:uK,createNativeStaticHandler:cK},composeHandler:{..._5.composeHandler,headers:NY?`c.headers=c.request.headers.toJSON()
`:`c.headers={}
for(const [k,v] of c.request.headers.entries())c.headers[k]=v
`},listen($){return(Z,Y)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if($.compile(),typeof Z==="string"){if(!b5(Z))throw new Error("Port must be a numeric value");Z=parseInt(Z)}let Q=(X,{withAsync:J=!1}={})=>{let z={},U=[];for(let[S,q]of Object.entries(X))if(pJ){if(!q)continue;for(let[M,H]of Object.entries(q)){if(!H||!(M in Uz))continue;if(H instanceof Promise){if(J){if(!z[S])z[S]={};U.push(H.then((w)=>{if(w instanceof Response)z[S][M]=w}))}continue}if(!(H instanceof Response))continue;if(!z[S])z[S]={};z[S][M]=H}}else{if(!q)continue;if(q instanceof Promise){if(J){if(!z[S])z[S]={};U.push(q.then((M)=>{if(M instanceof Response)z[S]=M}))}continue}if(!(q instanceof Response))continue;z[S]=q}if(J)return Promise.all(U).then(()=>z);return z},W=typeof Z==="object"?{development:!s$,reusePort:!0,...$.config.serve||{},...Z||{},routes:Y$(Y$(Q($.router.response),F5($)),$.config.serve?.routes),websocket:{...$.config.websocket||{},...bJ||{}},fetch:$.fetch}:{development:!s$,reusePort:!0,...$.config.serve||{},routes:Y$(Y$(Q($.router.response),F5($)),$.config.serve?.routes),websocket:{...$.config.websocket||{},...bJ||{}},port:Z,fetch:$.fetch};if($.server=Bun.serve(W),$.event.start)for(let X=0;X<$.event.start.length;X++)$.event.start[X].fn($);if(Y)Y($.server);process.on("beforeExit",()=>{if($.server){if($.server.stop?.(),$.server=null,$.event.stop)for(let X=0;X<$.event.stop.length;X++)$.event.stop[X].fn($)}}),$.promisedModules.then(async()=>{$.server?.reload({...W,fetch:$.fetch,routes:Y$(Y$(await Q($.router.response,{withAsync:!0}),F5($)),$.config.serve?.routes)}),Bun?.gc(!1)})}},ws($,Z,Y){let{parse:Q,body:W,response:X,...J}=Y,z=U0(W,{modules:$.definitions.typebox,models:$.definitions.type,normalize:$.config.normalize}),U=U0(X,{modules:$.definitions.typebox,models:$.definitions.type,normalize:$.config.normalize});$.route("WS",Z,async(S)=>{let q=$.getServer(),{set:M,path:H,qi:w,headers:G,query:N,params:O}=S;if(S.validator=U,Y.upgrade){if(typeof Y.upgrade==="function"){let k=Y.upgrade(S);if(k instanceof Promise)await k}else if(Y.upgrade)Object.assign(M.headers,Y.upgrade)}if(M.cookie&&T1(M.cookie)){let k=rJ(M.cookie);if(k)M.headers["set-cookie"]=k}if(M.headers["set-cookie"]&&Array.isArray(M.headers["set-cookie"]))M.headers=aJ(new Headers(M.headers),M.headers["set-cookie"]);let m=iK(U),P=pK(Q),b,l=[...Array.isArray(Y.error)?Y.error:[Y.error],...($.event.error??[]).map((k)=>typeof k==="function"?k:k.fn)].filter((k)=>k),t=!l.length?()=>{}:async(k,x)=>{for(let v of l){let _=v(Object.assign(S,{error:x}));if(_ instanceof Promise)_=await _;if(await m(k,_),_)break}};if(q?.upgrade(S.request,{headers:T1(M.headers)?M.headers:void 0,data:{...S,get id(){if(b)return b;return b=IY()},validator:U,ping(k){Y.ping?.(k)},pong(k){Y.pong?.(k)},open(k){try{m(k,Y.open?.(new i$(k,S)))}catch(x){t(k,x)}},message:async(k,x)=>{let v=await P(k,x);if(z?.Check(v)===!1)return void k.send(new j1("message",z,v).message);try{m(k,Y.message?.(new i$(k,S,v),v))}catch(_){t(k,_)}},drain(k){try{m(k,Y.drain?.(new i$(k,S)))}catch(x){t(k,x)}},close(k,x,v){try{m(k,Y.close?.(new i$(k,S),x,v))}catch(_){t(k,_)}}}}))return;return M.status=400,"Expected a websocket connection"},{...J,websocket:Y})}},xJ=J$?Bun.env:typeof process!=="undefined"&&process?.env?process.env:{},P5=($,Z)=>{for(let[Y,Q]of Object.entries($.schema.properties))Z[Y]??=Q.default},kJ=($)=>{let{mapResponse:Z,mapEarlyResponse:Y}=$["~adapter"].handler;return async(Q)=>{let W=Q.url,X=W.indexOf("/",11),J=W.indexOf("?",X+1),z=J===-1?W.substring(X):W.substring(X,J),U={cookie:{},status:200,headers:{}},S=Object.assign({},$.singleton.decorator,{set:U,store:$.singleton.store,request:Q,path:z,qi:J,error:FY,status:FY,redirect:x5});try{if($.event.request)for(let x=0;x<$.event.request.length;x++){let v=$.event.request[x].fn,_=v(S);if(_ instanceof Promise)_=await _;if(_=Y(_,U),_)return S.response=_}let q=$.router.dynamic.find(Q.method,z)??$.router.dynamic.find("ALL",z);if(!q)throw new k5;let{handle:M,hooks:H,validator:w,content:G,route:N}=q.store,O;if(Q.method!=="GET"&&Q.method!=="HEAD")if(G)switch(G){case"application/json":O=await Q.json();break;case"text/plain":O=await Q.text();break;case"application/x-www-form-urlencoded":O=HY(await Q.text());break;case"application/octet-stream":O=await Q.arrayBuffer();break;case"multipart/form-data":O={};let x=await Q.formData();for(let v of x.keys()){if(O[v])continue;let _=x.getAll(v);if(_.length===1)O[v]=_[0];else O[v]=_}break}else{let x=Q.headers.get("content-type");if(x){let v=x.indexOf(";");if(v!==-1)x=x.slice(0,v);if(S.contentType=x,H.parse)for(let _=0;_<H.parse.length;_++){let p=H.parse[_].fn,$1=p(S,x);if($1 instanceof Promise)$1=await $1;if($1){O=$1;break}}if(delete S.contentType,O===void 0)switch(x){case"application/json":O=await Q.json();break;case"text/plain":O=await Q.text();break;case"application/x-www-form-urlencoded":O=HY(await Q.text());break;case"application/octet-stream":O=await Q.arrayBuffer();break;case"multipart/form-data":O={};let _=await Q.formData();for(let p of _.keys()){if(O[p])continue;let $1=_.getAll(p);if($1.length===1)O[p]=$1[0];else O[p]=$1}break}}}S.route=N,S.body=O,S.params=q?.params||void 0,S.query=J===-1?{}:HY(W.substring(J+1)),S.headers={};for(let[x,v]of Q.headers.entries())S.headers[x]=v;let m=Object.assign({},$.config?.cookie,w?.cookie?.config),P=Q.headers.get("cookie");S.cookie=await sJ(S.set,P,m?{secrets:m.secrets!==void 0?typeof m.secrets==="string"?m.secrets:m.secrets.join(","):void 0,sign:m.sign===!0?!0:m.sign!==void 0?typeof m.sign==="string"?m.sign:m.sign.join(","):void 0}:void 0);let b=w?.createHeaders?.();if(b)P5(b,S.headers);let l=w?.createParams?.();if(l)P5(l,S.params);let t=w?.createQuery?.();if(t)P5(t,S.query);if(H.transform)for(let x=0;x<H.transform.length;x++){let v=H.transform[x],_=v.fn(S);if(v.subType==="derive")if(_ instanceof Promise)Object.assign(S,await _);else Object.assign(S,_);else if(_ instanceof Promise)await _}if(w){if(b){let x=structuredClone(S.headers);for(let[v,_]of Q.headers)x[v]=_;if(w.headers.Check(x)===!1)throw new j1("header",w.headers,x)}else if(w.headers?.Decode)S.headers=w.headers.Decode(S.headers);if(l?.Check(S.params)===!1)throw new j1("params",w.params,S.params);else if(w.params?.Decode)S.params=w.params.Decode(S.params);if(t?.Check(S.query)===!1)throw new j1("query",w.query,S.query);else if(w.query?.Decode)S.query=w.query.Decode(S.query);if(w.createCookie?.()){let x={};for(let[v,_]of Object.entries(S.cookie))x[v]=_.value;if(w.cookie.Check(x)===!1)throw new j1("cookie",w.cookie,x);else if(w.cookie?.Decode)x=w.cookie.Decode(x)}if(w.createBody?.()?.Check(O)===!1)throw new j1("body",w.body,O);else if(w.body?.Decode)S.body=w.body.Decode(O)}if(H.beforeHandle)for(let x=0;x<H.beforeHandle.length;x++){let v=H.beforeHandle[x],_=v.fn(S);if(v.subType==="resolve"){if(_ instanceof V0){let p=Y(_,S.set);if(p)return S.response=p}if(_ instanceof Promise)Object.assign(S,await _);else Object.assign(S,_);continue}else if(_ instanceof Promise)_=await _;if(_!==void 0){if(S.response=_,H.afterHandle)for(let $1=0;$1<H.afterHandle.length;$1++){let S1=H.afterHandle[$1].fn(S);if(S1 instanceof Promise)S1=await S1;if(S1)_=S1}let p=Y(_,S.set);if(p)return S.response=p}}let k=typeof M==="function"?M(S):M;if(k instanceof Promise)k=await k;if(H.afterHandle)if(!H.afterHandle.length){let x=k instanceof V0?k.code:U.status?typeof U.status==="string"?EY[U.status]:U.status:200,v=w?.createResponse?.()?.[x];if(v?.Check(k)===!1)throw new j1("response",v,k);else if(v?.Decode)k=v.Decode(k)}else{S.response=k;for(let x=0;x<H.afterHandle.length;x++){let v=H.afterHandle[x].fn(S);if(v instanceof Promise)v=await v;let _=Y(v,S.set);if(_!==void 0){let p=w?.response?.[_.status];if(p?.Check(_)===!1)throw new j1("response",p,_);else if(p?.Decode)k=p.Decode(k);return S.response=_}}}if(S.set.cookie&&m?.sign){let x=!m.secrets?void 0:typeof m.secrets==="string"?m.secrets:m.secrets[0];if(m.sign===!0)for(let[v,_]of Object.entries(S.set.cookie))S.set.cookie[v].value=await LY(_.value,"${secret}");else{let v=w?.cookie?.schema?.properties;for(let _ of m.sign){if(!(_ in v))continue;if(S.set.cookie[_]?.value)S.set.cookie[_].value=await LY(S.set.cookie[_].value,x)}}}return Z(S.response=k,S.set)}catch(q){let M=q instanceof XY&&q.error?q.error:q;return $.handleError(S,M)}finally{if($.event.afterResponse)for(let q of $.event.afterResponse)await q.fn(S)}}},oK=($)=>{let{mapResponse:Z}=$["~adapter"].handler;return async(Y,Q)=>{let W=Object.assign(Y,{error:Q,code:Q.code});if(W.set=Y.set,$.event.error)for(let X=0;X<$.event.error.length;X++){let J=$.event.error[X].fn(W);if(J instanceof Promise)J=await J;if(J!==void 0&&J!==null)return Y.response=Z(J,Y.set)}return new Response(typeof Q.cause==="string"?Q.cause:Q.message,{headers:Y.set.headers,status:Q.status??500})}};class u0{config;server=null;dependencies={};"~Prefix"="";"~Singleton"=null;"~Definitions"=null;"~Metadata"=null;"~Ephemeral"=null;"~Volatile"=null;"~Routes"=null;singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:g.Module({}),type:{},error:{}};extender={macros:[],higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){return h$(h$(this.global,this.scoped),this.local)}};standaloneValidator={global:null,scoped:null,local:null};event={};telemetry;router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new X$({lazy:!0});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new X$;return this["~dynamic"]},static:{},response:{},history:[]};routeTree={};get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}getGlobalDefinitions(){return this.definitions}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,path:!1,route:!1,url:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new cJ(console.error,()=>{});return this._promisedModules}constructor($={}){if($.tags)if(!$.detail)$.detail={tags:$.tags};else $.detail.tags=$.tags;if(this.config={prefix:"",aot:xJ.ELYSIA_AOT!=="false",nativeStaticResponse:!0,systemRouter:!0,encodeSchema:!0,normalize:!0,...$,cookie:{path:"/",...$?.cookie},experimental:$?.experimental??{},seed:$?.seed===void 0?"":$?.seed},this["~adapter"]=$.adapter??(typeof Bun!=="undefined"?nK:_5),$?.analytic&&($?.name||$?.seed!==void 0))this.telemetry={stack:new Error().stack}}"~adapter";env($,Z=xJ){if(U0($,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0,sanitize:()=>this.config.sanitize}).Check(Z)===!1){let Y=new j1("env",$,Z);throw new Error(Y.all.map((Q)=>Q.summary).join(`
`))}return this}wrap($){return this.extender.higherOrderFunctions.push({checksum:Q$(JSON.stringify({name:this.config.name,seed:this.config.seed,content:$.toString()})),fn:$}),this}applyMacro($){if(this.extender.macros.length){let Z=qK({globalHook:this.event,localHook:$}),Y={events:{global:this.event,local:$},get onParse(){return Z("parse")},get onTransform(){return Z("transform")},get onBeforeHandle(){return Z("beforeHandle")},get onAfterHandle(){return Z("afterHandle")},get mapResponse(){return Z("mapResponse")},get onAfterResponse(){return Z("afterResponse")},get onError(){return Z("error")}};for(let Q of this.extender.macros)SK(Q.fn(Y),$,Z)}}get models(){let $={};for(let Z of Object.keys(this.definitions.type))$[Z]=U0(this.definitions.typebox.Import(Z));return $.modules=this.definitions.typebox,$}add($,Z,Y,Q,W,X){let J=W?.skipPrefix??!1,z=W?.allowMeta??!1;if(Q??={},X===void 0){if(X=[],this.standaloneValidator.local)X=X.concat(this.standaloneValidator.local);if(this.standaloneValidator.scoped)X=X.concat(this.standaloneValidator.scoped);if(this.standaloneValidator.global)X=X.concat(this.standaloneValidator.global)}if(Z!==""&&Z.charCodeAt(0)!==47)Z="/"+Z;if(this.config.prefix&&!J)Z=this.config.prefix+Z;if(Q?.type)switch(Q.type){case"text":Q.type="text/plain";break;case"json":Q.type="application/json";break;case"formdata":Q.type="multipart/form-data";break;case"urlencoded":Q.type="application/x-www-form-urlencoded";break;case"arrayBuffer":Q.type="application/octet-stream";break;default:break}let U=this.validator.getCandidate(),S={body:Q?.body??U?.body,headers:Q?.headers??U?.headers,params:Q?.params??U?.params,query:Q?.query??U?.query,cookie:Q?.cookie??U?.cookie,response:Q?.response??U?.response},q=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,M=()=>{let _=this.definitions.type,p=!this.config.aot,$1=this.config.normalize,S1=this.definitions.typebox,q1=()=>this.config.sanitize,A6=()=>{if(S.cookie||X.find((L1)=>L1.cookie))return Qz({modules:S1,validator:S.cookie,defaultConfig:this.config.cookie,config:S.cookie?.config??{},dynamic:p,models:_,validators:X.map((L1)=>L1.cookie),sanitize:q1})};return q?{body:U0(S.body,{modules:S1,dynamic:p,models:_,normalize:$1,additionalCoerce:E5(),validators:X.map((L1)=>L1.body),sanitize:q1}),headers:U0(S.headers,{modules:S1,dynamic:p,models:_,additionalProperties:!0,coerce:!0,additionalCoerce:O4(),validators:X.map((L1)=>L1.headers),sanitize:q1}),params:U0(S.params,{modules:S1,dynamic:p,models:_,coerce:!0,additionalCoerce:O4(),validators:X.map((L1)=>L1.params),sanitize:q1}),query:U0(S.query,{modules:S1,dynamic:p,models:_,normalize:$1,coerce:!0,additionalCoerce:O4(),validators:X.map((L1)=>L1.query),sanitize:q1}),cookie:A6(),response:IJ(S.response,{modules:S1,dynamic:p,models:_,normalize:$1,validators:X.map((L1)=>L1.response),sanitize:q1})}:{createBody(){if(this.body)return this.body;return this.body=U0(S.body,{modules:S1,dynamic:p,models:_,normalize:$1,additionalCoerce:E5(),validators:X.map((L1)=>L1.body),sanitize:q1})},createHeaders(){if(this.headers)return this.headers;return this.headers=U0(S.headers,{modules:S1,dynamic:p,models:_,additionalProperties:!$1,coerce:!0,additionalCoerce:O4(),validators:X.map((L1)=>L1.headers),sanitize:q1})},createParams(){if(this.params)return this.params;return this.params=U0(S.params,{modules:S1,dynamic:p,models:_,coerce:!0,additionalCoerce:O4(),validators:X.map((L1)=>L1.params),sanitize:q1})},createQuery(){if(this.query)return this.query;return this.query=U0(S.query,{modules:S1,dynamic:p,models:_,coerce:!0,additionalCoerce:O4(),validators:X.map((L1)=>L1.query),sanitize:q1})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=A6()},createResponse(){if(this.response)return this.response;return this.response=IJ(S.response,{modules:S1,dynamic:p,models:_,normalize:$1,validators:X.map((L1)=>L1.response),sanitize:q1})}}};if(U.body||U.cookie||U.headers||U.params||U.query||U.response)Q=A8(Q,U);if(Q.tags)if(!Q.detail)Q.detail={tags:Q.tags};else Q.detail.tags=Q.tags;if(T1(this.config.detail))Q.detail=m0(Object.assign({},this.config.detail),Q.detail);this.applyMacro(Q);let H=T1(this.event)?A8(this.event,AJ(Q)):XK(AJ(Q));if(this.config.aot===!1){let _=M();this.router.dynamic.add($,Z,{validator:_,hooks:H,content:Q?.type,handle:Y,route:Z});let p=c$(Z,{dynamic:!0});if(Z!==p)this.router.dynamic.add($,p,{validator:_,hooks:H,content:Q?.type,handle:Y,route:Z});if(this.config.strictPath===!1){let $1=u$(Z);this.router.dynamic.add($,$1,{validator:_,hooks:H,content:Q?.type,handle:Y,route:Z});let S1=c$($1);if($1!==S1)this.router.dynamic.add($,$1,{validator:_,hooks:H,content:Q?.type,handle:Y,route:Z})}this.router.history.push({method:$,path:Z,composed:null,handler:Y,compile:void 0,hooks:H,standaloneValidators:X});return}let w=this["~adapter"].handler,G=typeof Y!=="function"?()=>{let _=w.createNativeStaticHandler?.(Y,H,this.setHeaders);return _ instanceof Promise?_.then((p)=>{if(p)return p}):_?.()}:void 0,N=this.config.nativeStaticResponse===!0,O=(_)=>{if(!N||!G)return;if(pJ)if(this.router.response[_])this.router.response[_][$]=G();else this.router.response[_]={[$]:G()};else this.router.response[_]=G()};O(Z);let m,P=()=>{if(m)return m;return m=mK({app:this,path:Z,method:$,hooks:H,validator:M(),handler:typeof Y!=="function"&&typeof w.createStaticHandler!=="function"?()=>Y:Y,allowMeta:z,inference:this.inference})},b;if(`${$}_${Z}`in this.routeTree)for(let _=0;_<this.router.history.length;_++){let p=this.router.history[_];if(p.path===Z&&p.method===$){b=_;break}}else this.routeTree[`${$}_${Z}`]=this.router.history.length;let l=b??this.router.history.length,t=q?P():(_)=>(this.router.history[l].composed=P())(_);if(b!==void 0)this.router.history[b]=Object.assign({method:$,path:Z,composed:t,compile:P,handler:Y,hooks:H},X.length?{standaloneValidators:X}:void 0,Q.webSocket?{websocket:Q.websocket}:void 0);else this.router.history.push(Object.assign({method:$,path:Z,composed:t,compile:P,handler:Y,hooks:H},X.length?{standaloneValidators:X}:void 0,Q.webSocket?{websocket:Q.websocket}:void 0));let k={handler:q?t:void 0,compile(){return this.handler=P()}},x=this.router.static,v=Z.indexOf(":")===-1&&Z.indexOf("*")===-1;if($==="WS"){if(v){if(Z in x)x[Z][$]=l;else x[Z]={[$]:l};return}if(this.router.http.add("WS",Z,k),!this.config.strictPath)this.router.http.add("WS",u$(Z),k);let _=c$(Z,{dynamic:!0});if(Z!==_)this.router.http.add("WS",_,k);return}if(v){if(Z in x)x[Z][$]=l;else x[Z]={[$]:l};if(!this.config.strictPath)O(u$(Z))}else{this.router.http.add($,Z,k);let _=typeof Y!=="function"&&typeof w.createStaticHandler==="function"?w.createStaticHandler(Y,H,this.setHeaders):void 0;if(!this.config.strictPath){let $1=u$(Z);O($1),this.router.http.add($,$1,k)}let p=c$(Z,{dynamic:!0});if(Z!==p)this.router.http.add($,p,k),O(p)}}setHeaders;headers($){if(!$)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=m0(this.setHeaders,$),this}onStart($){return this.on("start",$),this}onRequest($){return this.on("request",$),this}onParse($,Z){if(!Z){if(typeof $==="string")return this.on("parse",this["~parser"][$]);return this.on("parse",$)}return this.on($,"parse",Z)}parser($,Z){return this["~parser"][$]=Z,this}onTransform($,Z){if(!Z)return this.on("transform",$);return this.on($,"transform",Z)}resolve($,Z){if(!Z)Z=$,$={as:"local"};let Y={subType:"resolve",fn:Z};return this.onBeforeHandle($,Y)}mapResolve($,Z){if(!Z)Z=$,$={as:"local"};let Y={subType:"mapResolve",fn:Z};return this.onBeforeHandle($,Y)}onBeforeHandle($,Z){if(!Z)return this.on("beforeHandle",$);return this.on($,"beforeHandle",Z)}onAfterHandle($,Z){if(!Z)return this.on("afterHandle",$);return this.on($,"afterHandle",Z)}mapResponse($,Z){if(!Z)return this.on("mapResponse",$);return this.on($,"mapResponse",Z)}onAfterResponse($,Z){if(!Z)return this.on("afterResponse",$);return this.on($,"afterResponse",Z)}trace($,Z){if(!Z)Z=$,$={as:"local"};if(!Array.isArray(Z))Z=[Z];for(let Y of Z)this.on($,"trace",EK(Y));return this}error($,Z){switch(typeof $){case"string":return Z.prototype[OY]=$,this.definitions.error[$]=Z,this;case"function":return this.definitions.error=$(this.definitions.error),this}for(let[Y,Q]of Object.entries($))Q.prototype[OY]=Y,this.definitions.error[Y]=Q;return this}onError($,Z){if(!Z)return this.on("error",$);return this.on($,"error",Z)}onStop($){return this.on("stop",$),this}on($,Z,Y){let Q;switch(typeof $){case"string":Q=$,Y=Z;break;case"object":if(Q=Z,!Array.isArray(Z)&&typeof Z==="object")Y=Z;break}if(Array.isArray(Y))Y=W0(Y);else if(typeof Y==="function")Y=[{fn:Y}];else Y=[Y];let W=Y;for(let X of W)if(X.scope=typeof $==="string"?"local":$?.as??"local",Q==="resolve"||Q==="derive")X.subType=Q;if(Q!=="trace")this.inference=r$({[Q]:W.map((X)=>X.fn)},this.inference);for(let X of W){let J=zK(X,"global",{skipIfHasType:!0});switch(Q){case"start":this.event.start??=[],this.event.start.push(J);break;case"request":this.event.request??=[],this.event.request.push(J);break;case"parse":this.event.parse??=[],this.event.parse.push(J);break;case"transform":this.event.transform??=[],this.event.transform.push(J);break;case"derive":this.event.transform??=[],this.event.transform.push(W0(J,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(J);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push(W0(J,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(J);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(J);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(J);break;case"trace":this.event.trace??=[],this.event.trace.push(J);break;case"error":this.event.error??=[],this.event.error.push(J);break;case"stop":this.event.stop??=[],this.event.stop.push(J);break}}return this}as($){if(h8(this.event.parse,$),h8(this.event.transform,$),h8(this.event.beforeHandle,$),h8(this.event.afterHandle,$),h8(this.event.mapResponse,$),h8(this.event.afterResponse,$),h8(this.event.trace,$),h8(this.event.error,$),$==="scoped")this.validator.scoped=h$(this.validator.scoped,this.validator.local),this.validator.local=null;else if($==="global")this.validator.global=h$(this.validator.global,h$(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null;return this}group($,Z,Y){let Q=new u0({...this.config,prefix:""});Q.singleton={...this.singleton},Q.definitions={...this.definitions},Q.getServer=()=>this.getServer(),Q.inference=LJ(this.inference),Q.extender={...this.extender},Q["~parser"]=this["~parser"],Q.standaloneValidator={local:[...this.standaloneValidator.local??[]],scoped:[...this.standaloneValidator.scoped??[]],global:[...this.standaloneValidator.global??[]]};let W=typeof Z==="object",X=(W?Y:Z)(Q);if(this.singleton=m0(this.singleton,Q.singleton),this.definitions=m0(this.definitions,Q.definitions),X.event.request?.length)this.event.request=[...this.event.request||[],...X.event.request||[]];if(X.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...X.event.mapResponse||[]];return this.model(X.definitions.type),Object.values(Q.router.history).forEach(({method:J,path:z,handler:U,hooks:S,standaloneValidators:q})=>{if(z=(W?"":this.config.prefix)+$+z,W){let M=Z,H=S;this.add(J,z,U,A8(M,{...H||{},error:!H.error?X.event.error:Array.isArray(H.error)?[...H.error||{},...X.event.error||{}]:[H.error,...X.event.error||{}]}),void 0,q)}else this.add(J,z,U,A8(S,{error:X.event.error}),{skipPrefix:!0},q)}),this}guard($,Z){if(!Z){if(typeof $==="object"){if(this.applyMacro($),$.detail)if(this.config.detail)this.config.detail=m0(Object.assign({},this.config.detail),$.detail);else this.config.detail=$.detail;if($.tags)if(!this.config.detail)this.config.detail={tags:$.tags};else this.config.detail.tags=$.tags;let W=$.as??"local";if($.schema==="standalone"){if(!this.standaloneValidator[W])this.standaloneValidator[W]=[];let X=$?.response||typeof $?.response==="string"||$?.response&&L in $.response?{200:$.response}:$?.response;return this.standaloneValidator[W].push({body:$.body,headers:$.headers,params:$.params,query:$.query,response:X,cookie:$.cookie}),this}if(this.validator[W]={body:$.body??this.validator[W]?.body,headers:$.headers??this.validator[W]?.headers,params:$.params??this.validator[W]?.params,query:$.query??this.validator[W]?.query,response:$.response??this.validator[W]?.response,cookie:$.cookie??this.validator[W]?.cookie},$.parse)this.on({as:W},"parse",$.parse);if($.transform)this.on({as:W},"transform",$.transform);if($.derive)this.on({as:W},"derive",$.derive);if($.beforeHandle)this.on({as:W},"beforeHandle",$.beforeHandle);if($.resolve)this.on({as:W},"resolve",$.resolve);if($.afterHandle)this.on({as:W},"afterHandle",$.afterHandle);if($.mapResponse)this.on({as:W},"mapResponse",$.mapResponse);if($.afterResponse)this.on({as:W},"afterResponse",$.afterResponse);if($.error)this.on({as:W},"error",$.error);return this}return this.guard({},$)}let Y=new u0({...this.config,prefix:""});Y.singleton={...this.singleton},Y.definitions={...this.definitions},Y.inference=LJ(this.inference),Y.extender={...this.extender};let Q=Z(Y);if(this.singleton=m0(this.singleton,Y.singleton),this.definitions=m0(this.definitions,Y.definitions),Q.getServer=()=>this.server,Q.event.request?.length)this.event.request=[...this.event.request||[],...Q.event.request||[]];if(Q.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...Q.event.mapResponse||[]];return this.model(Q.definitions.type),Object.values(Y.router.history).forEach(({method:W,path:X,handler:J,hooks:z})=>{this.add(W,X,J,A8($,{...z||{},error:!z.error?Q.event.error:Array.isArray(z.error)?[...z.error||{},...Q.event.error||[]]:[z.error,...Q.event.error||[]]}))}),this}use($,Z){if(Array.isArray($)){let Y=this;for(let Q of $)Y=Y.use(Q);return Y}if(Z?.scoped)return this.guard({},(Y)=>Y.use($));if(Array.isArray($)){let Y=this;for(let Q of $)Y=this.use(Q);return Y}if($ instanceof Promise)return this.promisedModules.add($.then((Y)=>{if(typeof Y==="function")return Y(this);if(Y instanceof u0)return this._use(Y).compile();if(Y.constructor.name==="Elysia")return this._use(Y).compile();if(typeof Y.default==="function")return Y.default(this);if(Y.default instanceof u0)return this._use(Y.default);if(Y.constructor.name==="Elysia")return this._use(Y.default);if(Y.constructor.name==="_Elysia")return this._use(Y.default);try{return this._use(Y.default)}catch(Q){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),Q}}).then((Y)=>{if(Y&&typeof Y.compile==="function")Y.compile();return Y})),this;return this._use($)}propagatePromiseModules($){if($.promisedModules.size<=0)return this;for(let Z of $.promisedModules.promises)this.promisedModules.add(Z.then((Y)=>{if(!Y)return;let Q=this._use(Y);if(Q instanceof Promise)return Q.then((W)=>{if(W)W.compile();else Y.compile()});return Y.compile()}));return this}_use($){if(typeof $==="function"){let W=$(this);if(W instanceof Promise)return this.promisedModules.add(W.then((X)=>{if(X instanceof u0){X.getServer=()=>this.getServer(),X.getGlobalRoutes=()=>this.getGlobalRoutes(),X.getGlobalDefinitions=()=>this.getGlobalDefinitions(),X.model(this.definitions.type),X.error(this.definitions.error);for(let{method:J,path:z,handler:U,hooks:S,standaloneValidators:q}of Object.values(X.router.history))this.add(J,z,U,T1(X.event.error)?A8(S,{error:X.event.error}):S,void 0,q);if(X===this)return;return this.propagatePromiseModules(X),X}if(typeof X==="function")return X(this);if(typeof X.default==="function")return X.default(this);return this._use(X)}).then((X)=>{if(X&&typeof X.compile==="function")X.compile();return X})),this;return W}this.propagatePromiseModules($);let Z=$.config.name,Y=$.config.seed;if($.getParent=()=>this,$.getServer=()=>this.getServer(),$.getGlobalRoutes=()=>this.getGlobalRoutes(),$.getGlobalDefinitions=()=>this.getGlobalDefinitions(),$.standaloneValidator?.scoped)if(this.standaloneValidator.local)this.standaloneValidator.local=this.standaloneValidator.local.concat($.standaloneValidator.scoped);else this.standaloneValidator.local=$.standaloneValidator.scoped;if($.standaloneValidator?.global)if(this.standaloneValidator.global)this.standaloneValidator.global=this.standaloneValidator.global.concat($.standaloneValidator.global);else this.standaloneValidator.global=$.standaloneValidator.global;if(T1($["~parser"]))this["~parser"]={...$["~parser"],...this["~parser"]};if($.setHeaders)this.headers($.setHeaders);if(Z){if(!(Z in this.dependencies))this.dependencies[Z]=[];let W=Y!==void 0?Q$(Z+JSON.stringify(Y)):0;if(!this.dependencies[Z].some(({checksum:X})=>W===X))this.extender.macros=this.extender.macros.concat($.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat($.extender.higherOrderFunctions)}else{if($.extender.macros.length)this.extender.macros=this.extender.macros.concat($.extender.macros);if($.extender.higherOrderFunctions.length)this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat($.extender.higherOrderFunctions)}OJ(this.extender.macros),OJ(this.extender.higherOrderFunctions);let Q=[];for(let W=0;W<this.extender.higherOrderFunctions.length;W++){let X=this.extender.higherOrderFunctions[W];if(X.checksum){if(Q.includes(X.checksum))this.extender.higherOrderFunctions.splice(W,1),W--;Q.push(X.checksum)}}if(Q.length=0,this.inference=C5(this.inference,$.inference),T1($.singleton.decorator))this.decorate($.singleton.decorator);if(T1($.singleton.store))this.state($.singleton.store);if(T1($.definitions.type))this.model($.definitions.type);if(T1($.definitions.error))this.error($.definitions.error);if(T1($.definitions.error))$.extender.macros=this.extender.macros.concat($.extender.macros);for(let{method:W,path:X,handler:J,hooks:z,standaloneValidators:U}of Object.values($.router.history))this.add(W,X,J,T1($.event.error)?A8(z,{error:$.event.error}):z,void 0,U);if(Z){if(!(Z in this.dependencies))this.dependencies[Z]=[];let W=Y!==void 0?Q$(Z+JSON.stringify(Y)):0;if(this.dependencies[Z].some(({checksum:X})=>W===X))return this;if(this.dependencies[Z].push(this.config?.analytic?{name:$.config.name,seed:$.config.seed,checksum:W,dependencies:$.dependencies,stack:$.telemetry?.stack,routes:$.router.history,decorators:$.singleton,store:$.singleton.store,error:$.definitions.error,derive:$.event.transform?.filter((X)=>X?.subType==="derive").map((X)=>({fn:X.toString(),stack:new Error().stack??""})),resolve:$.event.transform?.filter((X)=>X?.subType==="resolve").map((X)=>({fn:X.toString(),stack:new Error().stack??""}))}:{name:$.config.name,seed:$.config.seed,checksum:W,dependencies:$.dependencies}),T1($.event))this.event=MJ(this.event,BJ($.event),W)}else if(T1($.event))this.event=MJ(this.event,BJ($.event));if($.validator.global)this.validator.global=A8(this.validator.global,{...$.validator.global});if($.validator.scoped)this.validator.local=A8(this.validator.local,{...$.validator.scoped});return this}macro($){if(typeof $==="function"){let Z={checksum:Q$(JSON.stringify({name:this.config.name,seed:this.config.seed,content:$.toString()})),fn:$};this.extender.macros.push(Z)}else if(typeof $==="object"){for(let Y of Object.keys($))if(typeof $[Y]==="object"){let Q={...$[Y]};$[Y]=(W)=>{if(W===!0)return Q}}let Z={checksum:Q$(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Object.entries($).map(([Y,Q])=>`${Y}+${Q}`).join(",")})),fn:()=>$};this.extender.macros.push(Z)}return this}mount($,Z,Y){if($ instanceof u0||typeof $==="function"||$.length===0||$==="/"){let J=typeof $==="function"?$:$ instanceof u0?$.compile().fetch:Z instanceof u0?Z.compile().fetch:typeof Z==="function"?Z:(()=>{throw new Error("Invalid handler")})(),z=({request:U,path:S})=>J(new Request(GJ(U.url,S),{method:U.method,headers:U.headers,signal:U.signal,credentials:U.credentials,referrerPolicy:U.referrerPolicy,duplex:U.duplex,redirect:U.redirect,mode:U.mode,keepalive:U.keepalive,integrity:U.integrity,body:U.body}));return this.route("ALL","/*",z,{parse:"none",...Y,detail:{...Y?.detail,hide:!0},config:{mount:J}}),this}let Q=Z instanceof u0?Z.compile().fetch:typeof Z==="function"?Z:(()=>{throw new Error("Invalid handler")})(),W=$.length-($.endsWith("*")?1:0),X=({request:J,path:z})=>Q(new Request(GJ(J.url,z.slice(W)||"/"),{method:J.method,headers:J.headers,signal:J.signal,credentials:J.credentials,referrerPolicy:J.referrerPolicy,duplex:J.duplex,redirect:J.redirect,mode:J.mode,keepalive:J.keepalive,integrity:J.integrity,body:J.body}));return this.route("ALL",$,X,{parse:"none",...Y,detail:{...Y?.detail,hide:!0},config:{mount:Q}}),this.route("ALL",$+($.endsWith("/")?"*":"/*"),X,{parse:"none",...Y,detail:{...Y?.detail,hide:!0},config:{mount:Q}}),this}get($,Z,Y){return this.add("GET",$,Z,Y),this}post($,Z,Y){return this.add("POST",$,Z,Y),this}put($,Z,Y){return this.add("PUT",$,Z,Y),this}patch($,Z,Y){return this.add("PATCH",$,Z,Y),this}delete($,Z,Y){return this.add("DELETE",$,Z,Y),this}options($,Z,Y){return this.add("OPTIONS",$,Z,Y),this}all($,Z,Y){return this.add("ALL",$,Z,Y),this}head($,Z,Y){return this.add("HEAD",$,Z,Y),this}connect($,Z,Y){return this.add("CONNECT",$,Z,Y),this}route($,Z,Y,Q){return this.add($.toUpperCase(),Z,Y,Q,Q?.config),this}ws($,Z){if(this["~adapter"].ws)this["~adapter"].ws(this,$,Z);else console.warn("Current adapter doesn't support WebSocket");return this}state($,Z,Y){if(Z===void 0)Y=$,$={as:"append"},Z="";else if(Y===void 0){if(typeof $==="string")Y=Z,Z=$,$={as:"append"};else if(typeof $==="object")Y=Z,Z=""}let{as:Q}=$;if(typeof Z!=="string")return this;switch(typeof Y){case"object":if(!Y||!T1(Y))return this;if(Z){if(Z in this.singleton.store)this.singleton.store[Z]=m0(this.singleton.store[Z],Y,{override:Q==="override"});else this.singleton.store[Z]=Y;return this}if(Y===null)return this;return this.singleton.store=m0(this.singleton.store,Y,{override:Q==="override"}),this;case"function":if(Z){if(Q==="override"||!(Z in this.singleton.store))this.singleton.store[Z]=Y}else this.singleton.store=Y(this.singleton.store);return this;default:if(Q==="override"||!(Z in this.singleton.store))this.singleton.store[Z]=Y;return this}}decorate($,Z,Y){if(Z===void 0)Y=$,$={as:"append"},Z="";else if(Y===void 0){if(typeof $==="string")Y=Z,Z=$,$={as:"append"};else if(typeof $==="object")Y=Z,Z=""}let{as:Q}=$;if(typeof Z!=="string")return this;switch(typeof Y){case"object":if(Z){if(Z in this.singleton.decorator)this.singleton.decorator[Z]=m0(this.singleton.decorator[Z],Y,{override:Q==="override"});else this.singleton.decorator[Z]=Y;return this}if(Y===null)return this;return this.singleton.decorator=m0(this.singleton.decorator,Y,{override:Q==="override"}),this;case"function":if(Z){if(Q==="override"||!(Z in this.singleton.decorator))this.singleton.decorator[Z]=Y}else this.singleton.decorator=Y(this.singleton.decorator);return this;default:if(Q==="override"||!(Z in this.singleton.decorator))this.singleton.decorator[Z]=Y;return this}}derive($,Z){if(!Z)Z=$,$={as:"local"};let Y={subType:"derive",fn:Z};return this.onTransform($,Y)}model($,Z){switch(typeof $){case"object":let Y={},Q=Object.entries($);if(!Q.length)return this;for(let[J,z]of Q){if(J in this.definitions.type)continue;Y[J]=this.definitions.type[J]=z,Y[J].$id??=`#/components/schemas/${J}`}return this.definitions.typebox=g.Module({...this.definitions.typebox.$defs,...Y}),this;case"function":let W=$(this.definitions.type);return this.definitions.type=W,this.definitions.typebox=g.Module(W),this;case"string":if(!Z)break;let X={...Z,id:Z.$id??`#/components/schemas/${$}`};return this.definitions.type[$]=Z,this.definitions.typebox=g.Module({...this.definitions.typebox.$defs,...X}),this}return this.definitions.type[$]=Z,this.definitions.typebox=g.Module({...this.definitions.typebox.$defs,[$]:Z}),this}Ref($){return g.Ref($)}mapDerive($,Z){if(!Z)Z=$,$={as:"local"};let Y={subType:"mapDerive",fn:Z};return this.onTransform($,Y)}affix($,Z,Y){if(Y==="")return this;let Q=["_","-"," "],W=(U)=>U[0].toUpperCase()+U.slice(1),X=$==="prefix"?(U,S)=>Q.includes(U.at(-1)??"")?U+S:U+W(S):Q.includes(Y.at(-1)??"")?(U,S)=>S+U:(U,S)=>S+W(U),J=(U)=>{let S={};switch(U){case"decorator":for(let q in this.singleton.decorator)S[X(Y,q)]=this.singleton.decorator[q];this.singleton.decorator=S;break;case"state":for(let q in this.singleton.store)S[X(Y,q)]=this.singleton.store[q];this.singleton.store=S;break;case"model":for(let q in this.definitions.type)S[X(Y,q)]=this.definitions.type[q];this.definitions.type=S;break;case"error":for(let q in this.definitions.error)S[X(Y,q)]=this.definitions.error[q];this.definitions.error=S;break}},z=Array.isArray(Z)?Z:[Z];for(let U of z.some((S)=>S==="all")?["decorator","state","model","error"]:z)J(U);return this}prefix($,Z){return this.affix("prefix",$,Z)}suffix($,Z){return this.affix("suffix",$,Z)}compile(){if(this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?L5(this):kJ(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=L5(this),this}handle=async($)=>this.fetch($);fetch=($)=>{return(this.fetch=this.config.aot?L5(this):kJ(this))($)};handleError=async($,Z)=>{return(this.handleError=this.config.aot?Jz(this):oK(this))($,Z)};listen=($,Z)=>{if(this["~adapter"].listen(this)($,Z),this.promisedModules.size)jJ(5000);return this.promisedModules.then(()=>{jJ(1000)}),this};stop=async($)=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop($),this.server=null,this.event.stop?.length)for(let Z=0;Z<this.event.stop.length;Z++)this.event.stop[Z].fn(this)}};get modules(){return this.promisedModules}}var tK=typeof new Headers()?.toJSON==="function",sK=($)=>{if(tK)return Object.keys($.toJSON()).join(", ");let Z="",Y=0;return $.forEach((Q,W)=>{if(Y)Z=Z+", "+W;else Z=W;Y++}),Z},Sz=($)=>{let{aot:Z=!0,origin:Y=!0,methods:Q=!0,allowedHeaders:W=!0,exposeHeaders:X=!0,credentials:J=!0,maxAge:z=5,preflight:U=!0}=$??{};if(Array.isArray(W))W=W.join(", ");if(Array.isArray(X))X=X.join(", ");let S=typeof Y==="boolean"?void 0:Array.isArray(Y)?Y:[Y],q=new u0({name:"@elysiajs/cors",seed:$,aot:Z}),M=S?.some((P)=>P==="*"),H={};if(S){for(let P of S)if(typeof P==="string")H[P]=!0}let w=(P,b,l)=>{if(Array.isArray(P))return P.some((t)=>w(t,b,l));switch(typeof P){case"string":if(l in H)return!0;let t=l.indexOf("://");if(t!==-1)l=l.slice(t+3);return P===l;case"function":return P(b)===!0;case"object":if(P instanceof RegExp)return P.test(l)}return!1},G=(P,b)=>{if(Y===!0){P.headers.vary="*",P.headers["access-control-allow-origin"]=b.headers.get("Origin")||"*";return}if(M){P.headers.vary="*",P.headers["access-control-allow-origin"]="*";return}if(!S?.length)return;let l=[];if(S.length){let t=b.headers.get("Origin")??"";for(let k=0;k<S.length;k++)if(w(S[k],b,t)===!0){P.headers.vary=Y?"Origin":"*",P.headers["access-control-allow-origin"]=t||"*";return}}if(P.headers.vary="Origin",l.length)P.headers["access-control-allow-origin"]=l.join(", ")},N=(P,b)=>{if(!b)return;if(Q===!0)return P.headers["access-control-allow-methods"]=b??"*";if(Q===!1||!Q?.length)return;if(Q==="*")return P.headers["access-control-allow-methods"]="*";if(!Array.isArray(Q))return P.headers["access-control-allow-methods"]=Q;P.headers["access-control-allow-methods"]=Q.join(", ")},O={};if(typeof X==="string")O["access-control-expose-headers"]=X;if(typeof W==="string")O["access-control-allow-headers"]=W;if(J===!0)O["access-control-allow-credentials"]="true";q.headers(O);function m({set:P,request:b,headers:l}){if(G(P,b),N(P,b.headers.get("access-control-request-method")),W===!0||X===!0){if(W===!0)P.headers["access-control-allow-headers"]=l["access-control-request-headers"];if(X===!0)P.headers["access-control-expose-headers"]=Object.keys(l).join(",")}if(z)P.headers["access-control-max-age"]=z.toString();return new Response(null,{status:204})}if(U)q.options("/",m).options("/*",m);return q.onRequest(function P({set:b,request:l}){if(G(b,l),N(b,l.method),W===!0||X===!0){let t=sK(l.headers);if(W===!0)b.headers["access-control-allow-headers"]=t;if(X===!0)b.headers["access-control-expose-headers"]=t}})};var hM=t$(hS(),1);var t8={jwt:{EXPIRATION_TIME:3600,KEY_PREFIX:"jwt",REDIS_DB_KEY:0},avatar:{EXPIRATION_TIME:21600,KEY_PREFIX:"avatar",REDIS_DB_KEY:1},lessons:{EXPIRATION_TIME:3600,KEY_PREFIX:"lessons",REDIS_DB_KEY:2},periods:{EXPIRATION_TIME:3600,KEY_PREFIX:"periods",REDIS_DB_KEY:3},users:{EXPIRATION_TIME:86400,KEY_PREFIX:"users",REDIS_DB_KEY:9}};var vM=t$(fM(),1),dM=globalThis,Px=process.env.REDIS_URL||"",yM=2,V4=dM.redis||new vM.default(Px,{retryStrategy:($,Z)=>{if(Z?.code==="ENOTFOUND")return console.error("Redis DNS hatas\u0131, tekrar denenmeyecek:",Z),null;if($>=yM)return console.error(`Redis ba\u011Flant\u0131s\u0131 ${yM} kez ba\u015Far\u0131s\u0131z oldu, duruyor...`),null;return Math.min($*1000,5000)}});dM.redis=V4;var W4=async($,Z,Y)=>{try{V4.select(Z);let Q=await V4.get($);if(!Q||Q.length<2||Q[1][0])return null;let W=Q[1][1];if(typeof W!=="string")return null;return Y?JSON.parse(W):W}catch(Q){return console.error("Redis get error:",Q),null}},N$=async($,Z,Y,Q,W)=>{console.log("set cache");try{let X=W?JSON.stringify(Z):Z;if(V4.select(Q),!await V4.set($,X,"EX",Y))console.log("insert error!")}catch(X){console.error("Redis set error:",X)}};var mM=process.env.JWT_SECRET_KEY,WW=t8.jwt;if(!mM)throw new Error("JWT_SECRET_KEY is not defined in environment variables.");async function Kx($){try{let Z=hM.default.verify($,mM),Y=Math.floor(Date.now()/1000);if(!Z||!Z.exp||Z.exp<Y)return null;return await N$($,Z,WW.EXPIRATION_TIME,WW.REDIS_DB_KEY,!0),Z}catch(Z){return null}}async function uM($){let Z=$.split(" ");if(Z.length!==2||Z[0]!=="Bearer")return null;let Y=Z[1],Q=Math.floor(Date.now()/1000),W=await W4(Y,WW.REDIS_DB_KEY,!0);if(W?.exp&&W.exp>Q)return W;return await Kx(Y)}async function R9($,Z){if(!$.authorization)return{status:!1,message:"Access denied. No token provided."};let Y=await uM($.authorization);if(!Y)return{status:!1,message:"Access denied. User not found."};if(!Y.userId)return{status:!1,message:"Access denied. Invalid token."};if(!Z.includes(Y.role))return{status:!1,message:"You do not have permission to access this resource."};return{status:!0,user:Y}}var{SQL:Rx}=globalThis.Bun;var cM=new Rx({url:process.env.DATABASE_URL});var pM=async({userId:$})=>{if(!$)return null;try{let Z=t8.lessons,Y="SPRING",Q="c12d4575-d3d3-4a42-bb19-61409470331c",W=await W4($,Z.REDIS_DB_KEY,!0);if(W)return W;let X=await cM`SELECT
                              to_jsonb (note) AS note,
                              to_jsonb (lesson) AS lesson,
                              to_jsonb (instructor) AS instructor,
                              period
                            FROM
                              "note"
                              INNER JOIN "lesson" ON "note"."lesson_id" = "lesson"."id"
                              INNER JOIN "instructor" ON "lesson"."instructor_id" = "instructor"."id"
                              INNER JOIN "note_to_period" ON "note_to_period"."note_id" = "note"."id"
                              INNER JOIN "period" ON "period"."id" = "note_to_period"."period_id"
                            WHERE
                              ("note"."user_id" = ${$} AND "period"."id" = ${"c12d4575-d3d3-4a42-bb19-61409470331c"} AND "period"."semester" = ${"SPRING"})`;return await N$($,X,Z.EXPIRATION_TIME,Z.REDIS_DB_KEY,!0),X}catch(Z){throw console.error("Error fetching lessons:",Z),new Error("Failed to fetch lessons from the database")}};var iM=async({userId:$})=>{if(!$)return null;try{let Z=t8.periods,Y=await W4($,Z.REDIS_DB_KEY,!0);if(Y)return Y}catch(Z){throw console.error("Error fetching periods:",Z),new Error("Failed to fetch periods from the database")}};var{S3Client:jx}=globalThis.Bun;var lM=new jx({accessKeyId:process.env.MINIO_ACCESS_KEY,secretAccessKey:process.env.MINIO_SECRET_KEY,endpoint:process.env.MINIO_END_POINT});var nM=async({userId:$,bucketId:Z})=>{if(!$)return null;try{if(!$||!Z)return null;let Y=t8.avatar,Q=await W4($,Y.REDIS_DB_KEY,!1);if(Q)return Q;let W=lM.presign(`${Z}/avatar/${$}.png`,{expiresIn:21600,acl:"private"});if(!W)return null;return await N$($,W,Y.EXPIRATION_TIME,Y.REDIS_DB_KEY,!1),W}catch(Y){throw console.error("Error fetching avatar:",Y),new Error("Failed to fetch avatar from the S3 server")}};var oM=["*","http://192.168.1.34:3000","http://localhost:3000","https://misy-dev.vercel.app","https://misy.online"];new u0().use(Sz({origin:oM,allowedHeaders:"Content-Type,Authorization,Expires,Cache-Control,Pragma",methods:"GET,POST,PUT,DELETE,OPTIONS"})).get("/api/avatar",async({headers:$})=>{let Z=await R9($,["STUDENT","INSTRUCTOR"]);if(!Z.status)return{status:"error",message:Z.message};let Y=await nM({userId:Z.user?.userId,bucketId:Z.user?.bucketId});return Y.length===0?{status:"success",message:"No avatar found."}:{status:"success",userId:Z.user?.userId,data:Y}}).get("/api/lessons",async({headers:$})=>{let Z=await R9($,["STUDENT","INSTRUCTOR"]);if(!Z.status)return{status:"error",message:Z.message};let Y=await pM({userId:"d2bd42e7-55d3-4e6b-9d0f-5c024f7bf9a6"});return Y.length===0?{status:"success",message:"No lessons found."}:{status:"success",userId:Z.user?.userId,data:Y}}).get("/api/periods",async({headers:$})=>{let Z=await R9($,["STUDENT","INSTRUCTOR"]);if(!Z.status)return{status:"error",message:Z.message};let Y=await iM({userId:Z.user?.userId});return Y.length===0?{status:"success",message:"No periods found."}:{status:"success",userId:Z.user?.userId,data:Y}}).get("/health",()=>{return new Response("OK")}).listen({idleTimeout:0,port:process.env.PORT||3001});
